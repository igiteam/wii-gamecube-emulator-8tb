(()=>{const __INJECTIONS__={tagVersion:"v5.9.0",nonWebWorkerTags:["INMQNM881","COHIBT937","NANVMK223","LESSNQ116","RJ5KCKY33","DT4QSOD19","OSTVLK679","WAXUIU497","MIGDPH287","PESUFE285","PEOYCU936","PENDBL803","NI3H21X3M","NEPNTI427","SEDHVU295","BQVJVH560","BQVAWY428"]},GLOBALS={clientTag:"",cdnUrl:"",dal:null,notifier:null,coreTracker:null,conf:null,chpReports:null,SeTargetAudience:null};GLOBALS.SeTargetAudience=(()=>{let e;const t=new class{constructor(){this.configs=null}init(n){t.configs=n,e=t.configs.e,notifier.retroBind("extensions-reported",(function(n){if(0===e.ta.length)return;let r=dal.session.getOne("target_audiences");if(r||(r=[]),r.length>0)for(const e of r)if(e.segmentId===n.resourceId)return;let i=[];for(const t of e.ta)t.segmentId===n.resourceId&&i.push({id:coreUtils.generateUUID(),segmentId:n.resourceId,segmentName:n.name,systemId:t.systemId,wasSent:0});if(0!==i.length){for(const e of i)r.push(e);dal.session.set({target_audiences:r}),t.updateTargetAudiences()}})),notifier.retroBind("updateTargetAudienceStatus",t.updateTargetAudienceStatus)}updateTargetAudiences(){const e=dal.session.getOne("target_audiences");for(const t of e)0===t.wasSent&&(t.wasSent=1,notifier.fire("sem_audiences_"+t.systemId,t)),dal.session.set({target_audiences:e})}updateTargetAudienceStatus(e){const t=dal.session.getOne("target_audiences");for(const n of t)n.id===e&&(n.wasSent=2);dal.session.set({target_audiences:t})}};return t})();const NmgProducts={CHP:"chp3"},TagModules={CHP:"chp3"},UrlParams={NMG_AUTH_KEY:"nmgAuthKey",DISABLE_MODULES:"disableModules",DISABLE_TAG:"disableTag"},DEFAULT_GW_HOST="https://colrep.sitelabweb.com",STG_DEFAULT_GW_HOST="https://evnt.s.nmgplatform.com",SnapshotFileSuffix="snp",EventsTopics={error:"pi_js_errors",stack:"pi_stack",chpStack:"stack",chpResearch:"research",chpHook:"hook_reporter",coreError:"core_js_errors",coreStack:"core_stack"},EventRequestType={GET:"sendGetEvent",POST:"sendPostEvent",GET_VIAWEBWORKER:"sendGetEventViaWebWorker"},FetchConfigs={GET:{method:"GET",mode:"no-cors",cache:"no-cache",headers:{"Content-Type":"application/json"}},POST:{method:"POST",mode:"cors",cache:"no-cache",headers:{"Content-Type":"application/json"}}},EventsProductsEndpoints={JDL:"jdldata/",CHP:"chpdata/"},ClientFeatureFlags={EVENT_COMPRESSION:"ec",SCRIPT_HANG_TIME_INTERVAL:"i",SCRIPT_HANG_TIME_TOTAL_TIME:"tt",SCRIPT_HANG_TIME_INTERVAL_PERCENTAGE:"ip",REVENUE_COLLECTION:"rc"},dataCollectorIntervals=1e3,browsers=[{values:["yandexbot"],displayName:"Yandex Search"},{values:["yabrowser"],displayName:"Yandex Browser"},{values:["apple mail"],displayName:"Apple Mail"},{values:["snapchat"],displayName:"Snapchat"},{values:["snapchat"],displayName:"Snapchat"},{values:["fbav/","fban/"],displayName:"Facebook"},{values:["pinterest"],displayName:"Pinterest"},{values:["instagram"],displayName:"Instagram"},{values:["gsa/"],displayName:"Google"}],ElementWithPrice={DESCRIPTION:"d",PRICE:"p",CURRENCY:"c"},Devices={TABLET:"tablet",MOB:"mobile",PC:"pc",TV:"tv"},CartSections={SUB_TOTAL:"subTotal",TAX:"tax",SHIPPING:"shipping",TOTAL:"total",PROMOTIONS:"promotions"},JDLDataPointNames={SPORT:"sport",LUXURY:"luxury",BRAND:"brand",APPLIANCE:"appliance",BEAUTY:"beauty",SALES:"sales"},DalMutators={ETAG:"etag"},maxTriesToGetEtag=5,intervalBetweenEtagCalls=250,localStorageKeys={nmgCjosConsent:"nmg_cjos_consent",channelHandlerPV:"nmg_chhndl_pv",channelHandlerCB:"nmg_chhndl_cb",channelHandlerChannelName:"nmg_chhndl_chname",bwLists:"xjhysnfefqnkscnb",forceSEMLight:"forceSEMLight",semLightStorageKey:"semLight",semLightActiveRulesStorageKey:"semLightActiveRules"},logger=(()=>{const e="error",t="warn",n="info",r="log";class i{constructor(e="NMG",t=!1){this.storageName="_vmdbnudu",this.isEnabled=!1,this.product=e,this.getLogLevel()&&(this.isEnabled=!0,t&&console.log("%cðŸ… ðŸ… ðŸ…œ ðŸ…ž-ðŸ…–-ðŸ…ž-ðŸ…ž","font-size:30px; color: #ffdf5a; margin: 10px 0;"))}static getStyle(e,t){return`display: inline-block;border-radius: 25px;padding: 1px 8px;color: white;weight: bold;margin: 2px 0;font-size:10px;background: ${e};border: 2px solid ${e};${t||""}`}static getCallerFunctionName(){try{throw Error()}catch(e){try{return e.stack.split("at ")[4].split(" ")[0]}catch(e){return""}}}info(e,t){o.consoleAction(n,e,t)}warn(e,n){o.consoleAction(t,e,n)}log(e,t){o.consoleAction(r,e,t)}error(t,n){o.consoleAction(e,t,n)}getLogLevel(){return+((localStorage?localStorage.getItem(this.storageName):0)||0)}shouldShowLog(i){if(!o.isEnabled)return!1;const s=o.getLogLevel();switch(i){case e:return s>=1;case t:return s>=2;case n:return s>=3;case r:return s>=4}}getTypeInfo(i){const s=o.product.toUpperCase();return{[e]:{tag:`[${s}-ERROR]`,color:"#c92e2c"},[t]:{tag:`[${s}-WARNING]`,color:"#ffdf5a",additionalStyle:"color: black;"},[n]:{tag:`[${s}-INFO]`,color:"#1078b5"},[r]:{tag:`[${s}-EXTRA-INFO]`,color:"#41B510FF"}}[i]}consoleAction(e,t,n){if(!o.shouldShowLog(e))return;n||(n=i.getCallerFunctionName()+":");const{tag:r,color:s,additionalStyle:a}=o.getTypeInfo(e),c=i.getStyle(s,a);console[e]("%c "+r,c,""+(n||""),t)}}const o=new i("NMG",!0);return o})(),coreUtils=(()=>{const e=function(){const e=function(){var e=e||function(e){var t,n,r,i,o,s,a,c,l,d,u,f,p;if("undefined"!=typeof window&&window.crypto&&(t=window.crypto),"undefined"!=typeof self&&self.crypto&&(t=self.crypto),"undefined"!=typeof globalThis&&globalThis.crypto&&(t=globalThis.crypto),!t&&"undefined"!=typeof window&&window.msCrypto&&(t=window.msCrypto),!t&&"undefined"!=typeof global&&global.crypto&&(t=global.crypto),!t&&"function"==typeof require)try{t=require("crypto")}catch(e){}return n=function(){if(t){if("function"==typeof t.getRandomValues)try{return t.getRandomValues(new Uint32Array(1))[0]}catch(e){}if("function"==typeof t.randomBytes)try{return t.randomBytes(4).readInt32LE()}catch(e){}}throw Error("Native crypto module could not be used to get secure random number.")},r=Object.create||function(){function e(){}return function(t){var n;return e.prototype=t,n=new e,e.prototype=null,n}}(),o=(i={}).lib={},s=o.Base={extend:function(e){var t=r(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},a=o.WordArray=s.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||l).stringify(this)},concat:function(e){var t,n,r,i=this.words,o=e.words,s=this.sigBytes,a=e.sigBytes;if(this.clamp(),s%4)for(t=0;a>t;t++)n=o[t>>>2]>>>24-t%4*8&255,i[s+t>>>2]|=n<<24-(s+t)%4*8;else for(r=0;a>r;r+=4)i[s+r>>>2]=o[r>>>2];return this.sigBytes+=a,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-n%4*8,t.length=e.ceil(n/4)},clone:function(){var e=s.clone.call(this);return e.words=this.words.slice(0),e},random:function(e){var t,r=[];for(t=0;e>t;t+=4)r.push(n());return new a.init(r,e)}}),c=i.enc={},l=c.Hex={stringify:function(e){var t,n,r=e.words,i=e.sigBytes,o=[];for(t=0;i>t;t++)n=r[t>>>2]>>>24-t%4*8&255,o.push((n>>>4).toString(16)),o.push((15&n).toString(16));return o.join("")},parse:function(e){var t,n=e.length,r=[];for(t=0;n>t;t+=2)r[t>>>3]|=parseInt(e.substr(t,2),16)<<24-t%8*4;return new a.init(r,n/2)}},d=c.Latin1={stringify:function(e){var t,n,r=e.words,i=e.sigBytes,o=[];for(t=0;i>t;t++)n=r[t>>>2]>>>24-t%4*8&255,o.push(String.fromCharCode(n));return o.join("")},parse:function(e){var t,n=e.length,r=[];for(t=0;n>t;t++)r[t>>>2]|=(255&e.charCodeAt(t))<<24-t%4*8;return new a.init(r,n)}},u=c.Utf8={stringify:function(e){try{return decodeURIComponent(escape(d.stringify(e)))}catch(e){throw Error("Malformed UTF-8 data")}},parse:function(e){return d.parse(unescape(encodeURIComponent(e)))}},f=o.BufferedBlockAlgorithm=s.extend({reset:function(){this._data=new a.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=u.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n,r,i,o,s=this._data,c=s.words,l=s.sigBytes,d=this.blockSize,u=l/(4*d);if(r=(u=t?e.ceil(u):e.max((0|u)-this._minBufferSize,0))*d,i=e.min(4*r,l),r){for(o=0;r>o;o+=d)this._doProcessBlock(c,o);n=c.splice(0,r),s.sigBytes-=i}return new a.init(n,i)},clone:function(){var e=s.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),o.Hasher=f.extend({cfg:s.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){f.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new p.HMAC.init(e,n).finalize(t)}}}),p=i.algo={},i}(Math);return e}();return function(t){var n,r,i=e,o=i.lib,s=o.WordArray,a=o.Hasher,c=i.algo,l=[],d=[];!function(){function e(e){var n,r=t.sqrt(e);for(n=2;r>=n;n++)if(!(e%n))return!1;return!0}function n(e){return 4294967296*(e-(0|e))|0}for(var r=2,i=0;64>i;)e(r)&&(8>i&&(l[i]=n(t.pow(r,.5))),d[i]=n(t.pow(r,1/3)),i++),r++}(),n=[],r=c.SHA256=a.extend({_doReset:function(){this._hash=new s.init(l.slice(0))},_doProcessBlock:function(e,t){var r,i,o,s,a,c,l,u,f=this._hash.words,p=f[0],g=f[1],h=f[2],m=f[3],y=f[4],b=f[5],v=f[6],w=f[7];for(r=0;64>r;r++)16>r?n[r]=0|e[t+r]:(o=((i=n[r-15])<<25|i>>>7)^(i<<14|i>>>18)^i>>>3,a=((s=n[r-2])<<15|s>>>17)^(s<<13|s>>>19)^s>>>10,n[r]=o+n[r-7]+a+n[r-16]),c=p&g^p&h^g&h,l=(p<<30|p>>>2)^(p<<19|p>>>13)^(p<<10|p>>>22),u=w+((y<<26|y>>>6)^(y<<21|y>>>11)^(y<<7|y>>>25))+(y&b^~y&v)+d[r]+n[r],w=v,v=b,b=y,y=m+u|0,m=h,h=g,g=p,p=u+(l+c)|0;f[0]=f[0]+p|0,f[1]=f[1]+g|0,f[2]=f[2]+h|0,f[3]=f[3]+m|0,f[4]=f[4]+y|0,f[5]=f[5]+b|0,f[6]=f[6]+v|0,f[7]=f[7]+w|0},_doFinalize:function(){var e=this._data,n=e.words,r=8*this._nDataBytes,i=8*e.sigBytes;return n[i>>>5]|=128<<24-i%32,n[14+(i+64>>>9<<4)]=t.floor(r/4294967296),n[15+(i+64>>>9<<4)]=r,e.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var e=a.clone.call(this);return e._hash=this._hash.clone(),e}}),i.SHA256=a._createHelper(r),i.HmacSHA256=a._createHmacHelper(r)}(Math),e.SHA256}(),t=function(){"use strict";function e(e,t){t.push(255&e)}function t(e,t){t.push(255&e),t.push(e>>>8)}function n(e,n){t(65535&e,n),t(e>>>16,n)}var r=function(){function e(n,r){var i,o,s;if(void 0!==e.crc&&r&&n||(e.crc=-1,n)){for(i=e.crc,o=0,s=n.length;s>o;o+=1)i=i>>>8^t[255&(i^n[o])];return e.crc=i,~i}}var t=[],n=3988292384;return function(){var e,r,i;for(r=0;256>r;r+=1){for(e=r,i=0;8>i;i+=1)1&e?e=n^e>>>1:e>>>=1;t[r]=e>>>0}}(),function(t,r){var i;return t="string"==typeof t?(i=t,[].map.call(i,(function(e){return e.charCodeAt(0)}))):t,((r?function(e){var t,r,i,o,s=-1;for(t=0,i=e.length;i>t;t+=1){for(o=255&(s^e[t]),r=0;8>r;r+=1)1&~o?o>>>=1:o=o>>>1^n;s=s>>>8^o}return~s}(t):e(t))>>>0).toString(16)}}(),i=function(){function e(){this.fc=0,this.dl=0}function t(){this.dyn_tree=null,this.static_tree=null,this.extra_bits=null,this.extra_base=0,this.elems=0,this.max_length=0,this.max_code=0}function n(e,t,n,r){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=r}function r(){this.next=null,this.len=0,this.ptr=[],this.off=0}function i(e){e.next=D,D=e}function o(e){return F[Ne+e]}function s(e,t){return F[Ne+e]=t}function a(e){mt[L+I++]=e,L+I===ze&&function(){var e,t,n;if(0!==I){for(null!==D?(n=D,D=D.next):n=new r,n.next=null,n.len=n.off=0,e=n,null===_?_=B=e:B=B.next=e,e.len=I-L,t=0;t<e.len;t++)e.ptr[t]=mt[L+t];I=L=0}}()}function c(e){e&=65535,ze-2>L+I?(mt[L+I++]=255&e,mt[L+I++]=e>>>8):(a(255&e),a(e>>>8))}function l(){G=(G<<ht^255&P[X+$e-1])&Xe,$=o(G),F[X&Qe]=$,s(G,X)}function d(e,t){O(t[e].fc,t[e].dl)}function u(e){return 255&(256>e?ve[e]:ve[256+(e>>7)])}function f(e,t,n){return e[t].fc<e[n].fc||e[t].fc===e[n].fc&&ye[t]<=ye[n]}function p(e,t,n){var r;for(r=0;n>r&&_e<De.length;r++)e[t+r]=255&De[_e++];return r}function g(e){var t,n,r,i,o=ee,s=X,a=J,c=X>tt?X-tt:Ye,l=X+qe,d=P[s+a-1],u=P[s+a];re>J||(o>>=2);do{if(P[(t=e)+a]===u&&P[t+a-1]===d&&P[t]===P[s]&&P[++t]===P[s+1]){for(s+=2,t++;l>s;){for(i=!1,r=0;8>r;r+=1)if(t+=1,P[s+=1]!==P[t]){i=!0;break}if(i)break}if(n=qe-(l-s),s=l-qe,n>a){if(Q=e,a=n,We){if(n>=qe)break}else if(n>=ie)break;d=P[s+a-1],u=P[s+a]}}}while((e=F[e&Qe])>c&&0!=--o);return a}function h(){var e,t,n=Ge-Z-X;if(-1===n)n--;else if(X>=Ne+tt){for(e=0;Ne>e;e++)P[e]=P[e+Ne];for(Q-=Ne,X-=Ne,z-=Ne,e=0;Je>e;e++)t=o(e),s(e,Ne>t?Ye:t-Ne);for(e=0;Ne>e;e++)t=F[e],F[e]=Ne>t?Ye:t-Ne;n+=Ne}Y||((e=p(P,X+Z,n))>0?Z+=e:Y=!0)}function m(e,t,n){var r;return M||(Y||(H=0,W=0,function(){var e,t,n,r,i;if(0===ce[0].dl){for(de.dyn_tree=oe,de.static_tree=ae,de.extra_bits=Be,de.extra_base=st+1,de.elems=ct,de.max_length=rt,de.max_code=0,ue.dyn_tree=se,ue.static_tree=ce,ue.extra_bits=Me,ue.extra_base=0,ue.elems=lt,ue.max_length=rt,ue.max_code=0,fe.dyn_tree=le,fe.static_tree=null,fe.extra_bits=Ie,fe.extra_base=0,fe.elems=dt,fe.max_length=it,fe.max_code=0,n=0,r=0;ot-1>r;r++)for(we[r]=n,e=0;e<1<<Be[r];e++)be[n++]=r;for(be[n-1]=r,i=0,r=0;16>r;r++)for(Se[r]=i,e=0;e<1<<Me[r];e++)ve[i++]=r;for(i>>=7;lt>r;r++)for(Se[r]=i<<7,e=0;e<1<<Me[r]-7;e++)ve[256+i++]=r;for(t=0;rt>=t;t++)pe[t]=0;for(e=0;143>=e;)ae[e++].dl=8,pe[8]++;for(;255>=e;)ae[e++].dl=9,pe[9]++;for(;279>=e;)ae[e++].dl=7,pe[7]++;for(;287>=e;)ae[e++].dl=8,pe[8]++;for(w(ae,ct+1),e=0;lt>e;e++)ce[e].dl=5,ce[e].fc=x(e,5);b()}}(),function(){var e;for(e=0;Je>e;e++)F[Ne+e]=0;if(te=Ue[ne].max_lazy,re=Ue[ne].good_length,We||(ie=Ue[ne].nice_length),ee=Ue[ne].max_chain,X=0,z=0,0>=(Z=p(P,0,2*Ne)))return Y=!0,void(Z=0);for(Y=!1;et>Z&&!Y;)h();for(G=0,e=0;$e-1>e;e++)G=(G<<ht^255&P[e])&Xe}(),_=null,I=0,L=0,ne>3?(V=$e-1,K=!1):(J=$e-1,V=0),U=!1),M=!0,0!==Z)?(r=y(e,t,n))===n?n:U?r:(ne>3?function(){for(;0!==Z&&null===_;){if(l(),J=V,q=Q,V=$e-1,$!==Ye&&te>J&&tt>=X-$&&((V=g($))>Z&&(V=Z),V===$e&&X-Q>Ze&&V--),$e>J||V>J)K?(E(0,255&P[X-1])&&(T(0),z=X),X++,Z--):(K=!0,X++,Z--);else{var e;e=E(X-1-q,J-$e),Z-=J-1,J-=2;do{X++,l()}while(0!=--J);K=!1,V=$e-1,X++,e&&(T(0),z=X)}for(;et>Z&&!Y;)h()}}():function(){for(;0!==Z&&null===_;){var e;if(l(),$===Ye||X-$>tt||(V=g($))>Z&&(V=Z),$e>V)e=E(0,255&P[X]),Z--,X++;else if(e=E(X-Q,V-$e),Z-=V,V>te)X+=V,V=0,G=((G=255&P[X])<<ht^255&P[X+1])&Xe;else{V--;do{X++,l()}while(0!=--V);X++}for(e&&(T(0),z=X);et>Z&&!Y;)h()}}(),0===Z&&(K&&E(0,255&P[X-1]),T(1),U=!0),r+y(e,r+t,n-r)):(U=!0,0)}function y(e,t,n){for(var r,o,s,a=0;null!==_&&n>a;){for((r=n-a)>_.len&&(r=_.len),o=0;r>o;o++)e[t+a+o]=_.ptr[_.off+o];_.off+=r,_.len-=r,a+=r,0===_.len&&(s=_,_=_.next,i(s))}if(a===n)return a;if(I>L){for((r=n-a)>I-L&&(r=I-L),o=0;r>o;o++)e[t+a+o]=mt[L+o];a+=r,I===(L+=r)&&(I=L=0)}return a}function b(){var e;for(e=0;ct>e;e++)oe[e].fc=0;for(e=0;lt>e;e++)se[e].fc=0;for(e=0;dt>e;e++)le[e].fc=0;oe[at].fc=1,xe=Re=0,Ce=Te=Ee=0,Ae=0,Oe=1}function v(e,t){for(var n=ge[t],r=t<<1;he>=r&&(he>r&&f(e,ge[r+1],ge[r])&&r++,!f(e,n,ge[r]));)ge[t]=ge[r],t=r,r<<=1;ge[t]=n}function w(e,t){var n,r,i,o=[],s=0;for(n=1;rt>=n;n++)s=s+pe[n-1]<<1,o[n]=s;for(r=0;t>=r;r++)0!==(i=e[r].dl)&&(e[r].fc=x(o[i]++,i))}function S(e){var t,n,r,i=e.dyn_tree,o=e.static_tree,s=e.elems,a=-1,c=s;for(he=0,me=gt,t=0;s>t;t++)0!==i[t].fc?(ge[++he]=a=t,ye[t]=0):i[t].dl=0;for(;2>he;)i[r=ge[++he]=2>a?++a:0].fc=1,ye[r]=0,xe--,null!==o&&(Re-=o[r].dl);for(e.max_code=a,t=he>>1;t>=1;t--)v(i,t);do{t=ge[nt],ge[nt]=ge[he--],v(i,nt),n=ge[nt],ge[--me]=t,ge[--me]=n,i[c].fc=i[t].fc+i[n].fc,ye[t]>ye[n]+1?ye[c]=ye[t]:ye[c]=ye[n]+1,i[t].dl=i[n].dl=c,ge[nt]=c++,v(i,nt)}while(he>=2);ge[--me]=ge[nt],function(e){var t,n,r,i,o,s,a=e.dyn_tree,c=e.extra_bits,l=e.extra_base,d=e.max_code,u=e.max_length,f=e.static_tree,p=0;for(i=0;rt>=i;i++)pe[i]=0;for(a[ge[me]].dl=0,t=me+1;gt>t;t++)(i=a[a[n=ge[t]].dl].dl+1)>u&&(i=u,p++),a[n].dl=i,n>d||(pe[i]++,o=0,l>n||(o=c[n-l]),s=a[n].fc,xe+=s*(i+o),null!==f&&(Re+=s*(f[n].dl+o)));if(0!==p){do{for(i=u-1;0===pe[i];)i--;pe[i]--,pe[i+1]+=2,pe[u]--,p-=2}while(p>0);for(i=u;0!==i;i--)for(n=pe[i];0!==n;)d<(r=ge[--t])||(a[r].dl!==i&&(xe+=(i-a[r].dl)*a[r].fc,a[r].fc=i),n--)}}(e),w(i,a)}function k(e,t){var n,r,i=-1,o=e[0].dl,s=0,a=7,c=4;for(0===o&&(a=138,c=3),e[t+1].dl=65535,n=0;t>=n;n++)r=o,o=e[n+1].dl,++s<a&&r===o||(c>s?le[r].fc+=s:0!==r?(r!==i&&le[r].fc++,le[ut].fc++):s>10?le[pt].fc++:le[ft].fc++,s=0,i=r,0===o?(a=138,c=3):r===o?(a=6,c=3):(a=7,c=4))}function C(e,t){var n,r,i=-1,o=e[0].dl,s=0,a=7,c=4;for(0===o&&(a=138,c=3),n=0;t>=n;n++)if(r=o,o=e[n+1].dl,++s>=a||r!==o){if(c>s)do{d(r,le)}while(0!=--s);else 0!==r?(r!==i&&(d(r,le),s--),d(ut,le),O(s-3,2)):s>10?(d(pt,le),O(s-11,7)):(d(ft,le),O(s-3,3));s=0,i=r,0===o?(a=138,c=3):r===o?(a=6,c=3):(a=7,c=4)}}function T(e){var t,n,r,i,o;if(i=X-z,ke[Ee]=Ae,S(de),S(ue),r=function(){var e;for(k(oe,de.max_code),k(se,ue.max_code),S(fe),e=dt-1;e>=3&&0===le[Le[e]].dl;e--);return xe+=14+3*(e+1),e}(),(n=Re+3+7>>3)>(t=xe+3+7>>3)||(t=n),i+4>t||0>z)n===t?(O((Fe<<1)+e,3),A(ae,ce)):(O((He<<1)+e,3),function(e,t,n){var r;for(O(e-257,5),O(t-1,5),O(n-4,4),r=0;n>r;r++)O(le[Le[r]].dl,3);C(oe,e-1),C(se,t-1)}(de.max_code+1,ue.max_code+1,r+1),A(oe,se));else for(O((je<<1)+e,3),R(),c(i),c(~i),o=0;i>o;o++)a(P[z+o]);b(),0!==e&&R()}function E(e,t){var n,r,i;if(j[Ce++]=t,0===e?oe[t].fc++:(e--,oe[be[t]+st+1].fc++,se[u(e)].fc++,N[Te++]=e,Ae|=Oe),Oe<<=1,7&Ce||(ke[Ee++]=Ae,Ae=0,Oe=1),ne>2&&!(4095&Ce)){for(n=8*Ce,r=X-z,i=0;lt>i;i++)n+=se[i].fc*(5+Me[i]);if(n>>=3,parseInt(Ce/2,10)>Te&&parseInt(r/2,10)>n)return!0}return Ce===Ke-1||Te===Ve}function A(e,t){var n,r,i,o,s=0,a=0,c=0,l=0;if(0!==Ce)do{7&s||(l=ke[c++]),r=255&j[s++],1&l?(d((i=be[r])+st+1,e),0!==(o=Be[i])&&O(r-=we[i],o),d(i=u(n=N[a++]),t),0!==(o=Me[i])&&O(n-=Se[i],o)):d(r,e),l>>=1}while(Ce>s);d(at,e)}function O(e,t){W>Pe-t?(c(H|=e<<W),H=e>>Pe-W,W+=t-Pe):(H|=e<<W,W+=t)}function x(e,t){var n=0;do{n|=1&e,e>>=1,n<<=1}while(--t>0);return n>>1}function R(){W>8?c(H):W>0&&a(H),H=0,W=0}var D,_,B,M,I,L,U,P,N,j,F,H,W,z,G,$,q,K,V,J,X,Q,Y,Z,ee,te,ne,re,ie,oe,se,ae,ce,le,de,ue,fe,pe,ge,he,me,ye,be,ve,we,Se,ke,Ce,Te,Ee,Ae,Oe,xe,Re,De,_e,Be,Me,Ie,Le,Ue,Pe,Ne=32768,je=0,Fe=1,He=2,We=!1,ze=8192,Ge=2*Ne,$e=3,qe=258,Ke=8192,Ve=Ke,Je=32768,Xe=Je-1,Qe=Ne-1,Ye=0,Ze=4096,et=qe+$e+1,tt=Ne-et,nt=1,rt=15,it=7,ot=29,st=256,at=256,ct=st+1+ot,lt=30,dt=19,ut=16,ft=17,pt=18,gt=2*ct+1,ht=parseInt((15+$e-1)/$e,10),mt=null;return Ke>32768&&console.error("error: INBUFSIZ is too small"),Ne<<1>65536&&console.error("error: WSIZE is too large"),258!==qe&&console.error("error: Code too clever"),Be=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],Me=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],Ie=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],Le=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Ue=[new n(0,0,0,0),new n(4,4,8,4),new n(4,5,16,8),new n(4,6,32,32),new n(4,4,16,16),new n(8,16,32,32),new n(8,16,128,128),new n(8,32,128,256),new n(32,128,258,1024),new n(32,258,258,4096)],Pe=16,{deflate:function(n,r){var i,o;De=n,_e=0,void 0===r&&(r=6),function(n){var r;if(n?1>n?n=1:n>9&&(n=9):n=6,ne=n,M=!1,Y=!1,null===mt){for(D=_=B=null,mt=[],P=[],N=[],j=[],F=[],oe=[],r=0;gt>r;r++)oe[r]=new e;for(se=[],r=0;2*lt+1>r;r++)se[r]=new e;for(ae=[],r=0;ct+2>r;r++)ae[r]=new e;for(ce=[],r=0;lt>r;r++)ce[r]=new e;for(le=[],r=0;2*dt+1>r;r++)le[r]=new e;de=new t,ue=new t,fe=new t,pe=[],ge=[],ye=[],be=[],ve=[],we=[],Se=[],ke=[]}}(r),o=[];do{i=m(o,o.length,1024)}while(i>0);return De=null,o}}}();return{zip:function(t,o){var s,a=0,c=[];return o||(o={}),s=o.level||6,"string"==typeof t&&(t=[].map.call(t,(function(e){return e.charCodeAt(0)}))),e(31,c),e(139,c),e(8,c),o.name&&(a|=8),e(a,c),n(o.timestamp||parseInt(Date.now()/1e3,10),c),e(1===s?4:9===s?2:0,c),e(3,c),o.name&&(function(t,n){var r,i=t.length;for(r=0;i>r;r+=1)e(t.charCodeAt(r),n)}(o.name.substring(o.name.lastIndexOf("/")+1),c),e(0,c)),i.deflate(t,s).forEach((function(t){e(t,c)})),n(parseInt(r(t),16),c),n(t.length,c),c}}}(),n=function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:r})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){var r,i;if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;if(r=Object.create(null),t.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(i in e)t.d(r,i,function(t){return e[t]}.bind(null,i));return r},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return{}.hasOwnProperty.call(e,t)},t.p="",t(t.s=90)}({17:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var r=n(18),i=function(){function e(){}return e.getFirstMatch=function(e,t){var n=t.match(e);return n&&n.length>0&&n[1]||""},e.getSecondMatch=function(e,t){var n=t.match(e);return n&&n.length>1&&n[2]||""},e.matchAndReturnConst=function(e,t,n){if(e.test(t))return n},e.getWindowsVersionName=function(e){switch(e){case"NT":return"NT";case"XP":case"NT 5.1":return"XP";case"NT 5.0":return"2000";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}},e.getMacOSVersionName=function(e){var t=e.split(".").splice(0,2).map((function(e){return parseInt(e,10)||0}));if(t.push(0),10===t[0])switch(t[1]){case 5:return"Leopard";case 6:return"Snow Leopard";case 7:return"Lion";case 8:return"Mountain Lion";case 9:return"Mavericks";case 10:return"Yosemite";case 11:return"El Capitan";case 12:return"Sierra";case 13:return"High Sierra";case 14:return"Mojave";case 15:return"Catalina";default:return}},e.getAndroidVersionName=function(e){var t=e.split(".").splice(0,2).map((function(e){return parseInt(e,10)||0}));if(t.push(0),1!==t[0]||t[1]>=5)return 1===t[0]&&6>t[1]?"Cupcake":1!==t[0]||6>t[1]?2===t[0]&&2>t[1]?"Eclair":2===t[0]&&2===t[1]?"Froyo":2===t[0]&&t[1]>2?"Gingerbread":3===t[0]?"Honeycomb":4===t[0]&&1>t[1]?"Ice Cream Sandwich":4===t[0]&&4>t[1]?"Jelly Bean":4!==t[0]||4>t[1]?5===t[0]?"Lollipop":6===t[0]?"Marshmallow":7===t[0]?"Nougat":8===t[0]?"Oreo":9===t[0]?"Pie":void 0:"KitKat":"Donut"},e.getVersionPrecision=function(e){return e.split(".").length},e.compareVersions=function(t,n,r){void 0===r&&(r=!1);var i=e.getVersionPrecision(t),o=e.getVersionPrecision(n),s=Math.max(i,o),a=0,c=e.map([t,n],(function(t){var n=s-e.getVersionPrecision(t),r=t+Array(n+1).join(".0");return e.map(r.split("."),(function(e){return Array(20-e.length).join("0")+e})).reverse()}));for(r&&(a=s-Math.min(i,o)),s-=1;s>=a;){if(c[0][s]>c[1][s])return 1;if(c[0][s]===c[1][s]){if(s===a)return 0;s-=1}else if(c[0][s]<c[1][s])return-1}},e.map=function(e,t){var n,r=[];if([].map)return[].map.call(e,t);for(n=0;n<e.length;n+=1)r.push(t(e[n]));return r},e.find=function(e,t){var n,r,i;if([].find)return[].find.call(e,t);for(n=0,r=e.length;r>n;n+=1)if(t(i=e[n],n))return i},e.assign=function(e){var t,n,r,i,o,s,a;for(r=e,o=Array((i=arguments.length)>1?i-1:0),s=1;i>s;s++)o[s-1]=arguments[s];if(Object.assign)return Object.assign.apply(Object,[e].concat(o));for(a=function(){var e=o[t];"object"==typeof e&&null!==e&&Object.keys(e).forEach((function(t){r[t]=e[t]}))},t=0,n=o.length;n>t;t+=1)a();return e},e.getBrowserAlias=function(e){return r.BROWSER_ALIASES_MAP[e]},e.getBrowserTypeByAlias=function(e){return r.BROWSER_MAP[e]||""},e}();t.default=i,e.exports=t.default},18:function(e,t){"use strict";t.__esModule=!0,t.ENGINE_MAP=t.OS_MAP=t.PLATFORMS_MAP=t.BROWSER_MAP=t.BROWSER_ALIASES_MAP=void 0,t.BROWSER_ALIASES_MAP={"Amazon Silk":"amazon_silk","Android Browser":"android",Bada:"bada",BlackBerry:"blackberry",Chrome:"chrome",Chromium:"chromium",Electron:"electron",Epiphany:"epiphany",Firefox:"firefox",Focus:"focus",Generic:"generic","Google Search":"google_search",Googlebot:"googlebot","Internet Explorer":"ie","K-Meleon":"k_meleon",Maxthon:"maxthon","Microsoft Edge":"edge","MZ Browser":"mz","NAVER Whale Browser":"naver",Opera:"opera","Opera Coast":"opera_coast",PhantomJS:"phantomjs",Puffin:"puffin",QupZilla:"qupzilla",QQ:"qq",QQLite:"qqlite",Safari:"safari",Sailfish:"sailfish","Samsung Internet for Android":"samsung_internet",SeaMonkey:"seamonkey",Sleipnir:"sleipnir",Swing:"swing",Tizen:"tizen","UC Browser":"uc",Vivaldi:"vivaldi","WebOS Browser":"webos",WeChat:"wechat","Yandex Browser":"yandex",Roku:"roku"},t.BROWSER_MAP={amazon_silk:"Amazon Silk",android:"Android Browser",bada:"Bada",blackberry:"BlackBerry",chrome:"Chrome",chromium:"Chromium",electron:"Electron",epiphany:"Epiphany",firefox:"Firefox",focus:"Focus",generic:"Generic",googlebot:"Googlebot",google_search:"Google Search",ie:"Internet Explorer",k_meleon:"K-Meleon",maxthon:"Maxthon",edge:"Microsoft Edge",mz:"MZ Browser",naver:"NAVER Whale Browser",opera:"Opera",opera_coast:"Opera Coast",phantomjs:"PhantomJS",puffin:"Puffin",qupzilla:"QupZilla",qq:"QQ Browser",qqlite:"QQ Browser Lite",safari:"Safari",sailfish:"Sailfish",samsung_internet:"Samsung Internet for Android",seamonkey:"SeaMonkey",sleipnir:"Sleipnir",swing:"Swing",tizen:"Tizen",uc:"UC Browser",vivaldi:"Vivaldi",webos:"WebOS Browser",wechat:"WeChat",yandex:"Yandex Browser"},t.PLATFORMS_MAP={tablet:"tablet",mobile:"mobile",desktop:"desktop",tv:"tv"},t.OS_MAP={WindowsPhone:"Windows Phone",Windows:"Windows",MacOS:"macOS",iOS:"iOS",Android:"Android",WebOS:"WebOS",BlackBerry:"BlackBerry",Bada:"Bada",Tizen:"Tizen",Linux:"Linux",ChromeOS:"Chrome OS",PlayStation4:"PlayStation 4",Roku:"Roku"},t.ENGINE_MAP={EdgeHTML:"EdgeHTML",Blink:"Blink",Trident:"Trident",Presto:"Presto",Gecko:"Gecko",WebKit:"WebKit"}},90:function(e,t,n){"use strict";var r,i,o,s;t.__esModule=!0,t.default=void 0,i=(r=n(91))&&r.__esModule?r:{default:r},o=n(18),s=function(){function e(){}var t;return e.getParser=function(e,t){if(void 0===t&&(t=!1),"string"!=typeof e)throw Error("UserAgent should be a string");return new i.default(e,t)},e.parse=function(e){return new i.default(e).getResult()},(t=[{key:"BROWSER_MAP",get:function(){return o.BROWSER_MAP}},{key:"ENGINE_MAP",get:function(){return o.ENGINE_MAP}},{key:"OS_MAP",get:function(){return o.OS_MAP}},{key:"PLATFORMS_MAP",get:function(){return o.PLATFORMS_MAP}}])&&function(e,t){var n,r;for(n=0;t.length>n;n++)(r=t[n]).enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}(e,t),e}(),t.default=s,e.exports=t.default},91:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}var i,o,s,a,c,l;t.__esModule=!0,t.default=void 0,i=r(n(92)),o=r(n(93)),s=r(n(94)),a=r(n(95)),c=r(n(17)),l=function(){function e(e,t){if(void 0===t&&(t=!1),null==e||""===e)throw Error("UserAgent parameter can't be empty");this._ua=e,this.parsedResult={},!0!==t&&this.parse()}var t=e.prototype;return t.getUA=function(){return this._ua},t.test=function(e){return e.test(this._ua)},t.parseBrowser=function(){var e,t=this;return this.parsedResult.browser={},(e=c.default.find(i.default,(function(e){if("function"==typeof e.test)return e.test(t);if(e.test instanceof Array)return e.test.some((function(e){return t.test(e)}));throw Error("Browser's test function is not valid")})))&&(this.parsedResult.browser=e.describe(this.getUA())),this.parsedResult.browser},t.getBrowser=function(){return this.parsedResult.browser?this.parsedResult.browser:this.parseBrowser()},t.getBrowserName=function(e){return e?(this.getBrowser().name+"").toLowerCase()||"":this.getBrowser().name||""},t.getBrowserVersion=function(){return this.getBrowser().version},t.getOS=function(){return this.parsedResult.os?this.parsedResult.os:this.parseOS()},t.parseOS=function(){var e,t=this;return this.parsedResult.os={},(e=c.default.find(o.default,(function(e){if("function"==typeof e.test)return e.test(t);if(e.test instanceof Array)return e.test.some((function(e){return t.test(e)}));throw Error("Browser's test function is not valid")})))&&(this.parsedResult.os=e.describe(this.getUA())),this.parsedResult.os},t.getOSName=function(e){var t=this.getOS().name;return e?(t+"").toLowerCase()||"":t||""},t.getOSVersion=function(){return this.getOS().version},t.getPlatform=function(){return this.parsedResult.platform?this.parsedResult.platform:this.parsePlatform()},t.getPlatformType=function(e){void 0===e&&(e=!1);var t=this.getPlatform().type;return e?(t+"").toLowerCase()||"":t||""},t.parsePlatform=function(){var e,t=this;return this.parsedResult.platform={},(e=c.default.find(s.default,(function(e){if("function"==typeof e.test)return e.test(t);if(e.test instanceof Array)return e.test.some((function(e){return t.test(e)}));throw Error("Browser's test function is not valid")})))&&(this.parsedResult.platform=e.describe(this.getUA())),this.parsedResult.platform},t.getEngine=function(){return this.parsedResult.engine?this.parsedResult.engine:this.parseEngine()},t.getEngineName=function(e){return e?(this.getEngine().name+"").toLowerCase()||"":this.getEngine().name||""},t.parseEngine=function(){var e,t=this;return this.parsedResult.engine={},(e=c.default.find(a.default,(function(e){if("function"==typeof e.test)return e.test(t);if(e.test instanceof Array)return e.test.some((function(e){return t.test(e)}));throw Error("Browser's test function is not valid")})))&&(this.parsedResult.engine=e.describe(this.getUA())),this.parsedResult.engine},t.parse=function(){return this.parseBrowser(),this.parseOS(),this.parsePlatform(),this.parseEngine(),this},t.getResult=function(){return c.default.assign({},this.parsedResult)},t.satisfies=function(e){var t,n,r,i,o,s,a,l=this,d={},u=0,f={},p=0;if(Object.keys(e).forEach((function(t){var n=e[t];"string"==typeof n?(f[t]=n,p+=1):"object"==typeof n&&(d[t]=n,u+=1)})),u>0){if(t=Object.keys(d),n=c.default.find(t,(function(e){return l.isOS(e)})),n&&void 0!==(r=this.satisfies(d[n])))return r;if(i=c.default.find(t,(function(e){return l.isPlatform(e)})),i&&void 0!==(o=this.satisfies(d[i])))return o}if(p>0&&(s=Object.keys(f),a=c.default.find(s,(function(e){return l.isBrowser(e,!0)})),void 0!==a))return this.compareVersion(f[a])},t.isBrowser=function(e,t){void 0===t&&(t=!1);var n=this.getBrowserName().toLowerCase(),r=e.toLowerCase(),i=c.default.getBrowserTypeByAlias(r);return t&&i&&(r=i.toLowerCase()),r===n},t.compareVersion=function(e){var t=[0],n=e,r=!1,i=this.getBrowserVersion();if("string"==typeof i)return">"===e[0]||"<"===e[0]?(n=e.substr(1),"="===e[1]?(r=!0,n=e.substr(2)):t=[],">"===e[0]?t.push(1):t.push(-1)):"="===e[0]?n=e.substr(1):"~"===e[0]&&(r=!0,n=e.substr(1)),t.indexOf(c.default.compareVersions(i,n,r))>-1},t.isOS=function(e){return this.getOSName(!0)===(e+"").toLowerCase()},t.isPlatform=function(e){return this.getPlatformType(!0)===(e+"").toLowerCase()},t.isEngine=function(e){return this.getEngineName(!0)===(e+"").toLowerCase()},t.is=function(e,t){return void 0===t&&(t=!1),this.isBrowser(e,t)||this.isOS(e)||this.isPlatform(e)},t.some=function(e){var t=this;return void 0===e&&(e=[]),e.some((function(e){return t.is(e)}))},e}(),t.default=l,e.exports=t.default},92:function(e,t,n){"use strict";var r,i,o,s;t.__esModule=!0,t.default=void 0,i=(r=n(17))&&r.__esModule?r:{default:r},o=/version\/(\d+(\.?_?\d+)+)/i,s=[{test:[/googlebot/i],describe:function(e){var t={name:"Googlebot"},n=i.default.getFirstMatch(/googlebot\/(\d+(\.\d+))/i,e)||i.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/opera/i],describe:function(e){var t={name:"Opera"},n=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/opr\/|opios/i],describe:function(e){var t={name:"Opera"},n=i.default.getFirstMatch(/(?:opr|opios)[\s/](\S+)/i,e)||i.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/SamsungBrowser/i],describe:function(e){var t={name:"Samsung Internet for Android"},n=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/Whale/i],describe:function(e){var t={name:"NAVER Whale Browser"},n=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:whale)[\s/](\d+(?:\.\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/MZBrowser/i],describe:function(e){var t={name:"MZ Browser"},n=i.default.getFirstMatch(/(?:MZBrowser)[\s/](\d+(?:\.\d+)+)/i,e)||i.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/focus/i],describe:function(e){var t={name:"Focus"},n=i.default.getFirstMatch(/(?:focus)[\s/](\d+(?:\.\d+)+)/i,e)||i.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/swing/i],describe:function(e){var t={name:"Swing"},n=i.default.getFirstMatch(/(?:swing)[\s/](\d+(?:\.\d+)+)/i,e)||i.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/coast/i],describe:function(e){var t={name:"Opera Coast"},n=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:coast)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/opt\/\d+(?:.?_?\d+)+/i],describe:function(e){var t={name:"Opera Touch"},n=i.default.getFirstMatch(/(?:opt)[\s/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/yabrowser/i],describe:function(e){var t={name:"Yandex Browser"},n=i.default.getFirstMatch(/(?:yabrowser)[\s/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/ucbrowser/i],describe:function(e){var t={name:"UC Browser"},n=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:ucbrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/Maxthon|mxios/i],describe:function(e){var t={name:"Maxthon"},n=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:Maxthon|mxios)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/epiphany/i],describe:function(e){var t={name:"Epiphany"},n=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:epiphany)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/puffin/i],describe:function(e){var t={name:"Puffin"},n=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:puffin)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/sleipnir/i],describe:function(e){var t={name:"Sleipnir"},n=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:sleipnir)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/k-meleon/i],describe:function(e){var t={name:"K-Meleon"},n=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:k-meleon)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/micromessenger/i],describe:function(e){var t={name:"WeChat"},n=i.default.getFirstMatch(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/qqbrowser/i],describe:function(e){var t={name:/qqbrowserlite/i.test(e)?"QQ Browser Lite":"QQ Browser"},n=i.default.getFirstMatch(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/msie|trident/i],describe:function(e){var t={name:"Internet Explorer"},n=i.default.getFirstMatch(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/\sedg\//i],describe:function(e){var t={name:"Microsoft Edge"},n=i.default.getFirstMatch(/\sedg\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/edg([ea]|ios)/i],describe:function(e){var t={name:"Microsoft Edge"},n=i.default.getSecondMatch(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/vivaldi/i],describe:function(e){var t={name:"Vivaldi"},n=i.default.getFirstMatch(/vivaldi\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/seamonkey/i],describe:function(e){var t={name:"SeaMonkey"},n=i.default.getFirstMatch(/seamonkey\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/sailfish/i],describe:function(e){var t={name:"Sailfish"},n=i.default.getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i,e);return n&&(t.version=n),t}},{test:[/silk/i],describe:function(e){var t={name:"Amazon Silk"},n=i.default.getFirstMatch(/silk\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/phantom/i],describe:function(e){var t={name:"PhantomJS"},n=i.default.getFirstMatch(/phantomjs\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/slimerjs/i],describe:function(e){var t={name:"SlimerJS"},n=i.default.getFirstMatch(/slimerjs\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(e){var t={name:"BlackBerry"},n=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/blackberry[\d]+\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/(web|hpw)[o0]s/i],describe:function(e){var t={name:"WebOS Browser"},n=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/w(?:eb)?[o0]sbrowser\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/bada/i],describe:function(e){var t={name:"Bada"},n=i.default.getFirstMatch(/dolfin\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/tizen/i],describe:function(e){var t={name:"Tizen"},n=i.default.getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/qupzilla/i],describe:function(e){var t={name:"QupZilla"},n=i.default.getFirstMatch(/(?:qupzilla)[\s/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/firefox|iceweasel|fxios/i],describe:function(e){var t={name:"Firefox"},n=i.default.getFirstMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/electron/i],describe:function(e){var t={name:"Electron"},n=i.default.getFirstMatch(/(?:electron)\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/MiuiBrowser/i],describe:function(e){var t={name:"Miui"},n=i.default.getFirstMatch(/(?:MiuiBrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/chromium/i],describe:function(e){var t={name:"Chromium"},n=i.default.getFirstMatch(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/chrome|crios|crmo/i],describe:function(e){var t={name:"Chrome"},n=i.default.getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/GSA/i],describe:function(e){var t={name:"Google Search"},n=i.default.getFirstMatch(/(?:GSA)\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:function(e){var t=!e.test(/like android/i),n=e.test(/android/i);return t&&n},describe:function(e){var t={name:"Android Browser"},n=i.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/playstation 4/i],describe:function(e){var t={name:"PlayStation 4"},n=i.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/safari|applewebkit/i],describe:function(e){var t={name:"Safari"},n=i.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/.*/i],describe:function(e){var t=-1!==e.search("\\(")?/^(.*)\/(.*)[ \t]\((.*)/:/^(.*)\/(.*) /;return{name:i.default.getFirstMatch(t,e),version:i.default.getSecondMatch(t,e)}}}],t.default=s,e.exports=t.default},93:function(e,t,n){"use strict";var r,i,o,s;t.__esModule=!0,t.default=void 0,i=(r=n(17))&&r.__esModule?r:{default:r},o=n(18),s=[{test:[/Roku\/DVP/],describe:function(e){var t=i.default.getFirstMatch(/Roku\/DVP-(\d+\.\d+)/i,e);return{name:o.OS_MAP.Roku,version:t}}},{test:[/windows phone/i],describe:function(e){var t=i.default.getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i,e);return{name:o.OS_MAP.WindowsPhone,version:t}}},{test:[/windows /i],describe:function(e){var t=i.default.getFirstMatch(/Windows ((NT|XP)( \d\d?.\d)?)/i,e),n=i.default.getWindowsVersionName(t);return{name:o.OS_MAP.Windows,version:t,versionName:n}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(e){var t={name:o.OS_MAP.iOS},n=i.default.getSecondMatch(/(Version\/)(\d[\d.]+)/,e);return n&&(t.version=n),t}},{test:[/macintosh/i],describe:function(e){var t=i.default.getFirstMatch(/mac os x (\d+(\.?_?\d+)+)/i,e).replace(/[_\s]/g,"."),n=i.default.getMacOSVersionName(t),r={name:o.OS_MAP.MacOS,version:t};return n&&(r.versionName=n),r}},{test:[/(ipod|iphone|ipad)/i],describe:function(e){var t=i.default.getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i,e).replace(/[_\s]/g,".");return{name:o.OS_MAP.iOS,version:t}}},{test:function(e){var t=!e.test(/like android/i),n=e.test(/android/i);return t&&n},describe:function(e){var t=i.default.getFirstMatch(/android[\s/-](\d+(\.\d+)*)/i,e),n=i.default.getAndroidVersionName(t),r={name:o.OS_MAP.Android,version:t};return n&&(r.versionName=n),r}},{test:[/(web|hpw)[o0]s/i],describe:function(e){var t=i.default.getFirstMatch(/(?:web|hpw)[o0]s\/(\d+(\.\d+)*)/i,e),n={name:o.OS_MAP.WebOS};return t&&t.length&&(n.version=t),n}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(e){var t=i.default.getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i,e)||i.default.getFirstMatch(/blackberry\d+\/(\d+([_\s]\d+)*)/i,e)||i.default.getFirstMatch(/\bbb(\d+)/i,e);return{name:o.OS_MAP.BlackBerry,version:t}}},{test:[/bada/i],describe:function(e){var t=i.default.getFirstMatch(/bada\/(\d+(\.\d+)*)/i,e);return{name:o.OS_MAP.Bada,version:t}}},{test:[/tizen/i],describe:function(e){var t=i.default.getFirstMatch(/tizen[/\s](\d+(\.\d+)*)/i,e);return{name:o.OS_MAP.Tizen,version:t}}},{test:[/linux/i],describe:function(){return{name:o.OS_MAP.Linux}}},{test:[/CrOS/],describe:function(){return{name:o.OS_MAP.ChromeOS}}},{test:[/PlayStation 4/],describe:function(e){var t=i.default.getFirstMatch(/PlayStation 4[/\s](\d+(\.\d+)*)/i,e);return{name:o.OS_MAP.PlayStation4,version:t}}}],t.default=s,e.exports=t.default},94:function(e,t,n){"use strict";var r,i,o,s;t.__esModule=!0,t.default=void 0,i=(r=n(17))&&r.__esModule?r:{default:r},o=n(18),s=[{test:[/googlebot/i],describe:function(){return{type:"bot",vendor:"Google"}}},{test:[/huawei/i],describe:function(e){var t=i.default.getFirstMatch(/(can-l01)/i,e)&&"Nova",n={type:o.PLATFORMS_MAP.mobile,vendor:"Huawei"};return t&&(n.model=t),n}},{test:[/nexus\s*(?:7|8|9|10).*/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Nexus"}}},{test:[/ipad/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/kftt build/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Amazon",model:"Kindle Fire HD 7"}}},{test:[/silk/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Amazon"}}},{test:[/tablet(?! pc)/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet}}},{test:function(e){var t=e.test(/ipod|iphone/i),n=e.test(/like (ipod|iphone)/i);return t&&!n},describe:function(e){var t=i.default.getFirstMatch(/(ipod|iphone)/i,e);return{type:o.PLATFORMS_MAP.mobile,vendor:"Apple",model:t}}},{test:[/nexus\s*[0-6].*/i,/galaxy nexus/i],describe:function(){return{type:o.PLATFORMS_MAP.mobile,vendor:"Nexus"}}},{test:[/[^-]mobi/i],describe:function(){return{type:o.PLATFORMS_MAP.mobile}}},{test:function(e){return"blackberry"===e.getBrowserName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.mobile,vendor:"BlackBerry"}}},{test:function(e){return"bada"===e.getBrowserName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.mobile}}},{test:function(e){return"windows phone"===e.getBrowserName()},describe:function(){return{type:o.PLATFORMS_MAP.mobile,vendor:"Microsoft"}}},{test:function(e){var t=+(e.getOSVersion()+"").split(".")[0];return"android"===e.getOSName(!0)&&t>=3},describe:function(){return{type:o.PLATFORMS_MAP.tablet}}},{test:function(e){return"android"===e.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.mobile}}},{test:function(e){return"macos"===e.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.desktop,vendor:"Apple"}}},{test:function(e){return"windows"===e.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.desktop}}},{test:function(e){return"linux"===e.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.desktop}}},{test:function(e){return"playstation 4"===e.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.tv}}},{test:function(e){return"roku"===e.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.tv}}}],t.default=s,e.exports=t.default},95:function(e,t,n){"use strict";var r,i,o,s;t.__esModule=!0,t.default=void 0,i=(r=n(17))&&r.__esModule?r:{default:r},o=n(18),s=[{test:function(e){return"microsoft edge"===e.getBrowserName(!0)},describe:function(e){if(/\sedg\//i.test(e))return{name:o.ENGINE_MAP.Blink};var t=i.default.getFirstMatch(/edge\/(\d+(\.?_?\d+)+)/i,e);return{name:o.ENGINE_MAP.EdgeHTML,version:t}}},{test:[/trident/i],describe:function(e){var t={name:o.ENGINE_MAP.Trident},n=i.default.getFirstMatch(/trident\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:function(e){return e.test(/presto/i)},describe:function(e){var t={name:o.ENGINE_MAP.Presto},n=i.default.getFirstMatch(/presto\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:function(e){var t=e.test(/gecko/i),n=e.test(/like gecko/i);return t&&!n},describe:function(e){var t={name:o.ENGINE_MAP.Gecko},n=i.default.getFirstMatch(/gecko\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/(apple)?webkit\/537\.36/i],describe:function(){return{name:o.ENGINE_MAP.Blink}}},{test:[/(apple)?webkit/i],describe:function(e){var t={name:o.ENGINE_MAP.WebKit},n=i.default.getFirstMatch(/webkit\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}}],t.default=s,e.exports=t.default}}),r=function(){function e(e,t){return function(e,t){return t.get?t.get.call(e):t.value}(e,n(e,t,"get"))}function t(e,t,r){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,n(e,t,"set"),r),r}function n(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}function r(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return n}function i(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function o(e,t,n){i(e,t),t.set(e,n)}function s(e,t){i(e,t),t.add(e)}function a(){t(this,u,RegExp(e(this,d).join("|"),l))}function c(t){return e(this,d).indexOf(t.toLowerCase())}var l,d,u,f,p,g,h=[" daum[ /]"," deusu/","(?:^| )site","@[a-z]","\\(at\\)[a-z]","\\(github\\.com/","\\[at\\][a-z]","^12345","^<","^[\\w \\.]+/v?\\d+(\\.\\d+)?(\\.\\d{1,10})?$","^[\\w]+$","^[^ ]{50,}$","^ace explorer","^acoon","^active","^ad muncher","^anglesharp/","^anonymous","^apple-pubsub/","^astute srm","^avsdevicesdk/","^axios/","^bidtellect/","^biglotron","^blackboard safeassign","^blocknote.net","^braze sender","^captivenetworksupport","^castro","^cf-uc ","^clamav[ /]","^cobweb/","^coccoc","^dap ","^ddg[_-]android","^discourse","^dispatch/\\d","^downcast/","^duckduckgo","^email","^enigma browser","^evernote clip resolver","^facebook","^faraday","^fdm[ /]\\d","^getright/","^gozilla/","^hatena","^hobbit","^hotzonu","^hwcdn/","^infox-wisg","^invision","^jeode/","^jetbrains","^jetty/","^jigsaw","^linkdex","^lwp[-: ]","^mailchimp\\.com$","^metauri","^microsoft bits","^microsoft data","^microsoft office existence","^microsoft office protocol discovery","^microsoft windows network diagnostics","^microsoft-cryptoapi","^microsoft-webdav-miniredir","^movabletype","^mozilla/\\d\\.\\d \\(compatible;?\\)$","^mozilla/\\d\\.\\d \\w*$","^my browser$","^navermailapp","^netsurf","^node-superagent","^octopus","^offline explorer","^pagething","^panscient","^perimeterx","^php","^postman","^postrank","^python","^read","^reed","^request-promise$","^restsharp/","^shareaza","^shockwave flash","^snapchat","^space bison","^sprinklr","^svn","^swcd ","^t-online browser","^taringa","^test certificate info","^the knowledge ai","^thinklab","^thumbor/","^traackr.com","^tumblr/","^vbulletin","^venus/fedoraplanet","^w3c","^webbandit/","^webcopier","^wget","^whatsapp","^www-mechanize","^xenu link sleuth","^yahoo","^yandex","^zdm/\\d","^zeushdthree","^zoom marketplace/","adbeat\\.com","appinsights","archive","ask jeeves/teoma","bit\\.ly/","bluecoat drtr","bot","browsex","burpcollaborator","capture","catch","check","chrome-lighthouse","chromeframe","client","cloud","crawl","daemon","dareboost","datanyze","dataprovider","dejaclick","dmbrowser","download","evc-batch/","feed","fetch","firephp","freesafeip","ghost","gomezagent","google","headlesschrome/","http","httrack","hubspot marketing grader","hydra","ibisbrowser","images","index","ips-agent","java","library","mail\\.ru/","manager","monitor","morningscore/","neustar wpm","news","nutch","offbyone","optimize","pagespeed","parse","perl","phantom","pingdom","powermarks","preview","probe","proxy","ptst[ /]\\d","reader","rexx;","rigor","rss","scan","scrape","search","server","sogou","sparkler/","spider","statuscake","stumbleupon\\.com","supercleaner","synapse","synthetic","taginspector/","toolbar","torrent","tracemyfile","transcoder","trendsmapresolver","twingly recon","url","valid","virtuoso","wappalyzer","webglance","webkit2png","websitemetadataretriever","whatcms/","wordpress","zgrab"];return function(e){try{RegExp("(?<! cu)bot").test("dangerbot")}catch(t){return e}e.splice(e.lastIndexOf("bot"),1),e.push("(?<! cu)bot"),e.splice(e.lastIndexOf("google"),1),e.push("(?<! (channel\\/|google\\/))google(?!(app|\\/google))"),e.splice(e.lastIndexOf("search"),1),e.push("(?<! (ya|yandex))search"),e.splice(e.lastIndexOf("http"),1),e.push("(?<!(lib))http"),e.splice(e.lastIndexOf("java"),1),e.push("java(?!;)"),e.splice(e.lastIndexOf("fetch"),1),e.push("(?<!(mozac))fetch")}(h),l="i",d=new WeakMap,u=new WeakMap,f=new WeakSet,p=new WeakSet,g=function(){function n(e){var i=this;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),s(this,p),s(this,f),o(this,d,{writable:!0,value:void 0}),o(this,u,{writable:!0,value:void 0}),t(this,d,e||h.slice()),r(this,f,a).call(this),Object.defineProperties((function(e){return i.test(e)}),Object.getOwnPropertyNames(n.prototype).filter((function(e){return!["constructor"].includes(e)})).reduce((function(e,t){return Object.assign(e,(o={get:function(){return i[t].bind(i)}},(r=t)in(n={})?Object.defineProperty(n,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):n[r]=o,n));var n,r,o}),{}))}var i,g;return i=n,g=[{key:"test",value:function(t){return!!t&&e(this,u).test(t)}},{key:"find",value:function(t){var n=(arguments.length>0&&void 0!==t?t:"").match(e(this,u));return n&&n[0]}},{key:"matches",value:function(t){var n=arguments.length>0&&void 0!==t?t:"";return e(this,d).filter((function(e){return RegExp(e,l).test(n)}))}},{key:"clear",value:function(e){var t=arguments.length>0&&void 0!==e?e:"";this.exclude(this.matches(t))}},{key:"extend",value:function(t){var n=this,i=arguments.length>0&&void 0!==t?t:[];[].push.apply(e(this,d),i.filter((function(e){return-1===r(n,p,c).call(n,e)})).map((function(e){return e.toLowerCase()}))),r(this,f,a).call(this)}},{key:"exclude",value:function(t){for(var n,i=arguments.length>0&&void 0!==t?t:[],o=i.length;o--;)(n=r(this,p,c).call(this,i[o]))>-1&&e(this,d).splice(n,1);r(this,f,a).call(this)}},{key:"spawn",value:function(t){return new n(t||e(this,d))}}],g&&function(e,t){var n,r;for(n=0;n<t.length;n++)(r=t[n]).enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}(i.prototype,g),Object.defineProperty(i,"prototype",{writable:!1}),n}(),new g}(),i=n.getParser(window.navigator.userAgent),o="ac|ad|ae|af|ag|ai|al|am|an|ao|aq|ar|as|at|au|aw|ax|az|ba|bb|be|bf|bg|bh|bi|bj|bm|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cd|cf|cg|ch|ci|cl|cm|cn|co|cr|cu|cv|cw|cx|cz|de|dj|dk|dm|do|dz|ec|ee|eg|es|et|fi|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|im|in|io|iq|ir|is|it|je|jo|jp|kg|ki|km|kn|kp|kr|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mk|ml|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|na|nc|ne|nf|ng|nl|no|nr|nu|nz|om|pa|pe|pf|ph|pk|pl|pm|pn|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sk|sl|sm|sn|so|sr|st|su|sv|sx|sy|sz|tc|td|tf|tg|th|tj|tk|tl|tm|tn|to|tp|tr|tt|tv|tw|tz|ua|ug|uk|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|yt".split("|"),s="com|2000|6bone|ab|abo|ac|act|ad|adm|adult|adv|adygeya|aero|aeroport|agr|agrar|agric|agro|ah|aichi|aid|ak|akita|al|aland|alt|altai|am|amur|amursk|and|aomori|ar|arkhangelsk|army|arq|art|arts|asn|assn|asso|astrakhan|atm|ato|augustow|auto|av|avocat|az|b|babia|baikal|bashkiria|bbs|bc|bd|bedzin|bel|belgorod|beskidy|bialowieza|bialystok|bielawa|bieszczady|bio|bir|biz|bj|blog|bmd|boleslawiec|bolt|brand|bryansk|buryatia|busan|bydgoszcz|bytom|c|ca|cap|casino|cbg|cg|chel|chelyabinsk|cherkassy|cherkasy|chernigov|chernivtsi|chernovtsy|chiba|chita|chukotka|chungbuk|chungnam|cieszyn|cim|city|ck|club|cmw|cn|cng|cnt|co|conf|coop|cpa|cq|cri|crimea|csiro|ct|cv|czeladz|czest|d|daegu|daejeon|dagestan|dc|de|dlugoleka|dn|dnepropetrovsk|dni|dnipropetrovsk|donetsk|dp|dr|e|e164|ebiz|ecape|ecn|ed|edu|ehime|ekloges|elblag|elk|eng|ens|erotica|erotika|es|esp|etc|eti|eun|f|fam|far|fareast|fed|fh|fhs|fhsk|fhv|fi|fie|film|fin|firm|fj|fl|flog|fm|fnd|folkebibl|forum|fot|from|fs|fst|fukui|fukuoka|fukushima|fylkesbibl|g|g12|ga|game|games|gangwon|gd|gda|gdansk|gdynia|geek|gen|ggf|gifu|gliwice|glogow|gmina|gniezno|go|gob|gok|gon|gop|gorlice|gos|gouv|gov|govt|gp|gr|grajewo|grondar|grozny|grp|gs|gsm|gub|gunma|gv|gwangju|gx|gyeongbuk|gyeonggi|gyeongnam|gz|h|ha|hb|he|health|herad|hi|hiroshima|hl|hn|hokkaido|hotel|hs|hyogo|i|ia|ibaraki|id|idn|idrett|idv|if|il|ilawa|imb|in|incheon|ind|inf|info|ing|ingatlan|inima|int|intl|ip6|irc|iris|irkutsk|isa|ishikawa|isla|it|ivano|ivanovo|iwate|iwi|iz|izhevsk|jamal|jar|jaworzno|jcpc|jeju|jelenia|jeonbuk|jeonnam|jgora|jl|jogasz|jor|joshkar|js|judiciary|jus|jx|k|k12|kagawa|kagoshima|kalisz|kalmykia|kaluga|kamchatka|kanagawa|karelia|karpacz|kartuzy|kaszuby|katowice|kawasaki|kazan|kazimierz|kchr|kemerovo|kepno|ketrzyn|kg|kh|khabarovsk|khakassia|kharkiv|kharkov|kherson|khmelnitskiy|khv|kids|kiev|kirov|kirovograd|kitakyushu|klodzko|km|kms|kobe|kobierzyce|kochi|koenig|kolobrzeg|komforb|komi|kommunalforbund|kommune|komvux|konin|konskowola|konyvelo|kostroma|kr|krakow|krasnoyarsk|ks|kuban|kumamoto|kurgan|kursk|kustanai|kutno|kuzbass|ky|kyiv|kyoto|kzn|la|lakas|lanarb|lanbib|lapy|law|lebork|leg|legnica|lel|lezajsk|lg|limanowa|lipetsk|ln|lomza|lowicz|lp|lt|ltd|lubin|lugansk|lukow|lutsk|lviv|m|ma|magadan|magnitka|mail|malbork|malopolska|maori|mari|marine|mat|mazowsze|mazury|mb|mbone|md|me|med|media|mi|miasta|mie|mielec|mielno|mil|miyagi|miyazaki|mk|mn|mo|mobi|mod|mordovia|mos|mosreg|mpm|mragowo|ms|msk|mt|muni|murmansk|mus|museum|music|musica|mytis|n|nagano|nagasaki|nagoya|nakhodka|naklo|nalchik|name|nara|nat|naturbruksgymn|navy|nb|nc|ncape|nd|ne|net|news|nf|ngo|nh|nhs|nic|nieruchomosci|niigata|nikolaev|nis|nj|nkz|nl|nm|nnov|nom|nome|norilsk|not|nov|novosibirsk|nowaruda|ns|nsk|nsn|nsw|nt|ntr|nu|nv|nw|nx|ny|nysa|o|od|odesa|odessa|odo|off|og|oh|oita|ok|okayama|okinawa|olawa|olecko|olkusz|olsztyn|omsk|on|opoczno|opole|or|orenburg|org|oryol|osaka|oskol|ostroda|ostroleka|ostrowiec|ostrowwlkp|oz|pa|parliament|parti|pb|pc|pe|penza|per|perm|perso|pila|pisz|pl|plc|plo|po|podhale|podlasie|pol|police|polkowice|poltava|pomorskie|pomorze|powiat|poznan|pp|ppg|prd|press|presse|pri|priv|pro|prochowice|pruszkow|przeworsk|psc|psi|pskov|ptz|pub|publ|pulawy|pvt|pyatigorsk|qc|qh|qld|qsl|radio|radom|rawa|re|realestate|rec|red|reklam|rel|res|ri|rivne|rnd|rovno|royal|rubtsovsk|rv|ryazan|rybnik|rzeszow|s|sa|saga|saitama|sakhalin|samara|sanok|sapporo|saratov|sc|sch|school|sci|sd|sebastopol|sec|sejny|sendai|seoul|sex|sh|shiga|shimane|shizuoka|shop|simbirsk|sk|sklep|skoczow|slask|sld|slg|slupsk|smolensk|sn|snz|so|soc|sopot|soros|sos|sosnowiec|spb|sport|sr|srv|sshn|stalowa|starachowice|stargard|starostwo|stat|stavropol|store|stv|suli|sumy|supremecourt|surgut|suwalki|swidnica|swiebodzin|swinoujscie|sx|syzran|szczecin|szczytno|szex|szkola|t|tambov|targi|tarnobrzeg|tas|tatarstan|taxi|te|tel|teo|ternopil|test|tgory|tirana|tj|tlt|tm|tmp|tn|tochigi|tokushima|tokyo|tom|tomsk|tottori|tourism|toyama|tozsde|travel|trd|tsaritsyn|tsk|tula|tur|turek|turystyka|tuva|tv|tver|tx|tychy|tyumen|u|udm|udmurtia|ug|ulan|ulsan|um|uniti|upow|upt|uri|urn|us|usenet|ustka|ut|utazas|uw|uz|uzhgorod|va|vatican|vdonsk|vet|veterinaire|vgs|vic|video|vinnica|vladikavkaz|vladimir|vladivostok|vlog|vn|volgograd|vologda|volyn|voronezh|vrn|vt|vyatka|w|wa|wakayama|walbrzych|warmia|warszawa|waw|wcape|weather|web|wegrow|wi|wielun|wiki|wlocl|wloclawek|wodzislaw|wolomin|wroc|wroclaw|wv|www|wy|x|xj|xz|y|yakutia|yalta|yamagata|yamaguchi|yamal|yamanashi|yaroslavl|yekaterinburg|yk|yn|yokohama|yuzhno|z|zachpomor|zagan|zakopane|zaporizhzhe|zarow|zgora|zgorzelec|zhitomir|zj|zlg|zp|zt".split("|"),a=e=>null===e?"null":void 0===e?"undefined":e===window?"global":{}.toString.call(e).match(/\s([a-z|A-Z]+)/)[1].toLowerCase(),c=e=>"number"===a(e)&&!isNaN(e),l=e=>"string"===a(e),d=(e,t)=>{if(e===t)return!1;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!0;const n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!0;for(let i of n)if(!r.includes(i)||d(e[i],t[i]))return!0;return!1},u=e=>e&&"NaN"!==e||0===e||!1===e,f=e=>{const t=e.match(/^(([^:\/?#]+:)?(?:\/\/((?:([^\/?#:]*):([^\/?#:]*)@)?([^\/?#:]*)(?::([^\/?#:]*))?)))?([^?#]*)(\?[^#]*)?(#.*)?$/),n={hash:t[10]||"",host:t[3]||"",hostname:t[6]||"",domainname:p(t[6]),href:t[0]||"",origin:t[1]||"",pathname:t[8]||(t[1]?"/":""),port:t[7]||"",protocol:t[2]||"",search:t[9]||"",username:t[4]||"",password:t[5]||""};return 2===n.protocol.length&&(n.protocol="file:///"+n.protocol.toUpperCase(),n.origin=n.protocol+"//"+n.host),n.href=n.origin+n.pathname+n.search+n.hash,n},p=e=>{let t=e||"";const n=["www.","https://www.","http://www."];for(let r=0,i=n.length;i>r;r++){const i=n[r];if(t.startsWith(i)){t=e.slice(i.length);break}}return t};let g="";const h=e=>(e&&""!==e&&(e=(e=e.charAt(0).toUpperCase()+e.slice(1)).replace(/\+/g," "),e=decodeURIComponent(e)),e),m=e=>e.replace(/^\.?|\.?$/g,""),y=(e,t,n)=>(t&&t.length||n)&&t.concat(n).findIndex((t=>e===t))>-1?n:null;return{compressEventData:async n=>{try{let r=e(n).toString();r&&r.length&&(r=r.substring(0,4));const i=await t.zip(n,{level:9}),o={A:0,B:1,C:2,D:3,E:4,F:5,G:6,H:7,I:8,J:9,K:10,L:11,M:12,N:13,O:14,P:15,Q:16,R:17,S:18,T:19,U:20,V:21,W:22,X:23,Y:24,Z:25,a:26,b:27,c:28,d:29,e:30,f:31,g:32,h:33,i:34,j:35,k:36,l:37,m:38,n:39,o:40,p:41,q:42,r:43,s:44,t:45,u:46,v:47,w:48,x:49,y:50,z:51,0:52,1:53,2:54,3:55,4:56,5:57,6:58,7:59,8:60,9:61,"+":62,"/":63},s=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","+","/"],a=btoa(String.fromCharCode(...new Uint8Array(i))),c=a.length;let l="";for(let e=0;c>e;e++)"="!==a[e]?l+=s[(o[a[e]]+c)%64]:l+="=";return encodeURIComponent(`${r}|${l}`)}catch(e){console.log("Failed to compress event data. errorL",e)}},getType:a,isUndefined:e=>"undefined"===a(e),isNumber:c,isString:l,isBoolean:e=>"boolean"===a(e),isObject:e=>"object"===a(e),isArray:e=>"array"===a(e),isFunction:e=>["function","asyncfunction"].indexOf(a(e))>=0,isNullish:e=>[null,void 0].some((t=>e===t)),clone:e=>{try{if(!(e instanceof HTMLElement)&&"function"==typeof structuredClone)return structuredClone(e)}catch(e){logger.error(e,"coreUtils.clone")}return JSON.parse(JSON.stringify(e))},hasDiff:d,reformatJsonToKeysAndValues:e=>{const t=Object.keys(e).length;let n=0,r="?",i="",o="";for(const[s,a]of Object.entries(e))u(a)&&(i=encodeURIComponent(s.replace(/[^\x00-\x7F]/g,"")),o=encodeURIComponent(("object"==typeof a?JSON.stringify(a):a.toString()).replace(/[^\x00-\x7F]/g,"")),r+=`${i}=${o}${t>n?"&":""}`),n++;return r.lastIndexOf("&")===r.length-1&&(r=r.substring(0,r.length-1)),r},parseUrl:f,removeWWWprefix:p,getBrowser:()=>{const e=i.getBrowserName(!0);return e===window.navigator.userAgent.toLowerCase()?"Unknown":e},getOS:()=>i.getOSName(!0),getOSVersion:()=>i.getOSVersion(),getDevice:()=>(g||(g=i.getPlatformType(!0).replace("desktop",Devices.PC)),g),getDeviceName:()=>i.getPlatform().model||"",getDateNow:()=>Date.now(),beautifyChannel:h,extractDomain:e=>{if(!e)return null;let t=e.split("."),n=t.length;return 2>n?t[0]:4===n||3===n&&3>=t[n-2].length?t[n-3]:t[n-2]},findElementsWithPrices:(e,t)=>{function n(e){return e.startsWith(",")?"0."+e.slice(1).replace(",","."):e.replace(/(\d+)\.(\d+),(\d+)/,(function(e,t,n,r){return t.replace(/(\d)(?=(\d{3})+$)/g,"$1,")+"."+n+r})).replace(/,(\d{1,2})$/,".$1")}const r=[],i=/^[+-]?([a-zA-Z]{0,3}[\p{Sc}]?)(\d+([\.,]\d{3})*([\.,]\d{1,2})?|([\.,]\d{1,2})?)([\p{Sc}]?)/u;for(let o=0;o<e.length;o++){const s=e[o],a=s.getBoundingClientRect();if(!t||a.left>=window.innerWidth/2){let e=s.textContent.trim();e=e.replace("&nbsp;","").replace(/\s/g,""),0===e.indexOf("(")&&e.indexOf(")")>0&&(e=e.substring(e.indexOf(")")+1).trim());const t=e.match(i);if(t&&t.length>3&&t[2].length>0&&2>s.children.length){let i=s.previousElementSibling,o=null;i||s.parentElement.innerText.split(/\s/)[0]!==e&&(o=s.parentElement.innerText.replace(e,"").trim()),o=o||(i?i.textContent.trim():""),0===o.indexOf("(")&&s.parentElement.innerText.split(/\s/)[0]!==e&&(o=s.parentElement.innerText.replace(e,"").trim()),o&&3===o.length&&"tax"!==o.toLowerCase()&&(i=s.parentElement.previousElementSibling,o=i?i.textContent.trim():"",o=o.split("\n")[0].trim()),o&&o.indexOf("(")>0&&(o=o.substring(0,o.indexOf("(")).trim());const a=(+n(t[2])).toFixed(2),c=t[1].length>0?t[1]:t[6];a.length>0&&c&&r.push({[ElementWithPrice.DESCRIPTION]:o,[ElementWithPrice.PRICE]:a,[ElementWithPrice.CURRENCY]:encodeURIComponent(c)})}}}return r.filter((e=>(e[ElementWithPrice.DESCRIPTION]||"").length>=3)).reduce(((e,t)=>(e.find((e=>e[ElementWithPrice.DESCRIPTION]===t[ElementWithPrice.DESCRIPTION]&&e[ElementWithPrice.PRICE]==e[ElementWithPrice.PRICE]))||e.push(t),e)),[])},getQueryParamsAsObject:()=>{try{const e=location.search.substring(1).replaceAll(/[?]+/g,"?").replaceAll(/[&]+/g,"&").replaceAll(/[=]+/g,"=");return JSON.parse('{"'+e.replaceAll("?","").replaceAll("&",'","').replaceAll("=",'":"')+'"}')}catch(e){return null}},getUTMChannelName:e=>e?h(e):"Unspecified UTM",isBot:()=>r(navigator.userAgent),getTimezone:()=>{try{return Intl.DateTimeFormat().resolvedOptions().timeZone}catch(e){return""}},safeRegex:e=>{e=e||"";try{return RegExp(e,"gi")}catch(e){}return e=e.replace("(?<!\\?)",""),RegExp(e,"gi")},get:(e,t,n)=>{if(!e||"object"!=typeof e)return n;const r=Array.isArray(t)?t:t.match(/([^[.\]])+/g);if(!r)return n;let i=e;for(let e of r)if(i=null===i?void 0:i[e],void 0===i)return n;return i},generateRandomString:function(e){let t=e||5,n="";for(;t--;)n+="ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz".charAt(Math.floor(51*Math.random()));return n},generateUUID:()=>{const e=[];for(let t=0;256>t;t++)e[t]=(16>t?"0":"")+t.toString(16);const t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return e[255&t]+e[t>>8&255]+e[t>>16&255]+e[t>>24&255]+e[255&n]+e[n>>8&255]+e[n>>16&255]+e[n>>24&255]+e[255&r]+e[r>>8&255]+e[r>>16&255]+e[r>>24&255]+e[255&i]+e[i>>8&255]+e[i>>16&255]+e[i>>24&255]},getCookie:(e,t)=>{if(t||(t=document.cookie),!t)return"";const n=t.split(/;\s*/),r={};let i,o;for(const t of n){i=t.indexOf("=");try{-1!==i&&(o=decodeURIComponent(t.substring(0,i).trim())),o&&(r[o]=decodeURIComponent((t.substring(i+1)||"").trim()))}catch(e){-1!==i&&(o=t.substring(0,i).trim()),o&&(r[o]=(t.substring(i+1)||"").trim())}if(e&&o===e)return r[o]}return e?"":r},jsonParse:e=>{if(!l(e)&&!c(e)||""===e)return null;try{return JSON.parse(e)}catch(e){return null}},hasContentWindowDocumentAndNoSrc:e=>{try{return(e=>{try{return(!e.src||!e.src.match(/^https?:\/\//)&&!e.src.match(/^data:/i)&&!e.src.match(/^file:/i))&&e.contentWindow&&e.contentWindow.navigator&&e.contentWindow.performance}catch(e){return!1}})(e)&&e.contentWindow.document}catch(e){return!1}},removeSubdomain:e=>{if(e.match(/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/))return e;const t=e.split(".");for(;t.length>3;)t.shift();return 3===t.length&&"www"!==t[0]&&(t[1].length>2&&t[2].length>2||-1===s.indexOf(t[1])&&-1!==o.indexOf(t[2]))&&t.shift(),t.join(".")},yieldToMain:function(){return new Promise((e=>{setTimeout(e,0)}))},isURL:e=>/^(https?|ftp):\/\/[^\s/$.?#].[^\s]*$/i.test(e),getStackTrace:function(){const e=Error();if(e.stack)return e.stack;try{null[0]}catch(e){return e.stack||""}return""},isEmptyObject:e=>"object"===a(e)&&0===Object.keys(e).length,findRelevantDomain:(e,t)=>{const n=f(window.location.href).domainname;try{return"exact"===e?(()=>{for(const e in t){if(!t.hasOwnProperty(e))continue;const r=t[e]&&t[e].domainsMapping||[],i=y(n,r,e);if(i)return logger.info(`'${n}' found the exact domain: '${i}'`),i}return logger.info(`'${n}' didn't match (exact) to any of the domains'`),null})():(()=>{const e=m(n).split("."),r=Object.keys(t).sort(((e,t)=>e.split(".").length>t.split(".").length?-1:1));for(const i of r){const r=m(i).split(".");let o=!0;for(let t=r.length-1,n=e.length-1;t>=0;t--,n--)if(r[t]!==e[n]){o=!1;break}if(o&&!t[i].excludedDomains.includes(n))return logger.info(`'${n}' found the most specific (includes) domain: '${i}'`),i}return logger.info(`'${n}' didn't match (includes) to any of the domains'`),null})()}catch(e){return logger.error("Failed to find relevant domain with error "+e),null}}}})(),encryption=(()=>{class e{static utf8_to_b64(e){return btoa(unescape(encodeURIComponent(e)))}static b64_to_utf8(e){return decodeURIComponent(escape(atob(e)))}static generateRandomB64Char(){return e.indexToB64Char(Math.floor(65*Math.random()))}static b64CharToIndex(e){let t=e.charCodeAt(0);return t>122&&(t-=3),t>95&&(t-=1),t>90&&(t-=4),t>57&&(t-=7),t>45&&(t-=2),t-45}static indexToB64Char(e){return(e+=45)>45&&(e+=2),e>57&&(e+=7),e>90&&(e+=4),e>95&&(e+=1),e>122&&(e+=3),String.fromCharCode(e)}static times(e,t){if(!e||"number"!=typeof e||0>=e)return"";let n="",r=typeof t;for(;e;){switch(r){case"string":n+=t;break;case"function":n+=t();break;default:"undefined"!==r&&null!==t&&t.toString&&(n+=t.toString())}e--}return n}static cyclic3(e){return(e>>-e)+(1|-e)}encrypt(t){if(null===t)return"";const n=e.generateRandomB64Char();let r=e.b64CharToIndex(n)%10;5>r&&(r+=5);let i,o,s=e.times(r,e.generateRandomB64Char),a=-1,c=e.utf8_to_b64(t).replace(/\+/g,"-").replace(/=/g,"_").replace(/\//g,"~"),l=n+s;for(let t=0,n=c.length;n>t;t++)a?(i=e.b64CharToIndex(s.charAt(t%r))*a,o=e.b64CharToIndex(c.charAt(t))+i,o=0>o?o+65:65>o?o:o-65,l+=e.indexToB64Char(o)):l+=c.charAt(t),a=e.cyclic3(a);return l}decrypt(t){if(null===t)return"";if("string"!=typeof t||/[^a-z\d\-_~]/i.test(t))return t;let n=t.charAt(0),r=e.b64CharToIndex(n)%10;5>r&&(r+=5);let i,o,s=t.slice(1,r+1),a=-1,c="";for(let n=0,l=(t=t.substr(r+1)).length;l>n;n++)a?(i=e.b64CharToIndex(s.charAt(n%r))*a*-1,o=e.b64CharToIndex(t.charAt(n))+i,o=0>o?o+65:65>o?o:o-65,c+=e.indexToB64Char(o)):c+=t.charAt(n),a=e.cyclic3(a);try{c=e.b64_to_utf8(c.replace(/~/g,"/").replace(/_/g,"=").replace(/\-/g,"+"))}catch(e){c=t}return c}}return new e})(),NmgWorker=class{constructor(e,t=null,n={}){this.workerCallback=e,this.resultCallback=t;const r={waitForTerminate:!1,fallbackToMainThread:!1,isWorkerSupported:!!__INJECTIONS__.useWebWorker};this.options={...r,...n},this.isWorkerSupported=!!(window.Worker&&window.URL&&window.URL.createObjectURL)&&this.options.isWorkerSupported}run(e,t){if(e=e||{},t=t||{},this.isWorkerSupported)try{const n=this.workerCallback.toString(),r=Object.keys(t).map((e=>`const ${e} = ${t[e].toString()};`)).join("\n"),i=new Blob([`\n                        onmessage = function(e) {\n                            const params = e.data;\n                            ${r}\n                            const func = ${n};\n                            const postMessage = self.postMessage.bind(self);\n                            const terminateWorker = () => {\n                                self.close();\n                                postMessage('terminate');\n                            };\n                            const NmgWorker = {\n                                postMessage: postMessage,\n                                terminateWorker: terminateWorker\n                            };\n                            func(params);\n                        }\n                    `],{type:"application/javascript"}),o=window.URL.createObjectURL(i),s=new Worker(o),a=this.resultCallback,c=this.options.waitForTerminate,l=()=>{window.URL.revokeObjectURL(o),s.terminate()};s.onmessage=function(e){"terminate"===e.data?l():(a&&a(e.data),c||l())},s.onerror=function(e){logger.error(e,"NmgWorker.run.onerror"),l()},s.onmessageerror=function(e){logger.error(e,"NmgWorker.run.onmessageerror"),l()},s.postMessage(e)}catch(n){logger.warn("Some exception when use Worker. Try to not use it: "+n,"NmgWorker.run"),this.isWorkerSupported=!1,this.run(e,t)}else if(this.options.fallback)this.options.fallback();else if(this.options.fallbackToMainThread){this.resultCallback;try{if(Object.keys(t).length){const n=Object.keys(t).join(",");Function("args","helperFunctions",`const {${n}=helperFunctions;return (${this.workerCallback.toString()})(args);`)(e,t)}else this.workerCallback(e)}catch(e){logger.error("Unable to run the Worker callback in the main thread! "+e,"NmgWorker.run")}}}},configurationsGetters=(()=>{const e=new class{init(e){this.snp=e}get configurations(){return e.snp}get cc(){return e.snp.cc||{}}get versions(){return{ver:e.snp.v,snp_ver:e.snp.sv,snp_ts:e.snp.snpTS}}get useHangTimeMeasurer(){const t=e.cc.sHT;return!!t&&(void 0!==e.hangTimeMeasurer||(e.hangTimeMeasurer=coreFeatureManager.getThreshold("SESSION")<=t[ClientFeatureFlags.SCRIPT_HANG_TIME_INTERVAL_PERCENTAGE]),e.hangTimeMeasurer)}};return e})(),dal=(()=>{class e{constructor(){this.tableData={},this.setMutators={},this.getMutators=[],this.onchangeFunction=null}addMutator(e,t){this.setMutators[e]=t}removeMutator(e){delete this.setMutators[e]}get(e=!0){if(!e)return this.tableData;let t=coreUtils.clone(this.tableData);return this.getMutators.forEach((e=>{e(t)})),t}getOne(e){return coreUtils.clone(this.tableData[e])}set(e,t=!1){let n=0;Object.keys(e).forEach((t=>{const r=e[t]&&coreUtils.clone(e[t]);!coreUtils.isUndefined(e[t])&&coreUtils.hasDiff(this.tableData[t],r)&&(this.tableData[t]=r,++n)}));for(let e of Object.values(this.setMutators))e(this.tableData);return(n>0||t)&&this.onchangeFunction&&this.onchangeFunction(),n}extendedSet(){return(e,t=!1)=>this.set(e,t)}clear(){const e=Object.keys(this.tableData).length;return this.tableData={},e&&this.onchangeFunction&&this.onchangeFunction(),e}onchange(e){coreUtils.isFunction(e)&&(this.onchangeFunction=e)}hasData(){for(const e in this.tableData)if(this.tableData[e]||0===this.tableData[e])return!0;return!1}on(...e){let t=0;return e.forEach((e=>{coreUtils.isFunction(e)&&(this.getMutators.push(e),t++)}),this),t}}class t{constructor(){this.tableData=null}get(){return this.tableData}set(e){return this.tableData=e,1}}return(new class{constructor(){this.dalObj={session:new e,commonReportFields:new e,incentiveData:new e,hookReader:new e,jdlObject:new e,jdlHiddenObject:new e,siteConfig:new e,coreDataStore:new e,activations:new e,sendReport:new e,throttlingProcess:new e,signals:new e,segments:new e,segmentsCHP3:new e,segmentsCHP3Data:new e,extensions:new e,esData:new e,esSession:new e,needToSend:new t,cnvByHref:new t}}get dal(){return this.dalObj}}).dal})();GLOBALS.dal=dal;const urlParamManager=(()=>{const e=new class{constructor(){this.authPass=!1}init(t){e.authPass=t===e.getValue(UrlParams.NMG_AUTH_KEY)}getParamValuation(t,n){let r={wasFound:!1};const i=n.toLowerCase(),o=e.getValue(t);if(null!==o)if(r.wasFound=!0,o.includes(",")){const e=o.toLowerCase().trim().split(",");r.value=e.includes(i)}else r.value=o===i;return r}getValue(t){return t===UrlParams.NMG_AUTH_KEY||e.authPass?new URLSearchParams(window.location.search).get(t):null}};return e})(),coreFeatureManager=(()=>{const e=new class{init(t){e.f=t,e.pageThreshold=100*Math.random(),e.sessionThreshold=dal.session.getOne("featureSessionThreshold")||100*Math.random(),e.userThreshold=dal.session.getOne("featureUserThreshold")||100*Math.random(),dal.session.set({featureSessionThreshold:e.sessionThreshold,featureUserThreshold:e.userThreshold})}getOne(t){const n=urlParamManager.getValue(t);if(null===n)return e.f[t];const r=+n;return!coreUtils.isNullish(n)&&Number.isInteger(r)?r:e.f[t]}get(...t){return t.reduce(((t,n)=>({...t,[n]:e.getOne(n)})),{})}getThreshold(t){switch(t){case"IMMEDIATE":default:return e.getImmediateThreshold();case"PAGE":return e.getPageThreshold();case"SESSION":return e.getSessionThreshold();case"USER":return e.getUserThreshold()}}meetsThreshold(t,n){const r=e.getOne(t);return"number"==typeof r&&r>e.getThreshold(n)}getImmediateThreshold(){return 100*Math.random()}getPageThreshold(){return e.pageThreshold}getSessionThreshold(){return e.sessionThreshold}getUserThreshold(){return e.userThreshold}};return e})(),{overrides:overrides,setTimeout:setTimeout,setInterval:setInterval}=(()=>{const e=new class{callbackTryCatchWrapper(e){return function(){try{return e.apply(this,arguments)}catch(e){GLOBALS.coreTracker&&GLOBALS.coreTracker.isReady()&&GLOBALS.coreTracker.reportEventsError("sendGetEventViaWebWorker",{message:e.message,stack:e.stack})}}}},t=(Object.getOwnPropertyDescriptor(window,"setTimeout")||Object.getOwnPropertyDescriptor(Window.prototype,"setTimeout")||{}).value,n=(Object.getOwnPropertyDescriptor(window,"setInterval")||Object.getOwnPropertyDescriptor(Window.prototype,"setInterval")||{}).value,r=t?function(n){return n=e.callbackTryCatchWrapper(n),t.apply(this,arguments)}:function(t,n){return window.setTimeout(e.callbackTryCatchWrapper(t),n)},i=n?function(t){return t=e.callbackTryCatchWrapper(t),n.apply(this,arguments)}:function(t,n){return window.setInterval(e.callbackTryCatchWrapper(t),n)};return{overrides:e,setTimeout:r,setInterval:i}})(),hangTimeMeasure=(()=>{let e=null;return t=>(e||(e=(e=>{let t,n,r,i;const o=o=>{r=[],r.push(e.intervalInMilli),o&&(t=n=coreUtils.getDateNow(),i=window.setInterval((()=>{(()=>{const o=coreUtils.getDateNow(),s=o-t;o-n>e.totalTimeInMilli?clearInterval(i):(r.push(s),t=o)})()}),e.intervalInMilli))};return{start:o,getAndReset:()=>{const e=coreUtils.clone(r);return e&&2>e.length?null:(o(!1),e)}}})(t)),e)})(),notifier=(()=>{const e=new class{constructor(){this.listeners={},this.counter={}}clear(){e.listeners={},e.counter={}}bind(t,n){coreUtils.isString(t)&&coreUtils.isFunction(n)&&(e.listeners[t]||(e.listeners[t]=[]),e.listeners[t].push(n))}retroBind(t,n){e.bind(t,n);const r=e.count(t);if(r)for(const t of r)e.callbacksWrapper(n,t)}unbind(t){coreUtils.isString(t)&&(e.listeners[t]=[])}prepareFire(t,n){const r={functions:e.listeners[t]||[]};return e.counter[t]||(e.counter[t]=[]),e.counter[t].push(n),r}fire(t,...n){const r=e.prepareFire(t,n);if(r)for(const t of r.functions)(t=>{setTimeout((()=>{e.callbacksWrapper(t,n)}),0)})(t)}fireSync(t,...n){const r=e.prepareFire(t,n);let i=[];if(r){for(const e of r.functions)o=e,i[i.length]=o.apply(o,n);var o;return i}}count(t){return e.counter[t]}callbacksWrapper(e,t){new Promise(((n,r)=>{try{const i=e.apply(e,t);i instanceof Promise?i.then(n).catch(r):n(i)}catch(e){r(e)}})).catch((e=>{try{logger.error(e),coreTracker.reportEventsError("sendGetEventViaWebWorker",{message:e.message,stack:e.stack})}catch(e){}}))}get(t){return e.listeners[t]||[]}};return e})();GLOBALS.notifier=notifier;const storesConfigurations=(()=>{const e=new class{init(t,n,r){const i=t||{storeType:null,etag:!1,spa:!1,sectionsMapping:null,domainsMapping:[],excludedDomains:[]};i.domain=n,i.clientTag=r,e.sc={...i}}get storeType(){return e.sc.storeType}get etag(){return e.sc.etag}get spa(){return e.sc.spa}get sectionsMapping(){return e.sc.sectionsMapping}get domainsMapping(){return e.sc.domainsMapping}get excludedDomains(){return e.sc.excludedDomains||[]}get domain(){return e.sc.domain}get clientTag(){return e.sc.clientTag}};return e})(),pageTypeDetector=(()=>{const e={LIKE:"like",REGEX:"regex",EQUALS:"="},t="contains",n="startsWith",r="endsWith",i=new class{init(t){i.storeType=t.storeType,i.sectionsUrlRegex=coreUtils.safeRegex(t.sectionsMapping.sectionsUrlRegex),i.clientSections=t.sectionsMapping.clientSections||[],i.criteriaCleaningStrategy={[e.LIKE]:i.trimLikeCriteria,[e.REGEX]:i.trimRegexCriteria,[e.EQUALS]:i.trimEqualsCriteria},i.criteriaMatchingStrategy={[e.LIKE]:i.matchingLikeCriteria,[e.REGEX]:i.matchingRegexCriteria,[e.EQUALS]:i.matchingEqualsCriteria}}detect(){if(i.storeType&&"custom"!==i.storeType)return;if(!i.sectionsUrlRegex)return;const t=window.location.href;for(const n of i.clientSections){const r=n.criteria.split(",").map((e=>e.trim()));if(r.length>1)for(let e=1;e<r.length;e++)r[e].indexOf("}")>0&&2>r[e].indexOf("}")&&(r[e-1]+=","+r[e],r[e]="");const o=i.getMatchedUrlSection(t,i.sectionsUrlRegex,n.capture_group);for(const t of r){const r=i.getCriteriaStrategy(t);if(!Object.values(e).includes(r))break;const s=i.criteriaCleaningStrategy[r],a=i.criteriaMatchingStrategy[r],[c,l]=s(t);if(a(o,c,l))return notifier.fire("pageType",n.section),n.section}}}getMatchedUrlSection(e,t,n){const r=RegExp(t,"gi").exec(e);return r.length<n?"":r[n]?r[n].toLowerCase():""}getCriteriaStrategy(t){for(const n of Object.values(e))if(t.startsWith(n))return n}trimLikeCriteria(e){const i=e.replace("like ","");let o;return i.startsWith("'%")&&i.endsWith("%'")?o=t:i.startsWith("'%")?o=r:i.endsWith("%'")&&(o=n),[i.replace(/%/g,"").replace(/'/g,""),o]}trimRegexCriteria(e){return[e.replace("regex","").replace("(","").replace(")","").replace(/'/g,"")]}trimEqualsCriteria(e){return[e.replace("=","").replace(/'/g,"").replace(/"/g,"")]}matchingLikeCriteria(e,i,o){switch(o){case t:return-1!==e.indexOf(i);case n:return e.startsWith(i);case r:return e.endsWith(i);default:return!1}}matchingRegexCriteria(e,t){return RegExp(t,"g").test(e)}matchingEqualsCriteria(e,t){return(e||"").toLowerCase()===(t||"").toLowerCase()}};return i})(),cpuStrengthDetector=new class{constructor(){}detect(){let e=0,t=(new Date).getTime(),n=t;for(;n-t==0;)n=(new Date).getTime();for(t=n;2>n-t;)e++,n=(new Date).getTime();return e=Math.round(e/1),e}},coreDataStore=new class{constructor(){}init(){const e={pageType:pageTypeDetector.detect(),cpuStrength:cpuStrengthDetector.detect()};dal.coreDataStore.set(e)}get(e){return dal.coreDataStore.getOne(e)}},hookReader=(()=>{class e{constructor(){this.ready=!1}init(e,n){t.resetLocals(),t.hookReader=(e||[]).filter((e=>e.domains.includes("*")||e.domains.includes(n))).reduce(((e,t,n)=>(e[n+1]=t,e)),{});try{t.updateHooksValues()}catch(e){logger.error(e,"hookReader.init")}notifier.bind("hook-cycle",t.updateHooksValues.bind(this)),t.storageManager=storageManagers.getStorageManager(),t.ready=!0}resetLocals(){t.ready=!1}isReady(){return t.ready}static memoryHookParser(e,t){return coreUtils.get(e,t)}getValueByPartialKey(e,t){let n;for(n in e)if(e.hasOwnProperty(n)&&-1!==n.indexOf(t))return e[n];return null}getHook(n,r){if(!n[r])return"";const i=n[r];if(!i.readFrom)return"";const o=i.key;let s,a;switch(i.readFrom.toLowerCase()){case"cookie":s=i.contains?t.getValueByPartialKey(coreUtils.getCookie(),o):coreUtils.getCookie(o);break;case"localstorage":s=i.contains?t.getValueByPartialKey(localStorage,o):localStorage.getItem(o);break;case"sessionStorage":s=i.contains?t.getValueByPartialKey(sessionStorage,o):sessionStorage.getItem(o);break;case"memory":s=e.memoryHookParser(window,o);break;case"session":s=dal.session.get()[o]}let c=i.parser;try{a=coreUtils.isUndefined(c)||null===c||""===c||coreUtils.isUndefined(s)||null===s||""===s?s:((e,t)=>{const n={utils:coreUtils,dal:dal};return Function("rawVal","context",`const {utils,dal}=context;const parser = ${t};return parser(rawVal);`)(e,n)})(s,c)}catch(e){logger.error(e)}return"sessionid"===i.role&&a!==dal.hookReader.getOne("clientSessionId")&&dal.hookReader.set({clientSessionId:a}),0===a?0:!1!==a&&(a||void 0)}updateHooksValues(){const e=dal.hookReader.get();let n;try{const r={};let i="";for(n in t.hookReader){if(!t.hookReader.hasOwnProperty(n))continue;const o=t.getHook(t.hookReader,n);coreUtils.isUndefined(o)||(i=t.hookReader[n].param||"ca"+n,e[i]!==o&&(r[i]=o))}0!==Object.keys(r).length&&dal.hookReader.set(r)}catch(e){throw Error(`Failed in updateHooksValues: ${e} , Param Name : ${n?t.hookReader[n].param:"unknown"}`)}}}const t=new e;return dal.hookReader.onchange((function(){notifier.fire("data-added")})),t})(),storageManagers=(()=>{class e{constructor(e){this.storageManageName=e}static getStorage(e){if(!localStorage)return{};const t=localStorage.getItem(e);return t||localStorage.setItem(e,JSON.stringify({})),JSON.parse(t)||{}}getRelevantStorage(){return e.getStorage(this.storageManageName)}getItem(e){return this.getRelevantStorage()[e]}getItemSync(e){return this.getRelevantStorage()[e]}getAll(){return this.getRelevantStorage()}setItem(e,t){if(!localStorage)return;const n=this.getRelevantStorage();n[e]=t,this.localStorageSetItem(this.storageManageName,JSON.stringify(n))}removeItem(e){if(!localStorage)return;const t=this.getRelevantStorage();delete t[e],this.localStorageSetItem(this.storageManageName,JSON.stringify(t))}localStorageSetItem(e,t){try{return localStorage.setItem(e,t),null}catch(n){const r=`${n.message} - local storage item: '${e}', value length: ${t.length}`;logger.warn(n,r);try{return coreTracker.isReady()&&coreTracker.reportEventsError("sendGetEventViaWebWorker",{message:r,stack:n.stack}),r}catch(e){}}}}const t=new class{init(){t.sharedStorageItemName="nmg_"+storesConfigurations.clientTag,t.storageManagers={[t.sharedStorageItemName]:new e(t.sharedStorageItemName)}}getStorageManager(n){let r;return n=n||t.sharedStorageItemName,Object.keys(t.storageManagers).includes(n)?r=t.storageManagers[n]:(r=new e(n),t.storageManagers[n]=r),r}removeStorage(e){localStorage.removeItem(e)}};return t})(),nmgDictionaryManager=(()=>{let e;const t="nmgCommonDictionary",n=t,r=new class{constructor(){this.nmgDictionaryData=null}init(t){if(null===t)return void(r.nmgDictionaryData={version:null,affinities:{[JDLDataPointNames.SPORT]:[],[JDLDataPointNames.LUXURY]:[],[JDLDataPointNames.BRAND]:[],[JDLDataPointNames.APPLIANCE]:[],[JDLDataPointNames.BEAUTY]:[],[JDLDataPointNames.SALES]:[]},cartDataPatterns:{subTotal:[],tax:[],shipping:[],total:[],promotions:[]},currencyMapper:{}});e=`${GLOBALS.cdnUrl}${n}.json`;const i=r.getFromStorage();!i||t>i.version?(notifier.retroBind("nmgCommonDictionaryLoaded",(e=>{r.nmgDictionaryData=e,r.setToStorage(e)})),r.fetchFromRemote()):r.nmgDictionaryData=i}getFromStorage(){const e=localStorage.getItem(t);if(!e)return null;try{return JSON.parse(e)}catch(e){return logger.error(e),null}}setToStorage(e){localStorage.setItem(t,JSON.stringify(e))}fetchFromRemote(){new NmgWorker((e=>{fetch(e.remoteUrl).then((e=>e.json())).then((e=>NmgWorker.postMessage(e)))}),(e=>{notifier.fire("nmgCommonDictionaryLoaded",e)}),{async:!0,fallback:async()=>{fetch(e).then((e=>e.json())).then((e=>{notifier.fire("nmgCommonDictionaryLoaded",e)}))}}).run({remoteUrl:e})}getAffinities(){return r.nmgDictionaryData?r.nmgDictionaryData.affinities:void 0}getCartDataPatterns(){return r.nmgDictionaryData?r.nmgDictionaryData.cartDataPatterns:void 0}getCurrencyMapper(){return r.nmgDictionaryData?r.nmgDictionaryData.currencyMapper:void 0}};return r})(),cartDataDetector=(()=>{const e=new class{constructor(){this.cartDataPatterns={[CartSections.SUB_TOTAL]:[],[CartSections.TAX]:[],[CartSections.SHIPPING]:[],[CartSections.TOTAL]:[],[CartSections.PROMOTIONS]:[]}}init(t){e.cartDataPatterns=t}isMatching(t,n){const r=e.cartDataPatterns[t];for(const e of r)if(RegExp(`(?:^|\\s)${e}\\b`,"i").test(n))return!0;return!1}detect(t){const n={currency:null,cartDataElements:{[CartSections.SUB_TOTAL]:null,[CartSections.TAX]:null,[CartSections.SHIPPING]:null,[CartSections.TOTAL]:null,[CartSections.PROMOTIONS]:null}};for(const r of t){const t=r[ElementWithPrice.DESCRIPTION],i=e.isMatching(CartSections.SUB_TOTAL,t),o=e.isMatching(CartSections.TAX,t),s=e.isMatching(CartSections.SHIPPING,t),a=e.isMatching(CartSections.TOTAL,t),c=e.isMatching(CartSections.PROMOTIONS,t);if(!n.cartDataElements.subTotal&&i&&(n.cartDataElements.subTotal=+r[ElementWithPrice.PRICE]),n.cartDataElements.tax||!o||a||(n.cartDataElements.tax=+r[ElementWithPrice.PRICE]),!n.cartDataElements.shipping&&s&&(n.cartDataElements.shipping=+r[ElementWithPrice.PRICE]),!n.cartDataElements.total&&a&&(n.cartDataElements.total=+r[ElementWithPrice.PRICE]),!n.cartDataElements.promotions&&c&&(n.cartDataElements.promotions=+r[ElementWithPrice.PRICE]),r[ElementWithPrice.CURRENCY]){const e=decodeURIComponent(r[ElementWithPrice.CURRENCY]),t=nmgDictionaryManager.getCurrencyMapper();n.currency=t[e]}}return n}};return e})(),{dataCollector:dataCollector,getSessionData:getSessionData}=(()=>{class e{constructor(){this.snp={},this.commonReportFields=null,this.ready=!1,e.collectAdditionalData()}init(e){t.resetLocals(),t.snp=e,t.ready=!0,t.checkRevenueCollector(),notifier.fire("DataCollectorInit")}resetLocals(){t.snp={},t.commonReportFields=null,t.ready=!1}isReady(){return t.ready}static collectAdditionalData(){setInterval((()=>{notifier.fire("hook-cycle")}),dataCollectorIntervals)}static getCustomSegment(){let e={};const t=function(){try{return dal.hookReader.get()}catch(e){return{}}}();for(const[n,r]of Object.entries(t))n.includes("customHook_")&&(e[n]=r);return e}getMMCChannelName(e){if(!e)return null;let n="Unspecified MMC";if(0>e.indexOf("email")){const r=e.split("-_-");if(r.length>1){let e=!1;const i=("cpc"===r[0]||"affiliate"===r[0]?r[1]:r[0])||"";for(const r of t.snp.ref||[])if(r.valueParam===i.toLowerCase()){n=r.displayName,e=!0;break}e||(n=coreUtils.beautifyChannel(i))}}else n="Generic Email";return n}getChannelByBrowser(){const e=navigator.userAgent.toLowerCase();for(const t of browsers)if(t.values.some((t=>e.includes(t))))return t.displayName}getChannelByUtm(){const e=coreUtils.getQueryParamsAsObject();if(e){for(const n of t.snp.ref||[])if(e.hasOwnProperty(n.keyParam)&&(!n.valueParam||t.isUrlParam((e[n.keyParam]||"").toLowerCase(),(n.valueParam||"").toLowerCase())))return n.displayName;let n=e.utm_source;return["utm_source","utm_medium"].some((t=>e.hasOwnProperty(t)))&&(n="b2b"===e.utm_source&&e.partner?e.partner:e.utm_source),n?coreUtils.getUTMChannelName(n):t.getMMCChannelName(e.cm_mmc||e.cm_sp)}return null}isUrlParam(e,t){if(!e)return!1;const n=t.indexOf("*");if(-1===n)return e===t;if(0===n)return e.lastIndexOf(t.replace("*",""))===e.length-t.length+1;if(n===t.length-1)return 0===e.indexOf(t.replace("*",""));const r=t.split("*"),i=0===e.indexOf(r[0]),o=e.lastIndexOf(r[1])===e.length-r[1].length;return i&&o}getChannelByReferrer(){const e=document.referrer&&coreUtils.parseUrl(document.referrer),t=coreUtils.extractDomain(e.hostname);return t&&t.length>0&&window.location.hostname.indexOf(t)>=0?"Direct":t||null}calculateJsChannel(){let e;for(const n of[t.getChannelByBrowser,t.getChannelByUtm,t.getChannelByReferrer])try{if(e=n.bind(this)(),e)return e.substring(0,89)}catch(e){break}return"Direct"}getChannel(){const e=dal.session.getOne("js_channel");if(e)return e;const n=t.calculateJsChannel();return dal.session.set({js_channel:n}),n}getCommonReportFields(n=!1){try{if(!t.commonReportFields||n){const{tag:n}=t.snp;t.commonReportFields={clienttag:n,cb:coreUtils.getDateNow(),ua:navigator.userAgent.substring(0,1024),domain:storesConfigurations.domain,full_domain:coreUtils.parseUrl(window.location.href).hostname,device_type:coreUtils.getDevice(),browser:coreUtils.getBrowser(),os:coreUtils.getOS(),js_channel:t.getChannel(),is_bot:coreUtils.isBot()||"bot"===coreUtils.getDevice(),custom_segments:e.getCustomSegment(),href:window.location.href.substring(0,4e3),referrer:document.referrer.substring(0,2e3)}}else t.commonReportFields.custom_segments=e.getCustomSegment();return t.commonReportFields}catch(e){return{}}}getRevenueCollection(e=1){let n=e;n>3||setTimeout((()=>{let e=document.querySelectorAll("div *"),r=coreUtils.findElementsWithPrices(e,!0);0===r.length&&(e=document.querySelectorAll("td *"),r=coreUtils.findElementsWithPrices(e,!0)),0===r.length&&coreUtils.isMobileDevice()&&(e=document.querySelectorAll("div *"),r=coreUtils.findElementsWithPrices(e,!1)),r.length||3===n?(logger.info({currNumOfTries:n},"getRevenueCollection: Data was found or number of retries exceeded!"),t.handleRevenueCollection(r)):(logger.info({currNumOfTries:n},"getRevenueCollection: No data was detected from cart and checkout about to try again!"),n++,t.getRevenueCollection(n))}),e>1?1e3:0)}checkRevenueCollector(){const e=pageTypeDetector.detect();if(e&&["cart","checkout"].includes(e.toLowerCase())&&t.snp.cc[ClientFeatureFlags.REVENUE_COLLECTION]){const e=coreUtils.parseUrl(window.location.href).domainname,n=t.snp.cc.rh&&t.snp.cc.rh.filter((t=>t.domains.includes("*")||t.domains.includes(e))).reduce(((e,t,n)=>(e[n+1]=t,e)),{});let r=null;n?(Object.keys(n).forEach((e=>{r=hookReader.getHook(n,e)})),t.handleRevenueCollection(r)):t.getRevenueCollection()}}handleRevenueCollection(e){logger.info(e,"We detected the following revenue from cart and checkout:");const t=dal.session.getOne("revenueData");if(JSON.stringify(t)!==JSON.stringify(e)){const t=cartDataDetector.detect(e);dal.session.set({revenueData:e,automatedCartData:{currency:t.currency,...t.cartDataElements}}),coreReports.setShouldSend(),notifier.fire("cart-data-collected",t)}}}const t=new e;return{dataCollector:t,getSessionData:function(){try{return dal.session.get()}catch(e){return{}}}}})(),coreReports=(()=>{class e{init(){t.cycle=1,t.shouldSend=!1,t.loopInterval=5e3,t.eventsCounter=0,setTimeout((()=>{t.updateStack()}),t.loopInterval)}setShouldSend(){t.shouldSend=!0}addToEventsCounter(){t.eventsCounter++}updateStack(){0===t.eventsCounter&&t.shouldSend&&(t.shouldSend=!1,t.reportEvent()),t.cycle+=1,t.eventsCounter=0,logger.log(`**** Cycle ${t.cycle} ****`,"coreUpdateStack"),setTimeout((()=>{t.updateStack()}),t.loopInterval)}static getCoreReportData(){const e=configurationsGetters.useHangTimeMeasurer?hangTimeMeasure().getAndReset():null,n=dataCollector.getCommonReportFields(),r=EventsTopics.coreStack,i=dal.session.get();return t.removeAndResetRevenueCollection(),{action:r,...configurationsGetters.versions,...n,coreReport:{scriptHangData:e,event_cb:coreUtils.getDateNow()},pv:i.pv,sid:i.pi_sessionid,uuid:i.pi_userid,nmgtag:n.clienttag,revenuecollection:i.revenueData,revenueData:i.automatedCartData}}static getLightDefaultCoreReportData(){const e=EventsTopics.coreStack,t=dal.session.get(),n=dataCollector.getCommonReportFields();let r={action:e,nmgtag:n.clienttag,domain:n.domain,sid:t.pi_sessionid,event_time:coreUtils.getDateNow(),href:window.location.href};return dal.session.getOne("isFirstCoreStackCall")&&(dal.session.set({isFirstCoreStackCall:!1}),r.uuid=t.pi_userid||t.uuid,r.cb=n.cb,r.device_type=n.device_type,r.browser=n.browser,r.os=n.os),r}getCoreReportDataLight(){const e=configurationsGetters.useHangTimeMeasurer?hangTimeMeasure().getAndReset():null,{revenueData:t}=dal.session.get();return{...configurationsGetters.versions,coreReport:{scriptHangData:e,event_cb:coreUtils.getDateNow()}}}reportEvent(t,n){let r=t?e.getLightDefaultCoreReportData():e.getCoreReportData();n&&(r={...r,...n}),coreTracker.reportEventsStack("sendGetEventViaWebWorker",r)}removeAndResetRevenueCollection(){t.shouldSend=!1,dal.session.set({revenueData:null})}}const t=new e;return t})(),{chpTracker:chpTracker,coreTracker:coreTracker}=(()=>{const e=["Object.entries is not a function","SecurityError: Failed to read the 'localStorage' property from 'Window'","SecurityError: The operation is insecure"],t=(e,t)=>({action:EventsTopics.coreError,nmgtag:e,href:window.location.href.substring(0,4e3),domain:coreUtils.parseUrl(window.location.href).hostname,ua:navigator.userAgent.substring(0,1024),device_type:coreUtils.getDevice(),browser:coreUtils.getBrowser(),os:coreUtils.getOS(),cb:coreUtils.getDateNow(),message:t.message,stack:t.stack,module:t.module||"core"});class n{constructor(e=!1){this.isCore=e,this.ready=!1}init(e,t){r.host=e,r.productEndpoint=t,r.ready=!0}isReady(){return r.ready}async sendPostEvent(e,t){if(logger.info(t,"Stack-event (POST):"),n.shouldBeIgnored(t))return;const i=await r.getDataToSend(t,e);r.fetchWrapper(`${r.host}/${r.productEndpoint}`,{...FetchConfigs.POST,body:i})}async sendGetEvent(e,t){if(logger.info(t,"Stack-event (GET):"),n.shouldBeIgnored(t))return;const i=await r.getDataToSend(t,e);r.fetchWrapper(`${r.host}/${r.productEndpoint}?${i}`,FetchConfigs.GET)}async sendGetEventViaWebWorker(e,t){try{if(logger.info(t,"Stack-event (GET-WB):"),n.shouldBeIgnored(t))return;const i=await r.getDataToSend(t,e),o=`${r.host}/${r.productEndpoint}?${i}`,s=new NmgWorker((e=>{const t=e.url,n=e.FetchConfigs;fetch(t,n.GET).then()}),(()=>{}),{fallback:()=>r.sendGetEvent(e,t).then()});s.run({url:o,FetchConfigs:FetchConfigs})}catch(n){r.sendGetEvent(e,t).then()}}async sendPostEventViaWebWorker(e,t){try{if(logger.info(t,"Stack-event (POST-WB):"),n.shouldBeIgnored(t))return;const i=await r.getDataToSend(t,e),o={...FetchConfigs.POST,body:i},s=`${r.host}/${r.productEndpoint}`,a=new NmgWorker((e=>{const t=e.url,n=e.init;fetch(t,n).then()}),(()=>{}),{fallback:()=>r.sendPostEvent(e,t).then()});a.run({url:s,init:o})}catch(n){r.sendPostEvent(e,t)}}reportEventsStack(e,t){this[e](EventsTopics.stack,t).catch()}static shouldBeIgnored(t){let n=JSON.stringify({event:t});for(let t of e)if(n.includes(t))return!0;return!1}async getDataToSend(e,t){coreReports.addToEventsCounter();const n=r.isCore?{}:coreReports.getCoreReportDataLight(),i=coreUtils.reformatJsonToKeysAndValues({...n,...e,topic:t});return configurationsGetters.cc[ClientFeatureFlags.EVENT_COMPRESSION]?"m="+await coreUtils.compressEventData(i):"d="+encryption.encrypt(i)}fetchWrapper(e,t){try{fetch(e,t).then((e=>e),(t=>{logger.info(`Failed to report event. url: ${e}, err: ${t}`,"stack-error")}))}catch(e){logger.info("Failed in fetch-wrapper. err: "+e,"stack-error")}}}const r=new n,i=new class extends n{reportEventsError(e,n,r){const o=r?t(r,n):(e=>({...t(configurationsGetters.configurations.tag,e),uuid:dal.session.getOne("pi_userid"),sid:dal.session.getOne("pi_sessionid"),pv:dal.session.getOne("pv"),...configurationsGetters.versions}))(n);i[e](null,o).catch()}}(!0);return{chpTracker:r,coreTracker:i}})();GLOBALS.coreTracker=coreTracker;const performanceTiming=(()=>{const e=new class{constructor(){this.scriptStartTime=0,this.scriptEndTime=0,this.apiDuration=0}setScriptStartTime(t){e.scriptStartTime=t}setScriptEndTime(t){e.scriptEndTime=t}addApiDuration(t){e.apiDuration+=t}calcPerformanceTiming(){return{pt_load:Math.max(performance.timing.loadEventEnd-performance.timing.navigationStart,-1),pt_redirect:Math.max(performance.timing.redirectEnd-performance.timing.redirectStart,-1),pt_cache:Math.max(performance.timing.domainLookupStart-performance.timing.fetchStart,-1),pt_dns:Math.max(performance.timing.domainLookupEnd-performance.timing.domainLookupStart,-1),pt_tcp:Math.max(performance.timing.connectEnd-performance.timing.connectStart,-1),pt_request:Math.max(performance.timing.responseStart-performance.timing.requestStart,-1),pt_response:Math.max(performance.timing.responseEnd-performance.timing.responseStart,-1),pt_domInteractive:Math.max(performance.timing.domInteractive-performance.timing.domLoading,-1),pt_domContentLoaded:Math.max(performance.timing.domContentLoadedEventEnd-performance.timing.domContentLoadedEventStart,-1),pt_domComplete:Math.max(performance.timing.domComplete-performance.timing.domContentLoadedEventEnd,-1),pt_onLoad:Math.max(performance.timing.loadEventEnd-performance.timing.loadEventStart,-1),pt_scriptStartTime:Math.max(e.scriptStartTime-performance.timing.navigationStart,-1),pt_scriptRunTime:Math.max(e.scriptEndTime-e.scriptStartTime,-1),...e.apiDuration&&{pt_apiResponseTime:Math.max(e.apiDuration,-1)}}}sendPerformanceTiming(t){const n=dal.hookReader.get(),r=dataCollector.getCommonReportFields(),i=dal.session.get();if(!r||!r.clienttag||!r.domain)return;const o={action:"performanceTiming",event_time:(new Date).getTime(),nmgtag:r.clienttag,domain:r.domain,device_type:r.device_type,cb:r.cb,os:r.os,ua:r.ua,href:r.href,browser:r.browser,pv:i.pv,sid:i.pi_sessionid,cycle:i.cycle||"1",uuid:(i.pi_userid||"").toString(),...n.ca1&&{client_attr1:n.ca1},...n.ca2&&{client_attr2:n.ca2},...e.calcPerformanceTiming()};coreTracker.reportEventsStack(EventRequestType.GET_VIAWEBWORKER,o)}init(t,n,r){100*Math.random()<t&&1===dal.session.get().pv&&setTimeout((()=>e.sendPerformanceTiming(r)),n)}};return e})(),{prepareSnapshot:prepareSnapshot}=(()=>{const e=((o=n=n||{}).runningInNodeJS=function(){return"object"==typeof process&&"object"==typeof process.versions&&"string"==typeof process.versions.node},o.runningInMainNodeJSModule=function(){return o.runningInNodeJS()&&require.main===module},o.commonJSAvailable=function(){return"object"==typeof module&&"object"==typeof module.exports},o.runningInWebWorker=function(){return"undefined"==typeof window&&"object"==typeof self&&"function"==typeof self.addEventListener&&"function"==typeof self.close},o.runningInNodeChildProcess=function(){return o.runningInNodeJS()&&"function"==typeof process.send},o.runningInNullOrigin=function(){return"object"==typeof window&&"object"==typeof window.location&&"object"==typeof document&&"http:"!==document.location.protocol&&"https:"!==document.location.protocol},o.webWorkersAvailable=function(){return!("function"!=typeof Worker||o.runningInNullOrigin()||o.runningInNodeJS()||navigator&&navigator.userAgent&&navigator.userAgent.indexOf("Android 4.3")>=0)},o.log=function(e,t){void 0===t&&(t=!1),"object"==typeof console&&(console.log(e),t&&"object"==typeof document&&(document.body.innerHTML+=e+"<br/>"))},o.createErrorMessage=function(e,t){return void 0===t&&(t="Unhandled exception"),null==e?t:(t+=": ","object"==typeof e.content?o.runningInNodeJS()?t+e.content.stack:"{}"!==(n=JSON.stringify(e.content))?t+n:t+e.content:"string"==typeof e.content?t+e.content:t+e);var n},o.printExceptionAndStackTraceToConsole=function(e,t){o.log(o.createErrorMessage(e,t=void 0===t?"Unhandled exception":t))},o.getGlobalObject=function(){return"object"==typeof global?global:"object"==typeof window?window:"object"==typeof self?self:{}},o.toString={}.toString,o.commonJSAvailable()&&(module.exports=o),function(){var e,t,n;if("function"==typeof Uint8Array&&0!==new Uint8Array(1).subarray(1).byteLength){function r(e,t){function n(e,t,n){return t>e?t:e>n?n:e}e|=0,t|=0,1>arguments.length&&(e=0),2>arguments.length&&(t=this.length),0>e&&(e=this.length+e),0>t&&(t=this.length+t),e=n(e,0,this.length);var r=(t=n(t,0,this.length))-e;return new this.constructor(this.buffer,this.byteOffset+e*this.BYTES_PER_ELEMENT,r=0>r?0:r)}if(e=["Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array"],t=void 0,"object"==typeof window?t=window:"object"==typeof self&&(t=self),void 0!==t)for(n=0;9>n;n++)t[e[n]]&&(t[e[n]].prototype.subarray=r)}}(t=t||{}),function(e){function t(e,t,n){this.container=e,this.startPosition=t,this.length=n}t.prototype.get=function(e){return this.container[this.startPosition+e]},t.prototype.getInReversedOrder=function(e){return this.container[this.startPosition+this.length-1-e]},t.prototype.set=function(e,t){this.container[this.startPosition+e]=t},e.ArraySegment=t}(n=n||{}),(i=(i=n=n||{}).ArrayTools||(i.ArrayTools={})).copyElements=function(e,t,n,r,i){for(;i--;)n[r++]=e[t++]},i.zeroElements=function(e,t,n){for(;n--;)e[t++]=0},i.countNonzeroValuesInArray=function(e){for(var t=0,n=0;n<e.length;n++)e[n]&&t++;return t},i.truncateStartingElements=function(e,t){if(e.length<=t)throw new RangeError("truncateStartingElements: Requested length should be smaller than array length");for(var n=e.length-t,r=0;t>r;r++)e[r]=e[n+r];e.length=t},i.doubleByteArrayCapacity=function(e){var t=new Uint8Array(2*e.length);return t.set(e),t},i.concatUint8Arrays=function(e){var t,n,r,i,o,s,a,c;for(t=0,n=0,r=e;n<r.length;n++)t+=(c=r[n]).length;for(i=new Uint8Array(t),o=0,s=0,a=e;s<a.length;s++)c=a[s],i.set(c,o),o+=c.length;return i},i.splitByteArray=function(e,t){var n,r,i;for(n=[],r=0;r<e.length;)i=Math.min(t,e.length-r),n.push(e.subarray(r,r+i)),r+=i;return n},function(e){var t;(t=e.BufferTools||(e.BufferTools={})).convertToUint8ArrayIfNeeded=function(e){return"function"==typeof Buffer&&Buffer.isBuffer(e)?t.bufferToUint8Array(e):e},t.uint8ArrayToBuffer=function(e){var t,n,r,i;if(Buffer.prototype instanceof Uint8Array)return t=new Uint8Array(e.buffer,e.byteOffset,e.byteLength),Object.setPrototypeOf(t,Buffer.prototype),t;for(n=e.length,r=new Buffer(n),i=0;n>i;i++)r[i]=e[i];return r},t.bufferToUint8Array=function(e){if(Buffer.prototype instanceof Uint8Array)return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);for(var t=e.length,n=new Uint8Array(t),r=0;t>r;r++)n[r]=e[r];return n}}(n=n||{}),function(e){var t;(t=e.CompressionCommon||(e.CompressionCommon={})).getCroppedBuffer=function(e,t,n,r){return void 0===r&&(r=0),(r=new Uint8Array(n+r)).set(e.subarray(t,t+n)),r},t.getCroppedAndAppendedByteArray=function(t,n,r,i){return e.ArrayTools.concatUint8Arrays([t.subarray(n,n+r),i])},t.detectCompressionSourceEncoding=function(e){if(null==e)throw new TypeError("detectCompressionSourceEncoding: input is null or undefined");if("string"==typeof e)return"String";if(e instanceof Uint8Array||"function"==typeof Buffer&&Buffer.isBuffer(e))return"ByteArray";throw new TypeError("detectCompressionSourceEncoding: input must be of type 'string', 'Uint8Array' or 'Buffer'")},t.encodeCompressedBytes=function(t,n){switch(n){case"ByteArray":return t;case"Buffer":return e.BufferTools.uint8ArrayToBuffer(t);case"Base64":return e.encodeBase64(t);case"BinaryString":return e.encodeBinaryString(t);case"StorageBinaryString":return e.encodeStorageBinaryString(t);default:throw new TypeError("encodeCompressedBytes: invalid output encoding requested")}},t.decodeCompressedBytes=function(t,n){if(null==n)throw new TypeError("decodeCompressedData: Input is null or undefined");switch(n){case"ByteArray":case"Buffer":var r=e.BufferTools.convertToUint8ArrayIfNeeded(t);if(r instanceof Uint8Array)return r;throw new TypeError("decodeCompressedData: 'ByteArray' or 'Buffer' input type was specified but input is not a Uint8Array or Buffer");case"Base64":if("string"!=typeof t)throw new TypeError("decodeCompressedData: 'Base64' input type was specified but input is not a string");return e.decodeBase64(t);case"BinaryString":if("string"!=typeof t)throw new TypeError("decodeCompressedData: 'BinaryString' input type was specified but input is not a string");return e.decodeBinaryString(t);case"StorageBinaryString":if("string"!=typeof t)throw new TypeError("decodeCompressedData: 'StorageBinaryString' input type was specified but input is not a string");return e.decodeStorageBinaryString(t);default:throw new TypeError("decodeCompressedData: invalid input encoding requested: '".concat(n,"'"))}},t.encodeDecompressedBytes=function(t,n){switch(n){case"String":return e.decodeUTF8(t);case"ByteArray":return t;case"Buffer":if("function"!=typeof Buffer)throw new TypeError("encodeDecompressedBytes: a 'Buffer' type was specified but is not supported at the current envirnment");return e.BufferTools.uint8ArrayToBuffer(t);default:throw new TypeError("encodeDecompressedBytes: invalid output encoding requested")}}}(n=n||{}),function(e){var t,n,r,i;n=t=e.EventLoop||(e.EventLoop={}),i=[],n.enqueueImmediate=function(e){i.push(e),1===i.length&&r()},n.initializeScheduler=function(){function t(){var t,n,r;for(t=0,n=i;t<n.length;t++){r=n[t];try{r.call(void 0)}catch(t){e.printExceptionAndStackTraceToConsole(t,"enqueueImmediate exception")}}i.length=0}var n,o,s;e.runningInNodeJS()&&(r=function(){return setImmediate(t)}),r="object"==typeof window&&"function"==typeof window.addEventListener&&"function"==typeof window.postMessage?(n="enqueueImmediate-"+Math.random().toString(),window.addEventListener("message",(function(e){e.data===n&&t()})),o=e.runningInNullOrigin()?"*":window.location.href,function(){return window.postMessage(n,o)}):"function"==typeof MessageChannel&&"function"==typeof MessagePort?((s=new MessageChannel).port1.onmessage=t,function(){return s.port2.postMessage(0)}):function(){return setTimeout(t,0)}},n.initializeScheduler(),e.enqueueImmediate=function(e){return t.enqueueImmediate(e)}}(n=n||{}),function(e){var t;(t=e.ObjectTools||(e.ObjectTools={})).override=function(e,n){return t.extend(e,n)},t.extend=function(e,t){if(null==e)throw new TypeError("obj is null or undefined");if("object"!=typeof e)throw new TypeError("obj is not an object");if("object"!=typeof(t=null==t?{}:t))throw new TypeError("newProperties is not an object");if(null!=t)for(var n in t)e[n]=t[n];return e}}(n=n||{}),(r=n=n||{}).getRandomIntegerInRange=function(e,t){return e+Math.floor(Math.random()*(t-e))},r.getRandomUTF16StringOfLength=function(e){var t,n,i;for(t="",n=0;e>n;n++){for(i=void 0;(i=r.getRandomIntegerInRange(0,1114112))>=55296&&57343>=i;);t+=r.Encoding.CodePoint.decodeToString(i)}return t},function(e){function t(e){this.outputBufferCapacity=e=void 0===e?1024:e,this.outputPosition=0,this.outputString="",this.outputBuffer=new Uint16Array(this.outputBufferCapacity)}t.prototype.appendCharCode=function(e){this.outputBuffer[this.outputPosition++]=e,this.outputPosition===this.outputBufferCapacity&&this.flushBufferToOutputString()},t.prototype.appendCharCodes=function(e){for(var t=0,n=e.length;n>t;t++)this.appendCharCode(e[t])},t.prototype.appendString=function(e){for(var t=0,n=e.length;n>t;t++)this.appendCharCode(e.charCodeAt(t))},t.prototype.appendCodePoint=function(e){if(e>65535){if(e>1114111)throw Error("appendCodePoint: A code point of ".concat(e," cannot be encoded in UTF-16"));this.appendCharCode(55296+(e-65536>>>10)),this.appendCharCode(56320+(e-65536&1023))}else this.appendCharCode(e)},t.prototype.getOutputString=function(){return this.flushBufferToOutputString(),this.outputString},t.prototype.flushBufferToOutputString=function(){this.outputPosition===this.outputBufferCapacity?this.outputString+=String.fromCharCode.apply(null,this.outputBuffer):this.outputString+=String.fromCharCode.apply(null,this.outputBuffer.subarray(0,this.outputPosition)),this.outputPosition=0},e.StringBuilder=t}(n=n||{}),function(e){function t(){this.restart()}t.prototype.restart=function(){this.startTime=t.getTimestamp()},t.prototype.getElapsedTime=function(){return t.getTimestamp()-this.startTime},t.prototype.getElapsedTimeAndRestart=function(){var e=this.getElapsedTime();return this.restart(),e},t.prototype.logAndRestart=function(t,n){void 0===n&&(n=!0);var r=this.getElapsedTime();return t="".concat(t,": ").concat(r.toFixed(3),"ms"),e.log(t,n),this.restart(),r},t.getTimestamp=function(){return this.timestampFunc||this.createGlobalTimestampFunction(),this.timestampFunc()},t.getMicrosecondTimestamp=function(){return Math.floor(1e3*t.getTimestamp())},t.createGlobalTimestampFunction=function(){var e,t,n,r;"object"==typeof process&&"function"==typeof process.hrtime?(e=0,this.timestampFunc=function(){var t=1e3*(t=process.hrtime())[0]+t[1]/1e6;return e+t},e=Date.now()-this.timestampFunc()):"object"==typeof chrome&&chrome.Interval?(t=Date.now(),(n=new chrome.Interval).start(),this.timestampFunc=function(){return t+n.microseconds()/1e3}):"object"==typeof performance&&performance.now?(r=Date.now()-performance.now(),this.timestampFunc=function(){return r+performance.now()}):this.timestampFunc=Date.now?function(){return Date.now()}:function(){return(new Date).getTime()}},e.Timer=t}(n=n||{}),function(e){function t(t){void 0===t&&(t=!0),this.MinimumSequenceLength=4,this.MaximumSequenceLength=31,this.MaximumMatchDistance=32767,this.PrefixHashTableSize=65537,this.inputBufferStreamOffset=1,t&&"function"==typeof Uint32Array?this.prefixHashTable=new e.CompressorCustomHashTable(this.PrefixHashTableSize):this.prefixHashTable=new e.CompressorSimpleHashTable(this.PrefixHashTableSize)}t.prototype.compressBlock=function(t){if(null==t)throw new TypeError("compressBlock: undefined or null input received");return"string"==typeof t&&(t=e.encodeUTF8(t)),t=e.BufferTools.convertToUint8ArrayIfNeeded(t),this.compressUtf8Block(t)},t.prototype.compressUtf8Block=function(e){var t,n,r,i,o,s,a,c,l;if(!e||0==e.length)return new Uint8Array(0);for(t=this.cropAndAddNewBytesToInputBuffer(e),n=this.inputBuffer,r=this.inputBuffer.length,this.outputBuffer=new Uint8Array(e.length),i=this.outputBufferPosition=0,o=t;r>o;o++)c=n[o],l=i>o,o>r-this.MinimumSequenceLength?l||this.outputRawByte(c):(s=this.getBucketIndexForPrefix(o),l||null!=(a=this.findLongestMatch(o,s))&&(this.outputPointerBytes(a.length,a.distance),i=o+a.length,l=!0),l||this.outputRawByte(c),a=this.inputBufferStreamOffset+o,this.prefixHashTable.addValueToBucket(s,a));return this.outputBuffer.subarray(0,this.outputBufferPosition)},t.prototype.findLongestMatch=function(e,t){var n,r,i,o,s,a,c,l,d=this.prefixHashTable.getArraySegmentForBucketIndex(t,this.reusableArraySegmentObject);if(null==d)return null;for(r=this.inputBuffer,i=0,o=0;o<d.length&&(a=e-(s=d.getInReversedOrder(o)-this.inputBufferStreamOffset),c=void 0,c=void 0===n?this.MinimumSequenceLength-1:128>n&&a>=128?i+(i>>>1):i,a<=this.MaximumMatchDistance&&c<this.MaximumSequenceLength&&e+c<r.length);o++)if(r[s+c]===r[e+c])for(l=0;;l++){if(e+l===r.length||r[s+l]!==r[e+l]){l>c&&(n=a,i=l);break}if(l===this.MaximumSequenceLength)return{distance:a,length:this.MaximumSequenceLength}}return void 0!==n?{distance:n,length:i}:null},t.prototype.getBucketIndexForPrefix=function(e){return(7880599*this.inputBuffer[e]+39601*this.inputBuffer[e+1]+199*this.inputBuffer[e+2]+this.inputBuffer[e+3])%this.PrefixHashTableSize},t.prototype.outputPointerBytes=function(e,t){128>t?(this.outputRawByte(192|e),this.outputRawByte(t)):(this.outputRawByte(224|e),this.outputRawByte(t>>>8),this.outputRawByte(255&t))},t.prototype.outputRawByte=function(e){this.outputBuffer[this.outputBufferPosition++]=e},t.prototype.cropAndAddNewBytesToInputBuffer=function(t){var n,r;return void 0===this.inputBuffer?(this.inputBuffer=t,0):(n=Math.min(this.inputBuffer.length,this.MaximumMatchDistance),r=this.inputBuffer.length-n,this.inputBuffer=e.CompressionCommon.getCroppedAndAppendedByteArray(this.inputBuffer,r,n,t),this.inputBufferStreamOffset+=r,n)},e.Compressor=t}(n=n||{}),function(e){function t(e){this.minimumBucketCapacity=4,this.maximumBucketCapacity=64,this.bucketLocators=new Uint32Array(2*e),this.storage=new Uint32Array(2*e),this.storageIndex=1}t.prototype.addValueToBucket=function(t,n){t<<=1,this.storageIndex>=this.storage.length>>>1&&this.compact();var r,i,o=this.bucketLocators[t];0===o?(o=this.storageIndex,r=1,this.storage[this.storageIndex]=n,this.storageIndex+=this.minimumBucketCapacity):(i=o+(r=(r=this.bucketLocators[t+1])===this.maximumBucketCapacity-1?this.truncateBucketToNewerElements(o,r,this.maximumBucketCapacity/2):r),0===this.storage[i]?(this.storage[i]=n,i===this.storageIndex&&(this.storageIndex+=r)):(e.ArrayTools.copyElements(this.storage,o,this.storage,this.storageIndex,r),o=this.storageIndex,this.storageIndex+=r,this.storage[this.storageIndex++]=n,this.storageIndex+=r),r++),this.bucketLocators[t]=o,this.bucketLocators[t+1]=r},t.prototype.truncateBucketToNewerElements=function(t,n,r){return e.ArrayTools.copyElements(this.storage,t+n-r,this.storage,t,r),e.ArrayTools.zeroElements(this.storage,t+r,n-r),r},t.prototype.compact=function(){var t,n,r,i,o,s=this.bucketLocators,a=this.storage;for(this.bucketLocators=new Uint32Array(this.bucketLocators.length),this.storageIndex=1,t=0;t<s.length;t+=2)0!==(n=s[t+1])&&(this.bucketLocators[t]=this.storageIndex,this.bucketLocators[t+1]=n,this.storageIndex+=Math.max(Math.min(2*n,this.maximumBucketCapacity),this.minimumBucketCapacity));for(this.storage=new Uint32Array(8*this.storageIndex),t=0;t<s.length;t+=2)0!==(o=s[t])&&(r=this.bucketLocators[t],i=this.bucketLocators[t+1],e.ArrayTools.copyElements(a,o,this.storage,r,i))},t.prototype.getArraySegmentForBucketIndex=function(t,n){var r=this.bucketLocators[t<<=1];return 0===r?null:void 0===n?new e.ArraySegment(this.storage,r,this.bucketLocators[t+1]):n},t.prototype.getUsedBucketCount=function(){return Math.floor(e.ArrayTools.countNonzeroValuesInArray(this.bucketLocators)/2)},t.prototype.getTotalElementCount=function(){for(var e=0,t=0;t<this.bucketLocators.length;t+=2)e+=this.bucketLocators[t+1];return e},e.CompressorCustomHashTable=t}(n=n||{}),function(e){function t(e){this.maximumBucketCapacity=64,this.buckets=Array(e)}t.prototype.addValueToBucket=function(t,n){var r=this.buckets[t];void 0===r?this.buckets[t]=[n]:(r.length===this.maximumBucketCapacity-1&&e.ArrayTools.truncateStartingElements(r,this.maximumBucketCapacity/2),r.push(n))},t.prototype.getArraySegmentForBucketIndex=function(t,n){return void 0===(t=this.buckets[t])?null:void 0===n?new e.ArraySegment(t,0,t.length):n},t.prototype.getUsedBucketCount=function(){return e.ArrayTools.countNonzeroValuesInArray(this.buckets)},t.prototype.getTotalElementCount=function(){for(var e=0,t=0;t<this.buckets.length;t++)void 0!==this.buckets[t]&&(e+=this.buckets[t].length);return e},e.CompressorSimpleHashTable=t}(n=n||{}),function(e){function t(){this.MaximumMatchDistance=32767,this.outputPosition=0}t.prototype.decompressBlockToString=function(t){return t=e.BufferTools.convertToUint8ArrayIfNeeded(t),e.decodeUTF8(this.decompressBlock(t))},t.prototype.decompressBlock=function(t){var n,r,i,o,s,a,c,l;for(this.inputBufferRemainder&&(t=e.ArrayTools.concatUint8Arrays([this.inputBufferRemainder,t]),this.inputBufferRemainder=void 0),n=this.cropOutputBufferToWindowAndInitialize(Math.max(4*t.length,1024)),r=0,i=t.length;i>r;r++)if((o=t[r])>>>6!=3)this.outputByte(o);else{if(s=o>>>5,r==i-1||r==i-2&&7==s){this.inputBufferRemainder=t.subarray(r);break}if(t[r+1]>>>7==1)this.outputByte(o);else for(a=31&o,o=void 0,6==s?(o=t[r+1],r+=1):(o=t[r+1]<<8|t[r+2],r+=2),c=this.outputPosition-o,l=0;a>l;l++)this.outputByte(this.outputBuffer[c+l])}return this.rollBackIfOutputBufferEndsWithATruncatedMultibyteSequence(),e.CompressionCommon.getCroppedBuffer(this.outputBuffer,n,this.outputPosition-n)},t.prototype.outputByte=function(t){this.outputPosition===this.outputBuffer.length&&(this.outputBuffer=e.ArrayTools.doubleByteArrayCapacity(this.outputBuffer)),this.outputBuffer[this.outputPosition++]=t},t.prototype.cropOutputBufferToWindowAndInitialize=function(t){var n,r;if(!this.outputBuffer)return this.outputBuffer=new Uint8Array(t),0;if(n=Math.min(this.outputPosition,this.MaximumMatchDistance),this.outputBuffer=e.CompressionCommon.getCroppedBuffer(this.outputBuffer,this.outputPosition-n,n,t),this.outputPosition=n,this.outputBufferRemainder){for(r=0;r<this.outputBufferRemainder.length;r++)this.outputByte(this.outputBufferRemainder[r]);this.outputBufferRemainder=void 0}return n},t.prototype.rollBackIfOutputBufferEndsWithATruncatedMultibyteSequence=function(){var e,t;for(e=1;4>=e&&this.outputPosition-e>=0;e++)if(t=this.outputBuffer[this.outputPosition-e],4>e&&t>>>3==30||3>e&&t>>>4==14||2>e&&t>>>5==6)return this.outputBufferRemainder=this.outputBuffer.subarray(this.outputPosition-e,this.outputPosition),void(this.outputPosition-=e)},e.Decompressor=t}(n=n||{}),function(e){var t,n,r,i;t=e.Encoding||(e.Encoding={}),n=t.Base64||(t.Base64={}),r=new Uint8Array([65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,48,49,50,51,52,53,54,55,56,57,43,47]),i=new Uint8Array([255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,62,255,255,255,63,52,53,54,55,56,57,58,59,60,61,255,255,255,0,255,255,255,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,255,255,255,255,255,255,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,255,255,255,255]),n.encode=function(t){return t&&0!=t.length?e.runningInNodeJS()?e.BufferTools.uint8ArrayToBuffer(t).toString("base64"):n.encodeWithJS(t):""},n.decode=function(t){return t?e.runningInNodeJS()?e.BufferTools.bufferToUint8Array(Buffer.from(t,"base64")):n.decodeWithJS(t):new Uint8Array(0)},n.encodeWithJS=function(t,n){if(void 0===n&&(n=!0),!t||0==t.length)return"";for(var i,o=r,s=new e.StringBuilder,a=0,c=t.length;c>a;a+=3)a>c-3?a===c-2?(i=t[a]<<16|t[a+1]<<8,s.appendCharCode(o[i>>>18&63]),s.appendCharCode(o[i>>>12&63]),s.appendCharCode(o[i>>>6&63]),n&&s.appendCharCode(61)):a===c-1&&(i=t[a]<<16,s.appendCharCode(o[i>>>18&63]),s.appendCharCode(o[i>>>12&63]),n&&(s.appendCharCode(61),s.appendCharCode(61))):(i=t[a]<<16|t[a+1]<<8|t[a+2],s.appendCharCode(o[i>>>18&63]),s.appendCharCode(o[i>>>12&63]),s.appendCharCode(o[i>>>6&63]),s.appendCharCode(o[63&i]),i=0);return s.getOutputString()},n.decodeWithJS=function(e,t){var n,r,o,s,a;if(!e||0==e.length)return new Uint8Array(0);if(1==(n=e.length%4))throw Error("Invalid Base64 string: length % 4 == 1");for(2==n?e+="==":3==n&&(e+="="),t=t||new Uint8Array(e.length),r=0,o=e.length,s=0;o>s;s+=4)a=i[e.charCodeAt(s)]<<18|i[e.charCodeAt(s+1)]<<12|i[e.charCodeAt(s+2)]<<6|i[e.charCodeAt(s+3)],t[r++]=a>>>16&255,t[r++]=a>>>8&255,t[r++]=255&a;return 61==e.charCodeAt(o-1)&&r--,61==e.charCodeAt(o-2)&&r--,t.subarray(0,r)}}(n=n||{}),function(e){var t;(t=(t=e.Encoding||(e.Encoding={})).BinaryString||(t.BinaryString={})).encode=function(t){var n,r,i,o,s,a;if(null==t)throw new TypeError("BinaryString.encode: undefined or null input received");if(0===t.length)return"";for(n=t.length,r=new e.StringBuilder,i=0,o=1,s=0;n>s;s+=2)a=s==n-1?t[s]<<8:t[s]<<8|t[s+1],r.appendCharCode(i<<16-o|a>>>o),i=a&(1<<o)-1,15===o?(r.appendCharCode(i),i=0,o=1):o+=1,s>=n-2&&r.appendCharCode(i<<16-o);return r.appendCharCode(32768|n%2),r.getOutputString()},t.decode=function(e){var t,n,r,i,o,s,a;if("string"!=typeof e)throw new TypeError("BinaryString.decode: invalid input type");if(""==e)return new Uint8Array(0);for(n=new Uint8Array(3*e.length),r=0,i=0,o=0,s=0;s<e.length;s++)32768>(a=e.charCodeAt(s))?(i=0==o?a:(t=i<<o|a>>>15-o,n[r++]=t>>>8,n[r++]=255&t,a&(1<<15-o)-1),15==o?o=0:o+=1):(32769==a&&r--,o=0);return n.subarray(0,r)}}(n=n||{}),function(e){(e=(e=e.Encoding||(e.Encoding={})).CodePoint||(e.CodePoint={})).encodeFromString=function(e,t){var n=e.charCodeAt(t);if(55296>n||n>56319)return n;if((e=e.charCodeAt(t+1))>=56320&&57343>=e)return e-56320+(n-55296<<10)+65536;throw Error("getUnicodeCodePoint: Received a lead surrogate character, char code ".concat(n,", followed by ").concat(e,", which is not a trailing surrogate character code."))},e.decodeToString=function(e){if(65535>=e)return String.fromCharCode(e);if(1114111>=e)return String.fromCharCode(55296+(e-65536>>>10),56320+(e-65536&1023));throw Error("getStringFromUnicodeCodePoint: A code point of ".concat(e," cannot be encoded in UTF-16"))}}(n=n||{}),function(e){var t;e=(e=e.Encoding||(e.Encoding={})).DecimalString||(e.DecimalString={}),t=["000","001","002","003","004","005","006","007","008","009","010","011","012","013","014","015","016","017","018","019","020","021","022","023","024","025","026","027","028","029","030","031","032","033","034","035","036","037","038","039","040","041","042","043","044","045","046","047","048","049","050","051","052","053","054","055","056","057","058","059","060","061","062","063","064","065","066","067","068","069","070","071","072","073","074","075","076","077","078","079","080","081","082","083","084","085","086","087","088","089","090","091","092","093","094","095","096","097","098","099","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","236","237","238","239","240","241","242","243","244","245","246","247","248","249","250","251","252","253","254","255"],e.encode=function(e){for(var n=[],r=0;r<e.length;r++)n.push(t[e[r]]);return n.join(" ")}}(n=n||{}),function(e){var t;t=e.Encoding||(e.Encoding={}),(e=t.StorageBinaryString||(t.StorageBinaryString={})).encode=function(e){return t.BinaryString.encode(e).replace(/\0/g,"è€‚")},e.decode=function(e){return t.BinaryString.decode(e.replace(/\u8002/g,"\0"))}}(n=n||{}),function(e){var t,n,r,i;t=e.Encoding||(e.Encoding={}),(n=t.UTF8||(t.UTF8={})).encode=function(t){return t&&0!=t.length?e.runningInNodeJS()?e.BufferTools.bufferToUint8Array(Buffer.from(t,"utf8")):n.createNativeTextEncoderAndDecoderIfAvailable()?r.encode(t):n.encodeWithJS(t):new Uint8Array(0)},n.decode=function(t){return t&&0!=t.length?e.runningInNodeJS()?e.BufferTools.uint8ArrayToBuffer(t).toString("utf8"):n.createNativeTextEncoderAndDecoderIfAvailable()?i.decode(t):n.decodeWithJS(t):""},n.encodeWithJS=function(e,n){var r,i,o;if(!e||0==e.length)return new Uint8Array(0);for(n=n||new Uint8Array(4*e.length),r=0,i=0;i<e.length;i++)if((o=t.CodePoint.encodeFromString(e,i))>127)if(o>2047)if(o>65535){if(o>1114111)throw Error("Invalid UTF-16 string: Encountered a character unsupported by UTF-8/16 (RFC 3629)");n[r++]=240|o>>>18,n[r++]=128|o>>>12&63,n[r++]=128|o>>>6&63,n[r++]=128|63&o,i++}else n[r++]=224|o>>>12,n[r++]=128|o>>>6&63,n[r++]=128|63&o;else n[r++]=192|o>>>6,n[r++]=128|63&o;else n[r++]=o;return n.subarray(0,r)},n.decodeWithJS=function(t,n,r){if(void 0===n&&(n=0),!t||0==t.length)return"";void 0===r&&(r=t.length);for(var i,o,s=new e.StringBuilder,a=n,c=r;c>a;){if((o=t[a])>>>7==0)i=o,a+=1;else if(o>>>5==6){if(a+1>=r)throw Error("Invalid UTF-8 stream: Truncated codepoint sequence encountered at position "+a);i=(31&o)<<6|63&t[a+1],a+=2}else if(o>>>4==14){if(a+2>=r)throw Error("Invalid UTF-8 stream: Truncated codepoint sequence encountered at position "+a);i=(15&o)<<12|(63&t[a+1])<<6|63&t[a+2],a+=3}else{if(o>>>3!=30)throw Error("Invalid UTF-8 stream: An invalid lead byte value encountered at position "+a);if(a+3>=r)throw Error("Invalid UTF-8 stream: Truncated codepoint sequence encountered at position "+a);i=(7&o)<<18|(63&t[a+1])<<12|(63&t[a+2])<<6|63&t[a+3],a+=4}s.appendCodePoint(i)}return s.getOutputString()},n.createNativeTextEncoderAndDecoderIfAvailable=function(){return!!r||"function"==typeof TextEncoder&&(r=new TextEncoder("utf-8"),i=new TextDecoder("utf-8"),!0)}}(n=n||{}),function(e){e.compress=function(t,n){if(void 0===n&&(n={}),null==t)throw new TypeError("compress: undefined or null input received");var r=e.CompressionCommon.detectCompressionSourceEncoding(t);return n=e.ObjectTools.override({inputEncoding:r,outputEncoding:"ByteArray"},n),r=(new e.Compressor).compressBlock(t),e.CompressionCommon.encodeCompressedBytes(r,n.outputEncoding)},e.decompress=function(t,n){if(void 0===n&&(n={}),null==t)throw new TypeError("decompress: undefined or null input received");return n=e.ObjectTools.override({inputEncoding:"ByteArray",outputEncoding:"String"},n),t=e.CompressionCommon.decodeCompressedBytes(t,n.inputEncoding),t=(new e.Decompressor).decompressBlock(t),e.CompressionCommon.encodeDecompressedBytes(t,n.outputEncoding)},e.encodeUTF8=function(t){return e.Encoding.UTF8.encode(t)},e.decodeUTF8=function(t){return e.Encoding.UTF8.decode(t)},e.encodeBase64=function(t){return e.Encoding.Base64.encode(t)},e.decodeBase64=function(t){return e.Encoding.Base64.decode(t)},e.encodeBinaryString=function(t){return e.Encoding.BinaryString.encode(t)},e.decodeBinaryString=function(t){return e.Encoding.BinaryString.decode(t)},e.encodeStorageBinaryString=function(t){return e.Encoding.StorageBinaryString.encode(t)},e.decodeStorageBinaryString=function(t){return e.Encoding.StorageBinaryString.decode(t)}}(n=n||{}),n).decompress;var t,n,r,i,o;return{prepareSnapshot:async function(t,n,r){const i=__INJECTIONS__.useWebWorker,o=e=>(logger.error("Failed to get snapshot file from cdn"),coreTracker.init(r?STG_DEFAULT_GW_HOST:DEFAULT_GW_HOST,EventsProductsEndpoints.JDL),coreTracker.reportEventsError(i?EventRequestType.GET_VIAWEBWORKER:EventRequestType.GET,{message:`Failed in snapshot fetch. path: ${a}, e: ${e}`},t),null);if(!t||!n)return null;GLOBALS.clientTag=t,GLOBALS.cdnUrl=n;let s={snpText:"",failureData:{failed:!1,error:""}};const a=`${n}${t}.${SnapshotFileSuffix}`;try{if(i)s=await async function(e){return new Promise(((t,n)=>{const r=new NmgWorker((e=>{const t={snpText:"",failureData:{failed:!1,error:""}};fetch(e.snpPath).then((e=>(e.ok||(t.failureData.failed=!0,t.failureData.error=e.status.toString()),e.text()))).then((e=>{const n={failureData:{failed:t.failureData.failed,error:t.failureData.error},snpText:e};NmgWorker.postMessage(n)})).catch((e=>{NmgWorker.postMessage({failureData:{failed:!0,error:e.message},snpText:""})}))}),(e=>t(e)),{async:!0,isWorkerSupported:!0,fallback:async()=>{const r={snpText:"",failureData:{failed:!1,error:""}};try{const n=await fetch(e);return r.failureData.failed=!n.ok,r.failureData.error=n.status.toString(),r.snpText=await n.text(),t(r)}catch(e){return n({message:e.message})}}}),i={snpPath:e};r.run(i)}))}(a);else{const e=await fetch(a);s.failureData.failed=!e.ok,s.failureData.error=e.status.toString(),s.snpText=await e.text()}if(s.failureData.failed)return s.snpText=`${s.snpText}, status code: ${s.failureData.error}`,o(s.snpText)}catch(e){return o(e.message)}try{const t=s.snpText?s.snpText.trim():"",n=e(t,{inputEncoding:"Base64"}),r=JSON.parse(n);if(!r.f)throw Error("Missing features");return r.v=__INJECTIONS__.tagVersion,r}catch(e){const t=s.snpText.length||0;return o(`Failed to decompress with error: ${e}, length: ${t}, first 30: "${t>0?s.snpText.substring(0,30):""}", last 30: "${t>30?s.snpText.substring(t-30):""}"`)}}}})(),domUtils=(()=>{const e=new class{constructor(){this.listeners={},this.stamps={},this.firedEvents={}}bind(t,n,r){let i;e.listeners[n]||(e.listeners[n]=[]),window.addEventListener&&(i=overrides.callbackTryCatchWrapper(r),t.addEventListener(n,i,!1)),e.listeners[n].push({element:t,handler:r,fn:i})}unbind(t,n,r){if(!e.listeners[n])return;const i=e.listeners[n];for(let e=i.length-1;e>=0;e--){let o=i[e];o.element===t&&o.handler===r&&window.removeEventListener&&(t.removeEventListener(n,o.fn,!1),i.splice(e,1))}}getSelfFetchTime(e,t){if(!window.performance||!performance.getEntries)return null;let n;n=t?e=>"script"===e.initiatorType&&e.name.includes(t):t=>"script"===t.initiatorType&&(t.name.includes(e+"IBP.js")||t.name.includes(e+"JDL.js"));const r=performance.getEntries().filter(n);if(!r||!r.length)return null;let i=r[0];return Math.round(i.responseEnd-i.fetchStart)}stampElement(t,n){e.stamps[t]||(e.stamps[t]=coreUtils.generateRandomString(5)),n&&!n[e.stamps[t]]&&Object.defineProperty(n,e.stamps[t],{enumerable:!1,configurable:!1,writable:!1,value:!0})}isStampedElement(t,n){return!(!n||!n[e.stamps[t]])}getUnstampedSrclessIframes(t,n){let r;const i=(n,o)=>{if(0>=o)return r;const s=Array.from(n.getElementsByTagName("IFRAME")).filter((n=>!e.isStampedElement(t,n)&&coreUtils.hasContentWindowDocumentAndNoSrc(n)));s.length&&(r=r.concat(s)),s.forEach((e=>{i(e.contentWindow.document,o-1)}))};return i(document,5),r.forEach((r=>{e.stampElement(t,r),n(r.contentWindow)})),r}firePageLoadWhenReady(){const e=this,t=function(t){e.firedEvents[t]||(e.firedEvents[t]=!0,notifier.fire(t))},n=function(){"complete"===document.readyState&&document.body?(t("DOMContentLoaded"),t("page-load")):window.setTimeout(n,50)};n(),window.addEventListener&&"complete"!==document.readyState&&document.addEventListener("DOMContentLoaded",(function(){t("DOMContentLoaded")}),!1);const r=document.onreadystatechange||function(){};document.onreadystatechange=function(e){r(e),"complete"===document.readyState&&(document.onreadystatechange=r,t("DOMContentLoaded"),t("page-load"))}}getStyle(e,t){const n=(e.ownerDocument||document).defaultView;if(n&&n.getComputedStyle){t&&(t=t.replace(/([A-Z])/g,"-$1").toLowerCase());const r=n.getComputedStyle(e,null);return t?r.getPropertyValue(t):r}}};return e})(),hookWriter=(()=>{class HookWriter{constructor(){this.storageManager=null,this.hookWriterConf=null,this.ready=!1}init(e,t){api.resetLocals(),api.storageManager=storageManagers.getStorageManager(),api.hookWriterConf=e.filter((e=>e.domains.includes("*")||e.domains.includes(t))),api.setHooksListeners(),api.ready=!0}resetLocals(){api.hookWriterConf=null,api.ready=!1}isReady(){return api.ready}setListeners(hookWriterConf){const utils={},{dal:dal,notifier:notifier,chpReports:networkResearch}=GLOBALS,getConf=()=>GLOBALS.conf,SeTargetAudience=GLOBALS.SeTargetAudience||{};utils.updateTargetAudienceStatus=SeTargetAudience.updateTargetAudienceStatus;const{isFunction:isFunction,isUndefined:isUndefined,isArray:isArray,isObject:isObject}=coreUtils,_=window;hookWriterConf.forEach((row=>{const write_to=row.write_to,write_cond=row.write_cond?eval(row.write_cond):e=>{e()},write_value=row.write_value?eval(row.write_value):()=>!0,write_as=row.write_as,func=e=>{write_cond((()=>{switch(write_to){case"exec":write_value(e);break;case"memory":window[write_as]=write_value();break;case"localStorage":api.storageManager.setItem(write_as,write_value())}}))};notifier.retroBind(row.write_event,func)}))}setHooksListeners(){api.hookWriterConf&&api.setListeners(api.hookWriterConf)}addHooks(e){const t=[];e.forEach((e=>{for(const t of api.hookWriterConf)if(t.write_value===e.write_value)return;t.push(e)})),t.length&&api.setListeners(t)}}const api=new HookWriter;return api})(),etag=(()=>{const e="GET",t="session.sitelabweb.com",n=new class{constructor(e="colrep.sitelabweb.com",t="nmg_tag.json"){this.host=e,this.path=t,this.apiHost=""}setApiHost(e){n.apiHost=e}async initEtagId(){return new Promise((e=>{let t=!1;const r=document.createElement("script");r.type="text/javascript",r.src=`https://${n.host}/${n.path}`,r.async=!0,domUtils.bind(r,"load",(()=>{const n=window._nmgtag&&window._nmgtag.new_nmg_tag;if(n)return t=!0,e(n)}));for(let e=0;maxTriesToGetEtag>e;e++)setTimeout((()=>{t||document.getElementsByTagName("head")[0].appendChild(r)}),e*intervalBetweenEtagCalls)}))}async getSessionData(t){if(!n.apiHost)return;const r=n.setHeaders(e),i=await fetch(`${n.apiHost}/get-session-data?identifier=${t}`,r);return(await i.json()).existingSession}setSessionData(t,r,i){if(!n.apiHost)return;const o=n.setHeaders(e);fetch(`${n.apiHost}/set-session-data?userId=${r}&etagId=${i}&session=${t}`,o).then()}setHeaders(e){return{method:e,mode:"cors",cache:"no-cache",headers:{"Content-Type":"application/json","X-Full-Path":window.location.href}}}async getSID(r,i){const o=n.setHeaders(e);delete o.headers["X-Full-Path"];const s=await fetch(`https://${t}/sid?userId=${r||""}&clientTag=${i||""}`,o);return(await s.json()).sessionId}async renewTTL(e,r,i){const o=n.setHeaders("POST");delete o.headers["X-Full-Path"],o.body=JSON.stringify({userId:e,clientTag:i,sessionId:r});const s=await fetch(`https://${t}/sid`,o);return await s.text()}};return n})(),session=(()=>{const e=new class{constructor(){this.conf=null,this.storageManager=null,this.sessionName="sessionData",this.isGenerated=!1,this.ready=!1,this.isEtag=!1,this.sessionWasExpired=!1,this.timestamp=coreUtils.getDateNow(),this.domain=coreUtils.removeSubdomain(window.location.host)}async init(t){e.resetLocals(),e.conf=t,e.storageManager=storageManagers.getStorageManager(),dal.session.onchange(e.sessionChanged);const n=e.storageManager.getItemSync(e.sessionName);e.isEtag=storesConfigurations.etag,e.isEtag&&dal.session.addMutator(DalMutators.ETAG,e.updateRemoteCache()),await e.processSession(n),e.ready=!0}updateRemoteCache(){const{storageManager:e,sessionName:t}=this,n=()=>{const n=e.getItemSync(t);if(n){const{pi_userid:e,etag_userid:t}=dal.session.get();etag.setSessionData(n,e,t)}};let r;return()=>{clearTimeout(r),r=setTimeout((()=>n.apply(this)),500)}}resetLocals(){e.conf={},e.timestamp=coreUtils.getDateNow(),e.isGenerated=!1,e.domain=coreUtils.removeSubdomain(window.location.host),e.ready=!1}isReady(){return e.ready}generateSessionData(t){dal.session.set(Object.assign({pi_userid:coreUtils.generateUUID(),pi_sessionid:coreUtils.generateUUID(),pv:1,session_counter:1,ust:e.timestamp,sst:e.timestamp,pvst:e.timestamp,lpvst:e.timestamp,lsst:e.timestamp,lset:e.timestamp},{...t,...getSessionData()})),e.isGenerated=!0}getDailySessionNumber(e){return!e.lset||(new Date).getDate()>new Date(e.lset).getDate()||(new Date).getMonth()>new Date(e.lset).getMonth()?1:e.dsn+1}parseSessionObject(e){let t={};if(!e)return t;const n=coreUtils.getType(e);return"string"===n&&(e=e.replace(/^"|"$/g,"")),e=encryption.decrypt(e),"string"===n&&("{"!==e.charAt(0)&&(e=encryption.decrypt(e)),t=coreUtils.jsonParse(e)||{}),t}async processSession(t){let n=e.parseSessionObject(t);if(e.isEtag){etag.setApiHost(e.conf.etagHost);const t=await etag.initEtagId(),r=getSessionData().pi_userid||t,i=await etag.getSessionData(r);i&&(n=e.parseSessionObject(i)),dal.session.set({etag_userid:t,...n})}logger.info(n,"existing session: ");const r=urlParamManager.getValue("sessionPeriodMs")||18e5;if(n.pi_userid&&n.pvst&&e.timestamp-n.pvst>=r){e.sessionWasExpired=!0;const t=e.getDailySessionNumber(n);n={pi_userid:n.pi_userid,session_counter:+(n.session_counter||0)+1,ust:n.ust,lsst:n.sst,lset:n.pvst,dsn:t,gslEmailSubscriber:n.gslEmailSubscriber,gslPhoneSubscriber:n.gslPhoneSubscriber,displayCounter:n.displayCounter,clickCounter:n.clickCounter,lastPage:n.lastPage,snp_ts:n.snp,isCouponApplied:n.isCouponAutoApplied,shouldTryToAutoApply:n.shouldTryToAutoApply,overruledUser:1===t?0:n.overruledUser,couponCode:1===t?null:n.couponCode,isFirstCoreStackCall:!0,colorPreferencesFrequencies:n.colorPreferencesFrequencies||{}}}dal.session.set({pvst:e.timestamp,lpvst:n.pvst,pv:+(n.pv||0)+1,cb:coreUtils.getDateNow(),href:window.location.href,prevURL:n.href||window.location.href,ud:(n.ud||0)+((n.pvst||0)-(n.lpvst||0)),dsn:n.dsn||1,gslEmailSubscriber:n.gslEmailSubscriber||[],gslPhoneSubscriber:n.gslPhoneSubscriber||[],displayCounter:n.displayCounter||{},clickCounter:n.clickCounter||{},previousLastPage:n.lastPage||null,isCouponAutoApplied:n.isCouponAutoApplied||!1,shouldTryToAutoApply:n.shouldTryToAutoApply||!1,incentiveSentInCurrentPv:!1,nmgSegments:{},js_channel:n.js_channel,couldShowPopupByDisplayRules:n.couldShowPopupByDisplayRules||null,overruledUser:n.overruledUser||0,couponCode:n.couponCode||null,isFirstCoreStackCall:void 0===n.isFirstCoreStackCall||n.isFirstCoreStackCall,dataPoints:n.dataPoints,featureUserThreshold:n.featureUserThreshold}),e.generateSessionData(n);const i=getSessionData();e.storageManager.setItem(e.sessionName,encryption.encrypt(JSON.stringify(i))),notifier.fire("session-ready")}sessionChanged(){e.isGenerated&&e.storageManager.setItem(e.sessionName,encryption.encrypt(JSON.stringify(getSessionData()))),notifier.fire("session-change")}};return e})(),{initCore:initCore}={initCore:async function(e,t,n){n||domUtils.firePageLoadWhenReady(),n||(()=>{try{"String"in window&&!"".each&&[].forEach&&(String.prototype.each=[].forEach)}catch(e){logger.error(e,"Failed in addStringEachIfNeeded")}})();const r=e.sc[t],i=[()=>{storageManagers.init()},async()=>{!n&&session.isReady()||await session.init(e)},()=>{(n||e.hr&&!hookReader.isReady())&&hookReader.init(e.hr,t)},()=>{(n||e.hw&&!hookWriter.isReady())&&hookWriter.init(e.hw,t)},()=>{nmgDictionaryManager.init(e.nmgCDV)},()=>{pageTypeDetector.init(r),coreDataStore.init(),coreFeatureManager.init(e.cc),cartDataDetector.init(nmgDictionaryManager.getCartDataPatterns())},()=>{coreReports.init()},()=>{!n&&dataCollector.isReady()||dataCollector.init(e)},()=>{(e=>{if(configurationsGetters.useHangTimeMeasurer){const t=e.sHT;hangTimeMeasure({intervalInMilli:t[ClientFeatureFlags.SCRIPT_HANG_TIME_INTERVAL],totalTimeInMilli:t[ClientFeatureFlags.SCRIPT_HANG_TIME_TOTAL_TIME]}).start(!0)}})(e.cc)},()=>{coreReports.reportEvent(!0)}];for(let e=0;i.length>e;e++){const t=i[e];try{t()}catch(t){throw Error(`Failed in Init Core at function ${e} Error: ${t}`)}await coreUtils.yieldToMain()}}},spaHandler=(()=>{const e=new class{constructor(){this.isRunning=!1,this.oldURL=location.href}listenToUrlChanges(t){e.isRunning||(e.isRunning=!0,new MutationObserver((()=>{const n=location.href;n!==e.oldURL&&(e.oldURL=n,t())})).observe(document,{subtree:!0,childList:!0}))}};return e})();class IndexCanvas{constructor(){this.isDev=!1}async init(){const{url:e,clientTag:t}=indexCanvas.getUrlWithClientTagFromScriptElement();if(this.isDev&&localStorage.setItem("_vmdbnudu","3"),coreTracker.init(indexCanvas.isDev?STG_DEFAULT_GW_HOST:DEFAULT_GW_HOST,EventsProductsEndpoints.JDL),window.nmg_tag_loaded){const e="Nmg tag already loaded, skipping initialization";throw logger.error(e,"Duplicate Tag:"),Error("Duplicate Tag, exiting")}if(window.nmg_tag_loaded=1,__INJECTIONS__.useWebWorker=!(__INJECTIONS__.nonWebWorkerTags||[]).length||!__INJECTIONS__.nonWebWorkerTags.includes(t.replace("dev_","")),logger.info(__INJECTIONS__,"Tag configurations:"),indexCanvas.snp=await prepareSnapshot(t,e,indexCanvas.isDev),!indexCanvas.snp)throw Error("No snapshot, exiting");if(indexCanvas.snp.cc.ct)return void logger.info(indexCanvas.snp.cc.ct,"Clear tag is enabled, exiting");urlParamManager.init(indexCanvas.snp.cc.nmgAuthKey);const n=urlParamManager.getParamValuation(UrlParams.DISABLE_TAG,"1");if(n.wasFound&&n.value)throw Error("Disable Tag is triggered from url params!");configurationsGetters.init(indexCanvas.snp),indexCanvas.snp.cd&&indexCanvas.snp.cd.lb_dns&&chpTracker.init(indexCanvas.snp.cd.lb_dns,EventsProductsEndpoints.CHP),logger.info(indexCanvas.snp,"snapshot:")}async run(e=!1){const t=(new Date).getTime();performanceTiming.setScriptStartTime(t);try{if(Object.keys(indexCanvas.snp.sc).filter((e=>e.includes("*"))).length){const t=coreUtils.parseUrl(window.location.href).domainname;return storesConfigurations.init(null,t,indexCanvas.snp.tag),await initCore(indexCanvas.snp,t,e),void indexCanvas.initChp(e)}const t=coreUtils.findRelevantDomain(indexCanvas.snp.cc.dIdM,indexCanvas.snp.sc);if(t){storesConfigurations.init(indexCanvas.snp.sc[t],t,indexCanvas.snp.tag),await initCore(indexCanvas.snp,t,e),storesConfigurations.spa&&spaHandler.listenToUrlChanges((()=>{notifier.clear(),indexCanvas.run(!0)}));const n=urlParamManager.getParamValuation(UrlParams.DISABLE_MODULES,NmgProducts.CHP);(!n.wasFound||n.wasFound&&!n.value)&&indexCanvas.initChp(e)}}catch(e){try{logger.error(e,"Run error"),!indexCanvas.isDev&&coreTracker.isReady()&&coreTracker.reportEventsError(EventRequestType.GET_VIAWEBWORKER,{message:e.message,stack:e.stack})}catch(e){}}}initChp(forceInit){try{const chpApi=(()=>{const tagsPrefix={a:{prefix:"a",attr:"href"},iframe:{prefix:"i",attr:"src"},script:{prefix:"s",attr:"src"},object:{prefix:"f",attr:"data"},embed:{prefix:"f",attr:"src"},form:{prefix:"m",attr:"action"},img:{prefix:"t",attr:"src"},pwin:{prefix:"w",attr:"src"},link:{prefix:"c",attr:"href"},dependencies:{prefix:"d",attr:""},network:{prefix:"n",attr:""}},extensionInteractionTypes={popped:1,removed:2,installed:3,interacted:4,unknownExtensionResearch:5},CHANNEL_HANDLER_CB_RECENT_TIMEDELTA=6e5,DOM_FUNCTIONS_TO_OVERRIDE=["appendChild","insertBefore","insertAdjacentElement","insertAdjacentHTML","innerHTML","write","writeln","replaceChild"],DpsDetectionsEvents={AdBlockerDetection:"is-adblocker",AdStyleBlockerDetection:"is-adstyleblocker"};let conf={},sendExceptions=!1;GLOBALS.conf=conf;const chpUtils=(()=>{function e(e){try{return e.outerHTML}catch(t){try{return logger.info(e,"getOuterHtml: Unable to perform default method! "+t),(new XMLSerializer).serializeToString(e)}catch(e){logger.error(e,"getOuterHtml: Unable to perform!")}}return""}function t(e,t,n){let r,i;return i=35===e.charCodeAt(0)?56:e.charCodeAt(0)-36,r=(i-(t+1+(n+2)))%90,0>r&&(r=90+r),i=r+36,String.fromCharCode(i)}const n=new class{constructor(){this.ourHosts=null,this.urlRegex=/^(https?|ftp):\/\/[^\s/$.?#].[^\s]*$/i,this.urlWPRegex=/^\/\/[^\s/$.?#].[^\s]*$/i}init(e){n.ourHosts=[e.lb_dns,e.r_lb_dns].map((e=>coreUtils.parseUrl(e).host)).filter(((e,t,n)=>t===n.indexOf(e)))}isOurHost(e){return!!n.ourHosts&&((e.match(n.urlRegex)||e.match(n.urlWPRegex))&&(e=coreUtils.parseUrl(e).host),n.ourHosts.includes(e))}},r=new class{setItem(e,t,n){return n=n||"SafeStorage setItem",r.setItems([{name:e,value:t}],n)}setItems(e,t){t=t||"SafeStorage setItems";try{e.forEach((e=>localStorage.setItem(e.name,e.value)))}catch(n){const r=e.map((e=>e.name)).join(", ");logger.warn(n,`${t}: Unable to set localStorage items [${r}]. Try to use sessionStorage...`);try{e.forEach((e=>sessionStorage.setItem(e.name,e.value)))}catch(e){logger.error(e,`${t}: Unable to set sessionStorage items [${r}]!`)}}}getItem(e,t){try{return localStorage.getItem(e)||sessionStorage.getItem(e)||""}catch(n){return logger.error(n,`${t}: Unable to getItem [${e}]`),""}}removeItem(e,t){try{localStorage.removeItem(e),sessionStorage.removeItem(e)}catch(n){logger.error(n,`${t}: Unable to removeItem [${e}]`)}}},i=(e,t)=>{if(!coreUtils.isObject(e)||!coreUtils.isObject(t))return!1;if(Object.keys(e).length!==Object.keys(t).length)return!1;for(let n in e)if(o(e[n])&&e[n]!==t[n]||coreUtils.isObject(e[n])&&!i(e[n],t[n])||e[n].toString&&t[n].toString&&e[n].toString()!==t[n].toString())return!1;return!0},o=e=>/^(boolean|number|string)$/.test(coreUtils.getType(e))||null===e,s=new class{constructor(){this.data={}}get(e,t){return s.data.hasOwnProperty(e)?s.data[e][t]:void 0}getNS(e){return s.data[e]}set(e,t,n){return s.data.hasOwnProperty(e)||(s.data[e]={}),s.data[e][t]=n,s.data[e][t]}has(e,t){return s.data.hasOwnProperty(e)&&s.data[e].hasOwnProperty(t)}},a=e=>e.reduce((function(e,t){return e.concat(coreUtils.isArray(t)?a(t):t)}),[]);return{getSectionName:()=>(dal.coreDataStore.getOne("pageType")||"").toLowerCase(),hostChecker:n,clean:function(e){let t,n={};for(t in e)e.hasOwnProperty(t)&&void 0!==e[t]&&""!==e[t]&&(n[t]=e[t]);return n},formSerialize:function(e,t){if(!coreUtils.isObject(e))return"";let n="",r=t?encodeURIComponent:function(e){return e};for(const t in e)e.hasOwnProperty(t)&&(n+="&"+r(t)+"="+r(e[t]));return n.substring(1)},getReportName:function(e,t){const n=e.tagName.toLowerCase();return"$taghost"===t.r&&tagsPrefix[n]?tagsPrefix[n].prefix+"_"+coreUtils.parseUrl(e.getAttribute(tagsPrefix[n].attr)).host:"$tagurl"===t.r&&tagsPrefix[n]?tagsPrefix[n].prefix+"_"+e.getAttribute(tagsPrefix[n].attr):t.r||t.i},safeStorageManager:r,EnumList:class{constructor(e){this.ENUM=e,this.map={},this.list=[]}add(e,t){var n,r,i=this.ENUM.indexOf(e);if(-1!==i){if(this.map[e])this.map[e].push(t);else{for(n=0,r=0;i>r;r++)this.map[this.ENUM[r]]&&n++;this.list.splice(n,0,[t]),this.map[e]=this.list[n],this.map[e].key=e}return t}}get(e){return this.map[e]||void 0}},objectCompare:i,cache:s,markAndRemove:function(t,n=!0,r=!1){try{t.__toRemove__=!0}catch(e){}if(n){if(r&&t.shadowRoot){try{t.shadowRoot.innerHTML=""}catch(n){try{t.outerHTML=e(t)}catch(e){logger.warn(e,"markToRemove: Unable to remove the shadow root content!")}}return}try{t.remove()}catch(e){logger.warn(e,"markToRemove: Unable to remove the element!")}try{t.style.cssText="display: none;"}catch(e){logger.warn(e,"markToRemove: Unable to remove the element!")}}},concatArrays:function(...e){const t=[];let n=0;if(e)for(let r=0,i=e.length;i>r;r++){const i=e[r];if(i.length)for(let e=0,r=i.length;r>e;e++)t[n]=i[e],n++}return t},getOuterHtml:e,shuffle:function(e){let t,n,r=0,i=e.length;for(;i>r;r++)t=Math.floor(Math.random()*(i-r))+r,n=e[r],e[r]=e[t],e[t]=n;return e},getUrlHash:function(e){const t=function(e){return e.replace(/#.*$/,"").replace(/\?.*$/,"")}(e);return function(e){const t=12;e.length<t&&(e=function(e,t,n){return e+Array(Math.max(t-e.length+1,0)).join(n||" ")}(e,t,"0"));const n=Math.floor(e.length/t);let r,i,o,s=0,a=[];for(let e=0;t>e;e+=1)a[e]=0;for(let c=0,l=e.length;l>c;c+=1)r=c%t,c/n==0&&(o=0),i=e.charCodeAt(c)+c,s+=i,o=(o<<5)-o+i,a[r]+=o,a[c%t]+=i-c,a[i%t]+=(i<<5)-i+c;const c=s.toString().split("").map((function(e){return parseInt(e,10)}));for(let e=0,t=a.length;t>e;e+=1)a[e]+=c[e%c.length];return a=a.map((function(e){return String.fromCharCode((e=Math.abs(e)%62)+(10>e?48:36>e?55:61))})).join(""),a}(t)},getNativeDescriptorWithObject:(e,t)=>{try{let n;coreUtils.isArray(e)||(e=[e]);for(let r=0,i=e.length;i>r;r+=1)if(e[r]&&(n=Object.getOwnPropertyDescriptor(e[r],t)),n)return{obj:e[r],descriptor:n}}catch(e){logger.warn(e,`Unable to getNativeDescriptorWithObject [ ${t} ]!`)}return null},overrideProperty:(e,t,n,r)=>{if(!Object.getOwnPropertyDescriptor)return null;try{if(n.configurable&&(r.configurable=n.configurable),n.writable&&(r.writable=n.writable),n.enumerable&&(r.enumerable=n.enumerable),Object.defineProperty(e,t,r),n.value){const r=function(){return n.value.toString()};let i=Object.getOwnPropertyDescriptor(e[t],"toString");return i?i.value=r:i={configurable:!0,writable:!0,enumerable:!1,value:r},Object.defineProperty(e[t],"toString",i),n.value}return n}catch(e){logger.warn(e,`overrideProperty: Unable to override [${t}] property!`)}},xmlHttpRequestOverriding:e=>{try{if(!e.XMLHttpRequest||!e.XMLHttpRequest.prototype)return!1;let t=Object.getOwnPropertyDescriptor(e.XMLHttpRequest.prototype,"open");if(void 0===t)return!1;Object.defineProperty(e.XMLHttpRequest.prototype,"open",{configurable:!1,writable:!1,enumerable:!0,value:function(e,n){const r=(notifier.fireSync("isBNW",n)||[])[0];return arguments.length>1&&r?!(this.send=function(){}):t.value.apply(this,arguments)}})}catch(e){logger.error(e,"CHP.xmlHttpRequestOverriding")}},checkIsDomain:(e,t=!0)=>{if(!e)return!0;let n="";return n=t?coreUtils.removeWWWprefix(coreUtils.removeSubdomain(window.location.host)):window.location.host,e===n},uniqueArray:e=>{const t=[];let n=0,r=e.length;for(;r>n;n++)-1===t.indexOf(e[n])&&""!==e[n]&&t.push(e[n]);return t},flattenArray:a,iframeDigger:e=>{let t,n=0;for(;e&&10>n++;){if(e.src&&e.src.match(/^https?:\/\//))return e.src;try{t=e.contentWindow.document.getElementsByTagName("iframe"),t&&(e=t[0])}catch(e){return""}}return""},truncateString:(e,t)=>{if(e.length<=t)return e;let n,r,i;return(t-=3)%2!=0?(r=Math.floor(t/2),i=r+1):r=i=t/2,n=e.substring(0,r)+"..."+e.substring(e.length-i),n},getDecryptedList:function(e){return e&&e.length?("huxhvnkl"===e[0]&&e.length&&(e=function(e){let n,r,i,o,s=0,a=e.length;for(;a>s;++s){for(o="",n=e[s],r=0,i=n.length;i>r;++r)o+=t(n[r],s,r);e[s]=o}return e}(e)).shift(),e):[]}}})(),chptl=(()=>{const e=new class{constructor(){this.dataStore={sent:{},unsent:{}}}add(t,n){const r=e.dataStore;coreUtils.isArray(n)?(r.unsent[t]||(r.unsent[t]=[]),r.unsent[t]=r.unsent[t].concat(n)):(r.unsent[t]||(r.unsent[t]={}),r.unsent[t]={...r.unsent[t],...n})}send(t){let n={};const r=e.dataStore.unsent,i=e.dataStore.sent;for(const e in r)if(r.hasOwnProperty(e)){if(0>=t)break;if(r[e]){const o=r[e];let s=!1;for(const a in o){if(!o.hasOwnProperty(a))continue;const c=o[a];if(0>=(t-=JSON.stringify(a).length+JSON.stringify(c).length+6)){s=!0;break}n[e]||(n[e]={}),n[e][a]||(n[e][a]=c),i[e]||(i[e]={}),i[e][a]||(i[e][a]=c),delete r[e][a]}if(s)break}}return n}};return e})(),{detectDebugger:detectDebugger}={detectDebugger:function(){try{if(chpApi.sessionMudbak)return!1}catch(e){logger.error(e,"detectDebugger - Something going wrong with chpApi...")}try{if(window.console&&window.console.firebug||window.Firebug&&window.Firebug.chrome&&window.Firebug.chrome.isInitialized)return!0;const e=200,t=window.outerHeight-window.innerHeight>e,n=window.outerWidth-window.innerWidth>e;return t||n}catch(e){return logger.error(e,"detectDebugger - Something going wrong"),!1}}},chpReports=(()=>{const e=new class{constructor(){this.reportData={},this.detectedData={},this.hasExtensions=!1,this.fiiReported=!1,this.prevSft=null,this.lastReportTime=null,this.f=null,this.params=null,this.maxGetSize=null,this.conf=null,this.reportedResearch={},this.researchData={},this.generalResearchSendCount=0,this.sentResearchByAction={},this.detectDebugger=null,this.device="",this.sft=0,this.semEnabled=!0,this.sectionName="",this.sectionNamesToSendTitle=["category","product"]}init(e,n,r,i=!0){chpTracker.isReady()||chpTracker.init(r.lb_dns,EventsProductsEndpoints.CHP),t.semEnabled=i,t.sectionName="",t.device=coreUtils.getDevice(),t.sft=domUtils.getSelfFetchTime(r.nmgTag,r.nmgTag+".js"),t.f=e,t.params=n,t.maxGetSize=Math.round(552.96*t.params.maxGetKb),t.conf=r,dal.commonReportFields.on((function(e){const n=dal.session.get();Object.assign(e,dataCollector.getCommonReportFields()),e.uuid=n.pi_userid||"",e.sid=n.pi_sessionid||"",e.etagUserId=n.etag_userid||"",e.etagSessionId=n.etag_sessionid||"",e.pv=n.pv||-1,e.href=window.location.href,e.tegr=n.testGroup||"",e.isInfected=n.ii||0,!e.js_channel&&n.js_channel&&(e.js_channel=n.js_channel||""),n.js_affiliate&&(e.js_affiliate=n.js_affiliate||""),t.f.ignore_data&&(e.ignoreData=1)})),t.f.detect_debugger?t.detectDebugger=detectDebugger:t.detectDebugger=function(){return!1},notifier.retroBind("add-detection",t.addDetection),notifier.retroBind("sendReport",t.sendReport),notifier.retroBind("sendDataReport",t.sendDataReport),notifier.retroBind("hookEvent",(function(e){notifier.fireSync("hook-cycle"),notifier.fire("sendReport",e)})),notifier.retroBind("sendDetections",(function(e){const t={action:"detections",...dal.commonReportFields.get(),...{detections:e.map((e=>encodeURIComponent(e))).join(",")}||{}};chpTracker.sendGetEventViaWebWorker(EventsTopics.chpResearch,t).then((()=>{})).catch((e=>{logger.error(e,"sendDetections: Unable to send! "+JSON.stringify(t))}))})),notifier.retroBind("researchException",t.researchException),notifier.retroBind("sendResearch",t.sendResearch)}add_sem_data_key(e){if(t.semEnabled){const t={...e};t.chp_uuid=e.uuid,t.chp_sid=e.sid,e.sem_data=encryption.encrypt(chpUtils.formSerialize(t,!0))}return e}addReport(e,n=!1){t.reportData[e]||(t.reportData[e]=0),t.reportData[e]++,dal.session.set({ii:1});const r=dal.session.getOne("eReporterOnly");dal.session.set({eReporterOnly:!(!n||!coreUtils.isUndefined(r)&&!r)}),dal.needToSend.set(!0)}sendReport(e){t.sectionName||(t.sectionName=chpUtils.getSectionName());const n=coreUtils.getDateNow();t.lastReportTime||(t.lastReportTime=t.conf.timestamp);const r=document.referrer,i=dal.throttlingProcess.getOne("cpum");let o;i&&(o=Math.floor(i.reduce((function(e,t){return e+t}))/i.length),dal.session.set({cpum:[]})),t.conf.nppco=1,window._nppc?t.conf.nppco=2:window._nppc=coreUtils.generateRandomString(8),dal.commonReportFields.set({hasExtension:t.checkHasExtension()});let s=chpUtils.clean({action:"stack",cycle:t.conf.threatLoopCounter,rt:n-t.lastReportTime,referrer:1===t.conf.threatLoopCounter&&r&&coreUtils.parseUrl(r).host!==window.location.host?r:"",title:t.sectionNamesToSendTitle.includes(t.sectionName)&&document.title||"",lip:"",ps:0,wobt:"",cpum:o||"",sc:"",dt:t.device,nppc:window._nppc,nppco:t.conf.nppco,sdt:window.performance&&window.performance.timing?n-window.performance.timing.domLoading:"",sft:t.sft,...dal.commonReportFields.get(),...dal.hookReader.get(!1),...dal.sendReport.get(),...e||{}});t.f.detect_debugger&&t.detectDebugger()&&(dal.session.set({ii:0}),s.nii&&(s.nii=0),s.isInfected&&(s.isInfected=0),s.nb&&(s.nb=0)),s.cpum&&notifier.fire("add-environment-data",{type:"cpum",value:s.cpum}),s.sft&&(t.prevSft&&s.sft===t.prevSft||(notifier.fire("add-environment-data",{type:"sft",value:s.sft}),t.prevSft=s.sft)),dal.session.getOne("ii")&&!t.fiiReported&&(s.fii=1,t.fiiReported=!0),-1===dal.session.getOne("sfi")&&(s.sfi=1,dal.session.set({sfi:1})),t.lastReportTime=n,s.report=Object.keys(t.reportData).length&&s.isInfected&&"0"!==s.isInfected&&"false"!==s.isInfected?JSON.stringify(t.reportData):"";const a=dal.extensions.get(!1);Object.keys(a).length&&(s.extensions=JSON.stringify(a),dal.extensions.clear()),s=t.add_sem_data_key(s),chpTracker.sendGetEventViaWebWorker(EventsTopics.chpStack,s).then((()=>{})).catch((e=>{logger.error(e,"sendReport: Unable to send! "+JSON.stringify(s))})),t.reportData={},dal.needToSend.set(!1),t.sendDetections()}checkHasExtension(){return dal.commonReportFields.getOne("hasExtension")||t.hasExtensions?1:0}sendDataReport(){notifier.fireSync("data-about-to-send");let e={};e=chpUtils.clean(chptl.send(t.maxGetSize)),e&&(e=JSON.stringify(e));let n=chpUtils.clean({action:"data",cycle:t.conf.threatLoopCounter,data:e,...dal.commonReportFields.get(),...dal.hookReader.get(!1)});n.data.length>2&&(n=t.add_sem_data_key(n),chpTracker.sendGetEventViaWebWorker(EventsTopics.chpStack,n).then((()=>{})).catch((e=>{logger.error(e,"sendDataReport: Unable to send! "+JSON.stringify(n))})))}addResearch(e){t.reportedResearch[e]||(t.reportedResearch[e]=!0,t.researchData[e]||(t.researchData[e]=0),t.researchData[e]++)}sendGeneralResearch(){if(t.generalResearchSendCount>=t.params.generalResearchMaxRequests||t.conf.threatLoopCounter%3!=1||!Object.keys(t.researchData).length)return;t.generalResearchSendCount++;const e={action:"research",report:JSON.stringify(t.researchData),...dal.commonReportFields.get()};chpTracker.sendGetEventViaWebWorker(EventsTopics.chpResearch,e).then((()=>{})).catch((t=>{logger.error(t,"sendGeneralResearch: Unable to send! "+JSON.stringify(e))})),t.researchData={}}sendResearch(e,n,r={},i=!1){if(!t.conf.researchOn&&!i)return;const o=-1!==e.indexOf("analyze_")?"analyze":e;t.sentResearchByAction[o]||(t.sentResearchByAction[o]=0),t.sentResearchByAction[o]<t.params.maxResearchRequestsPerAction&&(t.sentResearchByAction[o]++,(n={action:e,...dal.commonReportFields.get(),...n}).host&&(n.host=n.host.replace(/^www\./,"")),"post"===r.method?chpTracker.sendPostEventViaWebWorker(EventsTopics.chpResearch,n).then((()=>{})).catch((e=>{logger.error(e,"sendResearch: Unable to send POST! "+JSON.stringify(n))})):chpTracker.sendGetEventViaWebWorker(EventsTopics.chpResearch,n).then((()=>{})).catch((e=>{logger.error(e,"sendResearch: Unable to send GET! "+JSON.stringify(n))})))}researchException(e){coreTracker.reportEventsError(EventRequestType.GET,{message:e.message,stack:e.stack,module:TagModules.CHP})}addDetection(e){const n=chpUtils.getReportName(e.el,e.rule);t.f.detection_on&&(t.detectedData[n]||(t.detectedData[n]=!1),t.hasExtensions||-1===n.indexOf("-extension://")||(t.hasExtensions=!0),dal.needToSend.set(!0))}sendDetections(){const e=[];Object.keys(t.detectedData).forEach((function(n){t.detectedData[n]||(e.push(n),t.detectedData[n]=!0)})),e.length&&notifier.fire("sendDetections",e)}},t=e;return window.infectSession=function(){chpApi.sessionMudbak=!0,dal.session.set({sessionMudbak:!0}),e.addReport("sessionMudbak",!0)},e})();GLOBALS.chpReports=chpReports;const chpSession=(()=>{const e=session,t=new class{constructor(){this.isInfected=0,this.etagCallsCount=0,this.ready=!1,this.config={},this.etagHost="",this.chpEnabled=!1,this.semEnabled=!1}init(n=!0,r=!0){t.resetLocals(),t.chpEnabled=n,t.semEnabled=r,t.config=e.conf,t.etagHost=t.config.etagHost,notifier.retroBind("session-ready",t.processSession.bind(this)),notifier.retroBind("session-change",t.sessionChanged.bind(this))}resetLocals(){t.ready=!1,t.isInfected=0}sessionChanged(){const e=getSessionData();if(conf.researchOn=/^[xzo]$/.test(e.testGroup),conf.blockingMode=/^[yzo]$/.test(e.testGroup),t.chpEnabled){let n=!1;if(t.config.f.ignore_bots&&chpApi.ignoreBotsDoDecision)try{n=!chpApi.ignoreBotsDoDecision()}catch(e){logger.error(e,"sessionChanged - Something going wrong on ignoreBotsDoDecision")}else if(t.config.f.detect_debugger)try{detectDebugger()&&(n=!0)}catch(e){logger.error(e,"sessionChanged - Something going wrong on detectDebugger")}n&&(e.ii||t.isInfected)&&(t.isInfected=0,e.ii=0,dal.session.set({ii:0})),e.ii&&!t.isInfected&&(t.isInfected=1,dal.session.getOne("eReporterOnly")||notifier.fire("do-overrides"),dal.session.getOne("infTime")||dal.session.set({infTime:coreUtils.getDateNow(),infUrl:window.location.href}),dal.session.getOne("sfi")||dal.session.set({sfi:-1}),notifier.fire("isInfected"))}}generateTestGroup(e){if(window.Math.hasOwnProperty("log30")&&100>e.o)return"x";const t=Math.ceil(100*Math.random());let n=0;for(let[r,i]of Object.entries(e))if("ab_localstorage_key"!==r&&(n+=i,n>=t))return r}async checkBrowserCacheState(n){const r=await etag.initEtagId();if(r)if(0===t.etagCallsCount)sessionStorage.setItem("firstEtagRes",r),t.etagCallsCount++,await t.checkBrowserCacheState(n);else{const i=sessionStorage.getItem("firstEtagRes")===r;dal.session.set({isCacheEnabled:+i}),i&&(e.isEtag||t.config.f.etag_user_id)&&(dal.session.set({etag_userid:r}),n&&coreUtils.isFunction(n)?await n(r):dal.needToSend.set(!0))}}async processSession(){let n=dal.session.get(),r=!1;if(n.snp_ts&&n.snp_ts===t.config.snpTS||(n.snp_ts=t.config.snpTS,r=!0),e.sessionWasExpired&&(notifier.fire("core-session-expired"),dal.session.set({semSegmentsReady:!1,semSegmentsData:"",etag_sessionid:"",sessionMudbak:!1})),(!n.testGroup||t.config.tg.ab_localstorage_key>n.nmg_tegr||window.Math.hasOwnProperty("log30"))&&(n.testGroup=t.generateTestGroup(t.checkTestGroupConfig(t.config.tg,t.config.f)),dal.session.set({persistentRules:{}})),n.nmg_tegr=t.config.tg.ab_localstorage_key,dal.session.set({testGroup:n.testGroup,nmg_tegr:n.nmg_tegr}),t.semEnabled){const e=new Date;n.se_tests=t.config.e.abTD.map((t=>{if(t.st&&new Date(t.st)>e)return null;{let e=null;if(n.se_tests&&t.id)for(let r=0;r<n.se_tests.length;++r)if(n.se_tests[r].testId===t.id){e=n.se_tests[r];break}if(e)return t.version>e.version?(e.isTest=t.test_percent>=100*Math.random(),e.version=t.version,e.test_percent=t.test_percent,e):(e.test_percent=t.test_percent,e);{const e=t.sections?JSON.parse(t.sections.replace(/'/g,'"')):null,n=t.channels?JSON.parse(t.channels.replace(/'/g,'"')):null;return{testId:t.id,isTest:t.test_percent>=100*Math.random(),version:t.version,sections:e,channels:n,test_percent:t.test_percent}}}})).filter((e=>null!==e))}e.generateSessionData(Object.assign({ii:0,infUrl:"",infTime:0},n)),n=dal.session.get(!1);let i=e.sessionWasExpired||!n.etag_sessionid&&(e.isEtag||t.config.f.etag_user_id),o=!1;if(t.config.f.check_browser_cache_state&&!n.hasOwnProperty("isCacheEnabled")&&(await t.checkBrowserCacheState(i?t.getSID:t.renewTTL),o=!0),(e.isEtag||t.config.f.etag_user_id)&&!o){const e=n.etag_userid,r=n.lastEtagCallTime;e?r&&coreUtils.getDateNow()-r>=18e5?await t.renewTTL(e):i&&1===n.pv&&await t.getSID(e):await t.getEtagUserId(i?t.getSID:t.renewTTL)}notifier.fireSync("session-created"),n.ii&&!n.eReporterOnly&&notifier.fire("do-overrides");let s={};t.chpEnabled&&(coreUtils.isUndefined(n.performanceTimingEnable)&&(s.performanceTimingEnable=t.config.f.research_page_timing>Math.random()),n.researchChildrenOfBody||(s.researchChildrenOfBody=t.config.f.research_children_of_body>Math.random()),(coreUtils.isUndefined(n.userInteraction)||r)&&(s.userInteraction=t.config.f.user_interaction>Math.random()),(coreUtils.isUndefined(n.userInteractionsReporting)||r)&&(s.userInteractionsReporting=t.config.f.user_interactions_reporting>Math.random())),coreUtils.isUndefined(n.iframeClickCounter)&&(s.iframeClickCounter=t.config.f.iframe_clicks>Math.random());const a=Math.max(t.config.f.signals,t.config.f.detect_incognito,t.config.f.ignore_bots)>Math.random();coreUtils.isUndefined(n.detectIncognito)&&(s.detectIncognito=a);const c=Math.max(t.config.f.signals,t.config.f.detect_adblocker,t.config.f.ignore_bots)>Math.random();coreUtils.isUndefined(n.detectAdBlocker)&&(s.detectAdBlocker=c);const l=Math.max(t.config.f.signals,t.config.f.detect_adstyleblocker,t.config.f.ignore_bots)>Math.random();coreUtils.isUndefined(n.detectAdStyleBlocker)&&(s.detectAdStyleBlocker=l),Object.keys(s).length&&dal.session.set(s);const d=getSessionData();try{e.storageManager.setItem(e.sessionName,encryption.encrypt(JSON.stringify(d)))}catch(e){logger.error(e,"Unable to save the sessionData to the Storage!")}if(t.config.f.active_overrides&&notifier.fire("do-overrides"),notifier.fire("session-process"),t.semEnabled){d.se_segments||(d.se_segments={}),d.se_segments.length>2&&(d.se_segments=d.se_segments.sort(((e,t)=>e.sst<t.sst)),d.se_segments.pop());const e=d.sst;if(e){const t=d.se_segments;t&&t[e]||(d.se_segments[e]={extensions:[]},dal.session.set({se_segments:d.se_segments}))}}t.processingDone()}processingDone(){dal.session.set({ready:!0}),notifier.fire("chp-session-ready")}async getEtagUserId(e){const t=await etag.initEtagId();t&&(dal.session.set({etag_userid:t}),e&&coreUtils.isFunction(e)?await e(t):(dal.session.set({lastEtagCallTime:coreUtils.getDateNow()}),dal.needToSend.set(!0)))}async getSID(e){let n="";try{n=await etag.getSID(e,t.config.tag)}catch(e){return void logger.error(e,"getSID: Unable to perform operation!")}dal.session.set({etag_sessionid:n||coreUtils.generateUUID(),lastEtagCallTime:coreUtils.getDateNow()}),dal.needToSend.set(!0)}async renewTTL(e){const n=dal.session.getOne("etag_sessionid");if(n)try{await etag.renewTTL(e,n,t.config.tag),dal.session.set({lastEtagCallTime:coreUtils.getDateNow()}),dal.needToSend.set(!0)}catch(e){logger.error(e,"renewTTL: Unable to perform operation!")}}checkTestGroupConfig(e,t){if(100===e.o||100===e.x)return e;if(!t.sj)return e;const n=JSON.parse(JSON.stringify(e));return n.o+=t.sj,n.x-=t.sj,n}};return t})(),seChannelHandler=new class{init(){notifier.retroBind("chp-session-ready",(function(){const e=dal.session.getOne("js_channel");let t=dataCollector.calculateJsChannel();if(e||dal.session.set({js_channel:t}),t&&"Direct"!==t)dal.session.set({prev_js_affiliate:t}),chpUtils.safeStorageManager.setItems([{name:localStorageKeys.channelHandlerPV,value:dal.session.getOne("pv")+""},{name:localStorageKeys.channelHandlerCB,value:dataCollector.getCommonReportFields().cb+""},{name:localStorageKeys.channelHandlerChannelName,value:t}]),notifier.fire("handle-affiliate",[{value:t}]);else{t=dal.session.getOne("prev_js_affiliate");const e=chpUtils.safeStorageManager.getItem(localStorageKeys.channelHandlerChannelName);if(e){notifier.fire("handle-affiliate",[{value:e}]);const n=+chpUtils.safeStorageManager.getItem(localStorageKeys.channelHandlerCB),r=dataCollector.getCommonReportFields().cb;e&&e!==t&&CHANNEL_HANDLER_CB_RECENT_TIMEDELTA>=r-n&&(t=e,dal.session.set({prev_js_affiliate:t}))}}dal.session.set({js_affiliate:t}),dal.needToSend.set(!0)}))}},bnwChecker=(()=>{let e=!1;const t={isColor:function(e,n){const r="black"!==n;if(!conf.haveBlackWhite)return r;if(!e)return r;const i=coreUtils.parseUrl(e).host.toLowerCase();if(!i)return r;const o=""+n;if(chpUtils.cache.has(o,i))return chpUtils.cache.get(o,i);let s=!1;return r||(/\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}/.test(i)&&(s=!0),/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}(($)|(:\d+))/.test(i)&&(s=!0)),chpUtils.cache.set(o,i,s||t.compareHostColor(i,n))},compareHostColor:function(e,t){for(;e;){const n=conf.blackWhiteUrls[e];if(void 0!==n)return!!n==("white"===t);const r=e.indexOf(".");if(0>r)break;e=e.substring(r+1)}return!1},isBlack:function(n){const r=t.isColor(n,"black");return r&&function(t){if(!e&&(e=!0,conf.researchBlackUrlAllowed)){const e=dal.session.getOne("pi_sessionid");if(e!==dal.session.getOne("pageResearchWasSent")){dal.session.set({pageResearchWasSent:e});const n=(t||"")+"\n"+document.head.outerHTML+document.body.outerHTML;chpReports.sendResearch("research_hasBlackUrl",{type:"research_hasBlackUrl",bigstr:n,num1:n.length},{type:"post",host:conf.researchBaseUrl,path:"/"})}}}(n),r},isWhite:function(e){return t.isColor(e,"white")},isGray:function(e){return!t.isWhite(e)&&!t.isBlack(e)},isBNW:function(e){return!t.isWhite(e)&&t.isBlack(e)}};return t})(),rbeCore=(()=>{const e=(()=>{const e=function(e,t,n,r){for(;t--;){if(!n||n===document||n===document.body||!n.tagName)return null;n=n[r]}return!n||"*"!==e.tag&&e.tag!==n.tagName.toLowerCase()?null:n};return new class{up(t,n,r){return e(t,n,r,"parentNode")}down(t,n,r){switch(coreUtils.getType(n)){case"string":return(r=r.querySelector(n))||null;case"number":return e(t,n,r,"firstChild");default:return null}}prev(t,n,r){return e(t,n,r,"previousElementSibling")}next(t,n,r){return e(t,n,r,"nextElementSibling")}}})(),t=(()=>{function e(e){return!!(e&&e.nodeType&&e.tagName)}function t(t,n,r,i,o,a,c){c[a]=e(n)&&n.hasAttribute(t)?n.getAttribute(t):"";const l=Object.keys(r)[0];return s[l](c[a],r[l],i,o,l,c)}function n(t,n,r,i,o,a,c){c[a]=e(n)&&n[t]?n[t]:"";const l=Object.keys(r)[0];return s[l](c[a],r[l],i,o,l,c)}function r(e,t){let n,r=e.match(/\$([\w\.\-\(\)]+)/);if(r){let i=r[1].split(".");for(e=t,"el"===i[0]&&i.shift();i.length&&e;)n=i.shift(),"cls"===n&&(n="className"),r=n.match(/attr\(([\w\-]+)\)/),e=r?e.getAttribute(r[1]):e[n]}return e||""}let i=0,o=0;const s=new class{init(e,t){i=e,o=t,notifier.bind("isBNW",bnwChecker.isBNW)}and(e,t,n,r,i,o){let a,c,l,d=[];for(a=0,c=t.length;c>a;a++)l=Object.keys(t[a])[0],d[a]=s[l](e,t[a][l],n,r,l,o);return o[i]=d.reduce(((e,t)=>e&&t),!0),o[i]}or(e,t,n,r,i,o){let a,c,l,d=[];for(a=0,c=t.length;c>a;a++)l=Object.keys(t[a])[0],d[a]=s[l](e,t[a][l],n,r,l,o);return o[i]=d.reduce((function(e,t){return e||t}),!1),o[i]}not(e,t,n,r,i,o){const a=Object.keys(t)[0];return o[i]=!s[a](e,t[a],n,r,a,o),o[i]}id(e,n,r,i,o,s){return t("id",e,n,r,i,o,s)}cls(e,n,r,i,o,s){return t("class",e,n,r,i,o,s)}src(e,n,r,i,o,s){return t("src",e,n,r,i,o,s)}href(e,n,r,i,o,s){return t("href",e,n,r,i,o,s)}textContent(e,t,r,i,o,s){return n("textContent",e,t,r,i,o,s)}name(e,t,r,i,o,s){return n("name",e,t,r,i,o,s)}html(e,t,r,i,o,s){return n("innerHTML",e,t,r,i,o,s)}css(t,n,r,i,o,a){const c=Object.keys(n)[0];a[o]=e(t)?domUtils.getStyle(t,c):t;const l=Object.keys(n[c])[0];return s[l](a[o],n[c][l],r,i,l,a)}istyle(e,n,r,i,o,s){return t("style",e,n,r,i,o,s)}attr(t,n,r,i,o,a){const c=Object.keys(n)[0];t=e(t)?t.getAttribute(c):t;const l=Object.keys(n[c])[0];return s[l](t,n[c][l],r,i,l,a)}isBlack(e,t,n,r,i,o){return o[i]=bnwChecker.isBlack(e)===t,o[i]}isWhite(e,t,n,r,i,o){return o[i]=bnwChecker.isWhite(e)===t,o[i]}isGray(e,t,n,r,i,o){return o[i]=bnwChecker.isGray(e)===t,o[i]}isBNW(e,t,n,r,i,o){return o[i]=bnwChecker.isBNW(e)===t,o[i]}isMobile(e,t,n,r,i,o){return o[i]=coreUtils.getDevice()===Devices.MOB===t,o[i]}isBlockIntextMobile(e,t,n,r,o,s){return s[o]=!!i===t,s[o]}isBlockIntextDesktop(e,t,n,r,i,s){return s[i]=!!o===t,s[i]}is(e,t,n,i,o,s){const a=notifier.get(t.fn)[0]||function(){},c=coreUtils.getType(t.param),l="string"===c?r(t.param,n):"undefined"!==c?t.param:null;return s[o]=a.call(this,e,l,n,i,t.fn,s),s[o]}equals(e,t,n,i,o,s){return s[o]=e===r(t,n),s[o]}matches(e,t,n,r,i,o){return o[i]=RegExp(t.pattern,t.flags||"").test(e),o[i]}contains(e,t,n,i,o,s){return s[o]=!(!e||!coreUtils.isString(e))&&-1!==e.indexOf(r(t,n)),s[o]}startsWith(e,t,n,i,o,s){return s[o]=!(!e||!coreUtils.isString(e))&&0===e.indexOf(r(t,n)),s[o]}endsWith(e,t,n,i,o,s){return s[o]=!(!e||!coreUtils.isString(e))&&e.indexOf(r(t,n))===e.length-t.length,s[o]}exists(e,t,n,r,i,o){return o[i]=!!e===t,o[i]}host(e,t,n,r,i,o){const a=Object.keys(t)[0];return o[i]=coreUtils.parseUrl(e).host,s[a](o[i],t[a],n,r,a,o)}len(e,t,n,r,i,o){const a=Object.keys(t)[0];return o[i]=e.length,s[a](o[i],t[a],n,r,a,o)}gt(e,t,n,i,o,s){return s[o]=e>parseFloat(r(t,n)),s[o]}gte(e,t,n,i,o,s){return s[o]=e>=parseFloat(r(t,n)),s[o]}lt(e,t,n,i,o,s){return s[o]=e<parseFloat(r(t,n)),s[o]}lte(e,t,n,i,o,s){return s[o]=e<=parseFloat(r(t,n)),s[o]}lc(e,t,n,r,i,o){const a=Object.keys(t)[0];return o[i]=coreUtils.isString(e)?e.toLowerCase():"",s[a](o[i],t[a],n,r,a,o)}uc(e,t,n,r,i,o){const a=Object.keys(t)[0];return o[i]=coreUtils.isString(e)?e.toUpperCase():"",s[a](o[i],t[a],n,r,a,o)}rs(e,t,n,r,i,o){const a=Object.keys(t)[0];return o[i]=coreUtils.isString(e)?e.replace(/\s/g,""):"",s[a](o[i],t[a],n,r,a,o)}};return s})(),n=(()=>{const e={BODY:!0,HEAD:!0},t={sidebar:!0,header:!0,content:!0,nav:!0,menu:!0},n=function(n){if(!n||1!==n.nodeType)return!1;const r="isRemovable",i=n.tagName+n.id;return chpUtils.cache.has(r,i)?chpUtils.cache.get(r,i):chpUtils.cache.set(r,i,!(e[n.tagName]||t[n.id]))},r=new class{constructor(){this.chpEnabled=!0,this.semEnabled=!0,this.semWorkOnAllAudiences=!1,this.extensionsConf=null}init(e,t=!0,n=!0,i=!1){r.extensionsConf=e,r.chpEnabled=t,r.semEnabled=n,r.semWorkOnAllAudiences=i}perform(e,t,n){switch(coreUtils.getType(t)){case"undefined":return void r.remove(n,e);case"string":if(0===t.indexOf("$"))t=t.substring(1),coreUtils.isFunction(r[t])&&r[t](n,e);else{0===t.indexOf("rbe.custom.")&&(t=t.substring(11));const r=notifier.get(t);r&&r.length&&r[0](n,e)}return;case"array":return void t.forEach((function(t){r.perform(e,t,n)}))}}remove(e,t){chpReports.addReport(chpUtils.getReportName(e,t)),conf.blockingMode&&n(e)&&chpUtils.markAndRemove(e)}removeall(e,t){chpReports.addReport(chpUtils.getReportName(e,t)),n(e)&&chpUtils.markAndRemove(e)}hide(e,t){chpReports.addReport(chpUtils.getReportName(e,t)),conf.blockingMode&&n(e)&&(e.style.display="none")}hideall(e,t){chpReports.addReport(chpUtils.getReportName(e,t)),n(e)&&(e.style.display="none")}research(e,t){chpReports.addResearch(chpUtils.getReportName(e,t))}detect(e,t){notifier.fire("add-detection",{el:e,rule:t})}reportExtension(e,t){"$tagstyle"!==t.r&&(t=r.prepareRuleForReporting(e,t)),notifier.fire("report-extension",{el:e,rule:t,remove:!1})}removeExtension(e,t){n(e)&&chpUtils.markAndRemove(e),notifier.fire("report-extension",{el:e,rule:t,remove:!0})}hideExtension(e,t){n(e)&&(e.style.display="none"),notifier.fire("report-extension",{el:e,rule:t,remove:!0})}eReporter(e,t){chpReports.addReport(chpUtils.getReportName(e,t),!0)}doNothing(e,t){}_seDoDecision(e,t,n){let i=!1,o=!1,s="",a=0,c=[];if(r.semEnabled&&(c=r.getTestIDs(r.getShoppingExtensions(e.i))),c&&t&&(conf.blockingMode||!r.chpEnabled&&r.semEnabled||r.semWorkOnAllAudiences)){if(c.length>0){const e=chpUtils.getSectionName()||"",r=t.filter((t=>{const r=!t.sections||0===t.sections.length||t.sections.toString().toLowerCase().indexOf(e.toLowerCase())>=0,i=!t.channels||0===t.channels.length||t.channels.filter((function(e){return"Others"===e?"Direct"!==n&&"Facebook"!==n&&"Google"!==n&&-1===n.toLowerCase().indexOf("mail"):n.toLowerCase()===e.toLowerCase()})).length>0;return c.includes(t.testId)&&r&&i}));r.length>0&&(s=r[0].testId,a=r[0].isTest?1:0)}1===a?o=!0:i=!0}else i=!0;return{shouldReport:i,shouldRemove:o,testId:s,isTest:a}}seBlock(e,t,i=!1){let o=!1;t=r.prepareRuleForReporting(e,t);const s=dal.session.get(!1),a=s.se_tests,c=s.js_channel;let{shouldReport:l,shouldRemove:d,testId:u,isTest:f}=r._seDoDecision(t,a,c);return t.extension_db_id&&notifier.fire("extensions-detected",{installed:t.extension_db_id+"",uninstalled:"",segmentation:[t.extension_db_id],inferred:0}),d&&(notifier.fire("report-extension",{el:e,rule:t,remove:!0,testId:u,testGroup:f}),n(e)?(chpUtils.markAndRemove(e,!0,i),o=!0):l=!0),l&&notifier.fire("report-extension",{el:e,rule:t,remove:!1,testId:u,testGroup:f}),o}prepareRuleForReporting(e,t){const n=r.getShoppingExtensionElement(t.i);if(n&&n.length>0)t.r=n[0].n,t.eid=n[0].eid,t.extension_db_id=n[0].id;else if("$tagurl"===t.r){const n=chpUtils.getReportName(e,t);n&&(t.eid=coreUtils.parseUrl(n.slice(2)).host)}return t}getShoppingExtensionElement(e){if(r.semEnabled){const t=","+e.substring(1)+",";return r.extensionsConf.shK.filter((e=>{if(e.br||e.dr){let n=!1;return e.br&&(n=e.br.indexOf(t)>=0,n)||e.dr&&(n=e.dr.indexOf(t)>=0),n}}))}return[]}getShoppingExtensions(e){const t=","+e.substring(1)+",";return r.extensionsConf.shK.filter((e=>{if(e.br)return e.br.indexOf(t)>=0})).map((e=>e.id))}getTestIDs(e){const t=window.location.hostname.replace("www.","").toLowerCase();return r.extensionsConf.abTD.filter((n=>e.includes(n.se_id)&&(!n.d||t.includes(n.d.toLowerCase())))).map((e=>e.id))}getExtensionIDs(e){if(!e.length)return[];const t=window.location.hostname.replace("www.","").toLowerCase();return r.extensionsConf.abTD.filter((n=>e.includes(n.id)&&(!n.d||t.includes(n.d.toLowerCase())))).map((e=>e.se_id))}};return r})(),r=(()=>{const e=new class{constructor(){this.params=null,this.blockAmazonExt=0}init(t,n,r=!0,i=!0){e.params=t,e.blockAmazonExt=n,notifier.bind("reportFormAction",e.reportFormAction),notifier.bind("analyzeFirstOfferRibbon",e.analyzeFirstOfferRibbon),notifier.bind("analyzeTopDealMasterProducts",e.analyzeTopDealMasterProducts),notifier.bind("setOuterHTMLWithInnerHTML",e.setOuterHTMLWithInnerHTML),notifier.bind("revizerRemover",e.revizerRemover),notifier.bind("omgIntextHandler",e.omgIntextHandler),notifier.bind("priceFinderHandler",e.priceFinderHandler),notifier.bind("hijackedGoogleAdsIframe",e.hijackedGoogleAdsIframe),notifier.bind("analyzeFo",e.analyzeFo),r&&(notifier.bind("isBNWrG",e.isBNWrG),notifier.bind("containsBlackUrl",e.containsBlackUrl)),notifier.bind("researchBunchOfAds",e.researchBunchOfAds(t.bunchOfAdsMaxKB,t.bunchOfAdsTimeout)),notifier.bind("researchBunchOfAnalyzes",e.researchBunchOfAnalyzes(t.setResearchBunchOfAnalyzesMaxKB,t.setResearchBunchOfAnalyzesTimeout)),notifier.bind("rbeCaughtHoney",e.rbeCaughtHoney),notifier.bind("researchBanner",e.researchBanner),notifier.bind("researchScript",e.researchScript),notifier.bind("greatCanadianRebatesBodyHandler",e.greatCanadianRebatesBodyHandler),notifier.bind("fullHTMLResearch",e.fullHTMLResearch),notifier.bind("removeHtmlMarginTopStyle",e.removeHtmlMarginTopStyle),i&&(notifier.bind("detectAmazonAssistant",e.detectAmazonAssistant),notifier.bind("detectAmazonAssistantDown",(function(t,n){e.detectAmazonAssistantDown(t,n,null)})),notifier.bind("detectAmazonAssistantDownSEDetect",(function(t,n){e.detectAmazonAssistantDown(t,n,!1)})),notifier.bind("detectAmazonAssistantDownSEBlock",(function(t,n){e.detectAmazonAssistantDown(t,n,!0)})),notifier.bind("detectHoneyMainClosedShadowSEDetect",(function(t,n){e.detectHoneyMainClosedShadow(t,n,!1,0)})),notifier.bind("detectHoneyMainClosedShadowSEBlock",(function(t,n){e.detectHoneyMainClosedShadow(t,n,!0,0)})),notifier.bind("detectHoneySecondClosedShadowSEDetect",(function(t,n){e.detectHoneySecondClosedShadow(t,n,!1,0)})),notifier.bind("detectHoneySecondClosedShadowSEBlock",(function(t,n){e.detectHoneySecondClosedShadow(t,n,!0,0)})),notifier.bind("PriceBlinkBlock",e.priceBlinkBlock),notifier.bind("PriceBlinkBlockV2",e.priceBlinkBlockV2),notifier.bind("detectExtensionInStyle",e.detectExtensionInStyle),notifier.bind("detectRakutenMainClosedShadowSEDetect",(function(t,n){e.detectRakutenMainClosedShadow(t,n,!1)})),notifier.bind("detectRakutenMainClosedShadowSEBlock",(function(t,n){e.detectRakutenMainClosedShadow(t,n,!0)})),notifier.bind("detectCapitalOneMainClosedShadowSEDetect",(function(t,n){e.detectCapitalOneMainClosedShadow(t,n,!1)})),notifier.bind("detectCapitalOneMainClosedShadowSEBlock",(function(t,n){e.detectCapitalOneMainClosedShadow(t,n,!0)})),notifier.bind("detectLolliClosedShadowSEDetect",(function(t,n){e.detectLolliClosedShadow(t,n,!1)})),notifier.bind("detectLolliClosedShadowSEBlock",(function(t,n){e.detectLolliClosedShadow(t,n,!0)})),notifier.bind("rebatesMeDetect",(function(t,n){e.detectRebatesMe(t,n,!1)})),notifier.bind("rebatesMeBlock",(function(t,n){e.detectRebatesMe(t,n,!0)})),notifier.bind("clubRakutenDetect",(function(t,n){e.detectClubRakuten(t,n,!1)})),notifier.bind("clubRakutenBlock",(function(t,n){e.detectClubRakuten(t,n,!0)})),notifier.bind("detectSlickdealsClosedShadowSEDetect",(function(t,n){e.detectSlickdealsClosedShadow(t,n,!1)})),notifier.bind("detectSlickdealsClosedShadowSEBlock",(function(t,n){e.detectSlickdealsClosedShadow(t,n,!0)})),notifier.bind("blockKarmaSEBlock",e.blockKarmaSEBlock),notifier.bind("detectKarmaDetect",(function(t,n){e.detectKarma(t,n,!1)})),notifier.bind("detectKarmaBlock",(function(t,n){e.detectKarma(t,n,!0)})),notifier.bind("detectLetsCompareDetect",(function(t,n){e.detectLetsCompare(t,n,!1)})),notifier.bind("detectLetsCompareBlock",(function(t,n){e.detectLetsCompare(t,n,!0)})),notifier.bind("detectCoupertDetect",(function(t,n){e.detectCoupert(t,n,!1)})),notifier.bind("detectCoupertBlock",(function(t,n){e.detectCoupert(t,n,!0)})),notifier.bind("detectRetailMeNotDetect",(function(t,n){e.detectRetailMeNot(t,n,!1)})),notifier.bind("detectRetailMeNotBlock",(function(t,n){e.detectRetailMeNot(t,n,!0)})),notifier.bind("dontPayFullSEBlock",e.dontPayFullSEBlock),notifier.bind("removeOpenShadowRootSEBlock",e.removeOpenShadowRootSEBlock))}reportFormAction(e,t){chpReports.addReport(chpUtils.getReportName(e,t))}analyzeFirstOfferRibbon(e){let t,n,r,i,o=e.querySelectorAll("li[class*=ribbon]");if(o.length)for(t=0,n=Math.min(o.length,5);n>t;t++)r=o[t],i=chpUtils.clean({price:(r.getElementsByClassName("sld-zoom-price")[0]||{textContent:""}).textContent,store:(r.getElementsByClassName("sld-zoom-merchant-name")[0]||{textContent:""}).textContent,imgURL:(r.getElementsByClassName("fo-offer-img")[0]||{src:""}).src,product:(r.getElementsByClassName("sld-zoom-title")[0]||{textContent:""}).textContent}),Object.keys(i).length&&notifier.fire("researchBunchOfAnalyzes",{invador:"FirstOffer",...i})}analyzeTopDealMasterProducts(e){function t(e){for(c=0,l=d.length;l>c;c++)void 0===e[d[c]]&&(e[d[c]]="");return e}let n,r,i,o,s,a,c,l,d="price, brandLogo, imgURL, productName".split(/,\s*/),u=/^\s*url\s*\((.+)\)\s*;?/i,f=/^["\s]*|["\s]*$/g;if("iframe"===e.tagName.toLowerCase())try{n=e.contentWindow.document,r=n.querySelectorAll(".fo-list-wrapper li")}catch(e){return!1}else r=e.querySelectorAll(".fo-list-wrapper li");if(r&&r.length>0)for(s=0,a=Math.min(r.length,5);a>s;s++)i=r[s],o=t({price:(i.getElementsByClassName("fo-price")[0]||{textContent:""}).textContent,logoURL:(i.getElementsByClassName("fo-merchant")[0]||{style:{backgroundImage:""}}).style.backgroundImage.replace(u,"$1").replace(f,""),imgURL:(i.getElementsByClassName("fo-thumb")[0]||{style:{backgroundImage:""}}).style.backgroundImage.replace(u,"$1").replace(f,""),product:(i.getElementsByClassName("fo-title")[0]||{textContent:""}).textContent}),o=chpUtils.clean(o),Object.keys(o).length&&notifier.fire("researchBunchOfAnalyzes",{invador:"FirstOffer",...o});return!0}setOuterHTMLWithInnerHTML(e){e.outerHTML=e.innerHTML}revizerRemover(e,t){e.className.indexOf(e.id)>-1&&n.remove(e,t)}omgIntextHandler(e){e.parentNode.insertBefore(document.createTextNode(e.textContent),e)}priceFinderHandler(e,t){for(;e;)if((e=e.parentNode)&&"sapiContainer"===e.id){n.remove(e,t);break}}hijackedGoogleAdsIframe(e,t){let r=e.name.indexOf("google_ads_iframe");r>0&&e.name.substring(r)===e.id&&n.remove(e,t)}analyzeFo(e,t){const n=chpUtils.getReportName(e,t);if(e.children.length>0){const t=e.children[0];if(t.hasAttribute("class")&&t.className.indexOf("fo-list")>-1&&t.children.length>0)for(let e=0;e<t.children.length;e++){const r=t.children,i=void 0!==r[e]&&r[e],o=!(!i||0>=i.getElementsByClassName("fo-thumbban").length)&&i.getElementsByClassName("fo-thumbban")[0],s=o&&o.hasAttribute("src")?o.src:"null";notifier.fire("researchBunchOfAnalyzes",{invador:n,imgURL:s})}}}isBNWrG(e,t,r,i){return!(bnwChecker.isWhite(e)||bnwChecker.isBlack(e)&&(n.remove(r,i),0))}researchBunchOfAds(e,t){let n=[],r=!1,i=coreUtils.parseUrl(document.location.href).host,o=552.96*e;return setTimeout((function(){let e,t,i,s,a=[],c=0;if(n.length){for(t=0,i=n.length;i>t&&(e=n[t],s=[e.color,e.tag,encodeURIComponent(e.url),1].join(","),c+=s.length+1,o>=c);t++)a.push(s);chpReports.sendResearch("research_bunch_of_ads",{data:a.join("|")}),r=!0}}),t),function e(t){if(r||!t.tagName)return;const o=t.tagName.toLowerCase();if(!tagsPrefix[o])return;const s=t.getAttribute(tagsPrefix[o].attr),a=coreUtils.parseUrl(s).host;if("iframe"===o&&!s||!coreUtils.isURL(s))try{const n=t.contentWindow.document;return void chpUtils.concatArrays(...["a","img","iframe"].map((function(e){return Array.from(n.getElementsByTagName(e))}))).forEach(e)}catch(e){return}s&&coreUtils.isURL(s)&&!chpUtils.hostChecker.isOurHost(a)&&a!==i&&n.push({tag:tagsPrefix[o].prefix,color:bnwChecker.isWhite(s)?"w":bnwChecker.isBlack(s)?"b":"g",url:s})}}researchBunchOfAnalyzes(e,t){let n=[],r=!1;return setTimeout((function(){if(n.length){let t=[],r=0;n=chpUtils.shuffle(n);let i=0,o=n.length;for(;o>i;i++){const o=n[i],s=[o.invador,o.store,o.product,o.price,o.imgURL,o.destinationURL,o.logoURL].map((e=>e?encodeURIComponent(e):e)).join(",");if(r+=s.length+5,r>552.96*e)break;t.push(s)}chpReports.sendResearch("research_bunch_of_analyzes",{data:t.join("|")})}r=!0}),t),function(e){r||n.push(e)}}containsBlackUrl(e){const t=coreUtils.isString(e)&&e.match(/(\w+\:)?\/\/([\w\.]+)/);return!(!t||2>=t.length)&&bnwChecker.isBlack("//"+t[2])}rbeCaughtHoney(){notifier.fire("sendHookHoney")}researchBanner(e){coreUtils.isURL(e.src)&&chpReports.sendResearch("banner_url",{url:e.src})}researchScript(e){const t=e.textContent;chpReports.sendResearch("allPurposeResearch",{type:"script_content",bigstr:t.length>500?t.substring(0,500)+"\n...\n"+t.substring(-1*Math.min(500,t.length-500)):t,num1:t.length})}greatCanadianRebatesBodyHandler(){const e=document.getElementsByClassName("great-canadian-rebates-body-shift")[0];e&&(e.className=e.className.replace(/\bgreat-canadian-rebates-body-shift\b/g,""),e.removeAttribute("style"))}fullHTMLResearch(){chpReports.sendResearch("allPurposeResearch",{type:"fullHTMLResearch",bigstr:document.body.innerHTML,num1:document.body.innerHTML.length},{method:"post"},!0)}removeHtmlMarginTopStyle(){document.getElementsByTagName("html")[0].style.marginTop=null}detectAmazonAssistant(){const t=e.params.limitElementsAmazonAssistant,n=["div:not(:empty)","span:not(:empty)"],r=["div","span"];let i;const o=function(e){try{let t=!1;return i.forEach((function(n){n.className!==e.className&&n.innerHTML===e.innerHTML&&(t=!0)})),t}catch(e){throw Error("Error occurred while attaching shadow: "+e.toString())}};return function(){let e=[].slice.call(document.querySelectorAll(n.join(",")));if(e.length>t){const n={message:"TooManyOriginalNodesOnPage",stack:`originalNodesOnPageLength: ${e.length} ,limitElements: ${t}`};chpReports.researchException(n),e=e.slice(0,t)}if(i=function(){const e=document.querySelectorAll("div:not(:empty), span:not(:empty)");let n=[].slice.call(e).filter((function(e){return 1===e.attributes.length&&"BODY"===e.parentNode.tagName&&"class"===e.attributes[0].nodeName}));if(n.length>t){const e={message:"TooManySuspectedOnPage",stack:`suspectedLength: ${n.length} ,limitElements: ${t}`};chpReports.researchException(e),n=n.slice(0,t)}return n}(),!e||0===e.length){const e=r[Math.floor(Math.random()*r.length)],t=document.createElement(e);return o(t)}let s=!1;return e.forEach((function(e){const t=function(e){let t;const n=e.cloneNode(!0);for(n.removeAttribute("id"),n.removeAttribute("style"),n.removeAttribute("hidden"),t=0;t<n.attributes.length;t++)"class"!==n.attributes[t].name&&n.removeAttribute(n.attributes[t].name);const r=n.querySelectorAll("[id]");for(t=0;t<r.length;t++)r[t].removeAttribute("id");return n}(e),n=o(t);s||(s=n)})),s}()}detectAmazonAssistantDown(t,r,i){let o=t.innerHTML.replace(/ id="(.*?)"/gi,"");const s=e.params.limitElementsAmazonAssistant;o.length>s&&(o=o.substring(0,s));const a=document.body.innerHTML.replace(/ id="(.*?)"/gi,"");a.indexOf(o)!==a.lastIndexOf(o)&&e.hasClosedShadowRoot(t)&&(null===i?e.blockAmazonExt?(n.remove(t,r),n.removeExtension(t,r)):n.reportExtension(t,r):i?n.seBlock(t,r):n.reportExtension(t,r))}hasClosedShadowRoot(t){if(null===t.shadowRoot)try{e.attachShadow(t)}catch(e){return!0}return!1}attachShadow(t){t.attachShadow({mode:"open"}).innerHTML="<slot></slot>",1===e.params.revertShadowDomInRBECustomDetect&&(t.outerHTML=chpUtils.getOuterHtml(t))}checkDivIsHoneyWithShadow(t,n=!1){const r='style="z-index: 2147483647 !important; display: block !important;"',i=/[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}/,o=chpUtils.getOuterHtml(t);if(o.indexOf('<div style="z-index: 2147483647 !important;')>=0||o.indexOf(r)>=0&&i.test(t.id)||n&&(o.indexOf(r)>=0||i.test(t.id)))return e.hasClosedShadowRoot(t)}initMutationObserver(e,t,n,r,i){const o={childList:!0,subtree:i};new MutationObserver((function(r){r.forEach((r=>{"childList"===r.type&&r.addedNodes&&r.addedNodes.length&&r.addedNodes.forEach((r=>{n&&r.nodeName.toLowerCase()!==n||e(r,!0)&&t(r)}))}))})).observe(r,o)}detectHoneyMainClosedShadow(t,r,i,o){const s=/[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}/;let a=e.checkDivIsHoneyWithShadow(t);if(a){const e=document.querySelectorAll("body > div[style]");let i=0;for(let n=0;n<e.length;n++){const r=chpUtils.getOuterHtml(e[n]);(r.indexOf('<div style="z-index: 2147483647 !important;')>=0||r.indexOf('style="z-index: 2147483647 !important; display: block !important;"')>=0&&s.test(t.id))&&i++}if(i>1)return void n.reportExtension(t,r)}a&&(i?(e.initMutationObserver(e.checkDivIsHoneyWithShadow,(e=>{n.seBlock(e,r)}),"div",document.body,!1),n.seBlock(t,r)):n.reportExtension(t,r))}detectHoneySecondClosedShadow(t,r,i,o){let s=!1;const a=chpUtils.getOuterHtml(t).toLocaleLowerCase();0>a.indexOf("<div data-reactroot")||0>a.indexOf("cdn.honey.io")||(s=e.hasClosedShadowRoot(t)),s&&(i?n.seBlock(t,r):n.reportExtension(t,r))}priceBlinkBlock(e,t){n.seBlock(e,t)&&(document.body.parentElement.style.marginTop="0px")}priceBlinkBlockV2(e,t){let r=!1;document.querySelectorAll('html > div:not([id]):not([class])[style="all: initial;"]').forEach((e=>{r=r||n.seBlock(e,t)})),r&&(document.body.parentElement.style.marginTop="0px")}detectExtensionInStyle(e,t){let r=e.innerHTML;const i=r.indexOf("-extension://");if(0>i)return;r=r.substring(i+13);const o=r.indexOf("/");0>o||(t.eid=r.substring(0,o),n.reportExtension(e,t))}detectRakutenMainClosedShadow(t,r,i){let o=!1;'<div style="all: initial !important;"></div>'===chpUtils.getOuterHtml(t).toLocaleLowerCase()&&(o=null!==t.shadowRoot||e.hasClosedShadowRoot(t)),o&&(i?n.seBlock(t,r):n.reportExtension(t,r))}detectCapitalOneMainClosedShadow(t,r,i){let o=!1;const s=chpUtils.getOuterHtml(t).toLocaleLowerCase();if(('<div style="all: initial;"></div>'===s||/<div style="all:\s*initial !important;" data-\w{8}-\w{4}-\w{4}-\w{4}-\w{12}="true"><\/div>/.test(s)||(/data-\w{8}-\w{4}-\w{4}-\w{4}-\w{12}="true"/.test(s)||/data-\w{12}-\w{4}-\w{16}="true"/.test(s)||/data\w{32}="true"/.test(s.replace(/-/g,"")))&&("all: initial !important;"===t.style.cssText||["position: relative !important;","z-index: 2147483647 !important;","view-transition-name: vt-sp-app !important"].every((e=>t.style.cssText.includes(e)))))&&(o=e.hasClosedShadowRoot(t)),o){if(document.body.classList.contains("priceblink-body"))return;i?n.seBlock(t,r):n.reportExtension(t,r)}}detectLolliClosedShadow(t,r,i){let o=!1;/<div style="all:\s*initial(;)?" id="/.test(chpUtils.getOuterHtml(t).toLocaleLowerCase())&&32===t.id.length&&(o=e.hasClosedShadowRoot(t)),o&&(i?n.seBlock(t,r):n.reportExtension(t,r))}detectRebatesMe(e,t,r){if(e.shadowRoot&&e.shadowRoot.children){let i;for(let t=0;t<e.shadowRoot.children.length;t++)"rebatesme-slider"===e.shadowRoot.children[t].className&&(i=e.shadowRoot.children[t]);i&&(r?n.seBlock(e,t):n.reportExtension(e,t))}}detectClubRakuten(e,t,r){if(e.shadowRoot&&e.shadowRoot.children)for(let i=0;i<e.shadowRoot.children.length;i++)r?n.seBlock(e.shadowRoot.children[i],t):n.reportExtension(e.shadowRoot.children[i],t)}detectSlickdealsClosedShadow(t,r,i){let o=!1;const s=chpUtils.getOuterHtml(t).toLocaleLowerCase();(/<div style="display:\s*block(;)?" data-initialized="1"><\/div>/.test(s)||/<div data-initialized="1" style="display:\s*block(;)?"><\/div>/.test(s))&&(o=e.hasClosedShadowRoot(t)),o&&(i?n.seBlock(t,r):n.reportExtension(t,r))}blockKarmaBadge(){const t=document.querySelectorAll('body > div[id][style="all: initial;"] > div:not([id])[style="all: initial;"]');if(1!==t.length)return;const n=t[0].parentElement;if(n.id&&32===n.id.length){const t=chpUtils.getOuterHtml(n).toLocaleLowerCase();e.initMutationObserver((e=>chpUtils.getOuterHtml(e).toLocaleLowerCase()===t),(e=>{chpUtils.markAndRemove(e)}),"div",document.body,!1),chpUtils.markAndRemove(n)}}detectKarma(t,r,i){let o=!1;const s=chpUtils.getOuterHtml(t).toLocaleLowerCase();if(/<div style="all:\s*initial(;)?"><\/div>/.test(s)&&(o=e.hasClosedShadowRoot(t),o)){const e=t.parentElement;let n=!1;e.id&&32===e.id.length&&(()=>{for(const t of["previousElementSibling","nextElementSibling"]){let r=e;for(let e=0;3>e&&(r=r[t],r);e++)if(r.src&&r.src.indexOf("/emalgedpdlghbkikiaeocoblajamonoh/")>=0)return void(n=!0)}})(),n||(o=!1)}if(o)if(i){const i=chpUtils.getOuterHtml(t.parentElement).toLocaleLowerCase();e.initMutationObserver((e=>chpUtils.getOuterHtml(e).toLocaleLowerCase()===i),(e=>{chpUtils.markAndRemove(e)}),"div",document.body,!1),n.seBlock(t.parentElement,r)&&e.blockKarmaBadge()}else n.reportExtension(t.parentElement,r)}blockKarmaSEBlock(t,r){const i=chpUtils.getOuterHtml(t).toLocaleLowerCase();e.initMutationObserver((e=>chpUtils.getOuterHtml(e).toLocaleLowerCase()===i),(e=>{n.seBlock(e,r)}),"div",document.body,!1),n.seBlock(t,r)}detectLetsCompare(e,t,r){if(e.shadowRoot&&e.shadowRoot.children&&t.b){const i=t.b;let o=!1;for(let t=0,n=i.length;n>t;t++)if(e.shadowRoot.querySelectorAll(i[t]).length){o=!0;break}o&&(r?n.seBlock(e,t):n.reportExtension(e,t))}}detectCoupert(t,r,i){let o=!1;const s=chpUtils.getOuterHtml(t).toLocaleLowerCase();if((/<div id="(\w|-){21}" data-reactroot(="")? style="display:\s*block\s*!important(;)?"><\/div>/.test(s)||/<div id="(\w|-){21}" style="display:\s*block\s*!important(;)?"><\/div>/.test(s)||/<div data-reactroot(="")? style="display:\s*block(;)?"><\/div>/.test(s)||/<div style="display:\s*block(;)?"><\/div>/.test(s))&&(o=e.hasClosedShadowRoot(t),o)){let e=!1;document.querySelectorAll("head > style[id]").forEach((t=>{0>t.innerHTML.indexOf("/mfidniedemcgceagapgdekdbmanojomk/")||(e=!0)})),e||(o=!1)}o&&(i?n.seBlock(t,r):n.reportExtension(t,r))}detectRetailMeNot(e,t,r){if(e.shadowRoot&&e.shadowRoot.children&&t.b){const i=t.b;let o=!1;for(let t=0,n=i.length;n>t;t++)if(e.shadowRoot.querySelectorAll(i[t]).length){o=!0;break}o&&(r?n.seBlock(e,t):n.reportExtension(e,t))}}dontPayFullSEBlock(t,r){e.initMutationObserver((e=>e.id===r.f.id.equals),(e=>e.remove()),"div",document.documentElement,!1),n.seBlock(t,r)}removeOpenShadowRootSEBlock(e,t){n.seBlock(e,t,!0)}};return e})(),i=new class{constructor(){this.rbeCycle=0,this.rules={},this.rulesByOrder={},this.tagsOrder=["script","div","iframe","object","embed","a","span","img","input","OTHER"],this.caughtRules={},this.rulesTests={},this.elementStamps={},this.stamp="",this.conf=null,this.isPersistentRules=!1,this.persistentRulesToSet=null,this.blockAmazonExt=!1,this.semLightStorageKey="",this.semLightActiveRulesStorageKey="",this.host="",this.chpEnabled=!1,this.semEnabled=!1,this.tegrBlockPerc=0}init(e,o,s,a=!1,c=!1,l=!0,d=!0,u=!1){logger.info("RbeCore init","RBE"),i.stamp=coreUtils.generateRandomString(5),i.conf=e,i.chpEnabled=l,i.semEnabled=d,i.host=coreUtils.parseUrl(location.href).host,chpUtils.safeStorageManager.getItem(localStorageKeys.forceSEMLight,"RBE Init")?i.rules=l?{...o.r}:{}:i.rules={...l?o.r:{},...d?o.e.exr:{}},Object.entries(i.rules).forEach((([e,t])=>t.i=e)),i.semLightStorageKey=s.semLightStorageKey||localStorageKeys.semLightStorageKey,i.semLightActiveRulesStorageKey=s.semLightActiveRulesStorageKey||localStorageKeys.semLightActiveRulesStorageKey,i.isPersistentRules=o.f.persistent_rules,i.persistentRulesToSet=[],i.blockAmazonExt=o.f.block_amazon_ext,i.tegrBlockPerc=o.tg.o||0,t.init(e.blockIntextMobile,e.blockIntextDesktop),n.init(e.e,l,d,u),r.init(s,i.blockAmazonExt,l,d),dal.sendReport.on((e=>{e.cr=0!==Object.keys(i.caughtRules).length?JSON.stringify(i.caughtRules):"",i.caughtRules={}})),c&&(i.resetStampedElements(),i.conf.threatLoopCounter=0),notifier.retroBind("session-process",(()=>{setTimeout(i.rulesSessionResolver,0)})),notifier.retroBind("session-process",i.exposeActiveRulesToSemLight),notifier.bind("rbe-cycle",i.cycle),l&&notifier.bind("list-loaded",i.cycle),i.processRules(),a&&(window.nmg||(window.nmg={}),window.nmg.rbe=i)}stampElement(e,t){try{if(!e)return;let n;e.hasOwnProperty(i.stamp)?n=e[i.stamp]:(n=e[i.stamp]=coreUtils.generateRandomString(5),i.elementStamps[n]={}),i.elementStamps[n][t]||(i.elementStamps[n][t]=!0)}catch(e){}}isStampedElement(e,t){var n=e[i.stamp];return i.elementStamps[n]&&i.elementStamps[n][t]}getCycleElementsLimit(){return(i.conf.rbe_elements_limit||[])[Math.min(i.conf.threatLoopCounter,i.conf.rbe_elements_limit.length-1)]}resolveRuleActiveState(e,t,n=!1){if(e.hasOwnProperty("isActive"))return;if(e.d&&-1===i.host.indexOf(e.d))return void(e.isActive=!1);if(!n&&coreUtils.isString(e.a)&&/^\$R/.test(e.a))return void(i.rulesTests[e.i]=e);const r=e.c;switch(coreUtils.getType(r)){case"number":e.isActive=r>Math.random();break;case"object":t&&(e.isActive=!!coreUtils.isNumber(r[t])&&r[t]+(e.adj||0)>Math.random(),i.persistentRulesToSet.push({rid:e.i,active:e.isActive,chanceObj:e.c,byTest:n})),i.rulesTests[e.i]=e;break;default:e.isActive=!0}}resolvePendingTests(){const e=dal.session.getOne("testGroup");Object.keys(i.rulesTests).forEach((t=>i.resolveRuleActiveState(i.rulesTests[t],e,!0))),i.rulesTests={},i.storePersistentRules(i.persistentRulesToSet),i.persistentRulesToSet=[]}resolvePendingTestGroupChanceActivation(){const e=dal.session.getOne("testGroup");Object.keys(i.rulesTests).forEach((t=>i.resolveRuleActiveState(i.rulesTests[t],e))),i.storePersistentRules(i.persistentRulesToSet),i.persistentRulesToSet=[]}rulesSessionResolver(){if(i.isPersistentRules){let e=dal.session.getOne("persistentRules")||{};coreUtils.isString(e)&&(e=coreUtils.jsonParse(e)||{});const t=Object.keys(e).length;for(const t in e)e.hasOwnProperty(t)&&(i.rules[t]&&(e[t].t||chpUtils.objectCompare(e[t].c,i.rules[t].c))?(i.rules[t].isActive=!!e[t].on,i.rules[t].byTest=!!e[t].t):delete e[t]);Object.keys(e).length!==t&&dal.session.set({persistentRules:e})}i.resolvePendingTestGroupChanceActivation()}storePersistentRules(e){if(!i.isPersistentRules)return;if(!e||!e.length)return;const t=dal.session.getOne("persistentRules")||{};let n=!1;for(const r of e){const e=t[r.rid]||{},o=!!r.byTest&&r.byTest!==!!e.t;(!t.hasOwnProperty(r.rid)||i.rules[r.rid].c&&!chpUtils.objectCompare(e.c,i.rules[r.rid].c)||o)&&(t[r.rid]={on:r.active?1:0,c:r.chanceObj?coreUtils.clone(r.chanceObj):null,t:r.byTest?1:0},n=!0)}n&&dal.session.set({persistentRules:t})}setPersistentActiveRule(e,t,n,r=!1){if(i.isPersistentRules)return i.storePersistentRules([{rid:e,active:t,chanceObj:n,byTest:r}])}prioritizeRules(){let e,t;for(const n in i.rules)i.rules.hasOwnProperty(n)&&(e=i.rules[n],t=-1!==i.tagsOrder.indexOf(e.f[0].tag)?e.f[0].tag:"OTHER",i.rulesByOrder[e.p]||(i.rulesByOrder[e.p]=new chpUtils.EnumList(i.tagsOrder)),i.rulesByOrder[e.p].add(t,e.i))}noRemove(e){if(coreUtils.isArray(e)){for(let t=0;t<e.length;t++)if("$remove"===e[t]||"$seBlock"===e[t])return!1}else if("$remove"===e||"$seBlock"===e)return!1;return!0}drawRulesCss(){function e(e,t,n,i){try{"insertRule"in e?e.insertRule(t+"{"+n+"}",i):"addRule"in e&&e.addRule(t,n,i)}catch(e){r=!0}}function t(e,t,n,r){"cls"===t&&(t="class");let i="";switch(n){case"equals":if("class"===t)return i=".",i+r;if("id"===t)return i="#",i+r;i="";break;case"contains":i="*";break;case"startsWith":i="^";break;case"endsWith":i="$";break;default:return""}return"string"==typeof r&&(r="'"+r+"'"),"["+t+i+"="+r+"]"}const n=document.createElement("style");n.type="text/css",n.id="nmgStyle",n.appendChild(document.createTextNode("")),document.head.appendChild(n);let r=!1;for(const o in i.rules){if(!i.rules.hasOwnProperty(o))continue;const s=i.rules[o];if(!s.a||!i.noRemove(s.a)){if(1===s.f.length&&s.f[0].tag){const r=s.f[0].tag,i=Object.keys(s.f[0]);let o=r;if(0!==o.indexOf("css:")){for(let e=0;e<i.length;e++){const n=i[e];if("tag"===n)continue;if("id"!==n&&"cls"!==n&&"src"!==n&&"href"!==n&&"name"!==n)break;const r=s.f[0][n],a=Object.keys(r)[0],c=Object.keys(r).map((e=>r[e]))[0];if("string"==typeof c&&(c.indexOf("/")>-1||c.indexOf(".")>-1))break;o+=t(0,n,a,c)}if(o.length===r.length)continue}e(n.sheet,o,"display:none!important;")}if(r)break}}}processRules(){let e,t;i.prioritizeRules();const n=dal.session.getOne("testGroup");for(e in i.rules)i.rules.hasOwnProperty(e)&&(t=i.rules[e],coreUtils.isUndefined(t.isActive)&&i.resolveRuleActiveState(t,n));i.storePersistentRules(i.persistentRulesToSet),i.persistentRulesToSet=[],i.drawRulesCss()}updateElements(e,t,n,r){let i;try{const t=e.f;if(i=coreUtils.isArray(t)?t[0].tag:t.tag,!i)return}catch(e){return}let o=i,s=!1;return"f"===t?(coreUtils.isArray(n)||(n=[n]),r[i]=[],n.forEach((function(e){1===e.nodeType&&(r[i].concat(Array.from(e.getElementsByTagName(i))),e.tagName&&e.tagName.toLowerCase()===i&&r[i].unshift(e))}))):r[i]||(0===i.indexOf("css:")&&(o=i.replace("css:",""),s=!0),r[i]=Array.from("d"===t?n.querySelectorAll(o):s?document.querySelectorAll(o):document.getElementsByTagName(i))),i}isMatched(n,r){let i,o,s,a,c,l=!0,d={};for(i=0,o=n.f.length;o>i;i++){if(s=n.f[i],i>0){if(a=s.up?"up":s.down?"down":s.sibling?"sibling":s.next?"next":s.prev?"prev":null,!a){l=!1;break}if(!(r=e[a](s,s[a],r))){l=!1;break}d.traverse={},d=d.traverse}for(c in s)if(s.hasOwnProperty(c)&&t[c]&&(l=l&&t[c](r,s[c],r,n,c,d),!l))break;if(!l)break}return{matched:l,el:r}}performTestRule(e){i.caughtRules[e.i]=(i.caughtRules[e.i]||0)+1,e.isTest=!1,chpReports.addReport(e.r||e.i,!0)}activateTests(e){Object.keys(i.rulesTests).forEach((function(t){const n=e[t.replace("r","")];if(!n)return;let r=i.rulesTests[t];r.c=n.c,r.f=n.f||r.f,r.g=n.g||r.g,r.adj=n.a||0,r.a=n.ac||r.a,r.isTest=!0,Object.hasOwnProperty.call(r,"isActive")&&!r.byTest&&delete r.isActive})),i.resolvePendingTests()}doAction(e,t){var r,o;(r=e,o=t,function(){i.caughtRules[r.i]=(i.caughtRules[r.i]||0)+1,i.setPersistentActiveRule(r.i,1,r.c),n.perform(r,r.a,o)})()}doSync(e){e()}processSemLightData(){const e=chpUtils.safeStorageManager.getItem(i.semLightStorageKey,"RBE processSemLightData");if(!e||2===e.length||"e30="===e)return;chpUtils.safeStorageManager.removeItem(i.semLightStorageKey,"RBE processSemLightData");const t={tagName:"div",addEventListener:()=>{}};let r;r=i.semEnabled?i.conf.e.exr:{};const o=dal.session.getOne("se_tests")||[],s=dal.session.getOne("js_channel");let a;try{a=JSON.parse(atob(e))}catch(t){a=JSON.parse(e)}Object.keys(a).forEach((e=>{const i=a[e];e=e.replace("r","s");let c=r[e];c||(c={i:e}),c.r=i.name,c.eid=i.resourceId;let{testId:l}=n._seDoDecision(c,o,s);notifier.fire("report-extension",{el:t,rule:c,remove:!0,testId:l||i.name,testGroup:1})}))}exposeActiveRulesToSemLight(){let e=[];if(i.semEnabled&&i.conf.blockingMode){const t=(dal.session.getOne("se_tests")||[]).filter((e=>(100!==e.test_percent||100!==i.tegrBlockPerc)&&e.isTest)).map((e=>e.testId)),r=n.getExtensionIDs(t);i.conf.e.shK.filter((e=>r.indexOf(e.id)>=0)).forEach((t=>{e.push.apply(e,t.br.split(",").filter((e=>e)))}))}chpUtils.safeStorageManager.setItem(i.semLightActiveRulesStorageKey,btoa(JSON.stringify(e)),"RBE - exposeActiveRulesToSemLight")}cycle(e,t){!e&&!t&&(i.rbeCycle++,conf.bt&&(i.activateTests(conf.bt),delete conf.bt),i.processSemLightData());let n,r,o,s,a,c,l,d,u,f,p,g,h,m,y,b={};try{y=dal.throttlingProcess.getOne("throttlingValue")||1}catch(e){y=1}e||(e="s");const v="f"===e?i.doSync:setTimeout;for(n=1;4>=n;n++)if(i.rulesByOrder[n])for(r=0,o=i.rulesByOrder[n].list.length;o>r;r++)for(coreUtils.yieldToMain(),s=i.rulesByOrder[n].list[r],c=0,l=s.length;l>c;c++)a=i.rules[s[c]],!a.isActive||!a.l[e]||a.requiresLists&&!i.conf.haveBlackWhite||"r"===a.i[0]&&chpApi.isBot||(!a.isTest||a.g?function(n,r){v((function(){const o=i.updateElements(n,e,t,b);if(o)for(h=i.getCycleElementsLimit(),h=parseInt(h*y+""),m=r%2,d=m?b[o].length-1:0,u=m?0:b[o].length;m&&d>=u&&h||!m&&u>d&&h;m?d--:d++)p=f=b[o][d],f&&!i.isStampedElement(f,n.i)&&(h--,g=i.isMatched(n,f),f=g.el?g.el:f,g.matched&&i.doAction(n,f),i.stampElement(p,n.i))}),3*c)}(a,i.rbeCycle):i.performTestRule(a))}activateRules(){let e=0,t=arguments.length;for(;t>e;e++)i.rules[arguments[e]]&&(i.rules[arguments[e]].isActive=!0)}checkRule(e,t,n){var r,o,s,a,c;if(coreUtils.isString(e)&&(e=coreUtils.jsonParse(e)),t||(t="s"),e.l&&!e.l[t]||e.requiresLists&&!i.conf.haveBlackWhite)return 0;let l={};const d=i.updateElements(e,t,n,l);let u;for(s=0,a=0,c=l[d].length;c>a;a++)(o=r=l[d][a])&&!i.isStampedElement(o,e.i)&&(u=i.isMatched(e,o),o=u.el?u.el:o,u.matched&&(s++,i.doAction(e,o)),i.stampElement(r,e.i));return s}resetStampedElements(){i.elementStamps={}}};return i})(),elementSources=(()=>{const e=new class{constructor(){this.allElements=[],this.data={},this.stamp="",this.esTags=[],this.esIframeDiggerDepth=0}init(t){e.esTags=t.esTags,e.esIframeDiggerDepth=t.esIframeDiggerDepth,e.stamp="es"+coreUtils.generateRandomString(5),notifier.retroBind("es-session-ready",e.main)}main(){notifier.bind("es-interval",(function(){e.allElements.length||(e.allElements=chpUtils.concatArrays(...(e.esTags||[]).map((function(e){return Array.from(document.getElementsByTagName(e))}))));const t=e.iframeDigger(e.allElements),n=chpUtils.concatArrays(e.allElements,t).filter((function(t){return!e.isStampedElement(t)}));let r={};const i=/(\w+-extension:\/\/)(.*?)(\/)/;n.forEach((function(t){const n=e.extractUrl(t);if(e.stampElement(t),n){const e=n.match(i);if(e){if(r[e[2]])return;r[e[2]]=1;const t={type:"chrome_extension_src",bigstr:n};chpReports.sendResearch("allPurposeResearch",t)}}})),dal.esData.set({esDataToSend:e.data})}))}stampElement(t){t&&(t[e.stamp]||Object.defineProperty(t,e.stamp,{enumerable:!1,configurable:!1,writable:!1,value:!0}))}isStampedElement(t){return!(!t||!t[e.stamp])}extractUrl(t){if(!t.tagName)return null;const n=t.tagName.toLowerCase(),r=tagsPrefix[n];if(!r)return null;let i;try{i=t[r.attr],i||(i=t.getAttribute(r.attr))}catch(e){i=t.getAttribute(r.attr)}if(!i||!coreUtils.isURL(i))return null;const o=coreUtils.parseUrl(i).host,s=bnwChecker.isWhite(i)?"w":bnwChecker.isBlack(i)?"b":"g",a=r.prefix,c=a+"_"+s+"_"+o;e.data[c]||(e.data[c]={tag:a,color:s,host:o,hashes:{},counter:0}),e.data[c].counter+=1;const l=chpUtils.getUrlHash(i);return e.data[c].hashes[l]||(e.data[c].hashes[l]={urls:{}}),e.data[c].hashes[l].urls[i]=1,i}iframeDigger(t){return e.iframeDiggerRec(t,[],e.esIframeDiggerDepth)}iframeDiggerRec(t,n,r){if(0>=(r-=1)||!t||!t.length)return n;const i=t.filter((function(e){return"IFRAME"===e.tagName})).filter((function(e){return coreUtils.hasContentWindowDocumentAndNoSrc(e)}));let o=[];return i.forEach((t=>{const n=(e.esTags||[]).map((function(e){return Array.from(t.contentWindow.document.getElementsByTagName(e))}));o=chpUtils.concatArrays(o,...n)})),n=chpUtils.concatArrays(n,o),e.iframeDiggerRec(o,n,r)}};return e})(),elementSourcesSender=(()=>{function e(){const e=t.sectionName,n=dal.esSession.getOne("sentData")||{};n[e]||(n[e]={});let r=n[e];return r.domains||(r.domains=[]),r.hashes||(r.hashes=[]),r.fullURLs||(r.fullURLs=[]),r}const t=new class{constructor(){this.intervals=[],this.intervalsLen=0,this.intervalsIndex=0,this.storageManager=storageManagers.getStorageManager(),this.elementSourcesFeature=0,this.sectionName="",this.maxResearchRequestsPerAction=5,this.diColorPriorityLength=[2,1,1]}init(e,n,r,i,o){t.intervals=e||[],t.intervalsLen=t.intervals.length,t.elementSourcesFeature=n,t.sectionName=r,t.maxResearchRequestsPerAction=i,t.diColorPriorityLength=o,e&&t.intervalsLen&&(notifier.retroBind("list-loaded",t.start),notifier.retroBind("core-session-expired",(()=>{logger.warn("Clear esSource storage - Core Session expired!","ElementSources"),dal.esSession.clear()})))}start(){const e=coreUtils.removeSubdomain(window.location.host)+"_"+conf.nmgTag+"_ES";dal.esSession.onchange((function(){let n=dal.esSession.get(!1),r=JSON.stringify(n);2097152>r.length||(logger.warn("Clear esSource storage - 2 MB limit exceeded!","ElementSources"),n.sentData={},r=JSON.stringify(n)),t.storageManager.setItem(e,encryption.encrypt(r))})),dal.esData.set({domains:[],fullURLs:[]});let n=t.storageManager.getItem(e),r={};n&&(n=encryption.decrypt(n),r=coreUtils.jsonParse(n)||{}),(coreUtils.isUndefined(r.isOn)||0===t.elementSourcesFeature||1===t.elementSourcesFeature)&&(r.isOn=t.elementSourcesFeature>Math.random()),r.isOn||(r={isOn:!1,sentData:{}}),dal.esSession.set(r),r.isOn&&(notifier.fire("es-session-ready"),t.startIntervals())}startIntervals(){setTimeout(t.sendElementSources,t.intervals[t.intervalsIndex%t.intervalsLen])}sendElementSources(){notifier.fireSync("es-interval");let e=dal.esData.get();e.telm=Math.max(e.telm||0,t.elementSourcesFeature);let r=n.getHostsToSend(e.esDataToSend),i=n.getFullURLsToSend(e.esDataToSend);if(r.length>0&&(e.domains=r),i.length>0&&(e.fullURLs=i),e.esDataToSend={},dal.esData.set(e),r.length||i.length){chpReports.sendResearch("element_sources",chpUtils.clean({domains:r.join("|"),fullURLs:i.join("|"),telm:e.telm}));const n=dal.esSession.getOne("sentData")||{};n[t.sectionName]||(n[t.sectionName]={});const o=n[t.sectionName];o.domains||(o.domains=[]),o.fullURLs||(o.fullURLs=[]);const s=function(e,t){o[e]=o[e].concat(t.map((function(e){return decodeURIComponent(e.split(",")[2])}))),o[e]=o[e].filter((function(t,n){return o[e].indexOf(t)===n}))};r&&s("domains",r),i&&s("fullURLs",i),dal.esSession.set({sentData:n})}t.intervalsIndex++,t.intervalsIndex<t.maxResearchRequestsPerAction&&setTimeout(t.sendElementSources,t.intervals[t.intervalsIndex%t.intervalsLen])}},n={getHostsToSend:function(t){if(!t)return[];let n=e(),r=[],i=Object.keys(t).filter((function(e){return-1===n.domains.indexOf(t[e].host)}));if(i.length){let e,n;i=chpUtils.shuffle(i);let o=0,s=i.length;for(;s>o;o++)e=t[i[o]],n=[e.color,e.tag,encodeURIComponent(e.host),e.counter].join(","),r.push(n)}return r},getHashesToSend:function(t){if(!t)return[];let n=e(),r=[],i=Object.keys(t).reduce((function(e,r){return Object.keys(t[r].hashes).forEach((function(i){-1===n.hashes.indexOf(i)&&e.push({obj:t[r],hash:i})})),e}),[]);if(i.length){let e,t,n,o={},s=0,a=i.length;for(;a>s;s++)e=i[s].obj,t=i[s].hash,o[t]||(n=[e.color,e.tag,t,Object.keys(e.hashes[t].urls).length].join(","),r.push(n),o[t]=!0)}return r},getFullURLsToSend:function(n){if(!n)return[];let r=e(),i=[];const o=Object.keys(n).reduce((function(e,t){return Object.keys(n[t].hashes).forEach((function(i){Object.keys(n[t].hashes[i].urls).forEach((function(o){-1===r.fullURLs.indexOf(o)&&(e[n[t].color]||(e[n[t].color]=[]),e[n[t].color].push({obj:n[t],hash:i,url:o}))}))})),e}),{}),s=["g","b","w"],a=t.diColorPriorityLength;let c,l,d,u=0,f=s.length;for(;f>u;u++){if(c=s[u],!o[c])continue;o[c]=chpUtils.shuffle(o[c]);let e=0,t=Math.min(a[u],o[c].length);for(;t>e;e++)l=o[c][e],l.url&&l.url.length>1e3&&(l.url=l.url.slice(0,1e3)),d=[l.obj.color,l.obj.tag,encodeURIComponent(l.url),1].join(","),i.push(d)}return i}};return t})(),domManipulation=(()=>{const e=new class{constructor(){this.f={},this.tagsToCheck=[],this.overridesInitialized=!1,this.nativeDescriptors={},this.nativeObjects={},this.chpEnabled=!0}init(t,n,r,i=!0){e.chpEnabled=i,e.f=t.f,e.f.override_dom_funcs&&(e.tagsToCheck=r.overrideTags,notifier.bind("iframe-override",e.doOverrides),notifier.bind("do-overrides",(function(){e.overridesInitialized||n.isLimitedUserAgent||n.isLimitedDevice||"o"!==dal.session.getOne("testGroup")||(e.overridesInitialized=!0,e.storeNativeDescriptors(),e.doOverrides(window))})))}storeNativeDescriptors(){const t=[(window.Node||{}).prototype,(window.Element||{}).prototype,(window.HTMLElement||{}).prototype],n=[(window.Node||{}).prototype,(window.Document||{}).prototype,(window.HTMLDocument||{}).prototype],r=["write","writeln"];DOM_FUNCTIONS_TO_OVERRIDE.forEach((i=>{const o=chpUtils.getNativeDescriptorWithObject(r.includes(i)?n:t,i);o&&(e.nativeDescriptors[i]=o.descriptor,e.nativeObjects[i]=o.obj)}))}doOverrides(t){t=t||window,e.overrideAppendChild(t),e.overrideInsertBefore(t),e.overrideInsertAdjacentElement(t),e.overrideInnerHTML(t),e.overrideDocumentWrite(t),e.overrideDocumentWriteln(t),e.overrideInsertAdjacentHTML(t),e.overrideReplaceChild(t),e.chpEnabled&&(e.f.override_add_event_listener&&e.overrideAddEventListener(t),chpUtils.xmlHttpRequestOverriding(t))}doIframeOverrides(e){e.contentWindow&&notifier.fire("iframe-override",e.contentWindow)}checkElement(t){if(t&&(e.tagsToCheck.indexOf(t.tagName)>-1&&notifier.fireSync("rbe-cycle","f",t),t.children&&t.children.length)){const n=t.children.length;let r=e.tagsToCheck.map((e=>Array.from(t.querySelectorAll(e)))).reduce(((e,t)=>e.concat(t)));r.forEach((function(e){notifier.fireSync("rbe-cycle","f",e)})),r.forEach((function(e){if(e.__toRemove__)return chpUtils.markAndRemove(t,!1),!1})),n!==t.children.length&&chpUtils.markAndRemove(t,!1)}}getNativeElementFlowFunction(t){return function(n,r,i){if(e.checkElement(n),n.__toRemove__){try{delete n.__toRemove__}catch(e){}return r}{const r=t.apply(this,i);return"IFRAME"===n.tagName&&e.f.iframe_overrides&&coreUtils.hasContentWindowDocumentAndNoSrc(n)&&e.doIframeOverrides(r),r}}}getNativeHTMLFlowFunction(t){return function(n,r,i){const o=window.document.createElement("a");if(!o)return;const s=e.nativeDescriptors.insertAdjacentHTML;if(!s)return;let a;s.value.call(o,"beforeend",n);for(let t=0,n=o.children.length;n>t;t+=1)if(a=o.children[t],e.checkElement(a),a.__toRemove__)return r;return t.apply(this,i)}}getInitiator(e){let t=null;const n=e.split(/\n/);for(;n.length;){const e=n.pop().match(/(\w+:\/\/.+?)[:\s]/),r=coreUtils.parseUrl(e[1]);if(e&&chpUtils.hostChecker.isOurHost(e[1])){if(coreUtils.removeWWWprefix(coreUtils.removeSubdomain(r.host))!==coreUtils.removeWWWprefix(coreUtils.removeSubdomain(location.hostname)))return e[1];t=e[1]}}return t||null}getNativeListenerFlowFunction(t){return function(n){const r=coreUtils.getStackTrace(),i=e.getInitiator(r),o=(notifier.fireSync("isBNW",i)||[])[0];if(!i||!o)return t.apply(this,n);chpReports.addReport("e_"+coreUtils.parseUrl(i))}}overrideAppendChild(t){const n="appendChild",r=e.nativeDescriptors[n];if(!r)return;const i=e.nativeObjects[n];chpUtils.overrideProperty(i,n,r,{configurable:!1,writable:!1,enumerable:!1,value:function(t){return e.getNativeElementFlowFunction(r.value).call(this,t,t,arguments)}})}overrideInsertBefore(t){const n="insertBefore",r=e.nativeDescriptors[n];if(!r)return;const i=e.nativeObjects[n];chpUtils.overrideProperty(i,n,r,{configurable:!1,writable:!1,enumerable:!1,value:function(t){return e.getNativeElementFlowFunction(r.value).call(this,t,t,arguments)}})}overrideInsertAdjacentElement(t){const n="insertAdjacentElement",r=e.nativeDescriptors[n];if(!r)return;const i=e.nativeObjects[n];chpUtils.overrideProperty(i,n,r,{configurable:!1,writable:!1,enumerable:!1,value:function(t,n){return e.getNativeElementFlowFunction(r.value).call(this,n,n,arguments)}})}overrideInsertAdjacentHTML(t){const n="insertAdjacentHTML",r=e.nativeDescriptors[n];if(!r)return;const i=e.nativeObjects[n];chpUtils.overrideProperty(i,n,r,{configurable:!1,writable:!1,enumerable:!1,value:function(t,n){return e.getNativeHTMLFlowFunction(r.value).call(this,n,void 0,arguments)}})}overrideInnerHTML(t){const n="innerHTML",r=e.nativeDescriptors[n];if(!r)return;const i=e.nativeObjects[n];chpUtils.overrideProperty(i,n,r,{configurable:!1,enumerable:!0,get:function(){return r.get.apply(this,arguments)},set:function(t){return e.getNativeHTMLFlowFunction(r.set).call(this,t,t,arguments)}})}overrideDocumentWrite(t){const n="write",r=e.nativeDescriptors[n];if(!r)return;const i=e.nativeObjects[n];chpUtils.overrideProperty(i,n,r,{configurable:!1,writable:!1,enumerable:!1,value:function(t){return e.getNativeHTMLFlowFunction(r.value).call(this,t,void 0,arguments)}})}overrideDocumentWriteln(t){const n="writeln",r=e.nativeDescriptors[n];if(!r)return;const i=e.nativeObjects[n];chpUtils.overrideProperty(i,n,r,{configurable:!1,writable:!1,enumerable:!1,value:function(t){return e.getNativeHTMLFlowFunction(r.value).call(this,t,void 0,arguments)}})}overrideReplaceChild(t){const n="replaceChild",r=e.nativeDescriptors[n];if(!r)return;const i=e.nativeObjects[n];chpUtils.overrideProperty(i,n,r,{configurable:!1,writable:!1,enumerable:!1,value:function(t,n){return e.getNativeElementFlowFunction(r.value).call(this,t,n,arguments)}})}overrideAddEventListener(t){const n="addEventListener",r=chpUtils.getNativeDescriptorWithObject([(t.EventTarget||{}).prototype],n);r&&(e.nativeDescriptors[n]=r.descriptor,e.nativeObjects[n]=r.obj,chpUtils.overrideProperty(r.obj,n,r.descriptor,{configurable:!1,writable:!1,enumerable:!1,value:function(){return e.getNativeListenerFlowFunction(r.descriptor.value).call(this,arguments)}}))}};return e})(),signals=(()=>{const e=(()=>{let e={};return notifier.bind("data-about-to-send",(function(){Object.keys(e).length>0&&(chptl.add("signals",e),dal.signals.set(e),Object.keys(dal.signals.get(!1)).length>0&&notifier.fire("signals-ready"),notifier.fire("ready-for-segment-calculation",JSON.parse(JSON.stringify(e))),e={})})),{addDomain:function(t,n){e.domain||(e.domain={}),e.domain[t]||(e.domain[t]={}),e.domain[t]={...e.domain[t],...n}},addTag:function(t,n){e.tag||(e.tag={}),e.tag[t]||(e.tag[t]={}),e.tag[t]={...e.tag[t],...n}},addCross:function(t,n){e.cross||(e.cross={}),e.cross[t]||(e.cross[t]={}),e.cross[t]={...e.cross[t],...n}}}})(),t=new class{constructor(){this.signalName="NMG_SIGNALS",this.signalsOnFlag="SIGNALS_ON",this.signalsSampleRate="ssr",this.currentDomain="",this.currentTag="",this.signalsData={},this.signalsConfigurationObj=null,this.signalsCategoriesMappingObj=null,this.signalsFeature=0,this.queueSize=20,this.needRemoveSubdomain=!1}init(e,n,r,i,o){t.signalsConfigurationObj=e,t.signalsCategoriesMappingObj=n,t.signalsFeature=r,t.needRemoveSubdomain=i,t.currentTag=o,t.currentDomain=coreUtils.parseUrl(window.location.href).host,notifier.retroBind("chp-session-ready",t.beforeStart)}beforeStart(){const e=t.signalsFeature>Math.random()?1:0;let n=!1;const r=chpUtils.safeStorageManager.getItem(t.signalsSampleRate,"Signals module Init");r&&+r===t.signalsFeature||(chpUtils.safeStorageManager.setItem(t.signalsSampleRate,t.signalsFeature+"","Signals module Init"),n=!0);let i=chpUtils.safeStorageManager.getItem(t.signalsOnFlag,"Signals module Init");i&&!n||(chpUtils.safeStorageManager.setItem(t.signalsOnFlag,e+"","Signals module Init"),i=+e),+i?t.start():chpUtils.safeStorageManager.removeItem(t.signalName,"Signals module Init")}start(){const e=chpUtils.safeStorageManager.getItem(t.signalName,"Signals module Start");e&&(t.signalsData=JSON.parse(encryption.decrypt(e))),t.process(),notifier.retroBind("add-environment-data",t.addEnvironmentDataToSignals),notifier.retroBind("add-detection",t.addDetectionToSignals),notifier.retroBind("report-extension",t.addDetectionToSignals),notifier.retroBind("is-incognito",t.isIncognito),notifier.retroBind(DpsDetectionsEvents.AdBlockerDetection,t.isAdBlocker),notifier.retroBind(DpsDetectionsEvents.AdStyleBlockerDetection,t.isAdStyleBlocker),notifier.retroBind("user-interaction",t.hasInteraction),notifier.retroBind("iframe-click-data",t.hasIframeClick),notifier.retroBind("extensions-detected",t.extensionsDetected),notifier.retroBind("isInfected",t.isInfected),notifier.retroBind("conversion-detected",t.conversionDetected)}process(){let n,r;if(t.domainTagInitiator(),1===dal.session.getOne("pv")){const i=t.signalsConfigurationObj.sessionsCounter;if(i&&i.sessionsCount){const e=i.sessionsCount.category;e&&(t.updateSignalsData("sessionsCount",e,"add",0),t.updateSignalsSender("sessionsCount",e,"add",0))}const o=dataCollector.getCommonReportFields().cb||coreUtils.getDateNow(),s=t.signalsConfigurationObj.firstSeen;if(s&&s.firstSeen){const e=s.firstSeen.category;e&&(t.updateSignalsData("firstSeen",e,"min",o),t.updateSignalsSender("firstSeen",e,"min",o))}const a=t.signalsConfigurationObj.lastSeen;if(a&&a.lastSeen){const e=a.lastSeen.category;e&&(t.updateSignalsData("lastSeen",e,"max",o),t.updateSignalsSender("lastSeen",e,"max",o))}if(navigator.connection){const e=t.signalsConfigurationObj.networkInfoApiDetection;if(e)for(r in e)if(e.hasOwnProperty(r)&&(n=navigator.connection[e[r].value],!coreUtils.isUndefined(n))){const i=e[r].category;i&&(t.updateSignalsData(r,i,"setdefault",n),t.addDomainData(r,i))}}const c=t.signalsConfigurationObj.screenAttributesDetection;let l;if(c)for(r in l=function(){function e(e){return"(min-resolution: "+e+"dppx), (-webkit-min-device-pixel-ratio: "+e+"),(-moz-min-device-pixel-ratio: "+e+"),(min-device-pixel-ratio: "+e+")"}!function(){const e=document.createElement("div");e.id="dpi",e.setAttribute("style","height: 1in; width: 1in; left: 100%; position: fixed; top: 100%;"),document.body.appendChild(e)}();const t={},n=window.devicePixelRatio||(window.matchMedia&&window.matchMedia("(min-resolution: 2dppx), (-webkit-min-device-pixel-ratio: 1.5),(-moz-min-device-pixel-ratio: 1.5),(min-device-pixel-ratio: 1.5)").matches?2:1)||1;let r=0,i=function t(n,i){if(1e3>r)return r++,n===i?n:window.matchMedia&&window.matchMedia(e(n)).matches?5>n?t(n+i,n):5:window.matchMedia&&window.matchMedia(e(i)).matches?t((i+n)/2,i):1===i?1:void 0}(3,1);if(coreUtils.isUndefined(i))return t;i=parseFloat(i.toFixed(3));const o=i-n==0?2>i?1:n:i/n,s=window.screen.width,a=window.screen.height,c=s*n,l=a*n,d=s/document.getElementById("dpi").offsetWidth,u=Math.round(Math.sqrt(s*s+a*a)/(96*Math.sqrt(o))*10)/10,f=function(e,t,n,r){e>0||(e=1),t>0||(t=1),r||(r="d");const i=("d"===r?Math.sqrt(e*e+t*t):"w"===r?e:t)/n;return i>0?Math.round(i):0}(c,l,d,"w");return t.pxWidth=Math.round(s*o),t.pxHeight=Math.round(a*o),t.ppi=""+Math.round(f*Math.sqrt(o)),t.inch=u,t.retina=o,t.zoom=n/o,t}(),c)if(c.hasOwnProperty(r)&&(n=l[r],!coreUtils.isUndefined(n))){const e=c[r].category;e&&(t.updateSignalsData(r,e,"setdefault",n),t.addDomainData(r,e))}const d=t.signalsConfigurationObj.screenAttributesDetectionBuckets;if(d)for(r in d){if(!d.hasOwnProperty(r))continue;const e=d[r].category;if(e){n=0;const i=d[r].value[coreUtils.getDevice()]||[];if(0===i.length)continue;const o=r.indexOf("-"),s=r.substring(0,o);for(let e=0;e<i.length;e++)if(l[s]<i[e]){n=e;break}t.updateSignalsData(r,e,"set",n),t.addDomainData(r,e)}}const u=t.signalsConfigurationObj.isInfected;if(u&&u.isInfectedList){const n=u.isInfectedList.category;n&&(t.updateSignalsData("isInfectedList",n,"setdefault",[]),t.signalsData[t.currentTag][t.currentDomain][n].isInfectedList.unshift(0),t.signalsData[t.currentTag][t.currentDomain][n].isInfectedList.slice(0,t.queueSize),e.addCross("infectedSessions",{isInfectedList:t.signalsData[t.currentTag][t.currentDomain][n].isInfectedList}))}const f=t.signalsConfigurationObj.extensionDetectionSessionsList;if(f)for(let n in f){if(!f.hasOwnProperty(n))continue;const r=f[n].category;r&&(t.updateSignalsData(n,r,"setdefault",[]),t.signalsData[t.currentTag][t.currentDomain][r][n].unshift(0),t.signalsData[t.currentTag][t.currentDomain][r][n].slice(0,t.queueSize),e.addCross(r,{[n]:t.signalsData[t.currentTag][t.currentDomain][r][n]}))}}let i=window.location.href;const o=t.signalsConfigurationObj.referrerDetection;if(o&&document.referrer){const e=coreUtils.removeWWWprefix(coreUtils.removeSubdomain(coreUtils.parseUrl(document.referrer).host));for(let n in o)if(o.hasOwnProperty(n)&&("All"===n||i&&-1!==i.indexOf(n)))for(let r in o[n])if(o[n].hasOwnProperty(r)&&r&&RegExp(o[n][r],"ig").test(e)){t.updateSignalsData(e,r,"add",0),t.updateSignalsData("all",r,"add",0),t.updateSignalsSender(e,r,"add",0),t.updateSignalsSender("all",r,"add",0);break}}i=window.location.href;const s=t.signalsConfigurationObj.urlParamsDetection;if(s)for(r in s){if(!s.hasOwnProperty(r))continue;const e=s[r],n=e.category,o="All"===e.domain||chpUtils.checkIsDomain(e.domain);if(n&&o&&i.toLowerCase().indexOf(e.value.toLowerCase())>-1){t.updateSignalsData(r,n,"add",0),t.updateSignalsSender(r,n,"add",0);break}}t.updateLocalStorageObject()}domainTagInitiator(){t.currentTag&&(t.signalsData[t.currentTag]||(t.signalsData[t.currentTag]={}),t.currentDomain&&(t.signalsData[t.currentTag][t.currentDomain]||(t.signalsData[t.currentTag][t.currentDomain]={})))}updateLocalStorageObject(){chpUtils.safeStorageManager.setItem(t.signalName,encryption.encrypt(JSON.stringify(t.signalsData)),"Signals - updateLocalStorageObject")}addDomainData(n,r){let i={};i[n]=t.signalsData[t.currentTag][t.currentDomain][r][n],e.addDomain(r,i)}addTagData(n,r,i,o){let s={};switch(i){case"max":s[n]=Object.keys(t.signalsData[t.currentTag]).reduce((function(e,i){return t.signalsData[t.currentTag][i][r]&&t.signalsData[t.currentTag][i][r][n]?Math.max(e,t.signalsData[t.currentTag][i][r][n]):e}),o);break;case"min":s[n]=Object.keys(t.signalsData[t.currentTag]).reduce((function(e,i){return t.signalsData[t.currentTag][i][r]&&t.signalsData[t.currentTag][i][r][n]?Math.min(e,t.signalsData[t.currentTag][i][r][n]):e}),o);break;case"add":s[n]=Object.keys(t.signalsData[t.currentTag]).reduce((function(e,i){return t.signalsData[t.currentTag][i][r]&&t.signalsData[t.currentTag][i][r][n]&&(e+=t.signalsData[t.currentTag][i][r][n]),e}),o)}e.addTag(r,s)}addCrossData(n,r,i,o){let s={};switch(i){case"max":s[n]=Object.keys(t.signalsData).reduce((function(e,i){return e+Object.keys(t.signalsData[i]).reduce((function(e,o){return t.signalsData[i][o][r]&&t.signalsData[i][o][r][n]?Math.max(e,t.signalsData[i][o][r][n]):e}),0)}),o);break;case"min":s[n]=Object.keys(t.signalsData).reduce((function(e,i){return e+Object.keys(t.signalsData[i]).reduce((function(e,o){return t.signalsData[i][o][r]&&t.signalsData[i][o][r][n]?Math.min(e,t.signalsData[i][o][r][n]):e}),0)}),o);break;case"add":s[n]=Object.keys(t.signalsData).reduce((function(e,i){return e+Object.keys(t.signalsData[i]).reduce((function(e,o){return t.signalsData[i][o][r]&&t.signalsData[i][o][r][n]&&(e+=t.signalsData[i][o][r][n]),e}),0)}),o)}e.addCross(r,s)}updateSignalsData(e,n,r,i){switch(t.signalsData[t.currentTag][t.currentDomain][n]||(t.signalsData[t.currentTag][t.currentDomain][n]={}),t.signalsData[t.currentTag][t.currentDomain][n][e]||(t.signalsData[t.currentTag][t.currentDomain][n][e]=i),r){case"min":t.signalsData[t.currentTag][t.currentDomain][n][e]=Math.min(i,t.signalsData[t.currentTag][t.currentDomain][n][e]);break;case"max":t.signalsData[t.currentTag][t.currentDomain][n][e]=Math.max(i,t.signalsData[t.currentTag][t.currentDomain][n][e]);break;case"add":t.signalsData[t.currentTag][t.currentDomain][n][e]+=1;break;case"setdefault":default:break;case"set":t.signalsData[t.currentTag][t.currentDomain][n][e]=i}}updateSignalsSender(e,n,r,i){t.addDomainData(e,n),t.addTagData(e,n,r,i),t.addCrossData(e,n,r,i)}addEnvironmentDataToSignals(e){if(1===dal.session.getOne("pv")){t.domainTagInitiator();const n=t.signalsConfigurationObj.environmentDetection;if(!n||!n[e.type])return;const r=n[e.type].category;if(!r)return;let i=0;const o=n[e.type].value[coreUtils.getDevice()]||[];for(let t=0;t<o.length;t++)if(e.value<o[t]){"cpum"===e.type?i=t:"sft"===e.type&&(i=t?o.length-t:0);break}t.updateSignalsData(e.type,r,"set",i),t.updateSignalsData(e.type+"Raw",r,"set",e.value),t.updateSignalsData("isHigh"+e.type,r,"set",4>i?0:1),t.addDomainData(e.type,r),t.addDomainData(e.type+"Raw",r),t.addDomainData("isHigh"+e.type,r),t.updateLocalStorageObject()}}addDetectionToSignals(n){let r;t.domainTagInitiator();const i=dal.session.getOne("pi_sessionid"),o=t.signalsConfigurationObj.extensionDetectionByID;if(o)for(r in o)if(o.hasOwnProperty(r)&&o[r]){const e=RegExp(o[r].value),s=chpUtils.getReportName(n.el,n.rule);if(s&&e.test(s)){const e=o[r].category;if(!e)return;if(t.updateSignalsData(r,e,"setdefault",0),t.signalsData[t.currentTag][t.currentDomain][e][r+"x"]===i)return;return t.signalsData[t.currentTag][t.currentDomain][e][r+"x"]=i,t.signalsData[t.currentTag][t.currentDomain][e][r]+=1,t.updateSignalsSender(r,e,"add",0),void t.updateLocalStorageObject()}}const s=t.signalsConfigurationObj.extensionDetection;if(s)for(r in s)if(s.hasOwnProperty(r)&&s[r]){const o=s[r].value;for(let a=0;a<o.length;a++){const c=s[r].category;if(!c)return;if(o[a]===n.rule.i){if(t.updateSignalsData(r,c,"setdefault",0),t.signalsData[t.currentTag][t.currentDomain][c][r+"x"]===i)return;return t.signalsData[t.currentTag][t.currentDomain][c][r+"x"]=i,t.signalsData[t.currentTag][t.currentDomain][c][r]+=1,c&&t.signalsData[t.currentTag][t.currentDomain][c][r+"SessionsList"]&&(t.signalsData[t.currentTag][t.currentDomain][c][r+"SessionsList"][0]=1,e.addCross(c,{[r+"SessionsList"]:t.signalsData[t.currentTag][t.currentDomain][c][r+"SessionsList"]})),t.updateSignalsSender(r,c,"add",0),void t.updateLocalStorageObject()}}}}isIncognito(){t.domainTagInitiator();const e=t.signalsConfigurationObj.incognitoDetection;if(!e||!e.isIncognito)return;const n=e.isIncognito.category;n&&(t.updateSignalsData("incognitoCount",n,"add",0),t.updateSignalsSender("incognitoCount",n,"add",0),t.updateLocalStorageObject())}isAdBlocker(e){if(e)return t._isAdBlocker({type:"adBlocker"})}isAdStyleBlocker(e){if(e)return t._isAdBlocker({type:"adStyleBlocker"})}_isAdBlocker(e){t.domainTagInitiator();const n=t.signalsConfigurationObj.adBlockerDetection;if(!n||!n[e.type])return;const r=n[e.type].category;r&&(t.updateSignalsData(e.type,r,"add",0),t.updateSignalsSender(e.type,r,"add",0),t.updateLocalStorageObject())}hasInteraction(e){t.domainTagInitiator();const n=t.signalsConfigurationObj.userInteractionDetection;if(n){for(const r in e){if(!e.hasOwnProperty(r))continue;if(!n[r])return;const i=n[r].category;if(!i)return;t.updateSignalsData(r,i,"setdefault",0);const o=e[r];for(const e in o)o.hasOwnProperty(e)&&(t.signalsData[t.currentTag][t.currentDomain][i][r]+=o[e]);t.updateSignalsSender(r,i,"add",0)}t.updateLocalStorageObject()}}hasIframeClick(e){t.domainTagInitiator();const n=window.location.href,r=e.url,i=t.signalsConfigurationObj.iframeClickDetection;if(i)for(const e in i)if(i.hasOwnProperty(e)&&("All"===e||n&&-1!==n.indexOf(e)))for(const n in i[e]){if(!i[e].hasOwnProperty(n))continue;const o=n;if(!o)continue;let s=RegExp(i[e][n],"ig").exec(r);if(s){s=s[0],t.updateSignalsData(s,o,"add",0),t.updateSignalsData("all",o,"add",0),t.updateSignalsSender(s,o,"add",0),t.updateSignalsSender("all",o,"add",0),t.updateLocalStorageObject();break}}}extensionsDetected(e){if(!e.installed)return;let n=e.installed.split("*");n=n.filter((function(e,t){return n.indexOf(e)===t})),t.domainTagInitiator();const r=t.signalsConfigurationObj.extensionDetectionByAsset;if(r){for(const e in r)if(r.hasOwnProperty(e)&&r[e]){const i=r[e].value;for(let o=0;o<i.length;o++){const s=r[e].category;if(!s)return;if(n.includes(i[o])){const n=dal.session.getOne("pi_sessionid");if(t.updateSignalsData(e,s,"setdefault",0),t.signalsData[t.currentTag][t.currentDomain][s][e+"x"]===n)return;t.signalsData[t.currentTag][t.currentDomain][s][e+"x"]=n,t.signalsData[t.currentTag][t.currentDomain][s][e]+=1,t.updateSignalsSender(e,s,"add",0);break}}}t.updateLocalStorageObject()}}isInfected(){let n;if(-1!==dal.session.getOne("sfi"))return;t.domainTagInitiator();let r=t.signalsConfigurationObj.isInfected;r&&r.isInfected&&(n=r.isInfected.category,n&&(t.updateSignalsData("isInfected",n,"add",0),t.updateSignalsSender("isInfected",n,"add",0))),r=t.signalsConfigurationObj.isInfected,r&&r.isInfectedList&&(n=r.isInfectedList.category,n&&t.signalsData[t.currentTag][t.currentDomain][n].isInfectedList&&(t.signalsData[t.currentTag][t.currentDomain][n].isInfectedList[0]=1,e.addCross("infectedSessions",{isInfectedList:t.signalsData[t.currentTag][t.currentDomain][n].isInfectedList}))),t.updateLocalStorageObject()}conversionDetected(){t.domainTagInitiator();const e=t.signalsConfigurationObj.conversionsDetection;if(e&&e.cnv){const n=e.cnv.category;n&&(t.updateSignalsData("cnv",n,"add",0),t.updateSignalsSender("cnv",n,"add",0))}t.updateLocalStorageObject()}};return t})(),detectConversionByHref=(()=>{const e=new class{constructor(){this.thankyouPageRegex={}}init(t){t&&Object.keys(t)&&(e.thankyouPageRegex=t,notifier.retroBind("chp-session-ready",e.check))}check(){const t=coreUtils.removeWWWprefix(coreUtils.removeSubdomain(window.location.host)),n=e.thankyouPageRegex[t]||e.thankyouPageRegex.all||null;if(!n)return;const r=window.location.href.toLowerCase();n.forEach((function(e){-1!==r.indexOf(e)&&(notifier.fire("conversion-detected"),dal.cnvByHref.set(!0))}))}};return e})(),{detectIncognitoMode:detectIncognitoMode}=(()=>{let e=1,t=[];const n=n=>{t.push(n?1:0),t.length<e||notifier.fire("detectedIncognitoMode",Math.max(0,...t))},r=()=>{new Promise((e=>{const t=()=>e(!0),n=()=>e(!1);if(window.webkitRequestFileSystem)window.webkitRequestFileSystem(window.TEMPORARY,1,n,t);else{const e="test"+coreUtils.generateRandomString(5);try{localStorage.setItem(e,"1"),localStorage.removeItem(e),n()}catch(e){t()}}})).then((e=>{n(e)}))},i=()=>{void 0!==navigator.maxTouchPoints?void 0!==window.safari&&void 0===window.DeviceMotionEvent?(()=>{let e=!1;try{window.safari.pushNotification.requestPermission("https://mjca-yijws.global.ssl.fastly.net","private",{},(function(){}))}catch(t){/gesture/.test(t)||(e=!0,n(!0))}e||n(!1)})():(()=>{let e=!1;const t=document.createElement("iframe");t.style.display="none",document.body.appendChild(t),t.contentWindow.applicationCache.addEventListener("error",(function(){e=!0,n(!0)})),setTimeout((function(){e||n(!1),document.body.removeChild(t)}),100)})():(()=>{try{window.openDatabase(null,null,null,null)}catch(e){return void n(!0)}try{const e="test"+coreUtils.generateRandomString(5);window.localStorage.setItem(e,"1"),window.localStorage.removeItem(e)}catch(e){return void n(!0)}n(!1)})()},o=()=>{const e=Math.random()+"";try{window.indexedDB.open(e,1).onupgradeneeded=function(t){const r=t.target.result;try{r.createObjectStore("test",{autoIncrement:!0}).put(new Blob),n(!1)}catch(e){let t=e;if(e instanceof Error&&(t=e.message||e),"string"!=typeof t)return void n(!1);const r=t.includes("BlobURLs are not yet supported");n(r)}finally{r.close(),window.indexedDB.deleteDatabase(e)}}}catch(e){n(!1)}},s=()=>{Promise&&void 0!==Promise.allSettled?navigator.webkitTemporaryStorage.queryUsageAndQuota((function(e,t){const r=Math.round(t/1048576),i=2*Math.round((window.performance&&window.performance.memory&&void 0!==window.performance.memory.jsHeapSizeLimit?performance.memory.jsHeapSizeLimit:1073741824)/1048576);n(i>r)}),(function(e){aiLoggerManager.error(e.message,"detectIncognito somehow failed to query storage quota: "),n(!1)})):window.webkitRequestFileSystem(0,1,(function(){n(!1)}),(function(){n(!0)}))},a=()=>{n(void 0===navigator.serviceWorker)},c=()=>{n(void 0===window.indexedDB)};return{detectIncognitoMode:()=>{t=[];const l=[r,i,o,s,a,c],d=l.length;e=d;try{for(let e=0;d>e;e++)try{l[e]()}catch(e){n(!1)}}catch(e){logger.error("Incognito detection failed: "+e,"detectIncognitoMode")}}}})(),{detectAdBlocker:detectAdBlocker}={detectAdBlocker:()=>{(dal.session.getOne("detectAdBlocker")||dal.session.getOne("detectAdStyleBlocker"))&&!dal.session.getOne("DoneDetectAdblocker")&&(dal.session.set({DoneDetectAdblocker:!0,DoneDetectStyleAdblocker:!0}),notifier.retroBind(DpsDetectionsEvents.AdBlockerDetection,(function(e){e=+e,dal.sendReport.set({adblocker:e,adstyleblocker:e}),e&&dal.needToSend.set(!0)})),1)&&(()=>{let e=0;const t=document.createElement("div");t.id="adbox",t.className="banner_ads ads ad adsbox doubleclick ad-placement carbon-ads pub_300x250 pub_300x250m pub_728x90 text-ad textAd text_ad text_ads text-ads text-ad-links",t.setAttribute("style","position: absolute !important;width: 100px !important;height: 100px !important;z-index: -1 !important;top: -1000px !important;left: -1000px !important;"),t.setAttribute("aria-label","Advertisement"),t.setAttribute("title","3rd party ad content");const n=document.body;n&&n.appendChild&&n.appendChild(t),setTimeout((function(){let n=document.querySelector("#adbox");if(n){const t=window.getComputedStyle(n);0!==n.offsetHeight&&"none"!==t.getPropertyValue("display")&&"hidden"!==t.getPropertyValue("visibility")||(e=1)}else e=1;e||null===document.body.getAttribute("abp")||(e=1),notifier.fire(DpsDetectionsEvents.AdBlockerDetection,e),t.remove()}),1500)})()}},segments=(()=>{const segmentsParser={parseCategoryLevel:function(e,t,n){for(const r in t){if(!t.hasOwnProperty(r))continue;n[e].c||(n[e].c={}),n[e].c[r]||(n[e].c[r]=0);const i=t[r];for(const t in i)i.hasOwnProperty(t)&&(n[e].s||(n[e].s={}),n[e].s[t]||(n[e].s[t]=i[t]),"isInfectedList"===t&&(n[e].s[t]=i[t]),n[e].c[r]+=i[t])}},parseDataObj:function(e,t){for(const n in e)if(e.hasOwnProperty(n))switch(n){case"domain":segmentsParser.parseCategoryLevel("d",e[n],t);break;case"tag":segmentsParser.parseCategoryLevel("t",e[n],t);break;case"cross":segmentsParser.parseCategoryLevel("c",e[n],t)}return t}};class Segments{constructor(){this.segments=[],this.segmentsCHP3=[],this.segmentsHistorySize=10,this.segmentsIsActiveLimit=3,this.segmentsCHP3List={},this.activeCHP3Segments=[],this.semSegments={},this.seg={d:{s:{},c:{}},t:{s:{},c:{}},c:{s:{},c:{}},chp3:{}},this.shK=[]}init(e,t,n){if(api.segments=e,api.segmentsCHP3=t,api.shK=n||[],notifier.retroBind("chp-session-ready",api.prepareSegmentsHistory),t&&t.length)for(let e=0;e<t.length;e++){try{coreUtils.isString(t[e].r)&&(t[e].r=JSON.parse(t[e].r))}catch(n){logger.error(n,"Segments Init"),t[e].r={}}t[e].d="NULL"===t[e].d?null:t[e].d,t[e].a&&api.activeCHP3Segments.push(t[e].id)}notifier.retroBind("ready-for-segment-calculation",api.start),notifier.retroBind("data-about-to-send",api.hasSegmentationDataToSend),notifier.retroBind("report-extension",api.reportExtensions),notifier.retroBind("extensions-detected",api.reportInstalled)}prepareSegmentsHistory(){if(1==+dal.session.getOne("pv")||coreUtils.isUndefined(dal.session.getOne("segmentsCHP3List"))){api.segmentsCHP3List=dal.session.getOne("segmentsCHP3List")||{};const e=Object.keys(api.segmentsCHP3List);for(let t=0;t<e.length;t++){const n=e[t];api.segmentsCHP3List[n].unshift(0),api.segmentsCHP3List[n].slice(0,api.segmentsHistorySize)}dal.session.set({segmentsCHP3List:api.segmentsCHP3List})}}start(e){if(!api.segments)return;coreUtils.isUndefined(dal.session.getOne("seg"))||(api.seg=dal.session.getOne("seg"),api.seg.chp3||(api.seg.chp3={})),api.segmentsCHP3List=dal.session.getOne("segmentsCHP3List")||{};const t=new NmgWorker((({dataObject:e,segObject:t})=>{const n={parseCategoryLevel:function(e,t,n){for(const r in t){if(!t.hasOwnProperty(r))continue;n[e].c||(n[e].c={}),n[e].c[r]||(n[e].c[r]=0);const i=t[r];for(const t in i)i.hasOwnProperty(t)&&(n[e].s||(n[e].s={}),n[e].s[t]||(n[e].s[t]=i[t]),"isInfectedList"===t&&(n[e].s[t]=i[t]),n[e].c[r]+=i[t])}},parseDataObj:function(e,t){for(const r in e)if(e.hasOwnProperty(r))switch(r){case"domain":n.parseCategoryLevel("d",e[r],t);break;case"tag":n.parseCategoryLevel("t",e[r],t);break;case"cross":n.parseCategoryLevel("c",e[r],t)}return t}};NmgWorker.postMessage(n.parseDataObj(e,t))}),(e=>{api.seg=e,api.calculateSegments()}),{fallback:()=>{api.seg=segmentsParser.parseDataObj(e,api.seg),api.calculateSegments()},isWorkerSupported:__INJECTIONS__.useWebWorker&&!!(window.Worker&&window.URL&&window.URL.createObjectURL)});t.run({dataObject:e,segObject:api.seg})}calculateSegments(){let sgm={};for(let i=0;i<api.segments.length;i++){if(!chpUtils.checkIsDomain(api.segments[i].d))continue;let segmentFn=`runSeg = function(seg,dal,_){ return ${api.segments[i].sfn} ; }`;try{let res={};res[api.segments[i].sn]=eval(segmentFn)(api.seg,dal,window)||0,0!==res[api.segments[i].sn]&&(chptl.add("segments",res),sgm={...sgm,...res})}catch(e){}}dal.segments.set(sgm),(Object.keys(dal.segments.get(!1)).length>0||Object.keys(dal.segmentsCHP3.get(!1)).length>0)&&notifier.fire("segments-ready"),dal.session.set({seg:api.seg,segmentsCHP3List:api.segmentsCHP3List})}collectSegmentsCHP3Data(){const e=coreUtils.getDevice();let t=coreUtils.getOS(),n=coreUtils.getOSVersion(),r=coreUtils.getBrowser();t=`${t} ${n}`,dal.segmentsCHP3Data.set({device:"pc"===e?"desktop":e,osName:t,browserName:r})}compareValue(e,t,n){switch(t||(t="is"),t.toLowerCase()){case"is":return e.toLowerCase()===n.toLowerCase();case"is not":return e.toLowerCase()!==n.toLowerCase();default:return!1}}checkForDevice(e,t){let n=dal.segmentsCHP3Data.getOne("device");return n||(api.collectSegmentsCHP3Data(),n=dal.segmentsCHP3Data.getOne("device")),api.compareValue(n,e,t)}checkForInterrupter(e,t){let n=!1;for(let r=0;r<api.semSegments.extensions.length;r++)n=n||api.compareValue(api.semSegments.extensions[r],e,t);return n}checkForInterrupterType(e,t){let n=!1;dal.session.getOne("ii")&&(n=api.compareValue("Unwanted Interruptions",e,t));for(let r=0;r<api.semSegments.types.length;r++)n=n||api.compareValue(api.semSegments.types[r],e,t);return n}checkForOS(e,t){let n=dal.segmentsCHP3Data.getOne("osName");return n||(api.collectSegmentsCHP3Data(),n=dal.segmentsCHP3Data.getOne("osName")),api.compareValue(n,e,t)}checkForBrowserName(e,t){let n=dal.segmentsCHP3Data.getOne("browserName");return n||(api.collectSegmentsCHP3Data(),n=dal.segmentsCHP3Data.getOne("browserName")),api.compareValue(n,e,t)}doSegmentRuleCheck(e){switch(e.condition.toLowerCase()){case"device":return api.checkForDevice(e.operator,e.value);case"operating system":return api.checkForOS(e.operator,e.value);case"interrupter":return api.checkForInterrupter(e.operator,e.value);case"type of interrupter":return api.checkForInterrupterType(e.operator,e.value);case"browser":return api.checkForBrowserName(e.operator,e.value);default:return!1}}storeSegmentId(e,t){t&&chptl.add("segments",{[e]:1}),api.segmentsCHP3List[e]||(api.segmentsCHP3List[e]=[]),api.segmentsCHP3List[e][0]=+t}strToArray(e){if(coreUtils.isString(e)&&e.length)try{return JSON.parse(e)}catch(t){return-1===e.indexOf(",")?e:e.split(",")}return e}hasSegmentationDataToSend(){const e=dal.session.getOne("se_segments");if(e){const t=[];Object.keys(e).map((function(n){t.push(e[n].extensions)}));let n=dal.session.getOne("sent_se_segments");n||(n=[]);const r=chpUtils.flattenArray(t),i={},o=chpUtils.uniqueArray(r),s={};o.forEach((function(e){(1>n.length||api.isNewSegment(n,e.segment))&&(n.push(e.segment),e.segment&&"undefined"!==e.segment&&(e.resourceId&&e.resourceId.indexOf(" ")>0&&(e.resourceId=e.resourceId.substring(0,e.resourceId.indexOf(" ")).trim()),i[e.segment]={resourceId:e.resourceId,segment_value:1,inferred:e.inferred||0},s[e.resourceId]=e.inferred||0))}));const a=dal.session.getOne("sem_segments");if(coreUtils.isArray(n)&&coreUtils.isArray(api.shK)){const e=api.shK.map((function(e){return e.n})),t=chpUtils.uniqueArray(n.map((function(e){return e.replace(" Installed","").replace(" Popped","")})).filter((function(t){return e.includes(t)})));if((!a||coreUtils.isArray(t)&&a.sort().toString()!==t.sort().toString())&&(dal.session.set({sem_segments:t}),coreUtils.isArray(api.shK))){const e=chpUtils.uniqueArray(api.shK.filter((function(e){return t.includes(e.n)})).map((function(e){return(1>n.length||api.isNewSegment(n,e.n))&&(n.push(e.n),i[e.n]={resourceId:e.eid,segment_value:1,inferred:s[e.eid]||0}),(1>n.length||api.isNewSegment(n,e.et))&&(n.push(e.et),i[e.et]={resourceId:e.et,segment_value:1,inferred:s[e.eid]||0}),e.et})));api.processCustomSegments(t,e)}}coreUtils.isEmptyObject(i)||(chptl.add("se_segments",i),dal.session.set({sent_se_segments:n}))}}isNewSegment(e,t){return!e||0===e.length||0===e.filter((function(e){return e.segment?e.segment===t:e===t})).length}processCustomSegments(e,t){api.semSegments.extensions=e,api.semSegments.types=t;let n,r,i={};for(n=0;n<api.segmentsCHP3.length;n++)if(api.segmentsCHP3[n].a)try{let e,t=api.segmentsCHP3[n].r,r=!1;for(let n=0;n<t.length;n++){let i=!0;if(!r){e=t[n];for(let t=0;t<e.length;t++)i=i?i&&api.doSegmentRuleCheck(e[t]):i;r=r||i}}api.storeSegmentId(api.segmentsCHP3[n].id,r),api.seg.chp3[api.segmentsCHP3[n].id]=+r,r&&(i[api.segmentsCHP3[n].id]=1)}catch(e){}dal.segmentsCHP3.set(i);const o=Object.keys(api.segmentsCHP3List),s=Object.keys(i);for(n=0;n<o.length;n++){const e=o[n];-1===s.indexOf(e)&&-1!==api.activeCHP3Segments.indexOf(e)&&(r=Math.max.apply(null,api.segmentsCHP3List[e].slice(0,api.segmentsIsActiveLimit))||0,r&&chptl.add("segments",{[e]:1}))}}getExtensionNameById(e){const t=api.shK.find((t=>t.eid===e));return t?t.n:""}reportExtensions(e){const t=e.rule.i,n=e.inferred||0;if(t){let r=e.rule.eid;r&&r.indexOf(" ")>0&&(r=r.substring(0,r.indexOf(" ")).trim()),api.updateSessionSegmentForRule(t,r,"Popped",n),notifier.fire("sem-popped",api.getExtensionNameById(r)),notifier.fireSync("sendDataReport"),notifier.fireSync("sendToNMGDataLayer")}}reportInstalled(e){const t=e.inferred?1:0,n=e.segmentation;n&&(n.forEach((function(e){api.updateSessionSegmentForSeID(e,"Installed",t)})),notifier.fireSync("sendDataReport"),notifier.fireSync("sendToNMGDataLayer"))}updateSessionSegmentForRule(e,t,n,r){const i=dal.session.getOne("sst"),o=dal.session.getOne("se_segments");let s;if(i&&o){const a=o[i];let c=api.getShoppingExtensionNames(e);if(0===c.length)try{s=api.getShoppingExtensionElementFromId(t)[0],c=[s.n]}catch(e){}if(s&&s.oe&&(t=s.oe),a){let e="";c&&c.length>0&&(e=c[0]);let s=e.length>0||!window.chrome?e:t;s&&s.length||(s="undefined");const l=s+" "+n,d=dal.session.getOne("pv");if(api.isNewSegment(a.extensions,l)){let e=!0;for(let t=0;t<a.extensions.length;t++)if(a.extensions[t].segment===l){a.extensions[t].pv=d,e=!1;break}e&&a.extensions.push({segment:l,resourceId:t,v:d,inferred:r}),o[i]={extensions:a.extensions},dal.session.set({se_segments:o})}}}}getShoppingExtensionNames(e){const t=","+e.substring(1)+",";return api.shK.filter((function(e){if(e.br||e.dr){let n=!1;return e.br&&(n=e.br.indexOf(t)>=0,n)?n:e.dr&&(n=e.dr.indexOf(t)>=0,n)?e.dr.indexOf(t)>=0:n}})).map((e=>e.n))}getShoppingExtensionElementForId(e){return api.shK.filter((function(t){return t.id===e}))}getShoppingExtensionElementFromId(e){return api.shK.filter((function(t){return t.eid===e}))}updateSessionSegmentForSeID(e,t,n){const r=dal.session.getOne("sst"),i=dal.session.getOne("se_segments");if(r&&i){const o=i[r],s=api.getShoppingExtensionElementForId(e);if(o&&s){const a=(s[0].n||!window.chrome?s[0].n:e)+" "+t,c=dal.session.getOne("pv");if(api.isNewSegment(o.extensions,a)){let e=!0;for(let t=0;t<o.extensions.length;t++)if(o.extensions[t].segment===a){o.extensions[t].pv=c,e=!1;break}e&&(s[0]&&s[0].oe&&(s[0].eid=s[0].oe),notifier.fire("extensions-reported",{name:s[0].n,resourceId:s[0].eid}),s[0].eid&&s[0].eid.indexOf(" ")>0&&(s[0].eid=s[0].eid.substring(0,s[0].eid.indexOf(" ")).trim()),o.extensions.push({segment:a,resourceId:s[0].eid,pv:c,inferred:n})),i[r]={extensions:o.extensions},dal.session.set({se_segments:i})}}}}}const api=new Segments;return api})(),addKpiMethod=(()=>{const e=new class{constructor(){}init(){notifier.retroBind("chp-session-ready",e.setPushFunction)}extractNumber(e,t,n){if(null===e)return null;if(parseFloat(e).toString()===e.toString())return parseFloat(e);{const r=RegExp("[+-]?\\d+(?:["+(t=t||",")+"]\\d{3})*(?:["+(n=n||".")+"]\\d+)?","g");return e.match(r)&&e.match(r).length>0?(e=(e=e.match(r)[0]).replace(RegExp("["+t+"]","g"),""),e=parseFloat(e)):null}}addOrderData(t){if(window.journeyDataLayer&&window.journeyDataLayer.journey&&window.journeyDataLayer.journey.cartData){const n=window.journeyDataLayer.journey.cartData,r=e.extractNumber(t.orderTotalBeforeDiscount),i=e.extractNumber(t.orderTotalAfterDiscount);n.orderTotalBeforeDiscount=coreUtils.isNumber(r)?r.toString():null,n.orderTotalAfterDiscount=coreUtils.isNumber(i)?i.toString():null,n.couponCode=t.couponCode,null===r||0>r||null===i||0>i||i>=r||(n.discountAmount=r-i)}}setPushFunction(){if(window.journeyDataLayer&&!Array.isArray(window.journeyDataLayer))return;let t=[];Array.isArray(window.journeyDataLayer)&&(t=window.journeyDataLayer),window.journeyDataLayer={},window.journeyDataLayer.isJDL=!1,window.journeyDataLayer.journey={},window.journeyDataLayer.pushMethods=[],window.journeyDataLayer.journey.cartData={orderTotalBeforeDiscount:null,orderTotalAfterDiscount:null,couponCode:null,discountAmount:null},window.journeyDataLayer.push=function(t){t&&t.action&&t.params&&("addOrderData"===t.action&&t.params.orderData?e.addOrderData(t.params.orderData):window.journeyDataLayer.pushMethods.push(t))};for(let e=0;e<t.length;e+=1)"addOrderData"===t[e].action?window.journeyDataLayer.push(t[e]):window.journeyDataLayer.pushMethods.push(t[e])}};return e})(),iframeClickCounter=(()=>{const e=new class{constructor(){this.iframeNodesList=[],this.iframes=[],this.iframeIndex=-1,this.stamp="",this.conf=null,this.isBlurBoundKey="fqahtqvrksrrfeynth"}init(t){e.stamp=e.stamp||coreUtils.generateRandomString(5),e.conf=t,window.hasOwnProperty(e.isBlurBoundKey)||(window.addEventListener("blur",(function(){if(-1!==e.iframeIndex){const t=e.iframes[e.iframeIndex];coreUtils.parseUrl(t.src).host!==coreUtils.parseUrl(window.location.href).host&&(notifier.fire("iframe-click",{url:t.src,source:"iframe-click",iframeEl:t}),notifier.fire("iframe-click-data",{url:t.src}),chpReports.sendResearch("iframe_clicks",{src:chpUtils.iframeDigger(t),pv:dal.session.getOne("pv"),cycle:e.conf.threatLoopCounter,iframeHeight:t.clientHeight,iframeWidth:t.clientWidth}))}})),window[e.isBlurBoundKey]=1,notifier.bind("cycle-after-rbe",e.updateIframes),notifier.retroBind("dom-ready",(function(){e.iframeNodesList=document.getElementsByTagName("iframe"),e.updateIframes()})))}updateIframes(){if(!dal.session.getOne("iframeClickCounter"))return;let t,n;e.iframeNodesList||(e.iframeNodesList=document.getElementsByTagName("iframe"));for(let r=0,i=e.iframeNodesList.length;i>r;r++)t=e.iframeNodesList[r],t[e.stamp]||(t[e.stamp]=!0,n=e.iframes.length,e.iframes[n]=t,((e,t,n)=>{e.addEventListener("mouseover",(function(){n.iframeIndex=t})),e.addEventListener("mouseout",(function(){n.iframeIndex=-1}))})(t,n,e))}};return e})(),userInteractions=(()=>{const e=new class{constructor(){this.params=null,this.userInteractionRules=[],this.interactionData={},this.interactionsReportingData=[],this.clickableElements={},this.tagsFilter=[],this.iframeIndex=-1,this.iframes=[],this.blurEventBinded=!1,this.iframeClickEventBinded=!1,this.bindEventKeys={windowBeforeunload:"__uintr_gthtlfykjfljv",documentClick:"__uintr_lvtynrksr",elementRuleSpecific:"__uintr_ghfdbkjcgtwyjvth_",elementRule:"__uintr_ghfdbkjyjvth_",windowBlur:"qepthsynthtriypsysn"}}init(t,n,r=!1){e.params=n,e.userInteractionRules=t.uInt,e.clickableElements=JSON.parse((n.userInteractionConfig||"{}").replace(/'/g,'"')),e.tagsFilter=n.interactionReportingTagsFilter||[],e.iframes=[],e.interactionData={},e.iframeIndex=-1,e.blurEventBinded=!1,e.iframeClickEventBinded=!1;const i=function(){notifier.retroBind("data-about-to-send",e.hasInteractionDataToSend),window[e.bindEventKeys.windowBeforeunload]||(window[e.bindEventKeys.windowBeforeunload]=!0,window.addEventListener("beforeunload",(function(){notifier.fireSync("sendDataReport")}))),dal.session.getOne("userInteractionsReporting")?e.userInteractionsReporting():dal.session.getOne("userInteraction")&&e.userInteraction()};notifier.retroBind("chp-session-ready",(function(){(dal.session.getOne("userInteraction")||dal.session.getOne("userInteractionsReporting"))&&(r?i():notifier.retroBind("dom-ready",i))}))}reportEventListener(t,n){e.interactionData[t.n]||(e.interactionData[t.n]={}),e.interactionData[t.n][t.id]||(e.interactionData[t.n][t.id]={}),e.interactionData[t.n][t.id].count||(e.interactionData[t.n][t.id].count=0),e.interactionData[t.n][t.id].ts||(e.interactionData[t.n][t.id].ts=0),e.interactionData[t.n][t.id].count+=1,e.interactionData[t.n][t.id].ts=(new Date).getTime(),n&&(e.interactionData[t.n][t.id].elTag=n.elTag,e.interactionData[t.n][t.id].elText=chpUtils.truncateString(n.elText,128))}getInteractionData(e){let t={};return t.elTag=e.el.nodeName,t.elText=e.elText,t}clearUserInteractionData(){e.interactionData={}}clearUserInteractionsReportingData(){e.interactionsReportingData=[]}getUserInteractionData(){Object.keys(e.interactionData).length>0&&(chptl.add("intr",e.interactionData),notifier.fireSync("user-interaction",e.interactionData),e.reportCheckoutOrCart(),e.clearUserInteractionData())}getUserInteractionsReportingData(){e.interactionsReportingData.length&&(chptl.add("intrReporting",e.interactionsReportingData),e.clearUserInteractionsReportingData())}hasInteractionDataToSend(){e.getUserInteractionData(),e.getUserInteractionsReportingData()}checkIsSection(e){return window.location.href.indexOf(e)>-1}checkoutOrCartClicked(){return!(!e.interactionData.checkout&&!e.interactionData.cart)}reportCheckoutOrCart(){if(e.checkoutOrCartClicked()){let t={};e.interactionData.checkout&&(t.gint1=1),e.interactionData.cart&&(t.gint2=1),notifier.fireSync("sendReport",t)}}cartCheckoutGintReport(e){let t={};"checkout"===e.n&&(t.gint1=1),"cart"===e.n&&(t.gint2=1),notifier.fireSync("sendReport",t)}searchAndBindListener(t,n){if("paypal-iframe"===t)return void notifier.bind("iframe-click",(function(t){-1!==t.url.indexOf("paypal.com")&&e.reportEventListener(n)}));const r=document.querySelectorAll(t);r.length>0?r.forEach((function(t){t[e.bindEventKeys.elementRule+n.id]||(t[e.bindEventKeys.elementRule+n.id]=!0,t.addEventListener(n.ev,(function(){e.reportEventListener(n)}),!0))})):n.rc&&setTimeout((function(){e.searchAndBindListener(t,n)}),e.params.userInteractionListenerBindDelay)}specificElementListener(t,n){if("paypal-iframe"===t)return void notifier.bind("iframe-click",(function(t){-1!==t.url.indexOf("paypal.com")&&e.cartCheckoutGintReport(n)}));const r=document.querySelectorAll(t);r.length>0?r.forEach((function(t){t[e.bindEventKeys.elementRuleSpecific+n.id]||(t[e.bindEventKeys.elementRuleSpecific+n.id]=!0,t.addEventListener(n.ev,(function(){e.cartCheckoutGintReport(n)}),!0))})):n.rc&&setTimeout((function(){e.specificElementListener(t,n)}),e.params.userInteractionListenerBindDelay)}detectIframeClicks(t,n,r){if(dal.session.getOne("iframeClickCounter"))t.intrRule=r,e.iframeClickEventBinded||(notifier.bind("iframe-click",(function(t){if(t.iframeEl.intrRule){let n={elTag:"IFRAME",elText:t.url};e.reportEventListener(t.iframeEl.intrRule,n)}})),e.iframeClickEventBinded=!0);else{e.blurEventBinded||window.hasOwnProperty(e.bindEventKeys.windowBlur)||(window.addEventListener("blur",(function(){if(-1!==e.iframeIndex){const t=e.iframes[e.iframeIndex];if(chpUtils.hostChecker.isOurHost(t.el.src)!==chpUtils.hostChecker.isOurHost(window.location.href)){let n={elTag:"IFRAME",elText:t.src};e.reportEventListener(t.rule,n)}}})),e.blurEventBinded=!0,window[e.bindEventKeys.windowBlur]=1);const n=e.iframes.length;e.iframes[n]={el:t,rule:r},i=n,t.addEventListener("mouseover",(function(){e.iframeIndex=i})),t.addEventListener("mouseout",(function(){e.iframeIndex=-1}))}var i}searchElementsByText(t,n){const r=JSON.parse(t),i=Array.from(document.querySelectorAll(Object.keys(e.clickableElements).join())),o=[];i.forEach((function(t){let n;if("input"===t.nodeName.toLowerCase()){const r=t.nodeName.toLowerCase()+"[type="+t.type+"]";n=e.clickableElements[r]}else n=e.clickableElements[t.nodeName.toLowerCase()];for(let e=0;e<n.length;e+=1){const i=n[e];let s,a=!1,c=[],l=[];if("innerText"===i&&(c=Array.from(t.childNodes).slice(),l=c.filter((function(e){return 3===e.nodeType})),s=l.map((e=>e.data.trim().toLowerCase())).filter((e=>e)).join()),t[i]&&("innerText"!==i||0!==s.length)){for(let e=0;e<r.length;e+=1){const n=r[e];if(-1!==("innerText"===i?s:t[i].trim().toLowerCase()).indexOf(n)){o.push({el:t,elTag:t.nodeName,elText:t[i].trim()}),a=!0;break}}if(a)break}}})),o.forEach((function(r){"IFRAME"===r.elTag&&r.el.clientHeight&&r.el.clientWidth?e.detectIframeClicks(r.el,t,n):r.el.addEventListener(n.ev,(function(){const t=e.getInteractionData(r);e.reportEventListener(n,t)}))}))}logInteraction(t,n){let r={ruleName:n&&n.n||"",elTag:t.nodeName,elText:t.innerText?t.innerText.trim():t.value?t.value.trim():"",intTimestamp:(new Date).getTime(),elTarget:t.target||""};try{r.elUrl=t.href?t.href.trim():t.src?t.src.trim():""}catch(e){r.elUrl=""}e.interactionsReportingData.push(r)}passFilter(t){return 0===e.tagsFilter.length||-1===e.tagsFilter.indexOf(t.nodeName)}userInteraction(){for(let t=0;t<e.userInteractionRules.length;t+=1){let n=e.userInteractionRules[t];if(chpUtils.checkIsDomain(n.d)&&(null===n.s||e.checkIsSection(n.s)))if(n.t)e.searchElementsByText(n.t,n);else{let t=n.el;if(!t||"null"===t.toLowerCase())continue;e.searchAndBindListener(t,n)}}}userInteractionsReporting(){document[e.bindEventKeys.documentClick]||(document[e.bindEventKeys.documentClick]=!0,document.addEventListener("click",(function(t){const n=t.target;e.passFilter(n)&&e.logInteraction(n)})));const t=e.userInteractionRules.filter((e=>["cart","checkout"].includes(e.n)));for(let n=0;n<t.length;n+=1){const r=t[n];if(!chpUtils.checkIsDomain(r.d))continue;if(null!==r.s&&!e.checkIsSection(r.s))continue;let i=r.el;i&&"null"!==i.toLowerCase()&&e.specificElementListener(i,r)}}};return e})(),detectChromeExtension=(()=>{const e=new class{constructor(){this.params={},this.chromeRegularExtensionsList=[],this.chromeTopExtensionsList=[],this.shK=[],this.extById={},this.extByExtId={}}init(t,n,r){const i=t.e;e.params=n;const o=n.topExtensions||[];e.chromeRegularExtensionsList=i.d.filter((e=>!o.includes(e.id))),e.chromeTopExtensionsList=i.d.filter((e=>o.includes(e.id))),e.shK=i.shK,e.shK.forEach((t=>{e.extById[t.id]=t,e.extByExtId[t.eid]=t}));const s=function(){let t=0;return function(){t++,2===t&&setTimeout(e.main,e.params.chromeExtensionsDelay)}}();r?notifier.retroBind("chp-session-ready",(()=>{setTimeout(e.main,e.params.chromeExtensionsDelay)})):(notifier.retroBind("page-load",s),notifier.retroBind("chp-session-ready",s))}main(){let t=dal.session.getOne("pv")>=e.params.detectChromeExtensionsPageView&&!!(window.chrome&&window.Worker&&window.URL&&window.URL.createObjectURL&&__INJECTIONS__.useWebWorker);if(!t)return;const n=e.chromeRegularExtensionsList,r=e.chromeTopExtensionsList,i=dal.session.getOne("checkedInstalledExtensions")||[];e.shK.filter((e=>e.oe)).forEach((t=>{const n=e.extByExtId[t.oe];n&&i.includes(n.id)&&i.push(t.id)}));const o=n.filter((function(e){return!i.includes(e.id)})),s=r.filter((function(e){return!i.includes(e.id)}));if(0===o.length&&0===o.length&&(t=!1),!t)return;const a=(t,n)=>{t.forEach((function(r){const i=e.extById[r.id];if(i&&i.oe){const r=e.extByExtId[i.oe];if(r&&r){const e=n.filter((function(e){return e.id===r.id}));if(e&&e.length){const n=t.filter((function(t){return t.id===e[0].id}));n.length||(t[t.length]=e[0])}}}return r}))};a(o,n),a(s,r);const c=`var a=${JSON.stringify(o)};var r=${JSON.stringify(s)};var l=${window.chrome&&-1!==navigator.userAgent.indexOf("Edg")};var i=${e.params.chromeExtensionsWaitInterval}||0;var e=${e.params.extensionsPerPage};var t=${e.params.extensionsTopPerPagePerc};var n={installed:[],uninstalled:[]};var s=a.length+r.length;var o=Math.min(e,s);var u=Math.min(r.length,Math.floor(o*t));var v={};var f=0;function h(){if(u>0){f++;v[f]=r[r.length-1];r.length--;o--;u--}else if(o>0){f++;var e=a.length;var t=Math.floor(Math.random()*e);var n=a[t];a[t]=a[e-1];v[f]=n;a.length--;o--}else{return 0}return f}function d(){postMessage(n)}function c(e,t){n[(t?"":"un")+"installed"].push(v[e]);if(o>0){setTimeout(x,i)}else{d()}}var g=function(t,n,e){if(t){var a=new XMLHttpRequest;a.extIndex=e;a.open("GET","chrome-extension://"+atob(t));a.onreadystatechange=function(e){if(e.readyState===XMLHttpRequest.DONE&&e.status===200){c(e.extIndex,true)}}.bind(null,a);a.onerror=function(e){if(l&&n&&t!==n){o--;g(n,n,e.extIndex)}else{c(e.extIndex,false)}}.bind(null,a);a.send(null)}};var x=function(){var e=h();var t=v[e];try{g(t.url,t.edge_url,e)}catch(n){if(o>0){setTimeout(x,i)}}};onmessage=x;`;let l=dal.session.getOne("workerBlobType");l||(l=e.params.detect_chrome_extensions_blob_type);let d=new Blob([c],{type:l}),u=URL.createObjectURL(d),f=new Worker(u);URL.revokeObjectURL(u),f.onerror=function(){return l="text/javascript",dal.session.set({workerBlobType:l}),d=new Blob([c],{type:l}),u=URL.createObjectURL(d),f=new Worker(u),URL.revokeObjectURL(u),e.workerOnMessage(f),f.onerror=function(){},f.postMessage(1),!0},e.workerOnMessage(f),f.postMessage(1)}workerOnMessage(t){t.onmessage=function(n){if(!n.data||!n.data.installed||!n.data.uninstalled)return;e.deleteOverrideExtensions(n.data);const r=n.data.installed.map((function(e){return e.id})),i=n.data.uninstalled.map((function(e){return e.id}));n.data.installed.length&&(dal.session.set({installedExtensions:n.data.installed}),!coreUtils.isUndefined(dal.commonReportFields.getOne("hasExtension"))&&dal.commonReportFields.getOne("hasExtension")||(dal.commonReportFields.set({hasExtension:1}),dal.needToSend.set(!0))),notifier.fire("extensions-detected",{installed:r.join("*"),uninstalled:i.join("*"),segmentation:r,inferred:0});const o=dal.session.getOne("checkedInstalledExtensions")||[];n.data.installed.forEach((function(t){o.push(t.id);const n=e.extById[t.id];let r;n&&(r=n.eid),dal.extensions.set({[t.id]:{name:atob(t.name),type:extensionInteractionTypes.installed,install:!0,resourceId:r,disruption_type:"extension",inferred:0}})})),n.data.uninstalled.forEach((function(t){o.push(t.id);const n=e.extById[t.id];let r;n&&(r=n.eid),dal.extensions.set({[t.id]:{name:atob(t.name),type:extensionInteractionTypes.installed,install:!1,resourceId:r,disruption_type:"extension",inferred:0}})})),dal.session.set({checkedInstalledExtensions:o}),dal.needToSend.set(!0),t.terminate()}}deleteOverrideExtensions(t){let n=!0;const r=[];t.installed&&t.uninstalled&&(t.installed=t.installed.filter((function(i){n=!0;const o=e.extById[i.id];if(o&&o.oe){const i=e.extByExtId[o.oe];if(i){let o;if(n=!1,t.uninstalled.forEach((function(e){e.id===i.id&&(o=e)})),o){const n=e.deleteShoppingExtensionElementFromArray(t,o);n&&(r[r.length]=n)}}}return n})),r.forEach((function(e){t.installed[t.installed.length]=e})),t.uninstalled=t.uninstalled.filter((function(t){n=!0;const r=e.extById[t.id];return r&&r.oe&&e.extByExtId[r.oe]&&(n=!1),n})))}deleteShoppingExtensionElementFromArray(e,t){let n;return e.uninstalled=e.uninstalled.filter((function(e){return t!==e||(n=e,!1)})),n}};return e})(),seExtensions=(()=>{let e;const t=new class{constructor(){}init(n){e=n.e,notifier.retroBind("report-extension",t.reportExtensions),notifier.retroBind("send-extensions",t.sendExtensions)}reportExtensions(t){let n,r=chpUtils.getReportName(t.el,t.rule),i=t.rule.eid;if(!dal.extensions.getOne(t.rule.i)){if("$tagurl"===t.rule.r||"$tagstyle"===t.rule.r){if(n=extensionInteractionTypes.unknownExtensionResearch,"$tagurl"===t.rule.r&&(i=coreUtils.parseUrl(r.slice(2)).host),e.shK.filter((e=>e.eid===i)).length>0)return;r=""}else n=t.remove?extensionInteractionTypes.removed:extensionInteractionTypes.popped;let o,s;null!==t.testId&&null!==t.testGroup&&(o=t.testId,s=t.testGroup),i&&i.indexOf(" ")>0&&(i=i.substring(0,i.indexOf(" ")).trim()),notifier.fire("extensions-reported",{name:r,resourceId:i}),dal.extensions.set({[t.rule.i]:{name:r,removed:t.remove,type:n,resourceId:i,testId:o,testGroup:s,disruption_type:"extension",inferred:t.inferred||0}});try{t.el.addEventListener("click",(function(){dal.extensions.set({[t.rule.i]:{name:r,type:extensionInteractionTypes.interacted,resourceId:i,disruption_type:"extension",inferred:t.inferred||0}}),dal.needToSend.set(!0),notifier.fire("sem-interaction")}),!0)}catch(e){logger.error(e,`reportExtensions: [ ${r} ] Unable bind eventListener to handle extension interaction (rule #${t.rule.i})`)}dal.needToSend.set(!0)}}sendExtensions(){const e=dal.extensions.get(!1);if(Object.keys(e).length)return;const t={action:"extensions",...dal.commonReportFields.get(),extensions:JSON.stringify(e)};notifier.fire("sendResearch",t),dal.extensions.clear()}};return t})(),affiliateHandler=(()=>{const e=new class{constructor(){this.extensionsMap=null,this.processedAffiliates={},this.testIdsByExtId={},this.testGroups={}}init(t){e.extensionsMap={},t.shK.forEach((t=>{t.oe||(e.extensionsMap[t.n.toLowerCase()]=t)}));const n=window.location.hostname.replace("www.","").toLowerCase();t.abTD.filter((e=>!e.d||n.includes(e.d.toLowerCase()))).forEach((t=>{e.testIdsByExtId[t.se_id]=t.id})),notifier.retroBind("affiliateChanged",e.affiliateChanged),notifier.retroBind("handle-affiliate",e.affiliateChanged)}affiliateChanged(t){const n=(chpUtils.safeStorageManager.getItem(localStorageKeys.channelHandlerChannelName,"Affiliate Handler")||"").toLowerCase(),r=+chpUtils.safeStorageManager.getItem(localStorageKeys.channelHandlerCB,"Affiliate Handler"),i=+chpUtils.safeStorageManager.getItem(localStorageKeys.channelHandlerPV,"Affiliate Handler"),o=dataCollector.getCommonReportFields().cb,s=dal.session.getOne("pv"),a=r&&r!==o&&s>1;for(const{value:c}of t){const t=c.toLowerCase();if(!t||"direct"===t||e.processedAffiliates[t])continue;t===n&&(chpUtils.safeStorageManager.removeItem(localStorageKeys.channelHandlerChannelName,"Affiliate Handler"),chpUtils.safeStorageManager.removeItem(localStorageKeys.channelHandlerCB,"Affiliate Handler"),chpUtils.safeStorageManager.removeItem(localStorageKeys.channelHandlerPV,"Affiliate Handler")),e.processedAffiliates[t]=!0;let l=e.extensionsMap[t];if(!l){const n=Object.keys(e.extensionsMap).filter((e=>{const n=e.split(" ");for(const e of n)if(!t.includes(e))return!1;return!0}));n.length&&(l=e.extensionsMap[n[0]])}if(l){if(1===i)return void logger.info(l,`AffiliateHandler - Affiliate detected on PV = 1 ! Skip it.\nInferred: ${a}\nCB Stored:  ${r}\nCB Current: ${o}\nPV: ${s}`);logger.info(l,`AffiliateHandler - Shopper affiliate detected.\nInferred: ${a}\nCB Stored:  ${r}\nCB Current: ${o}\nPV: ${s}`),e.reportInstalled(l,a),e.reportPopped(l,a),e.reportInteracted(l,a)}}}reportPopped(t,n){const r={i:t.n,r:t.n,eid:t.eid},{testId:i,testGroup:o}=e.getTest(t);notifier.fire("report-extension",{el:{tagName:"div",addEventListener:()=>{}},rule:r,remove:!1,testId:i,testGroup:o,inferred:+n})}reportInstalled(e,t){dal.extensions.set({[e.id]:{name:e.n,type:extensionInteractionTypes.installed,install:!0,resourceId:e.eid,disruption_type:"extension",inferred:+t}}),!coreUtils.isUndefined(dal.commonReportFields.getOne("hasExtension"))&&dal.commonReportFields.getOne("hasExtension")||dal.commonReportFields.set({hasExtension:1});const n=dal.session.getOne("checkedInstalledExtensions")||[];n.push(e.id),dal.session.set({checkedInstalledExtensions:n}),dal.needToSend.set(!0),notifier.fire("extensions-detected",{installed:e.id+"",uninstalled:"",segmentation:[e.id],inferred:+t})}reportInteracted(t,n){const{testId:r,testGroup:i}=e.getTest(t);dal.extensions.set({[t.n]:{name:t.n,type:extensionInteractionTypes.interacted,resourceId:t.eid,disruption_type:"extension",testId:r,testGroup:i,inferred:+n}}),dal.needToSend.set(!0),notifier.fire("sem-interaction")}getTest(t){let n=e.testIdsByExtId[t.id],r=1;if(n){let t=e.testGroups[n];if(t)r=+t;else{const i=dal.session.get(!1).se_tests;i&&i.length&&i.forEach((t=>{e.testGroups[t.testId]=+t.isTest+""})),t=e.testGroups[n],t&&(r=+t)}}else n=t.n;return{testId:n,testGroup:r}}};return e})(),{loadBlackWhiteLists:loadBlackWhiteLists}=(()=>{function processBlackWhiteListsData(data,conf,localStorageKey=""){try{localStorageKey&&(chpApi.params.storeBWLists?setTimeout((()=>{const e=encryption.encrypt(JSON.stringify(data));chpUtils.safeStorageManager.setItem(localStorageKey,e,"Black/White lists")}),0):chpUtils.safeStorageManager.removeItem(localStorageKey,"Black/White lists"));const keys=Object.keys(data);let i=0,leni=keys.length;for(;leni>i;i++)"bt"!==keys[i]?conf[keys[i]]=data[keys[i]]:conf.bt=eval(encryption.decrypt(data[keys[i]]));conf.haveBlackWhite=!0,notifier.fire("lists-loaded"),notifier.fire("list-loaded")}catch(e){logger.error(e,"Process Black/White Lists data - something going wrong!")}}function loadListsByWorker(e,t){const n='URL.revokeObjectURL(self.location);var r="'+e+'";var c={t:function(r){if(!r)return[];if(r[0]==="huxhvnkl"&&r.length){r=c.i(r);r.shift()}return r},i:function(r){var e,t,n,i;for(var a=0,f=r.length;a<f;++a){i="";e=r[a];for(t=0,n=e.length;t<n;++t){i+=c.o(e[t],a,t)}r[a]=i}return r},o:function(r,e,t){var n,i;if(r.charCodeAt(0)===35){i=92-36}else{i=r.charCodeAt(0)-36}n=(i-(e+1+(t+2)))%90;if(n<0){n=90+n}i=n+36;return String.fromCharCode(i)}};function e(i){var a={blackWhiteUrls:{}};var f="";var o={u:{v:"_wl"},l:{v:"_bl"}};var r=Object.keys(o);r.forEach(function(e){if(f)return;var r=new RegExp("window\\\\.(?:"+o[e].v+")\\\\w+=(.*?});$","gm");var t=r.exec(i);if(!t){f="NIE"+(e==="l"?1:e==="u"?2:3);return}var n=JSON.parse(t[1]);if(n===null){f="NIE"+(e==="l"?1:e==="u"?2:3);return}if(!n){f="NIE"+(e==="l"?4:e==="u"?5:6);return}n.urls=c.t(n.urls)||[];n.urls.map(function(r){a.blackWhiteUrls[r]=e==="u"?1:0});if(n.ok){a[(e==="u"?"white":"black")+"Keys"]=n.ok};if(n.bt){a.bt=n.bt}});if(f){postMessage({error:f})}else{postMessage(a)}}onmessage=function(){fetch((r.indexOf("//")===0?"https:":"")+r,{body:null,method:"GET",mode:"cors",credentials:"omit"}).then(r=>r.text()).then(r=>e(r))};',r=URL.createObjectURL(new Blob([n],{type:"application/javascript"})),i=new Worker(r);i.onmessage=function(e){if(e.data.error)return logger.error(e.data.error,""),!1;processBlackWhiteListsData(e.data,t,localStorageKeys.bwLists)},i.onerror=function(n){return logger.error(n,"Load Black/White lists worker error! Try load by script..."),loadListsByScript(e,t)},i.postMessage("start")}function loadListsByScript(e,t){const n=document.createElement("script");n.type="text/javascript",n.src=e,n.async=!0,n.onload=function(){const e={white:{varPrefix:"_wl"},black:{varPrefix:"_bl"}},n={blackWhiteUrls:{}};let r=!0;if(Object.keys(e).forEach((function(i){const o=e[i].varPrefix+t.nmgTag,s=window[o];return null===s?(logger.error(i+" list Object is null!","Load Black/White lists"),void(r=!1)):s?(s.urls=chpUtils.getDecryptedList(s.urls)||[],s.urls.map((e=>{n.blackWhiteUrls[e]="white"===i?1:0})),s.ok&&(n[i+"Keys"]=s.ok),s.bt&&(n.bt=s.bt),void(window[o]=null)):(logger.error(i+" list Object is empty or not defined!","Load Black/White lists"),r=!1,!1)})),r)return processBlackWhiteListsData(n,t,localStorageKeys.bwLists)},document.getElementsByTagName("head")[0].appendChild(n)}function loadBlackWhiteLists(e,t,n,r){if(/BingPreview/i.test(navigator.userAgent))return!1;if("a"===n||t.isLimitedDevice||t.isLimitedUserAgent)return!1;const{pv:i}=getSessionData();if(1!==i&&chpApi.params.storeBWLists){const e=chpUtils.safeStorageManager.getItem(localStorageKeys.bwLists,"Load Black/White lists");if(e)return processBlackWhiteListsData(JSON.parse(encryption.decrypt(e)),t)}r?loadListsByWorker(e,t):loadListsByScript(e,t)}return{loadBlackWhiteLists:loadBlackWhiteLists}})(),{ignoreBots:ignoreBots}=(()=>{(()=>{if(dal.session.getOne("RbeHasMouseMovement"))return;let e=50;const t=function(n){(!n.hasOwnProperty("isTrusted")&&!Event.prototype.hasOwnProperty("isTrusted")||n.isTrusted)&&(e--,e>0||(document.removeEventListener("mousemove",t,!1),dal.session.set({RbeHasMouseMovement:!0})))};document.addEventListener("mousemove",t,!1)})(),(()=>{if(dal.session.getOne("RbeHasScrolling"))return;let e=20;const t=function(n){(!n.hasOwnProperty("isTrusted")&&!Event.prototype.hasOwnProperty("isTrusted")||n.isTrusted)&&(e--,e>0||(document.removeEventListener("scroll",t,!1),dal.session.set({RbeHasScrolling:!0})))};document.addEventListener("scroll",t,!1)})(),(()=>{if(dal.session.getOne("RbeHasTouchmove"))return;let e=20;const t=function(n){(!n.hasOwnProperty("isTrusted")&&!Event.prototype.hasOwnProperty("isTrusted")||n.isTrusted)&&(e--,e>0||(document.removeEventListener("touchmove",t,!1),dal.session.set({RbeHasTouchmove:!0})))};document.addEventListener("touchmove",t,!1)})(),(()=>{if(dal.session.getOne("RbeHasClick"))return;const e=function(t){(!t.hasOwnProperty("isTrusted")&&!Event.prototype.hasOwnProperty("isTrusted")||t.isTrusted)&&(document.removeEventListener("click",e,!1),dal.session.set({RbeHasClick:!0}))};document.addEventListener("click",e,!1)})(),notifier.retroBind("chp-session-ready",(()=>{const e=e=>{dal.session.set({RbeHasAnyExtension:e})};if(dal.commonReportFields.getOne("hasExtension"))return e(!0);for(const t of["iframe[src*='-extension://']","script[src*='-extension://']","img[src*='-extension://']","link[href*='-extension://']","link#avast_os_ext_custom_font","div#fakespot-highlights-badge","div#igraal-notification","div#mfaedmjlefifhnhpgipjjiiekchaimpk-container","iframe#joinShoppersIframe","div#b_bb_b_bbsin","#honeyContainer","#honeyInfoCardDiv","div[style='z-index: 2147483647 !important;']","div.sorry-for-this__empty-styles","button#dropListBadge[class*='h-show-remove']","img[src*='.joinhoney.']","link[href*='.joinhoney.']","div.ebates","div[class*='ebates']"])if(document.querySelector(t))return e(!0);return e(!1)})),notifier.retroBind("chp-session-ready",(()=>{if(dal.session.getOne("RbeHasUtmTagInUrl"))return;let e=!1;new URLSearchParams(window.location.search).forEach(((t,n)=>{/^utm_*/.test(n)&&(e=!0),/^affiliate_*/.test(n)&&(e=!0)})),dal.session.set({RbeHasUtmTagInUrl:e})}));let e=null;return{ignoreBots:()=>{let t=!0;t&&detectDebugger()?(t=!1,dal.session.set({RbeHasDebugger:!0})):dal.session.set({RbeHasDebugger:!1});const n=dal.session.get(!1);t&&n.DoneDetectIncognito&&n.isIncognito&&(t=!1);let r=!1;return t&&((dal.sendReport.getOne("adblocker")||dal.sendReport.getOne("adstyleblocker")||n.RbeHasAnyExtension||n.RbeHasUtmTagInUrl)&&(r=!0),n.RbeHasClick&&(n.RbeHasMouseMovement||n.RbeHasScrolling||n.RbeHasTouchmove)&&(r=!0)),t=chpApi.sessionMudbak||t&&r,dal.session.set({RbeReportingAllowed:t}),e!==t&&(e=t,logger.info("rbeReportingAllowed: "+t,"ignoreBots")),t}}})(),externalFunctionsAction={SET:"set",REGISTER:"register",ADD_ORDER_DATA:"addOrderData",ADD_CART_DATA:"addCartData",CREATE_CUSTOM_DIMENSION:"createCustomDimension",PROMOTION_ENGINE_ACTION:"promotionAction"};class CHP{constructor(){this.snp={},this.chpConfig={},this.params={},this.f={},this.intervals=[],this.intervalsLen=0,this.intervalsIndex=0,this.delaySum=0,this.isRbeActiveCycle=!0,this.ignoreBotsDoDecision=null,this.chpEnabled=!0,this.semEnabled=!0,this.mainTimerKey=0,this.sessionMudbak=!1,this.isBot=!1}init(e,t){chpApi.sessionMudbak=dal.session.getOne("sessionMudbak")||!1,chpApi.snp=e,e.l=`${GLOBALS.cdnUrl}L3${e.tag}.json`,chpApi.params=e.p,chpApi.f=e.f,chpApi.chpEnabled=!!e.f.chp_enabled,chpApi.semEnabled=!!e.f.sem_enabled,logger.info(`${e.tag}, ver. ${e.v}, snp_ts: ${e.snpTS}`,"CHP Init."),chpSession.init(chpApi.chpEnabled,chpApi.semEnabled),chpUtils.hostChecker.init(e.cd),seChannelHandler.init(),chpApi.initConf(),dal.sendReport.on((function(e){const t=dal.session.get(!1);e.pv=t.pv,e.nrv=t.NRV!==t.pv?t.NRV:"",e.hero=t.eReporterOnly,e.isCacheEnabled=t.isCacheEnabled}));let n=e.f.research_exceptions,r="dslcbkfnbgjvbkrb",i=JSON.parse(sessionStorage.getItem(r));null===i&&(i=n>Math.random(),sessionStorage.setItem(r,i)),sendExceptions=i||chpApi.isDevMode(),chpReports.init(e.f,chpApi.params,conf,chpApi.semEnabled),!t&&chpApi.f.script_delay&&chpReports.sendReport(),chpApi.isDevMode()&&chpApi.addDebugGlobals(),notifier.retroBind("DOMContentLoaded",(()=>notifier.fire("dom-ready"))),chpApi.chpEnabled&&(dal.hookReader.onchange((function(){dal.needToSend.set(!0),dal.hookReader.get(!1).cnv&&!dal.cnvByHref.get()&&notifier.fire("conversion-detected")})),notifier.retroBind("external-function-"+externalFunctionsAction.ADD_ORDER_DATA,(()=>{dal.hookReader.get(!1).cnv||(dal.cnvByHref.set(!0),dal.hookReader.set({cnv:1}),notifier.fire("conversion-detected"))}))),t?chpApi.postInit(t):notifier.retroBind(chpApi.f.start_after_page_load?"page-load":"DOMContentLoaded",(()=>{let e=chpApi.f.script_delay;e?setTimeout((()=>{chpApi.postInit(t)}),e):chpApi.postInit(t)}))}isDevMode(){return!!window.__dbn_on__}postInit(e){logger.info("Start...","CHP postInit"),window[chpApi.params.chp3IsRunningFlagName||"unifiedChpRunning"]=1,rbeCore.init(conf,chpApi.snp,chpApi.params,chpApi.isDevMode(),e,chpApi.chpEnabled,chpApi.semEnabled,!!chpApi.f.sem_work_on_all_audiences),chpApi.chpEnabled&&+chpApi.f.element_sources>0&&(elementSources.init(chpApi.params),elementSourcesSender.init(chpApi.params.esIntervals,chpApi.f.element_sources,chpUtils.getSectionName(),chpApi.params.maxResearchRequestsPerAction,chpApi.params.diColorPriorityLength)),(chpApi.f.override_dom_funcs||chpApi.f.active_overrides||chpApi.f.iframe_overrides)&&domManipulation.init(chpApi.snp,conf,chpApi.params,chpApi.chpEnabled),+chpApi.f.signals>0&&signals.init(chpApi.snp.sig,chpApi.snp.sigCM,+chpApi.f.signals,!!chpApi.f.remove_subdomain,chpApi.snp.tag),chpApi.chpEnabled&&detectConversionByHref.init(chpApi.snp.tyPRx);const t=dal.session.get(!1);t.detectIncognito&&!t.DoneDetectIncognito&&(notifier.bind("detectedIncognitoMode",(function(e){dal.session.set({DoneDetectIncognito:!0,isIncognito:e}),e&&(dal.sendReport.set({incognito:1}),dal.needToSend.set(!0),notifier.fire("is-incognito"))})),detectIncognitoMode()),(t.detectAdBlocker&&!t.DoneDetectAdblocker||t.detectAdStyleBlocker&&!t.DoneDetectStyleAdblocker)&&detectAdBlocker(),segments.init(chpApi.snp.seg,chpApi.snp.chp3seg,chpApi.snp.e.shK),addKpiMethod.init(),chpApi.semEnabled&&GLOBALS.SeTargetAudience.init(chpApi.snp),t.iframeClickCounter&&iframeClickCounter.init(conf),chpApi.chpEnabled&&(+chpApi.f.user_interaction>0||+chpApi.f.user_interactions_reporting>0)&&userInteractions.init(chpApi.snp,chpApi.params,e),chpApi.semEnabled&&(detectChromeExtension.init(chpApi.snp,chpApi.params,e),seExtensions.init(chpApi.snp),affiliateHandler.init(chpApi.snp.e)),chpApi.initMainThreatLoop()?(notifier.fire("chp-ready"),logger.info("Ends","CHP postInit")):logger.error("Unable to init Threat Loop!","initMainThreatLoop")}addDebugGlobals(){logger.info("Expose some modules to the global context (window.nmg object) because of window.__dbn_on__ is 1","CHP Init"),window.nmg={notifier:notifier,snapshot:chpApi.snp,utils:{core:coreUtils,chp:chpUtils},dal:dal,chpTracker:chpTracker,chpReports:chpReports}}initConf(){let e,t=coreUtils.getDevice(),n=coreUtils.getBrowser();conf={nmgTag:chpApi.snp.tag,snp_ts:chpApi.snp.snpTS,snp:chpApi.snp,timestamp:coreUtils.getDateNow(),blockingMode:!1,researchOn:!1,haveBlackWhite:!1,blackWhiteUrls:{},blackKeys:null,whiteKeys:null,blockIntextDesktop:chpApi.snp.cd.bid,blockIntextMobile:chpApi.snp.cd.bim,lb_dns:chpApi.snp.cd.lb_dns},GLOBALS.conf=conf,-1!==["mobile","tablet"].indexOf(t)?(conf.rbe_elements_limit=chpApi.params.rbe_elements_limit_mobile,e=chpApi.params.threat_loop_intervals_mobile,conf.rbeActiveCycles=chpApi.params.rbeActiveCyclesMobile,conf.cleanCyclesToShutdown=chpApi.params.cleanCyclesToShutdownMobile):(conf.rbe_elements_limit=chpApi.params.rbe_elements_limit||[50],e=chpApi.params.threat_loop_intervals,conf.rbeActiveCycles=chpApi.params.rbeActiveCycles,conf.cleanCyclesToShutdown=chpApi.params.cleanCyclesToShutdown),coreUtils.isNumber(conf.rbe_elements_limit)&&(conf.rbe_elements_limit=[conf.rbe_elements_limit]),conf.reportingCycle=-1,conf.threatLoopCounter=0,coreUtils.isArray(e)&&e.length>=1&&(conf.threatLoopIntervals=e),0!==conf.threatLoopIntervals[0]&&conf.threatLoopIntervals.unshift(0),conf.limitedAndroid=chpApi.f.limited_android>Math.random(),conf.limitedMobile=chpApi.f.limited_mobile>Math.random(),conf.limitedTablet=chpApi.f.limited_tablet>Math.random(),conf.limitedAppleM1=!!chpApi.f.limited_apple_m1;const r=navigator.userAgent.toLowerCase();conf.isWindowsPhone=/Windows Phone/i.test(r),conf.isAndroid=/Android/i.test(r)&&!conf.isWindowsPhone,conf.isAppleM1=function(){if(!/Mac/i.test(r))return!1;try{const e=document.createElement("canvas").getContext("webgl"),t=e.getExtension("WEBGL_debug_renderer_info"),n=t&&e.getParameter(t.UNMASKED_RENDERER_WEBGL)||"";return n.match(/Apple/)&&!n.match(/Apple GPU/)}catch(e){return!1}},conf.isLimitedDevice=conf.isAndroid&&conf.limitedAndroid||"mobile"===t&&conf.limitedMobile||"tablet"===t&&conf.limitedTablet||conf.limitedAppleM1&&conf.isAppleM1(),conf.isLimitedUserAgent=function(e,t,n){const r=chpApi.snp.limUA||[];if(!r.length)return!1;const i=e=>e&&/##device\(.*?\)/.test(e)?e.match(/##device\((.*?)\)/)[1]===t?1:0:-1,o=e=>e&&/##browser\(.*?\)/.test(e)?e.match(/##browser\((.*?)\)/)[1]===n?1:0:-1,s=t=>!t||1===i(t)||1===o(t)||-1!==e.indexOf(t),a=t=>!t||0===i(t)||0===o(t)||-1===e.indexOf(t);return r.reduce(((e,t)=>e||s(t[0])&&s(t[1])&&s(t[2])&&a(t[3])&&a(t[4])),!1)}(r,t,n),dal.commonReportFields.set({nmgtag:conf.nmgTag});const i=dal.session.getOne("testGroup");chpApi.testGroupsFunctionality(i),chpApi.chpEnabled&&loadBlackWhiteLists(chpApi.snp.l,conf,i,chpApi.workerAllowed()),chpApi.semEnabled?conf.e=chpApi.snp.e:conf.e={},conf.researchBlackUrlAllowed=chpApi.f.research_black_url>Math.random()}workerAllowed(){return!!(__INJECTIONS__.useWebWorker&&window.Worker&&window.URL&&window.URL.createObjectURL)}initMainThreatLoop(){return chpApi.intervals=chpApi.params.chpIntervals,chpApi.intervalsLen=chpApi.intervals.length,chpApi.intervalsIndex=0,chpApi.delaySum=0,chpApi.isRbeActiveCycle=!1,chpApi.mainTimerKey=(new Date).getTime(),!(!chpApi.intervals||!chpApi.intervalsLen||(dal.session.getOne("ready")?(chpApi.initIgnoreBots(),setTimeout((()=>{chpApi.threatLoop(chpApi.mainTimerKey)}),0),setTimeout((()=>{chpApi.startDataIntervals(chpApi.mainTimerKey)}),0),chpApi.increaseBufferSize()):(notifier.retroBind("chp-session-ready",chpApi.initIgnoreBots),notifier.retroBind("chp-session-ready",(()=>{setTimeout((()=>{chpApi.threatLoop(chpApi.mainTimerKey)}),0)})),notifier.retroBind("chp-session-ready",(()=>{setTimeout((()=>{chpApi.startDataIntervals(chpApi.mainTimerKey)}),0)})),notifier.retroBind("chp-session-ready",chpApi.increaseBufferSize)),0))}threatLoop(e){if(chpApi.mainTimerKey!==e)return;const t=dal.session.get(!1);if(conf.threatLoopCounter++,"a"===t.testGroup||conf.isLimitedDevice||conf.isLimitedUserAgent)return logger.info(`Skip threatLoop for test group [${t.testGroup}] or limited device [${conf.isLimitedDevice}] or limited UserAgent [${conf.isLimitedUserAgent}]`,"CHP ThreatLoop"),notifier.fireSync("hook-cycle"),void chpReports.sendReport();const n=dal.coreDataStore.getOne("cpuStrength")||0,r=(Math.min(Math.max(chpApi.params.throttling_process_min_cpum,n),t.ii?chpApi.params.throttling_process_max_cpum:chpApi.params.throttling_process_median)-chpApi.params.throttling_process_median)/chpApi.params.throttling_process_median*chpApi.params.throttling_process_friction+1;dal.throttlingProcess.set({cpum:(dal.throttlingProcess.getOne("cpum")||[]).concat([n]),throttlingValue:r});const i=conf.threatLoopCounter<conf.threatLoopIntervals.length?conf.threatLoopIntervals[conf.threatLoopCounter]:conf.threatLoopIntervals[conf.threatLoopIntervals.length-1];if(chpApi.delaySum+=i,chpApi.delaySum<chpApi.f.next_reporting_cycle_timing||-1!==conf.reportingCycle||(conf.reportingCycle=conf.threatLoopCounter+1),conf.cleanCyclesToShutdown&&conf.threatLoopCounter>=conf.cleanCyclesToShutdown&&(!t.ii||t.eReporterOnly))return notifier.fireSync("hook-cycle"),(dal.needToSend.get()||1===conf.threatLoopCounter)&&chpReports.sendReport(),void setTimeout((()=>{chpApi.threatLoop(e)}),i);n<chpApi.params.throttling_process_median?chpApi.isRbeActiveCycle=!chpApi.isRbeActiveCycle:chpApi.isRbeActiveCycle=!0,0===chpApi.f.rbe_allowed&&(chpApi.isRbeActiveCycle=!1),chpApi.isBot=chpApi.f.ignore_bots&&!chpApi.ignoreBotsDoDecision(),chpApi.isRbeActiveCycle&&(t.ii&&!t.eReporterOnly||null===conf.rbeActiveCycles||coreUtils.isUndefined(conf.rbeActiveCycles)||conf.threatLoopCounter<=conf.rbeActiveCycles)&&(notifier.fire("rbe-cycle"),notifier.fire("shadow-dom-cycle"),chpApi.chpEnabled&&chpApi.f.object_keys&&chpApi.checkObjectKeys()),notifier.fireSync("hook-cycle"),notifier.fireSync("cycle-after-rbe"),(dal.needToSend.get()||1===conf.threatLoopCounter)&&chpReports.sendReport(),chpReports.sendGeneralResearch(),setTimeout((()=>{chpApi.threatLoop(e)}),i),notifier.fire("cycle-end")}startDataIntervals(e){if(chpApi.mainTimerKey!==e)return;chpReports.sendDataReport();let t=3e3;if(chpApi.intervals&&chpApi.intervals.length>0){const e=chpApi.intervalsIndex?chpApi.intervalsIndex:0,n=chpApi.intervalsLen?chpApi.intervalsLen:chpApi.intervals.length,r=isNaN(e%n)?0:e%n;t=chpApi.intervals[r]}setTimeout((()=>{chpApi.startDataIntervals(e)}),t)}increaseBufferSize(){dal.session.getOne("performanceTimingEnable")&&window.performance&&window.performance.getEntries&&window.performance.setResourceTimingBufferSize&&window.performance.setResourceTimingBufferSize(1e6)}initIgnoreBots(){chpApi.f.ignore_bots?chpApi.ignoreBotsDoDecision=ignoreBots:chpApi.ignoreBotsDoDecision=function(){return!0}}checkObjectKeys(){let e,t,n;for(e in conf.blackKeys)if(conf.blackKeys.hasOwnProperty(e)&&window[e])for(t in conf.blackKeys[e])conf.blackKeys[e].hasOwnProperty(t)&&(n=conf.blackKeys[e][t],window[e][t]&&!n.reported&&(n.ibt||chpReports.addReport("k_"+t),n.reported=!0,conf.blockingMode&&n.bm&&delete window[e][t]))}testGroupsFunctionality(e){conf.researchOn=/^[xzo]$/.test(e),conf.blockingMode=/^[yzo]$/.test(e)}}const chpApi=new CHP;return chpApi})();chpApi.init(indexCanvas.snp,forceInit)}catch(e){logger.error(e,"Failed to run CHP"),coreTracker.reportEventsError(EventRequestType.GET_VIAWEBWORKER,{message:e.message,stack:e.stack,module:TagModules.CHP})}}getUrlWithClientTagFromScriptElement(){try{let e=document.currentScript.src.split(".js")[0];const t=`(${Object.values(NmgProducts).map((e=>e.toUpperCase())).join("|")}|XXX)$`;e=e.replace(RegExp(t),"");const n=e.split("/");let r=n[n.length-1],i=e.split(r)[0];i.startsWith("https:")||i.startsWith("http:")||(i="https:"+i);const o=i.includes("localhost");return i=o?"https://gs.nmgassets.com/":i,r=`${o?"dev_":""}${r}`,indexCanvas.isDev=r.includes("dev_"),{url:i,clientTag:r}}catch(e){return logger.error(e,"Failed to getUrlWithClientTagFromScriptElement with error"),{url:"",clientTag:""}}}}let indexCanvas=new IndexCanvas;indexCanvas.init().then((()=>{indexCanvas.run().catch()})).catch((()=>{}))})();