"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[45660],{35088:function(e,n,t){t.d(n,{p:function(){return m}});var a=t(179404),r=t(222830),i=t(868143);const l={type:null,message:null,payments:[]},d=e=>{var n;let t=l,a=l,r=l,i=l,d=l,o=l,s=l,c=l,u=l,m=l,p=l;null===(n=e.wallet)||void 0===n||n.paymentGroups.forEach(e=>{switch(e.type){case"CREDIT_CARD":t=e;break;case"GIFT_CARD":a=e;break;case"EBT":r=e;break;case"DIRECT_SPEND_CARD":i=e;break;case"DIGITAL_OFFERS":d=e;break;case"PAYPAL_BA":o=e;break;case"CASHI":s=e;break;case"PAYBYBANK":c=e;break;case"WM_CREDIT":u=e;break;case"WIC":m=e;break;case"ONE_PAY":p=e}});const x=a.payments.filter(e=>e.showAutoProvisionMessage);return{...e,wallet:{...e.wallet,eGiftCards:x,paymentGroups:{creditCard:t,giftCard:a,ebtCard:r,benefitCard:i,digitalOffers:d,payPalBA:o,cashi:s,payByBank:c,refundCredit:u,wic:m,onePay:p}}}},o={type:"mutation",name:"AutoProvisionGiftCard",hash:"65fa2f298f71bac822ecf81f8c5e44e142b5fcdf73f8feb52b96244d89ef7b04"},s={type:"query",name:"GetWalletPayments",hash:"5207379496309e9b2182aa67ac4f23bd4053ce9c8eb4e074f13520df7bef9d20"},c={type:"query",name:"GetWalletPaymentsMobile",hash:"bbe7d838e272fa0269c684b964a315d11db44a4359ae88fcfa112d957e9d5bad"};var u=t(165399);const m=e=>{const{isMobile:n,eegcn:t,enabled:l=!0,orgContextEnabled:m,enableSkyNewProgramLink:p,enableWalletPoweredByOne:x,enableOneCreditCard:y,enablePayWithPoints:g}=e,f=(0,u.M)(),h=((e,n)=>{let{isMobile:t,eegcn:a,fetchIntercept:r,orgContextEnabled:l,enableSkyNewProgramLink:u,enableWalletPoweredByOne:m,enableOneCreditCard:p,enablePayWithPoints:x}=n;const y=t?c:s;return{queryKey:["get-wallet-payments"],queryFn:()=>{const n=e.getGqlFetch("cegateway",r);return a?n(o,{input:{encryptedData:a}}).then(e=>{let{data:n}=e;var t,a;const{autoProvisionGiftCard:r}=n;if(!r||!(null===r||void 0===r?void 0:r.wallet))return Promise.reject(new Error("something is wrong"));const l=(null===r||void 0===r?void 0:r.provisionSuccess)?"Done! Card ending ".concat(null===(t=n.autoProvisionGiftCard)||void 0===t||null===(a=t.giftCard)||void 0===a?void 0:a.lastFour," successfully edited."):(0,i.Ss)({data:n,isFromDsForm:!1}).message;return{account:null,wallet:r.wallet,autoProvisionResult:{message:l,isError:!(null===r||void 0===r?void 0:r.provisionSuccess)}}}).then(e=>d(e)):n(y,{enableAccountDetails:l,enableSkyNewProgramLink:u,enableWalletPoweredByOne:m,enableOneCreditCard:p,enablePayWithPoints:x}).then(e=>!e.data.wallet||e.errors?Promise.reject(new Error("Something went wrong. Please try again.")):d(e.data))}}})((0,a.Z)(),{isMobile:n,eegcn:t,fetchIntercept:f,orgContextEnabled:m,enableSkyNewProgramLink:p,enableWalletPoweredByOne:x,enableOneCreditCard:y,enablePayWithPoints:g}),{data:C,error:v,isFetching:b,refetch:w}=(0,r.a)({...h,config:{enabled:l,refetchOnWindowFocus:!1}});return{error:v,isFetching:b,data:C,refetch:w}}},633857:function(e,n,t){t.d(n,{dY:function(){return q},GB:function(){return X},nu:function(){return Y}});var a=t(487954),r=t(155394),i=t(293168),l=t(513455),d=t(179404),o=t(222830),s=t(636230);const c={type:"query",name:"GetPauseMembershipDetails",hash:"d5db3e3a8bfeccfa007d7f24fc4f33a94862de6d1225298ef37b846a8e9427f3"},u=e=>{let{initialData:n,enabled:t=!0}=e;const a=(r=(0,d.Z)(),{queryKey:[s.CO],queryFn:()=>r.getGqlFetch("ceaccount")(c)});var r;return(0,o.a)({...a,config:{initialData:n,refetchOnWindowFocus:!1,enabled:t}})};var m=t(835847),p=t(194742),x=t(946192),y=t(522037),g=t(682081),f=t(425443),h=t(297693),C=t(811308),v=t(438989),b=t(976973),w=t(160511),A=t(875710),E=t(432215),S=t(516696),L=t(239582),P=t(385074),I=t(91726),j=t(444002);var N=e=>{let{pageTitle:n,setTermsConsented:t,checkboxRef:i,termsConsented:l,termsConsentError:d,disclaimerCopy:o,membershipStatus:s,hasInHome:c,tenureName:u}=e;return(0,a.jsxs)("div",{className:"flex flex-column items-start",children:[(0,a.jsx)(r.Divider,{UNSAFE_className:"pt3"}),(0,a.jsx)("div",{className:"b f6 pv3",children:(0,a.jsx)("span",{className:"pre-wrap",children:o})}),(0,a.jsx)(I.ZP,{className:"f6 b black mb3",href:"https://www.walmart.com/help/article/walmart-terms-of-use/de696dfa1dd4423bb1005668dd19b845","aria-label":(0,g.m)(E,"seeFullTerms"),...L.PR.fullTermsOnLinkExtras({text:(0,g.m)(E,"seeFullTerms"),membershipStatus:s,hasInHome:c,tenureName:u}),"data-dca-id":"L:C792F5E0D9",children:(0,g.m)(E,"seeFullTerms")}),d&&(0,a.jsx)(h.tp,{...(0,L._i)({pageTitle:n,membershipStatus:s,hasInHome:c,tenureName:u}),children:(0,a.jsx)("div",{className:"pb3 dark-red",children:(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",backgroundColor:"var(--color-core-red-10)",borderColor:"var(--color-core-red-50) var(--color-core-red-50) var(--color-core-red-50) var(--color-core-red-100)",borderWidth:"1px 1px 1px 4px",borderStyle:"solid",borderRadius:"4px",padding:"7px 16px 7px 12px",lineHeight:"20px"},children:[(0,a.jsx)(j.J,{name:"ExclamationCircle"}),(0,a.jsx)("span",{className:"f6",style:{marginLeft:"8px"},children:(0,g.m)(E,"alertErrorMessage")})]})})}),(0,a.jsx)(P.Z,{id:"resume-checkbox",ref:i,className:"mb2 b z-0",label:(0,g.m)(E,"agreeRequired"),checked:l,...L.PR.checkBoxOnLinkExtras({membershipStatus:s,hasInHome:c,tenureName:u,termsConsented:l}),onChange:()=>t(!l)})]})},F=t(345952),M=t(200421),T=t(918099),B=t(620769),V=t.n(B),_=t(485052);var D=function(e){let{primaryButtonText:n,primaryButtonAction:t,primaryButtonAnalytics:i={},secondaryButtonText:l,secondaryButtonAction:d,secondaryButtonAnalytics:o={},isLoading:s}=e;const{isZoomedIn:c}=(0,_.CQ)({zoomComparePercentage:200});return(0,a.jsxs)("div",{"data-testid":"sticky-footer",className:V()("bg-white bottom-0 left-0 right-0 ph4 pb3",{absolute:!c}),style:{maxWidth:"48rem",margin:"auto"},children:[(0,a.jsx)("div",{className:"nl4 nr4 w-auto",children:(0,a.jsx)(r.Divider,{})}),(0,a.jsx)(M.Z,{isFullWidth:!0,className:"mt4",size:"medium",variant:"primary",disabled:s,leading:s?(0,a.jsx)(T.$,{color:"white",size:"small"}):null,onClick:t,...i,"data-dca-id":"B:7A7E7B52B9","data-dca-intent":"__DCA_TBD__",children:n}),l&&d?(0,a.jsx)(M.Z,{isFullWidth:!0,size:"medium",className:"mt3",variant:"tertiary",disabled:s,onClick:d,...o,"data-dca-id":"B:DF29E9F554","data-dca-intent":"__DCA_TBD__",children:l}):null]})};var k=e=>{let{title:n}=e;const{isMobile:t}=(0,f.vP)();return t?(0,a.jsx)("span",{children:n}):(0,a.jsx)(r.Heading,{UNSAFE_className:"flex bg-blue white pa4 z-2",UNSAFE_style:{margin:"-24px -58px -25px -26px",width:"422px"},"aria-live":"assertive",children:n})};function O(e,n,t){return L.PR.continuePauseClick({text:null===e||void 0===e?void 0:e.secondaryCTALabel,heading:n,addOns:t})}function R(e,n,t){return L.PR.resumeMembershipClick({text:null===e||void 0===e?void 0:e.primaryCTALabel,heading:n,addOns:t})}function W(e,n,t){return{mb:{tr:e,mt:n},pg:{nm:t},ta:{pt:t}}}const U=e=>{let{isTrial:n,tenureName:t,pageTitle:r,children:i}=e;return(0,a.jsx)(y.ZP,{pageTitle:r,name:"manageMembership",moduleContext:"wplus",moduleLinkExtras:W(n,t,r),moduleViewExtras:W(n,t,r),"data-dca-id":"M:4D1BFC6075","data-dca-type":"module",children:i})},G=e=>{let{setCcErrorAlert:n,setOlErrorAlert:t,olErrorAlert:i,ccErrorAlert:l,onDialogClose:d,setIsResumeDialogOpen:o,pageTitle:s,resumeModule:c,planDetails:u,isTrial:m,tenureName:y,paymentPreferenceId:f,heading:C,plusUpsList:v,addOnsIdList:b,membershipStatus:w,yourAddOns:P,cohort:I}=e;const{0:j,1:M}=(0,p.useState)(void 0),{0:T,1:B}=(0,p.useState)(!1),{0:V,1:_}=(0,p.useState)(!1),{0:k,1:W}=(0,p.useState)(!1),U=(0,p.useRef)(null),{updateMembershipPauseStatus:G}=Y(),Z=(0,p.useCallback)(e=>{M(e),n({})},[]),H=(0,h.wG)();(0,p.useEffect)(()=>{V&&W(!1)},[V]);const z=!!(null===b||void 0===b?void 0:b.some(e=>null===e||void 0===e?void 0:e.includes("INHOME")));return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(F.Z,{forceImageFullWidth:!0,heading:C,hasStickyFooter:!0,Alert:(0,a.jsx)(S.Z,{...i}),imageAlt:(0,g.m)(E,"resumeMembership"),pauseBenefits:null===c||void 0===c?void 0:c.reviewConditions,pauseDescription:null===c||void 0===c?void 0:c.descriptionParagraphs,imageUrl:null===c||void 0===c?void 0:c.topImage,children:[(0,a.jsx)(r.Divider,{}),(0,a.jsx)(A.Z,{paymentPreferenceId:f,selectedCardId:j,setSelectedCardId:Z,Alert:(0,a.jsx)(S.Z,{...l}),heading:(0,g.m)(E,"confirmPaymentHeading"),description:void 0,showChangePaymentLink:!0}),(0,a.jsx)(N,{disclaimerCopy:(0,x.PX)({planDetails:u,tenureName:y,plusUpsList:v,showInHomeCopy:!!(null===b||void 0===b?void 0:b.length),yourAddOns:P,cohort:I}),termsConsented:V,checkboxRef:U,termsConsentError:k,setTermsConsented:_,pageTitle:s,tenureName:y,membershipStatus:w,hasInHome:z})]}),(0,a.jsx)(D,{primaryButtonText:null===c||void 0===c?void 0:c.primaryCTALabel,primaryButtonAction:async()=>{var e,a;if(!j)return void n(function(e,n){return{message:(0,g.m)(E,"noCcAlert"),variant:"error",className:"mt2",...L.PR.noCcErrorAlert({pageTitle:e,addOns:n})}}(s,b));if(!V)return W(!0),void setTimeout(()=>{var e;null===(e=U.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},100);B(!0);const r=await G({pauseOperationType:"RESUME_MEMBERSHIP",paymentPreferenceId:j});if(B(!1),!r||r.errors||(null===(e=r.data)||void 0===e||null===(a=e.updateMembershipPauseStatus)||void 0===a?void 0:a.error)){var i,l,d;"PAYMENT_AUTH_FAILURE"===(null===r||void 0===r||null===(i=r.data)||void 0===i||null===(l=i.updateMembershipPauseStatus)||void 0===l||null===(d=l.error)||void 0===d?void 0:d.code)?n(function(e,n){return{message:(0,g.m)(E,"ccProcessingAlert"),variant:"error",className:"mt2",...L.PR.ccProcessingAlertError({pageTitle:e,addOns:n})}}(s,b)):t(function(e,n){return{message:(0,g.m)(E,"generalAlert"),variant:"error",className:"mt2",...L.PR.generalAlertError({pageTitle:e,addOns:n})}}(s,b))}else H(L.PR.resumePauseAsync({pageTitle:s,isTrial:m,tenureName:y,addOns:b})),t({}),n({}),o(!1)},primaryButtonAnalytics:R(c,C,b),secondaryButtonText:null===c||void 0===c?void 0:c.secondaryCTALabel,secondaryButtonAction:d,secondaryButtonAnalytics:O(c,C,b),isLoading:T})]})};var Z=function(e){let{isResumeDialogOpen:n,setIsResumeDialogOpen:t,onClose:r,pageTitle:i}=e;const{isMobile:l}=(0,f.vP)(),{data:d,isFetching:o,isError:s}=(0,_.JX)({enabled:n,additionalQueryKey:"RESUME_MEMBERSHIP"}),{0:c,1:u}=(0,p.useState)({}),{0:m,1:y}=(0,p.useState)({});if(o)return(0,a.jsx)(w.Z,{});const{module:A,planDetails:S,yourAddOns:P}=d||{},I=(0,x.GP)(P),j=+("TRIAL"===(null===d||void 0===d?void 0:d.membershipStatus)),N=(null===d||void 0===d?void 0:d._tenureName.toLowerCase())||"",F=null===d||void 0===d?void 0:d.membershipStatus,M=null===d||void 0===d?void 0:d.cohort,T=()=>{u({}),y({}),t(!1),null===r||void 0===r||r()},B=s||"ACTIVE"!==(null===d||void 0===d?void 0:d.pauseStatus),V=(null===A||void 0===A?void 0:A.title)||(0,g.m)(E,"resumeMembership"),D=(null===A||void 0===A?void 0:A.heading)||"",O=!B&&d&&A&&S;return(0,a.jsx)(U,{pageTitle:i,isTrial:j,tenureName:N,children:(0,a.jsx)(v.Z,{children:(0,a.jsxs)(b.Z,{size:"medium",position:"right",onClose:T,desktopComponent:"panel",title:(0,a.jsx)(k,{title:V}),isOpen:n,onLinkExtrasForClose:L.PR.onLinkExtrasForClose({heading:D,addOns:I}),closeButtonProps:l?void 0:{UNSAFE_className:"white mt2"},children:[!O&&(0,a.jsx)(C.m,{}),O&&(0,a.jsx)(h.tp,{...L.PR.overlay({pageTitle:i,isTrial:j,tenureName:N,heading:D,addOns:I}),children:(0,a.jsx)(G,{setCcErrorAlert:y,setOlErrorAlert:u,olErrorAlert:c,ccErrorAlert:m,onDialogClose:T,setIsResumeDialogOpen:t,pageTitle:i,resumeModule:A,planDetails:S,isTrial:j,tenureName:N,paymentPreferenceId:null===d||void 0===d?void 0:d.paymentPreferenceId,heading:D,addOnsIdList:I,membershipStatus:F,plusUpsList:(0,x.m9)(P),yourAddOns:P,cohort:M})})]})})})};const H=e=>{let{isLoading:n,olErrorAlert:t,heading:r,pageTitle:i,isTrial:l,tenureName:d,undoModule:o,handlePrimaryButtonClick:s,onDialogClose:c,addOnsIdList:u}=e;return(0,a.jsx)(h.tp,{...L.tr.overlay({pageTitle:i,isTrial:l,tenureName:d,heading:r,addOns:u}),children:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(F.Z,{forceImageFullWidth:!0,heading:null===o||void 0===o?void 0:o.heading,Alert:(0,a.jsx)(S.Z,{...t}),imageUrl:null===o||void 0===o?void 0:o.topImage,imageAlt:(0,g.m)(E,"undoPauseImageAlt"),pauseBenefits:null===o||void 0===o?void 0:o.reviewConditions,pauseDescription:null===o||void 0===o?void 0:o.descriptionParagraphs,hasStickyFooter:!0}),(0,a.jsx)(D,{primaryButtonText:null===o||void 0===o?void 0:o.primaryCTALabel,primaryButtonAction:s,primaryButtonAnalytics:L.tr.undoPauseClick({text:null===o||void 0===o?void 0:o.primaryCTALabel,heading:r,addOns:u}),secondaryButtonText:null===o||void 0===o?void 0:o.secondaryCTALabel,secondaryButtonAction:c,secondaryButtonAnalytics:L.tr.continuePauseClick({text:null===o||void 0===o?void 0:o.secondaryCTALabel,heading:r,addOns:u}),isLoading:n})]})})};var z=e=>{let{isOpen:n,setIsOpen:t,pageTitle:r,onClose:i}=e;const{isMobile:l}=(0,f.vP)(),{0:d,1:o}=(0,p.useState)(!1),{data:s,isFetching:c,isError:u}=(0,_.JX)({enabled:n,additionalQueryKey:"UNDO_PAUSE"}),m=(0,h.wG)(),{updateMembershipPauseStatus:A}=Y(),{0:S,1:P}=(0,p.useState)({}),I=()=>{P({}),t(!1),null===i||void 0===i||i()},j=(0,x.GP)(null===s||void 0===s?void 0:s.yourAddOns);if(c)return(0,a.jsx)(w.Z,{});const N=+("TRIAL"===(null===s||void 0===s?void 0:s.membershipStatus)),F=(null===s||void 0===s?void 0:s._tenureName.toLowerCase())||"",{module:M,planDetails:T}=s||{},B=!(u||"INITIATED"!==(null===s||void 0===s?void 0:s.pauseStatus))&&s&&M&&T,V=(null===M||void 0===M?void 0:M.title)||(0,g.m)(E,"undoPauseHeading"),D=(null===M||void 0===M?void 0:M.heading)||"";return(0,a.jsx)(y.ZP,{pageTitle:r,name:"manageMembership",moduleContext:"wplus",moduleLinkExtras:{mb:{tr:N,mt:F},pg:{nm:r},ta:{pt:r}},moduleViewExtras:{mb:{tr:N,mt:F},pg:{nm:r},ta:{pt:r}},"data-dca-id":"M:0564CE5E8D","data-dca-type":"module",children:(0,a.jsx)(v.Z,{children:(0,a.jsxs)(b.Z,{id:"undo-pause-membership-dialog",isOpen:n,onClose:I,title:(0,a.jsx)(k,{title:V}),desktopComponent:"panel",mobileComponent:"bottomsheet",position:"right",size:"medium",onLinkExtrasForClose:L.tr.onLinkExtrasForClose({heading:D,addOns:j}),closeButtonProps:l?void 0:{UNSAFE_className:"white mt2"},children:[!B&&(0,a.jsx)(C.m,{}),B&&(0,a.jsx)(H,{isLoading:d,olErrorAlert:S,heading:D,pageTitle:r,isTrial:N,tenureName:F,undoModule:M,handlePrimaryButtonClick:async()=>{var e,n;o(!0);const a=await A({pauseOperationType:"UNDO_PAUSE"});o(!1),!a||a.errors||(null===(e=a.data)||void 0===e||null===(n=e.updateMembershipPauseStatus)||void 0===n?void 0:n.error)?P({message:(0,g.m)(E,"generalAlert"),variant:"error",className:"mt2",...L.tr.undoMutationError({pageTitle:r,addOns:j})}):(m(L.tr.undoPauseAsync({pageTitle:r,isTrial:N,tenureName:F,addOns:j})),P({}),t(!1))},onDialogClose:I,addOnsIdList:j})]})})})};const q=p.createContext(void 0),X=e=>{let{fetchEnabled:n=!0,showToast:t=!1,successMessages:d,pageTitle:o,onClose:s,onSuccess:c,children:y}=e;var g;const[f,h]=p.useState(!1),[C,v]=p.useState(!1),[b,w]=p.useState(null),[A,E]=p.useState(null),[S,L]=p.useState(),[P,I]=p.useState(void 0),{addSnack:j}=(0,r.useSnackbar)(),N=!!(null===(g=(0,i.iC)(l.yF).wplus.values)||void 0===g?void 0:g.enablePauseMembership),{data:F}=u({enabled:n&&N}),M=e=>{w(e.pauseMembershipDetails),E(e.membershipStatus),void 0!==(null===e||void 0===e?void 0:e.hasActiveOrPausedPlusUps)&&I(e.hasActiveOrPausedPlusUps)},[T]=(0,m.N)({onSuccess:(e,n)=>{let{data:a,errors:r}=e,{input:i}=n;if(!r&&a.updateMembershipPauseStatus&&!a.updateMembershipPauseStatus.error){const{pauseDetails:e,membershipStatus:n}=a.updateMembershipPauseStatus;M({pauseMembershipDetails:e,membershipStatus:n});const r=(l=i.pauseOperationType,o=P,d&&d[l]?d[l]:o?x.Km[l]:x.LQ[l]);t&&r?j({message:r}):L(r),null===c||void 0===c||c()}var l,o}});return(0,p.useEffect)(()=>{(null===F||void 0===F?void 0:F.data.membership)&&M({pauseMembershipDetails:F.data.membership.pauseMembershipDetails,membershipStatus:F.data.membership.status})},[null===F||void 0===F?void 0:F.data.membership]),(0,a.jsxs)(q.Provider,{value:{isResumeDialogOpen:f,setIsResumeDialogOpen:h,isUndoPauseDialogOpen:C,setIsUndoPauseDialogOpen:v,pauseMembershipDetails:b,membershipStatus:A,setPauseMembershipData:M,pauseMessage:S,updateMembershipPauseStatus:e=>{let{pauseOperationType:n,paymentPreferenceId:t}=e;return T({input:{paymentPreferenceId:t,pauseOperationType:n}})},pageTitle:o},children:[y,N&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(Z,{pageTitle:o,isResumeDialogOpen:f,setIsResumeDialogOpen:h,onClose:s}),(0,a.jsx)(z,{pageTitle:o,isOpen:C,setIsOpen:v,onClose:s})]})]})},Y=()=>{const e=p.useContext(q);if(!e)throw new Error("You need to use this context inside of 'PauseMembershipContextProvider'");return e}},875710:function(e,n,t){t.d(n,{Z:function(){return H}});var a={};t.r(a),t.d(a,{addCard:function(){return C},addPaymentMethod:function(){return E},change:function(){return h},changePaymentMethod:function(){return S},endingIn:function(){return b},endingVisa:function(){return f},expires:function(){return w},goToAccount:function(){return P},noCardText:function(){return v},payments:function(){return L},selectCard:function(){return A},toUpdatePaymentMethods:function(){return I}});var r=t(487954),i=t(522037),l=t(620769),d=t.n(l),o=t(194742),s=t(155394),c=t(682081),u=t(764766),m=t(200421),p=t(976973),x=t(91726),y=t(918099),g=t(35088);const f=e=>"Ending in "+e.endingVisaNumber,h=()=>"Change",C=()=>"Add card",v=()=>"No card on file",b=()=>"Ending in",w=e=>"Expires "+e.month+"/"+e.year,A=()=>"Select card",E=()=>"Add payment method",S=()=>"Change payment method",L=()=>"Payments",P=()=>"Go to account",I=()=>" to add or edit payment methods.";var j=t(714818),N=t(489927);var F=e=>{let{id:n,lastFour:t,cardType:i,expiryMonth:l,expiryYear:d,firstName:o,lastName:s,selectedCardId:u,setSelectedCardId:m,instrumentMetaData:p}=e;return(0,r.jsxs)("div",{className:"flex items-center pv3 bt b--near-white","data-testid":"subscription-payment-tile-".concat(n),children:[(0,r.jsx)("div",{children:(0,r.jsx)(j.Z,{a11yLabelledBy:"ending-in-".concat(t,"-type-").concat(i),checked:u===n,"data-testid":"subscription-payment-tile-radio-".concat(n),name:"subscription-payment-tile-radio",onChange:()=>null===m||void 0===m?void 0:m(n),value:t})}),(0,r.jsxs)("div",{className:"flex items-center",id:"ending-in-".concat(t,"-type-").concat(i),children:[(0,r.jsx)("div",{className:"mh3",children:(0,r.jsx)(N.I,{logoSize:{width:48,height:32},cardType:i,instrumentMetaData:p})}),(0,r.jsxs)("div",{className:"flex flex-column items-left mh1 w-60",children:[(0,r.jsx)("p",{className:"lh-solid pa0 b mv1 f6",children:"".concat((0,c.m)(a,"endingIn")," ").concat(t)}),(0,r.jsx)("p",{className:"lh-solid pa0 f6 mv1",children:(0,c.m)(a,"expires",{month:l?String(l).padStart(2,"0"):"",year:d?String(d).slice(-2):""})}),(0,r.jsxs)("p",{className:"lh-solid pa0 f6 mv1",children:[o," ",s]})]})]})]},n)};var M=e=>{let{listData:n,selectedCardId:t,setSelectedCardId:a}=e;return void 0===n||0===n.length?null:(0,r.jsx)(r.Fragment,{children:n.map(e=>(0,r.jsx)(F,{...e,selectedCardId:t,setSelectedCardId:a},e.id))})};var T=e=>{let{selectedCardId:n,paymentPreferenceId:t,setSelectedCardId:i,setPaymentCollections:l,isCoreSignupWallet:d,onChangePayment:f,buttonLinkExtras:h,className:C,ctaAddCardButton:v,ctaChangeButton:b,encourageCardChange:w,ctaAddCardButtonVariant:A,isPartnerPage:E=!1,linkText:S,linkTextStyle:L}=e;const[P,I]=o.useState(!1),{isFetching:j,data:N}=(0,g.p)({}),{router:F}=(0,u.tv)(),T=o.useMemo(()=>{var e,n;const t={cards:void 0,payPals:void 0};return t.cards=null===N||void 0===N?void 0:N.wallet.paymentGroups.creditCard.payments.filter(e=>{let{isExpired:n}=e;return!n}),(null===(e=null===N||void 0===N?void 0:N.wallet.paymentGroups)||void 0===e||null===(n=e.payPalBA)||void 0===n?void 0:n.payments)&&(t.payPals=N.wallet.paymentGroups.payPalBA.payments),t},[N]);o.useEffect(()=>{(void 0!==T.cards&&T.cards.length>0||void 0!==T.payPals&&T.payPals.length>0)&&l(T)},[T,l]),o.useEffect(()=>{var e,n;const a=null===(e=T.cards)||void 0===e?void 0:e.find(e=>{let{id:n}=e;return n===t});a&&(null===i||void 0===i||i(a.id));const r=null===(n=T.payPals)||void 0===n?void 0:n.find(e=>{let{id:n}=e;return n===t});r&&(null===i||void 0===i||i(r.id))},[T,t,i]);const B=()=>I(!1),V=void 0===T.cards||0===T.cards.length,_=()=>{d&&f?f():V?(F.push("/wallet"),B()):I(!0)},D=(0,c.m)(a,n?"changePaymentMethod":"addPaymentMethod"),k=n?b||"change":v||"add",O=(e,n)=>!(!e||!n)||!e,R=(0,c.m)(a,O(n,w)?"addPaymentMethod":"changePaymentMethod"),W=O(n,w)?v||"add":b||"change",U=(0,r.jsx)(m.Z,{onClick:_,onLinkExtras:h,variant:"tertiary",onLinkName:W,"aria-label":R,"data-dca-id":"B:6828A7FDD9","data-dca-intent":"__DCA_TBD__",children:b||(0,c.m)(a,"change")}),G=(0,r.jsx)(m.Z,{className:C||"bn sans-serif pa3 tc f6",onClick:_,onLinkExtras:h,variant:A||"primary",onLinkName:W,"aria-label":"tertiary"===A?(0,c.m)(a,"changePaymentMethod"):R,"data-dca-id":"B:256BC00553","data-dca-intent":"__DCA_TBD__",children:v||(0,c.m)(a,"addCard")});return(0,r.jsxs)(r.Fragment,{children:[E?(0,r.jsx)(r.Fragment,{children:O(n,w)?G:U}):(0,r.jsx)(m.Z,{className:C||"",variant:"tertiary",onClick:()=>{_()},onLinkName:k,onLinkExtras:h,"aria-label":D,style:L,"data-dca-id":"B:B8B47C8F9B","data-dca-intent":"__DCA_TBD__",children:n?S||b||(0,c.m)(a,"change"):S||v||(0,c.m)(a,"addCard")}),(0,r.jsxs)(p.Z,{title:(0,c.m)(a,"payments"),isOpen:P,onClose:B,size:"medium",position:"right",desktopComponent:"panel",children:[(0,r.jsxs)("p",{className:"ma0",children:[(0,r.jsx)(x.ZP,{href:"/wallet",target:"_blank",className:"black",onClick:B,"data-dca-id":"L:91640A1BF3",children:(0,c.m)(a,"goToAccount")}),(0,c.m)(a,"toUpdatePaymentMethods")]}),(0,r.jsxs)("div",{className:"mt3 mt4-l",children:[(0,r.jsx)(M,{listData:null===T||void 0===T?void 0:T.cards,selectedCardId:n,setSelectedCardId:i}),(0,r.jsx)(s.Divider,{UNSAFE_className:"b--near-white"}),(0,r.jsx)(m.Z,{isFullWidth:!0,className:"mt3 mt4-l",onClick:B,size:"medium",variant:"primary",disabled:j,leading:j?(0,r.jsx)(y.$,{color:"white",size:"small"}):null,"data-dca-id":"B:CBA34ACA45","data-dca-intent":"__DCA_TBD__",children:(0,c.m)(a,"selectCard")})]})]})]})};const B=e=>(0,c.m)(a,"endingVisa",{endingVisaNumber:e}),V="calc(100% - 80px)",_=e=>{let{selectedCard:n,selectedPayPal:t}=e;const a={pp:0,type:"n/a",dp:"false",pe:"false"};if(null===n||void 0===n?void 0:n.cardType){const{cardType:e,isDefault:t}=n;a.dp=t?"true":"false",a.type=e,a.pe="false"}else t&&(a.pp=1,a.type="paypal",a.pe="true");return{yl:a}},D=e=>{let{name:n,moduleName:t,tenure:a,status:r,requireConsent:i,inHome:l,currentCohortName:d,addons:o,contentZone:s,type:c,ppn:u,adid:m,adpgm:p}=e;return{mb:{mt:r,tn:a,qc:i,an:o,ih:l?"1":"0",ppn:u},ta:{pt:"manageMembership"},co:{ii:d,zn:s||"",ty:c,nm:t,adid:m,adpgm:p},li:{nm:n}}},k=(e,n,t,a)=>({nm:e&&n?a||"add":t||"change"}),O=e=>{let{selectedCardId:n,ctaChangeButton:t,ctaAddCardButton:a}=e;return{nm:n?t||"change":a||"add"}},R=e=>{let{lastFour:n,cardType:t,instrumentMetaData:r,isCompact:i,isWcpEnabled:l}=e;var d;if(!n)return(0,c.m)(a,"noCardText");if(!i||l)return B(n);if(t&&"unknown"!==t.toLowerCase())return"".concat(t," ").concat(n);const o=null===r||void 0===r||null===(d=r.brand)||void 0===d?void 0:d.name;return o&&"unknown"!==o.toLowerCase()?"".concat(o," ").concat(n):B(n)};var W=t(444002);const U=e=>{let{cardType:n,lastFour:t,selectedPayPal:a,instrumentMetaData:i,PaymentsSharedCardLabel:l,isPaypal:d,isCompact:o,isWcpEnabled:c}=e;return(0,r.jsx)("div",{children:(0,r.jsx)(s.VisuallyHidden,{children:(0,r.jsx)("div",{children:d?(0,r.jsxs)("div",{children:[(0,r.jsx)(N.I,{logoSize:{width:60,height:16},color:"dark",cardType:"PAYPAL"}),(0,r.jsx)("div",{children:null===a||void 0===a?void 0:a.emailAddress})]}):(0,r.jsxs)("div",{children:[n||i?(0,r.jsx)(N.I,{color:"dark",cardType:n,instrumentMetaData:i,ariaHidden:!0}):(0,r.jsx)(W.J,{"aria-hidden":!0,name:"CreditCard",size:"medium"}),(0,r.jsx)("div",{children:R({lastFour:t,cardType:n,instrumentMetaData:i,isCompact:o,isWcpEnabled:c})}),l&&(0,r.jsx)(l,{})]})})})})},G=e=>{let{cardType:n,lastFour:t,selectedPayPal:a,instrumentMetaData:i,PaymentsSharedCardLabel:l,descriptionStyle:o,isPaypal:s,isCompact:c,isWcpEnabled:u}=e;return s?(0,r.jsxs)("div",{className:d()("flex flex-column",{"flex-row items-end":c}),style:{width:V,maxWidth:V},children:[(0,r.jsx)(N.I,{ariaHidden:c,logoSize:{width:60,height:16},color:"dark",cardType:"PAYPAL"}),(0,r.jsx)("div",{className:d()("flex justify-between items-center",{mt0:c,mt2:!c}),children:(0,r.jsx)("span",{className:d()("f5 truncate",{"flex ml2":c}),children:(0,r.jsx)("strong",{className:"dark-gray",style:o,"aria-hidden":c,children:null===a||void 0===a?void 0:a.emailAddress})})})]}):(0,r.jsxs)("div",{className:"flex items-center",children:[n||i?(0,r.jsx)(N.I,{logoSize:{height:20,width:32},color:"dark",cardType:n,instrumentMetaData:i,ariaHidden:c}):(0,r.jsx)(W.J,{"aria-hidden":!0,name:"CreditCard",size:"medium"}),(0,r.jsx)("div",{"aria-hidden":c?"true":void 0,className:d()("f6 f5-m ml2 flex-auto dark-gray",{b:t&&!c}),style:o,children:R({lastFour:t,cardType:n,instrumentMetaData:i,isCompact:c,isWcpEnabled:u})}),l&&(0,r.jsx)(l,{})]})},Z=e=>{let{children:n,condition:t,wrapper:a}=e;return t?a(n):n};var H=function(e){let{instrumentMetaData:n,cardType:t,lastFour:a,paypal:l,paymentPreferenceId:s,selectedCardId:c,setSelectedCardId:u,Alert:m,heading:p,headingStyle:x,linkText:y,linkTextStyle:g,descriptionStyle:f,description:h,showChangePaymentLink:C=!1,isCoreSignupWallet:v=!1,onChangePayment:b,className:w,PaymentsSharedCardLabel:A,ctaAddCardButton:E,ctaAddCardButtonVariant:S,ctaChangeButton:L,isCompact:P,encourageCardChange:I,isPartnerPage:j,editCardBeaconDataV2:N,wrappingStyle:F,membershipStatus:M,membershipTenure:B,requireConsent:V,isWcpEnabled:R}=e;var W;const[H,z]=o.useState({cards:void 0,payPals:void 0}),q=null===H||void 0===H||null===(W=H.cards)||void 0===W?void 0:W.find(e=>e.id===c),{cardType:X,lastFour:Y,instrumentMetaData:K}=(e=>{let{_instrumentMetaData:n,_cardType:t,_lastFour:a,selectedCard:r}=e;return{cardType:t||(null===r||void 0===r?void 0:r.cardType),lastFour:a||(null===r||void 0===r?void 0:r.lastFour),instrumentMetaData:n||(null===r||void 0===r?void 0:r.instrumentMetaData)}})({_instrumentMetaData:n,_cardType:t,_lastFour:a,selectedCard:q}),J=(e=>{let{_paypal:n,paymentCollections:t,selectedCardId:a}=e;var r;return n||(null===t||void 0===t||null===(r=t.payPals)||void 0===r?void 0:r.find(e=>e.id===a))})({paymentCollections:H,_paypal:l,selectedCardId:c}),Q=!!J&&!X,$=(e=>{let{selectedCardId:n,encourageCardChange:t,ctaChangeButton:a,ctaAddCardButton:r,selectedCard:i,selectedPayPal:l,membershipStatus:d,membershipTenure:o,requireConsent:s,isPartnerPage:c,isCompact:u,isCoreSignupWallet:m,isWcpEnabled:p,editCardBeaconDataV2:x}=e;const y=!(!i||!p)&&i.isDefault;return{li:c?k(n,t,a,r):O({selectedCardId:n,ctaChangeButton:a,ctaAddCardButton:r}),...(u?D({...x}):void 0),...(m?_({selectedCard:i,selectedPayPal:l}):void 0),...(p&&{md:{mbt:d||(null===x||void 0===x?void 0:x.status),tn:o||(null===x||void 0===x?void 0:x.tenure),qc:s},nm:O({selectedCardId:n,ctaChangeButton:a,ctaAddCardButton:r}),co:{dp:y?"true":"false"}})}})({selectedCardId:c,encourageCardChange:I,ctaChangeButton:L,ctaAddCardButton:E,selectedCard:q,selectedPayPal:J,membershipStatus:M,membershipTenure:B,requireConsent:V,isPartnerPage:j,isCompact:P,isCoreSignupWallet:v,isWcpEnabled:R,editCardBeaconDataV2:N});return(0,r.jsx)(Z,{condition:v||!!R,wrapper:e=>(0,r.jsx)(i.ZP,{name:"wPlus",moduleContext:"wplus",shouldSuppressModuleView:!0,"data-dca-id":"M:92A7D74684","data-dca-type":"module",children:e}),children:(0,r.jsxs)(r.Fragment,{children:[p&&(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("h3",{className:d()("f6 f5-m mb0 dark-gray"),style:P?{lineHeight:"24px",paddingBottom:"6px"}:{},children:(0,r.jsx)("span",{style:x,children:p})}),P&&(0,r.jsx)(U,{cardType:X,lastFour:Y,selectedPayPal:J,instrumentMetaData:K,PaymentsSharedCardLabel:A,isPaypal:Q,isCompact:P,isWcpEnabled:R}),C&&P&&(0,r.jsx)(T,{paymentPreferenceId:s,setPaymentCollections:z,selectedCardId:c,setSelectedCardId:u,onChangePayment:b,isCoreSignupWallet:v,buttonLinkExtras:$,className:"pa0",ctaAddCardButton:E,ctaChangeButton:L,linkText:y,linkTextStyle:g})]}),m,(0,r.jsxs)("div",{className:d()("flex items-center justify-between",{"mt-3":!P}),style:F,children:[(0,r.jsx)(G,{cardType:X,lastFour:Y,selectedPayPal:J,instrumentMetaData:K,PaymentsSharedCardLabel:A,descriptionStyle:f,isPaypal:Q,isCompact:P,isWcpEnabled:R}),C&&!P&&(0,r.jsx)(T,{isPartnerPage:j,paymentPreferenceId:s,setPaymentCollections:z,selectedCardId:c,setSelectedCardId:u,onChangePayment:b,isCoreSignupWallet:v,buttonLinkExtras:$,className:w,ctaAddCardButton:E,ctaAddCardButtonVariant:S,ctaChangeButton:L,encourageCardChange:I})]}),!v&&h&&(0,r.jsx)("p",{className:"gray f7 mv3",children:h})]})})}}}]);