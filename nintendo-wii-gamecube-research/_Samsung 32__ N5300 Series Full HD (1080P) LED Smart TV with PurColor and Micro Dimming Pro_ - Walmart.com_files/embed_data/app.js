var e=globalThis;function n(e,t){return t.forEach((function(t){t&&"string"!=typeof t&&!Array.isArray(t)&&Object.keys(t).forEach((function(n){if("default"!==n&&!(n in e)){var i=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,i.get?i:{enumerable:!0,get:function(){return t[n]}})}}))})),Object.freeze(e)}var i="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==e?e:"undefined"!=typeof self?self:{};function r(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function o(e){return e&&Object.prototype.hasOwnProperty.call(e,"default")&&1===Object.keys(e).length?e.default:e}var s,a,l,c,u,d={},h={};u||(u=1,function(){if(s)return d;s=1;const e=(()=>{let e,t=[];do{e=e?e.parent:window.parent,t.push(e)}while(e!==window.top);return t})();function t(t,n="*"){e.forEach((e=>{try{null!=e&&e.postMessage&&e.postMessage(t,n)}catch(e){console.warn("No postMessage function available. Message not sent.")}}))}var n,i;window.eko=window.eko||{},window.eko.postMessageImpl=window.eko.postMessageImpl||((null===(n=window.eko)||void 0===n||null===(n=n.environment)||void 0===n||null===(n=n.embeddingApp)||void 0===n?void 0:n.includes("android"))?n=>{e.forEach((e=>{try{var t;null!=e&&null!==(t=e.deviceBridge)&&void 0!==t&&t.postMessage&&e.deviceBridge.postMessage(JSON.stringify(n))}catch(e){console.warn("Failed to use Walmart App native postMessage function")}})),t(n)}:(null===(i=window.eko)||void 0===i||null===(i=i.environment)||void 0===i||null===(i=i.embeddingApp)||void 0===i?void 0:i.includes("ios"))?n=>{e.forEach((e=>{try{var t;null!=e&&null!==(t=e.webkit)&&void 0!==t&&null!==(t=t.messageHandlers)&&void 0!==t&&null!==(t=t.deviceBridge)&&void 0!==t&&t.postMessage&&e.webkit.messageHandlers.deviceBridge.postMessage(JSON.stringify(n))}catch(e){console.warn("Failed to use Walmart App native postMessage function")}})),t(n)}:t)}(),a||(a=1,window.eko=window.eko||{},window.eko.getIdentifiers=function(){var e,t,n,i,r,o;let s=`${null===(e=(t=window).EkoAnalytics)||void 0===e?void 0:e.call(t,"getSid")}_${null===(n=(i=window).EkoAnalytics)||void 0===n?void 0:n.call(i,"getPageViewId")}`;return window.eko.activeExperiment&&(s=`${s}_${window.eko.activeExperiment.experimentid}_${window.eko.activeExperiment.experimentvariant}`),{userId:null===(r=(o=window).EkoAnalytics)||void 0===r?void 0:r.call(o,"getUid"),sessionId:s}}),function(){if(l)return h;l=1;const e=navigator&&navigator.userAgent&&navigator.userAgent.includes("- ekoNativeSDK/");window.eko=window.eko||{},window.eko.postMessage=window.eko.postMessage||function(t,n="*"){let i={identifiers:window.eko.getIdentifiers&&window.eko.getIdentifiers()};i.event=t.event,i.embedid=t.embedid||"ekoembed",i.embedapi=t.embedapi||"2.0",void 0!==t.args&&(i.args=Array.isArray(t.args)?t.args:[t.args]),i.args=i.args||[],e?window.nativeSdk.postMessage(JSON.stringify(i)):window.eko.postMessageImpl(i,n)}}(),c||(c=1,window.eko=window.eko||{},window.eko.embedApi=window.eko.embedApi||new class{constructor(){this.DEFAULT_EMBED_ID="ekoembed",this.DEFAULT_API_VERSION="2.0",this.IDENTIFIER="eko.embedapi",this.msgHandlers={};let e=new URLSearchParams(window.location.search);return this.urlSearchParamsObject=Object.fromEntries(e),window.addEventListener("message",this.onMessage.bind(this)),{TYPES:this.TYPES,sendMsg:this.sendMsg.bind(this),on:this.on.bind(this),once:this.once.bind(this),off:this.off.bind(this)}}onMessage(e){let t=e.data;if(t.target===this.IDENTIFIER){let e=t.type;this.isValidMsgType(e)?this.msgHandlers[e]&&this.msgHandlers[e].forEach((e=>{e(t.data)})):console.warn(`[embedApiV2] - Unknown type "${e}", ignoring received message.`)}}isValidMsgType(e){return Object.values(this.TYPES).includes(e)}numberToKbpsString(e){return parseInt((e/1e3).toFixed(0),10).toLocaleString()+" kbps"}addPerformanceData(e){var t;const n=window.player,i=null==n||null===(t=n.currentNode)||void 0===t||null===(t=t.segment)||void 0===t?void 0:t.chosenRepresentation;if(null!=i&&i.components){const t=Object.keys(i.components).find((e=>{var t;return null===(t=i.components[e].mimeType)||void 0===t?void 0:t.includes("video")})),r=i.components[t];r&&(e.performance={chosenBitrate:this.numberToKbpsString(r.bandwidth)||"",chosenResolution:r.label||"",FPS:n.qoe.envFps||"",QOE:n.qoe.score||"",measuredBandwidth:this.numberToKbpsString(r.measuredBandwidth)})}}get TYPES(){return{LOADER_DONE:"eko.loader.done",INTERACTION:"eko.project.interaction",BLOCK_START:"eko.project.blockstart",BLOCK_DONE:"eko.project.blockdone",METRICS_FID:"eko.metrics.fid",PLAYING:"eko.project.playing",PAUSE:"eko.project.pause",USER_PAUSE:"eko.project.userpause",USER_PLAY:"eko.project.userplay",LOAD_START:"eko.project.loadstart",CAN_PLAY:"eko.project.canplay",SWIPE:"eko.project.swipe",PROJECT_STARTED:"eko.project.started",BLOCK_EVENT:"eko.block.event",LOAD:"eko.load",INVOKE_ACTION:"eko.project.invokeaction",PLAYER_INVOKE:"eko.player.invoke",PROJECT_INVOKE:"eko.project.invoke",BLOCK_INVOKE:"eko.block.invoke",MODULE_INVOKE:"eko.module.invoke"}}sendMsg(e,t){var n,i;if(!this.isValidMsgType(e))return void console.warn(`[embedApiV2] - Unknown type "${e}", ignoring sending message.`);let r={source:this.IDENTIFIER,type:e,data:t,embedId:(null===(n=this.urlSearchParamsObject)||void 0===n?void 0:n.embedid)||this.DEFAULT_EMBED_ID,embedApiVersion:(null===(i=this.urlSearchParamsObject)||void 0===i?void 0:i.embedapi)||this.DEFAULT_API_VERSION,queryparams:this.urlSearchParamsObject,identifiers:window.eko.getIdentifiers&&window.eko.getIdentifiers()};this.addPerformanceData(r),window.eko.postMessageImpl(r)}on(e,t){this.msgHandlers[e]=this.msgHandlers[e]||[],this.msgHandlers[e].push(t)}once(e,t){this.msgHandlers[e]=this.msgHandlers[e]||[];let n=(...i)=>{this.off(e,n),t(...i)};this.msgHandlers[e].push(n)}off(e,t){this.msgHandlers[e]=this.msgHandlers[e]||[],this.msgHandlers[e]=this.msgHandlers[e].filter((e=>e!==t))}}));class p{constructor(e){if(e||(e={}),"object"!=typeof e)throw Error("Context constructor expect an object as an input");this.ctx=e}set(e,t){this.ctx[e]=t||e}get(e){return e?this.ctx[e]:this.ctx}}window.eko=window.eko||{};const f=window.eko.params;var g=function(e){return f[e]};window.eko=window.eko||{},g("csp")?window.eko.loaderCspPromise=function(){const{embedid:e,embedapi:t}=g("embedParams");return e&&t||console.warn(`[loaderCspPromise] Missing embedid ${e} or embedapi ${t},\n                        won't be able to comuunicate with "postMessage()"`),new Promise((n=>{const i=function(r){let o=r.data;"loader"===o.target&&(window.eko.postMessage({event:"loader.csp.accept",args:[],embedid:e,embedapi:t}),window.removeEventListener("message",i),n(o.csp))};window.addEventListener("message",i),window.eko.postMessage({event:"loader.csp.ready",args:[],embedid:e,embedapi:t})}))}():window.eko.loaderCspPromise=Promise.resolve({});var m=async function(e){return(await window.eko.loaderCspPromise)[e]};let y=new URLSearchParams(window.location.hash.slice(1));window.addEventListener("hashchange",(()=>{y=new URLSearchParams(window.location.hash.slice(1))}));const v={get:function(e){return y.get(e)},has:function(e){return y.has(e)},set:function(e,t=""){y.set(e,t)},apply:function(){window.location.hash=y.toString()}};var b,w;window.eko=window.eko||{},window.eko.hashParams=v;var k,x=function(){if(w)return b;var e,t,n,i,r,o,s;w=1;const a=function(...e){const t=new Promise(...e);let n={state:"pending"};return t.then((e=>{n.state="fulfilled",n.value=e}),(e=>{n.state="rejected",n.reason=e})),t.done=t.then,t.inspect=()=>n,t};(a.prototype=Object.assign(a.prototype,Promise.prototype)).constructor=a,a.all=null===(e=Promise.all)||void 0===e?void 0:e.bind(a),a.allSettled=null===(t=Promise.allSettled)||void 0===t?void 0:t.bind(a),a.any=null===(n=Promise.any)||void 0===n?void 0:n.bind(a),a.race=null===(i=Promise.race)||void 0===i?void 0:i.bind(a),a.resolve=null===(r=Promise.resolve)||void 0===r?void 0:r.bind(a),a.reject=null===(o=Promise.reject)||void 0===o?void 0:o.bind(a),a.withResolvers=null===(s=Promise.withResolvers)||void 0===s?void 0:s.bind(a);const l=e=>a.resolve(e);return l.promise=(...e)=>new a(...e),l.Promise=a,l.all=a.all.bind(a),l.resolve=a.resolve.bind(a),l.reject=a.reject.bind(a),l.defer=()=>{let e,t;const n=new a(((n,i)=>{e=n,t=i}));return{resolve:e,reject:t,promise:n}},b=l}(),S=r(x),C={exports:{}},_=C.exports,E=(k||(k=1,function(e){!function(t,n){e.exports?e.exports=n():t.log=n()}(_,(function(){var e=function(){},t="undefined",n=typeof window!==t&&typeof window.navigator!==t&&/Trident\/|MSIE /.test(window.navigator.userAgent),i=["trace","debug","info","warn","error"],r={},o=null;function s(e,t){var n=e[t];if("function"==typeof n.bind)return n.bind(e);try{return Function.prototype.bind.call(n,e)}catch(t){return function(){return Function.prototype.apply.apply(n,[e,arguments])}}}function a(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function l(){for(var n=this.getLevel(),r=0;r<i.length;r++){var o=i[r];this[o]=r<n?e:this.methodFactory(o,n,this.name)}if(this.log=this.debug,typeof console===t&&n<this.levels.SILENT)return"No console available for logging"}function c(e){return function(){typeof console!==t&&(l.call(this),this[e].apply(this,arguments))}}function u(i,r,o){return function(i){return"debug"===i&&(i="log"),typeof console!==t&&("trace"===i&&n?a:void 0!==console[i]?s(console,i):void 0!==console.log?s(console,"log"):e)}(i)||c.apply(this,arguments)}function d(e,n){var s,a,c,d=this,h="loglevel";function p(){var e;if(typeof window!==t&&h){try{e=window.localStorage[h]}catch(e){}if(typeof e===t)try{var n=window.document.cookie,i=encodeURIComponent(h),r=n.indexOf(i+"=");-1!==r&&(e=/^([^;]+)/.exec(n.slice(r+i.length+1))[1])}catch(e){}return void 0===d.levels[e]&&(e=void 0),e}}function f(e){var t=e;if("string"==typeof t&&void 0!==d.levels[t.toUpperCase()]&&(t=d.levels[t.toUpperCase()]),"number"==typeof t&&t>=0&&t<=d.levels.SILENT)return t;throw new TypeError("log.setLevel() called with invalid level: "+e)}"string"==typeof e?h+=":"+e:"symbol"==typeof e&&(h=void 0),d.name=e,d.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},d.methodFactory=n||u,d.getLevel=function(){return null!=c?c:null!=a?a:s},d.setLevel=function(e,n){return c=f(e),!1!==n&&function(e){var n=(i[e]||"silent").toUpperCase();if(typeof window!==t&&h){try{return void(window.localStorage[h]=n)}catch(e){}try{window.document.cookie=encodeURIComponent(h)+"="+n+";"}catch(e){}}}(c),l.call(d)},d.setDefaultLevel=function(e){a=f(e),p()||d.setLevel(e,!1)},d.resetLevel=function(){c=null,function(){if(typeof window!==t&&h){try{window.localStorage.removeItem(h)}catch(e){}try{window.document.cookie=encodeURIComponent(h)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch(e){}}}(),l.call(d)},d.enableAll=function(e){d.setLevel(d.levels.TRACE,e)},d.disableAll=function(e){d.setLevel(d.levels.SILENT,e)},d.rebuild=function(){if(o!==d&&(s=f(o.getLevel())),l.call(d),o===d)for(var e in r)r[e].rebuild()},s=f(o?o.getLevel():"WARN");var g=p();null!=g&&(c=f(g)),l.call(d)}(o=new d).getLogger=function(e){if("symbol"!=typeof e&&"string"!=typeof e||""===e)throw new TypeError("You must supply a name when creating a logger.");var t=r[e];return t||(t=r[e]=new d(e,o.methodFactory)),t};var h=typeof window!==t?window.log:void 0;return o.noConflict=function(){return typeof window!==t&&window.log===o&&(window.log=h),o},o.getLoggers=function(){return r},o.default=o,o}))}(C)),C.exports),T=r(E),P=void 0!==e?e:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{};const I="undefined"!=typeof self&&self||"undefined"!=typeof window&&window||void 0!==P&&P,A=I&&I.performance,O=A&&"function"==typeof A.now?()=>A.now():()=>Date.now();function L(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var N=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function R(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}}function D(e,t,n,i){return t=t||"&",n=n||"=",null===e&&(e=void 0),"object"==typeof e?M(F(e),(function(i){var r=encodeURIComponent(R(i))+n;return N(e[i])?M(e[i],(function(e){return r+encodeURIComponent(R(e))})).join(t):r+encodeURIComponent(R(e[i]))})).join(t):i?encodeURIComponent(R(i))+n+encodeURIComponent(R(e)):""}function M(e,t){if(e.map)return e.map(t);for(var n=[],i=0;i<e.length;i++)n.push(t(e[i],i));return n}var F=Object.keys||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t};function B(e,t,n,i){n=n||"=";var r={};if("string"!=typeof e||0===e.length)return r;var o=/\+/g;e=e.split(t=t||"&");var s=1e3;i&&"number"==typeof i.maxKeys&&(s=i.maxKeys);var a=e.length;s>0&&a>s&&(a=s);for(var l=0;l<a;++l){var c,u,d,h,p=e[l].replace(o,"%20"),f=p.indexOf(n);f>=0?(c=p.substr(0,f),u=p.substr(f+1)):(c=p,u=""),d=decodeURIComponent(c),h=decodeURIComponent(u),L(r,d)?N(r[d])?r[d].push(h):r[d]=[r[d],h]:r[d]=h}return r}var U={encode:D,stringify:D,decode:B,parse:B};function j(e){return"boolean"==typeof e?e:"string"==typeof e?"true"===(e=e.toLowerCase().trim())||"yes"===e||"1"===e:!!e}function z(e){return"string"==typeof e&&("true"===(e=e.toLowerCase().trim())||"false"===e||"yes"===e||"no"===e||"1"===e||"0"===e)}var V={parseBool:j,isBoolString:z};function W(e){var t;if(e&&"string"==typeof e)for(var n in t=U.parse(e))""===t[n]?t[n]=!0:isNaN(t[n])?V.isBoolString(t[n])&&(t[n]=V.parseBool(t[n])):t[n]=Number(t[n]);return t||{}}let H={};I&&I.location&&I.location.search&&I.location.search.length>1&&(H=W(I.location.search.slice(1)));var $=H;function G(e,t){const n=I.URL||I.webkitURL,i=I.Blob,r=I.Worker;if(!n||!i||!r)return t&&t.error("Workers are not supported on current environment."),null;if(!e)return t&&t.error("Must supply script text in order to create a worker."),null;const o=new i([e],{type:"text/javascript"}),s=n.createObjectURL(o);return t&&t.info("Creating worker with URL: "+s),new r(s)}let q=null;function Y(){if(null===q){let e=null;try{e=G(" "),e&&(q=!0,e.terminate())}catch(e){q=!1}}return q}function K(){return!!("undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self&&self instanceof WorkerGlobalScope)}var X={makeWorker:G,canSpawnWorker:Y,isInWorkerContext:K};let Q=T;var Z={},J={};function ee(e){e&&e.log&&(Array.isArray(e.log)?e.log.join(","):"string"==typeof e.log&&e.log||"").split(",").forEach((function(e){var t=e&&e.split(":")||[],n=t[0]||"",i=t[1]||"trace";if(n&&"function"==typeof n.toLowerCase){var r=n.toLowerCase();Z[r]=i,J.hasOwnProperty(r)&&J[r].forEach((function(e){e.setLevel(i)}))}}))}function te(e){if("number"==typeof e&&(0===e||1===e||2===e||3===e||4===e||5===e))return e;var t=0;if("string"!=typeof e)return t;switch(e.toLowerCase().trim()){case"enable":case"enabled":case"trace":t=0;break;case"debug":case"log":t=1;break;case"info":t=2;break;case"warn":t=3;break;case"error":t=4;break;case"disable":case"disabled":t=5}return t}var ne=0,ie="";X.isInWorkerContext()||ee($);var re=O(),oe=!0,se=self&&self.performance&&"function"==typeof self.performance.now?()=>`[${(self.performance.now()/1e3).toFixed(3)}]\t`:()=>`[${((O()-re)/1e3).toFixed(3)}]\t`;function ae(e,t){e&&"string"==typeof e&&Z.hasOwnProperty(e.toLowerCase())&&(t=Z[e.toLowerCase()]);var n="["+e+"] ",i=!0,r=te(t);function o(e){return e instanceof Error?(e.message=o(e.message),e):(oe?se():"")+ie+n+e}function s(e){i&&r<=0&&(arguments[0]=o(e),Q.trace.apply(null,arguments))}function a(e){i&&r<=1&&(arguments[0]=o(e),Q.debug.apply(null,arguments))}function l(e){i&&r<=2&&(arguments[0]=o(e),Q.info.apply(null,arguments))}function c(e){i&&r<=3&&(arguments[0]=o(e),Q.warn.apply(null,arguments))}function u(e){i&&r<=4&&(arguments[0]=o(e),Q.error.apply(null,arguments))}function d(e){return function(t){arguments[0]=o(t),Q[e].apply(null,arguments)}}s.force=d("trace"),a.force=d("debug"),l.force=d("info"),c.force=d("warn"),u.force=d("error");var h={trace:s,debug:a,log:a,info:l,warn:c,error:u,setLevel:function(e){r=te(e)},getIntLevel:function(){return r},disable:function(){i=!1},enable:function(){i=!0}};if(e&&"string"==typeof e){var p=e.toLowerCase();J.hasOwnProperty(p)||(J[p]=[]),J[p].push(h)}return h}function le(){Q.enableAll()}function ce(){Q.disableAll()}function ue(e){Q.setLevel(e)}function de(e,t){var n=e&&"string"==typeof e&&e.toLowerCase()||"";n&&J.hasOwnProperty(n)&&J[n].forEach((function(e){e.setLevel(t||"trace")}))}function he(){oe=!0}function pe(){oe=!1}function fe(){var e=Q.getLogger("logger"+ne++);e.getLogger=Q.getLogger,Q=e}function ge(e){"string"==typeof e&&(ie=e)}const me={createLogger:ae,enableAll:le,disableAll:ce,setLevel:ue,setInstanceLevel:de,enablePerformanceLogging:he,disablePerformanceLogging:pe,_refreshLogging:fe,_setGlobalPrefix:ge,_initWithQueryParams:ee};X.isInWorkerContext()&&"undefined"!=typeof self&&self&&!self.loggerFactory&&(self.loggerFactory=me);var ye,ve,be,we=Object.freeze({__proto__:null,_initWithQueryParams:ee,_refreshLogging:fe,_setGlobalPrefix:ge,createLogger:ae,default:me,disableAll:ce,disablePerformanceLogging:pe,enableAll:le,enablePerformanceLogging:he,setInstanceLevel:de,setLevel:ue}),ke={exports:{}},xe=(ye||(ye=1,ke.exports=function(){var e=/^v?(?:\d+)(\.(?:[x*]|\d+)(\.(?:[x*]|\d+)(\.(?:[x*]|\d+))?(?:-[\da-z\-]+(?:\.[\da-z\-]+)*)?(?:\+[\da-z\-]+(?:\.[\da-z\-]+)*)?)?)?$/i;function t(e){var t,n=e.replace(/^v/,"").replace(/\+.*$/,""),i=-1===(t=n).indexOf("-")?t.length:t.indexOf("-"),r=n.substring(0,i).split(".");return r.push(n.substring(i+1)),r}function n(e){return isNaN(Number(e))?e:Number(e)}function i(t){if("string"!=typeof t)throw new TypeError("Invalid argument expected string");if(!e.test(t))throw new Error("Invalid argument not valid semver ('"+t+"' received)")}function r(e,r){[e,r].forEach(i);for(var o=t(e),s=t(r),a=0;a<Math.max(o.length-1,s.length-1);a++){var l=parseInt(o[a]||0,10),c=parseInt(s[a]||0,10);if(l>c)return 1;if(c>l)return-1}var u=o[o.length-1],d=s[s.length-1];if(u&&d){var h=u.split(".").map(n),p=d.split(".").map(n);for(a=0;a<Math.max(h.length,p.length);a++){if(void 0===h[a]||"string"==typeof p[a]&&"number"==typeof h[a])return-1;if(void 0===p[a]||"string"==typeof h[a]&&"number"==typeof p[a])return 1;if(h[a]>p[a])return 1;if(p[a]>h[a])return-1}}else if(u||d)return u?-1:1;return 0}var o=[">",">=","=","<","<="],s={">":[1],">=":[0,1],"=":[0],"<=":[-1,0],"<":[-1]};return r.validate=function(t){return"string"==typeof t&&e.test(t)},r.compare=function(e,t,n){!function(e){if("string"!=typeof e)throw new TypeError("Invalid operator type, expected string but got "+typeof e);if(-1===o.indexOf(e))throw new TypeError("Invalid operator, expected one of "+o.join("|"))}(n);var i=r(e,t);return s[n].indexOf(i)>-1},r}()),ke.exports),Se=r(xe),Ce={exports:{}},_e=(ve||(ve=1,Ce.exports=function(){var e=Object.prototype.toString;function t(e,t){return null!=e&&Object.prototype.hasOwnProperty.call(e,t)}function n(e){if(!e)return!0;if(r(e)&&0===e.length)return!0;if("string"!=typeof e){for(var n in e)if(t(e,n))return!1;return!0}return!1}function i(t){return e.call(t)}var r=Array.isArray||function(t){return"[object Array]"===e.call(t)};function o(e){var t=parseInt(e);return t.toString()===e?t:e}function s(e){var s,a,l=function(e){return Object.keys(l).reduce((function(t,n){return"create"===n||"function"==typeof l[n]&&(t[n]=l[n].bind(l,e)),t}),{})};function c(e,t){if(s(e,t))return e[t]}function u(e,t,n,i){if("number"==typeof t&&(t=[t]),!t||0===t.length)return e;if("string"==typeof t)return u(e,t.split(".").map(o),n,i);var r=t[0],s=a(e,r);return 1===t.length?(void 0!==s&&i||(e[r]=n),s):(void 0===s&&(e[r]="number"==typeof t[1]?[]:{}),u(e[r],t.slice(1),n,i))}return s=(e=e||{}).includeInheritedProps?function(){return!0}:function(e,n){return"number"==typeof n&&Array.isArray(e)||t(e,n)},a=e.includeInheritedProps?function(e,t){"string"!=typeof t&&"number"!=typeof t&&(t=String(t));var n=c(e,t);if("__proto__"===t||"prototype"===t||"constructor"===t&&"function"==typeof n)throw new Error("For security reasons, object's magic properties cannot be set");return n}:function(e,t){return c(e,t)},l.has=function(n,i){if("number"==typeof i?i=[i]:"string"==typeof i&&(i=i.split(".")),!i||0===i.length)return!!n;for(var s=0;s<i.length;s++){var a=o(i[s]);if(!("number"==typeof a&&r(n)&&a<n.length||(e.includeInheritedProps?a in Object(n):t(n,a))))return!1;n=n[a]}return!0},l.ensureExists=function(e,t,n){return u(e,t,n,!0)},l.set=function(e,t,n,i){return u(e,t,n,i)},l.insert=function(e,t,n,i){var o=l.get(e,t);i=~~i,r(o)||l.set(e,t,o=[]),o.splice(i,0,n)},l.empty=function(e,t){var o,a;if(!n(t)&&null!=e&&(o=l.get(e,t))){if("string"==typeof o)return l.set(e,t,"");if(function(e){return"boolean"==typeof e||"[object Boolean]"===i(e)}(o))return l.set(e,t,!1);if("number"==typeof o)return l.set(e,t,0);if(r(o))o.length=0;else{if(!function(e){return"object"==typeof e&&"[object Object]"===i(e)}(o))return l.set(e,t,null);for(a in o)s(o,a)&&delete o[a]}}},l.push=function(e,t){var n=l.get(e,t);r(n)||l.set(e,t,n=[]),n.push.apply(n,Array.prototype.slice.call(arguments,2))},l.coalesce=function(e,t,n){for(var i,r=0,o=t.length;r<o;r++)if(void 0!==(i=l.get(e,t[r])))return i;return n},l.get=function(e,t,n){if("number"==typeof t&&(t=[t]),!t||0===t.length)return e;if(null==e)return n;if("string"==typeof t)return l.get(e,t.split("."),n);var i=o(t[0]),r=a(e,i);return void 0===r?n:1===t.length?r:l.get(e[i],t.slice(1),n)},l.del=function(e,t){if("number"==typeof t&&(t=[t]),null==e)return e;if(n(t))return e;if("string"==typeof t)return l.del(e,t.split("."));var i=o(t[0]);return a(e,i),s(e,i)?1!==t.length?l.del(e[i],t.slice(1)):(r(e)?e.splice(i,1):delete e[i],e):e},l}var a=s();return a.create=s,a.withInheritedProps=s({includeInheritedProps:!0}),a}()),Ce.exports),Ee=r(_e),Te={exports:{}},Pe=Te.exports,Ie=(be||(be=1,function(e,t){!function(n,i){var r="function",o="undefined",s="object",a="string",l="major",c="model",u="name",d="type",h="vendor",p="version",f="architecture",g="console",m="mobile",y="tablet",v="smarttv",b="wearable",w="embedded",k="Amazon",x="Apple",S="ASUS",C="BlackBerry",_="Browser",E="Chrome",T="Firefox",P="Google",I="Honor",A="Huawei",O="LG",L="Microsoft",N="Motorola",R="Nvidia",D="OnePlus",M="Opera",F="OPPO",B="Samsung",U="Sharp",j="Sony",z="Xiaomi",V="Zebra",W="Facebook",H="Chromium OS",$="Mac OS",G=" Browser",q=function(e){for(var t={},n=0;n<e.length;n++)t[e[n].toUpperCase()]=e[n];return t},Y=function(e,t){return typeof e===a&&-1!==K(t).indexOf(K(e))},K=function(e){return e.toLowerCase()},X=function(e,t){if(typeof e===a)return e=e.replace(/^\s\s*/,""),typeof t===o?e:e.substring(0,500)},Q=function(e,t){for(var n,o,a,l,c,u,d=0;d<t.length&&!c;){var h=t[d],p=t[d+1];for(n=o=0;n<h.length&&!c&&h[n];)if(c=h[n++].exec(e))for(a=0;a<p.length;a++)u=c[++o],typeof(l=p[a])===s&&l.length>0?2===l.length?this[l[0]]=typeof l[1]==r?l[1].call(this,u):l[1]:3===l.length?this[l[0]]=typeof l[1]!==r||l[1].exec&&l[1].test?u?u.replace(l[1],l[2]):i:u?l[1].call(this,u,l[2]):i:4===l.length&&(this[l[0]]=u?l[3].call(this,u.replace(l[1],l[2])):i):this[l]=u||i;d+=2}},Z=function(e,t){for(var n in t)if(typeof t[n]===s&&t[n].length>0){for(var r=0;r<t[n].length;r++)if(Y(t[n][r],e))return"?"===n?i:n}else if(Y(t[n],e))return"?"===n?i:n;return t.hasOwnProperty("*")?t["*"]:e},J={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},ee={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[p,[u,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[p,[u,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[u,p],[/opios[\/ ]+([\w\.]+)/i],[p,[u,M+" Mini"]],[/\bop(?:rg)?x\/([\w\.]+)/i],[p,[u,M+" GX"]],[/\bopr\/([\w\.]+)/i],[p,[u,M]],[/\bb[ai]*d(?:uhd|[ub]*[aekoprswx]{5,6})[\/ ]?([\w\.]+)/i],[p,[u,"Baidu"]],[/\b(?:mxbrowser|mxios|myie2)\/?([-\w\.]*)\b/i],[p,[u,"Maxthon"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer|sleipnir)[\/ ]?([\w\.]*)/i,/(avant|iemobile|slim(?:browser|boat|jet))[\/ ]?([\d\.]*)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|duckduckgo|klar|helio|(?=comodo_)?dragon)\/([-\w\.]+)/i,/(heytap|ovi|115)browser\/([\d\.]+)/i,/(weibo)__([\d\.]+)/i],[u,p],[/quark(?:pc)?\/([-\w\.]+)/i],[p,[u,"Quark"]],[/\bddg\/([\w\.]+)/i],[p,[u,"DuckDuckGo"]],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[p,[u,"UC"+_]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i,/micromessenger\/([\w\.]+)/i],[p,[u,"WeChat"]],[/konqueror\/([\w\.]+)/i],[p,[u,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[p,[u,"IE"]],[/ya(?:search)?browser\/([\w\.]+)/i],[p,[u,"Yandex"]],[/slbrowser\/([\w\.]+)/i],[p,[u,"Smart Lenovo "+_]],[/(avast|avg)\/([\w\.]+)/i],[[u,/(.+)/,"$1 Secure "+_],p],[/\bfocus\/([\w\.]+)/i],[p,[u,T+" Focus"]],[/\bopt\/([\w\.]+)/i],[p,[u,M+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[p,[u,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[p,[u,"Dolphin"]],[/coast\/([\w\.]+)/i],[p,[u,M+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[p,[u,"MIUI"+G]],[/fxios\/([\w\.-]+)/i],[p,[u,T]],[/\bqihoobrowser\/?([\w\.]*)/i],[p,[u,"360"]],[/\b(qq)\/([\w\.]+)/i],[[u,/(.+)/,"$1Browser"],p],[/(oculus|sailfish|huawei|vivo|pico)browser\/([\w\.]+)/i],[[u,/(.+)/,"$1"+G],p],[/samsungbrowser\/([\w\.]+)/i],[p,[u,B+" Internet"]],[/metasr[\/ ]?([\d\.]+)/i],[p,[u,"Sogou Explorer"]],[/(sogou)mo\w+\/([\d\.]+)/i],[[u,"Sogou Mobile"],p],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|2345(?=browser|chrome|explorer))\w*[\/ ]?v?([\w\.]+)/i],[u,p],[/(lbbrowser|rekonq)/i,/\[(linkedin)app\]/i],[u],[/ome\/([\w\.]+) \w* ?(iron) saf/i,/ome\/([\w\.]+).+qihu (360)[es]e/i],[p,u],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[u,W],p],[/(Klarna)\/([\w\.]+)/i,/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/(daum)apps[\/ ]([\w\.]+)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(alipay)client\/([\w\.]+)/i,/(twitter)(?:and| f.+e\/([\w\.]+))/i,/(chromium|instagram|snapchat)[\/ ]([-\w\.]+)/i],[u,p],[/\bgsa\/([\w\.]+) .*safari\//i],[p,[u,"GSA"]],[/musical_ly(?:.+app_?version\/|_)([\w\.]+)/i],[p,[u,"TikTok"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[p,[u,E+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[u,E+" WebView"],p],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[p,[u,"Android "+_]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[u,p],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[p,[u,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[p,u],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[u,[p,Z,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[u,p],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[u,"Netscape"],p],[/(wolvic|librewolf)\/([\w\.]+)/i],[u,p],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[p,[u,T+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(amaya|dillo|doris|icab|ladybird|lynx|mosaic|netsurf|obigo|polaris|w3m|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/\b(links) \(([\w\.]+)/i],[u,[p,/_/g,"."]],[/(cobalt)\/([\w\.]+)/i],[u,[p,/master.|lts./,""]]],cpu:[[/\b((amd|x|x86[-_]?|wow|win)64)\b/i],[[f,"amd64"]],[/(ia32(?=;))/i,/\b((i[346]|x)86)(pc)?\b/i],[[f,"ia32"]],[/\b(aarch64|arm(v?[89]e?l?|_?64))\b/i],[[f,"arm64"]],[/\b(arm(v[67])?ht?n?[fl]p?)\b/i],[[f,"armhf"]],[/( (ce|mobile); ppc;|\/[\w\.]+arm\b)/i],[[f,"arm"]],[/((ppc|powerpc)(64)?)( mac|;|\))/i],[[f,/ower/,"",K]],[/ sun4\w[;\)]/i],[[f,"sparc"]],[/\b(avr32|ia64(?=;)|68k(?=\))|\barm(?=v([1-7]|[5-7]1)l?|;|eabi)|(irix|mips|sparc)(64)?\b|pa-risc)/i],[[f,K]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[c,[h,B],[d,y]],[/\b((?:s[cgp]h|gt|sm)-(?![lr])\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]((?!sm-[lr])[-\w]+)/i,/sec-(sgh\w+)/i],[c,[h,B],[d,m]],[/(?:\/|\()(ip(?:hone|od)[\w, ]*)(?:\/|;)/i],[c,[h,x],[d,m]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[c,[h,x],[d,y]],[/(macintosh);/i],[c,[h,x]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[c,[h,U],[d,m]],[/\b((?:brt|eln|hey2?|gdi|jdn)-a?[lnw]09|(?:ag[rm]3?|jdn2|kob2)-a?[lw]0[09]hn)(?: bui|\)|;)/i],[c,[h,I],[d,y]],[/honor([-\w ]+)[;\)]/i],[c,[h,I],[d,m]],[/\b((?:ag[rs][2356]?k?|bah[234]?|bg[2o]|bt[kv]|cmr|cpn|db[ry]2?|jdn2|got|kob2?k?|mon|pce|scm|sht?|[tw]gr|vrd)-[ad]?[lw][0125][09]b?|605hw|bg2-u03|(?:gem|fdr|m2|ple|t1)-[7a]0[1-4][lu]|t1-a2[13][lw]|mediapad[\w\. ]*(?= bui|\)))\b(?!.+d\/s)/i],[c,[h,A],[d,y]],[/(?:huawei)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[c,[h,A],[d,m]],[/oid[^\)]+; (2[\dbc]{4}(182|283|rp\w{2})[cgl]|m2105k81a?c)(?: bui|\))/i,/\b((?:red)?mi[-_ ]?pad[\w- ]*)(?: bui|\))/i],[[c,/_/g," "],[h,z],[d,y]],[/\b(poco[\w ]+|m2\d{3}j\d\d[a-z]{2})(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/oid[^\)]+; (m?[12][0-389][01]\w{3,6}[c-y])( bui|; wv|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite|pro)?)(?: bui|\))/i,/ ([\w ]+) miui\/v?\d/i],[[c,/_/g," "],[h,z],[d,m]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[c,[h,F],[d,m]],[/\b(opd2(\d{3}a?))(?: bui|\))/i],[c,[h,Z,{OnePlus:["304","403","203"],"*":F}],[d,y]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[c,[h,"Vivo"],[d,m]],[/\b(rmx[1-3]\d{3})(?: bui|;|\))/i],[c,[h,"Realme"],[d,m]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto(?! 360)[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[c,[h,N],[d,m]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[c,[h,N],[d,y]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[c,[h,O],[d,y]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv|watch)\w+)/i,/\blg-?([\d\w]+) bui/i],[c,[h,O],[d,m]],[/(ideatab[-\w ]+|602lv|d-42a|a101lv|a2109a|a3500-hv|s[56]000|pb-6505[my]|tb-?x?\d{3,4}(?:f[cu]|xu|[av])|yt\d?-[jx]?\d+[lfmx])( bui|;|\)|\/)/i,/lenovo ?(b[68]0[08]0-?[hf]?|tab(?:[\w- ]+?)|tb[\w-]{6,7})( bui|;|\)|\/)/i],[c,[h,"Lenovo"],[d,y]],[/(nokia) (t[12][01])/i],[h,c,[d,y]],[/(?:maemo|nokia).*(n900|lumia \d+|rm-\d+)/i,/nokia[-_ ]?(([-\w\. ]*))/i],[[c,/_/g," "],[d,m],[h,"Nokia"]],[/(pixel (c|tablet))\b/i],[c,[h,P],[d,y]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[c,[h,P],[d,m]],[/droid.+; (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[c,[h,j],[d,m]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[c,"Xperia Tablet"],[h,j],[d,y]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[c,[h,D],[d,m]],[/(alexa)webm/i,/(kf[a-z]{2}wi|aeo(?!bc)\w\w)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[c,[h,k],[d,y]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[c,/(.+)/g,"Fire Phone $1"],[h,k],[d,m]],[/(playbook);[-\w\),; ]+(rim)/i],[c,h,[d,y]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[c,[h,C],[d,m]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[c,[h,S],[d,y]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[c,[h,S],[d,m]],[/(nexus 9)/i],[c,[h,"HTC"],[d,y]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[h,[c,/_/g," "],[d,m]],[/droid [\w\.]+; ((?:8[14]9[16]|9(?:0(?:48|60|8[01])|1(?:3[27]|66)|2(?:6[69]|9[56])|466))[gqswx])\w*(\)| bui)/i],[c,[h,"TCL"],[d,y]],[/(itel) ((\w+))/i],[[h,K],c,[d,Z,{tablet:["p10001l","w7001"],"*":"mobile"}]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[c,[h,"Acer"],[d,y]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[c,[h,"Meizu"],[d,m]],[/; ((?:power )?armor(?:[\w ]{0,8}))(?: bui|\))/i],[c,[h,"Ulefone"],[d,m]],[/; (energy ?\w+)(?: bui|\))/i,/; energizer ([\w ]+)(?: bui|\))/i],[c,[h,"Energizer"],[d,m]],[/; cat (b35);/i,/; (b15q?|s22 flip|s48c|s62 pro)(?: bui|\))/i],[c,[h,"Cat"],[d,m]],[/((?:new )?andromax[\w- ]+)(?: bui|\))/i],[c,[h,"Smartfren"],[d,m]],[/droid.+; (a(?:015|06[35]|142p?))/i],[c,[h,"Nothing"],[d,m]],[/; (x67 5g|tikeasy \w+|ac[1789]\d\w+)( b|\))/i,/archos ?(5|gamepad2?|([\w ]*[t1789]|hello) ?\d+[\w ]*)( b|\))/i],[c,[h,"Archos"],[d,y]],[/archos ([\w ]+)( b|\))/i,/; (ac[3-6]\d\w{2,8})( b|\))/i],[c,[h,"Archos"],[d,m]],[/(imo) (tab \w+)/i,/(infinix) (x1101b?)/i],[h,c,[d,y]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus(?! zenw)|dell|jolla|meizu|motorola|polytron|infinix|tecno|micromax|advan)[-_ ]?([-\w]*)/i,/; (hmd|imo) ([\w ]+?)(?: bui|\))/i,/(hp) ([\w ]+\w)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w ]+?)(?: bui|\)|\/)/i,/(oppo) ?([\w ]+) bui/i],[h,c,[d,m]],[/(kobo)\s(ereader|touch)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[h,c,[d,y]],[/(surface duo)/i],[c,[h,L],[d,y]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[c,[h,"Fairphone"],[d,m]],[/(u304aa)/i],[c,[h,"AT&T"],[d,m]],[/\bsie-(\w*)/i],[c,[h,"Siemens"],[d,m]],[/\b(rct\w+) b/i],[c,[h,"RCA"],[d,y]],[/\b(venue[\d ]{2,7}) b/i],[c,[h,"Dell"],[d,y]],[/\b(q(?:mv|ta)\w+) b/i],[c,[h,"Verizon"],[d,y]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[c,[h,"Barnes & Noble"],[d,y]],[/\b(tm\d{3}\w+) b/i],[c,[h,"NuVision"],[d,y]],[/\b(k88) b/i],[c,[h,"ZTE"],[d,y]],[/\b(nx\d{3}j) b/i],[c,[h,"ZTE"],[d,m]],[/\b(gen\d{3}) b.+49h/i],[c,[h,"Swiss"],[d,m]],[/\b(zur\d{3}) b/i],[c,[h,"Swiss"],[d,y]],[/\b((zeki)?tb.*\b) b/i],[c,[h,"Zeki"],[d,y]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[h,"Dragon Touch"],c,[d,y]],[/\b(ns-?\w{0,9}) b/i],[c,[h,"Insignia"],[d,y]],[/\b((nxa|next)-?\w{0,9}) b/i],[c,[h,"NextBook"],[d,y]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[h,"Voice"],c,[d,m]],[/\b(lvtel\-)?(v1[12]) b/i],[[h,"LvTel"],c,[d,m]],[/\b(ph-1) /i],[c,[h,"Essential"],[d,m]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[c,[h,"Envizen"],[d,y]],[/\b(trio[-\w\. ]+) b/i],[c,[h,"MachSpeed"],[d,y]],[/\btu_(1491) b/i],[c,[h,"Rotor"],[d,y]],[/((?:tegranote|shield t(?!.+d tv))[\w- ]*?)(?: b|\))/i],[c,[h,R],[d,y]],[/(sprint) (\w+)/i],[h,c,[d,m]],[/(kin\.[onetw]{3})/i],[[c,/\./g," "],[h,L],[d,m]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[c,[h,V],[d,y]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[c,[h,V],[d,m]],[/smart-tv.+(samsung)/i],[h,[d,v]],[/hbbtv.+maple;(\d+)/i],[[c,/^/,"SmartTV"],[h,B],[d,v]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[h,O],[d,v]],[/(apple) ?tv/i],[h,[c,x+" TV"],[d,v]],[/crkey/i],[[c,E+"cast"],[h,P],[d,v]],[/droid.+aft(\w+)( bui|\))/i],[c,[h,k],[d,v]],[/(shield \w+ tv)/i],[c,[h,R],[d,v]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[c,[h,U],[d,v]],[/(bravia[\w ]+)( bui|\))/i],[c,[h,j],[d,v]],[/(mi(tv|box)-?\w+) bui/i],[c,[h,z],[d,v]],[/Hbbtv.*(technisat) (.*);/i],[h,c,[d,v]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[h,X],[c,X],[d,v]],[/droid.+; ([\w- ]+) (?:android tv|smart[- ]?tv)/i],[c,[d,v]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[d,v]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[h,c,[d,g]],[/droid.+; (shield)( bui|\))/i],[c,[h,R],[d,g]],[/(playstation \w+)/i],[c,[h,j],[d,g]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[c,[h,L],[d,g]],[/\b(sm-[lr]\d\d[0156][fnuw]?s?|gear live)\b/i],[c,[h,B],[d,b]],[/((pebble))app/i,/(asus|google|lg|oppo) ((pixel |zen)?watch[\w ]*)( bui|\))/i],[h,c,[d,b]],[/(ow(?:19|20)?we?[1-3]{1,3})/i],[c,[h,F],[d,b]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[c,[h,x],[d,b]],[/(opwwe\d{3})/i],[c,[h,D],[d,b]],[/(moto 360)/i],[c,[h,N],[d,b]],[/(smartwatch 3)/i],[c,[h,j],[d,b]],[/(g watch r)/i],[c,[h,O],[d,b]],[/droid.+; (wt63?0{2,3})\)/i],[c,[h,V],[d,b]],[/droid.+; (glass) \d/i],[c,[h,P],[d,b]],[/(pico) (4|neo3(?: link|pro)?)/i],[h,c,[d,b]],[/; (quest( \d| pro)?)/i],[c,[h,W],[d,b]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[h,[d,w]],[/(aeobc)\b/i],[c,[h,k],[d,w]],[/(homepod).+mac os/i],[c,[h,x],[d,w]],[/windows iot/i],[[d,w]],[/droid .+?; ([^;]+?)(?: bui|; wv\)|\) applew).+? mobile safari/i],[c,[d,m]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[c,[d,y]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[d,y]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[d,m]],[/droid .+?; ([\w\. -]+)( bui|\))/i],[c,[h,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[p,[u,"EdgeHTML"]],[/(arkweb)\/([\w\.]+)/i],[u,p],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[p,[u,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna|servo)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i,/\b(libweb)/i],[u,p],[/ladybird\//i],[[u,"LibWeb"]],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[p,u]],os:[[/microsoft (windows) (vista|xp)/i],[u,p],[/(windows (?:phone(?: os)?|mobile|iot))[\/ ]?([\d\.\w ]*)/i],[u,[p,Z,J]],[/windows nt 6\.2; (arm)/i,/windows[\/ ]([ntce\d\. ]+\w)(?!.+xbox)/i,/(?:win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[p,Z,J],[u,"Windows"]],[/[adehimnop]{4,7}\b(?:.*os ([\w]+) like mac|; opera)/i,/(?:ios;fbsv\/|iphone.+ios[\/ ])([\d\.]+)/i,/cfnetwork\/.+darwin/i],[[p,/_/g,"."],[u,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[u,$],[p,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[p,u],[/(ubuntu) ([\w\.]+) like android/i],[[u,/(.+)/,"$1 Touch"],p],[/(android|bada|blackberry|kaios|maemo|meego|openharmony|qnx|rim tablet os|sailfish|series40|symbian|tizen|webos)\w*[-\/; ]?([\d\.]*)/i],[u,p],[/\(bb(10);/i],[p,[u,C]],[/(?:symbian ?os|symbos|s60(?=;)|series ?60)[-\/ ]?([\w\.]*)/i],[p,[u,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[p,[u,T+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[p,[u,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[p,[u,"watchOS"]],[/crkey\/([\d\.]+)/i],[p,[u,E+"cast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[u,H],p],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux)(?: arm\w*| x86\w*| ?)([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[u,p],[/(sunos) ?([\w\.\d]*)/i],[[u,"Solaris"],p],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux|serenityos)/i,/(unix) ?([\w\.]*)/i],[u,p]]},te=function(e,t){if(typeof e===s&&(t=e,e=i),!(this instanceof te))return new te(e,t).getResult();var g=typeof n!==o&&n.navigator?n.navigator:i,v=e||(g&&g.userAgent?g.userAgent:""),b=g&&g.userAgentData?g.userAgentData:i,w=t?function(e,t){var n={};for(var i in e)n[i]=t[i]&&t[i].length%2==0?t[i].concat(e[i]):e[i];return n}(ee,t):ee,k=g&&g.userAgent==v;return this.getBrowser=function(){var e,t={};return t[u]=i,t[p]=i,Q.call(t,v,w.browser),t[l]=typeof(e=t[p])===a?e.replace(/[^\d\.]/g,"").split(".")[0]:i,k&&g&&g.brave&&typeof g.brave.isBrave==r&&(t[u]="Brave"),t},this.getCPU=function(){var e={};return e[f]=i,Q.call(e,v,w.cpu),e},this.getDevice=function(){var e={};return e[h]=i,e[c]=i,e[d]=i,Q.call(e,v,w.device),k&&!e[d]&&b&&b.mobile&&(e[d]=m),k&&"Macintosh"==e[c]&&g&&typeof g.standalone!==o&&g.maxTouchPoints&&g.maxTouchPoints>2&&(e[c]="iPad",e[d]=y),e},this.getEngine=function(){var e={};return e[u]=i,e[p]=i,Q.call(e,v,w.engine),e},this.getOS=function(){var e={};return e[u]=i,e[p]=i,Q.call(e,v,w.os),k&&!e[u]&&b&&b.platform&&"Unknown"!=b.platform&&(e[u]=b.platform.replace(/chrome os/i,H).replace(/macos/i,$)),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return v},this.setUA=function(e){return v=typeof e===a&&e.length>500?X(e,500):e,this},this.setUA(v),this};te.VERSION="1.0.41",te.BROWSER=q([u,p,l]),te.CPU=q([f]),te.DEVICE=q([c,h,d,g,m,v,y,b,w]),te.ENGINE=te.OS=q([u,p]),e.exports&&(t=e.exports=te),t.UAParser=te;var ne=typeof n!==o&&(n.jQuery||n.Zepto);if(ne&&!ne.ua){var ie=new te;ne.ua=ie.getResult(),ne.ua.get=function(){return ie.getUA()},ne.ua.set=function(e){ie.setUA(e);var t=ie.getResult();for(var n in t)ne.ua[n]=t[n]}}}("object"==typeof window?window:Pe)}(Te,Te.exports)),Te.exports),Ae=new(r(Ie))("object"==typeof P&&P&&(P.ua||P.userAgent)||void 0).getResult(),Oe=Ae.device&&Ae.device.type&&Ae.device.type.toLowerCase()||"",Le=Ae.os&&Ae.os.name&&Ae.os.name.toLowerCase()||"",Ne=Ae.os&&Ae.os.version||"0.0.1",Re=Ae.browser&&Ae.browser.name&&Ae.browser.name.toLowerCase()||"",De=Ae.browser&&parseInt(Ae.browser.major,10)||0,Me=Ae.browser&&Ae.browser.version||"0.0.1",Fe=null;Object.defineProperty(Ae,"isTouchEnabled",{enumerable:!0,get:function(){return null===Fe&&(Fe=!!("ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch)),Fe}});var Be=null;Object.defineProperty(Ae,"isDesktop",{enumerable:!0,get:function(){return null===Be&&(Be="console"!==Oe&&"mobile"!==Oe&&"tablet"!==Oe&&"smarttv"!==Oe&&"wearable"!==Oe&&"embedded"!==Oe&&"android"!==Le&&"ios"!==Le&&"windows phone"!==Le&&"windows phone os"!==Le&&"windows mobile"!==Le),Be}});var Ue=null;Object.defineProperty(Ae,"isWebView",{enumerable:!0,get:function(){return null===Ue&&(Ue="ios"===Le?"mobile safari"!==Re&&!window.navigator.standalone:"android"===Le&&/; wv/.test(Ae.ua)),Ue}});var je=null;Object.defineProperty(Ae,"isAffectedByWinChrome51MseBug",{enumerable:!0,get:function(){return null===je&&(je=Le.indexOf("windows")>=0&&"chrome"===Re&&51===De),je}});var ze=null;Object.defineProperty(Ae,"isAffectedBySafari14PlaybackRateBug",{enumerable:!0,get:function(){return null===ze&&(ze=Re.indexOf("safari")>=0&&Se(Me,"14.1")>=0||"ios"===Le&&Se(Ne,"14.5")>=0),ze}});var Ve=null;Object.defineProperty(Ae,"name",{enumerable:!0,get:function(){return null===Ve&&(Ve=Ae.isDesktop?"desktop":Le).indexOf("windows")>=0&&(Ve="windows"),Ve}});var We=null;Object.defineProperty(Ae,"isEkoApp",{enumerable:!0,get:function(){return null===We&&(We=Ae.ua.indexOf("EkoApp")>=0),We}});var He=null;Object.defineProperty(Ae,"nativeSdkInfo",{enumerable:!0,get:function(){if(null===He){var e=/ekoNativeSDK\/([\d.\-\w]+) - (.+)\/(\S+)/.exec(Ae.ua);return e?(He={version:e[1],appName:e[2],appVersion:e[3]},e):null}return He}});var $e=null;Object.defineProperty(Ae,"isNativeSdk",{enumerable:!0,get:function(){return null===$e&&($e=!!Ae.nativeSdkInfo),$e}}),Ae.queryParams=$;var Ge=2147483647,qe=36,Ye=1,Ke=26,Xe=38,Qe=700,Ze=72,Je=128,et="-",tt=/[^\x20-\x7E]/,nt=/[\x2E\u3002\uFF0E\uFF61]/g,it={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},rt=qe-Ye,ot=Math.floor,st=String.fromCharCode;function at(e){throw new RangeError(it[e])}function lt(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function ct(e,t,n){var i=0;for(e=n?ot(e/Qe):e>>1,e+=ot(e/t);e>rt*Ke>>1;i+=qe)e=ot(e/rt);return ot(i+(rt+1)*e/(e+Xe))}var ut={env:{}};function dt(e){return null===e}function ht(e){return"string"==typeof e}function pt(e){return"object"==typeof e&&null!==e}var ft={parse:It,resolve:function(e,t){return It(e,!1,!0).resolve(t)},resolveObject:function(e,t){return e?It(e,!1,!0).resolveObject(t):t},format:function(e){return ht(e)&&(e=At({},e)),Ot(e)},Url:gt};function gt(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var mt=/^([a-z0-9.+-]+:)/i,yt=/:[0-9]*$/,vt=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,bt=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),wt=["'"].concat(bt),kt=["%","/","?",";","#"].concat(wt),xt=["/","?","#"],St=255,Ct=/^[+a-z0-9A-Z_-]{0,63}$/,_t=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,Et={javascript:!0,"javascript:":!0},Tt={javascript:!0,"javascript:":!0},Pt={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0};function It(e,t,n){if(e&&pt(e)&&e instanceof gt)return e;var i=new gt;return i.parse(e,t,n),i}function At(e,t,n,i){if(!ht(t))throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var r=t.indexOf("?"),o=-1!==r&&r<t.indexOf("#")?"?":"#",s=t.split(o);s[0]=s[0].replace(/\\/g,"/");var a=t=s.join(o);if(a=a.trim(),!i&&1===t.split("#").length){var l=vt.exec(a);if(l)return e.path=a,e.href=a,e.pathname=l[1],l[2]?(e.search=l[2],e.query=n?B(e.search.substr(1)):e.search.substr(1)):n&&(e.search="",e.query={}),e}var c,u,d,h=mt.exec(a);if(h){var p=(h=h[0]).toLowerCase();e.protocol=p,a=a.substr(h.length)}if(i||h||a.match(/^\/\/[^@\/]+@[^@\/]+/)){var f="//"===a.substr(0,2);!f||h&&Tt[h]||(a=a.substr(2),e.slashes=!0)}if(!Tt[h]&&(f||h&&!Pt[h])){var g,m,y=-1;for(c=0;c<xt.length;c++)-1!==(u=a.indexOf(xt[c]))&&(-1===y||u<y)&&(y=u);for(-1!==(m=-1===y?a.lastIndexOf("@"):a.lastIndexOf("@",y))&&(g=a.slice(0,m),a=a.slice(m+1),e.auth=decodeURIComponent(g)),y=-1,c=0;c<kt.length;c++)-1!==(u=a.indexOf(kt[c]))&&(-1===y||u<y)&&(y=u);-1===y&&(y=a.length),e.host=a.slice(0,y),a=a.slice(y),Lt(e),e.hostname=e.hostname||"";var v="["===e.hostname[0]&&"]"===e.hostname[e.hostname.length-1];if(!v){var b=e.hostname.split(/\./);for(c=0,d=b.length;c<d;c++){var w=b[c];if(w&&!w.match(Ct)){for(var k="",x=0,S=w.length;x<S;x++)w.charCodeAt(x)>127?k+="x":k+=w[x];if(!k.match(Ct)){var C=b.slice(0,c),_=b.slice(c+1),E=w.match(_t);E&&(C.push(E[1]),_.unshift(E[2])),_.length&&(a="/"+_.join(".")+a),e.hostname=C.join(".");break}}}}e.hostname=e.hostname.length>St?"":e.hostname.toLowerCase(),v||(e.hostname=function(e,t){var n=e.split("@"),i="";n.length>1&&(i=n[0]+"@",e=n[1]);var r=function(e,t){for(var n=e.length,i=[];n--;)i[n]=t(e[n]);return i}((e=e.replace(nt,".")).split("."),(function(e){return tt.test(e)?"xn--"+function(e){var t,n,i,r,o,s,a,l,c,u,d,h,p,f,g,m=[];for(e=function(e){for(var t,n,i=[],r=0,o=e.length;r<o;)(t=e.charCodeAt(r++))>=55296&&t<=56319&&r<o?56320==(64512&(n=e.charCodeAt(r++)))?i.push(((1023&t)<<10)+(1023&n)+65536):(i.push(t),r--):i.push(t);return i}(e),h=e.length,t=Je,n=0,o=Ze,s=0;s<h;++s)(d=e[s])<128&&m.push(st(d));for(i=r=m.length,r&&m.push(et);i<h;){for(a=Ge,s=0;s<h;++s)(d=e[s])>=t&&d<a&&(a=d);for(a-t>ot((Ge-n)/(p=i+1))&&at("overflow"),n+=(a-t)*p,t=a,s=0;s<h;++s)if((d=e[s])<t&&++n>Ge&&at("overflow"),d==t){for(l=n,c=qe;!(l<(u=c<=o?Ye:c>=o+Ke?Ke:c-o));c+=qe)m.push(st(lt(u+(g=l-u)%(f=qe-u),0))),l=ot(g/f);m.push(st(lt(l,0))),o=ct(n,p,i==r),n=0,++i}++n,++t}return m.join("")}(e):e})).join(".");return i+r}(e.hostname)),e.host=(e.hostname||"")+(e.port?":"+e.port:""),e.href+=e.host,v&&(e.hostname=e.hostname.substr(1,e.hostname.length-2),"/"!==a[0]&&(a="/"+a))}if(!Et[p])for(c=0,d=wt.length;c<d;c++){var T=wt[c];if(-1!==a.indexOf(T)){var P=encodeURIComponent(T);P===T&&(P=escape(T)),a=a.split(T).join(P)}}var I=a.indexOf("#");-1!==I&&(e.hash=a.substr(I),a=a.slice(0,I));var A=a.indexOf("?");return-1!==A?(e.search=a.substr(A),e.query=a.substr(A+1),n&&(e.query=B(e.query)),a=a.slice(0,A)):n&&(e.search="",e.query={}),a&&(e.pathname=a),Pt[p]&&e.hostname&&!e.pathname&&(e.pathname="/"),(e.pathname||e.search)&&(e.path=(e.pathname||"")+(e.search||"")),e.href=Ot(e),e}function Ot(e){var t=e.auth||"";t&&(t=(t=encodeURIComponent(t)).replace(/%3A/i,":"),t+="@");var n=e.protocol||"",i=e.pathname||"",r=e.hash||"",o=!1,s="";e.host?o=t+e.host:e.hostname&&(o=t+(-1===e.hostname.indexOf(":")?e.hostname:"["+this.hostname+"]"),e.port&&(o+=":"+e.port)),e.query&&pt(e.query)&&Object.keys(e.query).length&&(s=D(e.query));var a=e.search||s&&"?"+s||"";return n&&":"!==n.substr(-1)&&(n+=":"),e.slashes||(!n||Pt[n])&&!1!==o?(o="//"+(o||""),i&&"/"!==i.charAt(0)&&(i="/"+i)):o||(o=""),r&&"#"!==r.charAt(0)&&(r="#"+r),a&&"?"!==a.charAt(0)&&(a="?"+a),i=i.replace(/[?#]/g,(function(e){return encodeURIComponent(e)})),n+o+i+(a=a.replace("#","%23"))+r}function Lt(e){var t=e.host,n=yt.exec(t);n&&(":"!==(n=n[0])&&(e.port=n.substr(1)),t=t.substr(0,t.length-n.length)),t&&(e.hostname=t)}function Nt(e,t){for(var n=0,i=e.length-1;i>=0;i--){var r=e[i];"."===r?e.splice(i,1):".."===r?(e.splice(i,1),n++):n&&(e.splice(i,1),n--)}if(t)for(;n--;n)e.unshift("..");return e}gt.prototype.parse=function(e,t,n){return At(this,e,t,n)},gt.prototype.format=function(){return Ot(this)},gt.prototype.resolve=function(e){return this.resolveObject(It(e,!1,!0)).format()},gt.prototype.resolveObject=function(e){if(ht(e)){var t=new gt;t.parse(e,!1,!0),e=t}for(var n,i=new gt,r=Object.keys(this),o=0;o<r.length;o++){var s=r[o];i[s]=this[s]}if(i.hash=e.hash,""===e.href)return i.href=i.format(),i;if(e.slashes&&!e.protocol){for(var a=Object.keys(e),l=0;l<a.length;l++){var c=a[l];"protocol"!==c&&(i[c]=e[c])}return Pt[i.protocol]&&i.hostname&&!i.pathname&&(i.path=i.pathname="/"),i.href=i.format(),i}if(e.protocol&&e.protocol!==i.protocol){if(!Pt[e.protocol]){for(var u=Object.keys(e),d=0;d<u.length;d++){var h=u[d];i[h]=e[h]}return i.href=i.format(),i}if(i.protocol=e.protocol,e.host||Tt[e.protocol])i.pathname=e.pathname;else{for(n=(e.pathname||"").split("/");n.length&&!(e.host=n.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==n[0]&&n.unshift(""),n.length<2&&n.unshift(""),i.pathname=n.join("/")}return i.search=e.search,i.query=e.query,i.host=e.host||"",i.auth=e.auth,i.hostname=e.hostname||e.host,i.port=e.port,(i.pathname||i.search)&&(i.path=(i.pathname||"")+(i.search||"")),i.slashes=i.slashes||e.slashes,i.href=i.format(),i}var p,f=i.pathname&&"/"===i.pathname.charAt(0),g=e.host||e.pathname&&"/"===e.pathname.charAt(0),m=g||f||i.host&&e.pathname,y=m,v=i.pathname&&i.pathname.split("/")||[],b=i.protocol&&!Pt[i.protocol];if(n=e.pathname&&e.pathname.split("/")||[],b&&(i.hostname="",i.port=null,i.host&&(""===v[0]?v[0]=i.host:v.unshift(i.host)),i.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===n[0]?n[0]=e.host:n.unshift(e.host)),e.host=null),m=m&&(""===n[0]||""===v[0])),g)i.host=e.host||""===e.host?e.host:i.host,i.hostname=e.hostname||""===e.hostname?e.hostname:i.hostname,i.search=e.search,i.query=e.query,v=n;else if(n.length)v||(v=[]),v.pop(),v=v.concat(n),i.search=e.search,i.query=e.query;else if(null!=e.search)return b&&(i.hostname=i.host=v.shift(),(p=!!(i.host&&i.host.indexOf("@")>0)&&i.host.split("@"))&&(i.auth=p.shift(),i.host=i.hostname=p.shift())),i.search=e.search,i.query=e.query,dt(i.pathname)&&dt(i.search)||(i.path=(i.pathname?i.pathname:"")+(i.search?i.search:"")),i.href=i.format(),i;if(!v.length)return i.pathname=null,i.path=i.search?"/"+i.search:null,i.href=i.format(),i;for(var w=v.slice(-1)[0],k=(i.host||e.host||v.length>1)&&("."===w||".."===w)||""===w,x=0,S=v.length;S>=0;S--)"."===(w=v[S])?v.splice(S,1):".."===w?(v.splice(S,1),x++):x&&(v.splice(S,1),x--);if(!m&&!y)for(;x--;x)v.unshift("..");!m||""===v[0]||v[0]&&"/"===v[0].charAt(0)||v.unshift(""),k&&"/"!==v.join("/").substr(-1)&&v.push("");var C=""===v[0]||v[0]&&"/"===v[0].charAt(0);return b&&(i.hostname=i.host=C?"":v.length?v.shift():"",(p=!!(i.host&&i.host.indexOf("@")>0)&&i.host.split("@"))&&(i.auth=p.shift(),i.host=i.hostname=p.shift())),(m=m||i.host&&v.length)&&!C&&v.unshift(""),v.length?i.pathname=v.join("/"):(i.pathname=null,i.path=null),dt(i.pathname)&&dt(i.search)||(i.path=(i.pathname?i.pathname:"")+(i.search?i.search:"")),i.auth=e.auth||i.auth,i.slashes=i.slashes||e.slashes,i.href=i.format(),i},gt.prototype.parseHost=function(){return Lt(this)};var Rt=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,Dt=function(e){return Rt.exec(e).slice(1)};function Mt(){for(var e="",t=!1,n=arguments.length-1;n>=-1&&!t;n--){var i=n>=0?arguments[n]:"/";if("string"!=typeof i)throw new TypeError("Arguments to path.resolve must be strings");i&&(e=i+"/"+e,t="/"===i.charAt(0))}return(t?"/":"")+(e=Nt(jt(e.split("/"),(function(e){return!!e})),!t).join("/"))||"."}function Ft(e){var t=Bt(e),n="/"===zt(e,-1);return(e=Nt(jt(e.split("/"),(function(e){return!!e})),!t).join("/"))||t||(e="."),e&&n&&(e+="/"),(t?"/":"")+e}function Bt(e){return"/"===e.charAt(0)}var Ut={extname:function(e){return Dt(e)[3]},basename:function(e,t){var n=Dt(e)[2];return t&&n.substr(-1*t.length)===t&&(n=n.substr(0,n.length-t.length)),n},dirname:function(e){var t=Dt(e),n=t[0],i=t[1];return n||i?(i&&(i=i.substr(0,i.length-1)),n+i):"."},sep:"/",delimiter:":",relative:function(e,t){function n(e){for(var t=0;t<e.length&&""===e[t];t++);for(var n=e.length-1;n>=0&&""===e[n];n--);return t>n?[]:e.slice(t,n-t+1)}e=Mt(e).substr(1),t=Mt(t).substr(1);for(var i=n(e.split("/")),r=n(t.split("/")),o=Math.min(i.length,r.length),s=o,a=0;a<o;a++)if(i[a]!==r[a]){s=a;break}var l=[];for(a=s;a<i.length;a++)l.push("..");return(l=l.concat(r.slice(s))).join("/")},join:function(){return Ft(jt(Array.prototype.slice.call(arguments,0),(function(e,t){if("string"!=typeof e)throw new TypeError("Arguments to path.join must be strings");return e})).join("/"))},isAbsolute:Bt,normalize:Ft,resolve:Mt};function jt(e,t){if(e.filter)return e.filter(t);for(var n=[],i=0;i<e.length;i++)t(e[i],i,e)&&n.push(e[i]);return n}var zt="b"==="ab".substr(-1)?function(e,t,n){return e.substr(t,n)}:function(e,t,n){return t<0&&(t=e.length+t),e.substr(t,n)};const Vt=Ut.posix||Ut;function Wt(e){return"string"==typeof e&&Vt.basename.apply(Vt,arguments)||""}function Ht(){return Vt.join.apply(Vt,arguments)}var $t={basename:Wt,join:Ht};function Gt(e){var t;try{t=ft.parse(e,!0,!0)}catch(e){}return!(!t||!t.hostname)}function qt(e){var t;try{t=ft.parse(e,!0,!0)}catch(e){}return!(!t||!t.protocol)}function Yt(e){var t;try{t=ft.parse(e,!0,!0)}catch(e){}return!(!t||t.hostname)}function Kt(e,t){var n,i;try{n=ft.parse(e,!0,!0)}catch(e){n=ft.parse("")}try{i=ft.parse(t,!0,!0)}catch(e){i=ft.parse("")}var r={};return r.protocol=i.protocol,r.slashes=i.slashes,r.auth=i.auth,r.hostname=i.hostname,r.port=i.port,r.pathname=$t.join(i.pathname||"",n.pathname||""),r.search=n.search,r.query=n.query,r.hash=n.hash,ft.format(r)}var Xt={isUrl:Gt,doesUrlIncludeProtocol:qt,isRelativeUrl:Yt,replaceBaseUrl:Kt},Qt=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;const Zt={width:10,height:10},Jt={REGULAR:"regular",RTS:"rts",PARALLEL:"parallel",IMAGE:"image"};function en(e,t){return parseInt(e.bandwidth,10)-parseInt(t.bandwidth,10)}const tn={auto:(e,{bitrate:t,bitrateMultiplier:n,resolution:i,ivdResolutionFilterEnabled:r,minResolution:o})=>{n&&"number"==typeof n||(n=1.5),e=function(e,t,n=Zt){if(!t||!t.width||!t.height)return e.map((e=>(delete e.filteredOutRepsChecksums,delete e.resolutionTooLow,e)));if(t.width<n.width&&t.height<n.height)return e.map((e=>(delete e.filteredOutRepsChecksums,e.resolutionTooLow=!0,e)));const i=e.map((e=>({width:e.width,height:e.height}))).filter((e=>e.width&&e.height)).sort(((e,t)=>e.width===t.width?e.height-t.height:e.width-t.width)).reduce(((e,t)=>{if(0===e.length)e.push(t);else{const n=e[e.length-1];t.width===n.width&&t.height===n.height||e.push(t)}return e}),[]);let r=i.filter((e=>e.width>t.width&&e.height>t.height)),o=i.filter((e=>e.width<=t.width||e.height<=t.height));const s=o[o.length-1];(!s||s.width<t.width||s.height<t.height)&&r.length>0&&o.push(r.shift());let a=[];return e.filter((e=>{const t=o.some((t=>e.width===t.width&&e.height===t.height));return t||a.push(e.checksum),e.filteredOutRepsChecksums=a,t}))}(e,i,o=r?o||Zt:{width:1/0,height:1/0});for(let i=e.length-1;i>=0;--i)if(t>=e[i].bandwidth*n)return e[i];return e[0]},top:e=>e[e.length-1],bottom:e=>e[0],random:e=>e[Math.floor(Math.random()*e.length)]};function nn(e,t){t=t||{};const n=function(e){return!!(e&&e.representations&&Array.isArray(e.representations))}(e)?e.representations.slice(0).sort(en):[],i=t.ivdStrategy&&"string"==typeof t.ivdStrategy&&t.ivdStrategy.toLowerCase().trim()||"auto";return(tn[i]||tn.auto)(n,t)}function rn(e,t,n){return n||Xt.isRelativeUrl(e)?Xt.replaceBaseUrl(e,t):e}function on(e){return e&&"object"==typeof e&&e.type&&"assets-delivery-service"===e.type&&e.assetId&&(t=e.assetId)&&"string"==typeof t&&Qt.test(t)&&e.hasOwnProperty("assetRevision")&&"number"==typeof e.assetRevision;var t}function sn(e){var t;return(null==e||null===(t=e.metadata)||void 0===t?void 0:t.type)===Jt.IMAGE}var an={chooseRepresentation:nn,buildUrl:rn,isAssetsDeliverySrvSourceType:on,isImageSegment:sn,SEGMENT_TYPES:Jt};async function ln(e){return new Promise((t=>setTimeout(t,e)))}const cn=(I.requestAnimationFrame||I.mozRequestAnimationFrame||I.webkitRequestAnimationFrame||I.msRequestAnimationFrame||(e=>I.setTimeout(e,1e3/60))).bind(I),un=(I.cancelAnimationFrame||I.mozCancelAnimationFrame||I.webkitCancelAnimationFrame||I.msCancelAnimationFrame||(e=>I.clearTimeout(e))).bind(I);var dn=[],hn=[],pn="undefined"!=typeof Uint8Array?Uint8Array:Array,fn=!1;function gn(){fn=!0;for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=0;t<64;++t)dn[t]=e[t],hn[e.charCodeAt(t)]=t;hn["-".charCodeAt(0)]=62,hn["_".charCodeAt(0)]=63}function mn(e,t,n){for(var i,r=[],o=t;o<n;o+=3)r.push(dn[(i=(e[o]<<16)+(e[o+1]<<8)+e[o+2])>>18&63]+dn[i>>12&63]+dn[i>>6&63]+dn[63&i]);return r.join("")}function yn(e,t,n,i,r){var o,s,a=8*r-i-1,l=(1<<a)-1,c=l>>1,u=-7,d=n?r-1:0,h=n?-1:1,p=e[t+d];for(d+=h,o=p&(1<<-u)-1,p>>=-u,u+=a;u>0;o=256*o+e[t+d],d+=h,u-=8);for(s=o&(1<<-u)-1,o>>=-u,u+=i;u>0;s=256*s+e[t+d],d+=h,u-=8);if(0===o)o=1-c;else{if(o===l)return s?NaN:1/0*(p?-1:1);s+=Math.pow(2,i),o-=c}return(p?-1:1)*s*Math.pow(2,o-i)}function vn(e,t,n,i,r,o){var s,a,l,c=8*o-r-1,u=(1<<c)-1,d=u>>1,h=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,p=i?0:o-1,f=i?1:-1,g=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=u):(s=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-s))<1&&(s--,l*=2),(t+=s+d>=1?h/l:h*Math.pow(2,1-d))*l>=2&&(s++,l/=2),s+d>=u?(a=0,s=u):s+d>=1?(a=(t*l-1)*Math.pow(2,r),s+=d):(a=t*Math.pow(2,d-1)*Math.pow(2,r),s=0));r>=8;e[n+p]=255&a,p+=f,a/=256,r-=8);for(s=s<<r|a,c+=r;c>0;e[n+p]=255&s,p+=f,s/=256,c-=8);e[n+p-f]|=128*g}var bn={}.toString,wn=Array.isArray||function(e){return"[object Array]"==bn.call(e)};function kn(){return Sn.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function xn(e,t){if(kn()<t)throw new RangeError("Invalid typed array length");return Sn.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=Sn.prototype:(null===e&&(e=new Sn(t)),e.length=t),e}function Sn(e,t,n){if(!(Sn.TYPED_ARRAY_SUPPORT||this instanceof Sn))return new Sn(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return En(this,e)}return Cn(this,e,t,n)}function Cn(e,t,n,i){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,i){if(n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(i||0))throw new RangeError("'length' is out of bounds");return t=void 0===n&&void 0===i?new Uint8Array(t):void 0===i?new Uint8Array(t,n):new Uint8Array(t,n,i),Sn.TYPED_ARRAY_SUPPORT?(e=t).__proto__=Sn.prototype:e=Tn(e,t),e}(e,t,n,i):"string"==typeof t?function(e,t,n){if("string"==typeof n&&""!==n||(n="utf8"),!Sn.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var i=0|An(t,n),r=(e=xn(e,i)).write(t,n);return r!==i&&(e=e.slice(0,r)),e}(e,t,n):function(e,t){if(In(t)){var n=0|Pn(t.length);return 0===(e=xn(e,n)).length||t.copy(e,0,0,n),e}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(i=t.length)!=i?xn(e,0):Tn(e,t);if("Buffer"===t.type&&wn(t.data))return Tn(e,t.data)}var i;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function _n(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function En(e,t){if(_n(t),e=xn(e,t<0?0:0|Pn(t)),!Sn.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function Tn(e,t){var n=t.length<0?0:0|Pn(t.length);e=xn(e,n);for(var i=0;i<n;i+=1)e[i]=255&t[i];return e}function Pn(e){if(e>=kn())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+kn().toString(16)+" bytes");return 0|e}function In(e){return!(null==e||!e._isBuffer)}function An(e,t){if(In(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var i=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return ii(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return ri(e).length;default:if(i)return ii(e).length;t=(""+t).toLowerCase(),i=!0}}function On(e,t,n){var i=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return Gn(this,t,n);case"utf8":case"utf-8":return Vn(this,t,n);case"ascii":return Hn(this,t,n);case"latin1":case"binary":return $n(this,t,n);case"base64":return zn(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return qn(this,t,n);default:if(i)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),i=!0}}function Ln(e,t,n){var i=e[t];e[t]=e[n],e[n]=i}function Nn(e,t,n,i,r){if(0===e.length)return-1;if("string"==typeof n?(i=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=r?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(r)return-1;n=e.length-1}else if(n<0){if(!r)return-1;n=0}if("string"==typeof t&&(t=Sn.from(t,i)),In(t))return 0===t.length?-1:Rn(e,t,n,i,r);if("number"==typeof t)return t&=255,Sn.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?r?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):Rn(e,[t],n,i,r);throw new TypeError("val must be string, number or Buffer")}function Rn(e,t,n,i,r){var o,s=1,a=e.length,l=t.length;if(void 0!==i&&("ucs2"===(i=String(i).toLowerCase())||"ucs-2"===i||"utf16le"===i||"utf-16le"===i)){if(e.length<2||t.length<2)return-1;s=2,a/=2,l/=2,n/=2}function c(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(r){var u=-1;for(o=n;o<a;o++)if(c(e,o)===c(t,-1===u?0:o-u)){if(-1===u&&(u=o),o-u+1===l)return u*s}else-1!==u&&(o-=o-u),u=-1}else for(n+l>a&&(n=a-l),o=n;o>=0;o--){for(var d=!0,h=0;h<l;h++)if(c(e,o+h)!==c(t,h)){d=!1;break}if(d)return o}return-1}function Dn(e,t,n,i){n=Number(n)||0;var r=e.length-n;i?(i=Number(i))>r&&(i=r):i=r;var o=t.length;if(o%2!=0)throw new TypeError("Invalid hex string");i>o/2&&(i=o/2);for(var s=0;s<i;++s){var a=parseInt(t.substr(2*s,2),16);if(isNaN(a))return s;e[n+s]=a}return s}function Mn(e,t,n,i){return oi(ii(t,e.length-n),e,n,i)}function Fn(e,t,n,i){return oi(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,i)}function Bn(e,t,n,i){return Fn(e,t,n,i)}function Un(e,t,n,i){return oi(ri(t),e,n,i)}function jn(e,t,n,i){return oi(function(e,t){for(var n,i,r=[],o=0;o<e.length&&!((t-=2)<0);++o)i=(n=e.charCodeAt(o))>>8,r.push(n%256),r.push(i);return r}(t,e.length-n),e,n,i)}function zn(e,t,n){return function(e){var t;fn||gn();for(var n=e.length,i=n%3,r="",o=[],s=16383,a=0,l=n-i;a<l;a+=s)o.push(mn(e,a,a+s>l?l:a+s));return 1===i?(r+=dn[(t=e[n-1])>>2],r+=dn[t<<4&63],r+="=="):2===i&&(r+=dn[(t=(e[n-2]<<8)+e[n-1])>>10],r+=dn[t>>4&63],r+=dn[t<<2&63],r+="="),o.push(r),o.join("")}(0===t&&n===e.length?e:e.slice(t,n))}function Vn(e,t,n){n=Math.min(e.length,n);for(var i=[],r=t;r<n;){var o,s,a,l,c=e[r],u=null,d=c>239?4:c>223?3:c>191?2:1;if(r+d<=n)switch(d){case 1:c<128&&(u=c);break;case 2:128==(192&(o=e[r+1]))&&(l=(31&c)<<6|63&o)>127&&(u=l);break;case 3:s=e[r+2],128==(192&(o=e[r+1]))&&128==(192&s)&&(l=(15&c)<<12|(63&o)<<6|63&s)>2047&&(l<55296||l>57343)&&(u=l);break;case 4:s=e[r+2],a=e[r+3],128==(192&(o=e[r+1]))&&128==(192&s)&&128==(192&a)&&(l=(15&c)<<18|(63&o)<<12|(63&s)<<6|63&a)>65535&&l<1114112&&(u=l)}null===u?(u=65533,d=1):u>65535&&(i.push((u-=65536)>>>10&1023|55296),u=56320|1023&u),i.push(u),r+=d}return function(e){var t=e.length;if(t<=Wn)return String.fromCharCode.apply(String,e);for(var n="",i=0;i<t;)n+=String.fromCharCode.apply(String,e.slice(i,i+=Wn));return n}(i)}Sn.TYPED_ARRAY_SUPPORT=void 0===P.TYPED_ARRAY_SUPPORT||P.TYPED_ARRAY_SUPPORT,kn(),Sn.poolSize=8192,Sn._augment=function(e){return e.__proto__=Sn.prototype,e},Sn.from=function(e,t,n){return Cn(null,e,t,n)},Sn.TYPED_ARRAY_SUPPORT&&(Sn.prototype.__proto__=Uint8Array.prototype,Sn.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&Symbol),Sn.alloc=function(e,t,n){return function(e,t,n,i){return _n(t),t<=0?xn(e,t):void 0!==n?"string"==typeof i?xn(e,t).fill(n,i):xn(e,t).fill(n):xn(e,t)}(null,e,t,n)},Sn.allocUnsafe=function(e){return En(null,e)},Sn.allocUnsafeSlow=function(e){return En(null,e)},Sn.isBuffer=function(e){return null!=e&&(!!e._isBuffer||si(e)||function(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&si(e.slice(0,0))}(e))},Sn.compare=function(e,t){if(!In(e)||!In(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,i=t.length,r=0,o=Math.min(n,i);r<o;++r)if(e[r]!==t[r]){n=e[r],i=t[r];break}return n<i?-1:i<n?1:0},Sn.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Sn.concat=function(e,t){if(!wn(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return Sn.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var i=Sn.allocUnsafe(t),r=0;for(n=0;n<e.length;++n){var o=e[n];if(!In(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(i,r),r+=o.length}return i},Sn.byteLength=An,Sn.prototype._isBuffer=!0,Sn.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)Ln(this,t,t+1);return this},Sn.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)Ln(this,t,t+3),Ln(this,t+1,t+2);return this},Sn.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)Ln(this,t,t+7),Ln(this,t+1,t+6),Ln(this,t+2,t+5),Ln(this,t+3,t+4);return this},Sn.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?Vn(this,0,e):On.apply(this,arguments)},Sn.prototype.equals=function(e){if(!In(e))throw new TypeError("Argument must be a Buffer");return this===e||0===Sn.compare(this,e)},Sn.prototype.inspect=function(){var e="";return this.length>0&&(e=this.toString("hex",0,50).match(/.{2}/g).join(" "),this.length>50&&(e+=" ... ")),"<Buffer "+e+">"},Sn.prototype.compare=function(e,t,n,i,r){if(!In(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===i&&(i=0),void 0===r&&(r=this.length),t<0||n>e.length||i<0||r>this.length)throw new RangeError("out of range index");if(i>=r&&t>=n)return 0;if(i>=r)return-1;if(t>=n)return 1;if(this===e)return 0;for(var o=(r>>>=0)-(i>>>=0),s=(n>>>=0)-(t>>>=0),a=Math.min(o,s),l=this.slice(i,r),c=e.slice(t,n),u=0;u<a;++u)if(l[u]!==c[u]){o=l[u],s=c[u];break}return o<s?-1:s<o?1:0},Sn.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},Sn.prototype.indexOf=function(e,t,n){return Nn(this,e,t,n,!0)},Sn.prototype.lastIndexOf=function(e,t,n){return Nn(this,e,t,n,!1)},Sn.prototype.write=function(e,t,n,i){if(void 0===t)i="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)i=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===i&&(i="utf8")):(i=n,n=void 0)}var r=this.length-t;if((void 0===n||n>r)&&(n=r),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");for(var o=!1;;)switch(i){case"hex":return Dn(this,e,t,n);case"utf8":case"utf-8":return Mn(this,e,t,n);case"ascii":return Fn(this,e,t,n);case"latin1":case"binary":return Bn(this,e,t,n);case"base64":return Un(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return jn(this,e,t,n);default:if(o)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),o=!0}},Sn.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var Wn=4096;function Hn(e,t,n){var i="";n=Math.min(e.length,n);for(var r=t;r<n;++r)i+=String.fromCharCode(127&e[r]);return i}function $n(e,t,n){var i="";n=Math.min(e.length,n);for(var r=t;r<n;++r)i+=String.fromCharCode(e[r]);return i}function Gn(e,t,n){var i=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>i)&&(n=i);for(var r="",o=t;o<n;++o)r+=ni(e[o]);return r}function qn(e,t,n){for(var i=e.slice(t,n),r="",o=0;o<i.length;o+=2)r+=String.fromCharCode(i[o]+256*i[o+1]);return r}function Yn(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function Kn(e,t,n,i,r,o){if(!In(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>r||t<o)throw new RangeError('"value" argument is out of bounds');if(n+i>e.length)throw new RangeError("Index out of range")}function Xn(e,t,n,i){t<0&&(t=65535+t+1);for(var r=0,o=Math.min(e.length-n,2);r<o;++r)e[n+r]=(t&255<<8*(i?r:1-r))>>>8*(i?r:1-r)}function Qn(e,t,n,i){t<0&&(t=4294967295+t+1);for(var r=0,o=Math.min(e.length-n,4);r<o;++r)e[n+r]=t>>>8*(i?r:3-r)&255}function Zn(e,t,n,i,r,o){if(n+i>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function Jn(e,t,n,i,r){return r||Zn(e,0,n,4),vn(e,t,n,i,23,4),n+4}function ei(e,t,n,i,r){return r||Zn(e,0,n,8),vn(e,t,n,i,52,8),n+8}Sn.prototype.slice=function(e,t){var n,i=this.length;if((e=~~e)<0?(e+=i)<0&&(e=0):e>i&&(e=i),(t=void 0===t?i:~~t)<0?(t+=i)<0&&(t=0):t>i&&(t=i),t<e&&(t=e),Sn.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=Sn.prototype;else{var r=t-e;n=new Sn(r,void 0);for(var o=0;o<r;++o)n[o]=this[o+e]}return n},Sn.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||Yn(e,t,this.length);for(var i=this[e],r=1,o=0;++o<t&&(r*=256);)i+=this[e+o]*r;return i},Sn.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||Yn(e,t,this.length);for(var i=this[e+--t],r=1;t>0&&(r*=256);)i+=this[e+--t]*r;return i},Sn.prototype.readUInt8=function(e,t){return t||Yn(e,1,this.length),this[e]},Sn.prototype.readUInt16LE=function(e,t){return t||Yn(e,2,this.length),this[e]|this[e+1]<<8},Sn.prototype.readUInt16BE=function(e,t){return t||Yn(e,2,this.length),this[e]<<8|this[e+1]},Sn.prototype.readUInt32LE=function(e,t){return t||Yn(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},Sn.prototype.readUInt32BE=function(e,t){return t||Yn(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},Sn.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||Yn(e,t,this.length);for(var i=this[e],r=1,o=0;++o<t&&(r*=256);)i+=this[e+o]*r;return i>=(r*=128)&&(i-=Math.pow(2,8*t)),i},Sn.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||Yn(e,t,this.length);for(var i=t,r=1,o=this[e+--i];i>0&&(r*=256);)o+=this[e+--i]*r;return o>=(r*=128)&&(o-=Math.pow(2,8*t)),o},Sn.prototype.readInt8=function(e,t){return t||Yn(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},Sn.prototype.readInt16LE=function(e,t){t||Yn(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},Sn.prototype.readInt16BE=function(e,t){t||Yn(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},Sn.prototype.readInt32LE=function(e,t){return t||Yn(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},Sn.prototype.readInt32BE=function(e,t){return t||Yn(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},Sn.prototype.readFloatLE=function(e,t){return t||Yn(e,4,this.length),yn(this,e,!0,23,4)},Sn.prototype.readFloatBE=function(e,t){return t||Yn(e,4,this.length),yn(this,e,!1,23,4)},Sn.prototype.readDoubleLE=function(e,t){return t||Yn(e,8,this.length),yn(this,e,!0,52,8)},Sn.prototype.readDoubleBE=function(e,t){return t||Yn(e,8,this.length),yn(this,e,!1,52,8)},Sn.prototype.writeUIntLE=function(e,t,n,i){e=+e,t|=0,n|=0,i||Kn(this,e,t,n,Math.pow(2,8*n)-1,0);var r=1,o=0;for(this[t]=255&e;++o<n&&(r*=256);)this[t+o]=e/r&255;return t+n},Sn.prototype.writeUIntBE=function(e,t,n,i){e=+e,t|=0,n|=0,i||Kn(this,e,t,n,Math.pow(2,8*n)-1,0);var r=n-1,o=1;for(this[t+r]=255&e;--r>=0&&(o*=256);)this[t+r]=e/o&255;return t+n},Sn.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||Kn(this,e,t,1,255,0),Sn.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},Sn.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||Kn(this,e,t,2,65535,0),Sn.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):Xn(this,e,t,!0),t+2},Sn.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||Kn(this,e,t,2,65535,0),Sn.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):Xn(this,e,t,!1),t+2},Sn.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||Kn(this,e,t,4,4294967295,0),Sn.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):Qn(this,e,t,!0),t+4},Sn.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||Kn(this,e,t,4,4294967295,0),Sn.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):Qn(this,e,t,!1),t+4},Sn.prototype.writeIntLE=function(e,t,n,i){if(e=+e,t|=0,!i){var r=Math.pow(2,8*n-1);Kn(this,e,t,n,r-1,-r)}var o=0,s=1,a=0;for(this[t]=255&e;++o<n&&(s*=256);)e<0&&0===a&&0!==this[t+o-1]&&(a=1),this[t+o]=(e/s|0)-a&255;return t+n},Sn.prototype.writeIntBE=function(e,t,n,i){if(e=+e,t|=0,!i){var r=Math.pow(2,8*n-1);Kn(this,e,t,n,r-1,-r)}var o=n-1,s=1,a=0;for(this[t+o]=255&e;--o>=0&&(s*=256);)e<0&&0===a&&0!==this[t+o+1]&&(a=1),this[t+o]=(e/s|0)-a&255;return t+n},Sn.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||Kn(this,e,t,1,127,-128),Sn.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},Sn.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||Kn(this,e,t,2,32767,-32768),Sn.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):Xn(this,e,t,!0),t+2},Sn.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||Kn(this,e,t,2,32767,-32768),Sn.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):Xn(this,e,t,!1),t+2},Sn.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||Kn(this,e,t,4,2147483647,-2147483648),Sn.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):Qn(this,e,t,!0),t+4},Sn.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||Kn(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),Sn.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):Qn(this,e,t,!1),t+4},Sn.prototype.writeFloatLE=function(e,t,n){return Jn(this,e,t,!0,n)},Sn.prototype.writeFloatBE=function(e,t,n){return Jn(this,e,t,!1,n)},Sn.prototype.writeDoubleLE=function(e,t,n){return ei(this,e,t,!0,n)},Sn.prototype.writeDoubleBE=function(e,t,n){return ei(this,e,t,!1,n)},Sn.prototype.copy=function(e,t,n,i){if(n||(n=0),i||0===i||(i=this.length),t>=e.length&&(t=e.length),t||(t=0),i>0&&i<n&&(i=n),i===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-t<i-n&&(i=e.length-t+n);var r,o=i-n;if(this===e&&n<t&&t<i)for(r=o-1;r>=0;--r)e[r+t]=this[r+n];else if(o<1e3||!Sn.TYPED_ARRAY_SUPPORT)for(r=0;r<o;++r)e[r+t]=this[r+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+o),t);return o},Sn.prototype.fill=function(e,t,n,i){if("string"==typeof e){if("string"==typeof t?(i=t,t=0,n=this.length):"string"==typeof n&&(i=n,n=this.length),1===e.length){var r=e.charCodeAt(0);r<256&&(e=r)}if(void 0!==i&&"string"!=typeof i)throw new TypeError("encoding must be a string");if("string"==typeof i&&!Sn.isEncoding(i))throw new TypeError("Unknown encoding: "+i)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var o;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(o=t;o<n;++o)this[o]=e;else{var s=In(e)?e:ii(new Sn(e,i).toString()),a=s.length;for(o=0;o<n-t;++o)this[o+t]=s[o%a]}return this};var ti=/[^+\/0-9A-Za-z-_]/g;function ni(e){return e<16?"0"+e.toString(16):e.toString(16)}function ii(e,t){var n;t=t||1/0;for(var i=e.length,r=null,o=[],s=0;s<i;++s){if((n=e.charCodeAt(s))>55295&&n<57344){if(!r){if(n>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(s+1===i){(t-=3)>-1&&o.push(239,191,189);continue}r=n;continue}if(n<56320){(t-=3)>-1&&o.push(239,191,189),r=n;continue}n=65536+(r-55296<<10|n-56320)}else r&&(t-=3)>-1&&o.push(239,191,189);if(r=null,n<128){if((t-=1)<0)break;o.push(n)}else if(n<2048){if((t-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function ri(e){return function(e){var t,n,i,r,o,s;fn||gn();var a=e.length;if(a%4>0)throw new Error("Invalid string. Length must be a multiple of 4");s=new pn(3*a/4-(o="="===e[a-2]?2:"="===e[a-1]?1:0)),i=o>0?a-4:a;var l=0;for(t=0,n=0;t<i;t+=4,n+=3)r=hn[e.charCodeAt(t)]<<18|hn[e.charCodeAt(t+1)]<<12|hn[e.charCodeAt(t+2)]<<6|hn[e.charCodeAt(t+3)],s[l++]=r>>16&255,s[l++]=r>>8&255,s[l++]=255&r;return 2===o?(r=hn[e.charCodeAt(t)]<<2|hn[e.charCodeAt(t+1)]>>4,s[l++]=255&r):1===o&&(r=hn[e.charCodeAt(t)]<<10|hn[e.charCodeAt(t+1)]<<4|hn[e.charCodeAt(t+2)]>>2,s[l++]=r>>8&255,s[l++]=255&r),s}(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(ti,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function oi(e,t,n,i){for(var r=0;r<i&&!(r+n>=t.length||r>=e.length);++r)t[r+n]=e[r];return r}function si(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}var ai,li={exports:{}},ci=function(){if(ai)return li.exports;ai=1;var e,t,n=li.exports={};function i(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function o(t){if(e===setTimeout)return setTimeout(t,0);if((e===i||!e)&&setTimeout)return e=setTimeout,setTimeout(t,0);try{return e(t,0)}catch(n){try{return e.call(null,t,0)}catch(n){return e.call(this,t,0)}}}!function(){try{e="function"==typeof setTimeout?setTimeout:i}catch(t){e=i}try{t="function"==typeof clearTimeout?clearTimeout:r}catch(e){t=r}}();var s,a=[],l=!1,c=-1;function u(){l&&s&&(l=!1,s.length?a=s.concat(a):c=-1,a.length&&d())}function d(){if(!l){var e=o(u);l=!0;for(var n=a.length;n;){for(s=a,a=[];++c<n;)s&&s[c].run();c=-1,n=a.length}s=null,l=!1,function(e){if(t===clearTimeout)return clearTimeout(e);if((t===r||!t)&&clearTimeout)return t=clearTimeout,clearTimeout(e);try{return t(e)}catch(n){try{return t.call(null,e)}catch(n){return t.call(this,e)}}}(e)}}function h(e,t){this.fun=e,this.array=t}function p(){}return n.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];a.push(new h(e,t)),1!==a.length||l||o(d)},h.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=p,n.addListener=p,n.once=p,n.off=p,n.removeListener=p,n.removeAllListeners=p,n.emit=p,n.prependListener=p,n.prependOnceListener=p,n.listeners=function(e){return[]},n.binding=function(e){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(e){throw new Error("process.chdir is not supported")},n.umask=function(){return 0},li.exports}(),ui=r(ci);I&&!I.global&&(I.global=I),I&&!I.Buffer&&Sn&&(I.Buffer=Sn),I&&!I.process&&ui&&(I.process=ui),String.prototype.endsWith||(String.prototype.endsWith=function(e,t){var n=this.toString();(void 0===t||t>n.length)&&(t=n.length);var i=n.indexOf(e,t-=e.length);return-1!==i&&i===t}),String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return this.indexOf(e,t=t||0)===t}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(e){if(null==this)throw new TypeError('"this" is null or not defined');var t=Object(this),n=t.length>>>0;if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var i=arguments[1],r=0;r<n;){var o=t[r];if(e.call(i,o,r,t))return o;r++}},configurable:!0,writable:!0}),Array.prototype.every||(Array.prototype.every=function(e,t){var n,i;if(null===this)throw new TypeError("this is null or not defined");var r=Object(this),o=r.length>>>0;if("function"!=typeof e&&"[object Function]"!==Object.prototype.toString.call(e))throw new TypeError;for(arguments.length>1&&(n=t),i=0;i<o;){var s;if(i in r&&(s=r[i],!(n?e.call(n,s,i,r):e(s,i,r))))return!1;i++}return!0}),"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(e,t){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(e),i=1;i<arguments.length;i++){var r=arguments[i];if(null!=r)for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])}return n},writable:!0,configurable:!0}),"function"!=typeof Number.isInteger&&(Number.isInteger=function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e});var di,hi,pi=Object.prototype.hasOwnProperty,fi=Object.prototype.toString,gi=function(e){if(!e||"[object Object]"!==fi.call(e)||e.nodeType||e.setInterval)return!1;var t,n=pi.call(e,"constructor"),i=e.constructor&&e.constructor.prototype&&pi.call(e.constructor.prototype,"isPrototypeOf");if(e.constructor&&!n&&!i)return!1;for(t in e);return void 0===t||pi.call(e,t)},mi=(di=Array.isArray,hi=function(){var e,t,n,i,r,o,s,a=arguments[0]||{},l=1,c=arguments.length,u=!1,d=!1;for("boolean"==typeof a&&(u=a,a=arguments[1]||{},l=2),"boolean"==typeof arguments[1]&&(d=arguments[1],a=arguments[2]||{},l=3),"object"!=typeof a&&"function"!=typeof a&&(a={}),c===l&&(a=this,--l);l<c;l++)if(null!==(e=arguments[l])){if(u&&di(e)){a=[];for(var h=e.length,p=0;p<h;++p)gi(e[p])?a.push(hi(u,{},e[p])):di(e[p])?a.push(hi(u,[],e[p])):a.push(e[p]);continue}for(t in e)n=a[t],a!==(i=e[t])&&(d&&(s=Object.getOwnPropertyDescriptor(e,t))&&s&&(s.get||s.set)?Object.defineProperty(a,t,s):u&&i&&(gi(i)||(r=di(i)))?(r?(r=!1,o=n&&di(n)?n:[]):o=n&&gi(n)?n:{},a[t]=hi(u,o,i)):void 0!==i&&(a[t]=i))}return a},hi),yi=function(){var e=!1,t=/xyz/.test((function(){}))?/\b_super\b/:/.*/,n=function(){};return n.extend=function n(i){var r=this.prototype;e=!0;var o=new this;for(var s in e=!1,i)o[s]="function"==typeof i[s]&&"function"==typeof r[s]&&t.test(i[s])?function(e,t){return function(){var n=this._super;this._super=r[e];var i=t.apply(this,arguments);return this._super=n,i}}(s,i[s]):i[s];function a(){!e&&this.init&&this.init.apply(this,arguments)}return(a.prototype=o).constructor=a,a.extend=n,a},n}();function vi(e){return function(){console.warn('The "'+e+'" method is not available.')}}function bi(e,t,n){return Ee.get.apply(Ee,arguments)}function wi(){var e=void 0!==I&&(I.crypto||I.msCrypto)||"undefined"!=typeof crypto&&crypto;if(e&&e.getRandomValues){var t=new Uint8Array(16);e.getRandomValues(t),t[6]=15&t[6]|64,t[8]=63&t[8]|128;for(var n=[],i=0;i<256;++i)n[i]=(i+256).toString(16).substr(1);return n[t[0]]+n[t[1]]+n[t[2]]+n[t[3]]+"-"+n[t[4]]+n[t[5]]+"-"+n[t[6]]+n[t[7]]+"-"+n[t[8]]+n[t[9]]+"-"+n[t[10]]+n[t[11]]+n[t[12]]+n[t[13]]+n[t[14]]+n[t[15]]}var r=(new Date).getTime(),o="undefined"!=typeof performance&&performance.now&&1e3*performance.now()||0;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random();return r>0?(t=(r+t)%16|0,r=Math.floor(r/16)):(t=(o+t)%16|0,o=Math.floor(o/16)),("x"===e?t:3&t|8).toString(16)}))}I.CustomEvent&&"ie"!==bi(Ae,"browser.name","").toLowerCase()||!I.Event||function(){function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n}e.prototype=I.Event.prototype,I.CustomEvent=e}();const ki={basename:Wt,join:Ht,isUrl:Gt,doesUrlIncludeProtocol:qt,isRelativeUrl:Yt,replaceBaseUrl:Kt,chooseRepresentation:nn,buildUrl:rn,isAssetsDeliverySrvSourceType:on,isImageSegment:sn,SEGMENT_TYPES:Jt,parseBool:j,isBoolString:z,makeWorker:G,canSpawnWorker:Y,isInWorkerContext:K,requestAnimationFrame:cn,cancelAnimationFrame:un,extend:mi,arrayify:function(e){return Array.isArray(e)?e:[e]},isPlainObject:gi,createMethod:vi,uuid:wi,getObjectProperty:bi,setObjectProperty:function(e,t,n){return Ee.set.apply(Ee,arguments)},hasObjectProperty:function(e,t){return Ee.has.apply(Ee,arguments)},intersect:function(e,t){return e.filter((function(e){return-1!==t.indexOf(e)}))},Class:yi,dispatchSimpleEvent:function(e,t,n,i,r){n=!!n,i=!!i,e.dispatchEvent(new CustomEvent(t,{bubbles:n,cancelable:i,detail:r}))},compareVersions:Se,getTime:O,requestIdleCallback:function(e,t){if(t=t||{},I.requestIdleCallback&&!t.forceInternalImplementation)return I.requestIdleCallback.apply(I,arguments);if(e&&"function"==typeof e){var n="number"==typeof t.timeout&&t.timeout||1e3,i=O();return setTimeout((function(){var t=O();e({didTimeout:t-i>=n,timeRemaining:function(){return Math.max(0,30-(O()-t))}})}),n/2)}},cancelIdleCallback:function(e,t){if(t=t||{},I.cancelIdleCallback&&!t.forceInternalImplementation)return I.cancelIdleCallback.apply(I,arguments);clearTimeout(e)},sleep:ln};var xi,Si={exports:{}},Ci=Si.exports,_i=(xi||(xi=1,function(e){!function(t){function n(){}var i=n.prototype,r=t.EventEmitter;function o(e,t){for(var n=e.length;n--;)if(e[n].listener===t)return n;return-1}function s(e){return function(){return this[e].apply(this,arguments)}}function a(e){return"function"==typeof e||e instanceof RegExp||!(!e||"object"!=typeof e)&&a(e.listener)}i.getListeners=function(e){var t,n,i=this._getEvents();if(e instanceof RegExp)for(n in t={},i)i.hasOwnProperty(n)&&e.test(n)&&(t[n]=i[n]);else t=i[e]||(i[e]=[]);return t},i.flattenListeners=function(e){var t,n=[];for(t=0;t<e.length;t+=1)n.push(e[t].listener);return n},i.getListenersAsObject=function(e){var t,n=this.getListeners(e);return n instanceof Array&&((t={})[e]=n),t||n},i.addListener=function(e,t){if(!a(t))throw new TypeError("listener must be a function");var n,i=this.getListenersAsObject(e),r="object"==typeof t;for(n in i)i.hasOwnProperty(n)&&-1===o(i[n],t)&&i[n].push(r?t:{listener:t,once:!1});return this},i.on=s("addListener"),i.addOnceListener=function(e,t){return this.addListener(e,{listener:t,once:!0})},i.once=s("addOnceListener"),i.defineEvent=function(e){return this.getListeners(e),this},i.defineEvents=function(e){for(var t=0;t<e.length;t+=1)this.defineEvent(e[t]);return this},i.removeListener=function(e,t){var n,i,r=this.getListenersAsObject(e);for(i in r)r.hasOwnProperty(i)&&-1!==(n=o(r[i],t))&&r[i].splice(n,1);return this},i.off=s("removeListener"),i.addListeners=function(e,t){return this.manipulateListeners(!1,e,t)},i.removeListeners=function(e,t){return this.manipulateListeners(!0,e,t)},i.manipulateListeners=function(e,t,n){var i,r,o=e?this.removeListener:this.addListener,s=e?this.removeListeners:this.addListeners;if("object"!=typeof t||t instanceof RegExp)for(i=n.length;i--;)o.call(this,t,n[i]);else for(i in t)t.hasOwnProperty(i)&&(r=t[i])&&("function"==typeof r?o.call(this,i,r):s.call(this,i,r));return this},i.removeEvent=function(e){var t,n=typeof e,i=this._getEvents();if("string"===n)delete i[e];else if(e instanceof RegExp)for(t in i)i.hasOwnProperty(t)&&e.test(t)&&delete i[t];else delete this._events;return this},i.removeAllListeners=s("removeEvent"),i.emitEvent=function(e,t){var n,i,r,o,s=this.getListenersAsObject(e);for(o in s)if(s.hasOwnProperty(o))for(n=s[o].slice(0),r=0;r<n.length;r++)!0===(i=n[r]).once&&this.removeListener(e,i.listener),i.listener.apply(this,t||[])===this._getOnceReturnValue()&&this.removeListener(e,i.listener);return this},i.trigger=s("emitEvent"),i.emit=function(e){var t=Array.prototype.slice.call(arguments,1);return this.emitEvent(e,t)},i.setOnceReturnValue=function(e){return this._onceReturnValue=e,this},i._getOnceReturnValue=function(){return!this.hasOwnProperty("_onceReturnValue")||this._onceReturnValue},i._getEvents=function(){return this._events||(this._events={})},n.noConflict=function(){return t.EventEmitter=r,n},e.exports?e.exports=n:t.EventEmitter=n}("undefined"!=typeof window?window:Ci||{})}(Si)),Si.exports),Ei=r(_i),Ti=function(){Ei.apply(this,arguments)};Ti.prototype=Object.create(Ei.prototype),Ti.prototype.constructor=Ti,Ti.prototype.on=Ei.prototype.on,Ti.prototype.off=Ei.prototype.off,Ti.prototype.once=Ei.prototype.once,Ti.prototype.trigger=Ei.prototype.emit,Ti.prototype.removeAllListeners=Ei.prototype.removeAllListeners;var Pi,Ii={WARNING:2,ERROR:5,FATAL:8,toSeverityString:function(e){return Pi||(Pi={},Object.keys(Ii).forEach((function(e){"number"==typeof Ii[e]&&(Pi[Ii[e]]=e)}))),Pi[e]||"UNKNOWN"}},Ai={2:{msg:"Cannot force technology, unknown tech",severity:Ii.FATAL},3:{msg:"Could not find any supported video technology",severity:Ii.FATAL},4:{msg:"Unknown forced video format",severity:Ii.FATAL},6:{msg:"Could not create MediaSource instance",severity:Ii.FATAL},8:{msg:"Segment does not include representation"},9:{msg:"Unable to initialize worker",severity:Ii.FATAL},11:{msg:"The engine is not available",severity:Ii.FATAL},12:{msg:"Could not create cue point - no arguments given"},13:{msg:"Could not create node - no arguments given"},14:{msg:"Cannot create node - input arguments are not valid"},16:{msg:"Could not create segment - no arguments given"},17:{msg:"Cannot create segment - input arguments are not valid"},19:{msg:"Unable to set critical time, value is not a number"},21:{msg:"Invalid value supplied to currentNodeIndex",severity:Ii.WARNING},22:{msg:"Requested currentNodeIndex is beyond bounds",severity:Ii.WARNING},23:{msg:"Invalid value supplied to currenTime",severity:Ii.WARNING},24:{msg:"Requested currentTime is beyond bounds",severity:Ii.WARNING},25:{msg:"Could not perform seek operation"},26:{msg:"No video container element (or selector) provided"},27:{msg:"Could not retrieve container element"},28:{msg:"Could not find or create node"},29:{msg:"Could not create segment"},30:{msg:"Invalid argument given to updateSegment()"},31:{msg:"No segmentId given"},32:{msg:"Segment could not be found"},33:{msg:"Could not create node"},34:{msg:"Invalid argument given to update()"},35:{msg:"No nodeId given"},36:{msg:"Node could not be found"},43:{msg:"Node does not contain a segment"},47:{msg:"Could not find plugin"},48:{msg:"Plugin is not a function"},49:{msg:"Error setting SourceBuffer's timestampOffset"},51:{msg:"Error ending MediaSource stream"},64:{msg:"Invalid EngineTech configuration, 'engines' must be a non-empty array (or function that returns a non-empty array)"},69:{msg:"Invalid value supplied to bitrate"},70:{msg:"Invalid argument given to append(). Expected node object or existing node id"},71:{msg:"Invalid argument given to seek(). Expected node object or existing node id"},72:{msg:"Could not successfully resolve selector"},73:{msg:"Unable to switch channel, current node is not switchable",severity:Ii.WARNING},74:{msg:"Invalid argument given to switch()",severity:Ii.WARNING},75:{msg:"Invalid argument given to timeOffsetAtIndex()",severity:Ii.WARNING},76:{msg:"Missing required property 'source'"},77:{msg:"Unsupported IVD version"},78:{msg:"IVD error - no representations left after applying filters/transforms"},79:{msg:"Could not create node, id is a reserved keyword"},80:{msg:"SourceBuffer contains more than 1 buffered TimeRange (this is likely an indication of a gap which will cause infinite buffering)"},82:{msg:"Download error occurred. No more retries"},83:{msg:"Download error occurred",severity:Ii.WARNING},84:{msg:"Could not initialize container"},85:{msg:"Could not resolve container DOM element"},88:{msg:"Plugin initialization failed. Caught error"},89:{msg:"Invalid offset argument given to seek(). Expected value (in abs) to be between 0 to node.duration - criticalTime"},90:{msg:"Seeking error - could not resolve node"},97:{msg:"Current browser does not support the WebAudio API"},98:{msg:"Mismatch between audioBuffers and alternates"},99:{msg:"No segId or no representation given"},100:{msg:"Could not find any suitable audio representation in IVD"},101:{msg:"Invalid argument given to pluginInited(). Expected a non-empty string"},102:{msg:"Cannot register plugin, incorrect parameters supplied"},104:{msg:"Cannot decode audio data (WEBAUDIO)"}},Oi=Object.setPrototypeOf;function Li(e){var t,n,i,r,o=Ii.ERROR;return i=Array.prototype.slice.call(arguments,1),"number"==typeof e?(t=e,n=Ai.hasOwnProperty(e)?Ai[e].msg:"",o=Ai.hasOwnProperty(e)&&"number"==typeof Ai[e].severity?Ai[e].severity:Ii.ERROR):"string"==typeof e?(t=NaN,n=e):e&&"object"==typeof e&&"function"==typeof e.toString&&(t=NaN,n=e.toString(),i.push(e)),Oi?(r=new Error(n),Oi(r,Li.prototype)):r=this,r.id=t,r.args=i,Object.defineProperty(r,"name",{enumerable:!1,writable:!1,value:"InterludeError"}),Object.defineProperty(r,"Severity",{enumerable:!0,writable:!1,value:Ii}),Object.defineProperty(r,"severity",{enumerable:!0,writable:!1,value:Ii.toSeverityString(o)}),Object.defineProperty(r,"severityValue",{enumerable:!0,writable:!1,value:o}),Object.defineProperty(r,"isWarning",{enumerable:!0,writable:!1,value:o===Ii.WARNING}),Oi||(Object.defineProperty(r,"message",{enumerable:!1,writable:!0,value:n}),Error.captureStackTrace?Error.captureStackTrace(r,Li):Object.defineProperty(r,"stack",{enumerable:!1,writable:!1,value:new Error(n).stack})),r}function Ni(e){for(var t=[],n=0;n<e.length;n++)switch(typeof e[n]){case"string":t.push("'"+e[n]+"'");break;case"object":null===e[n]?t.push("null"):Array.isArray(e[n])?t.push("["+Ni(e[n]).join(", ")+"]"):t.push(e[n]);break;case"undefined":t.push("undefined");break;default:t.push(e[n])}return t}function Ri(e,t,n){return function(){return n.log.debug("-> "+t+"("+Ni(arguments).join(", ")+")"),e.apply(n,arguments)}}Oi?Oi(Li.prototype,Error.prototype):Li.prototype=Object.create(Error.prototype,{constructor:{value:Li}});var Di=["on","off","once","trigger","defineEvents","removeAllListeners","getListeners"];me.enableAll();var Mi,Fi,Bi,Ui,ji=ki.Class.extend({name:null,log:null,defaults:null,settings:null,exports:null,options:null,throwErrors:!1,excludeFuncFromAutoDebug:[],baseExcludeFuncFromAutoDebug:["ctor","getSetting","setSetting","expose","defineProperty","exposeProperty","addErrorListener"].concat(Di),logLevel:"trace",init:function(e){this.options=e,this.logLevel=e&&e[this.name]&&e[this.name].hasOwnProperty("logLevel")?e[this.name].logLevel:this.logLevel,this.log=me.createLogger(this.name,this.logLevel);var t=this.log.getIntLevel();t<=1&&this.log.debug("init: "+JSON.stringify(e&&e[this.name]||{},null,"\t")),this.settings=ki.extend(!0,{},this.settings,this.defaults,e&&e[this.name]||{});var n="*"===this.baseExcludeFuncFromAutoDebug||"*"===this.excludeFuncFromAutoDebug?"*":this.baseExcludeFuncFromAutoDebug.concat(this.excludeFuncFromAutoDebug);for(var i in this)"function"==typeof this[i]?this[i]=t>1||"*"===n||n.indexOf(i)>=0?this[i].bind(this):Ri(this[i],i,this):"object"==typeof this[i]&&null!==this[i]&&(this[i]=Array.isArray(this[i])?this[i].slice(0):ki.extend(!0,{},this[i]));for(var r,o=new Ti,s=0,a=Di.length;s<a;++s)void 0!==this[r=Di[s]]&&this.log.warn("This module is using the reserved identifier: '"+r+"'. Overriding with EventEmitter's '"+r+"' method."),this[r]=o[r].bind(o);this.ctor.apply(this,Array.prototype.slice.call(arguments,1));var l=function(){void 0!==I&&I&&"function"==typeof I.removeEventListener&&(I.removeEventListener("unload",l),I.removeEventListener("pagehide",l)),this.dispose()}.bind(this);void 0!==I&&I&&"function"==typeof I.addEventListener&&(I.addEventListener("unload",l),I.addEventListener("pagehide",l))},ctor:function(){},getSetting:function(e,t){return ki.getObjectProperty(this.settings,e,t)},setSetting:function(e,t){return ki.setObjectProperty(this.settings,e,t)},expose:function(e){this.exports=ki.extend(!0,!0,this.exports||{},e)},defineProperty:function(e,t,n){var i={enumerable:!0};t&&"function"==typeof t&&(i.get=t.bind(this)),n&&"function"==typeof n&&(i.set=n.bind(this)),Object.defineProperty(this,e,i)},exposeProperty:function(e,t){var n=Object.getOwnPropertyDescriptor(this,e);n?(t=t||e,Object.defineProperty(this.exports=this.exports||{},t,n)):this.log.warn('Could not expose property "'+e+'", did you define it using this.defineProperty() ?')},notifyError:function(){var e;if((e=1===arguments.length&&arguments[0]instanceof Error?arguments[0]:new(Li.bind.apply(Li,[null].concat(Array.prototype.slice.call(arguments))))).isWarning)this.trigger("warning",e);else if(this.getListeners("error").length)this.trigger("error",e);else{if(this.getSetting("throwErrors",this.throwErrors))throw e;this.log.error(e&&e.message)}},addErrorListener:function(e){e&&"function"==typeof e.on&&(e.on("error",this.notifyError),e.on("warning",this.notifyError))},removeErrorListener:function(e){e&&"function"==typeof e.off&&(e.off("error",this.notifyError),e.off("warning",this.notifyError))},dispose:function(){this.removeAllListeners()}}),zi=function(){if(Ui)return Bi;Ui=1;var e,t=function(){if(Fi)return Mi;Fi=1;var e=Object.prototype.hasOwnProperty;function t(t){if(!t||"[object Object]"!==toString.call(t)||t.nodeType||t.setInterval)return!1;var n,i=e.call(t,"constructor"),r=t.constructor&&t.constructor.prototype&&e.call(t.constructor.prototype,"isPrototypeOf");if(t.constructor&&!i&&!r)return!1;for(n in t);return void 0===n||e.call(t,n)}var n=function(){var e=Array.isArray,n=function(){var i,r,o,s,a,l,c,u=arguments[0]||{},d=1,h=arguments.length,p=!1,f=!1;for("boolean"==typeof u&&(p=u,u=arguments[1]||{},d=2),"boolean"==typeof arguments[1]&&(f=arguments[1],u=arguments[2]||{},d=3),"object"!=typeof u&&"function"!=typeof u&&(u={}),h===d&&(u=this,--d);d<h;d++)if(null!==(i=arguments[d])){if(p&&e(i)){u=[];for(var g=i.length,m=0;m<g;++m)t(i[m])?u.push(n(p,{},i[m])):e(i[m])?u.push(n(p,[],i[m])):u.push(i[m]);continue}for(r in i)o=u[r],u!==(s=i[r])&&(f&&(c=Object.getOwnPropertyDescriptor(i,r))&&c&&(c.get||c.set)?Object.defineProperty(u,r,c):p&&s&&(t(s)||(a=e(s)))?(a?(a=!1,l=o&&e(o)?o:[]):l=o&&t(o)?o:{},u[r]=n(p,l,s)):void 0!==s&&(u[r]=s))}return u};return n}();return Mi={extend:n,arrayify:function(e){return Array.isArray(e)?e:[e]}}}(),n={autoInit:!1,version:"0.0.0",deps:[]},i={name:null,version:"0.0.0",optional:!1},r=console;return r.info=console.log,Bi=function(o){var s=o||"",a={};function l(e,n,i,r,o,s,c){i[n]=!0,e[n]||(e[n]=function(e,n,i){var r=[];if(e){if(e.deps&&e.deps.length){var o=[];e.deps.forEach((function(e){if(a[e.name]&&a[e.name].alias){var n=t.extend({},e,{name:a[e.name].alias});o.push(n)}})),e.deps=e.deps.concat(o),r=r.concat.apply(r,e.deps.map((function(e){if(!0===e.optional){if(!a[e.name])return"";n[e.name]={}}else if(e.optional){if(!n[e.name])return""}else n[e.name]={};return e.name})).filter((function(e){return!!e})))}i&&e.loadingDeps&&e.loadingDeps.length&&e.loadingDeps.forEach((function(e){n[e.name]||(n[e.name]={}),r.includes(e.name)||r.push(e.name)}))}return{children:r}}(a[n],s,c)),o=o||[n],e[n].children.forEach((function(t){i[t]?o.indexOf(t)>=0&&log.warn("Cycle detected in dependency graph:",o.slice(o.indexOf(t)).concat(t).join(" => ")):l(e,t,i,r,o.slice(0).concat(t),s,c)})),r.push(n)}return{resolve:function(t,n){n=n||{};var i=[];l({__root:{children:Object.keys(t),loadingDeps:[]}},"__root",{},i,null,t,n.includeLoadingDeps);var o={};i=i.filter((function(e){return"__root"!==e})).reduce((function(t,n,i){return a[n]?(a[n].loadingDeps.length>0?(i=function(e){var n=-1;return e.forEach((function(e){o[e]&&i>n?n=i:t.forEach((function(t,i){t.includes(e.name)&&(o[e.name]=i,i>n&&(n=i))}))})),n}(a[n].loadingDeps),t[i+1]=t[i+1]||[],t[i+1].push(n)):t[0].push(n),t):(r.warn("Cannot resolve plugin because was not loaded yet: "+n),"function"==typeof e&&e(88,n),t)}),[[]]);var s=(i=i.map((function(e){return e.filter((function(e){return t[e]}))}))).reduce((function(e,t){return e.concat(t)}),[]);return n.includeLoadingDeps?{groupedDeps:i,flatDeps:s}:s},registerPlugin:function(o,l,c){if("string"!=typeof o||"function"!=typeof l)return r.error("Cannot register plugin, incorrect parameters supplied."),void("function"==typeof e&&e(102,o,l));if(a[o]&&a[o].alias)r.warn("Plugin '"+o+"' is deprecated, the new plugin '"+a[o].alias+"' was already registered.");else{if(a[o]&&r.warn("Plugin '"+o+"' was already registered - overriding."),(c=t.extend({},n,"boolean"==typeof c?{autoInit:!!c}:c)).deps=function(e,n){return(e=t.arrayify(e||[])).map((function(e){if(e){if("string"==typeof e)return t.extend({},i,{name:e});if(e.name)return t.extend({},i,e);r.warn("A dependency object for the '"+n+"' plugin is missing required key 'name'",e)}})).filter((function(e){return!!e}))}(c.deps,o),c.loadingDeps=function(e,n){return(e=t.arrayify(e||[])).map((function(e){if(e){if("string"==typeof e)return{name:e};if(e.name)return e;r.warn("A dependency object for the '"+n+"' plugin is missing required key 'name'",e)}})).filter((function(e){return!!e}))}(c.loadingDeps,o),c.deprecates&&Array.isArray(c.deprecates)&&c.deprecates.length>0)for(var u=0;u<c.deprecates.length;++u)a[c.deprecates[u]]={fn:l,autoInit:!1,deps:c.deps,loadingDeps:c.loadingDeps,version:c.version,alias:o,dontInitDeprecates:c.dontInitDeprecates||!1};a[o]={fn:l,autoInit:c.autoInit,deps:c.deps,redux:c.redux,version:c.version,loadingDeps:c.loadingDeps||[]},r.info("Successfully registered plugin: '"+o+"' to registry "+s+".")}},allPlugins:a,init:function(t){t.logger&&(r=t.logger),t.notifyError&&(e=t.notifyError)},id:s}},Bi}();const Vi=r(zi)();var Wi=[],Hi=me.createLogger("PluginManager","warn");Vi.init({logger:Hi});var $i=ji.extend({name:"PluginManager",logLevel:"warn",pluginCtx:null,api:null,pluginInitedDeferMap:{},_initedPlugins:{},doInitPlugin:function(e,t,n){if(!Vi.allPlugins||!Vi.allPlugins[e])return this.log.error("Could not find plugin: "+e),this.notifyError(47,e),!1;if(Vi.allPlugins[e].alias){var i="DEPRECATION WARNING: The '"+e+"' plugin is being deprecated";if(Vi.allPlugins[e].dontInitDeprecates)return this.log.warn(i),!1;this.log.warn(i+", initializing '"+Vi.allPlugins[e].alias+"' plugin instead."),e=Vi.allPlugins[e].alias}if("function"!=typeof Vi.allPlugins[e].fn)return this.log.error("Plugin is not a function: "+e),this.notifyError(48,e),!1;if(this._initedPlugins[e])return n&&this.log.warn("The '"+e+"' plugin was already initialized. Ignoring."),!0;try{var r=Vi.allPlugins[e];r.redux&&"function"==typeof r.redux.reducer&&this.pluginCtx.reduxManager.registerReducer(r.redux.namespace||e,r.redux.reducer),r.fn(this.pluginCtx,t),this._initedPlugins[e]=!0,this.log.info("Plugin '"+e+"' version "+r.version+" was successfully initialized."),this.api.trigger(this.api.events.plugininit,e,r.version),this.api.trigger(this.api.events.plugininit+e,e,r.version),this.pluginInited(e),this.pluginInitedDeferMap[e].resolve()}catch(t){return this.log.error("The '"+e+"' plugin initialization failed. Caught error:",t),this.notifyError(88,e,t),!1}return!0},mapToSortedArray:function(e){var t=ki.extend({},e),n=Vi.resolve(t);return(n=n.map((function(t){return{name:t,options:e[t]||{},explicit:e.hasOwnProperty(t)}}))).forEach(function(e){var t=Vi.allPlugins[e.name];t&&t.deps&&t.deps.length&&t.deps.forEach(function(t){var n=Vi.allPlugins[t.name];n&&ki.compareVersions(n.version,t.version)<0&&this.log.warn("The '"+e.name+"' plugin depends on a minimum version '"+t.version+"' of the '"+t.name+"' plugin, but an older version ("+n.version+") was registered")}.bind(this))}.bind(this)),this.log.info("Resolved init order:",n.map((function(e){return e.name}))),n},initPlugin:function(){var e,t=!0;return 1===arguments.length&&arguments[0]&&"object"==typeof arguments[0]?e=arguments[0]:arguments[0]&&"string"==typeof arguments[0]?(e={})[arguments[0]]=arguments.length>1?arguments[1]:{}:this.log.warn("Bad arguments given to initPlugin():",arguments),this.mapToSortedArray(e).forEach(function(e){t=this.doInitPlugin(e.name,e.options,e.explicit)&&t}.bind(this)),t},runInitialInit:function(e){if(e=e||{},Array.isArray(e)){for(var t={},n=0;n<e.length;n++){var i=e[n],r=n+1<e.length&&"object"==typeof e[n+1]?e[++n]:{};t[i]=r}e=t}for(var o in Vi.allPlugins)Vi.allPlugins[o].autoInit&&!e[o]&&(e[o]={});this.initPlugin(e)},pluginInited:function(e){if(arguments.length>1){var t=Array.prototype.slice.call(arguments,0);return S.all(t.map(function(e){return this.pluginInited(e)}.bind(this)))}return e&&"string"==typeof e?(this.pluginInitedDeferMap[e]||(this.pluginInitedDeferMap[e]=S.defer()),this.pluginInitedDeferMap[e].promise):(this.log.error("[pluginInited] Invalid argument given to pluginInited(). Expected a non-empty string, instead got:",e),this.notifyError(101,e),S())},ctor:function(e,t){this.pluginCtx=e,this.api=t,Wi.push(this),this.defineProperty("initedPlugins",(function(){var e={};return Object.keys(this._initedPlugins).forEach((function(t){e[t]=Vi.allPlugins[t].version})),e})),Vi.init({logger:this.log,notifyError:this.notifyError}),this.expose({initPlugin:this.initPlugin,initedPlugins:this.exposeProperty("initedPlugins"),pluginInited:this.pluginInited})},dispose:function(){this._super.apply(this,arguments),Wi.splice(Wi.indexOf(this),1)}});$i.registerPlugin=function(e,t,n){Vi.registerPlugin(e,t,n),Vi.allPlugins[e].autoInit&&Wi.length&&Wi.forEach((function(t){t.initPlugin(e,{})}))},Object.defineProperty($i,"registeredPlugins",{enumerable:!0,get:function(){var e={};return Object.keys(Vi.allPlugins).forEach((function(t){e[t]=Vi.allPlugins[t].version})),e}});var Gi={},qi={get:function(e){return Gi[e]||(Gi[e]={}),Gi[e]}},Yi=me.createLogger("config","warn"),Ki={engines:{default:["webcodecs","fallback"],path:"EngineTech.techs"},autoplay:{default:!1,path:"Autoplay.enabled"},muted:{default:!1,path:["AudioContextManager.muted","MseVideo.muted","FallbackVideo.muted"]},mutedAutoplayEnabled:{default:!0,path:["AudioContextManager.mutedAutoplayEnabled","MseVideo.mutedAutoplayEnabled"]},forceAudioLocked:{default:!1,path:"AudioContextManager.forceAudioLocked"},minCanplayBuffer:{default:3,path:["Controller.minBufferAhead","IdleState.minCanPlayBuffer","WaitingState.minBufferAhead","SeekingState.minBufferAhead","MetamorphosisEngine.minCanplayBuffer"]},adaptiveBitrateEnabled:{default:!0,path:["WebAudioEngine.bitrateConfig.enableAdaptiveBitrate","WebCodecsEngine.bitrateConfig.enableAdaptiveBitrate"]},ivdStrategy:{default:"auto",path:["WebAudioEngine.bitrateConfig.ivdStrategy","WebCodecsEngine.bitrateConfig.ivdStrategy"]},ivdResolutionFilterEnabled:{default:!0,path:["WebCodecsEngine.bitrateConfig.ivdResolutionFilterEnabled"]},metamorphosisEnabled:{default:!1,path:["EngineTech.useMetamorphosisFallbackEngine"]},partialPrefetchEnabled:{default:!0,path:["NodeFactory.partialPrefetchEnabled"]},priorityLoadingEnabled:{default:!0,path:["WebCodecsEngine.priorityLoadingManager.enabled","WebAudioEngine.priorityLoadingManager.enabled"]},initialBitrate:{default:void 0,path:"Controller.bitrate"},ivdMediaBaseUrl:{default:null,path:"Controller.forceBaseUrl"},scaling:{default:"panAndScan",path:"VideoScaler.mode"},panAndScanMinVisibleWidth:{default:.7,path:"PanAndScanScaler.minVisibleWidthPercentage"},panAndScanMinVisibleHeight:{default:.7,path:"PanAndScanScaler.minVisibleHeightPercentage"},fullscreenOrientation:{default:"landscape",path:"FullScreen.fullscreenOrientation"},fullscreenOptions:{default:{navigationUI:"hide"},path:"FullScreen.fullscreenOptions"},containerStyle:{default:{"background-color":"transparent","background-repeat":"no-repeat","background-position":"center","background-image":"none"},path:"Core.containerStyle"},plugins:{default:null,path:"plugins"},hardwareAcceleration:{default:"no-preference",path:["WebCodecsFormat.hardwareAcceleration","WebCodecsEngine.segmentDecoderConfig.hardwareAcceleration"]}},Xi={getFullPath:function(e){if(e&&Ki[e])return Ki[e].path},getDefault:function(e,t){return ki.getObjectProperty(Ki,e+".default",t)},processOptions:function(e){var t=ki.extend(!0,{},e=e||{}),n=t.env||Ae.name||"";return t.envOptions&&t.envOptions[n]&&(Yi.info("[processOptions] Applying envOptions for environment '"+n+"'"),t=ki.extend(!0,t,t.envOptions[n])),Object.keys(Ki).forEach((function(e){if(ki.hasObjectProperty(t,e)){var n=ki.arrayify(Ki[e].path),i=ki.getObjectProperty(t,e);n.forEach((function(e){ki.hasObjectProperty(t,e)||ki.setObjectProperty(t,e,i)}))}})),Yi.info("[processOptions] Input options:  "+JSON.stringify(e)),Yi.info("[processOptions] Output options: "+JSON.stringify(t)),t},createReadonlyOptions:function(e){e=e||{};var t={};return Object.keys(Ki).forEach((function(n){var i=e.hasOwnProperty(n)?e[n]:Ki[n].default;i&&"object"==typeof i&&(i=ki.extend(!0,{},i)),Object.defineProperty(t,n,{enumerable:!0,get:function(){return i}})})),t}},Qi=ki.getObjectProperty(Ae,"os.name","").toLowerCase(),Zi=ki.getObjectProperty(Ae,"ua","").toLowerCase().indexOf("snapchat")>=0,Ji=ji.extend({name:"Autoplay",logLevel:"warn",defaults:{enabled:Xi.getDefault("autoplay")},isBlacklistedEnv:function(){return Zi&&"ios"===Qi},getIsAutoplayExpected:function(){return this.getSetting("enabled")&&!this.isBlacklistedEnv()},ctor:function(){this.defineProperty("isAutoplayExpected",(function(){return this.getIsAutoplayExpected()})),this.expose({isAutoplayExpected:this.exposeProperty("isAutoplayExpected")})}});const er=yi.extend({time:0,callback:null,data:null});var tr,nr=ji.extend({name:"CuePointFactory",logLevel:"warn",createCuePoint:function(){var e=null;if(arguments.length)if(1===arguments.length&&"object"==typeof arguments[0])e=arguments[0]instanceof er?arguments[0]:ki.extend(new er,arguments[0]);else{e=new er;for(var t=0;t<arguments.length;t++){var n=arguments[t];switch(typeof n){case"function":e.callback=n;break;case"string":e.id=n;break;case"number":e.time=n;break;case"object":e.data=n;break;default:this.log.warn("Unknown argument: "+n)}}}else this.log.error("Could not create cue point - no arguments given"),this.notifyError(12);return e},ctor:function(){this.expose({createCuePoint:this.createCuePoint})}}),ir=/^timeupdate:(-?\d*(\.\d*)?)(\?.*?)?$/,rr=Math.random().toString(36).substring(7),or=me.createLogger("Node","warn"),sr=function(e){return ir.test(e)},ar=function(e){return parseFloat(ir.exec(e)[1])},lr=function(e){var t=ir.exec(e)[3];return!t||t.length<=1?null:W(t.slice(1))},cr=ki.Class.extend({init:function(e,t){or.info("[init] Creating node with segment and options:",e,t),t=t||{},this._segment=e;var n=new Ti,i=0,r=function(e,t){for(var n=null,i=0;i<this.cuePoints.length;i++)if(this.cuePoints[i].time===e&&this.cuePoints[i].origCallback===t){n=this.cuePoints.splice(i,1);break}return n&&this.trigger("cuepoint.removed",this,n),n}.bind(this),o=function(e,t,o,s){var a=this;tr||(tr=new nr);var l=tr.createCuePoint({id:s&&s.id||this.id+":cp_"+ ++i+"_"+rr,time:e,callback:function(){var i;t&&"function"==typeof t&&(i=t.apply(n,[a,e])),(o||!0===i)&&r(e,t)},options:s});return l.origCallback=t,this.cuePoints=this.cuePoints||[],this.cuePoints.push(l),this.trigger("cuepoint.added",this,l),l}.bind(this);this.on=function(e,t){return sr(e)?o(ar(e),t,!1,lr(e)):n.on.apply(n,arguments)},this.off=function(e,t){return sr(e)&&this.cuePoints&&this.cuePoints.length?r(ar(e),t):n.off.apply(n,arguments)}.bind(this),this.once=function(e,t){return sr(e)?o(ar(e),t,!0,lr(e)):n.once.apply(n,arguments)},this.trigger=n.trigger.bind(n),this.addPrefetch=function(e,t=10){return e&&"object"==typeof e&&e.id&&"string"==typeof e.id&&(t=(e=e.id).priority||t),e&&"string"==typeof e?(this._prefetch||(this._prefetch=[]),-1===this._prefetch.findIndex((t=>t.id===e))&&(this._prefetch.push({id:e,priority:t}),this.trigger("prefetch.added",this,e)),this):(or.warn("Invalid argument given to Node.addPrefetch(). Expected string, instead got:",e),this)}.bind(this),this.removePrefetch=function(e){if(e&&"object"==typeof e&&e.id&&"string"==typeof e.id&&(e=e.id),!e||"string"!=typeof e)return or.warn("Invalid argument given to Node.removePrefetch(). Expected string, instead got:",e),this;var t;for(this._prefetch||(this._prefetch=[]),t=0;t<this._prefetch.length&&this._prefetch[t].id!==e;t++);return t<this._prefetch.length&&(this._prefetch.splice(t,1),this.trigger("prefetch.removed",this,e)),this}.bind(this),Object.defineProperty(this,"prefetch",{enumerable:!0,get:function(){return(this._prefetch||[]).map((e=>e.id))}.bind(this),set:function(e){this._prefetch=e.map((e=>"object"==typeof e&&null!==e&&e.id?{id:e.id||e,priority:e.priority||10}:{id:e,priority:10}))}.bind(this)}),Object.defineProperty(this,"prefetchObjects",{enumerable:!0,get:function(){return this._prefetch||[]}.bind(this)}),Object.defineProperty(this,"segment",{enumerable:!0,get:function(){return this._segment}.bind(this)}),Object.defineProperty(this,"metadata",{enumerable:!0,get:function(){return this._segment&&this._segment.metadata||null}.bind(this)}),Object.defineProperty(this,"duration",{enumerable:!0,get:function(){return this._segment&&this._segment.duration||0}.bind(this)}),n.defineEvents(["cuepoint.added","cuepoint.removed","prefetch.added","prefetch.removed","volumechange","nodestart","nodeend","nodecritical","playlistpush","timeupdate"]),this.id=t.id||ki.uuid(),this.data=t.data?ki.extend(!0,{},t.data):null,this.cuePoints=[],this._prefetch=[],t.prefetch&&ki.arrayify(t.prefetch).forEach(this.addPrefetch)},id:null,prefetch:null,cuePoints:null,data:null,getWorkerSafeNode:function(){return{id:this.id,segment:this.segment.id,prefetch:this.prefetch,prefetchObjects:this.prefetchObjects,metadata:this.metadata}},getSerializableDataObject:function(){var e={};return this.data?(Object.keys(this.data).forEach(function(t){t.startsWith("_")||(e[t]=this.data[t])}.bind(this)),e):e},toJSON:function(){return{id:this.id,prefetch:this.prefetch,prefetchObjects:this.prefetchObjects,metadata:this.metadata,duration:this.duration,data:this.getSerializableDataObject()}},resolve:function(){return S()},getResolvePromise:function(){return S()},getImageUrl:function(e){var t,n,i,r,o;const s=null===(t=this.data)||void 0===t?void 0:t.imageUrl,a=null===(n=this.data)||void 0===n?void 0:n.imageStartOffset;return e={...e,...s?{imageUrl:s}:{},..."number"==typeof a?{imageStartOffset:a}:{}},null!==(i=null===(r=(o=this._segment).getImageUrl)||void 0===r?void 0:r.call(o,e))&&void 0!==i?i:null}}),ur=me.createLogger("AudioTrack","warn"),dr=ki.Class.extend({init:function(e,t){var n=new Ti,i=!1,r=1;this.on=n.on.bind(n),this.once=n.once.bind(n),this.off=n.off.bind(n),this.trigger=n.trigger.bind(n),n.defineEvents(["volumechange"]),Object.defineProperty(this,"muted",{enumerable:!0,get:function(){return i},set:function(e){i!==(e=!!e)&&(i=e,this.trigger("volumechange",this))}.bind(this)}),Object.defineProperty(this,"volume",{enumerable:!0,get:function(){return r},set:function(e){"number"!=typeof e||isNaN(e)?ur.warn("Bad volume argument, ignoring.",e):((e<0||e>1)&&ur.warn("Volume value out of range [0, 1]. Normalizing to "+(e=e<0?0:1)),r!==e&&(r=e,this.trigger("volumechange",this)))}.bind(this)}),Object.defineProperty(this,"node",{enumerable:!0,get:function(){return e}}),Object.defineProperty(this,"index",{enumerable:!0,get:function(){return t}})}}),hr=me.createLogger("Node","warn"),pr=cr.extend({_hydrateNodeDataWithSegmentData:function(){this.segment&&this.segment.data&&(this.data=mi(!0,{},this.data||{},this.segment.data))},_createSubNodes:function(e){if(!this.segment||!this.segment.subsegments)return;hr.info("[_createSubNodes] ["+this.id+"]");const t=!(null==e||!e.partialPrefetchEnabled),n=(null==e?void 0:e.partialPrefetchSegmentCount)||1;this.subnodes=[],this.segment.subsegments.forEach(function(e,t){var n=new cr(e,{id:this.id+"::"+t});n.supernode=this,this.subnodes.push(n)}.bind(this));var i=this.subnodes[this.subnodes.length-1];const r=Math.min(this.subnodes.length-1,n-1),o=t?r===this.subnodes.length-1?null:this.subnodes[r]:null;var s=this.addPrefetch;this.addPrefetch=function(){s.apply(this,arguments),i.addPrefetch.apply(i,arguments),null==o||o.addPrefetch.apply(o,arguments)}.bind(this);var a=this.removePrefetch;this.removePrefetch=function(){a.apply(this,arguments),i.removePrefetch.apply(i,arguments),null==o||o.removePrefetch.apply(o,arguments)}.bind(this);for(let e=0,n=t?r:this.subnodes.length-1;e<n;++e)this.subnodes[e]._prefetch=[{id:this.subnodes[e+1].id,priority:1}];this._prefetch&&"function"==typeof this._prefetch.slice&&(i._prefetch=this._prefetch.slice(0),o&&(o._prefetch=this._prefetch.slice(0)));var l=function(e,t,n){this.segment.currentSubSegmentIndex=n,this.trigger("subnodestart",e,n,this)}.bind(this);this.subnodes.forEach((function(e){e.on("nodestart",l)})),this.addedSubNodesDefer||(this.addedSubNodesDefer=S.defer()),this.addedSubNodesDefer.resolve(),this.trigger("subnodesadded",this)},init:function(e,t){this._super.apply(this,arguments),t=t||{};var n,i=new dr(this,-1),r=0,o=0,s=0,a=!this.data||!this.data._disableAutoRtsSwitch&&!this.data._disableAutoSwitch;this.getAudioTracks=function(){if(!n){n=[];for(var e=0;e<this.audioTracksCount;++e)n.push(new dr(this,e)),n[e].muted=0!==e;n=Object.freeze(n)}return n}.bind(this),Object.defineProperty(this,"isParallel",{enumerable:!0,get:function(){var e=this.metadata;return e&&"rts"===e.type&&(this.audioTracksCount>1||this.videoTracksCount>1)}.bind(this)}),Object.defineProperty(this,"audioTracksCount",{configurable:!0,enumerable:!0,get:function(){var e=this.metadata;return e&&e.altLength||1}}),Object.defineProperty(this,"videoTracksCount",{configurable:!0,enumerable:!0,get:function(){var e=this.metadata;return e&&e.indexMap&&Object.keys(e.indexMap).length||1}}),Object.defineProperty(this,"autoSwitchingEnabled",{enumerable:!0,get:function(){return a},set:function(e){a=!!e}}),Object.defineProperty(this,"defaultAudioTrackIndex",{enumerable:!0,get:function(){return s},set:function(e){!Number.isInteger(e)||e<0||e>=this.audioTracksCount?hr.warn("[defaultAudioTrackIndex] Unexpected value given. Expected integer in range [0, "+(this.audioTracksCount-1)+"], instead got:",e):s=e}}),Object.defineProperty(this,"defaultVideoTrackIndex",{enumerable:!0,get:function(){return o},set:function(e){!Number.isInteger(e)||e<0||e>=this.videoTracksCount?hr.warn("[defaultVideoTrackIndex] Unexpected value given. Expected integer in range [0, "+(this.videoTracksCount-1)+"], instead got:",e):o=e}}),Object.defineProperty(this,"currentAudioTrackIndex",{configurable:!0,enumerable:!0,get:function(){var e=0,t=-1;return this.getAudioTracks().forEach((function(n,i){n.muted||(++e,-1===t&&(t=i))})),1!==e?-1:t}.bind(this),set:function(e){if(!Number.isInteger(e)||e<0||e>=this.audioTracksCount)hr.warn("[currentAudioTrackIndex] Unexpected value given. Expected integer in range [0, "+(this.audioTracksCount-1)+"], instead got:",e);else{var t=this.currentAudioTrackIndex;this.getAudioTracks().forEach((function(t,n){t.muted=n!==e,t.volume=1})),this.trigger("currentaudiotrackindexchange",this,t,e)}}.bind(this)}),Object.defineProperty(this,"currentVideoTrackIndex",{configurable:!0,enumerable:!0,get:function(){return r},set:function(e){!Number.isInteger(e)||e<0||e>=this.videoTracksCount?hr.warn("[currentVideoTrackIndex] Unexpected value given. Expected integer in range [0, "+(this.videoTracksCount-1)+"], instead got:",e):e!==r&&this.trigger("currentvideotrackindexchange",this,r,r=e)}}),Object.defineProperty(this,"volume",{enumerable:!0,get:function(){return i.volume},set:function(e){i.volume=e}}),Object.defineProperty(this,"muted",{enumerable:!0,get:function(){return i.muted},set:function(e){i.muted=e}}),i.on("volumechange",function(){this.trigger("volumechange")}.bind(this)),Object.defineProperty(this,"isResolved",{enumerable:!0,get:function(){return!(!this.addedSubNodesDefer||"fulfilled"!==this.addedSubNodesDefer.promise.inspect().state)}.bind(this)}),Object.defineProperty(this,"isDurationUnknown",{enumerable:!0,get:function(){return 0===this.duration&&!this.isResolved}.bind(this)}),"number"==typeof t.defaultAudioTrackIndex&&(this.defaultAudioTrackIndex=t.defaultAudioTrackIndex),"number"==typeof t.defaultVideoTrackIndex&&(this.defaultVideoTrackIndex=t.defaultVideoTrackIndex),"boolean"==typeof t.autoSwitchingEnabled&&(this.autoSwitchingEnabled=t.autoSwitchingEnabled),"number"==typeof t.volume&&(this.volume=t.volume),"boolean"==typeof t.muted&&(this.muted=t.muted),this.segment.getResolvePromise().then(this._hydrateNodeDataWithSegmentData.bind(this)).then(this._createSubNodes.bind(this,t))},getWorkerSafeNode:function(){var e=this._super.apply(this,arguments);return e.subnodes=this.subnodes&&this.subnodes.map((function(e){return e.id}))||[],e},resolve:function(){return this.addedSubNodesDefer||(this.addedSubNodesDefer=S.defer()),this.segment.resolve(),this.addedSubNodesDefer.promise},getResolvePromise:function(){return this.addedSubNodesDefer||(this.addedSubNodesDefer=S.defer()),this.addedSubNodesDefer.promise}}),fr=ji.extend({name:"NodeFactory",logLevel:"warn",defaults:{partialPrefetchEnabled:Xi.getDefault("partialPrefetchEnabled"),partialPrefetchSegmentCount:1},createNode:function(e){if(!arguments.length)return this.log.error("Could not create node - no arguments given"),this.notifyError(13),null;if(e instanceof cr)return e;if(!e||"object"!=typeof e)return this.log.error("Cannot create node - input arguments are not valid",arguments),this.notifyError(14,Array.prototype.slice.call(arguments)),null;if(!e.hasOwnProperty("source"))return this.log.error("Missing required property 'source'.",e),this.notifyError(76,e),null;var t=this.segmentFactory.createSegment(e.source);return t?new pr(t,{...this.settings,...e}):null},ctor:function(e,t){this.segmentFactory=e,this.cuePointFactory=t,this.expose({createNode:this.createNode})}}),gr=ki.Class.extend({id:null,version:null,metadata:null,representations:null,chosenRepresentation:null,formatsObj:null,getDuration:function(){var e=this.chosenRepresentation||this.representations&&this.representations.length&&this.representations[0];return e&&e.origSamples&&e.audioSamplingRate?e.origSamples/e.audioSamplingRate:e&&e.duration?e.duration:this.metadata&&this.metadata.duration||0},hasFormat:function(e){if(!this.representations||!this.representations.length)return!1;if(!this.formatsObj){var t={};this.representations.forEach((function(e){e&&e.format&&(t[e.format]=!0)})),this.formatsObj=t}return!!this.formatsObj[e]},getWorkerSafeSegment:function(e){return{id:this.id,version:this.version,metadata:this.metadata,duration:this.duration,representations:e&&e.filterRepresentations?this.representations&&this.representations.filter(e.filterRepresentations):this.representations}},resolve:function(){return S()},getResolvePromise:function(){return S()},init:function(e){Object.defineProperty(this,"duration",{enumerable:!0,get:this.getDuration}),this.id=e.id||ki.uuid(),this.version=e.version||"",this.metadata=e.metadata||{},this.representations=e.representations;var t=new Ti;this.on=t.on,this.off=t.off,this.once=t.once,this.trigger=t.trigger}}),mr={version:"2.1.2",id:"NULL",metadata:{type:"null",duration:0},representations:[]},yr=gr.extend({playerCtx:null,hasFormat:function(e){return!(!this.subsegments||!this.subsegments.length)&&this.subsegments[0].hasFormat(e)},getDuration:function(){return this.subsegments&&this.subsegments.length?this.subsegments.map((function(e){return e.duration})).reduce((function(e,t){return e+t}),0):0},getImageUrl:function(e){var t,n;if("number"==typeof(null===(t=e)||void 0===t?void 0:t.imageStartOffset)&&(e={...e,startOffset:e.imageStartOffset}),null!==(n=e)&&void 0!==n&&n.imageUrl){const t=this.playerCtx.assetsDeliveryService.parseAssetIdAndRevision(e.imageUrl);if(t){const n=Object.fromEntries(new URL(e.imageUrl).searchParams);return this.playerCtx.assetsDeliveryService.getImageUrl(t,{...n,...e})}return e.imageUrl}return this.playerCtx.assetsDeliveryService.getImageUrl(this.ivdUrl,e)},_createSubSegmentsViaObjectArray:function(e){var t=this.playerCtx.repository;this.subsegments=e.map((function(n){var i=n&&n.id;return t&&t.hasSegment(i)?t.getSegment(i):t&&t.segmentFactory&&1===e.length&&i===mr.id+"::0"?t.segmentFactory.getNullSegment().subsegments[0]:new gr(n)}))},_initSubSegments:function(e,t){"function"==typeof t&&(e=t(e));var n=e&&e.representations||[];this.metadata!==(e&&e.metadata)&&(this.metadata=e.metadata),this.version!==(e&&e.version)&&(this.version=e.version),this.representations=[];var i={};n.forEach((function(e){var t=e&&e.segIndex||0;i[t]=i[t]||[],i[t].push(e)}));for(var r,o=[],s=0,a=e.metadata.segLength||1;s<a;++s)(r={}).metadata=e.metadata,r.version=e.version,r.id=e.id+"::"+s,r.representations=i[s],o.push(r);this._createSubSegmentsViaObjectArray(o)},init:function(e,t,n){this._super.apply(this,arguments),this.playerCtx=qi.get(n&&n.playerInstanceId),e&&e.representations&&e.representations.length&&this._initSubSegments(e,t),this.currentSubSegmentIndex=0,Object.defineProperty(this,"chosenRepresentation",{enumerable:!0,get:function(){var e=this.subsegments&&this.subsegments[this.currentSubSegmentIndex]&&this.subsegments[this.currentSubSegmentIndex].chosenRepresentation||{};return e.segmentIndex=this.currentSubSegmentIndex,e}.bind(this)})}}),vr=me.createLogger("networkUtils","warn");function br(e,t){this.name="RequestError",this.message=e||"A network request error occurred",this.stack=(new Error).stack,this.response=t}function wr(e,t,n,i){n=n||{};var r="["+e.toUpperCase()+"] ",o="object"==typeof n.headers&&n.headers||null,s="boolean"==typeof n.withCredentials&&n.withCredentials,a="number"==typeof n.retries?n.retries:5,l=a,c="number"==typeof n.retryDelay?n.retryDelay:.1,u="string"==typeof n.type&&n.type.toLowerCase().trim()||null,d="string"==typeof n.responseType&&n.responseType.toLowerCase().trim()||"";return i&&"string"!=typeof i&&"object"!=typeof i&&vr.warn(r+"Unexpected payload type '"+typeof i+"'",i),S.promise((function(h,p){vr.info(r+"Loading URL: "+t),function f(){var g=function(){var t={method:e.toUpperCase(),headers:{},credentials:s?"include":"same-origin"};if(o)for(var n in o)t.headers[n]=o[n];var r,a=(r=u)?"json"===r?"application/json":"form"===r?"application/x-www-form-urlencoded":r:null;if("POST"===t.method||"PUT"===t.method){var l=a;if(l||(l=i&&"string"==typeof i?"application/x-www-form-urlencoded":i&&"object"==typeof i?"application/json":"text/plain"),t.headers["Content-Type"]=l,null!=i)if("application/x-www-form-urlencoded"===l){if("string"==typeof i)t.body=i;else if("object"==typeof i){var c=[];for(var d in i){var h=i[d];null==h&&(h=""),c.push(encodeURIComponent(d)+"="+encodeURIComponent(h))}t.body=c.join("&")}}else if("application/json"===l)if("string"==typeof i)t.body=i;else try{t.body=JSON.stringify(i)}catch(e){t.body=""}else if("string"==typeof i)t.body=i;else if("object"==typeof i)try{t.body=JSON.stringify(i)}catch(e){t.body=""}}return t}(),m="function"==typeof fetch&&fetch||"undefined"!=typeof self&&self.fetch;m?m(t,g).then((function(i){var o,s;if(!(i&&i.status>=200&&i.status<=299)){var m=i&&i.status||0;return n.silentFail||vr.error("["+t+"] Failed with status: "+m+" ("+(i&&i.statusText||"")+"). Attempt #"+(a-l+1)+". "+(1===l?"No more retries.":""),null,i),--l>0?void setTimeout(f,1e3*c):void p(new br("Loading '"+t+"' failed with status: "+m+". No more retries.",i))}if("HEAD"===g.method){var y=(s={},(o=i)&&o.headers&&"function"==typeof o.headers.forEach&&o.headers.forEach((function(e,t){s[t]=e})),{status:o.status,statusText:o.statusText,url:o.url,headers:s});return vr.info(r+"Successfully loaded URL: "+t+".\n\tResponse:",i,"\n\tReturn value:",y),void h(y)}"arraybuffer"!==d?"text"!==u?function(t){if("get"===e&&("json"===u||"application/json"===u))return!0;if("json"===d||"application/json"===d)return!0;var n=function(e){var t="";try{t=e&&e.headers&&"function"==typeof e.headers.get&&e.headers.get("content-type")}catch(e){t=""}return(t||"").toLowerCase()}(t);return n.indexOf("application/json")>-1}(i)?i.text().then((function(e){var n;try{n=e?JSON.parse(e):null}catch(n){vr.warn("["+t+"] Expected JSON response, but JSON parsing failed:",n,"Returning text instead:",e)}var o=n||e||"";vr.info(r+"Successfully loaded URL: "+t+".\n\tResponse:",i,"\n\tReturn value:",o),h(o)})):i.text().then((function(e){var n=e||i;vr.info(r+"Successfully loaded URL: "+t+".\n\tResponse:",i,"\n\tReturn value:",n),h(n)})):i.text().then((function(e){vr.info(r+"Successfully loaded URL: "+t+".\n\tResponse:",i,"\n\tReturn value:",e),h(e)})):i.arrayBuffer().then((function(e){vr.info(r+"Successfully loaded URL: "+t+".\n\tResponse:",i,"\n\tReturn value:",e),h(e)})).catch((function(){p(new br("Loading '"+t+"' failed parsing arraybuffer.",i))}))})).catch((function(e){n.silentFail||vr.error("["+t+"] Failed with status: 0 (). Attempt #"+(a-l+1)+". "+(1===l?"No more retries.":""),e),--l>0?setTimeout(f,1e3*c):p(new br("Loading '"+t+"' failed with status: 0. No more retries.",null))})):p(new br("Fetch API is not available",null))}()}))}(br.prototype=Object.create(Error.prototype)).constructor=br;var kr={get:function(e,t){return wr("get",e,t)},post:function(e,t,n){return wr("post",e,n,t)},put:function(e,t,n){return wr("put",e,n,t)},head:function(e,t){return wr("head",e,t)},RequestError:br},xr=me.createLogger("AsyncSegment","warn"),Sr=yr.extend({isResolved:!1,ivdUrl:null,transformer:null,loadingDefer:null,playerCtx:null,baseUrl:null,resolvePartialIvdUrl:function(){if(!this.partialIvds||!this.partialIvds.length)return"";for(var e="",t=ki.getObjectProperty(this.playerCtx,"controller.exports.engine",""),n=ki.getObjectProperty(this.playerCtx,"engine.neededFormatNames",[]),i=0;i<this.partialIvds.length;i++){var r=this.partialIvds[i];if(Ae.name===r.env&&t===r.engine&&ki.intersect(n,r.formats).length>0){e=r.ivdUrl;break}}return this.baseUrl&&(e=Xt.replaceBaseUrl(e,this.baseUrl)),e?xr.info("["+this.id+"] Resolved partial IVD URL:",e):xr.info("["+this.id+"] No partial IVD found for current environment"),e},getIvdUrl:function(){return"function"==typeof this.ivdUrl?S().then(this.ivdUrl):an.isAssetsDeliverySrvSourceType(this.ivdUrl)?this.playerCtx.assetsDeliveryService.getIvdUrl(this.ivdUrl):(void 0===this.partialIvdUrl&&(this.partialIvdUrl=this.resolvePartialIvdUrl()),this.partialIvdUrl?this.partialIvdUrl:this.ivdUrl)},getDuration:function(){return this.metadata&&this.metadata.hasOwnProperty("duration")?this.metadata.duration:this.subsegments?this._super.apply(this,arguments):0},hydrateSegment:function(e){var t=this.playerCtx.repository;this._initSubSegments(e,e.id===mr.id?null:this.transformer),delete this.metadata.duration,t&&t.hasSegment(this.id)&&t.updateSegment({id:this.id},{shallowExtend:!0})},doResolveWithIvd:function(e){this.isResolved||(this.loadingDefer||(this.loadingDefer=S.defer()),e&&2===Object.keys(e).length&&e.ivd&&e.data&&(this.data=e.data,e=e.ivd),e.id=e.parentId?e.parentId:e.id,this.isResolved=!0,this.hydrateSegment(e),this.loadingDefer.resolve())},loadIvdUrl:function(){if(!this.isLoading&&!this.isLoaded){this.loadingDefer||(this.loadingDefer=S.defer()),this.isLoading=!0;var e=function(e){xr.info("[loadIvdUrl] ["+this.id+"] Response:",e),this.doResolveWithIvd(e),this.isLoading=!1,this.isLoaded=!0}.bind(this),t=function(e){this.loadingDefer.reject(e),this.isLoading=!1,this.isLoaded=!1}.bind(this);return S().then(this.getIvdUrl.bind(this)).then((function(n){n&&"object"==typeof n?e(n):"string"==typeof n&&n.startsWith("{")?e(JSON.parse(n)):n&&"null"!==n?"string"==typeof n&&(Xt.isUrl(n)||n.endsWith(".ivd"))?kr.get(n,{responseType:"json"}).then(e).catch(t):t(new Error("Unknown ivdUrl type: "+n)):e(mr)})),this.loadingDefer.promise}},resolve:function(){return xr.info("[resolve] ["+this.id+"]"),this.loadIvdUrl(),this.loadingDefer.promise},getResolvePromise:function(){return this.loadingDefer||(this.loadingDefer=S.defer()),this.loadingDefer.promise},init:function(e,t,n){this.transformer=t,this.ivdUrl=e.metadata.ivdUrl,this.partialIvds=e.partialIvds,this.baseUrl=n&&n.AsyncSegment&&n.AsyncSegment.baseUrl||null,delete e.metadata.ivdUrl,e.representations=e.representations||[],this._super.apply(this,arguments)}});const Cr=me.createLogger("ImageSegment","warn"),_r={width:-1,height:-1,contentX:0,contentY:0,contentWidth:-1,contentHeight:-1},Er=yr.extend({init:function(e,t,n){var i;this.transformer=t,this.ivdUrl=null==e||null===(i=e.metadata)||void 0===i?void 0:i.ivdUrl,this.baseUrl=n&&n.ImageSegment&&n.ImageSegment.baseUrl||null,e.representations=e.representations||[],this._super.apply(this,arguments);const r=this.metadata.frame||_r,o=this;this.metadata.frame={get width(){var e;return(null==o||null===(e=o.chosenRepresentation)||void 0===e?void 0:e.width)||r.width},get height(){var e;return(null==o||null===(e=o.chosenRepresentation)||void 0===e?void 0:e.height)||r.height},get contentX(){return 0},get contentY(){return 0},get contentWidth(){var e;return(null==o||null===(e=o.chosenRepresentation)||void 0===e?void 0:e.width)||r.width},get contentHeight(){var e;return(null==o||null===(e=o.chosenRepresentation)||void 0===e?void 0:e.height)||r.height}}}});Er.isImageIvd=sn,Er.isImageUrl=function(e){var t;return(null==e||null===(t=e.startsWith)||void 0===t?void 0:t.call(e,"image:"))&&Xt.isUrl(e.slice(6))},Er.constructImageIvd=function(e,t){var n,i;if(!Er.isImageUrl(e))return Cr.error("Invalid image URL: "+e),null;e=e.slice(6);const r=((null==t||null===(n=t.assetsDeliveryService)||void 0===n?void 0:n.parseAssetIdAndRevision)||(()=>null))(e)||{type:"unknown",assetId:wi(),assetRevision:0};if("assets-delivery-service"===r.type&&"function"==typeof(null==t||null===(i=t.assetsDeliveryService)||void 0===i?void 0:i.getImageUrl)){const n=Object.fromEntries(new URL(e).searchParams);e=t.assetsDeliveryService.getImageUrl(r,n),Cr.info("Constructed assets-delivery-service image URL:",e)}return{id:`image:${r.assetId}:${r.assetRevision}`,version:"2.1.2",metadata:{type:"image",segLength:1,ivdUrl:r,frame:_r},representations:[{segIndex:0,altIndex:0,label:"image",format:"eko-img-asset",url:e,duration:30,mimeType:"image/webp",width:_r.width,height:_r.height,keepUrlAsIs:!0}]}};var Tr={WEB_AUDIO:"webaudio",WEBCODECS:"webcodecs"},Pr={};function Ir(e,t,n,i){var r=e&&e.representations||[];if(t){e.representations=[];for(var o=0,s=r.length;o<s;++o)r[o]&&r[o].tags&&r[o].tags.length&&r[o].tags.indexOf(t)>=0&&e.representations.push(r[o]);e.representations.length||(e.representations=r)}return i&&(e.representations=e.representations.filter((function(e){return i.indexOf(e.format)>=0}))),e}Pr[Tr.WEB_AUDIO]=["webm_vorbis","oggv1","fm4a_aac","m4av1","mp3v1","wavv1"],Pr[Tr.WEBCODECS]=["fmp4_hevc","webm_vp9","fmp4_avc"];const Ar={WEB_AUDIO_COMPOSITE_ENGINES:["webcodecs"],engineTechs:Tr,getSupportedFormatNames:function(e){return Pr[e]},transform:Ir,transformIgnoreEnv:function(e,t,n,i){return Ir(e,null,0,i)}};"object"==typeof globalExports&&globalExports&&(globalExports.InterludeIvdTransformer=Ar);var Or="2.0.0",Lr="2.1.2",Nr=Ae.name,Rr=ki.getObjectProperty(Ae,"device.type",""),Dr={version:Lr,metadata:{type:"unknown",duration:0,ivdUrl:""}};function Mr(e){return e}var Fr=ji.extend({name:"SegmentFactory",logLevel:"warn",defaults:{transformIvd:Ar.transformIgnoreEnv,transformIvdEnabled:!0,repsToFilterOut:null,formatsToFilterOut:null,ivdTransformers:null},excludeFuncFromAutoDebug:["engineTransformerWrapper","filterOutRepsTransformer","filterOutFormatsTransformer"],transformers:null,engineTransformer:null,excludedRepLabelsMap:null,excludedFormatsMap:null,nullSegment:null,playerCtx:null,initTransformers:function(){this.transformers=[],this.getSetting("transformIvdEnabled")&&this.pushIvdTransformer(this.getSetting("transformIvd",Mr)),this.getSetting("repsToFilterOut")&&(this.initExcludedRepLabelsMap(),this.pushIvdTransformer(this.filterOutRepsTransformer)),this.getSetting("formatsToFilterOut")&&(this.initExcludedRepFormatsMap(),this.pushIvdTransformer(this.filterOutFormatsTransformer)),this.pushIvdTransformer(this.engineTransformerWrapper);var e=this.getSetting("ivdTransformers");e&&(e=ki.arrayify(e)).forEach(this.pushIvdTransformer)},initExcludedRepFormatsMap:function(){var e=this.getSetting("formatsToFilterOut"),t={};(e=ki.arrayify(e)).forEach((function(e){e&&"string"==typeof e&&(t[e.trim().toLowerCase()]=!0)})),this.log.info("[initExcludedRepFormatsMap] Resolved excluded formats map:",t),this.excludedFormatsMap=t},initExcludedRepLabelsMap:function(){var e=this.getSetting("repsToFilterOut"),t={};(e=ki.arrayify(e)).forEach((function(e){e&&"string"==typeof e&&(t[e.trim().toLowerCase()]=!0)})),this.log.info("[initExcludedRepLabelsMap] Resolved excluded rep labels map:",t),this.excludedRepLabelsMap=t},engineTransformerWrapper:function(e){return this.engineTransformer?this.engineTransformer(e):e},filterOutFormatsTransformer:function(e){var t=this.excludedFormatsMap;return e.representations=e.representations.filter((function(e){return e&&e.format&&!t[e.format.trim().toLowerCase()]})),e},filterOutRepsTransformer:function(e){var t=this.excludedRepLabelsMap;return e.representations=e.representations.filter((function(e){return e&&e.label&&!t[e.label.trim().toLowerCase()]})),e},applyTransformers:function(e){return this.transformers.forEach((function(t){var n=t(e,Nr,Rr);n?(0===n.representations.length&&e.representations.length>0&&this.log.warn("IVD transformer function returned an IVD with no representations:",t),e=n):this.log.warn("IVD transformer function did not return a value")}),this),e.representations&&e.representations.length||(this.log.error("IVD error - no representations left after applying filters/transforms",e),this.notifyError(78,e)),e},isLinkIVD:function(e){return e&&e.metadata&&e.version&&(!e.representations||!e.representations.length)&&e.metadata.ivdUrl},getNullSegment:function(){return this.nullSegment||(this.nullSegment=new yr(mr),this.nullSegment._initSubSegments(mr)),this.nullSegment},createSegment:function(e){return Er.isImageUrl(e)?e=Er.constructImageIvd(e,this.playerCtx):"string"==typeof e&&Xt.isUrl(e)?e=ki.extend(!0,{},Dr,{metadata:{ivdUrl:e}}):"string"==typeof e&&e.startsWith("{")?e=JSON.parse(e):"function"==typeof e?e=ki.extend(!0,{},Dr,{metadata:{ivdUrl:e}}):an.isAssetsDeliverySrvSourceType(e)?e=ki.extend(!0,{},Dr,{id:e.assetId+":"+e.assetRevision,metadata:{ivdUrl:e}}):e&&"null"!==e||(e=mr),arguments.length?e instanceof gr?e:e.id===mr.id?this.getNullSegment():"object"==typeof e&&e.version&&e.metadata&&e.metadata.type?e.id&&this.repository.segmentMap.hasOwnProperty(e.id)?this.repository.segmentMap[e.id]:ki.compareVersions(e.version,Or)<0?(this.log.error("Unsupported IVD version: "+e.version+", minimum IVD version: "+Or),this.notifyError(77,e.version,Or),null):this.isLinkIVD(e)?new Sr(e,this.applyTransformers,this.options):Er.isImageIvd(e)?new Er(e,this.applyTransformers,this.options):new yr(e,this.applyTransformers,this.options):(this.log.error("Cannot create segment - input arguments are not valid",arguments),this.notifyError(17,Array.prototype.slice.call(arguments)),null):(this.log.error("Could not create segment - no arguments given"),this.notifyError(16),null)},pushIvdTransformer:function(e){e&&"function"==typeof e?this.transformers.push(e):this.log.error("[pushIvdTransformer] Expected argument to be a function, instead got:",e)},setEngineIvdTransformer:function(e){e&&"function"==typeof e||this.log.error("[setEngineIvdTransformer] Expected argument to be a function, instead got:",e),this.engineTransformer=e},ctor:function(e){var t;this.repository=e,this.playerCtx=qi.get(null===(t=this.options)||void 0===t?void 0:t.playerInstanceId),this.initTransformers(),this.expose({createSegment:this.createSegment,setEngineIvdTransformer:this.setEngineIvdTransformer})}});Fr.getIvdVersion=function(){return{minimum:Or,latest:Lr}};var Br,Ur=["all"],jr=ji.extend({name:"Repository",logLevel:"warn",defaults:{exposeFactoryMethods:!1},cuePointFactory:null,segmentFactory:null,nodeFactory:null,nodeMap:{},segmentMap:{},addSegment:function(e){if(Array.isArray(e)||arguments.length>1&&(e=arguments)){for(var t=[],n=0;n<e.length;n++)t.push(this.addSegment(e[n]));return t}return(e=this.segmentFactory.createSegment(e))?(this.segmentMap.hasOwnProperty(e.id)&&this.log.warn("Segment id already exists in repository - overriding previous instance."),e._nodes||(e._nodes={}),this.segmentMap[e.id]=e,this._notifyChange("segment.added",e),e.getResolvePromise().then(function(){e.subsegments&&this.segmentMap[e.id]===e&&(e.subsegments.filter(function(e){return e&&e.id&&!this.segmentMap.hasOwnProperty(e.id)}.bind(this)).forEach(function(e){this.addSegment(e)}.bind(this)),this._notifyChange("segment.updated",e))}.bind(this)),this.segmentMap[e.id]):(this.log.error("Could not create segment"),this.notifyError(29),null)},updateSegment:function(e,t){var n=null;return t=t||{},e&&"object"==typeof e&&e.id?(this.segmentMap.hasOwnProperty(e.id)?(n=t.shallowExtend?ki.extend(this.segmentMap[e.id],e):ki.extend(!0,this.segmentMap[e.id],e),t.silent||this._notifyChange("segment.updated",n)):(this.log.warn('Could not find segment with id: "'+e.id+'", adding segment instead.'),n=this.addSegment(e)),n):(this.log.error("Invalid argument given to updateSegment(): "+JSON.stringify(e,null,"\t")),this.notifyError(30,JSON.stringify(e,null,"\t")),null)},hasSegment:function(e){return this.segmentMap.hasOwnProperty(e)},getSegment:function(e){var t=null;if("all"===e){for(var n in t=[],this.segmentMap)this.segmentMap.hasOwnProperty(n)&&t.push(this.segmentMap[n]);return t}if(Array.isArray(e)||arguments.length>1&&(e=arguments)){t=[];for(var i=0;i<e.length;i++)t.push(this.getSegment(e[i]));return t}return e?("string"!=typeof e&&e.id&&(e=e.id),e&&!this.segmentMap.hasOwnProperty(e)?(this.log.error("Segment could not be found: "+e),this.notifyError(32,e),null):this.segmentMap[e]):(this.log.error("No segmentId given"),this.notifyError(31),null)},removeSegment:function(e){var t,n;if("all"===e){for(t=Object.keys(this.segmentMap),n=0;n<t.length;n++)this.removeSegment(t[n]);return null}if(Array.isArray(e)||arguments.length>1&&(e=arguments)){for(n=0;n<e.length;n++)this.removeSegment(e[n]);return null}return(e=this.getSegment(e))&&(delete this.segmentMap[e.id],this._notifyChange("segment.removed",e)),null},add:function(e){var t,n=null;if(Array.isArray(e)||arguments.length>1&&(e=arguments)){for(n=[],t=0;t<e.length;t++)n.push(this.add(e[t]));return n}return(e=this.nodeFactory.createNode(e))?Ur.indexOf(e.id)>=0?(this.log.error("Could not create node, id '"+e.id+"' is a reserved keyword."),this.notifyError(79,e.id),null):(this.nodeMap[e.id]&&!this.nodeMap[e.id].hidden&&this.log.warn("Node id already exists in repository - overriding previous instance."),this.segmentMap[e.segment.id]||this.addSegment(e.segment),e.segment._nodes[e.id]=!0,this.nodeMap[e.id]=e,n=e,this._notifyChange("node.added",e),this._addNodeListeners(e),e.getResolvePromise().then(function(){e.subnodes&&e.subnodes.length&&this.nodeMap[e.id]===e&&(e.subnodes.forEach(function(e){e.hidden=!0,this.add(e)}.bind(this)),this._notifyChange("node.updated",e))}.bind(this)),n):(this.log.error("Could not create node"),this.notifyError(33),null)},update:function(e){var t,n=null;if(Array.isArray(e)||arguments.length>1&&(e=arguments)){for(n=[],t=0;t<e.length;t++)n.push(this.update(e[t]));return n}if(!e||"object"!=typeof e||!e.id)return this.log.error("Invalid argument given to updateNode(): "+JSON.stringify(e,null,"\t")),this.notifyError(34,JSON.stringify(e,null,"\t")),null;if(this.nodeMap.hasOwnProperty(e.id)){var i=e.source||null,r=null;i&&(delete e.source,r=this.segmentFactory.createSegment(i)),n=ki.extend(!0,this.nodeMap[e.id],e),r&&(n._segment&&n._segment._nodes&&n._segment._nodes[e.id]&&delete n._segment._nodes[e.id],n.subnodes&&n.subnodes.forEach((function(e){e._segment&&e._segment._nodes&&e._segment._nodes[e.id]&&delete e._segment._nodes[e.id]})),n._segment=r,delete n.addedSubNodesDefer,delete n.subnodes,n.segment.getResolvePromise().then(function(){this.nodeMap[n.id]===n&&(n._createSubNodes(),n.subnodes&&n.subnodes.forEach(function(e){this.add(e)}.bind(this)))}.bind(this))),this._notifyChange("node.updated",n)}else this.log.warn('Could not find node with id: "'+e.id+'", adding node instead.'),n=this.add(e);if(n&&n.segment&&(this.segmentMap[n.segment.id]||this.addSegment(n.segment),n.segment._nodes[n.id]=!0,n.subnodes))for(var o=0;o<n.subnodes.length;++o)n.subnodes[o].segment._nodes[n.subnodes[o].id]=!0;return n},has:function(e){return"string"!=typeof e&&e&&e.id&&(e=e.id),this.nodeMap.hasOwnProperty(e)},get:function(e){var t=null;if("all"===e)return Object.keys(this.nodeMap).map(function(e){return this.nodeMap[e]}.bind(this)).filter((function(e){return!e.hidden}));if(Array.isArray(e)||arguments.length>1&&(e=arguments)){t=[];for(var n=0;n<e.length;n++)t.push(this.get(e[n]));return t}return e?"string"!=typeof e&&e.id&&(e=e.id):(this.log.error("No nodeId given"),this.notifyError(35)),e&&!this.nodeMap.hasOwnProperty(e)?(this.log.error("Node could not be found: "+e),this.notifyError(36,e)):t=this.nodeMap[e],t},remove:function(e){if(!this.core.exports.playlist.length){var t;if("all"===e)return Object.keys(this.nodeMap).forEach(function(e){this.nodeMap[e]&&this.remove(e)}.bind(this)),null;if(Array.isArray(e)||arguments.length>1&&(e=arguments)){for(t=0;t<e.length;t++)this.remove(e[t]);return null}return(e=this.get(e))?(delete this.nodeMap[e.id],this._removeNodeListeners(e),this._notifyChange("node.removed",e),e.segment&&e.segment._nodes&&delete e.segment._nodes[e.id],e.subnodes&&e.subnodes.forEach(function(e){this.remove(e.id)}.bind(this))):this.log.warn("Node does not exists"),null}this.log.error("Playlist is not empty, cannot remove node from repository.")},reset:function(){this.core.exports.playlist.length?this.log.error("Playlist is not empty, cannot reset repository."):(this.remove("all"),this.removeSegment("all"))},resolveNodeId:function(e){return e&&this.nodeMap[e]&&this.nodeMap[e].subnodes&&this.nodeMap[e].subnodes.length?this.nodeMap[e].subnodes[0].id:e},_notifyChange:function(e){this.trigger("changed"),e&&this.trigger.apply(this,[e].concat(Array.prototype.slice.call(arguments,1)))},_onCuePointAdded:function(e,t){this._notifyChange("cuepoint.added",e,t)},_onCuePointRemoved:function(e,t){this._notifyChange("cuepoint.removed",e,t)},_onPrefetchAdded:function(e,t){this._notifyChange("prefetch.added",e,t)},_onPrefetchRemoved:function(e,t){this._notifyChange("prefetch.removed",e,t)},_onSubNodeStart:function(){this.trigger.apply(this,["subnodestart"].concat(Array.prototype.slice.call(arguments)))},_addNodeListeners:function(e){e.on("cuepoint.added",this._onCuePointAdded),e.on("cuepoint.removed",this._onCuePointRemoved),e.on("prefetch.added",this._onPrefetchAdded),e.on("prefetch.removed",this._onPrefetchRemoved),e.on("subnodestart",this._onSubNodeStart)},_removeNodeListeners:function(e){e.off("cuepoint.added",this._onCuePointAdded),e.off("cuepoint.removed",this._onCuePointRemoved),e.off("prefetch.added",this._onPrefetchAdded),e.off("prefetch.removed",this._onPrefetchRemoved),e.off("subnodestart",this._onSubNodeStart)},ctor:function(e){this.core=e,this.cuePointFactory=new nr(this.options),this.segmentFactory=new Fr(this.options,this),this.nodeFactory=new fr(this.options,this.segmentFactory,this.cuePointFactory),this.addErrorListener(this.cuePointFactory),this.addErrorListener(this.segmentFactory),this.addErrorListener(this.nodeFactory),this.expose({add:this.add,update:this.update,get:this.get,remove:this.remove,has:this.has,reset:this.reset}),this.getSetting("exposeFactoryMethods",!1)&&(this.expose(this.cuePointFactory.exports),this.expose(this.segmentFactory.exports),this.expose(this.nodeFactory.exports)),this.defineEvents(["segment.added","segment.removed","segment.updated","node.added","node.removed","node.updated","cuepoint.added","cuepoint.removed","prefetch.added","prefetch.removed"])}}),zr=ji.extend({name:"BaseState",logLevel:"warn",excludeFuncFromAutoDebug:["warnUnexpected","getCurrentTime","getPaused","getBuffered"],owner:null,unexpectedMethods:[],init:function(e){(e=e||{})[this.name]=ki.extend(!0,{bufferFullDelta:.35},e.State||e.States||e.state||e.states||{},e[this.name]||{}),this._super.apply(this,[e].concat(Array.prototype.slice.call(arguments,1)))},warnUnexpected:function(e){this.log.warn("Unexpected call to method: '"+e+"()'","Previous states: ["+this.owner._prevStates.map((function(e){return e.name})).join(", ")+"]")},enterState:function(){this.owner._state===this&&this.owner.enterState.apply(this.owner,arguments)},triggerStateEvent:function(e){e!==this.owner._prevStateEvent&&(this.log.info("[triggerStateEvent] Triggering '"+e+"' (previous state event was '"+this.owner._prevStateEvent+"')"),this.owner.triggerApiEvent.apply(this.owner,arguments),this.owner._prevStateEvent=e)},triggerControllerEvent:function(e){this.owner._state===this&&(this.log.info("[triggerControllerEvent] Triggering controller event '"+e+"'.",arguments),this.owner.trigger.apply(this.owner,arguments))},enter:function(){},exit:function(){},play:function(){},pause:function(){},seek:function(){},getCurrentTime:function(){return this.owner._playbackOffset+this.owner.video.currentTime()},getBuffered:function(){var e=this.owner._playbackOffset+this.owner.engine.buffered,t=this.getCurrentTime();return e>=this.owner._duration-this.settings.bufferFullDelta&&(e=this.owner._duration),e<t&&(e=t),e},getPaused:function(){return!0},onWaiting:function(){},onPlaying:function(){},onPause:function(){},onEnded:function(){},onPlaylistReset:function(){},ctor:function(e,t){this.owner=e,this.stateOptions=t||{},this.unexpectedMethods.forEach(function(e){this[e]=this.warnUnexpected.bind(this,e)}.bind(this))}}),Vr=me.createLogger("ticker","warn"),Wr=[],Hr=null,$r=O();function Gr(){$r=O();var e,t,n=[];for(t=Wr.length-1;t>=0;--t)$r>=(e=Wr[t]).lastTick+e.interval&&n.push(e);for(t=n.length-1;t>=0;--t)if(!(e=n[t]).stopped){e.lastTick=$r;try{e.callback()}catch(e){console&&"function"==typeof console.error?console.error(e):Vr.error(e)}}Br=cn(Gr)}function qr(){O()-$r>=200&&(un(Br),Gr())}function Yr(e){for(var t=-1,n=0;n<Wr.length;n++)if(Wr[n].callback===e){t=n;break}return t}function Kr(e,t){if(t=t||0,e&&"function"==typeof e&&"number"==typeof t&&!(t<0)){var n=Yr(e);return-1!==n?(Vr.info("[start] Callback already exists, overriding interval.",arguments),Wr[n].interval=t,e):(Wr.push({callback:e,interval:t,lastTick:O()}),1===Wr.length&&(Br=cn(Gr),Hr||(Hr=setInterval(qr,1e3))),e)}Vr.error("[start] Invalid arguments given to start method.",arguments)}function Xr(e){var t=Yr(e);-1!==t?(Wr[t].stopped=!0,Wr.splice(t,1),Wr.length||(un(Br),clearInterval(Hr),Hr=null)):Vr.info("[stop] Callback not found, doing nothing.",arguments)}function Qr(e,t,n){const i="number"==typeof n?n:(null==n?void 0:n.maxQueueSize)||Number.POSITIVE_INFINITY,r=null!=n&&n.immediatelyFlushFirst?"boolean"==typeof n.immediatelyFlushFirst?n.immediatelyFlushFirst?1:0:Number(n.immediatelyFlushFirst):0;let o=0;if("function"==typeof e){Vr.info("[createThrottler] Creating a new throttler instance.",arguments);var s=[],a={push:function(e){Vr.info("[push] Queuing argument:",e),0===s.length&&Kr(l,t),s.push(e),o++,(o<=r||s.length>=i)&&l()},flush:function(){Vr.info("[flush] Flushing queue."),0!==s.length&&l()},dispose:function(){Vr.info("[dispose] Disposing of throttler.");const e=s.slice(0);return s.length=0,Xr(l),e}};return Object.defineProperty(a,"interval",{enumerable:!0,get:function(){return t},set:function(e){"number"==typeof e&&(t=e)}}),a}function l(){Vr.info("[onThrottlerTick] Calling callback with "+s.length+" queued items.");var t=s.slice(0);s.length=0,Xr(l),e(t)}Vr.error("[createThrottler] Bad argument given to createThrottler, first argument must be a function.",arguments)}var Zr={start:Kr,stop:Xr,isTicking:function(e){return-1!==Yr(e)},predicator:function(e,t){if(t=t||{},"function"==typeof e){if(e.apply())return Vr.info("[predicator] Invoking onFulfilled immediately."),void("function"==typeof t.onFulfilled&&t.onFulfilled.call(null,0));var n,i,r,o,s=t.timeout||1e4,a=t.interval,l=O();r=function(){e.apply()&&i()},i=function(){Xr(r),clearTimeout(n),o=O()-l,Vr.info("[predicator] Invoking onFulfilled after "+o+" ms."),"function"==typeof t.onFulfilled&&t.onFulfilled.call(null,o)},n=setTimeout((function(){Xr(r),o=O()-l,Vr.info("[predicator] Invoking onTimeout after "+o+" ms."),"function"==typeof t.onTimeout&&t.onTimeout.call(null,o)}),s),Kr(r,a)}else Vr.error("[predicator] Bad argument given to predicator, first argument must be a function.",arguments)},createThrottler:Qr,scheduleExecution:function(e,t){if(e&&"function"==typeof e)return e.__tickerThrottler||(e.__tickerThrottler=Qr((function(){e()}),t)),"number"==typeof t&&(e.__tickerThrottler.interval=t),e.__tickerThrottler.push(),e.__tickerThrottler;Vr.error("[scheduleExecution] Bad argument given to scheduleExecution, first argument must be a function.",arguments)}},Jr=zr.extend({name:"IdleState",logLevel:"warn",unexpectedMethods:["onEnded"],defaults:{playbackAssuranceInterval:1,canPlayInterval:.025,minCanPlayBuffer:Xi.getDefault("minCanplayBuffer"),triggerWaitingDelay:.25},enter:function(){this.owner._prevStateEvent="",this.stateOptions.ignorePreExistingNodes||this.owner.playlist.nodes.forEach(function(e){this.log.info("[enter] Pushing pre-existing playlist node for engine playback: ["+e.id+"]"),this.owner.appendNodeForEnginePlayback(e)}.bind(this)),this.startCanPlayInterval(),this.addDocumentListeners(),this.stateOptions.play&&this.play()},exit:function(){this.stopPlaybackAssuranceInterval(),this.stopCanPlayInterval(),this.removeDocumentListeners(),this.owner._hadBeenToIdle=!0},onPlaybackAssuranceIntervalTick:function(){this.log.info("[onPlaybackAssuranceIntervalTick] Calling video.play() on interval."),this.callVideoPlay()},startPlaybackAssuranceInterval:function(){Zr.start(this.onPlaybackAssuranceIntervalTick,1e3*this.getSetting("playbackAssuranceInterval"))},stopPlaybackAssuranceInterval:function(){Zr.stop(this.onPlaybackAssuranceIntervalTick)},triggerCanplay:function(){this.triggeredCanplay||(this.log.info("Triggering 'canplay' event"),this.triggerStateEvent("canplay",[this.getBuffered(),this.owner.api.exports.isAutoplayExpected]),this.triggeredCanplay=!0)},onCanPlayIntervalTick:function(){var e=this.getBuffered();this.log.debug("[onCanPlayIntervalTick] Buffered: "+e+", Duration: "+this.owner._duration+", Requires user action: "+this.owner.engine.isUnlockingRequired),this.owner.hasBufferedEnough(this.getSetting("minCanPlayBuffer"))?(this.triggerCanplay(),this.stopCanPlayInterval(),this.owner.api.exports.isAutoplayExpected&&!this.owner._hadBeenToIdle&&(this.log.info("autoplay set to true - calling play()"),this.play())):0===e&&this.owner.engine.isUnlockingRequired&&this.owner.triggerApiEvent("requiresuseraction")},startCanPlayInterval:function(){Zr.start(this.onCanPlayIntervalTick,1e3*this.getSetting("canPlayInterval"))},stopCanPlayInterval:function(){Zr.stop(this.onCanPlayIntervalTick)},onTouchEnd:function(){this.waitingForPlaying&&this.callVideoPlay()},addDocumentListeners:function(){document&&"function"==typeof document.addEventListener&&document.addEventListener("touchend",this.onTouchEnd,!0)},removeDocumentListeners:function(){document&&"function"==typeof document.removeEventListener&&document.removeEventListener("touchend",this.onTouchEnd,!0)},callVideoPlay:function(){var e=this.owner.video.play();e&&"function"==typeof e.catch||(e=S()),e.catch(function(e){this.log.info("Caught play rejection:",e)}.bind(this))},play:function(){this.triggerStateEvent("play"),this.waitingForPlaying=!0,this.callVideoPlay(),this.startPlaybackAssuranceInterval()},pause:function(){this.waitingForPlaying=!1,this.owner.video.pause(),this.stopPlaybackAssuranceInterval()},seek:function(e){this.enterState("seeking",ki.extend(e,{play:this.waitingForPlaying}))},getPaused:function(){return!this.waitingForPlaying},onPlaying:function(){this.waitingForPlaying?(this.triggerCanplay(),this.enterState("playing")):this.owner.video.pause()},onWaiting:function(){this.waitingForPlaying&&setTimeout(function(){this.owner._state===this&&(this.log.info("Triggering 'waiting' event."),this.triggerStateEvent("waiting"))}.bind(this),1e3*this.getSetting("triggerWaitingDelay"))},onPlaylistReset:function(e){this.enterState("resetting",e)},ctor:function(e,t){this._super.apply(this,arguments);var n=!1;this.defineProperty("waitingForPlaying",(function(){return n}),(function(e){n=!!e,this.triggerControllerEvent("pausestatechange",this.getPaused())}))}}),eo=zr.extend({name:"PlayingState",logLevel:"warn",unexpectedMethods:[],excludeFuncFromAutoDebug:["warnUnexpected","getCurrentTime","getPaused","getBuffered","onTimeUpdateTick"],defaults:{timeupdateInterval:.25},onTimeUpdateTick:function(){this.owner.triggerApiEvent("timeupdate",[this.getCurrentTime()]),this.owner.dequeueNodeForEnginePlayback()},enter:function(){this.owner.video.play({nowait:!0}),Zr.start(this.onTimeUpdateTick,1e3*this.getSetting("timeupdateInterval")),this.owner.cuepoints.startInterval(),this.triggerStateEvent("playing"),this.owner.cuepoints.onTimeUpdate()},exit:function(){Zr.stop(this.onTimeUpdateTick),this.owner.cuepoints.stopInterval(),this.shouldPause&&(this.log.info("[exit] Calling pause() method of next state"),this.owner.pause())},play:function(){this.triggerStateEvent("play"),this.triggerStateEvent("playing"),this.shouldPause=!1},pause:function(){this.shouldPause=!0,this.owner.video.pause()},seek:function(e){this.enterState("seeking",e)},onWaiting:function(){this.enterState("waiting")},onPause:function(){this.shouldPause?this.enterState("paused"):(this.log.warn("[onPause] Detected unexpected 'pause' event while playing, explicitly calling play() to continue playing."),this.owner.video.play({nowait:!0}))},onEnded:function(){this.enterState("ended")},onPlaylistReset:function(e){this.enterState("resetting",e)},getPaused:function(){return!!this.shouldPause},ctor:function(e,t){this._super.apply(this,arguments);var n=!1;this.defineProperty("shouldPause",(function(){return n}),(function(e){n=!!e,this.triggerControllerEvent("pausestatechange",this.getPaused())}))}}),to=zr.extend({name:"PausedState",logLevel:"warn",unexpectedMethods:[],enter:function(){this.owner.video.pause(),this.owner.triggerApiEvent("timeupdate",[this.getCurrentTime()]),this.triggerStateEvent("pause")},exit:function(){},play:function(){this.expectingPlayingEvent=!0,this.triggerStateEvent("play"),this.owner.video.play()},pause:function(){this.expectingPlayingEvent&&(this.expectingPlayingEvent=!1,this.owner.video.pause())},seek:function(e){this.enterState("seeking",e)},getPaused:function(){return!this.expectingPlayingEvent},onPlaying:function(){if(!this.expectingPlayingEvent)return this.log.warn("[onPlaying] Not expecting a 'playing' event. Explicitly pausing video."),void this.owner.video.pause();this.enterState("playing")},onPlaylistReset:function(e){this.enterState("resetting",e)},onEnded:function(){this.enterState("ended")},ctor:function(e,t){this._super.apply(this,arguments);var n=!1;this.defineProperty("expectingPlayingEvent",(function(){return n}),(function(e){n=!!e,this.triggerControllerEvent("pausestatechange",this.getPaused())}))}}),no=zr.extend({name:"EndedState",logLevel:"warn",unexpectedMethods:["onWaiting"],enter:function(){this.owner.cuepoints.dispatchCuePoints(this.owner._duration,!0),this.owner.triggerApiEvent("timeupdate",[this.owner._duration]),this.triggerStateEvent("ended"),this.owner.video.pause()},exit:function(){},seek:function(e){this.enterState("seeking",e)},getCurrentTime:function(){return this.owner._duration},getPaused:function(){return!0},onPlaying:function(){this.log.warn("[onPlaying] Detected unexpected 'playing' event while ended, explicitly calling pause()."),this.owner.video.pause()},onPlaylistReset:function(e){this.enterState("resetting",e)}}),io=zr.extend({name:"SeekingState",logLevel:"warn",unexpectedMethods:["onEnded"],defaults:{waitingTimeout:2.5,bufferedEnoughTimeout:5,minBufferAhead:Xi.getDefault("minCanplayBuffer")},nextStateOptions:null,isNextStateSeeking:!1,nextSeekingStateOptions:null,triggeredWaiting:!1,seekToTime:NaN,seekOptions:null,waitingForPlaying:!1,callPlayOnIdle:!1,isPostEngineSeek:!1,performOnExitFns:[],enterNextState:function(){this.log.info("[enterNextState]",this.nextState),this.isNextStateSeeking?this.enterState("seeking",this.nextSeekingStateOptions):"playing"===this.nextState?(this.waitingForPlaying=!0,this.owner.video.play()):("paused"===this.nextState&&this.triggeredWaiting&&this.triggerStateEvent("playing"),this.enterState(this.nextState,this.nextStateOptions),"idle"===this.nextState&&this.callPlayOnIdle&&this.owner.play())},performOnExit:function(e){this.performOnExitFns.push(e)},enter:function(){this.owner.video.pause(),this.seekToTime=this.stateOptions.seekToTime,this.seekOptions=this.stateOptions.seekOptions||{},this.seekOptions.seekToTime=this.seekToTime,this.log.info("[enter] Seeking with options:",this.seekOptions);var e=this.stateOptions.prevState,t=e&&e.name&&e.name.toLowerCase();t&&(t.indexOf("paused")>=0||t.indexOf("ended")>=0)?this.nextState="paused":e&&t.indexOf("idle")>=0?this.owner._visitedStatesMap.playing?this.nextState="paused":(this.nextState="idle",this.nextStateOptions={ignorePreExistingNodes:!0,play:this.stateOptions.play}):this.nextState="playing",this.stateOptions.nextState&&(this.nextState=this.stateOptions.nextState,this.nextStateOptions=this.stateOptions.nextStateOptions),setTimeout(function(){if(this===this.owner._state){if("idle"===this.nextState)return void this.log.info("Seek waiting timeout expired, but we've never played before, so no 'waiting' event will be triggered.");this.log.info("Seek waiting timeout expired, triggering 'waiting' event."),this.triggerStateEvent("waiting"),this.triggeredWaiting=!0}}.bind(this),1e3*this.getSetting("waitingTimeout"));var n,i,r=this.seekToTime,o=0,s=0;for(this.owner._appendDisabled=!0,i=0;i<this.owner.playlist.nodes.length;i++){if(r>=o&&r<o+this.owner.playlist.nodes[i].duration){n=this.owner.playlist.nodes[i];break}o+=this.owner.playlist.nodes[i].duration||0}s=r-o,this.seekOptions.silence||this.triggerStateEvent("seeking",[this.seekOptions]);var a,l=[],c=0;if(n&&n.subnodes&&n.subnodes.length&&(n.subnodes.forEach((function(e,t,n){var i=e.duration||0;!a&&(s<i||t===n.length-1)?a=e:a?l.push(e):(s-=i,c+=i)})),n=a,s<0&&(s=0)),!n)return this.log.error("Seeking error - could not resolve node"),this.notifyError(90),void this.enterNextState();this.log.info("Seeking "+c+" seconds into '"+n.id+"'."),this.seekToTime=o+c+s;var u=this.owner._playbackOffset;this.owner._playbackOffset=o+c;var d=this.owner._currentNodeIndex;this.owner._currentNodeIndex=i,this.owner.triggerApiEvent("timeupdate",[this.getCurrentTime()]),this.owner.resetAppendQueue().then(this.owner.engine.seek.bind(this.owner.engine,n.id,s)).then(function(){this.owner._appendDisabled=!1,this.isPostEngineSeek=!0,l.forEach(this.owner.appendNodeForEnginePlayback),this.owner.appendPlaylistForEnginePlaybackFromIndex(i+1),this.log.info("Successfully seeked video"),this.performOnExit(function(){this.seekOptions.silence||(this.log.info('Triggering "seeked" event'),this.triggerStateEvent("seeked",[this.owner._playbackOffset+s,i,o,this.seekOptions]))}.bind(this))}.bind(this)).then(function(){return S.promise(function(e){Zr.predicator(this.owner.hasBufferedEnough.bind(this.owner,this.getSetting("minBufferAhead",3)),{timeout:1e3*this.getSetting("bufferedEnoughTimeout"),onFulfilled:function(t){this.log.info("[onFulfilled] Resolving isReady promise after "+(t/1e3).toFixed(3)+" seconds."),e()}.bind(this),onTimeout:function(){this.log.warn("[onTimeout] Resolving isReady promise due to timeout."),e()}.bind(this)})}.bind(this))}.bind(this)).then(this.enterNextState).catch(function(e){this.owner._playbackOffset=u,this.owner._currentNodeIndex=d,this.performOnExit(function(){this.log.error("Could not perform seek operation.",e),this.owner.notifyError(25,e)}.bind(this)),this.enterNextState()}.bind(this))},exit:function(){this.owner._appendDisabled=!1,this.performOnExitFns.forEach((function(e){e.apply()}))},play:function(){if("resetting"!==this.nextState){if(this.triggerStateEvent("play"),"idle"===this.nextState)return this.log.info("[play] Next state is idle, so let's set callPlayOnIdle and call video play in order to potentially unlock playback."),this.callPlayOnIdle=!0,void this.owner.video.play();this.nextState="playing"}},pause:function(){"resetting"!==this.nextState&&(this.nextState="paused")},seek:function(e){this.isNextStateSeeking=!0,this.nextSeekingStateOptions=ki.extend({},e,{nextState:this.nextState,nextStateOptions:this.nextStateOptions}),this.waitingForPlaying&&(this.log.info("[seek] Seek requested while waiting for playing, entering next seeking state."),this.waitingForPlaying=!1,this.owner.video.pause(),this.enterState("seeking",this.nextSeekingStateOptions))},getCurrentTime:function(){return this.seekToTime},getBuffered:function(){return this.isPostEngineSeek?this._super():this.seekToTime},getPaused:function(){return"paused"===this.nextState},onPlaying:function(){this.waitingForPlaying?(this.log.info("[onPlaying] Entering 'playing' state."),this.enterState("playing")):(this.log.info("[onPlaying] Unexpected onPlaying, explicitly calling pause()"),this.owner.video.pause())},onPlaylistReset:function(e){this.waitingForPlaying?this.enterState("resetting",e):(this.nextState="resetting",this.nextStateOptions=e)},ctor:function(e,t){this._super.apply(this,arguments);var n="playing";this.defineProperty("nextState",(function(){return n}),(function(e){n=e,this.triggerControllerEvent("pausestatechange",this.getPaused())}))}});function ro(e,t){return e.x-t.x}function oo(e){return"("+(e&&e.x)+", "+(e&&e.y)+")"}function so(e,t,n){return Math.min(Math.max(e,t),n)}var ao={sortPoints:function(e){return e.sort(ro)},pointToStr:oo,pointsToStr:function(e){return"["+(e&&e.length&&e.map(oo).join(", "))+"]"},isPoint:function(e){return e&&"object"==typeof e&&"number"==typeof e.x&&"number"==typeof e.y&&!isNaN(e.x)&&!isNaN(e.y)},clamp:so,snapToClosestInArray:function(e,t){if(!Array.isArray(t)||!t.length)return NaN;var n=t[0];return t.forEach((function(t){Math.abs(e-t)<Math.abs(e-n)&&(n=t)})),n},snapUpInArray:function(e,t){if(!Array.isArray(t)||!t.length)return NaN;t=t.slice().sort((function(e,t){return e-t}));for(var n=NaN,i=0,r=t.length;i<r;++i)if(t[i]>=e){n=t[i];break}return isNaN(n)&&(n=t[t.length-1]),n},snapDownInArray:function(e,t){if(!Array.isArray(t)||!t.length)return NaN;t=t.slice().sort((function(e,t){return t-e}));for(var n=NaN,i=0,r=t.length;i<r;++i)if(t[i]<=e){n=t[i];break}return isNaN(n)&&(n=t[t.length-1]),n},avg:function e(t){return arguments.length>1?e(Array.prototype.slice.call(arguments,0)):t&&Array.isArray(t)&&t.length?t.reduce((function(e,t){return e+t}),0)/t.length:NaN}},lo=zr.extend({name:"WaitingState",logLevel:"warn",unexpectedMethods:["onEnded"],defaults:{minBufferAhead:Xi.getDefault("minCanplayBuffer"),maxWaitingTime:10,triggerWaitingDelay:.25,predicatorInterval:.08,playingNotTriggeredErrorTimeout:2},isWaitingEnded:!1,isWaitingStarted:!1,onWaitingEnd:function(){if(this.owner._state===this)if(this.isWaitingEnded=!0,"playing"===this.nextState){if(!this.owner.video.getPaused())return this.log.info("Video was never paused, entering playing state immediately."),this.owner.video.play({nowait:!0}),void this.enterState("playing");this.owner.video.once("playing",this.enterState.bind(this,"playing")),this.owner.video.play(),setTimeout(function(){if(this.owner._state===this){this.log.error(`Infinite buffering potentially detected with engine: ${this.owner.engine.videoTech()}. Attempting to recover.`);const e=0-this.owner.cuepoints.getSetting("internalPerNode.nodecritical.time");this.owner.api.exports.currentTime=so(this.owner.api.exports.currentTime,0,this.owner.api.exports.duration-(e+1e-4)),this.owner.play()}}.bind(this),1e3*this.getSetting("playingNotTriggeredErrorTimeout"))}else this.triggerStateEvent("playing"),this.enterState("paused")},enter:function(){setTimeout(function(){this.owner._state!==this||this.isWaitingEnded||(this.log.info("Forcing pause() and triggering 'waiting' event."),this.owner.video.pause(),this.triggerStateEvent("waiting"),this.isWaitingStarted=!0)}.bind(this),1e3*this.getSetting("triggerWaitingDelay"));var e=this.getCurrentTime();this.log.info("Entering 'waiting' state @ time: "+e.toFixed(2)),Zr.predicator(this.owner.hasBufferedEnough.bind(this.owner,this.getSetting("minBufferAhead",3)),{timeout:1e3*this.getSetting("maxWaitingTime"),interval:1e3*this.getSetting("predicatorInterval"),onFulfilled:this.onWaitingEnd,onTimeout:this.onWaitingEnd})},exit:function(){},play:function(){this.triggerStateEvent("play"),this.nextState="playing"},pause:function(){this.nextState="paused"},seek:function(e){this.enterState("seeking",e)},onPlaying:function(){this.isWaitingStarted&&!this.isWaitingEnded&&this.owner.video.pause()},getPaused:function(){return"paused"===this.nextState},onPlaylistReset:function(e){this.enterState("resetting",e)},ctor:function(e,t){this._super.apply(this,arguments);var n="playing";this.defineProperty("nextState",(function(){return n}),(function(e){n=e,this.triggerControllerEvent("pausestatechange",this.getPaused())}))}}),co=zr.extend({name:"ResettingState",logLevel:"warn",unexpectedMethods:["onWaiting"],enter:function(){this.owner._appendDisabled=!0,this.owner.video.pause(),this.owner._currentNodeIndex=0,this.owner._playbackOffset=0,this.owner.calcDuration(),this.owner.triggerApiEvent("timeupdate",[this.getCurrentTime()]),this.owner.resetAppendQueue().then(function(){this.log.info("Successfully reset controller append queue.")}.bind(this)).then(this.owner.engine.reset).then(function(){this.log.info("Successfully reset engine: "+this.owner.engine.videoTech())}.bind(this)).then(function(){this.enterState("idle",{play:!!this.shouldPlay})}.bind(this))},exit:function(){this.log.info("Triggering 'playlistreset' event."),this.owner.triggerApiEvent("playlistreset",[this.resetOptions]),this.owner._appendDisabled=!1},play:function(){this.shouldPlay=!0},pause:function(){this.shouldPlay=!1},getCurrentTime:function(){return 0},getPaused:function(){return!0},ctor:function(e,t){this._super.apply(this,arguments),this.resetOptions=t||null}}),uo=me.createLogger("StateFactory","warn");function ho(e,t){return e&&e.StateFactory&&e.StateFactory.logLevel&&uo.setLevel(e.StateFactory.logLevel),{createState:function(n,i){uo.debug(" -> createState("+n+")");var r=null;switch(n){case"idle":r=new Jr(e,t,i);break;case"playing":r=new eo(e,t,i);break;case"paused":r=new to(e,t,i);break;case"ended":r=new no(e,t,i);break;case"seeking":r=new io(e,t,i);break;case"waiting":r=new lo(e,t,i);break;case"resetting":r=new co(e,t,i);break;default:uo.warn("Unknown requested state: "+n)}return r}}}function po(e,t){if(!e||"function"!=typeof e)throw new Error("[ExecQueue] Bad argument given to constructor");var n,i=[],r="function"==typeof(t=t||{}).predicate&&t.predicate||function(){return!0},o=!1;n=function(){o=!1,this.execNext()}.bind(this),this.push=function(e){i.push(e),this.execNext()},this.reset=function(){i.length=0},this.execNext=function(){if(o||!i.length||!r(i[0]))return!1;var t=i.shift();o=!0;var s=e(t);return s&&"function"==typeof s.then?(s=s.then(n,n),!0):(n(),!0)},Object.defineProperty(this,"length",{enumerable:!0,get:function(){return i.length}})}var fo=ji.extend({name:"Controller",logLevel:"warn",excludeFuncFromAutoDebug:["triggerApiEvent","nodeDuration","getCurrentTime","getDuration","callStateMethodLogDisabled","getCurrentNode","getCurrentNodeIndex","getCurrentNodeId","getBitrate","dequeueNodeForEnginePlayback","getPlaybackRate","setPlaybackRate","scheduleBitrateGuesstimatorUpdate","doBitrateGuesstimatorUpdate"],defaults:{autoPauseOnVisibilityChange:!0,autoResumeOnVisibilityChange:!0,autoPauseOnPresumedVisibilityChange:!0,autoResumeOnPresumedVisibilityChange:!0,presumedVisibilityAssuranceTimeout:.1,criticalTime:{webcodecs:1.5,webaudio:1.5,null:1.5,fallback:1.5},bitrate:void 0,bitrateGuesstimatorUpdateInterval:10,forceBaseUrl:Xi.getDefault("forceBaseUrl"),minBufferAhead:Xi.getDefault("minCanplayBuffer"),maxBufferSecondsAhead:60,maxPrevStates:3,minPlaybackRate:.5,playbackRate:1,maxPlaybackRate:4,enablePlayerjsAdapter:!1,endedDelta:.25},playlist:null,repository:null,engine:null,video:null,api:null,cuepoints:null,fullScreen:null,cdnOptimizer:null,deprecator:null,playerjsAdapter:null,bitrateGuesstimator:null,pushToAppendQueuePromise:null,_duration:0,_currentNodeIndex:0,_playbackOffset:0,_bitrate:NaN,_wasPlaying:null,_appendQueue:[],_appendedDuration:0,_currentlyAppending:!1,_state:null,_prevStates:[],_prevStateEvent:"",_visitedStatesMap:{},_stateFactory:null,_currentVideoSource:null,_stateExecQueue:null,triggerApiEvent:function(e,t){arguments.length>2&&this.log.warn("[triggerApiEvent] Unexpected arguments.length for event '"+e+"'.",arguments),"timeupdate"!==e&&this.log.debug("Dispatching API event: "+e),void 0===t&&(t=[]),t&&!Array.isArray(t)&&"object"==typeof t&&"number"==typeof t.length&&(t=Array.prototype.slice.call(t,0)),this.api.trigger.apply(this.api,[e].concat(t))},doAddRemoveListeners:function(e){var t=e?"on":"off",n=e?"addEventListener":"removeEventListener";this.video&&(this.video[t](this.api.events.volumechange,this.onVolumeChange),this.video[t](this.api.events.audiolockedchange,this.onAudioLockedChange),this.video[t](this.api.events.resize,this.onResize),this.video[t](this.api.events.loadeddata,this.onLoadedData),this.video[t](this.api.events.playing,this.onPlaying),this.video[t](this.api.events.waiting,this.onWaiting),this.video[t](this.api.events.pause,this.onPause),this.video[t](this.api.events.ended,this.onEnded)),this.fullScreen&&this.fullScreen[t](this.api.events.fullscreenchange,this.onFullscreenChange),this.engine&&(this.engine[t]("bitrateUpdated",this.onEngineBitrateUpdated),this.engine[t]("representationChosen",this.onEngineRepresentationChosen),this.engine[t]("representationsChosen",this.onEngineRepresentationsChosen)),this.playlist&&(this.playlist[t]("push",this.onPlaylistPush),this.playlist[t]("reset",this.onPlaylistReset)),this.repository&&(this.repository[t]("segment.updated",this.onSegmentUpdated),this.repository[t]("node.updated",this.onNodeUpdated),this.repository[t]("subnodestart",this.onSubNodeStart)),this.cuepoints&&(this.cuepoints[t]("nodestart",this.onCuePointsNodeStart),this.cuepoints[t]("nodeend",this.onCuePointsNodeEnd),this.cuepoints[t]("nodecritical",this.onCuePointsNodeCritical),this.cuepoints[t]("waiting",this.onWaiting),this.cuepoints[t]("playing",this.onPlaying)),this.api.exports&&this.api.exports[t]("presumedvisibilitychange",this.onPresumedVisibilityChange),document&&document[n]("visibilitychange",this.onDocumentVisibilityChange)},onDocumentVisibilityChange:function(){switch(document.visibilityState){case"visible":this.getSetting("autoResumeOnVisibilityChange",!1)&&this._wasPlaying&&(this._wasPlaying=!1,this.play());break;case"hidden":this.getSetting("autoPauseOnVisibilityChange",!1)&&(this._wasPlaying=!this.getPaused(),this.pause())}},onPresumedVisibilityChange:async function(){const e=this.presumedVisibility.isPresumedVisible;await ln(1e3*this.getSetting("presumedVisibilityAssuranceTimeout")),e===this.presumedVisibility.isPresumedVisible&&(e?this.getSetting("autoResumeOnPresumedVisibilityChange",!1)&&this._wasPlayingPresumedVisibility&&(this._wasPlayingPresumedVisibility=!1,this.play()):this.getSetting("autoPauseOnPresumedVisibilityChange",!1)&&(this.log.warn("[onPresumedVisibilityChange] Auto-pausing due to presumed visibility change."),this._wasPlayingPresumedVisibility=!this.getPaused(),this.pause()))},resetAppendQueue:function(){return this._appendQueue=[],this._appendedDuration=0,this.pushToAppendQueuePromise=null,this._currentlyAppending?this._currentlyAppending.then(function(){this._currentlyAppending=!1}.bind(this)):S()},pushToAppendQueue:function(e){this._appendQueue.push(e),1!==this._appendQueue.length||this._currentlyAppending||this.dequeueNodeForEnginePlayback()},dequeueNodeForEnginePlayback:function(){if(!this._currentlyAppending&&this._appendQueue.length&&this.shouldAppendNodeForEnginePlayback()){var e=this._appendQueue.shift(),t=this.repository.get(e);if(!t||!t.segment)return void this.log.error("[dequeueNodeForEnginePlayback] Unknown node:",e);this.log.info("[dequeueNodeForEnginePlayback] Appending '"+e+"' for engine playback."),this._currentlyAppending=S().then(this.engine.appendNode.bind(this.engine,e)).then(function(){this._appendedDuration+=t&&t.duration||0,this._currentlyAppending=!1,this.dequeueNodeForEnginePlayback()}.bind(this)).catch(function(e){this.notifyError(e)}.bind(this))}},shouldAppendNodeForEnginePlayback:function(){var e=this.getCurrentTime()-this._playbackOffset;return this._appendedDuration-e<this.getSetting("maxBufferSecondsAhead",60)},appendNodeForEnginePlayback:function(e){if(!this._appendDisabled){this.pushToAppendQueuePromise||(this.pushToAppendQueuePromise=S());var t=this._appendQueue;this.pushToAppendQueuePromise=this.pushToAppendQueuePromise.then(function(){if(!this._appendDisabled&&t===this._appendQueue)return e instanceof pr?e.resolve().then(function(){this._appendDisabled||t!==this._appendQueue||e.subnodes.forEach(function(e){this.pushToAppendQueue(e.id)}.bind(this))}.bind(this)):void this.pushToAppendQueue(e.id)}.bind(this))}},appendPlaylistForEnginePlaybackFromIndex:function(e){var t=e<this.playlist.nodes.length?this.playlist.nodes.slice(e,this.playlist.nodes.length):[];this.log.info("[appendPlaylistForEnginePlaybackFromIndex] Appending next nodes: ["+t.map((function(e){return e&&e.id})).join(", ")+"]"),t.forEach(function(e){this.appendNodeForEnginePlayback(e)}.bind(this))},doBitrateGuesstimatorUpdate:function(){this.bitrateGuesstimator&&this.bitrateGuesstimator.update(this._bitrate)},scheduleBitrateGuesstimatorUpdate:function(){this.bitrateGuesstimator&&(this.bitrateGuesstimator.__calledUpdate?Zr.scheduleExecution(this.doBitrateGuesstimatorUpdate,1e3*this.getSetting("bitrateGuesstimatorUpdateInterval")):(this.doBitrateGuesstimatorUpdate(),this.bitrateGuesstimator.__calledUpdate=!0))},onEngineBitrateUpdated:function(e){this.setBitrate(e,!0),this.scheduleBitrateGuesstimatorUpdate()},onEngineRepresentationChosen:function(e,t){this.repository.hasSegment(e)&&this.repository.updateSegment({id:e,chosenRepresentation:t},{shallowExtend:!0})},onEngineRepresentationsChosen:function(e){var t=[];e.forEach(function(e){this.repository.hasSegment(e.segId)&&t.push(this.repository.updateSegment({id:e.segId,chosenRepresentation:e.chosenRep},{silent:!0,shallowExtend:!0}))}.bind(this)),t.length&&this.repository._notifyChange("segment.updated",t)},calcDurationOfNodeArray:function(e){return e.map((function(e){return e&&e.duration||0})).reduce((function(e,t){return e+t}),0)},nodeDuration:function(e){return e&&e.duration||0},calcDuration:function(){this._duration=this.playlist.calcPlaylistDuration(),this.prevReportedDuration!==this._duration&&(this.triggerApiEvent(this.api.events.durationchange,[this.duration]),this.prevReportedDuration=this._duration)},setCriticalTime:function(){var e=this.getSetting("criticalTime",3),t=[this.engine.videoTech()];0===t[0].indexOf("composite")?t=t[0].substring(9).split(",").map((function(e){return e.replace(/[\(\)]/g,"").trim()})):0===t[0].indexOf("metamorphosis")&&(t=this.engine.engines.map((e=>e.engineStr)));var n=function(e){if("number"!=typeof e)return this.log.error("Unable to set critical time, value "+e+" is not a number."),void this.notifyError(19,e);e=Math.abs(e),this.log.info("Setting critical time: "+e),this.cuepoints.setSetting("internalPerNode.nodecritical.time",0-e)}.bind(this);switch(typeof e){case"number":n(e);break;case"object":n(Math.max.apply(null,t.map(function(t){var n=3;return e&&"number"==typeof e[t]?n=e[t]:this.log.warn("Settings object 'criticalTime' is missing a \""+t+'" property.'),n}.bind(this))));break;case"function":n(e())}},getCriticalTime:function(){return 0-this.cuepoints.getSetting("internalPerNode.nodecritical.time")},getDuration:function(){return this._duration},getCurrentNode:function(){return this._currentNodeIndex<this.playlist.nodes.length?this.playlist.nodes[this._currentNodeIndex]:null},getCurrentNodeId:function(){return this._currentNodeIndex<this.playlist.nodes.length?this.playlist.nodes[this._currentNodeIndex].id:""},getCurrentNodeIndex:function(){return this._currentNodeIndex},isPlaylistResolved:function(){return this.playlist.nodes.reduce((function(e,t){return e&&t.isResolved}),!0)},isPlaylistResolvedUpToTime:function(e){for(var t,n=this.getCriticalTime(),i=0,r=0;r<this.playlist.nodes.length;++r){if(!(t=this.playlist.nodes[r]).isResolved)return!1;if(i-n>=e)return!0;i+=t.duration}return!0},isPlaylistResolvedUpToIndex:function(e){if(e<0)return!0;var t=this.playlist.nodes.length;return this.playlist.nodes.slice(0,e=e>=t?t:e+1).reduce((function(e,t){return e&&t.isResolved}),!0)},hasBufferedEnough:function(e){var t=this.getCurrentTime(),n=this.getBuffered(),i=this._duration;return n-t>=(e="number"==typeof e?e:this.getSetting("minBufferAhead"))||i&&n===i},playlistNodesResolvedUpToTimePromise:function(e,t){var n=t||this.playlist.nodes,i=[],r=this.getCriticalTime();return n.map((function(t){return function(n){return n-r>=e?n:t.isResolved?n+t.duration:(t.trigger("waitToResolve",t),t.duration>0?(i.push(t.resolve()),n+t.duration):t.resolve().then((function(){return n+t.duration})))}})).reduce((function(e,t){return e.then(t)}),S(0)).then((function(){return S.all(i)}))},playlistNodesResolvedUpToIndexPromise:function(e,t){if(e<0)return S();var n=t||this.playlist.nodes,i=[];return n.slice(0,e=e>=n.length?n.length:e+1).forEach((function(e){e.isResolved||(e.trigger("waitToResolve",e),i.push(e.resolve()))})),S.all(i)},setCurrentNodeIndex:function(e,t){if(t=t||{},e<0||isNaN(e)||"number"!=typeof e)return this.log.warn("Invalid value supplied to currentNodeIndex:",e),void this.notifyError(21,e);if(e>=this.playlist.nodes.length)return this.log.warn("Requested currentNodeIndex is beyond playlist"),void this.notifyError(22);var n=function(){this.setCurrentTime(this.playlist.timeOffsetAtIndex(e),t)}.bind(this);this.isPlaylistResolvedUpToIndex(e)?n():this.playlistNodesResolvedUpToIndexPromise(e).then(n)},setCurrentTime:function(e,t){if(t=t||{},"number"!=typeof e||e<0||isNaN(e))return this.log.warn("Invalid value supplied to currentTime:",e),void this.notifyError(23,e);if(this.playlist.nodes.length){var n=function(){if(this.calcDuration(),e>=this._duration-this.getCriticalTime()&&this.playlist.length&&e>this.playlist.timeOffsetAtIndex(this.playlist.length-1))return this.log.warn("Requested currentTime is beyond playlist"),void this.notifyError(24);this.seek({seekToTime:e,seekOptions:t,prevState:this._state})}.bind(this);this.isPlaylistResolvedUpToTime(e)?n():this.playlistNodesResolvedUpToTimePromise(e).then(n)}},getCurrentNodeTimeOffset:function(){return this.playlist.timeOffsetAtIndex(this._currentNodeIndex)},getCurrentNodeDuration:function(){var e=this.getCurrentNode();return e&&e.duration||0},getCurrentNodeTime:function(){return this.getCurrentTime()-this.getCurrentNodeTimeOffset()},getCurrentNodeRemainingTime:function(){return this.getCurrentNodeDuration()-this.getCurrentNodeTime()},getBitrate:function(){return isNaN(this._bitrate)?this.getSetting("bitrate"):this._bitrate},setBitrate:function(e,t){if("number"!=typeof e)return this.log.error("Invalid value supplied to bitrate:",e),void this.notifyError(69,e);this._bitrate=e,this.log.info("bitrate set to",e),t||this.engine.updateBitrate(e),this.trigger("bitrateUpdated",e)},getVideoTech:function(e){return e||this.log.warn("DEPRECATION WARNING: The 'videoTech()' function is being deprecated. Please use the 'engine' property instead."),this.engine.videoTech()},getPlaybackRate:function(){return this.video.getPlaybackRate()},setPlaybackRate:function(e){if("number"==typeof e){var t=ao.clamp(e,this.getSetting("minPlaybackRate"),this.getSetting("maxPlaybackRate"));t!==e&&this.log.warn("Value supplied to playbackRate, "+e+", is out of valid range ["+this.getSetting("minPlaybackRate")+", "+this.getSetting("maxPlaybackRate")+"], applying "+t+" instead."),t!==this.getPlaybackRate()&&(this.video.setPlaybackRate(t),this.triggerApiEvent(this.api.events.ratechange,[t]))}else this.log.warn("Invalid value supplied to playbackRate, ignoring:",e)},getEngineCurrentVideoElementGetter:function(e,t){let n;if(t=t||this.engine,(e=e||this.engineStr).startsWith("metamorphosis")){const e=this.getEngineCurrentVideoElementGetter(t.srcEngine.engineStr,t.srcEngine),i=this.getEngineCurrentVideoElementGetter(t.destEngine.engineStr,t.destEngine);return n=()=>t.isSrcEngineActive?e():i(),n}switch(e){case"webcodecs":case"nullwebcodecs":case"webaudionull":n=()=>t.engines[1].video.getCanvas();break;case"null":n=()=>t.video.getCanvas();break;default:n=()=>this.rts.videoEl}return n},enterState:function(e,t){this._stateExecQueue||(this._stateExecQueue=new po(this.doEnterState)),this._stateExecQueue.push([e,t])},doEnterState:function(e){var t=e[0],n=this._state;this._state=this._stateFactory.createState(t,e[1]),n&&(this._prevStates.push(n),this._prevStates.length>this.getSetting("maxPrevStates")&&this._prevStates.shift(),n.exit()),this._state.enter(),this._visitedStatesMap[t]=!0,this.trigger("stateChanged",n,this._state)},callStateMethod:function(e,t){return this._state[e].apply(this._state,t)},callStateMethodLogDisabled:function(e,t){return this._state[e].apply(this._state,t)},play:function(){return this.callStateMethod("play",arguments)},pause:function(){return this.callStateMethod("pause",arguments)},seek:function(){return this.callStateMethod("seek",arguments)},getCurrentTime:function(){return this.callStateMethodLogDisabled("getCurrentTime",arguments)},getBuffered:function(){return this.callStateMethod("getBuffered",arguments)},getPaused:function(){return this.callStateMethod("getPaused",arguments)},onWaiting:function(){return this.callStateMethod("onWaiting",arguments)},onPlaying:function(){return this.callStateMethod("onPlaying",arguments)},onPause:function(){return this.callStateMethod("onPause",arguments)},onEnded:function(){return this.callStateMethod("onEnded",arguments)},onPlaylistReset:function(){return this.callStateMethod("onPlaylistReset",arguments)},onVolumeChange:function(){this.triggerApiEvent(this.api.events.volumechange,[{volume:this.api.exports.volume,muted:this.api.exports.muted,isAudioLocked:this.api.exports.isAudioLocked}])},onAudioLockedChange:function(){this.triggerApiEvent(this.api.events.audiolockedchange,arguments)},onResize:function(){this.triggerApiEvent(this.api.events.resize,arguments)},onLoadedData:function(){this.triggerApiEvent(this.api.events.loadeddata,arguments)},onFullscreenChange:function(){this.triggerApiEvent(this.api.events.fullscreenchange,arguments)},onPlaylistPush:function(e,t,n){this.appendNodeForEnginePlayback(e),e.trigger(this.api.events.playlistpush,e,t,n),this.triggerApiEvent(this.api.events.playlistpush,[e,t,n]),this.calcDuration()},onSegmentUpdated:function(){this.calcDuration()},onNodeUpdated:function(){this.calcDuration()},onSubNodeStart:function(){this.triggerApiEvent("subnodestart",arguments)},onCuePointsNodeStart:function(e,t){this._currentNodeIndex=t,this.triggerApiEvent(this.api.events.nodestart,[e,t])},onCuePointsNodeEnd:function(e,t){this.triggerApiEvent(this.api.events.nodeend,[e,t]),t===this.playlist.nodes.length-1&&this.onEnded()},onCuePointsNodeCritical:function(e,t){t===this.playlist.nodes.length-1&&(this.triggerApiEvent(this.api.events.nodecritical,[e,t]),this.triggerApiEvent(this.api.events.playlistcritical,[e,t]),setTimeout(function(){t===this.playlist.nodes.length-1&&this.engine.endStream()}.bind(this),0))},ctor:function(e,t,n,i,r,o,s,a,l,c,u,d){this.playlist=e,this.repository=t,this.engine=n,this.video=n.video,this.api=i,this.cuepoints=r,this.fullScreen=o,this.cdnOptimizer=s,this.deprecator=a,this.playerjsAdapter=l,this.bitrateGuesstimator=c,this.rts=u,this.presumedVisibility=d,this.defineProperty("engineStr",(()=>this.engine.engineStr)),this.doAddRemoveListeners(!0),this.setCriticalTime();var h=this.getSetting("playbackRate",1);h!==this.getPlaybackRate()&&this.setPlaybackRate(h),this.defineProperty("duration",(function(){return this.getDuration()})),this.defineProperty("currentNode",(function(){return this.getCurrentNode()})),this.defineProperty("currentNodeId",(function(){return this.getCurrentNodeId()})),this.defineProperty("currentNodeIndex",(function(){return this.getCurrentNodeIndex()}),(function(e){this.setCurrentNodeIndex(e)})),this.defineProperty("currentNodeTimeOffset",(function(){return this.getCurrentNodeTimeOffset()})),this.defineProperty("currentNodeDuration",(function(){return this.getCurrentNodeDuration()})),this.defineProperty("currentNodeTime",(function(){return this.getCurrentNodeTime()})),this.defineProperty("currentNodeRemainingTime",(function(){return this.getCurrentNodeRemainingTime()})),this.defineProperty("currentTime",(function(){return this.getCurrentTime()}),(function(e){this.setCurrentTime(e)})),this.defineProperty("playbackRate",(function(){return this.getPlaybackRate()}),(function(e){this.setPlaybackRate(e)})),this.defineProperty("buffered",(function(){return this.getBuffered()})),this.defineProperty("bitrate",(function(){return this.getBitrate()}),(function(e){this.setBitrate(e)})),this.defineProperty("baseUrl",(function(){return this.cdnOptimizer.baseUrl})),this.defineProperty("cdn",(function(){return this.cdnOptimizer.cdn})),this.defineProperty("paused",(function(){return this.getPaused()})),this.defineProperty("isWithinEndedDelta",(()=>this.getDuration()-this.getCurrentTime()<=this.getSetting("endedDelta",.25))),this.defineProperty("engineCurrentVideoElement",this.getEngineCurrentVideoElementGetter()),this.defineProperty("currentVideoSource",(function(){return this._currentVideoSource||this.engineCurrentVideoElement}),(function(e){this._currentVideoSource=e})),this.setBitrate(this.getSetting("bitrate",this.bitrateGuesstimator.guesstimate()));var p=this.getSetting("forceBaseUrl");p?(this.cdnOptimizer.initCdn(p),this.engine.setForceBaseUrl(!0)):this.engine.setForceBaseUrl(!1),this.getSetting("enablePlayerjsAdapter")&&l.initAdapter(this),this._stateFactory=new ho(this.options,this),this.enterState("idle"),setTimeout(function(){this.onVolumeChange()}.bind(this)),this.expose({play:this.play,pause:this.pause,isWithinEndedDelta:this.exposeProperty("isWithinEndedDelta"),paused:this.exposeProperty("paused"),duration:this.exposeProperty("duration"),currentTime:this.exposeProperty("currentTime"),buffered:this.exposeProperty("buffered"),bitrate:this.exposeProperty("bitrate"),currentNode:this.exposeProperty("currentNode"),currentNodeId:this.exposeProperty("currentNodeId"),currentNodeIndex:this.exposeProperty("currentNodeIndex"),currentNodeTimeOffset:this.exposeProperty("currentNodeTimeOffset"),currentNodeDuration:this.exposeProperty("currentNodeDuration"),currentNodeTime:this.exposeProperty("currentNodeTime"),currentNodeRemainingTime:this.exposeProperty("currentNodeRemainingTime"),engine:this.exposeProperty("engineStr","engine"),playbackRate:this.exposeProperty("playbackRate"),videoTech:this.getVideoTech})},dispose:function(){this._super.apply(this,arguments),this.doAddRemoveListeners(!1),this._state&&"function"==typeof this._state.exit&&this._state.exit()}});function go(e,t){if(e.time===t.time){if(e.index!==t.index)return e.index-t.index;if("number"==typeof e.subindex&&"number"==typeof t.subindex&&e.subindex!==t.subindex)return e.subindex-t.subindex;if("nodestart"===e.type||"nodeend"===t.type)return-1;if("nodestart"===t.type||"nodeend"===e.type)return 1}return e.time-t.time}function mo(e,t,n){return t.time<0?n.duration?e+n.duration+t.time:NaN:e+t.time}var yo=ji.extend({name:"CuePoints",logLevel:"warn",excludeFuncFromAutoDebug:["onTimeUpdate","dispatchCuePoints","getInternalNodeCuePoints","getSubNodesCuePoints","getOtherCuePoints"],defaults:{internalPerNode:{nodestart:{time:0},nodecritical:{time:-3},nodeend:{time:-1e-6}},skippableTolerance:.5,interval:0,bufferingDelta:.1,triggerWaitingDelay:.075,triggerWaitingDelayAtZero:2.5},api:null,events:null,repository:null,playlist:null,prevSeekToTime:0,waiting:!1,cuePointsArray:null,triggeredIds:{},isWebAudioEngine:null,getInternalNodeCuePoints:function(e,t,n){var i=[];if(!e)return i;var r,o,s,a=this.getSetting("internalPerNode"),l=this;for(var c in a)r=c+"_"+e.id+"_"+n,s=mo(t,o=a[c],e),isNaN(s)||(s=ao.clamp(s,t,t+e.duration),i.push({id:r,time:s,index:n,type:c,cuePoint:{id:r,time:o.time,callback:function(e,t,n){l.trigger(e,n,t),n.trigger(e,n,t)}.bind(null,c,n,e)}}));return i},getSubNodesCuePoints:function(e,t,n){var i=[];if(!e||!e.subnodes||!e.subnodes.length)return i;var r=0;return e.subnodes.forEach((function(o,s){var a=this.getInternalNodeCuePoints(o,t+r,n).map((function(t){return t.subindex=s,t.cuePoint.callback=function(e,t,n,i,r){i.trigger(t,i,n,r,e)}.bind(null,e,t.type,n,o,s),t}));i=i.concat(a),r+=o.duration}),this),i},getOtherCuePoints:function(e,t,n){var i=[];return e&&e.cuePoints&&e.cuePoints.length?(e.cuePoints.forEach((function(r){var o=mo(t,r,e);isNaN(o)||i.push({id:r.id+"_"+n,time:o,index:n,type:"other",cuePoint:r})})),i):i},resetCuePoints:function(){for(var e=this.playlist.nodes.slice(this.api.currentNodeIndex).map(function(e,t){return{node:e,offset:this.playlist.timeOffsetAtIndex(t+this.api.currentNodeIndex),index:t+this.api.currentNodeIndex}}.bind(this)),t=e.length-1,n=0;n<t;n++)e[n].node.duration||e[n].node.isResolved||(t=n);e=e.slice(0,t+1);var i=[];e.forEach((function(e){i=i.concat(this.getInternalNodeCuePoints(e.node,e.offset,e.index)).concat(this.getSubNodesCuePoints(e.node,e.offset,e.index)).concat(this.getOtherCuePoints(e.node,e.offset,e.index))}),this);var r=this.getSetting("skippableTolerance",.5);i=i.filter(function(e){var t=e&&e.cuePoint||{};return!(this.triggeredIds[e.id]||t.options&&t.options.skippable&&e.time<this.prevSeekToTime-r)}.bind(this)).sort(go),this.cuePointsArray=i},resetMembers:function(){this.prevSeekToTime=0,this.waiting=!1,this.triggeredIds={},this.areCuePointsDirty=!0},onAPIPlaylistReset:function(){this.resetMembers()},onPlaylistChanged:function(){this.playlist.nodes.length||this.resetMembers(),this.areCuePointsDirty=!0},onSegmentUpdated:function(){this.areCuePointsDirty=!0},onCuePointsChanged:function(){this.areCuePointsDirty=!0},dispatchCuePoints:function(e,t){this.areCuePointsDirty&&(this.resetCuePoints(),this.areCuePointsDirty=!1);for(var n=this.cuePointsArray.length?this.cuePointsArray[0]:null;n&&n.time<=e&&(this.triggeredIds[n.id]=!0,this.cuePointsArray.shift(),n.cuePoint.callback&&(this.log.debug("Dispatching cue point at: "+n.time),n.cuePoint.callback(n.cuePoint)),n=this.cuePointsArray.length?this.cuePointsArray[0]:null,!this.isSeeking&&!this.api.paused||t););},startInterval:function(){this.waiting=!1,Zr.start(this.onTimeUpdate,1e3*this.getSetting("interval"))},stopInterval:function(){Zr.stop(this.onTimeUpdate)},onEnded:function(){this.triggeredIds={}},onSeeked:function(e,t,n,i){this.triggeredIds={},this.prevSeekToTime=i&&i.seekToTime||e,this.areCuePointsDirty=!0},onTimeUpdate:function(){var e=this.api.currentTime,t=Date.now();if(this.dispatchCuePoints(e),null===this.isWebAudioEngine&&(this.isWebAudioEngine=this.api.videoTech(!0).toLowerCase().indexOf("webaudio")>=0),!this.isWebAudioEngine&&e===this.prevCurrentTime&&this.api.isWithinEndedDelta)this.dispatchCuePoints(void 0);else if(e===this.prevCurrentTime&&this.prevTimestamp+1e3*this.getSetting("bufferingDelta")<=t&&!1===this.waiting){var n=0===e?1e3*this.getSetting("triggerWaitingDelayAtZero"):1e3*this.getSetting("triggerWaitingDelay");this.log.info("Setting waiting timeout: "+n),setTimeout(function(){this.waiting===e&&(this.log.info("Triggering waiting after timeout: "+n+", at currentTime: "+e),this.trigger("waiting"))}.bind(this),n),this.waiting=e}else e!==this.prevCurrentTime&&(this.prevTimestamp=t,"number"==typeof this.waiting&&(this.waiting=!1,this.trigger("playing")));this.prevCurrentTime=e},ctor:function(e,t,n){this.api=e.exports,this.events=this.api.events,this.repository=t,this.playlist=n,this.cuePointsArray=[],this.api.on(this.events.ended,this.onEnded),this.api.on(this.events.seeked,this.onSeeked),this.api.on(this.events.playlistreset,this.onAPIPlaylistReset),this.playlist.on(/.*/,this.onPlaylistChanged),this.repository.on("segment.updated",this.onSegmentUpdated),this.repository.on(/cuepoint\..*/,this.onCuePointsChanged),this.defineProperty("isSeeking",(function(){return this.api.reduxStore.getState().player.isSeeking}))},dispose:function(){this._super(),this.cuePointsArray=null,this.stopInterval(),this.api.off(this.events.ended,this.onEnded),this.api.off(this.events.seeked,this.onSeeked),this.api.off(this.events.playlistreset,this.onAPIPlaylistReset),this.playlist.off(/.*/,this.onPlaylistChanged),this.repository.off("segment.updated",this.onSegmentUpdated),this.repository.off(/cuepoint\..*/,this.onCuePointsChanged)}}),vo=ji.extend({name:"Playlist",logLevel:"warn",excludeFuncFromAutoDebug:["timeOffsetAtIndex","calcPlaylistDuration"],repository:null,nodes:[],eventsExecQueue:null,push:function(e){var t,n,i=[].slice.call(arguments);if(!(i.length>1)||i[i.length-1]instanceof pr||!ki.isPlainObject(i[i.length-1])||i[i.length-1].id&&i[i.length-1].source||(n=i.pop()),n=ki.extend({},n),i.length>1){for(var r=0;r<i.length;r++)this.push(i[r],n);return this.nodes.length}return(t=this.repository.has(e)?this.repository.get(e):this.repository.add(e))?t.segment?(this.nodes.push(t),this.exports[this.nodes.length-1]=this.nodes[this.nodes.length-1],this.eventsExecQueue.push(["push",t,this.nodes.length-1,n])):(this.log.error("Node does not contain a segment: "+e),this.notifyError(43,t,e)):(this.log.error("Could not find or create node: "+e),this.notifyError(28,e)),this.nodes.length},triggerEvent:function(e){this.trigger.apply(this,e)},reset:function(){for(var e=0;e<this.nodes.length;e++)delete this.exports[e];this.nodes=[],this.eventsExecQueue.push(["reset"])},timeOffsetAtIndex:function(e){if(e<0||e>this.nodes.length||"number"!=typeof e)return this.log.warn("Invalid argument given to timeOffsetAtIndex(). Expected an integer in the range: [0, "+this.nodes.length+"]. Instead got:",e),this.notifyError(75,this.nodes.length,e),NaN;for(var t=0,n=0;n<e;n++)t+=this.nodes[n].segment.duration||0;return t},calcPlaylistDuration:function(){for(var e=-1,t=0,n=this.nodes.length;t<n;++t)if(this.nodes[t].isDurationUnknown){e=t;break}return this.timeOffsetAtIndex(-1===e?this.nodes.length:e)},ctor:function(e){this.repository=e,this.eventsExecQueue=new po(this.triggerEvent),this.defineProperty("length",(function(){return this.nodes.length})),this.defineEvents(["push","reset"]),this.expose({push:this.push,reset:this.reset,timeOffsetAtIndex:this.timeOffsetAtIndex,length:this.exposeProperty("length")})}}),bo=ji.extend({name:"FullScreen",logLevel:"warn",defaults:{fullscreenOrientation:Xi.getDefault("fullscreenOrientation"),fullscreenOptions:Xi.getDefault("fullscreenOptions")},excludeFuncFromAutoDebug:["isFullscreenSupported"],events:{},element:null,isCurrentlyInFullscreen:!1,requestFullscreen:function(e){this.element?(e=void 0===e?this.getSetting("fullscreenOptions",{}):e,this.element.requestFullscreen?this.element.requestFullscreen(e):this.element.msRequestFullscreen?this.element.msRequestFullscreen(e):this.element.mozRequestFullScreen?this.element.mozRequestFullScreen(e):this.element.webkitRequestFullscreen?this.element.webkitRequestFullscreen(e):this.log.warn("requestFullscreen is not supported in current environment.")):this.log.warn("Cannot perform requestFullscreen since element is null.")},exitFullscreen:function(){this.element?document&&document.exitFullscreen?document.exitFullscreen():document&&document.msExitFullscreen?document.msExitFullscreen():document&&document.mozCancelFullScreen?document.mozCancelFullScreen():document&&document.webkitExitFullscreen?document.webkitExitFullscreen():this.log.warn("exitFullscreen is not supported in current environment."):this.log.warn("Cannot perform exitFullscreen since element is null.")},isFullscreenSupported:function(){return!!(this.element&&(this.element.requestFullscreen||this.element.webkitRequestFullscreen||this.element.mozRequestFullScreen||this.element.msRequestFullscreen)&&window&&window.document&&(window.document.fullscreenEnabled||window.document.webkitFullscreenEnabled||window.document.mozFullScreenEnabled||window.document.msFullscreenEnabled))},onFullscreenChange:function(){var e,t=!(!document||!(document.fullscreenElement||document.fullscreen||document.mozFullScreen||document.webkitIsFullScreen||document.msFullscreenElement)),n=document&&(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement);if(n===this.element&&null!==n&&(this.isCurrentlyInFullscreen=!0),this.isCurrentlyInFullscreen&&(t||(this.isCurrentlyInFullscreen=!1),this.log.info("Triggering event 'fullscreenchange' with value isFullscreen:",t),this.trigger(this.events.fullscreenchange,t)),this.isCurrentlyInFullscreen){var i=screen&&(screen.lockOrientation||screen.mozLockOrientation||screen.msLockOrientation);i="function"==typeof i?i.bind(screen):screen&&screen.orientation&&screen.orientation.lock&&screen.orientation.lock.bind(screen.orientation),this.getSetting("fullscreenOrientation",!1)&&"function"==typeof i&&(e=i(this.getSetting("fullscreenOrientation")),window&&window.Promise&&e instanceof window.Promise&&e.catch&&e.catch((function(){})))}else{var r=screen&&(screen.unlockOrientation||screen.mozUnlockOrientation||screen.msUnlockOrientation);r="function"==typeof r?r.bind(screen):screen&&screen.orientation&&screen.orientation.unlock&&screen.orientation.unlock.bind(screen.orientation),this.getSetting("fullscreenOrientation",!1)&&"function"==typeof r&&(e=r(),window&&window.Promise&&e instanceof window.Promise&&e.catch&&e.catch((function(){})))}},ctor:function(e,t){this.element=t,this.events.fullscreenchange=e.events.fullscreenchange,document&&(document.addEventListener("fullscreenchange",this.onFullscreenChange),document.addEventListener("webkitfullscreenchange",this.onFullscreenChange),document.addEventListener("mozfullscreenchange",this.onFullscreenChange),document.addEventListener("MSFullscreenChange",this.onFullscreenChange)),this.defineEvents([this.events.fullscreenchange]),this.defineProperty("isFullscreen",(function(){return this.isCurrentlyInFullscreen})),this.expose({isFullscreenSupported:this.isFullscreenSupported,requestFullscreen:this.requestFullscreen,exitFullscreen:this.exitFullscreen,isFullscreen:this.exposeProperty("isFullscreen")})},dispose:function(){this._super(),document&&(document.removeEventListener("fullscreenchange",this.onFullscreenChange),document.removeEventListener("webkitfullscreenchange",this.onFullscreenChange),document.removeEventListener("mozfullscreenchange",this.onFullscreenChange),document.removeEventListener("MSFullscreenChange",this.onFullscreenChange))}}),wo=ji.extend({name:"Stream",logLevel:"warn",defaults:{},playlist:null,repo:null,engine:null,video:null,controller:null,rts:null,deprecator:null,core:null,prevNode:null,isCurrentlySwitching:!1,doSwitchExecQueue:null,setupRtsViaNodeObject:function(e){return e&&e.metadata&&e.metadata.rows&&e.metadata.cols?this.rts.setup(e.metadata.rows,e.metadata.cols):this.rts.setup(1,1)},switchNodeToVideoTrackIndex:function(e,t){e.metadata&&e.metadata.indexMap?this.rts.switch(e.metadata.indexMap[t][0],e.metadata.indexMap[t][1]):this.rts.switch(0,0)},wrapInSwitchingSwitched:function(e,t,n){if("function"==typeof e&&t&&Number.isInteger(t.audio)&&Number.isInteger(t.video)&&n&&Number.isInteger(n.audio)&&Number.isInteger(n.video))if(this.isCurrentlySwitching)e();else{this.isCurrentlySwitching=!0;var i=new Number(t.video),r=new Number(n.video);i.video=t.video,i.audio=t.audio,r.video=n.video,r.audio=n.audio,this.core.exports.trigger(this.core.exports.events.switching,i,r),e(),this.core.exports.trigger(this.core.exports.events.switched,i,r),this.isCurrentlySwitching=!1}else this.log.error("[wrapInSwitchingSwitched] Invalid arguments")},onCurrentVideoTrackIndexChange:function(e,t,n){this.wrapInSwitchingSwitched(this.switchNodeToVideoTrackIndex.bind(this,e,n),{video:t,audio:e.currentAudioTrackIndex},{video:n,audio:e.currentAudioTrackIndex})},onCurrentAudioTrackIndexChange:function(e,t,n){this.wrapInSwitchingSwitched((function(){}),{video:e.currentVideoTrackIndex,audio:t},{video:e.currentVideoTrackIndex,audio:n})},stopListeningToPreviousNodeTrackIndexChange:function(){this._prevListeningNode&&(this._prevListeningNode.off("currentvideotrackindexchange",this.onCurrentVideoTrackIndexChange),this._prevListeningNode.off("currentaudiotrackindexchange",this.onCurrentAudioTrackIndexChange),this._prevListeningNode=null)},listenToNodeCurrentTrackIndexChange:function(e){e&&(this.stopListeningToPreviousNodeTrackIndexChange(),e.on("currentvideotrackindexchange",this.onCurrentVideoTrackIndexChange),e.on("currentaudiotrackindexchange",this.onCurrentAudioTrackIndexChange),this._prevListeningNode=e)},switchAVViaNodeObject:function(e,t){e?((t=t||{audio:e.defaultAudioTrackIndex,video:e.defaultVideoTrackIndex}).video!==e.currentVideoTrackIndex&&(e.currentVideoTrackIndex=t.video),t.audio!==e.currentAudioTrackIndex&&-1!==t.audio&&(e.currentAudioTrackIndex=t.audio)):this.rts.switch(0,0)},resetRtsViaNodeObject:function(e,t){e&&(this.prevNode!==e||t)&&(this.setupRtsViaNodeObject(e),e.autoSwitchingEnabled&&this.switchAVViaNodeObject(e),this.listenToNodeCurrentTrackIndexChange(e),this.switchNodeToVideoTrackIndex(e,e.currentVideoTrackIndex),this.prevNode=e)},doSwitch:function(e){var t=this.core.exports.currentNode;if(!t||!t.isParallel)return this.log.warn("Unable to switch channel, current node is not switchable."),void this.notifyError(73);for(var n=Math.max(t.audioTracksCount,t.videoTracksCount),i=["prev","next"],r=0;r<n;++r)i.push(r);if("number"==typeof e){if(e<0||e>n)return this.log.warn("Invalid argument given to switch(). Expected a valid avTracksObj or one of: "+i.join(", ")+". Instead got: ",e),void this.notifyError(74,i,e);e={audio:e%t.audioTracksCount,video:e%t.videoTracksCount}}else"next"===e||"prev"===e?e={audio:(t.currentAudioTrackIndex+("next"===e?1:t.audioTracksCount-1))%t.audioTracksCount,video:(t.currentVideoTrackIndex+("next"===e?1:t.videoTracksCount-1))%t.videoTracksCount}:e&&"object"==typeof e&&(e.hasOwnProperty("audio")||(e.audio=t.currentAudioTrackIndex),e.hasOwnProperty("video")||(e.video=t.currentVideoTrackIndex),"prev"!==e.audio&&"next"!==e.audio||(e.audio=(t.currentAudioTrackIndex+("next"===e.audio?1:t.audioTracksCount-1))%t.audioTracksCount),"prev"!==e.video&&"next"!==e.video||(e.video=(t.currentVideoTrackIndex+("next"===e.video?1:t.videoTracksCount-1))%t.videoTracksCount));if(!e||"object"!=typeof e||!Number.isInteger(e.audio)||!Number.isInteger(e.video)||e.audio<-1||e.video<0||e.audio>t.audioTracksCount-1||e.video>t.videoTracksCount-1)return this.log.warn("Invalid argument given to switch(). Expected a valid avTracksObj or one of: "+i.join(", ")+". Instead got: ",e),void this.notifyError(74,i,e);this.log.info("Resolved avTracksObj:",e),e.audio!==t.currentAudioTrackIndex||e.video!==t.currentVideoTrackIndex?this.wrapInSwitchingSwitched(this.switchAVViaNodeObject.bind(this,t,e),{video:t.currentVideoTrackIndex,audio:t.currentAudioTrackIndex},e):this.log.warn("Ignoring switch tracks request, we're already on tracks:",e)},onSeeked:function(e,t){this.core.exports.paused&&this.resetRtsViaNodeObject(this.playlist.nodes[t])},onPlaylistPush:function(e,t){0===t&&this.resetRtsViaNodeObject(e,!0)},onNodeStart:function(e){this.resetRtsViaNodeObject(e)},isValidNode:function(e){return e&&(e instanceof pr||"string"==typeof e&&this.repo.has(e))},isValidSeekOffset:function(e,t){e=this.repo.get(e);var n=this.controller.getCriticalTime();return 0===t||t>0&&t<e.duration-n||t<0&&Math.abs(t)>n&&Math.abs(t)<=e.duration},append:function(e,t){t=ki.extend({},t,{append:!0}),this.isValidNode(e)?this.playlist.push(e,t):(this.log.error("Invalid argument given to append(). Expected node object or existing node id, instead got:",e),this.notifyError(70,e))},seek:function(e,t,n){if(2===arguments.length&&ki.isPlainObject(t)&&(n=t,t=void 0),n=ki.extend({},n,{seek:!0}),t=t||0,e=this.repo.get(e),!this.isValidNode(e))return this.log.error("Invalid argument given to seek(). Expected node object or existing node id, instead got:",e),void this.notifyError(71,e);this.controller.playlistNodesResolvedUpToIndexPromise(this.playlist.length-1).then(function(){if(!this.isValidSeekOffset(e,t))return this.log.error("Invalid offset argument given to seek(). Expected value (in abs) to be between 0 to node.duration - criticalTime, instead got:",t),void this.notifyError(89,t);var i=this.controller.getDuration(),r=t>=0?i+t:i+t+e.duration;this.playlist.push(e,n),this.controller.setCurrentTime(r,n)}.bind(this))},switch:function(e){this.doSwitchExecQueue||(this.doSwitchExecQueue=new po(this.doSwitch)),this.doSwitchExecQueue.push(e)},ctor:function(e,t,n,i,r,o,s){this.playlist=e,this.repo=t,this.engine=n,this.video=n.video,this.controller=i,this.rts=r,this.deprecator=o,this.core=s,this.core.exports.on("nodestart",this.onNodeStart),this.core.exports.on("playlistpush",this.onPlaylistPush),this.core.exports.on("seeked",this.onSeeked),this.expose({append:this.append,seek:this.seek,switch:this.switch}),this.deprecator.addProperty("currentChannel","currentNode.currentVideoTrackIndex",{defaultValue:0,readonly:!0})},dispose:function(){this._super.apply(this,arguments),this.doSwitchExecQueue&&(this.doSwitchExecQueue.reset(),this.doSwitchExecQueue=null),this.stopListeningToPreviousNodeTrackIndexChange(),this.core.exports.off("nodestart",this.onNodeStart),this.core.exports.off("playlistpush",this.onPlaylistPush),this.core.exports.off("seeked",this.onSeeked)}});function ko(e,t,n,i){this.leftPercent=e||0,this.topPercent=t||0,this.widthPercent=n||100,this.heightPercent=i||100}var xo=ji.extend({name:"BaseScaler",logLevel:"warn",calcScalingDescriptor:function(e,t,n,i){return new ko},init:function(e){((e=e||{}).Scaler||e.Scalers||e.scaler||e.scalers)&&(e[this.name]=ki.extend(!0,e[this.name]||{},e.Scaler||e.Scalers||e.scaler||e.scalers)),this._super.apply(this,[e].concat(Array.prototype.slice.call(arguments,1)))},ctor:function(){},dispose:function(){this._super.apply(this,arguments)}}),So=xo.extend({name:"BoxingScaler",logLevel:"warn",calcScalingDescriptor:function(e,t,n,i){var r=e/t,o=n/i,s=new ko;return r>o?(s.topPercent=0,s.heightPercent=100,s.widthPercent=o/r*100,s.leftPercent=(100-s.widthPercent)/2):(s.leftPercent=0,s.widthPercent=100,s.heightPercent=r/o*100,s.topPercent=(100-s.heightPercent)/2),s},ctor:function(){},dispose:function(){this._super.apply(this,arguments)}}),Co=Xi.getDefault("panAndScanMinVisibleWidth"),_o=Xi.getDefault("panAndScanMinVisibleHeight"),Eo=.5,To=.5,Po=xo.extend({name:"PanAndScanScaler",logLevel:"warn",defaults:{minVisibleWidthPercentage:Co,minVisibleHeightPercentage:_o,debugCOA:!1,debugCircleZIndex:99,coaXPercent:Eo,coaYPercent:To},fallbackScaler:null,debugCOADomEl:null,debugCircleEl:null,debugLabelEl:null,coaLeftPercent:Eo,coaTopPercent:To,core:null,onDragStart:function(e){this.debugCOADomEl.style["z-index"]=this.getSetting("debugCircleZIndex"),e.dataTransfer.effectAllowed="move",e.target.style.opacity=.4,e.dataTransfer.setData("text/plain","somedata")},onDragEnd:function(e){this.debugCOADomEl.style["z-index"]="auto",e.target.style.opacity=1},onDragEnter:function(e){return e.preventDefault(),!1},onDragLeave:function(e){},onDragOver:function(e){return e.preventDefault(),e.dataTransfer.dropEffect="move",!1},onDrop:function(e){return e.preventDefault(),e.target!==this.debugCOADomEl||this.core.exports.trigger("coaupdated",e.offsetX,e.offsetY,e.target.offsetWidth,e.target.offsetHeight),!1},onFallbackScalerRequestScaling:function(){this.trigger("requestscaling")},isCropWithinThreshold:function(e,t){return e>t?t/e>=this.getSetting("minVisibleHeightPercentage"):!(e<t)||e/t>=this.getSetting("minVisibleWidthPercentage")},initDebugCOA:function(e){this.debugCOADomEl=document.createElement("div"),this.debugCOADomEl.setAttribute("style","top: 0px; left: 0px; width: 100%; height: 100%; position: absolute; overflow: hidden; pointer-events: auto;"),this.debugCOADomEl.innerHTML='<div draggable="true" style="cursor: pointer; position: absolute; top: '+100*this.coaTopPercent+"%; left: "+100*this.coaLeftPercent+"%; -webkit-transform: translate(-50%, -50%); -ms-transform: translate(-50%, -50%); transform: translate(-50%, -50%); z-index: "+this.getSetting("debugCircleZIndex")+';"><svg height="30" width="30"><circle cx="50%" cy="50%" r="12" stroke="black" stroke-width="1" fill="green" /></svg><div style="position: absolute; white-space: nowrap; background-color: black; color: white;">('+(100*this.coaLeftPercent).toFixed(2)+"%, "+(100*this.coaTopPercent).toFixed(2)+"%)</div></div>",e.appendChild(this.debugCOADomEl),this.debugCircleEl=this.debugCOADomEl.children[0],this.debugLabelEl=this.debugCircleEl.children[1],this.debugCircleEl.addEventListener("dragstart",this.onDragStart),this.debugCircleEl.addEventListener("dragend",this.onDragEnd),this.debugCOADomEl.addEventListener("dragenter",this.onDragEnter),this.debugCOADomEl.addEventListener("dragleave",this.onDragLeave),this.debugCOADomEl.addEventListener("dragover",this.onDragOver),this.debugCOADomEl.addEventListener("drop",this.onDrop)},addCOACuePoint:function(e,t,n,i,r,o){e.on("timeupdate:"+t,function(){this.core.exports.trigger("coaupdated",n,i,r,o)}.bind(this))},onPlaylistPush:function(e){e&&!e.__addedCOAListeners&&e.metadata&&e.metadata.frame&&e.metadata.frame.contentWidth&&e.metadata.frame.contentHeight&&Array.isArray(e.metadata.coa)&&e.metadata.coa.length&&(this.log.info("Adding COA listeners for node ["+e.id+"]"),e.metadata.coa.sort((function(e,t){return e.time-t.time})).filter((function(e,t,n){return 0===t||n[t-1].x!==e.x||n[t-1].y!==e.y})).forEach(function(t){t&&t.hasOwnProperty("time")&&t.hasOwnProperty("x")&&t.hasOwnProperty("y")&&this.addCOACuePoint(e,t.time,t.x,t.y,e.metadata.frame.contentWidth,e.metadata.frame.contentHeight)}.bind(this)),e.__addedCOAListeners=!0)},onCOAUpdated:function(e,t,n,i){if(4===arguments.length&&Array.prototype.reduce.call(arguments,(function(e,t){return e&&"number"==typeof t}),!0))this.coaLeftPercent=e/n,this.coaTopPercent=t/i;else{if(2!==arguments.length||!Array.prototype.reduce.call(arguments,(function(e,t){return e&&"number"==typeof t&&t>=0&&t<=1}),!0))return void this.log.warn("Unexpected arguments in 'coaupdated' event. Expecting either: [x, y, width, height] or [xPercent, yPercent]. Received: ",arguments);this.coaLeftPercent=e,this.coaTopPercent=t}this.debugCircleEl&&(this.debugCircleEl.style.top=100*this.coaTopPercent+"%",this.debugCircleEl.style.left=100*this.coaLeftPercent+"%",this.debugLabelEl.innerHTML="("+(100*this.coaLeftPercent).toFixed(2)+"%, "+(100*this.coaTopPercent).toFixed(2)+"%)"),this.trigger("requestscaling")},calcScalingDescriptor:function(e,t,n,i){var r=e/t,o=n/i;if(!this.isCropWithinThreshold(r,o))return this.fallbackScaler.calcScalingDescriptor.apply(this.fallbackScaler,arguments);var s=new ko;if(r>o){var a=.5-this.coaTopPercent*(r/o),l=1-r/o;a>0?a=0:a<l&&(a=l),s.leftPercent=0,s.topPercent=100*a,s.widthPercent=100,s.heightPercent=r/o*100}else{var c=.5-this.coaLeftPercent*(o/r),u=1-o/r;c>0?c=0:c<u&&(c=u),s.leftPercent=100*c,s.topPercent=0,s.widthPercent=o/r*100,s.heightPercent=100}return s},ctor:function(e,t,n){this.fallbackScaler=e,this.core=t;var i=this.getSetting("minVisibleWidthPercentage");("number"!=typeof i||i<0||i>1)&&(this.log.warn("Bad configuration for minVisibleWidthPercentage: "+i+" (expected number in range [0, 1]). Using default value: "+Co),this.setSetting("minVisibleWidthPercentage",Co));var r=this.getSetting("minVisibleHeightPercentage");("number"!=typeof r||r<0||r>1)&&(this.log.warn("Bad configuration for minVisibleHeightPercentage: "+r+" (expected number in range [0, 1]). Using default value: "+_o),this.setSetting("minVisibleHeightPercentage",_o));var o=this.getSetting("coaXPercent",Eo);"number"!=typeof o||o<0||o>1?(this.log.warn("Bad configuration for coaXPercent: "+o+" (expected number in range [0, 1]). Using default value: "+Eo),this.coaLeftPercent=Eo):this.coaLeftPercent=o;var s=this.getSetting("coaYPercent",To);"number"!=typeof s||s<0||s>1?(this.log.warn("Bad configuration for coaYPercent: "+s+" (expected number in range [0, 1]). Using default value: "+To),this.coaTopPercent=To):this.coaTopPercent=s,this.getSetting("debugCOA")&&this.initDebugCOA(n),this.core.exports.on("coaupdated",this.onCOAUpdated),this.core.exports.on("playlistpush",this.onPlaylistPush),this.fallbackScaler.on("requestscaling",this.onFallbackScalerRequestScaling)},dispose:function(){this._super.apply(this,arguments),this.debugCircleEl&&(this.debugCircleEl.removeEventListener("dragstart",this.onDragStart),this.debugCircleEl.removeEventListener("dragend",this.onDragEnd)),this.debugCOADomEl&&(this.debugCOADomEl.removeEventListener("dragenter",this.onDragEnter),this.debugCOADomEl.removeEventListener("dragleave",this.onDragLeave),this.debugCOADomEl.removeEventListener("dragover",this.onDragOver),this.debugCOADomEl.removeEventListener("drop",this.onDrop),this.debugCOADomEl.parentNode&&this.debugCOADomEl.parentNode.removeChild(this.debugCOADomEl)),this.fallbackScaler&&(this.fallbackScaler.off("requestscaling",this.onFallbackScalerRequestScaling),"function"==typeof this.fallbackScaler.dispose&&this.fallbackScaler.dispose()),this.core.exports.off("coaupdated",this.onCOAUpdated),this.core.exports.off("playlistpush",this.onPlaylistPush)}}),Io=xo.extend({name:"NoopScaler",logLevel:"warn"}),Ao=me.createLogger("ScalerFactory","warn");function Oo(e,t,n){return e&&e.ScalerFactory&&e.ScalerFactory.logLevel&&Ao.setLevel(e.ScalerFactory.logLevel),{createScaler:function(i){Ao.debug(" -> createScaler("+i+")");var r=null;switch(i){case"boxing":r=new So(e);break;case"panAndScan":r=new Po(e,new So(e),t,n);break;case"noop":r=new Io(e);break;default:Ao.warn("Unknown requested scaler: "+i+". Returning PanAndScanScaler instance."),r=new Po(e,new So(e),t,n)}return r}}}var Lo=ji.extend({name:"VideoScaler",logLevel:"warn",defaults:{mode:Xi.getDefault("scaling"),initialVideoWidth:1280,initialVideoHeight:720,unboxEnabled:!0},excludeFuncFromAutoDebug:["getContentWidth","getContentHeight","getFrameObject","constructFrameObject"],core:null,video:null,scalerFactory:null,scaler:null,container:null,containerWidth:0,containerHeight:0,videoWrapperEl:null,videoWrapperWidth:0,videoWrapperHeight:0,videoProxyEl:null,addResizeListener:function(){window.addResizeListener&&this.container&&window.addResizeListener(this.container,this.onContainerResize)},removeResizeListener:function(){if(window.removeResizeListener&&this.container)try{window.removeResizeListener(this.container,this.onContainerResize)}catch(e){}},onVideoResize:function(){this.performScaling(this.containerWidth,this.containerHeight)},onScalerRequestScaling:function(){this.performScaling(this.containerWidth,this.containerHeight)},onContainerResize:function(){var e=this.container.offsetWidth,t=this.container.offsetHeight;this.containerWidth===e&&this.containerHeight===t||(this.containerWidth=e,this.containerHeight=t,this.performScaling(e,t))},constructFrameObject:function(e,t){return{width:e,height:t,contentX:0,contentY:0,contentWidth:e,contentHeight:t}},getFrameObject:function(e){return(e=e||this.core.exports.currentNode)&&e.segment.metadata.frame||e&&e.segment.chosenRepresentation&&e.segment.chosenRepresentation.width&&e.segment.chosenRepresentation.height&&this.constructFrameObject(e.segment.chosenRepresentation.width,e.segment.chosenRepresentation.height)||this.constructFrameObject(this.getSetting("initialVideoWidth"),this.getSetting("initialVideoHeight"))},getContentWidth:function(e){return this.getFrameObject(e).contentWidth||0},getContentHeight:function(e){return this.getFrameObject(e).contentHeight||0},unboxVideo:function(e){if(this.getSetting("unboxEnabled")){var t=this.getFrameObject(e),n=t.width/t.contentWidth,i=t.height/t.contentHeight,r=(100*n).toFixed(3)+"%",o=(100*i).toFixed(3)+"%";this.videoProxyEl.style.cssText="position: relative;overflow: hidden;width: "+r+";height: "+o+";top: "+(0-t.contentY/t.height)*i*100+"%;left: "+(0-t.contentX/t.width)*n*100+"%;"}},onPlaylistPush:function(e,t){0===t&&(this.unboxVideo(e),this.performScaling(this.containerWidth,this.containerHeight,e))},onNodeStart:function(e){this.unboxVideo(e=e||this.core.exports.currentNode),this.performScaling(this.containerWidth,this.containerHeight,e)},applyScalingFromDescriptor:function(e){return e&&e instanceof ko&&"number"==typeof e.topPercent&&"number"==typeof e.leftPercent&&"number"==typeof e.widthPercent&&"number"==typeof e.heightPercent?(this.log.info("[applyScalingFromDescriptor] Applying scaling:\n   left: "+e.leftPercent+"%;\n   top: "+e.topPercent+"%;\n   width: "+e.widthPercent+"%;\n   height: "+e.heightPercent+"%;"),this.videoWrapperEl.setAttribute("style","position: absolute;overflow: hidden;left: "+e.leftPercent+"%;top: "+e.topPercent+"%;width: "+e.widthPercent+"%;height: "+e.heightPercent+"%;"),!0):(this.log.error("[applyScalingFromDescriptor] Invalid scaling descriptor object:",e),!1)},performScaling:function(e,t,n){var i=this.getSetting("unboxEnabled")&&this.getContentWidth(n)||this.video.videoWidth||this.getSetting("initialVideoWidth"),r=this.getSetting("unboxEnabled")&&this.getContentHeight(n)||this.video.videoHeight||this.getSetting("initialVideoHeight"),o=this.scaler.calcScalingDescriptor(e,t,i,r),s=this.applyScalingFromDescriptor(o);this.videoWrapperWidth=this.videoWrapperEl.offsetWidth,this.videoWrapperHeight=this.videoWrapperEl.offsetHeight,s&&this.trigger("videoscaled",o)},initScaler:function(e){this.disposeScaler(),this.scaler=this.scalerFactory.createScaler(e),this.scaler.on("requestscaling",this.onScalerRequestScaling)},disposeScaler:function(){this.scaler&&(this.scaler.off("requestscaling",this.onScalerRequestScaling),"function"==typeof this.scaler.dispose&&this.scaler.dispose(),this.scaler=null)},ctor:function(e,t,n,i,r){this.core=e,this.container=t,this.videoWrapperEl=n,this.videoProxyEl=i,this.video=r,this.defineProperty("videoEl",(function(){return i.children[0]})),this.scalerFactory=new Oo(this.options,e,n),this.initScaler(this.getSetting("mode")),this.video.on("resize",this.onVideoResize),this.addResizeListener(),this.core.exports.on("nodestart",this.onNodeStart),this.core.exports.on("playlistpush",this.onPlaylistPush),this.videoWrapperWidth=this.videoWrapperEl.offsetWidth,this.videoWrapperHeight=this.videoWrapperEl.offsetHeight,this.onContainerResize()},dispose:function(){this._super.apply(this,arguments),this.video.off("resize",this.onVideoResize),this.removeResizeListener(),this.core.exports.off("nodestart",this.onNodeStart),this.core.exports.off("playlistpush",this.onPlaylistPush),this.disposeScaler()}});!function(){var e,t,n=document.attachEvent,i=!1;function r(e){var t=e.__resizeTriggers__,n=t.firstElementChild,i=t.lastElementChild,r=n.firstElementChild;i.scrollLeft=i.scrollWidth,i.scrollTop=i.scrollHeight,r.style.width=n.offsetWidth+1+"px",r.style.height=n.offsetHeight+1+"px",n.scrollLeft=n.scrollWidth,n.scrollTop=n.scrollHeight}function o(e){var t=this;r(this),this.__resizeRAF__&&a(this.__resizeRAF__),this.__resizeRAF__=s((function(){(function(e){return e.offsetWidth!=e.__resizeLast__.width||e.offsetHeight!=e.__resizeLast__.height})(t)&&(t.__resizeLast__.width=t.offsetWidth,t.__resizeLast__.height=t.offsetHeight,t.__resizeListeners__.forEach((function(n){n.call(t,e)})))}))}if(!n){var s=(t=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||function(e){return window.setTimeout(e,20)},function(e){return t(e)}),a=(e=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.clearTimeout,function(t){return e(t)}),l=!1,c="",u="animationstart",d="Webkit Moz O ms".split(" "),h="webkitAnimationStart animationstart oAnimationStart MSAnimationStart".split(" "),p=document.createElement("fakeelement");if(void 0!==p.style.animationName&&(l=!0),!1===l)for(var f=0;f<d.length;f++)if(void 0!==p.style[d[f]+"AnimationName"]){c="-"+d[f].toLowerCase()+"-",u=h[f],l=!0;break}var g="resizeanim",m="@"+c+"keyframes "+g+" { from { opacity: 0; } to { opacity: 0; } } ",y=c+"animation: 1ms "+g+"; "}window.addResizeListener=function(e,t){n?e.attachEvent("onresize",t):(e.__resizeTriggers__||("static"==getComputedStyle(e).position&&(e.style.position="relative"),function(){if(!i){var e=(m||"")+".resize-triggers { "+(y||"")+'visibility: hidden; opacity: 0; } .resize-triggers, .resize-triggers > div, .contract-trigger:before { content: " "; display: block; position: absolute; top: 0; left: 0; height: 100%; width: 100%; overflow: hidden; } .resize-triggers > div { background: #eee; overflow: auto; } .contract-trigger:before { width: 200%; height: 200%; }',t=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e)),t.appendChild(n),i=!0}}(),e.__resizeLast__={},e.__resizeListeners__=[],(e.__resizeTriggers__=document.createElement("div")).className="resize-triggers",e.__resizeTriggers__.innerHTML='<div class="expand-trigger"><div></div></div><div class="contract-trigger"></div>',e.appendChild(e.__resizeTriggers__),r(e),e.addEventListener("scroll",o,!0),u&&e.__resizeTriggers__.addEventListener(u,(function(t){t.animationName==g&&r(e)}))),e.__resizeListeners__.push(t))},window.removeResizeListener=function(e,t){n?e.detachEvent("onresize",t):(e.__resizeListeners__.splice(e.__resizeListeners__.indexOf(t),1),e.__resizeListeners__.length||(e.removeEventListener("scroll",o),e.__resizeTriggers__=!e.removeChild(e.__resizeTriggers__)))}}();var No=ki.getObjectProperty(Ae,"os.name","").toLowerCase(),Ro=ki.getObjectProperty(Ae,"browser.name","").toLowerCase(),Do=ki.getObjectProperty(Ae,"browser.major",""),Mo=parseInt(Do,10)||0,Fo=Ae.isDesktop&&"windows"===No&&("chrome"===Ro||"edge"===Ro)&&Mo>=90&&Mo<93,Bo=ji.extend({name:"RTS",logLevel:"warn",defaults:{},rows:0,cols:0,setup:function(e,t){return"number"!=typeof e||"number"!=typeof t||e<1||t<1?(this.log.error("Bad arguments given to setup()."),!1):(this.rows===e&&this.cols===t||(this.rows=e,this.cols=t,this.videoEl.style.width=100*t+"%",this.videoEl.style.height=100*e+"%",this.videoEl.style.top="0px",this.videoEl.style.left="0px"),!0)},switch:function(e,t){if("number"==typeof e&&void 0===t&&(1===this.cols?t=0:1===this.rows&&(t=e,e=0)),"number"!=typeof e||"number"!=typeof t||e>=this.rows||t>=this.cols)return this.log.error("Bad arguments given to switch()."),!1;var n="0px",i="0px";return e&&(n="-"+100*e+"%"),t&&(i="-"+100*t+"%"),this.videoEl.style.top===n&&this.videoEl.style.left===i||(this.videoEl.style.top=n,this.videoEl.style.left=i),!0},onFullscreenChange:function(e){Fo&&this.rows===this.cols&&this.rows>1&&(this.videoEl.style.height=e?100*this.rows-1+"%":100*this.rows+"%")},ctor:function(e,t){this.defineProperty("videoEl",(()=>e.children[0])),this.core=t,this.core.on(this.core.events.fullscreenchange,this.onFullscreenChange)},dispose:function(){this.core.off(this.core.events.fullscreenchange,this.onFullscreenChange)}});const Uo=ji.extend({name:"PresumedVisibility",logLevel:"warn",excludeFuncFromAutoDebug:["onVisibilityRaf","onCheckVisibility"],defaults:{visibilityThreshold:.15,checkVisibilityInterval:.25},api:null,lastAnimationFrameTimestamp:null,prevPresumedVisibility:null,scheduledRafId:null,checkVisibilityIntervalId:null,onVisibilityRaf:function(){this.lastAnimationFrameTimestamp=Date.now(),this.scheduledRafId=cn(this.onVisibilityRaf)},onCheckVisibility:function(){const e=this.getPresumedVisibility();e!==this.prevPresumedVisibility&&(this.prevPresumedVisibility=e,this.api.trigger("presumedvisibilitychange",e))},getPresumedVisibility:function(){return Date.now()-this.lastAnimationFrameTimestamp<1e3*this.getSetting("visibilityThreshold")},ctor:function(e){this.api=e.exports,this.onVisibilityRaf(),this.prevPresumedVisibility=this.getPresumedVisibility(),this.checkVisibilityIntervalId=setInterval(this.onCheckVisibility,1e3*this.getSetting("checkVisibilityInterval")),this.defineProperty("isPresumedVisible",this.getPresumedVisibility)},dispose:function(){clearInterval(this.checkVisibilityIntervalId),un(this.scheduledRafId)}});var jo=ji.extend({name:"Container",logLevel:"warn",defaults:{multiplyByDevicePixelRatio:!1},core:null,_container:null,_containerWidth:0,_containerHeight:0,triggerContainerResizeEvent:function(){this.core.trigger(this.core.events.containerresize,this._containerWidth,this._containerHeight)},onContainerResize:function(){const e=this.getSetting("multiplyByDevicePixelRatio")&&window.devicePixelRatio||1,t=this._container.offsetWidth*e,n=this._container.offsetHeight*e;this._containerWidth===t&&this._containerHeight===n||(this._containerWidth=t,this._containerHeight=n,this.triggerContainerResizeEvent())},addResizeListener:function(){window.addResizeListener&&window.addResizeListener(this._container,this.onContainerResize)},removeResizeListener:function(){if(window.removeResizeListener&&this._container)try{window.removeResizeListener(this._container,this.onContainerResize)}catch(e){}},getContainerWidth:function(){return this._containerWidth},getContainerHeight:function(){return this._containerHeight},getContainer:function(){return this._container},ctor:function(e){this.core=e,this._container=e.container,this.onContainerResize(),this.addResizeListener(),this.defineProperty("containerWidth",(function(){return this.getContainerWidth()})),this.defineProperty("containerHeight",(function(){return this.getContainerHeight()})),this.defineProperty("container",(function(){return this.getContainer()})),this.expose({containerWidth:this.exposeProperty("containerWidth"),containerHeight:this.exposeProperty("containerHeight"),container:this.exposeProperty("container")})},dispose:function(){this._super.apply(this,arguments),this.removeResizeListener()}});const zo=/.*?assets\.eko\.com\/.+?\/(.+?)\/(\d+)/,Vo=ji.extend({name:"AssetsDeliveryService",logLevel:"warn",defaults:{assetsDeliveryServiceUrl:"https://assets.eko.com",profile:null,imageWidth:1400,imageQuality:80,imageCrop:"limit",imageStartOffset:0},playerCtx:null,parseAssetIdAndRevision:function(e){var t;let n=null;const i=null==e||null===(t=e.match)||void 0===t?void 0:t.call(e,zo);return i&&(n={type:"assets-delivery-service",assetId:i[1],assetRevision:parseInt(i[2],10)},this.log.debug("[parseAssetIdAndRevision] Parsed assetId and revision:",n)),n},getAssetsDeliveryServiceBaseUrl:function(){return new URL(this.getSetting("assetsDeliveryServiceUrl")).origin},resolveProfileFromAvailableProfiles:function(e){const t=this.getSetting("profile");return e&&e.length?t&&e.includes(t)?t:e[0]:t||null},getImageUrl:function(e,t={}){var n,i,r,o;if(!e||!e.assetId||void 0===e.assetRevision)return null;const s=null!==(n=t.width)&&void 0!==n?n:this.getSetting("imageWidth"),a=null!==(i=t.quality)&&void 0!==i?i:this.getSetting("imageQuality"),l=null!==(r=t.crop)&&void 0!==r?r:this.getSetting("imageCrop"),c=null!==(o=t.startOffset)&&void 0!==o?o:this.getSetting("imageStartOffset"),u={...s?{width:s}:{},...a?{quality:a}:{},...l?{crop:l}:{},...c||0===c?{startOffset:c}:{}},d=new URLSearchParams(u).toString();return`${this.getAssetsDeliveryServiceBaseUrl()}/image/${e.assetId}/${e.assetRevision}?${d}`},getIvdUrl:function(e){const{assetId:t,assetRevision:n,availableEncodeProfiles:i=[]}=e,r=ki.getObjectProperty(this.playerCtx,"engine.neededFormatNames",[]),o=this.resolveProfileFromAvailableProfiles(i),s={formats:r.join(","),type:"data",...o?{profile:o}:{}};return`${this.getAssetsDeliveryServiceBaseUrl()}/ivd/${t}/${n}?${new URLSearchParams(s).toString()}`},loadIvds:async function(e){const t=(e=ki.arrayify(e)).map((e=>{const{assetId:t,assetRevision:n,availableEncodeProfiles:i=[]}=e.ivdUrl,r=this.resolveProfileFromAvailableProfiles(i);return`${t}:${n}${r?`:${r}`:""}`})),n=ki.getObjectProperty(this.playerCtx,"engine.neededFormatNames",[]),i={assets:t.join(","),formats:n.join(","),type:"data"},r=new URLSearchParams(i).toString(),o=`${this.getAssetsDeliveryServiceBaseUrl()}/ivd?${r}`;this.log.info(`Requesting IVDs: ${o}`);const s=await kr.get(o,{responseType:"json"});if(!s||"object"!=typeof s||Object.keys(s).length!==e.length){const t="Mismatch between requested IVD count and loaded IVD count.";throw this.log.error(t,e,s),new Error(`[AssetsDeliveryServiceUrl] ${t}`)}e.forEach((e=>{if(!s[e.id]){const t=`[${e.id}] is missing from loaded IVDs.`;throw this.log.error(t,s),new Error(`[AssetsDeliveryServiceUrl] ${t}`)}e.doResolveWithIvd(s[e.id])})),this.log.info("Successfully loaded and resolved segments:",t)},ctor:function(){this.playerCtx=qi.get(this.options&&this.options.playerInstanceId)}});var Wo=ji.extend({name:"AsyncIvdLoadingManager",logLevel:"warn",excludeFuncFromAutoDebug:["isAsyncSegment","isSegmentInPlaylist"],defaults:{maxConcurrent:5},api:null,repo:null,playlist:null,controller:null,assetsDeliveryService:null,segsToLoadArr:null,segsCurrentlyLoadingMap:null,newSegmentsThrottler:null,isMediaPreloaded:!1,addApiListeners:function(){this.api&&(this.api.once("canplay",this.onCanPlay),this.api.once("playing",this.onPlaying))},removeApiListeners:function(){this.api&&(this.api.off("canplay",this.onCanPlay),this.api.off("playing",this.onPlaying))},addRepoListeners:function(){this.repo&&(this.repo.on("segment.added",this.onSegmentAdded),this.repo.on("segment.removed",this.onSegmentRemoved),this.repo.on("segment.updated",this.onSegmentUpdated))},removeRepoListeners:function(){this.repo&&(this.repo.off("segment.added",this.onSegmentAdded),this.repo.off("segment.removed",this.onSegmentRemoved),this.repo.off("segment.updated",this.onSegmentUpdated))},addPlaylistListeners:function(){this.playlist&&this.playlist.on("push",this.onPlaylistPush)},removePlaylistListeners:function(){this.playlist&&this.playlist.off("push",this.onPlaylistPush)},sortLoadingArray:function(){if(this.segsToLoadArr=this.segsToLoadArr||[],!(this.segsToLoadArr.length<=1)){var e=function(e){var t={};return e.forEach((function(e){t[e.id]=e})),t}(this.segsToLoadArr.filter((function(e){return e&&!e.isResolved}))),t=[];this.playlist.nodes.forEach((function(n){n&&n.segment&&n.segment.id&&e.hasOwnProperty(n.segment.id)&&(t.push(e[n.segment.id]),delete e[n.segment.id])}));var n,i,r=this.repo,o={};this.playlist.nodes.length&&function(n){var i=[n];for(o[n.id]=!0;i.length;){var s=i.shift();e.hasOwnProperty(s.segment.id)&&(t.push(e[s.segment.id]),delete e[s.segment.id]),s.prefetch&&s.prefetch.length&&s.prefetch.map((function(e){return r.get(e)})).forEach((function(e){e&&!o[e.id]&&(i.push(e),o[e.id]=!0)}))}}(this.playlist.nodes[this.playlist.length-1]),n=e,i=function(n){t.push(n),delete e[n.id]},Object.keys(n).map((function(e){return n[e]})).forEach(i),this.segsToLoadArr=t}},onNewSegmentsTick:function(e){this.segsToLoadArr=(this.segsToLoadArr||[]).concat(e),this.sortLoadingArray(),Zr.scheduleExecution(this.loadNextBatch)},loadNextBatch:function(){var e=Math.min(this.getSetting("maxConcurrent")-Object.keys(this.segsCurrentlyLoadingMap).length,this.segsToLoadArr.length);e<=0||(this.isMediaPreloaded||0===this.api.exports.duration)&&this.loadSegments(this.segsToLoadArr.splice(0,e))},loadSegmentsBatchViaAssetsDeliveryService:function(e){e.forEach(function(e){this.segsCurrentlyLoadingMap[e.id]=e}.bind(this)),this.assetsDeliveryService.loadIvds(e).then(function(){e.forEach(function(e){delete this.segsCurrentlyLoadingMap[e.id],Zr.scheduleExecution(this.loadNextBatch)}.bind(this))}.bind(this)).catch(function(e){this.log.error("Error loading IVDs via assetsDeliveryService: ",e),this.notifyError(e)}.bind(this))},loadSegmentsIndividually:function(e){e.forEach(function(e){this.segsCurrentlyLoadingMap[e.id]=e,e.resolve().then(function(){this.log.info("successfully resolved ["+e.id+"]"),delete this.segsCurrentlyLoadingMap[e.id],Zr.scheduleExecution(this.loadNextBatch)}.bind(this)).catch(function(t){this.log.error("["+e.id+"] Error resolving individual IVD: ",t),this.notifyError(t)}.bind(this))}.bind(this))},loadSegments:function(e){this.log.info("Loading batch:",e.map((function(e){return e.id}))),e.every((function(e){return an.isAssetsDeliverySrvSourceType(e.ivdUrl)}))?this.loadSegmentsBatchViaAssetsDeliveryService(e):this.loadSegmentsIndividually(e)},onPlaylistPush:function(){Zr.scheduleExecution(this.sortLoadingArray)},isAsyncSegment:function(e){return e instanceof Sr},isAsyncSegmentResolved:function(e){return e&&e.isResolved},isSegmentInPlaylist:function(e){if(!e||!e.id||!this.playlist.nodes.length)return!1;for(var t=!1,n=0,i=this.playlist.nodes.length;n<i;++n)if(this.playlist.nodes[n]&&this.playlist.nodes[n].segment&&this.playlist.nodes[n].segment.id===e.id){t=!0;break}return t},onSegmentAdded:function(e){ki.arrayify(e).filter(this.isAsyncSegment).forEach(function(e){this.log.info("Adding LinkSegment ["+e.id+"]"),this.newSegmentsThrottler.push(e)}.bind(this))},onSegmentRemoved:function(){},onSegmentUpdated:function(e){ki.arrayify(e).forEach(function(e){this.segsCurrentlyLoadingMap[e.id]&&this.isAsyncSegmentResolved(e)&&(this.log.info("Marking as resolved ["+e.id+"]"),delete this.segsCurrentlyLoadingMap[e.id],Zr.scheduleExecution(this.loadNextBatch))}.bind(this))},onCanPlay:function(){this.isMediaPreloaded=!0,Zr.scheduleExecution(this.loadNextBatch)},onPlaying:function(){this.isMediaPreloaded=!0,Zr.scheduleExecution(this.loadNextBatch)},ctor:function(e,t,n,i,r){this.api=e,this.repo=t,this.controller=n,this.playlist=i,this.assetsDeliveryService=r,this.segsToLoadArr=[],this.segsCurrentlyLoadingMap={},this.newSegmentsThrottler=Zr.createThrottler(this.onNewSegmentsTick,0),this.addRepoListeners(),this.addPlaylistListeners(),this.addApiListeners()},dispose:function(){this._super.apply(this,arguments),this.newSegmentsThrottler.dispose(),this.removeRepoListeners(),this.removePlaylistListeners(),this.removeApiListeners()}});const Ho=ki.getObjectProperty(Ae,"browser.name","").toLowerCase(),$o=ki.getObjectProperty(Ae,"browser.version","0.0.0"),Go=parseInt(ki.getObjectProperty(Ae,"browser.major",0),10),qo=ki.getObjectProperty(Ae,"engine.name","").toLowerCase(),Yo=ki.getObjectProperty(Ae,"os.name","").toLowerCase(),Ko=ki.getObjectProperty(Ae,"os.version","0.0.0"),Xo=Ho.indexOf("safari")>=0,Qo="ios"===Yo,Zo=Xo||Qo;var Jo={mpegtsv1:{name:"mpegtsv1",source:"ts",mimeType:"video/mp2t",mimeTypeAndCodecs:'video/mp2t; codecs="avc1.4D401F, mp4a.40.2"',mediaCapabilitiesConfig:{video:{contentType:'video/mp2t; codecs="avc1.64001F"',width:1280,height:720,bitrate:3067608,framerate:24},audio:{contentType:'audio/mp2t; codecs="mp4a.40.2"',channels:2,bitrate:96314,samplerate:44100}}},mp4v1:{name:"mp4v1",source:"mp4",mimeType:"video/mp4",mimeTypeAndCodecs:'video/mp4; codecs="avc1.4D401F, mp4a.40.2"',mediaCapabilitiesConfig:{video:{contentType:'video/mp4; codecs="avc1.64001F"',width:1280,height:720,bitrate:3067608,framerate:24},audio:{contentType:'audio/mp4; codecs="mp4a.40.2"',channels:2,bitrate:96314,samplerate:44100}}},mp4v2:{name:"mp4v2",source:"mp4",mimeType:"video/mp4",mimeTypeAndCodecs:'video/mp4; codecs="avc1.42C01E"',mediaCapabilitiesConfig:{video:{contentType:'video/mp4; codecs="avc1.64001F"',width:1280,height:720,bitrate:3067608,framerate:24}}},mp4v3:{name:"mp4v3",source:"mp4",mimeType:"video/mp4",mimeTypeAndCodecs:'video/mp4; codecs="avc1.42C01E"',aliases:["fmp4_avc"],mediaCapabilitiesConfig:{video:{contentType:'video/mp4; codecs="avc1.640028"',width:1920,height:1080,bitrate:6277152,framerate:23.976}}},mp4v5:{name:"mp4v5",source:"mp4",mimeType:"video/mp4",mimeTypeAndCodecs:'video/mp4; codecs="hvc1.1.6.L90.90"',aliases:["fmp4_hevc"],mediaCapabilitiesConfig:{video:{contentType:'video/mp4; codecs="hvc1.1.6.L93.90"',width:1280,height:720,bitrate:2166746,framerate:23.976}}},webmv1:{name:"webmv1",source:"webm",mimeType:"video/webm",mimeTypeAndCodecs:'video/webm; codecs="vp9"',aliases:["webm_vp9"],mediaCapabilitiesConfig:{video:{contentType:'video/webm; codecs="vp09.00.40.08"',width:1920,height:1080,bitrate:3310708,framerate:23.976}},isSupported:("chrome"!==Ho||Go>=55)&&("edge"!==Ho||"blink"===qo)&&("firefox"!==Ho||Go<86)},oggv1:{name:"oggv1",source:"ogg",mimeType:"audio/ogg",mimeTypeAndCodecs:'audio/ogg; codecs="vorbis"',mediaCapabilitiesConfig:{audio:{contentType:'audio/ogg; codecs="vorbis"',channels:2,bitrate:85204,samplerate:44100}}},webm_vorbis:{name:"webm_vorbis",source:"webm",mimeType:"audio/webm",mimeTypeAndCodecs:'audio/webm; codecs="vorbis"',mediaCapabilitiesConfig:{audio:{contentType:'audio/webm; codecs="vorbis"',channels:2,bitrate:85204,samplerate:44100}},isSupported:!Zo||Xo&&ki.compareVersions($o,"17.5",">=")||Qo&&ki.compareVersions(Ko,"17.5",">=")},m4av1:{name:"m4av1",source:"m4a",mimeType:"audio/mp4",mimeTypeAndCodecs:'audio/mp4; codecs="mp4a.40.2"',mediaCapabilitiesConfig:{audio:{contentType:'audio/mp4; codecs="mp4a.40.2"',channels:2,bitrate:99976,samplerate:44100}}},mp3v1:{name:"mp3v1",source:"mp3",mimeType:"audio/mpeg",mimeTypeAndCodecs:'audio/mpeg; codecs="mp3"',mediaCapabilitiesConfig:{audio:{contentType:'audio/mpeg; codecs="mp3"',channels:2,bitrate:121859,samplerate:44100}}},wavv1:{name:"wavv1",source:"wav",mimeType:"audio/wav",mimeTypeAndCodecs:'audio/wav; codecs="1"',mediaCapabilitiesConfig:{audio:{contentType:'audio/wav; codecs="1"',channels:2,bitrate:1411200,samplerate:44100}}}};ki.extend(Jo,{fmp4_avc:ki.extend({},Jo.mp4v3,{name:"fmp4_avc",aliases:["mp4v3"]}),fmp4_hevc:ki.extend({},Jo.mp4v5,{name:"fmp4_hevc",aliases:["mp4v5"]}),webm_vp9:ki.extend({},Jo.webmv1,{name:"webm_vp9",aliases:["webmv1"]}),fm4a_aac:ki.extend({},Jo.m4av1,{name:"fm4a_aac",isSupported:!Zo})});var es=ki.getObjectProperty(Ae,"browser.name","").toLowerCase(),ts=ki.getObjectProperty(Ae,"os.name","").toLowerCase(),ns=es.indexOf("safari")>=0||"ios"===ts,is=ji.extend({name:"WebAudioFormat",logLevel:"warn",defaults:{forceFormat:!1,formats:Ar.getSupportedFormatNames(Ar.engineTechs.WEB_AUDIO)},detect:function(){var e,t=null;if((e=this.getSetting("forceFormat",!1))&&Jo[e])this.log.info("Forcing audio format: "+e),t=[Jo[e]];else if(e)this.log.error("Unknown audio format: "+e);else{var n=window.Audio&&new window.Audio;t=this.getSetting("formats",[]).map((function(e){return Jo[e]})).filter((function(e){var t="";return n&&e&&e.mimeTypeAndCodecs&&(t=n.canPlayType(e.mimeTypeAndCodecs))&&("probably"===t||"maybe"===t&&ns)&&("boolean"!=typeof e.isSupported||e.isSupported)}))}return null!==t&&t.length?this.log.info("Returning formats:",t):this.log.info("No supported audio formats found!"),t}});const rs=ji.extend({name:"WebCodecsFormat",logLevel:"warn",defaults:{forceFormat:!1,formats:Ar.getSupportedFormatNames(Ar.engineTechs.WEBCODECS),hardwareAcceleration:Xi.getDefault("hardwareAcceleration")},excludeFuncFromAutoDebug:["isFormatSupported"],isFormatSupported:async function(e){if(void 0===window.VideoDecoder)return!1;const t=e&&e.mediaCapabilitiesConfig&&e.mediaCapabilitiesConfig.video;if(!t||!t.contentType)return!1;const n=t.contentType.match(/codecs="([^"]+?)[",]/)[1];if(!n)return!1;const i={codec:n,codedWidth:t.width,codedHeight:t.height,...this.getSetting("hardwareAcceleration")?{hardwareAcceleration:this.getSetting("hardwareAcceleration")}:{}};try{const{supported:e,config:t}=await window.VideoDecoder.isConfigSupported(i);return this.log.info(`VideoDecoder.isConfigSupported(${JSON.stringify(t)}) returned ${e}`),e}catch(e){return this.log.error(`VideoDecoder.isConfigSupported(${JSON.stringify(i)}) failed with error: ${e}`),!1}},detect:async function(){let e=null;const t=this.getSetting("forceFormat",!1);if(t&&Jo[t])this.log.info("Forcing video format: "+t),e=[Jo[t]];else if(t)this.log.error("Unknown video format: "+t);else{const t=this.getSetting("formats",[]).map((function(e){return Jo[e]}));e=(await Promise.all(t.map((async e=>await this.isFormatSupported(e)?e:null)))).filter(Boolean)}return null!==e&&e.length?this.log.info("Returning formats:",e):this.log.info("No supported video formats found!"),e}});var os,ss=ki.getObjectProperty(Ae,"browser.name","").toLowerCase(),as=parseInt(ki.getObjectProperty(Ae,"browser.major",0),10);const ls=void 0!==(null===(os=window)||void 0===os?void 0:os.VideoDecoder);let cs=!1;var us=ji.extend({name:"EngineTech",logLevel:"warn",defaults:{forceTech:!1,disableTechs:[],techs:Xi.getDefault("engines"),useMetamorphosisFallbackEngine:Xi.getDefault("metamorphosisEnabled")},webAudioFormats:null,webcodecsFormats:null,canSpawnWorker:!1,supportMap:{},isTechSupported:function(e){if(this.supportMap.hasOwnProperty(e))return this.supportMap[e];var t=!1;switch(e.toLowerCase()){case"webaudionull":case"webaudio":t=window&&(window.AudioContext||window.webkitAudioContext)&&this.webAudioFormats&&this.webAudioFormats.length&&("firefox"!==ss||as>=43)&&this.canSpawnWorker;break;case"webcodecs":t=this.isTechSupported("nullwebcodecs")&&this.isTechSupported("webaudio");break;case"composite":t=this.isTechSupported("webcodecs");break;case"metamorphosis":case"fallback":case"null":t=!0;break;case"nullwebcodecs":t=ls&&this.webcodecsFormats&&this.webcodecsFormats.length>=1&&this.canSpawnWorker;break;default:this.log.warn("Unknown tech: "+e)}return this.supportMap[e]=t,this.supportMap[e]},getCompositeVideoComponentTechObject:function(e){return"webcodecs"===e?{videoTech:"webcodecs",formats:this.webcodecsFormats}:["webcodecs","fallback"].filter(this.isTechSupported).map(this.getCompositeVideoComponentTechObject)[0]},getTechObject:function(e){var t=null;switch(e.toLowerCase()){case"fallback":t={videoTech:"fallback"};break;case"webaudio":case"webcodecs":case"composite":t={videoTech:"composite",components:[{videoTech:"webaudio",formats:this.webAudioFormats},this.getCompositeVideoComponentTechObject(e.toLowerCase())]};break;case"null":t={videoTech:"null"};break;case"webaudionull":t={videoTech:"composite",components:[{videoTech:"webaudio",formats:this.webAudioFormats},{videoTech:"null"}]};break;case"nullwebcodecs":t={videoTech:"composite",components:[{videoTech:"null"},{videoTech:"webcodecs",formats:this.webcodecsFormats}]};break;default:this.log.warn("Unknown tech: "+e)}return this.getSetting("useMetamorphosisFallbackEngine")&&t&&"fallback"!==t.videoTech&&this.log.info("[getTechObject] Wrapped selected video tech with a Metamorphosis engine, configured to start with a fallback engine:",t={videoTech:"metamorphosis",components:[{videoTech:"fallback"},t]}),t},detect:function(){var e,t=null;if(e=this.getSetting("forceTech",!1))(t=this.getTechObject(e))?this.log.info("Forcing tech: "+e):(this.log.error("Cannot force technology, unknown tech: "+e),this.notifyError(2,e));else{var n=this.getTechs();if(!n)return null;for(var i=0;i<n.length;i++)if(this.isTechSupported(n[i])){t=this.getTechObject(n[i]),this.log.info("Detected tech: "+n[i]);break}t||(this.log.error("Could not find any supported video technology."),this.notifyError(3))}return t},supportedEngines:function(){var e=[],t=this.getTechs();if(!t)return e;for(var n=0;n<t.length;n++)this.isTechSupported(t[n])&&e.push(t[n]);return e},getTechs:function(){var e=this.getSetting("techs");if("function"==typeof e&&(e=e()),!e||!Array.isArray(e)||!e.length)return this.log.error("Invalid EngineTech configuration, 'techs' must be a non-empty array (or function that returns a non-empty array):",e),this.notifyError(64,e),null;Ae.queryParams.forceTech&&-1===e.indexOf(Ae.queryParams.forceTech)&&e.push(Ae.queryParams.forceTech);var t=this.getSetting("disableTechs");return t&&Array.isArray(t)?t.forEach((function(t){var n=e.indexOf(t);n>-1&&(this.log.info("[getTechs] Disabling tech '"+t+"'"),e.splice(n,1))}),this):this.log.warn("[getTechs] Invalid value for config option 'disableTechs', expected array, instead got:",t),this.log.info("Techs to detect: ",e),e},doAsyncInit:async function(){this.webcodecsFormats=await new rs(this.options).detect(),this.log.info("Detected WebCodecs formats:",this.webcodecsFormats&&this.webcodecsFormats.map((function(e){return e.name})))},ctor:function(){if(!cs)throw new Error("EngineTech cannot be instantiated directly. Please use EngineTech.create() instead.");this.webAudioFormats=new is(this.options).detect(),this.canSpawnWorker=ki.canSpawnWorker(),this.isCanvasSupported=function(){var e=document.createElement("canvas");return!(!e.getContext||!e.getContext("2d"))}(),this.isBlobConstructorSupported=window&&window.Blob&&("function"==typeof window.Blob||"object"==typeof window.Blob),this.isCreateObjectURLSupported=window&&window.URL&&"function"==typeof window.URL.createObjectURL,this.log.info("Detected WebAudio formats:",this.webAudioFormats&&this.webAudioFormats.map((function(e){return e.name}))),this.log.info("Is WebCodecs API supported:",ls),this.expose({detect:this.detect,supportedEngines:this.supportedEngines})}});us.create=async(...e)=>{cs=!0;const t=new us(...e);return await t.doAsyncInit(),cs=!1,t};var ds=ji.extend({name:"BaseEngine",logLevel:"warn",api:null,events:null,repository:null,video:null,appendNode:function(e){return S()},reset:function(){return S()},endStream:function(){return S()},seek:function(e,t){return S()},videoTech:function(){return"unknown"},getEngineString:function(){return this.videoTech()},getBuffered:function(){return 0},updateBitrate:function(e){},updateBaseUrl:function(e){},setForceBaseUrl:function(e){},setBitrateMultiplier:function(e){},isRepSupported:function(e){return!0},transformIvd:function(e){return e&&e.representations&&e.representations.length?(e.representations=e.representations.filter(this.isRepSupported),e):e},getIsUnlockingRequired:function(){return!1},loadNode:function(){},monitorDownloads:function(e){},setBaseUrlLoadVariants:function(e){},getNeededFormatNames:function(){return[]},getContainerResolution:function(){return{width:this.api.exports.containerWidth,height:this.api.exports.containerHeight}},onContainerResize:function(){},addRemoveApiListeners:function(e=!1){this.api.exports[e?"on":"off"]("containerresize",this.onContainerResize)},addApiListeners:function(){this.addRemoveApiListeners(!0)},removeApiListeners:function(){this.addRemoveApiListeners(!1)},ctor:function(e,t,n){this.api=e,this.repository=t,this.events=e.events,this.formats=n,this.addApiListeners(),this.repository&&this.repository.segmentFactory&&"function"==typeof this.repository.segmentFactory.setEngineIvdTransformer&&this.repository.segmentFactory.setEngineIvdTransformer(this.transformIvd),this.defineProperty("isUnlockingRequired",this.getIsUnlockingRequired),this.defineProperty("buffered",this.getBuffered),this.defineProperty("neededFormatNames",this.getNeededFormatNames),this.defineProperty("engineStr",this.getEngineString),this.expose({appendNode:this.appendNode,reset:this.reset,seek:this.seek,videoTech:this.videoTech})},dispose:function(){this._super.apply(this,arguments),this.removeApiListeners()}}),hs=ji.extend({name:"BaseVideo",logLevel:"warn",api:null,events:null,play:function(){},pause:function(){},currentTime:function(){},getVolume:function(){},setVolume:function(e){},getMuted:function(){},setMuted:function(e){},getPaused:function(){},getVideoWidth:function(){},getVideoHeight:function(){},getPlaybackRate:function(){return 1},setPlaybackRate:function(e){},getIsAudioLocked:function(){},getCurrentVideoTotalFrames:function(){return 0},getCurrentVideoDroppedFrames:function(){return 0},getCurrentSegmentIndex:function(){return 0},getCurrentSegmentTime:function(){return 0},ctor:function(e){this.api=e,this.events=e.events,this.defineEvents([this.events.audiolockedchange,this.events.resize,this.events.timeupdate,this.events.volumechange,this.events.loadeddata,this.events.playing,this.events.waiting,this.events.play,this.events.pause,this.events.ended,"segmentend"]),this.defineProperty("volume",(function(){return this.getVolume()}),(function(e){this.setVolume(e)})),this.defineProperty("muted",(function(){return this.getMuted()}),(function(e){this.setMuted(e)})),this.defineProperty("paused",(function(){return this.getPaused()})),this.defineProperty("isAudioLocked",(function(){return this.getIsAudioLocked()})),this.defineProperty("videoWidth",(function(){return this.getVideoWidth()})),this.defineProperty("videoHeight",(function(){return this.getVideoHeight()})),this.expose({volume:this.exposeProperty("volume"),muted:this.exposeProperty("muted"),isAudioLocked:this.exposeProperty("isAudioLocked"),videoWidth:this.exposeProperty("videoWidth"),videoHeight:this.exposeProperty("videoHeight")})}}),ps=hs.extend({name:"CompositeVideo",logLevel:"warn",excludeFuncFromAutoDebug:["getFirstDefinedValue","currentTime","getPlaybackRate","setPlaybackRate"],api:null,events:null,videos:null,silent:{play:!1,pause:!1},aggregatePromises:function(e){var t=[];return this.videos.forEach((function(n){n&&t.push(e(n))})),S.all(t)},getFirstDefinedValue:function(e){var t;return this.videos.forEach((function(n){void 0===t&&n&&(t=e(n))})),t},getOredBooleanValue:function(e){var t=!1;return this.videos.forEach((function(n){n&&(t=t||!!e(n))})),t},getSum:function(e){var t=0;return this.videos.forEach((function(n){n&&(t+=e(n))})),t},addComponentsListeners:function(){this.videos.forEach(function(e){e&&(e.on(this.events.resize,this.onComponentResize),e.on(this.events.timeupdate,this.onComponentTimeupdate),e.on(this.events.volumechange,this.onComponentVolumeChange),e.on(this.events.audiolockedchange,this.onComponentAudioLockedChange),e.on(this.events.loadeddata,this.onComponentLoadedData),e.on(this.events.playing,this.onComponentPlaying),e.on(this.events.waiting,this.onComponentWaiting),e.on(this.events.play,this.onComponentPlay),e.on(this.events.pause,this.onComponentPause),e.on(this.events.ended,this.onComponentEnded),this.addErrorListener(e))}.bind(this))},removeComponentsListeners:function(){this.videos.forEach(function(e){e&&(e.off(this.events.resize,this.onComponentResize),e.off(this.events.timeupdate,this.onComponentTimeupdate),e.off(this.events.volumechange,this.onComponentVolumeChange),e.off(this.events.audiolockedchange,this.onComponentAudioLockedChange),e.off(this.events.loadeddata,this.onComponentLoadedData),e.off(this.events.playing,this.onComponentPlaying),e.off(this.events.waiting,this.onComponentWaiting),e.off(this.events.play,this.onComponentPlay),e.off(this.events.pause,this.onComponentPause),e.off(this.events.ended,this.onComponentEnded),this.removeErrorListener(e))}.bind(this))},initVideos:function(){this.videos.forEach((function(e,t,n){if(e&&"function"==typeof e.setOtherVideos){var i=Array.prototype.slice.call(n);i.splice(t,1),e.setOtherVideos(i)}}))},onComponentResize:function(){this.trigger.apply(this,[this.events.resize].concat(Array.prototype.slice.call(arguments)))},onComponentTimeupdate:function(){this.trigger.apply(this,[this.events.timeupdate].concat(Array.prototype.slice.call(arguments)))},onComponentVolumeChange:function(){this.trigger.apply(this,[this.events.volumechange].concat(Array.prototype.slice.call(arguments)))},onComponentAudioLockedChange:function(){this.trigger.apply(this,[this.events.audiolockedchange].concat(Array.prototype.slice.call(arguments)))},onComponentLoadedData:function(){this.trigger.apply(this,[this.events.loadeddata].concat(Array.prototype.slice.call(arguments)))},onComponentPlaying:function(){this.trigger.apply(this,[this.events.playing].concat(Array.prototype.slice.call(arguments)))},onComponentWaiting:function(){this.trigger.apply(this,[this.events.waiting].concat(Array.prototype.slice.call(arguments)))},onComponentPlay:function(){this.silent.play||this.trigger.apply(this,[this.events.play].concat(Array.prototype.slice.call(arguments)))},onComponentEnded:function(){this.trigger.apply(this,[this.events.ended].concat(Array.prototype.slice.call(arguments)))},onComponentPause:function(){this.silent.pause||this.trigger.apply(this,[this.events.pause].concat(Array.prototype.slice.call(arguments)))},play:function(e){return((e=e||{}).silent||e.silence)&&(this.silent.play=!0),e.nowait?this.aggregatePromises((function(t){return t.play(e)})).then(function(){this.silent.play=!1}.bind(this)):this.aggregatePromises((function(t){return t.play(ki.extend({},e,{wait:!0}))})).then(function(){return this.aggregatePromises((function(t){return t.play(e)}))}.bind(this)).then(function(){this.silent.play=!1}.bind(this))},pause:function(e){return((e=e||{}).silent||e.silence)&&(this.silent.pause=!0),this.aggregatePromises((function(e){return e.pause()})).then(function(){this.silent.pause=!1}.bind(this))},currentTime:function(){return this.getFirstDefinedValue((function(e){return e.currentTime()}))},getVolume:function(){return this.getFirstDefinedValue((function(e){return e.getVolume()}))},setVolume:function(e){this.videos.forEach((function(t){t.setVolume(e)}))},getMuted:function(){return this.getFirstDefinedValue((function(e){return e.getMuted()}))},setMuted:function(e){this.videos.forEach((function(t){t.setMuted(e)}))},getPaused:function(){return this.getFirstDefinedValue((function(e){return e.getPaused()}))},getVideoWidth:function(){return this.getFirstDefinedValue((function(e){return e.getVideoWidth()}))},getVideoHeight:function(){return this.getFirstDefinedValue((function(e){return e.getVideoHeight()}))},getPlaybackRate:function(){return this.getFirstDefinedValue((function(e){return e.getPlaybackRate()}))},setPlaybackRate:function(e){this.videos.forEach((function(t){t.setPlaybackRate(e)}))},getIsAudioLocked:function(){return this.getFirstDefinedValue((function(e){return e.getIsAudioLocked()}))},getCurrentVideoTotalFrames:function(){return this.getSum((function(e){return e.getCurrentVideoTotalFrames()}))},getCurrentVideoDroppedFrames:function(){return this.getSum((function(e){return e.getCurrentVideoDroppedFrames()}))},ctor:function(e,t){this.videos=t,this.initVideos(),this._super.apply(this,arguments),this.addComponentsListeners()},dispose:function(){this._super.apply(this,arguments),this.removeComponentsListeners()}}),fs=me.createLogger("CompositeRepresentation","warn");function gs(e){var t={};return e.forEach((function(e){t[e]=!0})),Object.keys(t)}var ms=function(){var e={};this.add=function(t,n){e[t]=n},this.get=function(){var t={components:e};return Object.keys(e).sort().forEach((function(n){for(var i in e[n])t[i]?"measuredBandwidth"===i?t[i]=Math.max(t[i],e[n][i]):"bitrateMultiplier"===i?t[i]=Math.min(t[i],e[n][i]):/[bB]andwidth|contentLength/g.test(i)?t[i]+=e[n][i]:"string"==typeof t[i]?t[i]+="+"+e[n][i]:Array.isArray(t[i])&&(t[i]=gs(t[i].concat(e[n][i]))):t[i]=e[n][i]})),fs.info("Returning composite representation object.",t),t}},ys=me.createLogger("BandwidthAggregator","warn"),vs=function(e,t){var n=(t=t||{}).alpha||.15,i=t.cacheRate||(t.env&&t.env.isDesktop?8e7:2e7),r=t.cacheFactor||3,o=t.cacheScoreThreshold||.85,s=t.factorScoreWeight||.5,a="number"==typeof t.updateInterval?t.updateInterval:.1,l=!t.hasOwnProperty("enableCacheDetection")||t.enableCacheDetection,c=t.hasOwnProperty("bitrate")?t.bitrate:NaN,u=e,d={},h=!1,p=0,f="number"==typeof t.initialSyncSampleCount?t.initialSyncSampleCount:20,g=this,m=function(){g.trigger("bandwidthupdated",c)},y=function(e,t){if(!l)return!1;var n=function(e){return Math.log(1+Number(Math.min(e/(c*r),1)))/Math.log(2)}(t),a=function(e){return Math.log(1+Number(Math.min(e/i,1)))/Math.log(2)}(t);return s*n+(1-s)*a>=o},v=function(e){if(++p,isNaN(c)||1===p)return c=e,void m();c!==(c=n*e+(1-n)*c)&&m()},b=function(){var e=[],t=0,n=NaN;for(var i in d){var r=d[i];r.loading||e.push(i),n=r.bps,isNaN(n)||y(0,n)||(t+=n)}t>0&&!y(0,t)&&v(t);for(var o=0;o<e.length;o++)delete d[e[o]]},w=function(e){e&&e.segment&&e.segment.id&&!d.hasOwnProperty(e.segment.id)&&(d[e.segment.id]=e),!h&&a&&p>=f?(h=!0,setTimeout((function(){h&&(b(),h=!1)}),1e3*a)):(p<f||!a)&&b()},k=function(e){e&&e.off("bandwidthupdated",w)},x=function(e,t){!function(e){e&&e.on("bandwidthupdated",w)}(e)},S=function(e,t){k(e)};this.addExternalSample=function(e){e>0&&!y(0,e)&&v(e)},this.dispose=function(){for(var e in ys.info("Disposing of instance."),u&&(u.off("segmentloader.added",x),u.off("segmentloader.remove",S)),d)k(d[e]);d=null},Object.defineProperties(this,{bps:{get:function(){return c}}}),u&&(u.on("segmentloader.added",x),u.on("segmentloader.remove",S))};(vs.prototype=Object.create(Ti.prototype)).constructor=vs;var bs=ds.extend({name:"CompositeEngine",logLevel:"warn",defaults:{bitrateConfig:{alpha:.15,enableCacheDetection:!1},maxConcurrentRepresentationsChosen:10,representationsChosenInterval:.016},excludeFuncFromAutoDebug:["onBandwidthAggregatorUpdated","onBitrateUpdated"],_engineStr:"",engines:[],segMap:{},representationChosenListeners:{},representationsChosenListeners:{},onBitrateUpdated:function(e){this.bandwidthAggregator.addExternalSample(e)},onBandwidthAggregatorUpdated:function(e){this.trigger("bitrateUpdated",e)},onDownloadComplete:function(e,t){this.trigger("downloadComplete",e,t)},onBytesDownloaded:function(e){this.trigger("bytesDownloaded",e)},onNodeLoading:function(e){this.trigger("nodeLoading",e)},onNodeLoadingPausing:function(e){this.trigger("nodeLoadingPausing",e)},onNodeLoadingComplete:function(e){this.trigger("nodeLoadingComplete",e)},aggregatePromises:function(e){var t=[];return this.engines.forEach((function(n){n&&t.push(e(n))})),S.all(t)},getFirstDefinedValue:function(e){var t;return this.engines.forEach((function(n){n&&void 0===t&&(t=e(n))})),t},getOredBooleanValue:function(e){var t=!1;return this.engines.forEach((function(n){n&&(t=t||!!e(n))})),t},addEngineListeners:function(){this.engines.forEach(function(e){if(e){var t=e.videoTech();e.on("bitrateUpdated",this.onBitrateUpdated),e.on("downloadComplete",this.onDownloadComplete),e.on("bytesDownloaded",this.onBytesDownloaded),this.representationChosenListeners[t]=this.onRepresentationChosen.bind(this,t),e.on("representationChosen",this.representationChosenListeners[t]),this.representationsChosenListeners[t]=this.onRepresentationsChosen.bind(this,t),e.on("representationsChosen",this.representationsChosenListeners[t]),e.on("nodeLoading",this.onNodeLoading),e.on("nodeLoadingPausing",this.onNodeLoadingPausing),e.on("nodeLoadingComplete",this.onNodeLoadingComplete),this.addErrorListener(e)}}.bind(this)),this.video&&this.addErrorListener(this.video)},removeEngineListeners:function(){this.engines.forEach(function(e){if(e){var t=e.videoTech();e.off("bitrateUpdated",this.onBitrateUpdated),e.off("downloadComplete",this.onDownloadComplete),e.off("bytesDownloaded",this.onBytesDownloaded),e.off("representationChosen",this.representationChosenListeners[t]),delete this.representationChosenListeners[t],e.off("representationsChosen",this.representationsChosenListeners[t]),delete this.representationsChosenListeners[t],e.off("nodeLoading",this.onNodeLoading),e.off("nodeLoadingPausing",this.onNodeLoadingPausing),e.off("nodeLoadingComplete",this.onNodeLoadingComplete),this.removeErrorListener(e)}}.bind(this)),this.video&&this.removeErrorListener(this.video)},calcCompositeRep:function(e,t,n){this.segMap[t]||(this.segMap[t]={}),this.segMap[t][e]=n;var i=new ms(this.options);for(var r in this.segMap[t])i.add(r,this.segMap[t][r]);return i.get()},onRepresentationChosen:function(e,t,n){var i=this.calcCompositeRep(e,t,n);this.engines.forEach((function(e){e&&e.repoSyncHelper&&(e.repoSyncHelper._ignoreEvents=!0)})),this.trigger("representationChosen",t,i),this.engines.forEach((function(e){e&&e.repoSyncHelper&&(e.repoSyncHelper._ignoreEvents=!1)}))},resolveArrayOfSegments:function(e,t){var n=[];t.forEach(function(t){n.push({segId:t.segId,chosenRep:this.calcCompositeRep(e,t.segId,t.chosenRep)})}.bind(this)),this.engines.forEach((function(e){e&&e.repoSyncHelper&&(e.repoSyncHelper._ignoreEvents=!0)})),this.trigger("representationsChosen",n),this.engines.forEach((function(e){e&&e.repoSyncHelper&&(e.repoSyncHelper._ignoreEvents=!1)}))},onRepresentationsChosen:function(e,t){var n=this.getSetting("maxConcurrentRepresentationsChosen");if(t.length<n)return this.resolveArrayOfSegments(e,t);var i=this,r=this.segMap;!function o(){if(r===i.segMap){i.log.info("[onRepresentationsChosen] [doNextBatch]");var s=t.splice(0,n);i.resolveArrayOfSegments(e,s),t.length&&setTimeout(o,1e3*i.getSetting("representationsChosenInterval"))}else i.log.info("[onRepresentationsChosen] [doNextBatch] - detected a reset, returning.")}()},initEngines:function(){this.engines.forEach((function(e,t,n){if(e&&"function"==typeof e.setOtherEngines){var i=Array.prototype.slice.call(n);i.splice(t,1),e.setOtherEngines(i)}}))},appendNode:function(e){return this.aggregatePromises((function(t){return t.appendNode(e)}))},reset:function(){return this.aggregatePromises((function(e){return e.reset()})).then(function(){this.log.info("Resetting segMap"),this.segMap={}}.bind(this))},endStream:function(){this.engines.forEach((function(e){e.endStream()}))},seek:function(e,t){return this.aggregatePromises((function(n){return n.seek(e,t)}))},getBuffered:function(){return Math.min.apply(null,this.engines.map((function(e){return e.getBuffered()})))},videoTech:function(){return"composite("+this.engines.map((function(e){return e.videoTech()})).join(", ")+")"},getEngineString:function(){if(!this._engineStr)if(this.engines.length)if(1===this.engines.length)this._engineStr=this.engines[0].engineStr;else{const e=this.engines.map((e=>e.engineStr));e.includes("null")&&(this._engineStr=e.join("")),this._engineStr=e[e.length-1]}else this._engineStr="unknown";return this._engineStr},updateBitrate:function(e){this.engines.forEach((function(t){t.updateBitrate(e)}))},updateBaseUrl:function(e){this.engines.forEach((function(t){t.updateBaseUrl(e)}))},setForceBaseUrl:function(e){this.engines.forEach((function(t){t.setForceBaseUrl(e)}))},setBitrateMultiplier:function(e){this.engines.forEach((function(t){t.setBitrateMultiplier(e)}))},transformIvd:function(e){var t=ki.extend({},e);return t.representations=[],this.engines.forEach((function(n){t.representations=t.representations.concat(n.transformIvd(ki.extend({},e)).representations)})),t},getIsUnlockingRequired:function(){return this.getOredBooleanValue((function(e){return e.isUnlockingRequired}))},loadNode:function(){var e=arguments;this.engines.forEach((function(t){t.loadNode.apply(t,e)}))},monitorDownloads:function(e){this.engines.forEach((function(t){t.monitorDownloads(e)}))},setBaseUrlLoadVariants:function(e){this.engines.forEach((function(t){t.setBaseUrlLoadVariants(e)}))},getNeededFormatNames:function(){var e=[];return this.engines.forEach((function(t){e=e.concat(t.neededFormatNames)})),e},ctor:function(e,t,n,i){this._super(t,n),i&&i.length?(this.engines=i,this.initEngines(),this.video=new ps(this.options,this.api,this.engines.map((function(e){return e.video}))),this.bandwidthAggregator=new vs(null,this.getSetting("bitrateConfig")),this.bandwidthAggregator.on("bandwidthupdated",this.onBandwidthAggregatorUpdated),this.addEngineListeners()):this.notifyError("No engines given to CompositeEngine constructor")},dispose:function(){this._super.apply(this,arguments),this.bandwidthAggregator&&this.bandwidthAggregator.off("bandwidthupdated",this.onBandwidthAggregatorUpdated),this.removeEngineListeners(),this.engines.forEach((function(e){e&&e.dispose()}))}}),ws=me.createLogger("AudioSegment","warn"),ks=ki.getObjectProperty(Ae,"os.name","").toLowerCase(),xs=ki.getObjectProperty(Ae,"browser.name","").toLowerCase(),Ss="ios"===ks||xs.indexOf("safari")>=0;function Cs(e,t,n){return Math.round(e/t*n)}function _s(e,t,n){return Math.abs(e-t)<=n}var Es=function(e,t,n,i,r){e&&t&&i&&"number"==typeof i.frontPadSamples&&"number"==typeof i.audioSamplingRate&&"number"==typeof i.origSamples&&"number"==typeof i.backPadSamples||ws.error("Bad arguments given to constructor",arguments),r=r||{},n=n||e.createBuffer(1,i.frontPadSamples+i.origSamples+i.backPadSamples,i.audioSamplingRate),this.context=e,this.dest=t,this.buffer=n,this.meta=i,this.data=r.data,this.playbackRate="number"==typeof r.playbackRate?r.playbackRate:1;var o=Cs(i.frontPadSamples,i.audioSamplingRate,n.sampleRate),s=Cs(i.origSamples,i.audioSamplingRate,n.sampleRate),a=Cs(i.backPadSamples,i.audioSamplingRate,n.sampleRate),l=o+s+a,c=_s(n.length,s,1)||_s(n.length,s+a,1);if(ws.info("Expected total samples",l,"Actual total samples",n.length,"Difference",n.length-l,"frontPadWasDiscarded",c,"buffer",n),this.frontPadWasDiscarded=c,this.frontPadDuration=i.frontPadSamples/i.audioSamplingRate,"mp3v1"===i.format&&n.length-l>0){var u=(n.length-l)/n.sampleRate;this.frontPadDuration+=u,ws.info("MP3 decoder delay detected, increasing the frontPadDuration by "+u+" seconds. frontPadDuration:",this.frontPadDuration)}};(Es.prototype=Object.create(Ti.prototype)).constructor=Es,Es.prototype.play=function(e,t){this.source&&this.stop(),this.source=this.context.createBufferSource(),this.source.buffer=this.buffer,this.source.playbackRate.value=this.playbackRate,this.source.connect(this.dest),this.source.onended=function(){this.trigger("ended",this)}.bind(this);try{e=Math.max(e||0,0),t=t||0;var n=Math.max((this.frontPadWasDiscarded?0:this.frontPadDuration)+t,0),i=Math.max(this.getDuration()-t,0);if(this.buffer&&n>this.buffer.duration)return void ws.warn(`[play] Invalid params - offset ${n} is larger than buffer duration ${this.buffer.duration}.`);ws.info("[play] ["+ki.basename(this.meta&&this.meta.url)+"]","when:",e.toFixed(3),"offset:",n.toFixed(3),"duration:",i.toFixed(3)),this.source.start(e,n,i)}catch(e){ws.warn("[play] Web Audio error",e)}},Es.prototype.stop=function(){if(this.source)try{ws.info("[stop] ["+ki.basename(this.meta&&this.meta.url)+"]"),this.source.stop(0),this.source.disconnect(),this.source.onended=null;try{var e;Ss?(this.context&&(this.context.__dummyBuffer||(this.context.__dummyBuffer=this.context.createBuffer(1,1,22050)),e=this.context.__dummyBuffer),e&&(this.source.buffer=e)):this.source.buffer=null}catch(e){}this.source=null}catch(e){ws.warn("[stop] Web Audio error",e)}},Es.prototype.getDuration=function(){return this.meta&&this.meta.origSamples&&this.meta.audioSamplingRate?this.meta.origSamples/this.meta.audioSamplingRate:this.buffer?this.buffer.duration:NaN},Es.prototype.dispose=function(){ws.info("[dispose] ["+ki.basename(this.meta&&this.meta.url)+"]"),this.source&&this.stop(),this.source=null,this.buffer=null,this.context=null,this.removeAllListeners()},Object.defineProperties(Es.prototype,{duration:{enumerable:!0,get:function(){return this.getDuration()}},playbackRate:{enumerable:!0,get:function(){return this._playbackRate||1},set:function(e){"number"!=typeof e||isNaN(e)?ws.warn("Bad playbackRate argument, ignoring.",e):(e<=0&&(ws.warn("Playback rate value out of range (0, ). Changing to 1."),e=1),this._playbackRate=e,this.source&&this.source.playbackRate.value!==e&&(this.source.playbackRate.value=e))}}});var Ts=me.createLogger("WebAudioTrackWrapper","warn"),Ps=function(e,t,n){Ts.info("[ctor]",e,t,n),e&&t||Ts.error("Bad arguments given to constructor",arguments),this.context=e,this.gain=e.createGain(),this.audioTrack=n,this.gain.connect(t),this.onAudioTrackVolumeChange=this.onAudioTrackVolumeChange.bind(this),this.audioTrack.on("volumechange",this.onAudioTrackVolumeChange),this.onAudioTrackVolumeChange()};Ps.prototype.constructor=Ps,Ps.prototype.onAudioTrackVolumeChange=function(){this.gain.gain.value=this.audioTrack.muted?0:this.audioTrack.volume},Ps.prototype.dispose=function(){Ts.info("[dispose]"),this.gain&&this.gain.disconnect(),this.audioTrack&&this.audioTrack.off("volumechange",this.onAudioTrackVolumeChange),this.gain=null,this.context=null,this.audioTrack=null},Object.defineProperties(Ps.prototype,{audioNode:{enumerable:!0,get:function(){return this.gain}}});var Is=ji.extend({name:"PresentationTime",logLevel:"warn",excludeFuncFromAutoDebug:["getPlaybackRate","getPresentationTime"],ctxTimeAtLastPlaybackRateChange:0,presentationTimeAtLastPlaybackRateChange:0,playbackRate:1,resetPlayback:function(e){this.ctxTimeAtLastPlaybackRateChange=this.ctx.currentTime,this.presentationTimeAtLastPlaybackRateChange=e||0},setPlaybackRate:function(e){this.presentationTimeAtLastPlaybackRateChange=this.getPresentationTime(),this.ctxTimeAtLastPlaybackRateChange=this.ctx.currentTime,this.playbackRate=e},getPlaybackRate:function(){return this.playbackRate},getPresentationTime:function(){return this.presentationTimeAtLastPlaybackRateChange+(this.ctx.currentTime-this.ctxTimeAtLastPlaybackRateChange)*this.playbackRate},ctor:function(e){this.ctx=e}}),As=ji.extend({name:"MutedMode",logLevel:"warn",excludeFuncFromAutoDebug:["onTick","getCurrentTime","getCurrentSegmentIndex","getCurrentSegmentTime","getPlaybackRate","setPlaybackRate","getPaused"],defaults:{},_isEnabled:!1,wasDisabled:!1,currentTime:0,prevTick:NaN,isPaused:!0,api:null,pseudoSegments:[],currentSegmentIndex:0,presentationTime:null,onTick:function(){var e=O();isFinite(this.prevTick)?(this.currentTime+=(e-this.prevTick)/1e3,this.prevTick=e):this.prevTick=e},startTick:function(){Zr.isTicking(this.onTick)?this.isPaused=!1:(this.prevTick=O(),this.isPaused=!1,Zr.start(this.onTick))},stopTick:function(){Zr.stop(this.onTick),this.prevTick=NaN,this.isPaused=!0},updateCurrentSegmentIndex:function(){if(this.pseudoSegments.length)if(this.currentSegmentIndex>=this.pseudoSegments.length)this.log.warn("[updateCurrentSegmentIndex] Unexpected state, this.currentSegmentIndex === "+this.currentSegmentIndex+", but this.pseudoSegments.length === "+this.pseudoSegments.length);else{var e=this.pseudoSegments[this.currentSegmentIndex],t=this.getCurrentTime();if(!(t>=e.offset&&t<=e.offset+e.duration)){if(this.currentSegmentIndex===this.pseudoSegments.length-1)return this.log.warn('[updateCurrentSegmentIndex] No next segment pushed yet, triggering "ended" that will in turn trigger "waiting"'),void this.trigger("ended");for(var n=this.currentSegmentIndex+1;n<this.pseudoSegments.length;n++)if(t>=(e=this.pseudoSegments[n]).offset&&t<=e.offset+e.duration){this.currentSegmentIndex=n,this.log.info("[updateCurrentSegmentIndex] Triggering 'segmentend' for index ["+(n-1)+"]"),this.trigger("segmentend");break}}}else this.currentSegmentIndex=0},onSubNodeStart:function(){this.updateCurrentSegmentIndex()},onNodeStart:function(e){e.subnodes&&e.subnodes.length||this.updateCurrentSegmentIndex()},addApiListeners:function(){this.api&&(this.api.on("subnodestart",this.onSubNodeStart),this.api.on("nodestart",this.onNodeStart))},removeApiListeners:function(){this.api&&(this.api.off("subnodestart",this.onSubNodeStart),this.api.off("nodestart",this.onNodeStart))},play:function(){return this.enable(),this.startTick(),S()},pause:function(){return this.stopTick(),S()},getPaused:function(){return this.isPaused},getCurrentTime:function(){return this.presentationTime?this.presentationTime.getPresentationTime():0},push:function(e,t){this.wasDisabled||(this.log.info(`[push] Pushing audio segment with duration [${e.duration}] and startOffset [${t}]`,e),this.pseudoSegments.push({duration:e.duration,offset:this.pseudoSegments.length?this.pseudoSegments[this.pseudoSegments.length-1].offset+this.pseudoSegments[this.pseudoSegments.length-1].duration:0}),this.currentSegmentIndex===this.pseudoSegments.length-2&&this.updateCurrentSegmentIndex(),1===this.pseudoSegments.length&&t>0&&(this.currentTime=t))},reset:function(){this.wasDisabled||(this.pseudoSegments.length=0,this.currentSegmentIndex=0,this.currentTime=0)},enable:function(){this._isEnabled||(this._isEnabled=!0,this.addApiListeners(),this.trigger("enabled"))},disable:function(){this._isEnabled&&(this._isEnabled=!1,this.wasDisabled=!0,this.stopTick(),this.removeApiListeners(),this.trigger("disabled"))},getPlaybackRate:function(){return this.presentationTime?this.presentationTime.getPlaybackRate():1},setPlaybackRate:function(e){this.presentationTime&&this.presentationTime.setPlaybackRate(e)},getCurrentSegmentIndex:function(){return this.currentSegmentIndex},getCurrentSegmentTime:function(){var e=this.pseudoSegments[this.currentSegmentIndex];return e?this.getCurrentTime()-e.offset:0},ctor:function(e){this.api=e,this.presentationTime=new Is(this.options,this),this.defineProperty("isEnabled",(function(){return this._isEnabled}))}}),Os="ios"===ki.getObjectProperty(Ae,"os.name","").toLowerCase(),Ls=function(e){var t="running",n=Object.getOwnPropertyDescriptor(Object.getPrototypeOf(e),"currentTime")?Object.getOwnPropertyDescriptor(Object.getPrototypeOf(e),"currentTime").get:null,i=e.createBufferSource,r=new Ti,o=0,s=NaN;return e.currentTimeToOrigTime=function(e){return e+o},e.origCreateBufferSource=i.bind(e),e.suspend=function(){return"running"===t&&(t="suspended",s=n.call(e),r.trigger("statechange",t)),S()},e.resume=function(){if("suspended"===t&&(t="running",o+=n.call(e)-s,s=NaN,r.trigger("statechange",t)),Os){var i=e.currentTime;setTimeout((function(){e.currentTime===i&&i>0&&r.trigger("contextnotprogress",e.currentTimeProxy)}),50)}return S()},e.close=function(){return"running"!==t&&"suspended"!==t||(s=0,o=0,r.trigger("statechange",t="closed")),S()},e.on=function(){r.on.apply(r,arguments)},e.off=function(){r.off.apply(r,arguments)},Object.defineProperty(e,"state",{enumerable:!0,get:function(){return t}}),e.createBufferSource=function(){return function(e,t,n){var i,r,o,s,a,l={},c=!1,u=!1,d=e.start,h=e.stop,p=e.connect,f=e.disconnect,g=[];function m(){n.off("statechange",i)}function y(){m(),"function"==typeof r&&r()}function v(){c&&(e.onended=null,e=function(){var n=t.origCreateBufferSource();n.buffer=e.buffer;for(var i=0;i<g.length;i++)n.connect(g[i]);return n}(),c=!1),e.onended=y;var n=t.hasOwnProperty("currentTimeProxy")?t.currentTimeProxy:t.currentTime;if(n>=o+a)return e.onended=null,void m();n>=o&&n<o+a?d.call(e,t.currentTimeToOrigTime(n),s+(n-o),a-(n-o)):d.call(e,t.currentTimeToOrigTime(o),s,a),u=!0,c=!0}function b(n){e.onended=null,u&&h.call(e,t.currentTimeToOrigTime(n)||0),c=!0,u=!1}function w(t){Object.defineProperty(l,t,{enumerable:!0,get:function(){return e[t]}})}function k(t){Object.defineProperty(l,t,{enumerable:!0,get:function(){return e[t]},set:function(n){e[t]=n}})}return i=function(e){switch(e){case"suspended":b();break;case"running":v();break;case"ended":m()}},l.start=function(r,l,c){o=r||0,s=l||0,a=c||e.buffer.duration,n.on("statechange",i),"running"===t.state&&v()},l.stop=function(e){m(),b(e)},l.connect=function(t){g.push(t),p.apply(e,arguments)},l.disconnect=function(t){"number"!=typeof t||isNaN(t)?t&&e.outputs.indexOf(t)>=0?g.splice(e.outputs.indexOf(t),1):t||(g.length=0):g.splice(t,1),f.apply(e,arguments)},Object.defineProperty(l,"onended",{enumerable:!0,get:function(){return r},set:function(e){r=e}}),w("context"),w("numberOfInputs"),w("numberOfOutputs"),k("buffer"),k("detune"),k("channelCount"),k("channelCountMode"),k("channelInterpretation"),k("loop"),k("loopStart"),k("loopEnd"),k("playbackRate"),Object.defineProperty(l,"_audioBufferSourceNode",{enumerable:!0,get:function(){return e}}),l}(i.apply(this,arguments),e,r)},n?Object.defineProperty(e,"currentTime",{enumerable:!0,get:function(){return isNaN(s)?n.call(e)-o:s-o}}):(Object.defineProperty(e,"currentTimeProxy",{enumerable:!0,get:function(){return isNaN(s)?e.currentTime-o:s-o}}),n=function(){return e.currentTime}),e};const Ns=me.createLogger("audioContextFactory","warn");var Rs=window.AudioContext||window.webkitAudioContext,Ds=null,Ms=ji.extend({name:"LinearFunc",logLevel:"warn",defaults:{},a:0,b:0,applyFunc:function(e){return this.a*e+this.b},ctor:function(e){this.log.info("Got points: "+ao.pointsToStr(e)),this.a=(e[1].y-e[0].y)/(e[1].x-e[0].x),this.b=e[0].y-this.a*e[0].x,this.log.info("Calculated function: f(x) = "+this.a+"x"+(this.b>=0?" + ":" - ")+Math.abs(this.b))}}),Fs=ji.extend({name:"QuadFunc",logLevel:"warn",defaults:{createThirdPoint:function(e,t){return{x:(t.x+e.x)/2,y:(e.y+(e.y+t.y)/2)/2}}},a:0,b:0,c:0,normalizePoints:function(e){if(e.length>=3)return ao.sortPoints(e.slice(0,3));var t=this.getSetting("createThirdPoint")(e[0],e[1]);return e.push(t),this.log.info("[normalizePoints] Created third point: "+ao.pointToStr(t)),ao.sortPoints(e)},applyFunc:function(e){return this.a*Math.pow(e,2)+this.b*e+this.c},ctor:function(e){e=this.normalizePoints(e),this.log.info("Normalized points: "+ao.pointsToStr(e));var t=e[0],n=e[1],i=e[2];this.a=t.y/((t.x-n.x)*(t.x-i.x))+n.y/((n.x-t.x)*(n.x-i.x))+i.y/((i.x-t.x)*(i.x-n.x)),this.b=-t.y*(n.x+i.x)/((t.x-n.x)*(t.x-i.x))-n.y*(t.x+i.x)/((n.x-t.x)*(n.x-i.x))-i.y*(t.x+n.x)/((i.x-t.x)*(i.x-n.x)),this.c=t.y*n.x*i.x/((t.x-n.x)*(t.x-i.x))+n.y*t.x*i.x/((n.x-t.x)*(n.x-i.x))+i.y*t.x*n.x/((i.x-t.x)*(i.x-n.x)),this.log.info("Calculated function: f(x) = "+this.a+"x^2"+(this.b>=0?" + ":" - ")+Math.abs(this.b)+"x"+(this.c>=0?" + ":" - ")+Math.abs(this.c))}});function Bs(e,t,n,i,r,o,s,a,l){return e*r*l+t*o*s+n*i*a-e*o*a-t*i*l-n*r*s}var Us,js=ji.extend({name:"CubicFunc",logLevel:"warn",defaults:{createThirdPoint:function(e,t){return{x:(t.x+e.x)/2,y:(t.y+e.y)/2}},createFourthPoint:function(e,t,n){return{x:(t.x+e.x)/2,y:(t.y+(t.y+(t.y+e.y)/2)/2)/2}}},a:0,b:0,c:0,d:0,normalizePoints:function(e){if(e.length>=4)return ao.sortPoints(e.slice(0,4));if(2===e.length){var t=this.getSetting("createThirdPoint")(e[0],e[1]);e.push(t),e=ao.sortPoints(e),this.log.info("[normalizePoints] Created third point: "+ao.pointToStr(t))}if(3===e.length){var n=this.getSetting("createFourthPoint")(e[0],e[1],e[2]);e.push(n),e=ao.sortPoints(e),this.log.info("[normalizePoints] Created fourth point: "+ao.pointToStr(n))}return ao.sortPoints(e)},applyFunc:function(e){return this.a*Math.pow(e,3)+this.b*Math.pow(e,2)+this.c*e+this.d},ctor:function(e){e=this.normalizePoints(e),this.log.info("Normalized points: "+ao.pointsToStr(e));var t=e[0],n=e[1],i=e[2],r=e[3],o=Math.pow(t.x,3),s=Math.pow(t.x,2),a=t.x,l=Math.pow(n.x,3),c=Math.pow(n.x,2),u=n.x,d=Math.pow(i.x,3),h=Math.pow(i.x,2),p=i.x,f=Math.pow(r.x,3),g=Math.pow(r.x,2),m=r.x,y=function(e,t,n,i,r,o,s,a,l,c,u,d,h,p,f,g){return e*(o*u*1+1*s*p+1*c*f-1*u*p-s*c*1-o*f*1)-t*(r*u*1+1*s*h+1*l*f-1*u*h-s*l*1-r*f*1)+n*(r*c*1+1*o*h+1*l*p-1*c*h-o*l*1-r*p*1)-1*(r*c*f+o*u*h+s*l*p-s*c*h-o*l*f-r*p*u)}(o,s,a,0,l,c,u,0,d,h,p,0,f,g,m),v=t.y*Bs(c,u,1,h,p,1,g,m,1)-n.y*Bs(s,a,1,h,p,1,g,m,1)+i.y*Bs(s,a,1,c,u,1,g,m,1)-r.y*Bs(s,a,1,c,u,1,h,p,1),b=-t.y*Bs(l,u,1,d,p,1,f,m,1)+n.y*Bs(o,a,1,d,p,1,f,m,1)-i.y*Bs(o,a,1,l,u,1,f,m,1)+r.y*Bs(o,a,1,l,u,1,d,p,1),w=t.y*Bs(l,c,1,d,h,1,f,g,1)-n.y*Bs(o,s,1,d,h,1,f,g,1)+i.y*Bs(o,s,1,l,c,1,f,g,1)-r.y*Bs(o,s,1,l,c,1,d,h,1),k=-t.y*Bs(l,c,u,d,h,p,f,g,m)+n.y*Bs(o,s,a,d,h,p,f,g,m)-i.y*Bs(o,s,a,l,c,u,f,g,m)+r.y*Bs(o,s,a,l,c,u,d,h,p);this.a=v/y,this.b=b/y,this.c=w/y,this.d=k/y,this.log.info("Calculated function: f(x) = "+this.a+"x^3"+(this.b>=0?" + ":" - ")+Math.abs(this.b)+"x^2"+(this.c>=0?" + ":" - ")+Math.abs(this.c)+"x"+(this.d>=0?" + ":" - ")+Math.abs(this.d))}}),zs=ji.extend({name:"MathFuncFactory",logLevel:"warn",registeredFuncs:{},createWithPoints:function(e,t){return this.registeredFuncs.hasOwnProperty(e)||(this.log.warn("[createWithPoints] Unknown type '"+e+"'. Using 'linear' instead."),e="linear"),function(e){return e&&Array.isArray(e)&&e.length>=2&&e.reduce((function(e,t){return e&&ao.isPoint(t)}),!0)&&e.reduce((function(e,t){return e.areUnique=e.areUnique&&-1===e.values.indexOf(t.x),e.values.push(t.x),e}),{areUnique:!0,values:[]}).areUnique}(t)||(this.log.warn("[createWithPoints] Bad points argument, using (0, 0), (1, 1) instead:",t),t=[{x:0,y:0},{x:1,y:1}]),new this.registeredFuncs[e](this.options,ao.sortPoints(t))},register:function(e,t){this.registeredFuncs[e]=t},ctor:function(){this.register("linear",Ms),this.register("quad",Fs),this.register("cubic",js)}}),Vs=me.createLogger("tweener","warn"),Ws={to:function(e,t,n,i){if(!e||"object"!=typeof e||"number"!=typeof t||!n||"object"!=typeof n)return Vs.warn("[to] Invalid arguments:",e,t,n,i),e;if((i=i||{}).overwrite=!i.hasOwnProperty("overwrite")||i.overwrite,e.__tweener&&"function"==typeof e.__tweener.onTick&&i.overwrite&&(Vs.info("[to] Stopping ongoing tween"),Zr.stop(e.__tweener.onTick),delete e.__tweener),!t)return Vs.info("[to] Duration is 0, applying props immediately.",n),Object.keys(n).forEach((function(t){e[t]=n[t]})),"function"==typeof i.onComplete&&i.onComplete(e),e;Vs.info("[to] Starting tween with duration "+t+" seconds.",e,n);var r=ki.getTime(),o={};Us||(Us=new zs),Object.keys(n).forEach((function(t){o[t]=Us.createWithPoints(i.ease||"quad",i.points||[{x:0,y:e[t]||0},{x:.5,y:(e[t]||0)+.75*((n[t]||0)-(e[t]||0))},{x:1,y:n[t]||0}])})),e.__tweener={};var s=function(){var a=(ki.getTime()-r)/(1e3*t);if(a>=1)return Object.keys(n).forEach((function(t){e[t]=n[t]})),"function"==typeof i.onUpdate&&i.onUpdate(e),Zr.stop(s),delete e.__tweener,void("function"==typeof i.onComplete&&i.onComplete(e));Object.keys(n).forEach((function(t){e[t]=o[t].applyFunc(a)})),"function"==typeof i.onUpdate&&i.onUpdate(e)};return e.__tweener.onTick=s,Zr.start(s),e},stop:function(e){e&&e.__tweener&&"function"==typeof e.__tweener.onTick&&(Vs.info("[stop] Stopping ongoing tween",e.__tweener),Zr.stop(e.__tweener.onTick),delete e.__tweener)}},Hs=ki.getObjectProperty(Ae,"os.name","").toLowerCase(),$s=parseInt(ki.getObjectProperty(Ae,"os.version",0),10),Gs=ki.getObjectProperty(Ae,"browser.name","").toLowerCase(),qs=parseInt(ki.getObjectProperty(Ae,"browser.major",0),10),Ys="android"===Hs&&Gs.indexOf("chrome")>=0&&qs<49,Ks=ji.extend({name:"AudioContextManager",logLevel:"warn",excludeFuncFromAutoDebug:["currentTime","getContextCurrentTime","getContextCurrentTimeiOS","getPaused","getBuffered","getCurrentSegmentIndex","getCurrentSegmentTime","getMuted","getPlaybackRate","setPlaybackRate","initSuperNodeTracks","disposeOfAllWebAudioTracks","disposeOfWebAudioTrack","getVolume"],defaults:{mutedAutoplayEnabled:Xi.getDefault("mutedAutoplayEnabled"),forceAudioLocked:Xi.getDefault("forceAudioLocked"),muted:Xi.getDefault("muted"),contextRunningAssuranceTimeoutMs:500,maxiOSReInitAttempts:1,androidPlaySampleInterval:25,iOSCurrentTimeCacheIntervalMs:1e3/60,forceAudioContextProxy:Gs.indexOf("firefox")>=0&&qs<103||Gs.indexOf("chrome")>=0&&"ios"!==Hs&&(qs<=43||qs>=52&&qs<54),audioContextOptions:{latencyHint:"android"===Hs?void 0:.025}},_context:null,_gain:null,offset:NaN,isMuted:!1,currentVolume:1,playingSegments:[],totalDuration:0,currentSegmentIndex:0,iOSContextReInitAttempts:0,unlockedDefer:null,webaudioTracks:[],mutedMode:null,presentationTime:null,playSample:function(){if(this._context&&"running"===this._context.state){var e=this._context.createBuffer(1,1,22050),t=this._context.createBufferSource();e.getChannelData(0).set(new Float32Array([4e-5])),t.buffer=e,t.connect(this._context.destination),t.start(0)}},unlockAudioContext:function(){if(!this.isUnlocked){var e=this._context.createBuffer(1,1,22050),t=this._context.createBufferSource();t.buffer=e,t.connect(this._context.destination),t.start(0),this.log.info("[unlockAudioContext] Starting test to see if unlock was successful"),this._context.resume().then(function(){if(!this.isUnlocked)return this.log.info("[unlockAudioContext] Resume was successful, calling suspend"),this._context.suspend()}.bind(this)).then(function(){this.isUnlocked||(this.log.info("[unlockAudioContext] Resolving unlockedDefer - unlock test was successful"),this.unlockedDefer.resolve())}.bind(this))}},initAudioContext:function(){if(this._context&&"closed"!==this._context.state&&(this.removeAudioContextListeners(),this._context.close()),this.unlockedDefer=S.defer(),this._context=function(e,t){var n=null;return Rs&&(n=function(e){var t;if(Rs&&null===Ds)try{t=new Rs(e),Ds=!0}catch(e){Ds=!1,t=new Rs}else Rs&&(t=Ds?new Rs(e):new Rs);return t}(t),!Rs.prototype.suspend&&!Rs.prototype.resume||e?(n=Ls(n),Ns.info("[createAudioContext] Created proxy AudioContext")):Ns.info("[createAudioContext] Created native AudioContext")),n}(this.getSetting("forceAudioContextProxy"),this.getSetting("audioContextOptions")),!this._context)return this.log.error("[initAudioContext] Current browser does not support the WebAudio API."),void this.notifyError(97);if("ios"===Hs&&48e3===this._context.sampleRate&&$s<11){if(this.iOSContextReInitAttempts<this.getSetting("maxiOSReInitAttempts"))return this.log.warn("[initAudioContext] Re-initializing audio context instance, identified distorted audio state."),this.iOSContextReInitAttempts++,void this.initAudioContext();this.log.warn("[initAudioContext] Exhausted maximum iOS re-init attempts. Continuing with potentially distorted audio.")}return this.addAudioContextListeners(),this.addDocumentListeners(),this.unlockedDefer.promise.then(this.removeDocumentListeners).then((()=>{this.mutedMode.isEnabled&&this.switchFromMutedModeToAudioContext(),this.trigger("audiolockedchange")})),this._context.hasOwnProperty("currentTimeProxy")&&(this.log.info("[initAudioContext] Overriding getContextCurrentTime() implementation for proxy."),this.getContextCurrentTime=function(){return this._context.currentTimeProxy}.bind(this)),this._gain=this._context.createGain(),this._gain.connect(this._context.destination),this._gain.gain.value=this.isMuted?0:this.currentVolume,"running"===this._context.state?this.getSetting("forceAudioLocked")?this.log.info("[initAudioContext] Context is running, but forceAudioLocked is set. Will suspend."):(this.log.info("[initAudioContext] Context is running, marking as unlocked."),this.unlockedDefer.resolve()):this.log.info("[initAudioContext] Context is not running, assuming audio is locked."),"firefox"===Gs?this._context.resume().then(this._context.suspend.bind(this._context)):this._context.suspend()},decodeAudioData:function(e){if(Array.isArray(e)){if(this.envSupportsConcurrentDecode)return S.all(e.map(function(e){return this.decodeAudioData(e)}.bind(this)));var t=S(),n=[];return e.forEach(function(e){t=t.then(this.decodeAudioData.bind(this,e)).then((function(e){n.push(e)}))}.bind(this)),t.then((function(){return n}))}return S.promise(function(t,n){var i=this.context.decodeAudioData(e,t,(function(e){n(new Li(104,e))}));i&&"function"==typeof i.then&&i.then(t,(function(e){n(new Li(104,e))}))}.bind(this))},getContextCurrentTimeiOS:function(){var e=ki.getTime();return e-this._prevGetContextCurrentTimeiOS<=this.settings.iOSCurrentTimeCacheIntervalMs||(this._prevGetContextCurrentTimeiOS=e,this._contextCurrentTimeiOS=this._context&&this._context.currentTime||0),this._contextCurrentTimeiOS},getContextCurrentTime:function(){return this._context&&this._context.currentTime||0},getBuffered:function(){return this.totalDuration},disposeOfWebAudioTrack:function(e){e&&e.audioTrack&&(e.audioTrack.__webaudioTrack=null,e.dispose())},disposeOfAllWebAudioTracks:function(){this.webaudioTracks.forEach(this.disposeOfWebAudioTrack),this.webaudioTracks.length=0},wrapAudioTrack:function(e,t){if(e.__webaudioTrack){if(e.__webaudioTrack.context===this._context)return;this.disposeOfWebAudioTrack(e.__webaudioTrack)}e.__webaudioTrack=new Ps(this._context,t,e),this.webaudioTracks.push(e.__webaudioTrack)},initSuperNodeTracks:function(e){e&&"function"==typeof e.getAudioTracks?(this.wrapAudioTrack(e,this._gain),e.getAudioTracks().forEach(function(t){this.wrapAudioTrack(t,e.__webaudioTrack.gain)}.bind(this))):this.log.error("[initSuperNodeTracks] Invalid argument, expected a Node object, instead got:",e)},pushAlternatesToPlayback:function(e,t,n,i,r){i=i||0;var o=[];this.initSuperNodeTracks(r),t.forEach(function(t,i){var s=n[i];if(s.segId=e,this._context){var a=r.getAudioTracks()[i].__webaudioTrack.audioNode;o.push(new Es(this._context,a,t,s,{playbackRate:this.getPlaybackRate(),data:{index:this.playingSegments.length,altIndex:i}}))}}.bind(this)),isNaN(this.offset)&&(this.offset=this.getContextCurrentTime()),o.forEach(function(e){e.play(this.offset,i),e.offset=this.offset-i,e.presentationOffset=this.totalDuration}.bind(this)),o.length&&(this.offset+=(o[0].duration-i)/this.getPlaybackRate(),this.totalDuration+=o[0].duration,o.forEach(function(e){e.on("ended",this.onAudioSegmentEnded)}.bind(this)),this.playingSegments.push(o),1===this.playingSegments.length&&this.presentationTime.resetPlayback(i),this.mutedMode.push(o[0],i),this.trigger("segmentpushed",o))},pushToPlayback:function(e,t,n,i,r){if(Array.isArray(t)){if(!n.alternates||!n.alternates.length||t.length!==n.alternates.length)return this.log.error("[pushToPlayback] Mismatch between audioBuffers and alternates.",arguments),void this.notifyError(98,Array.prototype.slice.call(arguments));this.pushAlternatesToPlayback(e,t,n.alternates,i,r)}else this.pushAlternatesToPlayback(e,[t],[n],i,r)},onAudioSegmentEnded:function(e){if(0===e.data.altIndex){var t=e.data.index===this.playingSegments.length-1;this.currentSegmentIndex=e.data.index+1,this.trigger("segmentend"),t&&(this.trigger("ended"),this.pause())}e.off("ended",this.onAudioSegmentEnded),e.dispose()},onContextNotProgress:function(e){this.trigger("contextnotprogress",e)},onAndroidTick:function(){this.playSample()},onContextStateChange:function(){if(Ys&&this.playSample(),this._context&&this._context.state)if(this.log.info("[onContextStateChange] AudioContext state:",this._context.state),"suspended"===this._context.state||"interrupted"===this._context.state||"closed"===this._context.state)this.trigger("pause");else if("running"===this._context.state){this.trigger("playing");const e=this._context.currentTime,t=this._context;setTimeout((()=>{t===this._context&&"running"===t.state&&t.currentTime===e&&(this.log.info("[onContextStateChange] AudioContext currentTime not progressing:",e),this._context.dispatchEvent(new Event("contextnotprogress")))}),this.getSetting("contextRunningAssuranceTimeoutMs"))}},addAudioContextListeners:function(){this._context&&this._context.on&&this._context.on("contextnotprogress",this.onContextNotProgress),this._context&&this._context.addEventListener&&(this._context.addEventListener("statechange",this.onContextStateChange),this._context.addEventListener("contextnotprogress",this.onContextNotProgress))},removeAudioContextListeners:function(){this._context&&this._context.off&&this._context.off("contextnotprogress",this.onContextNotProgress),this._context&&this._context.removeEventListener&&(this._context.removeEventListener("statechange",this.onContextStateChange),this._context.removeEventListener("contextnotprogress",this.onContextNotProgress))},addDocumentListeners:function(){document.addEventListener("touchend",this.unlockAudioContext,!0),document.addEventListener("click",this.unlockAudioContext,!0),document.addEventListener("keydown",this.unlockAudioContext,!0)},removeDocumentListeners:function(){document.removeEventListener("touchend",this.unlockAudioContext,!0),document.removeEventListener("click",this.unlockAudioContext,!0),document.removeEventListener("keydown",this.unlockAudioContext,!0)},doPlayingSegmentsReset:function(){this.playingSegments.forEach(function(e){e.forEach(function(e){e.off("ended",this.onAudioSegmentEnded),e.dispose()}.bind(this))}.bind(this)),this.playingSegments.length=0,this.mutedMode.reset(),this.offset=NaN,this.currentSegmentIndex=0,this.totalDuration=0,this.presentationTime&&this.presentationTime.resetPlayback()},reset:function(){return S().then(this.doPlayingSegmentsReset).then(function(){return this.mutedMode.isEnabled||!this.isUnlocked?S():this.shouldCreateNewContextOnReset?this.initAudioContext():this._context.suspend()}.bind(this)).then(this.disposeOfAllWebAudioTracks).then(function(){this.trigger("reset")}.bind(this))},append:function(e,t,n,i,r){var o=this,s=arguments;return S().then((function(){return S.promise((function(n,i){if(!e||!t||!t.url)return o.log.error("[append] No segId or no representation given.",s),o.notifyError(99,Array.prototype.slice.call(s)),void i(new Error("[append] No segId or no representation given."));n()}))})).then(this.decodeAudioData.bind(this,n)).then((function(n){o.pushToPlayback(e,n,t,i,r)}))},appendSilentNode:function(e,t,n,i){return this.pushToPlayback(e,null,t,n,i)},muteFade:function(e){if(e.muted)return Ws.stop(e),e.muted=!0,void(e.volume=1);e.volume=1,e.muted=!1,Ws.to(e,this.getSetting("fadeOptions.duration",0),{volume:0},ki.extend({},this.getSetting("fadeOptions"),{onComplete:function(){e.muted=!0,e.volume=1}}))},unmuteFade:function(e){if(!e.muted)return Ws.stop(e),e.muted=!1,void(e.volume=1);e.volume=0,e.muted=!1,Ws.to(e,this.getSetting("fadeOptions.duration",0),{volume:1},this.getSetting("fadeOptions"))},play:function(){return this.isUnlocked?this._context.resume():this.getSetting("mutedAutoplayEnabled")?this.mutedMode.play():this.unlockedDefer.promise.then(this._context.resume.bind(this._context))},pause:function(){return this._context?this.mutedMode.isEnabled?this.mutedMode.pause():this._context.suspend():S()},currentTime:function(){return this.mutedMode.isEnabled?this.mutedMode.getCurrentTime():this.presentationTime?this.presentationTime.getPresentationTime():0},getVolume:function(){return this.currentVolume},setVolume:function(e){if("number"!=typeof e||isNaN(e))this.log.warn("Bad volume argument, ignoring.",e);else{if(e<0||e>1){var t=e<0?0:1;this.log.warn("Volume value out of range [0, 1]. Changing to "+t),e=t}this.currentVolume!==e&&(this.currentVolume=e,this.isMuted||this.gain&&(this.gain.gain.value=this.currentVolume),this.trigger("volumechange"))}},getMuted:function(){return this.isMuted},setMuted:function(e){this.isMuted!==(e=!!e)&&(this.isMuted=e,this.isMuted?this.gain&&(this.gain.gain.value=0):this.gain&&(this.gain.gain.value=this.currentVolume),this.trigger("volumechange"))},getPaused:function(){return this.mutedMode.isEnabled?this.mutedMode.getPaused():!this._context||"suspended"===this._context.state||"interrupted"===this._context.state},getPlaybackRate:function(){return this.presentationTime?this.presentationTime.getPlaybackRate():1},setPlaybackRate:function(e){if(this.presentationTime){this.mutedMode&&this.mutedMode.setPlaybackRate(e);var t=this.playingSegments&&this.playingSegments[this.currentSegmentIndex]&&this.playingSegments[this.currentSegmentIndex][0];if(t){var n=this.getCurrentSegmentTime(),i=t.duration-n;this.offset=this.getContextCurrentTime()+i/e,this.presentationTime.setPlaybackRate(e);for(var r=this.currentSegmentIndex;r<this.playingSegments.length;r++){var o=this.playingSegments[r];o.forEach((function(t){r!==this.currentSegmentIndex?(t.stop(),t.playbackRate=e,t.play(this.offset,0),t.offset=this.offset):t.playbackRate=e}),this),o[0]&&r>this.currentSegmentIndex&&(this.offset+=o[0].duration/e)}}else this.presentationTime.setPlaybackRate(e)}},getIsReadyPromise:function(){return this.getSetting("mutedAutoplayEnabled")?S():this.unlockedDefer.promise},switchFromMutedModeToAudioContext:function(){if(this.mutedMode.isEnabled&&this.isUnlocked){this.mutedMode.updateCurrentSegmentIndex();var e=this.mutedMode.getPaused(),t=this.mutedMode.getCurrentSegmentIndex(),n=this.mutedMode.getCurrentSegmentTime(),i=this.mutedMode.getCurrentTime();this.mutedMode.disable(),this.offset=this.getContextCurrentTime(),this.playingSegments.forEach((function(e,i){e.forEach((function(e){e.stop(),i>=t&&(e.play(this.offset,i===t?n:0),e.offset=i===t?this.offset-n:this.offset)}),this),i>=t&&e[0]&&(this.offset+=(e[0].duration-(i===t?n:0))/this.getPlaybackRate())}),this),this.currentSegmentIndex=t,this.presentationTime&&this.presentationTime.resetPlayback(i),e?this.pause():this.play()}},getCurrentSegmentIndex:function(){return this.mutedMode.isEnabled?this.mutedMode.getCurrentSegmentIndex():this.currentSegmentIndex},getCurrentSegmentTime:function(){if(this.mutedMode.isEnabled)return this.mutedMode.getCurrentSegmentTime();if(!this.playingSegments[this.currentSegmentIndex]||!this.presentationTime)return 0;var e=this.playingSegments[this.currentSegmentIndex][0].presentationOffset;return this.presentationTime.getPresentationTime()-e},onMutedModeSegmentEnd:function(){this.trigger("segmentend")},onMutedModeEnded:function(){this.trigger("ended")},ctor:function(e){this.isMuted=!!this.getSetting("muted"),this.initAudioContext();var t={};Object.defineProperty(t,"currentTime",{get:function(){return this.getContextCurrentTime()}.bind(this)}),this.presentationTime=new Is(this.options,t),this.defineProperty("context",(function(){return this._context})),this.defineProperty("gain",(function(){return this._gain})),this.defineProperty("isUnlocked",(function(){return!!this.unlockedDefer&&"fulfilled"===this.unlockedDefer.promise.inspect().state})),"ios"===Hs&&(this.getContextCurrentTime=this.getContextCurrentTimeiOS),this.mutedMode=new As(this.options,e),this.mutedMode.on("segmentend",this.onMutedModeSegmentEnd),this.mutedMode.on("ended",this.onMutedModeEnded),this.log.info("[ctor] Muted autoplay is "+(this.getSetting("mutedAutoplayEnabled")?"ENABLED":"DISABLED")),this.getSetting("forceAudioLocked")||this.unlockAudioContext(),Ys&&Zr.start(this.onAndroidTick,1e3*this.getSetting("androidPlaySampleInterval")),this.envSupportsConcurrentDecode="firefox"!==Gs&&-1===Gs.indexOf("safari"),this.log.info(this.envSupportsConcurrentDecode?"Env supports concurrent decode, decoding in parallel.":"Env does not support concurrent decode, decoding in series."),this.shouldCreateNewContextOnReset=!1,this.log.info(this.shouldCreateNewContextOnReset?"Will create a new AudioContext on reset (shouldCreateNewContextOnReset === true)":"Will re-use same AudioContext instance (shouldCreateNewContextOnReset === false)")},dispose:function(){if(this._super.apply(this,arguments),Ys&&Zr.stop(this.onAndroidTick),this.log.info("Stopping "+(this.playingSegments&&this.playingSegments.length||0)+" playingSegments"),this.playingSegments.forEach(function(e){e.forEach(function(e){e.off("ended",this.onAudioSegmentEnded),e.dispose()}.bind(this))}.bind(this)),this.disposeOfAllWebAudioTracks(),this._context&&"function"==typeof this._context.close){this.log.info("Closing context.");try{this._context.close().then(function(){this.log.info("Context successfully closed")}.bind(this)).catch(function(e){this.log.warn("Async error closing context:",e)}.bind(this))}catch(e){this.log.warn("Error closing context:",e)}this._context=null}this.presentationTime&&"function"==typeof this.presentationTime.dispose&&this.presentationTime.dispose(),this.presentationTime=null,this.log.info("Clearing playingSegments"),this.playingSegments.length=0,this.removeDocumentListeners(),this.mutedMode&&(this.mutedMode.off("segmentend",this.onMutedModeSegmentEnd),this.mutedMode.off("ended",this.onMutedModeEnded),this.mutedMode.disable(),this.mutedMode.dispose())}}),Xs=hs.extend({name:"WebAudioVideo",logLevel:"warn",defaults:{},excludeFuncFromAutoDebug:["currentTime","getCurrentSegmentIndex","getCurrentSegmentTime","getPlaybackRate","setPlaybackRate"],api:null,events:null,triggeredLoadedData:!1,isEnded:!1,notifyPause:function(){this.trigger(this.events.pause)},notifyPlay:function(){this.trigger(this.events.play)},notifyPlaying:function(){this.manager&&!this.manager.getPaused()&&this.trigger(this.events.playing)},onManagerEnded:function(){this.api.exports.isWithinEndedDelta?(this.trigger(this.events.ended),this.isEnded=!0):this.trigger(this.events.waiting)},onManagerSegmentPushed:function(){this.isEnded=!1,this.triggeredLoadedData||(this.triggeredLoadedData=!0,this.trigger(this.events.loadeddata))},onManagerReset:function(){this.isEnded=!1,this.triggeredLoadedData=!1},onManagerVolumeChange:function(){this.trigger(this.events.volumechange)},onManagerAudioLockedChange:function(){this.trigger(this.events.audiolockedchange)},onManagerPlaying:function(){this.notifyPlaying()},onManagerPause:function(){this.notifyPause()},play:function(e){return this.isEnded?S():e&&e.wait?(!this.manager||this.getPaused()?S():this.manager.pause()).then(function(){return this.log.info("Returning unlocked promise for play with wait."),this.manager.getIsReadyPromise()}.bind(this)):(this.notifyPlay(),this.manager?this.manager.play().then(this.notifyPlaying).then(function(){this.log.info("Resolving play.")}.bind(this)):S())},pause:function(){return this.manager?this.manager.pause().then(this.notifyPause):S()},currentTime:function(){return this.manager&&this.manager.currentTime()},getVolume:function(){return this.manager&&this.manager.getVolume()},setVolume:function(e){return this.manager&&this.manager.setVolume(e)},getMuted:function(){return this.manager&&this.manager.getMuted()},setMuted:function(e){return this.manager&&this.manager.setMuted(e)},getPaused:function(){return this.manager&&this.manager.getPaused()},getVideoWidth:function(){},getVideoHeight:function(){},getPlaybackRate:function(){return this.manager?this.manager.getPlaybackRate():1},setPlaybackRate:function(e){this.manager&&this.manager.setPlaybackRate(e)},getIsAudioLocked:function(){return!this.manager||!this.manager.isUnlocked},getCurrentSegmentIndex:function(){return this.manager&&this.manager.getCurrentSegmentIndex()||0},getCurrentSegmentTime:function(){return this.manager&&this.manager.getCurrentSegmentTime()||0},onManagerSegmentEnd:function(){this.trigger("segmentend",this.api.exports.isWithinEndedDelta)},ctor:function(e,t,n){this.manager=n,this._super.apply(this,arguments),this.manager.on("ended",this.onManagerEnded),this.manager.on("segmentpushed",this.onManagerSegmentPushed),this.manager.on("reset",this.onManagerReset),this.manager.on("volumechange",this.onManagerVolumeChange),this.manager.on("segmentend",this.onManagerSegmentEnd),this.manager.on("audiolockedchange",this.onManagerAudioLockedChange),this.manager.on("playing",this.onManagerPlaying),this.manager.on("pause",this.onManagerPause)},dispose:function(){this._super.apply(this,arguments),this.manager&&(this.manager.off("ended",this.onManagerEnded),this.manager.off("segmentpushed",this.onManagerSegmentPushed),this.manager.off("reset",this.onManagerReset),this.manager.off("volumechange",this.onManagerVolumeChange),this.manager.off("segmentend",this.onManagerSegmentEnd),this.manager.off("audiolockedchange",this.onManagerAudioLockedChange),this.manager.off("playing",this.onManagerPlaying),this.manager.off("pause",this.onManagerPause)),this.manager=null}}),Qs=me.createLogger("WorkerMsgChannel","warn");function Zs(e){return e&&e instanceof ArrayBuffer?e.slice(0,e.byteLength):e}var Js=function(e,t,n){n=(n=n||{}).WorkerMsgChannel||n,this.worker=e,this.env=t;var i=t&&t.browser&&t.browser.name&&t.browser.name.toLowerCase()||"",r=t&&t.engine&&t.engine.name&&t.engine.name.toLowerCase()||"";this._shouldSerializeData=i.indexOf("chrome")>=0||i.indexOf("firefox")>=0||i.indexOf("opera")>=0||r.indexOf("blink")>=0||this.worker.isPseudoWorker,this._shouldUseTransferList="boolean"!=typeof n.transferEnabled||n.transferEnabled,Qs.info("Created WorkerMsgChannel with following configuration:",{_shouldUseTransferList:this._shouldUseTransferList,_shouldSerializeData:this._shouldSerializeData}),this._onWorkerMsg=this._onWorkerMsg.bind(this),this.worker.addEventListener("message",this._onWorkerMsg,!1)};(Js.prototype=Object.create(Ti.prototype)).constructor=Js,Js.prototype._onWorkerMsg=function(e){var t=e&&e.data;if(t&&t.name&&t.meta){var n=t.name,i=t.meta,r=t.data&&"string"==typeof t.data&&i.isJsonData?JSON.parse(t.data):t.data;Qs.info("Received message: ["+n+"]",r||"",i.isJsonData?"[JSON]":"[RAW]"),this.trigger("message",n,r),this.trigger(n,r)}else Qs.error("Invalid worker message received:",t)},Js.prototype.post=function(e,t,n){var i;this._shouldUseTransferList&&n&&"string"==typeof n&&t&&t[n]&&(Array.isArray(t[n])?(t[n]=t[n].map(Zs),i=t[n]):(t[n]=Zs(t[n]),i=[t[n]]));var r=this._shouldSerializeData&&t&&"object"==typeof t&&!n;r&&(t=JSON.stringify(t)),Qs.info("[post] Posting message '"+e+"' with data:",t),this.worker.postMessage({name:e,meta:{isJsonData:r},data:t},this._shouldUseTransferList&&i||void 0)},Js.prototype.dispose=function(){this.worker.removeEventListener("message",this._onWorkerMsg)};var ea={dispose:vi("dispose")},ta=mi({},ea),na=mi({},ea);let ia=me.createLogger("NodeHandler","warn");const ra={_pauseNodeHandling:function(e,t){(t=t||this.segmentStore.getByNodeId(e))?(ia.debug(`[${e}] [_pauseNodeHandling] Pausing load`),this._removeSegLoaderListeners(e,t),this.trigger("handler.pausing",e),t.pause()):ia.warn(`[${e}] [_pauseNodeHandling] No segment loader found`)},_isNodeHandled:function(e){return!!this.workerState.isNullNode(e)||this.segmentStore.getByNodeId(e).completed},_doHandleNode:function(e){let t=this.segmentStore.getByNodeId(e);t.completed?this._onSegLoaderComplete(e,t):t.loadStarted?t.paused?(ia.debug("["+e+"] Resuming load"),this.trigger("handler.handling",e),this._addSegLoaderListeners(e,t),t.resume()):(ia.debug("["+e+"] Load already started, adding listeners"),this._addSegLoaderListeners(e,t)):(ia.debug("["+e+"] Starting load"),this.trigger("handler.handling",e),this._addSegLoaderListeners(e,t),t.load())},_onSegLoaderComplete:function(e,t){ia.debug("["+e+"] Load complete"),this._removeSegLoaderListeners(e,t),this.trigger("handler.complete",e)},_addSegLoaderListeners:function(e,t){t&&(t.__completeListeners=t.__completeListeners||{},t.__completeListeners[e]||(t.__completeListeners[e]=this._onSegLoaderComplete.bind(this,e,t),t.once("complete",t.__completeListeners[e])))},_removeSegLoaderListeners:function(e,t){t&&t.__completeListeners&&t.__completeListeners[e]&&(t.off("complete",t.__completeListeners[e]),delete t.__completeListeners[e])}},oa={_canHandleNode:function(e){let t=this.workerState.nodeIdToSegment(e);return!this.isLinkIVDSegment(t)},isLinkIVDSegment:function(e){return e&&e.metadata&&e.id&&e.version&&(!e.representations||!e.representations.length)}};var sa,aa,la,ca,ua=me.createLogger("BaseManager","warn"),da=function(e){for(var t in this.segmentStore=e.segmentStore,this.workerState=e.workerState,this.currentlyHandling={},this)"function"==typeof this[t]&&(this[t]=this[t].bind(this));this.addWorkerStateListeners(),this.addSegmentStoreListeners(),this.on("handler.complete",this.onHandlerComplete)};function ha(){da.apply(this,arguments),this.workerState.on("workerstate.appendingIndexIncremented",this.onAppendingIndexIncremented),this.workerState.on("workerstate.loadNode",this.onLoadNodeRequest)}da.prototype=Object.create(Ti.prototype),Object.assign(da.prototype,oa),da.prototype.constructor=da,da.prototype._pauseNodeHandling=function(e,t){},da.prototype._isNodeHandled=function(e){},da.prototype._doHandleNode=function(e){},da.prototype._dispose=function(){},da.prototype.onHandlerComplete=function(e){if(this.currentlyHandling[e])if(delete this.currentlyHandling[e],this.isPlaylistHandled()){var t=this.getUnhandledDescendantsOfFirstOrder(e);for(var n in!Object.keys(t).length&&this.workerState.playlist.length&&(t=this.getUnhandledDescendantsOfFirstOrder(this.workerState.playlist[this.workerState.playlist.length-1])),t)this.handleNode(n)}else this.handleNextPlaylistNode();else Object.keys(this.currentlyHandling).length||this.restartHandling()},da.prototype.isNodeHandled=function(e){return this._isNodeHandled(e)},da.prototype.canHandleNode=function(e){return this._canHandleNode(e)},da.prototype.handleNode=function(e){if(this.canHandleNode(e))return this.currentlyHandling[e]=!0,this._doHandleNode(e)},da.prototype.nextUnhandledPlaylistNode=function(){for(var e=null,t=this.workerState.appendingIndex;t<this.workerState.playlist.length;t++)if(!this.isNodeHandled(this.workerState.playlist[t])){e=this.workerState.playlist[t];break}return e},da.prototype.isPlaylistHandled=function(){return null===this.nextUnhandledPlaylistNode()},da.prototype.handleNextPlaylistNode=function(){var e=this.nextUnhandledPlaylistNode();return null!==e&&(this.handleNode(e),!0)},da.prototype.getUnhandledDescendantsOfFirstOrder=function(e){var t={},n={},i=function(e){for(var r,o=this.workerState.nodeIdToChildren(e),s=0;s<o.length;s++)if(!n[r=o[s].id]){if(n[r]=!0,!this.workerState.hasNode(r)){ua.warn("Node with id '"+r+"' was not found (prefetch of '"+e+"') - did you add it to the repository?");continue}this.isNodeHandled(r)?i(r):t[r]=!0}}.bind(this);return i(e),t},da.prototype.pauseNodes=function(e){for(let t in e)this._pauseNodeHandling(t)},da.prototype.handleNodes=function(e){Object.keys(e).forEach(this.handleNode)},da.prototype.resetAllCurrentlyHandling=function(){this.isPlaylistHandled()?this.currentlyHandling=this.workerState.playlist.length?this.getUnhandledDescendantsOfFirstOrder(this.workerState.playlist[this.workerState.playlist.length-1]):{}:(this.currentlyHandling={},this.currentlyHandling[this.nextUnhandledPlaylistNode()]=!0)},da.prototype.restartHandling=function(){ua.debug("-> restartHandling()"),this.restartPending=!1;var e,t=ki.extend({},this.currentlyHandling),n={},i={};for(e in this.resetAllCurrentlyHandling(),this.currentlyHandling)t[e]&&this._isNodeHandled(e)||(i[e]=!0);for(e in t)this.currentlyHandling[e]||(n[e]=!0);ua.info("-> restartHandling() - prevHandling",t),ua.info("-> restartHandling() - currHandling",this.currentlyHandling),ua.info("-> restartHandling() - toPause",n),ua.info("-> restartHandling() - toHandle",i),this.pauseNodes(n),this.handleNodes(i)},da.prototype.onPlaylistAppend=function(){this.restartHandling()},da.prototype.onPlaylistReset=function(){ua.info("-> onPlaylistReset() - Setting restartPending flag"),this.restartPending=!0},da.prototype.onRepoUpdated=function(){this.restartHandling()},da.prototype.onPreRepoUpdate=function(){this.restartPending&&(ua.info("-> onPreRepoUpdate() - restartPending flag is set, restarting handling"),this.restartHandling())},da.prototype.onSegmentLoaderRemoved=function(e){e&&e.nodeIds&&Object.keys(e.nodeIds).forEach(function(t){this.currentlyHandling[t]&&(ua.info("Segment loader was forcibly removed, no longer handling node ["+t+"]"),this._pauseNodeHandling(t,e),delete this.currentlyHandling[t])}.bind(this))},da.prototype.onWorkerStateDispose=function(){this.removeWorkerStateListeners()},da.prototype.addSegmentStoreListeners=function(){this.segmentStore&&this.segmentStore.on("segmentloader.removed",this.onSegmentLoaderRemoved)},da.prototype.removeSegmentStoreListeners=function(){this.segmentStore&&this.segmentStore.off("segmentloader.removed",this.onSegmentLoaderRemoved)},da.prototype.addWorkerStateListeners=function(){this.workerState&&(this.workerState.on("workerstate.repo.updated",this.onRepoUpdated),this.workerState.on("workerstate.repo.preupdate",this.onPreRepoUpdate),this.workerState.on("workerstate.playlist.reset",this.onPlaylistReset),this.workerState.on("workerstate.playlist.append",this.onPlaylistAppend),this.workerState.on("workerstate.dispose",this.onWorkerStateDispose))},da.prototype.removeWorkerStateListeners=function(){this.workerState&&(this.workerState.off("workerstate.repo.updated",this.onRepoUpdated),this.workerState.off("workerstate.repo.preupdate",this.onPreRepoUpdate),this.workerState.off("workerstate.playlist.reset",this.onPlaylistReset),this.workerState.off("workerstate.playlist.append",this.onPlaylistAppend),this.workerState.off("workerstate.dispose",this.onWorkerStateDispose))},da.prototype.dispose=function(){this._dispose(),this.removeWorkerStateListeners(),this.removeSegmentStoreListeners(),this.off("handler.complete",this.onHandlerComplete)},ha.prototype=Object.create(da.prototype),Object.assign(ha.prototype,ra),ha.prototype.constructor=ha,ha.prototype._dispose=function(){this.workerState&&(this.workerState.off("workerstate.appendingIndexIncremented",this.onAppendingIndexIncremented),this.workerState.off("workerstate.loadNode",this.onLoadNodeRequest))},ha.prototype.onAppendingIndexIncremented=function(){this.restartHandling()},ha.prototype.onLoadNodeRequest=function(e){this._doHandleNode(e)};var pa=function(){if(ca)return la;ca=1;const e=function(){if(aa)return sa;aa=1;class e{constructor(e){this.value=e,this.next=void 0}}class t{constructor(){this.clear()}enqueue(t){const n=new e(t);this._head?(this._tail.next=n,this._tail=n):(this._head=n,this._tail=n),this._size++}dequeue(){const e=this._head;if(e)return this._head=this._head.next,this._size--,e.value}clear(){this._head=void 0,this._tail=void 0,this._size=0}get size(){return this._size}*[Symbol.iterator](){let e=this._head;for(;e;)yield e.value,e=e.next}}return sa=t}();return la=t=>{if(!Number.isInteger(t)&&t!==1/0||!(t>0))throw new TypeError("Expected `concurrency` to be a number from 1 and up");const n=new e;let i=0;const r=async(e,t,...r)=>{i++;const o=(async()=>e(...r))();t(o);try{await o}catch{}i--,n.size>0&&n.dequeue()()},o=(e,...o)=>new Promise((s=>{((e,o,...s)=>{n.enqueue(r.bind(null,e,o,...s)),(async()=>{await Promise.resolve(),i<t&&n.size>0&&n.dequeue()()})()})(e,s,...o)}));return Object.defineProperties(o,{activeCount:{get:()=>i},pendingCount:{get:()=>n.size},clearQueue:{value:()=>{n.clear()}}}),o},la}(),fa=r(pa);const ga=me.createLogger("PriorityLoadingManager","warn");function ma(e){var t,n,i;ga.debug("PriorityLoadingManager created with settings:",e),this.segmentStore=e.segmentStore,this.workerState=e.workerState,this.activeNodes={},this.sortedNodes=[],this.restartPending=!1,this.maxLoadingLimit=(null===(t=e.priorityLoadingManager)||void 0===t?void 0:t.maxLoadingLimit)||10,this.levelMultiplier=(null===(n=e.priorityLoadingManager)||void 0===n?void 0:n.levelMultiplier)||1,this.priorityMultiplier=(null===(i=e.priorityLoadingManager)||void 0===i?void 0:i.priorityMultiplier)||.3;for(let e in this)"function"==typeof this[e]&&(this[e]=this[e].bind(this));this.limit=fa(this.maxLoadingLimit),this.addWorkerStateListeners(),this.addSegmentStoreListeners(),this.on("handler.complete",this.onHandlerComplete)}(ma.prototype=Object.create(Ti.prototype)).constructor=ma,Object.assign(ma.prototype,ra,oa),ma.prototype.onHandlerComplete=async function(e){ga.debug(`-> onHandlerComplete(${e})`),this.activeNodes[e]?(this.activeNodes[e].resolve(),delete this.activeNodes[e],this.isPlaylistHandled()?0===this.limit.pendingCount&&0===this.limit.activeCount&&this.restartHandling():await this.handleNextPlaylistNode()):Object.keys(this.activeNodes).length||await this.restartHandling()},ma.prototype.isNodeHandled=function(e){return this._isNodeHandled(e)},ma.prototype.prioritizeNodes=function(e){let t={},n={[e]:!0};const i=[{nodeId:e,level:0,priority:1}];for(;i.length>0;){const{nodeId:r,level:o,priority:s}=i.shift();this.workerState.nodeIdToChildren(r).forEach((r=>{if(!n[r.id]&&!(r.id in this.activeNodes)){if(n[r.id]=!0,!this.workerState.hasNode(r.id))return void ga.warn(`Node with id ${r.id} was not found (prefetch of ${e} ) - did you add it to the repository?`);this.isNodeHandled(r.id)||(t[r.id]={priority:Math.max(r.priority,s),level:o+1}),i.push({nodeId:r.id,level:o+1,priority:Math.max(r.priority,s)})}}))}this.sortedNodes=((e,t=1,n=1)=>Object.entries(e).map((([e,i])=>({key:e,score:i.level*t+i.priority*n,...i}))).sort(((e,t)=>e.score-t.score)))(t,this.levelMultiplier,this.priorityMultiplier).map((e=>e.key))},ma.prototype.pauseNodes=function(e){e.forEach((([e,{resolve:t}])=>{t(),this._pauseNodeHandling(e),delete this.activeNodes[e]}))},ma.prototype.handleNode=function(e){return new Promise((t=>{if(!this._canHandleNode(e))return t();this.activeNodes[e]={resolve:t},ga.info(`Handling node [ ${e} ]`),this._doHandleNode(e)}))},ma.prototype.handleNodes=async function(e){const t=e.map((e=>this.limit((()=>this.handleNode(e)))));await Promise.all(t),ga.info("-> handleNodes() - All nodes handled")},ma.prototype.nextUnhandledPlaylistNode=function(){let e=null;for(let t=this.workerState.appendingIndex;t<this.workerState.playlist.length;t++)if(!this.isNodeHandled(this.workerState.playlist[t])){e=this.workerState.playlist[t];break}return e},ma.prototype.isPlaylistHandled=function(){return null===this.nextUnhandledPlaylistNode()},ma.prototype.handleNextPlaylistNode=async function(){let e=this.nextUnhandledPlaylistNode();null!==e&&await this.handleNode(e)},ma.prototype.getNextNodesToHandle=function(){const e={};return this.isPlaylistHandled()?this.workerState.playlist.length&&(this.prioritizeNodes(this.workerState.playlist[this.workerState.playlist.length-1]),this.sortedNodes.forEach((t=>{e[t]=!0}))):e[this.nextUnhandledPlaylistNode()]=!0,e},ma.prototype.restartHandling=async function(){ga.debug("-> restartHandling()"),this.restartPending=!1;const e=Object.keys(this.getNextNodesToHandle());if(!e.some((e=>!this.activeNodes[e])))return;const t=e.slice(0,this.maxLoadingLimit).reduce(((e,t)=>(e[t]=!0,e)),{}),n=Object.entries(this.activeNodes).filter((([e])=>!t[e])),i=Object.keys(this.activeNodes).filter((e=>t[e])),r=e.filter((e=>!(e in i)));ga.info("-> restartHandling() - prevHandling",Object.keys(this.activeNodes)),ga.info("-> restartHandling() - toPause",n.map((([e])=>e))),ga.info("-> restartHandling() - toKeep",i),ga.info("-> restartHandling() - toHandle",r),this.limit.clearQueue(),this.pauseNodes(n),await this.handleNodes(r)},ma.prototype.onRepoUpdated=async function(){await this.restartHandling()},ma.prototype.onPlaylistReset=function(){ga.info("-> onPlaylistReset() - Setting restartPending flag"),this.restartPending=!0},ma.prototype.onRepoUpdated=async function(){await this.restartHandling()},ma.prototype.onPreRepoUpdate=async function(){this.restartPending&&(ga.info("-> onPreRepoUpdate() - restartPending flag is set, restarting handling"),await this.restartHandling())},ma.prototype.onPlaylistAppend=async function(){await this.restartHandling()},ma.prototype.onWorkerStateDispose=function(){this.removeWorkerStateListeners()},ma.prototype.addWorkerStateListeners=function(){this.workerState&&(this.workerState.on("workerstate.repo.updated",this.onRepoUpdated),this.workerState.on("workerstate.repo.preupdate",this.onPreRepoUpdate),this.workerState.on("workerstate.playlist.reset",this.onPlaylistReset),this.workerState.on("workerstate.playlist.append",this.onPlaylistAppend),this.workerState.on("workerstate.dispose",this.onWorkerStateDispose))},ma.prototype.removeWorkerStateListeners=function(){this.workerState&&(this.workerState.off("workerstate.repo.updated",this.onRepoUpdated),this.workerState.off("workerstate.repo.preupdate",this.onPreRepoUpdate),this.workerState.off("workerstate.playlist.reset",this.onPlaylistReset),this.workerState.off("workerstate.playlist.append",this.onPlaylistAppend),this.workerState.off("workerstate.dispose",this.onWorkerStateDispose))},ma.prototype.onSegmentLoaderRemoved=function(e){e&&e.nodeIds&&Object.keys(e.nodeIds).forEach(function(t){this.activeNodes[t]&&(ga.info(`Segment loader was forcibly removed, no longer handling node ${t} ]`),this._pauseNodeHandling(t,e),this.activeNodes[t].resolve(),delete this.activeNodes[t])}.bind(this))},ma.prototype.addSegmentStoreListeners=function(){this.segmentStore&&this.segmentStore.on("segmentloader.removed",this.onSegmentLoaderRemoved)},ma.prototype.removeSegmentStoreListeners=function(){this.segmentStore&&this.segmentStore.off("segmentloader.removed",this.onSegmentLoaderRemoved)},ma.prototype._dispose=function(){this.removeWorkerStateListeners(),this.removeSegmentStoreListeners(),this.off("handler.complete",this.onHandlerComplete)},ma.prototype.dispose=function(){ga.debug("-> dispose()"),this._dispose()};var ya=function(e,t){var n=[];for(var i in e)n.push(t(i,e[i]));return function(e,t){for(var i=!0,r=0;r<n.length;r++)if(!n[r](e,t)){i=!1;break}return i}},va=function(e,t){var n=[];for(var i in e)n.push(t(i,e[i]));return function(e,t){for(var i=!1,r=0;r<n.length;r++)if(n[r](e,t)){i=!0;break}return i}},ba=function(e){var t=!!e;return function(e,n){var i=!!e.repo.nodes[n];return t||(i=!i),i}},wa=function(e){var t=!!e;return function(e,n){e.futurePlaylist||(e.futurePlaylist=e.playlist.slice(e.appendingIndex));var i=e.futurePlaylist.indexOf(n)>=0;return t||(i=!i),i}},ka=function(e,t,n,i){if(i)for(var r=0;r<t[n].prefetch.length;r++)e[t[n].prefetch[r]]||(e[t[n].prefetch[r]]=!0,ka(e,t,t[n].prefetch[r],i-1))},xa=function(e){var t=e&&e.depth,n=!(!e||!e.value);return(!t||t<=0)&&(t=1),function(e,i){e.nodesUpToDepth||(e.nodesUpToDepth={},e.playlist.length&&ka(e.nodesUpToDepth,e.repo.nodes,e.playlist[e.playlist.length-1],t));var r=!!e.nodesUpToDepth[i];return n||(r=!r),r}},Sa=function(){return!1},Ca=me.createLogger("memoryPredicateFactory","warn"),_a=function(e,t){var n;if(e&&"string"==typeof e)switch(e=e.toLowerCase()){case"inrepo":n=new ba(t);break;case"infutureplaylist":n=new wa(t);break;case"innextlevels":n=new xa(t);break;case"and":n=new ya(t,_a);break;case"or":n=new va(t,_a);break;default:Ca.warn("Unknown predicate type '"+e+"', using default predicate."),n=Sa}else if(e&&"object"==typeof e&&1===Object.keys(e).length){var i=Object.keys(e)[0];n=_a(i,e[i])}return n||(Ca.warn("Using default predicate - possible bad configuration."),n=Sa),n},Ea=me.createLogger("MemoryManager","warn");function Ta(e){var t=e.segmentStore,n=e.workerState,i=ki.getObjectProperty(e,"memory.maxmemory",25e6),r=_a(e.memory&&e.memory.logic);Ea.info("Constructed with max memory: "+(i/1e6).toFixed(2)+" MB");var o=function(e){Ea.debug("-> sweep()");const{preSweepCallback:i=(()=>{})}=e||{};var o={playlist:n.playlist,repo:n.repo,appendingIndex:n.appendingIndex},s=function(){var e={};for(var i in n.repo.nodes){var r=n.nodeIdToSegmentId(i);t.segMap[r]&&t.segMap[r].loadStarted&&(e[i]=!0)}return e}(),a={},l={},c={};for(var u in s){var d=n.nodeIdToSegmentId(u);r(o,u)&&!c[d]?(a[d]=!0,l[u]=!0):(c[d]=!0,a[d]&&delete a[d])}i({toSweep:a=Object.keys(a),notToSweep:c=Object.keys(c)}),a.length&&(Ea.info("Disposing of: ["+Object.keys(l).join(", ")+"]"),t.destroy.apply(t,a),Ea.info("Post sweep memory: "+t.bytesTotal.toLocaleString()+" bytes."))};function s(e){i&&i>0&&e>=i&&setTimeout(o,0)}this.forceSweep=function(){Ea.info("[forceSweep] Forcing sweep");let e={};return o({preSweepCallback:({toSweep:n,notToSweep:i})=>{e.urlsToKeep=i.map((e=>t.getBySegId(e))).filter((e=>!!e)).map((e=>e.url)),e.urlsToDelete=n.map((e=>t.getBySegId(e))).filter((e=>!!e)).map((e=>e.url))}}),e},this.dispose=function(){},t.on("memory.increased",(function(e){Ea.info("memory.increased: "+e.toLocaleString()+" bytes."),s(e)})),n.on("workerstate.appendingIndexIncremented",(function(){var e=t.bytesTotal;Ea.info("Appending index was incremented. Total memory used: "+e.toLocaleString()+" bytes."),s(e)}))}function Pa(){this.appendNode=function(e){},this.updateRepo=function(e){},this.reset=function(){},this.dispose=function(){}}var Ia=me.createLogger("controllerFactory","warn"),Aa=function(e){var t;return null!=e&&null!==(t=e.priorityLoadingManager)&&void 0!==t&&t.enabled?(Ia.info("Creating priority loading manager."),new ma(e)):(Ia.info("Creating loading manager."),new ha(e))},Oa=function(e){var t,n=e&&e.memory&&e.memory.type;return"constrained"===(n="string"==typeof n?n.toLowerCase():"noop")?(Ia.info("Creating constrained memory manager."),t=new Ta(e)):(Ia.info("Creating NOOP memory manager."),t=new Pa),t},La=me.createLogger("RepoSyncHelper","warn"),Na=function(e,t,n){this.repo=e,this.transforms={nodes:t,segments:n},this._ignoreEvents=!1,this._onSegmentAdded=this._onSegmentAdded.bind(this),this._onSegmentRemoved=this._onSegmentRemoved.bind(this),this._onSegmentUpdated=this._onSegmentUpdated.bind(this),this._onNodeAdded=this._onNodeAdded.bind(this),this._onNodeRemoved=this._onNodeRemoved.bind(this),this._onNodeUpdated=this._onNodeUpdated.bind(this),this._onPrefetchAdded=this._onPrefetchAdded.bind(this),this._onPrefetchRemoved=this._onPrefetchRemoved.bind(this),this._addRepoListeners(),this._diff=this._getEmptyValue()};(Na.prototype=Object.create(Ti.prototype)).constructor=Na,Na.prototype._addRepoListeners=function(){this.repo&&(this.repo.on("segment.added",this._onSegmentAdded),this.repo.on("segment.removed",this._onSegmentRemoved),this.repo.on("segment.updated",this._onSegmentUpdated),this.repo.on("node.added",this._onNodeAdded),this.repo.on("node.removed",this._onNodeRemoved),this.repo.on("node.updated",this._onNodeUpdated),this.repo.on("prefetch.added",this._onPrefetchAdded),this.repo.on("prefetch.removed",this._onPrefetchRemoved))},Na.prototype._removeRepoListeners=function(){this.repo&&(this.repo.off("segment.added",this._onSegmentAdded),this.repo.off("segment.removed",this._onSegmentRemoved),this.repo.off("segment.updated",this._onSegmentUpdated),this.repo.off("node.added",this._onNodeAdded),this.repo.off("node.removed",this._onNodeRemoved),this.repo.off("node.updated",this._onNodeUpdated),this.repo.off("prefetch.added",this._onPrefetchAdded),this.repo.off("prefetch.removed",this._onPrefetchRemoved))},Na.prototype._getEmptyValue=function(){return{segments:{},nodes:{}}},Na.prototype._addUpdateSegOrNode=function(e,t){ki.arrayify(e).forEach(function(e){this._diff[t][e.id]="function"==typeof this.transforms[t]?this.transforms[t].call(null,e):e}.bind(this))},Na.prototype._removeSegOrNode=function(e,t){ki.arrayify(e).forEach(function(e){this._diff[t][e.id]=null}.bind(this))},Na.prototype._notifyRepoChange=function(){this.trigger("repochange")},Na.prototype._onSegmentAdded=function(e){this._ignoreEvents||(this._addUpdateSegOrNode(e,"segments"),this._notifyRepoChange())},Na.prototype._onSegmentUpdated=function(e){this._ignoreEvents||(this._addUpdateSegOrNode(e,"segments"),this._notifyRepoChange())},Na.prototype._onSegmentRemoved=function(e){this._ignoreEvents||(this._removeSegOrNode(e,"segments"),this._notifyRepoChange())},Na.prototype._onNodeAdded=function(e){this._ignoreEvents||(this._addUpdateSegOrNode(e,"nodes"),this._notifyRepoChange())},Na.prototype._onNodeUpdated=function(e){this._ignoreEvents||(this._addUpdateSegOrNode(e,"nodes"),this._notifyRepoChange())},Na.prototype._onNodeRemoved=function(e){this._ignoreEvents||(this._removeSegOrNode(e,"nodes"),this._notifyRepoChange())},Na.prototype._onPrefetchAdded=function(e){this._ignoreEvents||(this._addUpdateSegOrNode(e,"nodes"),this._notifyRepoChange())},Na.prototype._onPrefetchRemoved=function(e){this._ignoreEvents||(this._addUpdateSegOrNode(e,"nodes"),this._notifyRepoChange())},Na.prototype.execFuncWhileIgnoringRepoChanges=function(e){if("function"==typeof e){this._ignoreEvents=!0;try{e.apply(null)}catch(e){La.error("[execFuncWhileIgnoringRepoChanges] Error caught.",e)}this._ignoreEvents=!1}},Na.prototype.flushDiff=function(){var e=this._diff;return La.info("[flushDiff] Flushing diff:",e),this._diff=this._getEmptyValue(),e},Na.prototype.getFullRepo=function(e){e||this.flushDiff();var t,n,i=this._getEmptyValue();if(!this.repo)return i;for(var r in this.repo.nodeMap)t=this.repo.nodeMap[r],i.nodes[r]="function"==typeof this.transforms.nodes?this.transforms.nodes.call(null,t):t;for(var o in this.repo.segmentMap)n=this.repo.segmentMap[o],i.segments[o]="function"==typeof this.transforms.segments?this.transforms.segments.call(null,n):n;return i},Na.prototype.dispose=function(){this._removeRepoListeners(),this.repo=null},Na.applyDiff=function(e,t,n){if(e&&e.nodes&&e.segments&&t&&t.nodes&&t.segments){for(var i in t.segments)t.segments[i]?e.segments[i]="function"==typeof n?n(e.segments[i]||{},t.segments[i]):t.segments[i]:delete e.segments[i];for(var r in t.nodes)t.nodes[r]?e.nodes[r]="function"==typeof n?n(e.nodes[r]||{},t.nodes[r]):t.nodes[r]:delete e.nodes[r]}else La.error("Invalid arguments given to applyDiff().",arguments)};var Ra=me.createLogger("WorkerState","warn"),Da=function(e){for(var t in Ra.debug("-> [constructor]"),this.repo=e.repo,this.playlist=e.playlist?e.playlist:[],this.format=e.format,this.environment=e.environment,this.nodeIdToChildrenMap={},this.appendingIndex=0,this.currBaseUrlIndex=0,this.config=e,this.bitrate=e.bitrate,this.bitrateConfig=e.bitrateConfig,this.containerResolution=e.containerResolution,this.baseUrl=e.baseUrl,this.forceBaseUrl=e.forceBaseUrl,this)"function"==typeof this[t]&&(this[t]=this[t].bind(this));this.correctRepoPrefetch()};(Da.prototype=Object.create(Ti.prototype)).constructor=Da,Da.prototype._chooseBaseUrl=function(){var e=null;return this.baseUrl&&(e=this.baseUrl[this.currBaseUrlIndex],this.currBaseUrlIndex=(this.currBaseUrlIndex+1)%this.baseUrl.length),e},Da.prototype.resolveNodeId=function(e){return e&&this.repo&&this.repo.nodes&&this.repo.nodes[e]&&this.repo.nodes[e].subnodes&&this.repo.nodes[e].subnodes.length?this.repo.nodes[e].subnodes[0]:e},Da.prototype.correctRepoPrefetch=function(){Object.keys(this.repo.nodes).forEach(function(e){var t,n=this.repo.nodes[e];n.prefetch&&n.prefetch.length&&(n.prefetch=n.prefetch.map(this.resolveNodeId)),null!=n&&null!==(t=n.prefetchObjects)&&void 0!==t&&t.length&&(n.prefetchObjects=n.prefetchObjects.map((e=>({...e,id:this.resolveNodeId(e.id)}))))}.bind(this))},Da.prototype.hasNode=function(e){return this.repo.nodes.hasOwnProperty(e)},Da.prototype.nodeIdToSegmentId=function(e){return e&&this.repo&&this.repo.nodes&&this.repo.nodes[e]?this.repo.nodes[e].segment:(Ra.error("No node with id: "+e),null)},Da.prototype.isNullNode=function(e){var t=this.nodeIdToSegment(e);return!(!t||0!==t.duration)},Da.prototype.nodeIdToSegment=function(e){var t=this.nodeIdToSegmentId(e);return t&&!this.repo.segments.hasOwnProperty(t)?(Ra.error("No segment with id: "+t),null):this.repo.segments[t]},Da.prototype.nodeIdToChildren=function(e){return this.nodeIdToChildrenMap[e]||(this.nodeIdToChildrenMap[e]=this.repo.nodes[e]&&this.repo.nodes[e].prefetch?this.repo.nodes[e].prefetchObjects:[]),this.nodeIdToChildrenMap[e]},Da.prototype.chooseRepresentation=function(e,t){var n,i;if(!e)return Ra.error("Cannot choose representation",e),null;t=t||{};var r=this.bitrateConfig&&this.bitrateConfig.bitrateMultiplier||null;r&&t.bitrateMultiplierTransform&&(r=t.bitrateMultiplierTransform(r));var o=ki.chooseRepresentation(e,{bitrate:this.bitrate,resolution:this.containerResolution,bitrateMultiplier:r,ivdStrategy:t.ivdStrategy||this.bitrateConfig.ivdStrategy||"auto",ivdResolutionFilterEnabled:null===(n=null!==(i=t.ivdResolutionFilterEnabled)&&void 0!==i?i:this.bitrateConfig.ivdResolutionFilterEnabled)||void 0===n||n});if(!o)return Ra.error("Cannot choose representation, no representations left: ",e),null;var s=ki.extend({},o,{url:o.keepUrlAsIs?o.url:ki.buildUrl(o.url,this._chooseBaseUrl(),this.forceBaseUrl),containerResolution:this.containerResolution,measuredBandwidth:this.bitrate,bitrateMultiplier:r,...t.chosenRepOverrides||{}});return e.chosenRepresentation=s,Ra.info("[chooseRepresentation] Representation chosen: ",s),t.silent||this.trigger("representationChosen",e.id,s),s},Da.prototype.appendNode=function(e){let t,n=0;e&&"object"==typeof e&&e.nodeId?(t=e.nodeId,n=e.startTimeOffset||0):t=e,Ra.debug(`-> appendNode(${t}) @ ${n}`),this.playlist.push(t),this.trigger("workerstate.playlist.append",t,this.playlist,n)},Da.prototype.updateRepo=function(e){Ra.debug("-> updateRepo()"),this.trigger("workerstate.repo.preupdate"),this.repo=e,this.nodeIdToChildrenMap={},this.correctRepoPrefetch(),this.trigger("workerstate.repo.updated")},Da.prototype.updateRepoDiff=function(e){Ra.debug("-> updateRepoDiff()",e),this.trigger("workerstate.repo.preupdate"),Na.applyDiff(this.repo,e,ki.extend),this.nodeIdToChildrenMap={},this.correctRepoPrefetch(),this.trigger("workerstate.repo.updated")},Da.prototype.updateSegment=function(e){Ra.debug("-> updateSegment()"),this.repo&&this.repo.segments&&e&&e.id&&(this.repo.segments[e.id]=e),this.trigger("workerstate.segment.updated",e)},Da.prototype.reset=function(){Ra.debug("-> reset()"),this.playlist=[],this.appendingIndex=0,this.trigger("workerstate.playlist.reset",this.playlist)},Da.prototype.incrementAppendingIndex=function(e){"number"==typeof e?this.appendingIndex=e:this.appendingIndex++,Ra.debug("-> incrementAppendingIndex() - New index is:",this.appendingIndex),this.trigger("workerstate.appendingIndexIncremented",this.appendingIndex)},Da.prototype.updateBitrate=function(e){Ra.debug("-> updateBitrate()"),this.bitrate=e},Da.prototype.updateContainerResolution=function(e){Ra.debug(`-> updateContainerResolution(${JSON.stringify(e)})`),this.containerResolution=e},Da.prototype.updateBaseUrl=function(e){Ra.debug("-> updateBaseUrl()"),this.baseUrl=e,this.currBaseUrlIndex=0},Da.prototype.setForceBaseUrl=function(e){Ra.debug("-> setForceBaseUrl()"),this.forceBaseUrl=e},Da.prototype.setBitrateMultiplier=function(e){Ra.debug("-> setBitrateMultiplier("+e+")"),this.bitrateConfig&&(this.bitrateConfig.bitrateMultiplier=e)},Da.prototype.loadNode=function(e){Ra.debug("-> loadNode("+e+")"),this.trigger("workerstate.loadNode",e)},Da.prototype.dispose=function(){Ra.debug("-> dispose()"),this.trigger("workerstate.dispose")};var Ma=me.createLogger("BandwidthCalculator","warn");function Fa(){this._mSampleStartTime=NaN,this._mbps=NaN,this._mTotalBytes=0,this._mTotalDuration=0}function Ba(e){if(!e||"string"!=typeof e||!e.startsWith("http"))return e;const t=new URL(e);return t.searchParams.set("x-eko-sw-cache","enabled"),t.toString()}(Fa.prototype=Object.create(Ti.prototype)).constructor=Fa,Fa.prototype._notifyBandwidthUpdated=function(){this.trigger("bandwidthupdated",this._mbps)},Fa.prototype._doAddMeasurement=function(e,t){this._mTotalBytes+=e,this._mTotalDuration+=t;var n=this._mbps;this._mbps=function(e,t){var n=8*e/(t/1e3);return Ma.getIntLevel()<=2&&Ma.info("Calculated: "+parseInt((n/1e3).toFixed(0),10).toLocaleString()+" kbps ("+e.toLocaleString()+" bytes loaded in "+t.toFixed(0)+" milliseconds)."),n}(this._mTotalBytes,this._mTotalDuration),n!==this._mbps&&this._notifyBandwidthUpdated()},Fa.prototype.startSampleMeasurement=function(e){isNaN(this._mSampleStartTime)||e?this._mSampleStartTime=O():Ma.warn("Sample measurement already started and override flag is false, ignoring.")},Fa.prototype.endSampleMeasurement=function(e,t){if(isNaN(this._mSampleStartTime))return Ma.warn("Sample start time was not found. Did you call startSampleMeasurement() ?"),NaN;var n=O(),i=n-this._mSampleStartTime;this._mSampleStartTime=t?n:NaN,this._doAddMeasurement(e,i)},Object.defineProperties(Fa.prototype,{bps:{get:function(){return this._mbps}}});var Ua,ja,za,Va={swCacheEnabled:!1,forceXhr:!1,forceXhrOnEdge:!0,chunkSize:256e3,maxProgressElapsedTime:.5,retries:5,maxReadDuration:.04,retryDelay:.4},Wa=me.createLogger("StreamBinaryLoader","warn");function Ha(e,t){e=e||"",this._opts=ki.extend({},Va,t),this._mUrl=this._opts.swCacheEnabled&&!this._opts.keepUrlAsIs?Ba(e):e,this._mCurrentOffset=0,this._mTotalSize=this._opts.totalSize||0,this._mRetryRef=NaN,this._mLoadRetries=this._opts.retries,this._mArrayBuffer=null,this._mArrayBufferTyped=null,this._mComplete=!1,this._mPaused=!1,this._mLoadStarted=!1,this._mBandwidthCalculator=new Fa(this._opts),this._mPreviousProgressOffset=0,this._mPreviousProgressTime=NaN,this._mWaitingForInitialResponse=!1,this._mIsDisposed=!1,this._mResponseIsFromServiceWorkerCache=!1,this._mLogPrefix="["+ki.basename(e)+"] ",this._onBandwidthUpdated=this._onBandwidthUpdated.bind(this),this._onEnd=this._onEnd.bind(this),this._onData=this._onData.bind(this),Wa.info(this._mLogPrefix+"Initializing with url ["+e+"] and options:",this._opts),this._mBandwidthCalculator.on("bandwidthupdated",this._onBandwidthUpdated),this._opts.baseUrlLoadVariants&&Array.isArray(this._opts.baseUrlLoadVariants)&&(this._opts.baseUrlLoadVariants=this._opts.baseUrlLoadVariants.filter((function(t){return!e.startsWith(t)})))}(Ha.prototype=Object.create(Ti.prototype)).constructor=Ha,Ha.prototype._trigger=function(){this._mIsDisposed||this.trigger.apply(this,arguments)},Ha.prototype._onBandwidthUpdated=function(){this._mResponseIsFromServiceWorkerCache||this._trigger("bandwidthupdated",this.bps)},Ha.prototype._notifyProgress=function(){var e=ki.getTime();(this._mCurrentOffset===this._mTotalSize||this._mCurrentOffset>=this._mPreviousProgressOffset+this._opts.chunkSize||isNaN(this._mPreviousProgressTime)||e>=this._mPreviousProgressTime+1e3*this._opts.maxProgressElapsedTime)&&(this._mPreviousProgressOffset=this._mCurrentOffset,this._mPreviousProgressTime=e,Wa.info(this._mLogPrefix+"progress: "+this._mCurrentOffset+" / "+this._mTotalSize),this._trigger("progress",this._mCurrentOffset,this._mTotalSize))},Ha.prototype._notifyComplete=function(){Wa.info(this._mLogPrefix+"complete"),this._trigger("complete",this)},Ha.prototype._notifyLoadError=function(e){this._trigger("loadError",e)},Ha.prototype._setNextChunkBuffer=function(e){this._mArrayBufferTyped.set(e,this._mCurrentOffset),this._mCurrentOffset+=e.byteLength},Ha.prototype._abortRequest=function(){if(this._reader&&"function"==typeof this._reader.cancel){try{this._reader.cancel()}catch(e){}this._reader=null}if(this._controller){try{this._controller.abort()}catch(e){}this._controller=null}this._mWaitingForInitialResponse=!1},Ha.prototype._onData=function(e){this._mIsDisposed||(this._mBandwidthCalculator.endSampleMeasurement(e.byteLength,!(e.byteLength+this._mCurrentOffset===this._mTotalSize)),this._trigger("bytesDownloaded",e.byteLength),this._setNextChunkBuffer(e),this._mPaused?this._mCurrentOffset<this._mTotalSize&&this._abortRequest():this._notifyProgress())},Ha.prototype._onEnd=function(){this._mComplete=this._mCurrentOffset===this._mTotalSize,this._mComplete&&!this._mPaused&&this&&(this._req=null,this._notifyComplete())},Ha.prototype.load=function(){if(!this._mIsDisposed)if(Wa.debug(this._mLogPrefix+"load()"),isNaN(this._mRetryRef)||(clearTimeout(this._mRetryRef),this._mRetryRef=NaN),this._mPaused=!1,!this._mComplete&&this._mCurrentOffset&&this._mTotalSize&&this._mCurrentOffset===this._mTotalSize&&(this._mComplete=!0),this._mComplete)this._notifyComplete();else{var e=!1,t={};this._opts.swCacheEnabled&&!this._opts.keepUrlAsIs&&(t["x-eko-sw-cache"]="enabled"),this._mTotalSize&&this._mCurrentOffset>0&&(t.range="bytes="+this._mCurrentOffset+"-"+this._mTotalSize,e=!0),"string"!=typeof Ua&&self.env&&(Ua=ki.getObjectProperty(self.env,"browser.name","").toLowerCase(),ja=ki.getObjectProperty(self.env,"engine.name","").toLowerCase(),za=Ua.indexOf("edge")>-1&&"blink"!==ja),(this._opts.forceXhr||za&&this._opts.forceXhrOnEdge)&&Wa.info(this._mLogPrefix+"XHR path requested, using fetch streaming instead for progressive loading"),this._mBandwidthCalculator.startSampleMeasurement(!0),this._controller="undefined"==typeof AbortController?null:new AbortController,this._mLoadStarted=!0,this._mWaitingForInitialResponse=!0,this._startFetch(t,e)}},Ha.prototype._startFetch=function(e,t){fetch(this._mUrl,{method:"GET",headers:e,signal:this._controller?this._controller.signal:void 0}).then(function(e){return this._onFetchResponse(e,t)}.bind(this)).catch(function(e){!e||"AbortError"!==e.name&&20!==e.code?this._handleFetchError("Error occurred while downloading from '"+this._mUrl+"'. "+(e&&e.toString?e.toString():""),NaN):Wa.info(this._mLogPrefix+"Fetch aborted")}.bind(this))},Ha.prototype._updateTotalSizeFromHeaders=function(e,t){if(!t){var n=e.headers&&e.headers.get&&e.headers.get("content-length"),i=parseInt(n,10);isNaN(i)||i<=0?Wa.warn(this._mLogPrefix+"Cannot access Content-Length header for url: '"+this._mUrl+"'. Using meta Content-Length ("+this._mTotalSize+") instead.","If this is a CORS request, make sure that 'Access-Control-Expose-Headers: Content-Length' header is present."):this._mTotalSize=i}},Ha.prototype._ensureArrayBufferAllocated=function(){this._mArrayBuffer||(Wa.info(this._mLogPrefix+"Creating new ArrayBuffer with size "+this._mTotalSize+" for url: "+this._mUrl),this._mArrayBuffer=new ArrayBuffer(this._mTotalSize),this._mArrayBufferTyped=new Uint8Array(this._mArrayBuffer),Wa.info(this._mLogPrefix+"Successfully created ArrayBuffer"),this._trigger("bytesTotal",this._mTotalSize))},Ha.prototype._onFetchResponse=function(e,t){if(Wa.info(this._mLogPrefix+"Initial response object available",e),this._mWaitingForInitialResponse=!1,"hit"===(e.headers&&e.headers.get&&e.headers.get("x-eko-sw-cache")||null)&&(Wa.info(this._mLogPrefix+"Hit from service worker cache - will ignore bandwidth measurements"),this._mResponseIsFromServiceWorkerCache=!0),this._mPaused)this._abortRequest();else{if(!(e.status<200||e.status>399)){this._updateTotalSizeFromHeaders(e,t),this._ensureArrayBufferAllocated();var n=e.body&&e.body.getReader?e.body.getReader():null;if(n){this._reader=n;var i=function(){return n.read().then(function(e){if(e.done)this._onEnd();else if(this._onData(e.value),!this._mPaused&&!this._mIsDisposed)return i.call(this)}.bind(this))}.bind(this);return i()}return e.arrayBuffer().then(function(e){this._onData(new Uint8Array(e)),this._onEnd()}.bind(this))}this._handleFetchError("Failed request for '"+this._mUrl+"'. Server returned '"+e.status+" - "+e.statusText+"'.",e.status)}},Ha.prototype.pause=function(){Wa.debug(this._mLogPrefix+"pause()"),this._abortRequest(),this._mPaused=!0},Ha.prototype.resume=function(){Wa.debug(this._mLogPrefix+"resume()"),this._mPaused=!1,this._mComplete?this._notifyComplete():this._req||this._mWaitingForInitialResponse||this.load()},Ha.prototype.dispose=function(){Wa.debug(this._mLogPrefix+"dispose()"),this._abortRequest(),this._mBandwidthCalculator&&this._mBandwidthCalculator.off("bandwidthupdated",this._onBandwidthUpdated),isNaN(this._mRetryRef)||(clearTimeout(this._mRetryRef),this._mRetryRef=NaN),this._mTotalSize=0,this._mCurrentOffset=0,this._mComplete=!1,this._mUrl=null,this._mArrayBuffer=null,this._mArrayBufferTyped=null,this._mPaused=!1,this._mLoadRetries=0,this._mBandwidthCalculator=null,this._mPreviousProgressOffset=0,this._mPreviousProgressTime=NaN,this._mResponseIsFromServiceWorkerCache=!1,this._trigger("dispose"),this._mIsDisposed=!0},Object.defineProperties(Ha.prototype,{bps:{get:function(){return this._mBandwidthCalculator?this._mBandwidthCalculator.bps:NaN}},bytesLoaded:{get:function(){return this._mCurrentOffset}},bytesTotal:{get:function(){return this._mArrayBuffer&&this._mArrayBuffer.byteLength||0}},arrayBuffer:{get:function(){return this._mArrayBuffer||new ArrayBuffer(0)}},readyForStreaming:{get:function(){return this._mCurrentOffset>0}},completed:{get:function(){return this._mComplete}},paused:{get:function(){return this._mPaused}},loading:{get:function(){return!this._mPaused&&this._mLoadStarted&&!this._mComplete}},loadStarted:{get:function(){return this._mLoadStarted}},url:{get:function(){return this._mUrl}}}),Ha.prototype._handleFetchError=function(e,t){this._abortRequest(),null!==this._mUrl&&(this._mLoadRetries-1>0?(Wa.error(this._mLogPrefix+e+" Retrying."),this._mLoadRetries--,this._notifyLoadError({isLast:!1,url:this._mUrl,status:t,errorMsg:e,attempt:this._opts.retries-this._mLoadRetries}),this._mRetryRef=setTimeout(this.load.bind(this),1e3*this._opts.retryDelay)):this._opts.baseUrlLoadVariants&&this._opts.baseUrlLoadVariants.length>0?(Wa.error(this._mLogPrefix+e+" Retrying from other base url."),this._notifyLoadError({isLast:!1,url:this._mUrl,status:t,errorMsg:e,attempt:this._opts.retries}),this._mUrl=ki.buildUrl(this._mUrl,this._opts.baseUrlLoadVariants.shift(),!0),this._mLoadRetries=this._opts.retries,this._mRetryRef=setTimeout(this.load.bind(this),1e3*this._opts.retryDelay)):(Wa.error(this._mLogPrefix+e+" No more retries."),this._notifyLoadError({isLast:!0,url:this._mUrl,status:t,errorMsg:e,attempt:this._opts.retries})))};const $a={swCacheEnabled:!0,retries:5},Ga=me.createLogger("NoBufferBinaryLoader","warn");function qa(e,t){e=e||"",this._opts=ki.extend({},$a,t),this._mUrl=this._opts.swCacheEnabled&&!this._opts.keepUrlAsIs?Ba(e):e,this._mRetryRef=NaN,this._mLoadRetries=this._opts.retries,this._mComplete=!1,this._mReadyForStreaming=!1,this._mPaused=!1,this._mLoadStarted=!1,this._mBandwidthCalculator=new Fa(this._opts),this._mIsDisposed=!1,this._mResponseIsFromServiceWorkerCache=!1,this._mAbortController=null,this._mLogPrefix=`[${this._mUrl}] `,this._onBandwidthUpdated=this._onBandwidthUpdated.bind(this),this._onEnd=this._onEnd.bind(this),Ga.info(this._mLogPrefix+"Initializing with url ["+e+"] and options:",this._opts),this._mBandwidthCalculator.on("bandwidthupdated",this._onBandwidthUpdated),this._opts.baseUrlLoadVariants&&Array.isArray(this._opts.baseUrlLoadVariants)&&(this._opts.baseUrlLoadVariants=this._opts.baseUrlLoadVariants.filter((function(t){return!e.startsWith(t)})))}function Ya(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}function Ka(e,t){return e.get(Ya(e,t))}function Xa(e,t,n){return e.set(Ya(e,t),n),n}function Qa(e,t,n){return n(Ya(e,t))}function Za(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,"string");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ja(){return Ja=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Ja.apply(this,arguments)}function el(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tl(e,t,n){el(e,t),t.set(e,n)}function nl(e,t){el(e,t),t.add(e)}(qa.prototype=Object.create(Ti.prototype)).constructor=qa,qa.prototype._trigger=function(){this._mIsDisposed||this.trigger.apply(this,arguments)},qa.prototype._onBandwidthUpdated=function(){this._mResponseIsFromServiceWorkerCache?Ga.info(this._mLogPrefix+"Hit from service worker cache - ignoring bandwidth measurements"):(Ga.info(this._mLogPrefix+"Bandwidth updated - "+this.bps.toFixed(0)+" bps"),this._trigger("bandwidthupdated",this.bps))},qa.prototype._notifyComplete=function(){Ga.info(this._mLogPrefix+"complete"),this._trigger("complete",this)},qa.prototype._notifyReadyForStreaming=function(){Ga.info(this._mLogPrefix+"readyforstreaming"),this._mReadyForStreaming=!0,this._trigger("readyforstreaming",this)},qa.prototype._notifyLoadError=function(e){this._trigger("loadError",e)},qa.prototype._abortRequest=function(e={}){if(!this._mAbortController)return;this._mAbortController.abort(),this._mAbortController=null;const{notifyServiceWorker:t}="boolean"==typeof e.notifyServiceWorker?e:{notifyServiceWorker:!0};t&&this._opts.swCacheEnabled&&self.navigator&&self.navigator.serviceWorker&&self.navigator.serviceWorker.controller&&(Ga.info(this._mLogPrefix+"Aborting service worker cache request"),self.navigator.serviceWorker.controller.postMessage({type:"fetchabort",data:{url:this._mUrl}}))},qa.prototype._onEnd=function(){this._mAbortController=null,this._mComplete&&!this._mPaused&&this._notifyComplete()},qa.prototype.load=async function(){if(this._mIsDisposed)return;if(Ga.debug(this._mLogPrefix+"load()"),isNaN(this._mRetryRef)||(clearTimeout(this._mRetryRef),this._mRetryRef=NaN),this._mPaused=!1,this._mComplete)return void this._notifyComplete();this._mAbortController=new AbortController,this._mLoadStarted=!0;const e={...this._opts.swCacheEnabled&&!this._opts.keepUrlAsIs&&{"x-eko-sw-cache":"enabled"}};let t;try{if(this._mBandwidthCalculator.startSampleMeasurement(!0),t=await fetch(this._mUrl,{signal:this._mAbortController.signal,method:"GET",headers:e}),!t.ok)throw new Error("Response was not ok");this._mResponseIsFromServiceWorkerCache="hit"===t.headers.get("x-eko-sw-cache"),this._notifyReadyForStreaming(),await t.arrayBuffer(),this._mBandwidthCalculator.endSampleMeasurement(t.headers.get("content-length")),this._mComplete=!0,this._onEnd()}catch(e){const n=t&&t.status,i=t&&t.statusText;if("AbortError"===e.name||499===n&&"Client Closed Request"===i)return void Ga.info(this._mLogPrefix+"Load aborted");const r=`Failed request for "${this._mUrl}". Server returned ${n} - ${i}.\n${e}`;this._mLoadRetries-1>0?(Ga.warn(this._mLogPrefix+r+" Retrying."),this._mLoadRetries--,this._notifyLoadError({isLast:!1,url:this._mUrl,status:n,errorMsg:r,attempt:this._opts.retries-this._mLoadRetries}),this._mRetryRef=setTimeout(this.load.bind(this),1e3*this._opts.retryDelay)):this._opts.baseUrlLoadVariants&&this._opts.baseUrlLoadVariants.length>0?(Ga.warn(this._mLogPrefix+r+" Retrying from other base url."),this._notifyLoadError({isLast:!1,url:this._mUrl,status:n,errorMsg:r,attempt:this._opts.retries}),this._mUrl=ki.buildUrl(this._mUrl,this._opts.baseUrlLoadVariants.shift(),!0),this._mLoadRetries=this._opts.retries,this._mRetryRef=setTimeout(this.load.bind(this),1e3*this._opts.retryDelay)):(Ga.error(this._mLogPrefix+r+" No more retries."),this._notifyLoadError({isLast:!0,url:this._mUrl,status:n,errorMsg:r,attempt:this._opts.retries}))}},qa.prototype.pause=function(){Ga.debug(this._mLogPrefix+"pause()"),this._abortRequest(),this._mPaused=!0},qa.prototype.resume=function(){Ga.debug(this._mLogPrefix+"resume()"),this._mPaused=!1,this._mComplete?this._notifyComplete():this.load()},qa.prototype.dispose=function(){Ga.debug(this._mLogPrefix+"dispose()"),this._abortRequest(),this._mBandwidthCalculator&&this._mBandwidthCalculator.off("bandwidthupdated",this._onBandwidthUpdated),isNaN(this._mRetryRef)||(clearTimeout(this._mRetryRef),this._mRetryRef=NaN),this._mComplete=!1,this._mReadyForStreaming=!1,this._mUrl=null,this._mPaused=!1,this._mLoadRetries=0,this._mBandwidthCalculator=null,this._mResponseIsFromServiceWorkerCache=!1,this._trigger("dispose"),this._mIsDisposed=!0},Object.defineProperties(qa.prototype,{bps:{get:function(){return this._mBandwidthCalculator?this._mBandwidthCalculator.bps:NaN}},bytesLoaded:{get:function(){return 0}},bytesTotal:{get:function(){return 0}},arrayBuffer:{get:function(){return null}},completed:{get:function(){return this._mComplete}},paused:{get:function(){return this._mPaused}},loading:{get:function(){return!this._mPaused&&this._mLoadStarted&&!this._mComplete}},loadStarted:{get:function(){return this._mLoadStarted}},url:{get:function(){return this._mUrl}},readyForStreaming:{get:function(){return this._mReadyForStreaming}}});const il=me.createLogger("TransBufferBinaryLoader","warn"),rl=["bandwidthupdated","progress","complete","loadError","bytesDownloaded","bytesTotal","readyforstreaming"];var ol=new WeakMap,sl=new WeakMap,al=new WeakMap,ll=new WeakMap,cl=new WeakMap,ul=new WeakMap,dl=new WeakSet;class hl{constructor(e,t={}){nl(this,dl),tl(this,ol,""),tl(this,sl,!1),tl(this,al,null),tl(this,ll,null),tl(this,cl,null),tl(this,ul,null),Xa(ol,this,e?`[${e}]`:""),Xa(al,this,e),Xa(ll,this,t),Xa(sl,this,"boolean"==typeof t.useBuffer&&t.useBuffer),Xa(ul,this,new Ti),il.info(`${Ka(ol,this)} Initializing ${Ka(sl,this)?"BUFFERED LOADER":"NOBUFFER LOADER"} with options:`,Ka(ll,this)),Ya(dl,this,pl).call(this)}load(){Ka(cl,this).load()}pause(){Ka(cl,this).pause()}resume(){Ka(cl,this).resume()}dispose(){Ya(dl,this,gl).call(this),Ka(cl,this).dispose(),this.trigger("dispose")}switch(e){"boolean"==typeof e&&Ka(sl,this)!==e&&(il.info(`${Ka(ol,this)} Switching to ${e?"BUFFERED LOADER":"NOBUFFER LOADER"}`),Xa(sl,this,e),Ya(dl,this,pl).call(this))}on(...e){Ka(ul,this).on(...e)}once(...e){Ka(ul,this).once(...e)}off(...e){Ka(ul,this).off(...e)}trigger(...e){Ka(ul,this).trigger(...e)}removeAllListeners(...e){Ka(ul,this).removeAllListeners(...e)}get bps(){return Ka(cl,this).bps}get bytesLoaded(){return Ka(cl,this).bytesLoaded}get bytesTotal(){return Ka(cl,this).bytesTotal}get arrayBuffer(){return Ka(cl,this).arrayBuffer}get completed(){return Ka(cl,this).completed}get paused(){return Ka(cl,this).paused}get loading(){return Ka(cl,this).loading}get loadStarted(){return Ka(cl,this).loadStarted}get url(){return Ka(cl,this).url}get readyForStreaming(){return Ka(cl,this).readyForStreaming}}function pl(){let e=!1,t=!1;Ka(cl,this)&&(e=Ka(cl,this).loadStarted,t=Ka(cl,this).paused,Ya(dl,this,gl).call(this),"function"==typeof Ka(cl,this)._abortRequest&&Ka(cl,this)._abortRequest({notifyServiceWorker:!1}),Ka(cl,this).dispose(),Xa(cl,this,null)),Xa(cl,this,Ka(sl,this)?new Ha(Ka(al,this),Ka(ll,this)):new qa(Ka(al,this),Ka(ll,this))),Ya(dl,this,fl).call(this),e&&Ka(cl,this).load(),t&&Ka(cl,this).pause()}function fl(){rl.forEach((e=>{Ka(cl,this).__listeners=Ka(cl,this).__listeners||{},Ka(cl,this).__listeners[e]=(...t)=>{this.trigger(e,...t)},Ka(cl,this).on(e,Ka(cl,this).__listeners[e])}))}function gl(){Ka(cl,this)&&Ka(cl,this).__listeners&&(Object.entries(Ka(cl,this).__listeners).forEach((([e,t])=>{Ka(cl,this).off(e,t)})),Ka(cl,this).__listeners=null)}const ml=me.createLogger("binaryLoaderFactory","warn");var yl=me.createLogger("SegmentLoader","warn");function vl(e,t,n){this._segment=e,this._workerState=t,this._options=n||{},this._useBuffer="boolean"==typeof this._options.useBuffer&&this._options.useBuffer,this._representation=null,this._binaryLoader=null,this._logPrefix=this._segment&&this._segment.id?"["+this._segment.id+"] ":"",this._isDisposed=!1,this._onBinaryLoaderBandwidthUpdated=this._onBinaryLoaderBandwidthUpdated.bind(this),this._onBinaryLoaderComplete=this._onBinaryLoaderComplete.bind(this),yl.info(this._logPrefix+"Initializing with options:",n)}(vl.prototype=Object.create(Ti.prototype)).constructor=vl,vl.prototype._onBinaryLoaderBandwidthUpdated=function(){this.trigger("bandwidthupdated",this,this.bps)},vl.prototype._onBinaryLoaderComplete=function(){this.trigger("complete",this)},vl.prototype._addBinaryLoaderListeners=function(e){e=e||this._binaryLoader,!this._isDisposed&&e&&(e.on("bandwidthupdated",this._onBinaryLoaderBandwidthUpdated),e.on("complete",this._onBinaryLoaderComplete),e.on("progress",this.trigger.bind(this,"progress")),e.on("loadError",this.trigger.bind(this,"loadError")),e.on("bytesDownloaded",this.trigger.bind(this,"bytesDownloaded")),e.on("bytesTotal",this.trigger.bind(this,"bytesTotal")),e.on("readyforstreaming",this.trigger.bind(this,"readyforstreaming")))},vl.prototype._removeBinaryLoaderListeners=function(e){e=e||this._binaryLoader,!this._isDisposed&&e&&e.removeAllListeners()},vl.prototype._chooseRepresentation=function(e){return this._workerState.chooseRepresentation(e)},vl.prototype.load=function(){if(yl.trace(this._logPrefix+"load()"),!this._representation){this._representation=this._chooseRepresentation(this.segment);var e=this._representation?this._representation.url:null;if(!e)throw new Error(this._logPrefix+"Could not choose a representation");this._binaryLoader=function(e,t){let n;return(t=t||{}).forceTransBufferBinaryLoader?(ml.info("Creating TransBufferBinaryLoader"),n=new hl(e,t)):t.forceNoBufferBinaryLoader?(ml.info("Creating NoBufferBinaryLoader"),n=new qa(e,t)):(ml.info("Creating a StreamBinaryLoader instance."),n=new Ha(e,t)),n}(e,{...this._options,totalSize:this._representation.contentLength,useBuffer:this._useBuffer,keepUrlAsIs:this._representation.keepUrlAsIs}),this._addBinaryLoaderListeners(),this.trigger("representationChosen",this._representation)}if(!this._binaryLoader)throw new Error(this._logPrefix+"No binary loader instance found");this._binaryLoader.load()},vl.prototype.pause=function(){yl.trace(this._logPrefix+"pause()"),this._binaryLoader&&this._binaryLoader.pause()},vl.prototype.resume=function(){yl.trace(this._logPrefix+"resume()"),this._binaryLoader?this._binaryLoader.resume():yl.warn(this._logPrefix+"resume() called but binary loader instance does not exist")},vl.prototype.switch=function(e){yl.trace(this._logPrefix+"switch("+e+")"),"boolean"==typeof e&&this._useBuffer!==e&&(yl.info(this._logPrefix+"Switching to "+(e?"BUFFERED LOADER":"NOBUFFER LOADER")),this._useBuffer=e,this._binaryLoader&&"function"==typeof this._binaryLoader.switch&&this._binaryLoader.switch(this._useBuffer))},vl.prototype.dispose=function(){yl.trace(this._logPrefix+"dispose()"),this.trigger("dispose",this.segment),this._removeBinaryLoaderListeners(),this._binaryLoader&&this._binaryLoader.dispose(),this._representation=null,this._binaryLoader=null,this._isDisposed=!0},Object.defineProperties(vl.prototype,{bps:{get:function(){return this._binaryLoader?this._binaryLoader.bps:NaN}},bytesLoaded:{get:function(){return this._binaryLoader?this._binaryLoader.bytesLoaded:0}},bytesTotal:{get:function(){return this._binaryLoader?this._binaryLoader.bytesTotal:0}},arrayBuffer:{get:function(){return this._binaryLoader?this._binaryLoader.arrayBuffer:null}},readyForStreaming:{get:function(){return!!this._binaryLoader&&!!this._binaryLoader.readyForStreaming}},completed:{get:function(){return!!this._binaryLoader&&this._binaryLoader.completed}},paused:{get:function(){return!!this._binaryLoader&&this._binaryLoader.paused}},loading:{get:function(){return!!this._binaryLoader&&this._binaryLoader.loading}},loadStarted:{get:function(){return!!this._binaryLoader&&this._binaryLoader.loadStarted}},url:{get:function(){return this._binaryLoader?this._binaryLoader.url:""}},segmentId:{get:function(){var e,t;return null!==(e=null==this||null===(t=this._segment)||void 0===t?void 0:t.id)&&void 0!==e?e:null}},segment:{get:function(){return this._workerState&&this._workerState.repo&&this._workerState.repo.segments&&this._segment&&this._segment.id&&this._workerState.repo.segments[this._segment.id]||null}},representation:{get:function(){return this._representation}}});var bl=me.createLogger("SingleAltSegmentLoader","warn");function wl(e){var t=Array.prototype.slice.call(arguments);t.splice(0,1),vl.apply(this,t),this._altIndex=e||0,this._altLength=this._segment&&this._segment.metadata&&this._segment.metadata.altLength||1,bl.info(this._logPrefix+"was created with alternate "+this._altIndex)}(wl.prototype=Object.create(vl.prototype)).constructor=wl,wl.prototype._chooseRepresentation=function(e){var t=ki.extend(!0,{},e),n=this._altIndex,i=this._altLength;t.representations=t.representations.filter((function(e){return e.altIndex===n}));var r=this._workerState.chooseRepresentation(t,{silent:!0,bitrateMultiplierTransform:function(e){return e*i}});return this._segment.chosenRepresentation||(this._segment.chosenRepresentation=ki.extend(!0,{},t.chosenRepresentation)),this._segment.chosenRepresentation.alternates=this._segment.chosenRepresentation.alternates||[],this._segment.chosenRepresentation.alternates[n]=t.chosenRepresentation,i-1===n&&this._workerState.trigger("representationChosen",this._segment.id,this._segment.chosenRepresentation),r};var kl=me.createLogger("AlternatesSegmentLoader","warn");function xl(e,t){e&&e.length&&e.forEach((function(e){e&&t(e)}))}function Sl(e,t){var n=[];return e&&e.length?(xl(e,(function(e){n.push(t(e))})),n):n}function Cl(e,t,n){vl.apply(this,arguments),this._segLoaders=[],this._channelCount=this._segment&&this._segment.metadata&&this._segment.metadata.altLength||1,this._triggerQueue=null,this._triggerTimeoutRef=null,this._onSegLoaderLoadError=this._onSegLoaderLoadError.bind(this),this._onSegLoaderProgress=this._onSegLoaderProgress.bind(this),this._onSegLoaderComplete=this._onSegLoaderComplete.bind(this),this._onSegLoaderBandwidthUpdated=this._onSegLoaderBandwidthUpdated.bind(this),this._onSegLoaderBytesTotal=this._onSegLoaderBytesTotal.bind(this),this._onSegLoaderBytesDownloaded=this._onSegLoaderBytesDownloaded.bind(this);for(var i=0;i<this._channelCount;++i)this._segLoaders.push(new wl(i,e,t,n)),this._addSegLoaderEventListeners(this._segLoaders[i])}(Cl.prototype=Object.create(vl.prototype)).constructor=Cl,Cl.prototype._trigger=function(){this._isDisposed||this.trigger.apply(this,arguments)},Cl.prototype._onSegLoaderBandwidthUpdated=function(e,t){kl.debug(this._logPrefix+"-> _onSegLoaderBandwidthUpdated()"),this._trigger("bandwidthupdated",e,t)},Cl.prototype._onSegLoaderProgress=function(e,t){kl.debug(this._logPrefix+"-> _onSegLoaderProgress()"),this._trigger("progress",e,t)},Cl.prototype._onSegLoaderComplete=function(){kl.debug(this._logPrefix+"-> _onSegLoaderComplete()"),this.completed&&(kl.info(this._logPrefix+"[_onSegLoaderComplete] Triggering complete event"),this._trigger("complete"))},Cl.prototype._onSegLoaderBytesTotal=function(e){kl.debug(this._logPrefix+"-> _onSegLoaderBytesTotal()"),this._trigger("bytesTotal",e)},Cl.prototype._onSegLoaderBytesDownloaded=function(e){kl.debug(this._logPrefix+"-> _onSegLoaderBytesDownloaded()"),this._trigger("bytesDownloaded",e)},Cl.prototype._onSegLoaderLoadError=function(e){kl.debug(this._logPrefix+"-> _onSegLoaderLoadError()"),this._trigger("loadError",e)},Cl.prototype._addSegLoaderEventListeners=function(e){e.on("bandwidthupdated",this._onSegLoaderBandwidthUpdated),e.on("progress",this._onSegLoaderProgress),e.on("complete",this._onSegLoaderComplete),e.on("bytesTotal",this._onSegLoaderBytesTotal),e.on("loadError",this._onSegLoaderLoadError),e.on("bytesDownloaded",this._onSegLoaderBytesDownloaded)},Cl.prototype._removeSegLoaderEventListeners=function(e){e.off("bandwidthupdated",this._onSegLoaderBandwidthUpdated),e.off("progress",this._onSegLoaderProgress),e.off("complete",this._onSegLoaderComplete),e.off("bytesTotal",this._onSegLoaderBytesTotal),e.off("loadError",this._onSegLoaderLoadError),e.off("bytesDownloaded",this._onSegLoaderBytesDownloaded)},Cl.prototype.load=function(){kl.debug(this._logPrefix+"-> load()"),xl(this._segLoaders,(function(e){e.load()}))},Cl.prototype.pause=function(){kl.debug(this._logPrefix+"-> pause()"),xl(this._segLoaders,(function(e){e.pause()}))},Cl.prototype.resume=function(){kl.debug(this._logPrefix+"-> resume()"),xl(this._segLoaders,(function(e){e.resume()}))},Cl.prototype.switch=function(e){kl.debug(this._logPrefix+"-> switch("+e+")"),xl(this._segLoaders,(function(t){t.switch(e)}))},Cl.prototype.dispose=function(){kl.debug(this._logPrefix+"-> dispose()"),xl(this._segLoaders,function(e){this._removeSegLoaderEventListeners(e),e.dispose()}.bind(this)),this._segLoaders=null,this._channelCount=NaN,this._triggerQueue=null,this._triggerTimeoutRef=null,this._isDisposed=!0},Object.defineProperties(Cl.prototype,{bps:{get:function(){return Sl(this._segLoaders,(function(e){return e.bps}))}},bytesLoaded:{get:function(){return Sl(this._segLoaders,(function(e){return e.bytesLoaded}))}},bytesTotal:{get:function(){return Sl(this._segLoaders,(function(e){return e.bytesTotal}))}},arrayBuffer:{get:function(){return Sl(this._segLoaders,(function(e){return e.arrayBuffer}))}},readyForStreaming:{get:function(){return Sl(this._segLoaders,(function(e){return e.readyForStreaming})).reduce((function(e,t){return e&&t}),!0)}},completed:{get:function(){return Sl(this._segLoaders,(function(e){return e.completed})).reduce((function(e,t){return e&&t}),!0)}},paused:{get:function(){return Sl(this._segLoaders,(function(e){return e.paused})).reduce((function(e,t){return e&&t}),!0)}},loading:{get:function(){return Sl(this._segLoaders,(function(e){return e.loading})).reduce((function(e,t){return e||t}),!1)}},loadStarted:{get:function(){return Sl(this._segLoaders,(function(e){return e.loadStarted})).reduce((function(e,t){return e||t}),!1)}},url:{get:function(){return Sl(this._segLoaders,(function(e){return e.url}))}},channels:{get:function(){return this._channelCount}}});const _l=me.createLogger("ImageSegmentLoader","warn");function El(e){return!(!e||-1!==e.width&&-1!==e.height&&e.width&&e.height)}var Tl=new WeakMap,Pl=new WeakSet;class Il extends vl{constructor(...e){super(...e),nl(this,Pl),tl(this,Tl,null)}_chooseRepresentation(e){const t=super._chooseRepresentation(e);return El(t)&&(_l.debug(`${this._logPrefix}[_chooseRepresentation] Representation missing width/height - forcing buffer:`,t),this._useBuffer=!0,this._options={...this._options,forceNoBufferBinaryLoader:!1}),t}async _onBinaryLoaderComplete(){var e,t,n;if(!this._isDisposed&&this.completed){if(!Ka(Tl,this)&&null!==(e=this.arrayBuffer)&&void 0!==e&&e.byteLength)try{Xa(Tl,this,await createImageBitmap(new Blob([this.arrayBuffer]))),_l.debug(`${this._logPrefix}[_onBinaryLoaderComplete] ImageBitmap created`,Ka(Tl,this))}catch(e){_l.error(`${this._logPrefix}[_onBinaryLoaderComplete] Error creating ImageBitmap from arrayBuffer`,e)}if(El(this.representation)&&null!==(t=Ka(Tl,this))&&void 0!==t&&t.width&&null!==(n=Ka(Tl,this))&&void 0!==n&&n.height){var i;const e=Ka(Tl,this).width,t=Ka(Tl,this).height,n=this.representation.contentLength||(null===(i=this.arrayBuffer)||void 0===i?void 0:i.byteLength),r=this.representation.duration||this.segment.duration||0,o=this.representation.bandwidth||(r?n/r:0),s={...this.representation,width:e,height:t,contentLength:n,duration:r,bandwidth:o,videoBandwidth:this.representation.videoBandwidth||o,frameRate:this.representation.frameRate||1/(r||1)};_l.debug(`${this._logPrefix}[_onBinaryLoaderComplete] Updating chosen representation with image dimensions: ${s.width}x${s.height}`,s),Ya(Pl,this,Al).call(this,s)}this.trigger("complete",this)}}dispose(){super.dispose(),Xa(Tl,this,null)}get imageBitmap(){return Ka(Tl,this)}}function Al(e){if(_l.debug(`${this._logPrefix}[#updateChosenRepresentation]`,e),!this.representation)throw new Error(`${this._logPrefix}[#updateChosenRepresentation] Cannot update if no representation chosen yet.`);this._representation=e,this.trigger("representationChosen",this.representation),this._workerState.trigger("representationChosen",this.segment.id,this.representation)}Za(Il,"isImageSegment",sn);var Ol=me.createLogger("segmentLoaderFactory","warn");function Ll(e,t){var n,i=!0;for(n in t)if(typeof e[n]!=typeof t[n]){i=!1;break}return i}var Nl=me.createLogger("SegmentStore","warn"),Rl=function(e){for(var t in this.segMap={},this.checksumMap={},this.bytesTotal=0,this.workerState=e,this.bandwidth=new vs(this,ki.extend(e.bitrateConfig||{},{bitrate:e.bitrate,env:e.environment})),this.segmentLoaderConfig=ki.extend({swCacheEnabled:this.workerState.config&&this.workerState.config.swCacheEnabled||!1},this.workerState.config&&this.workerState.config.segmentLoaderConfig||{}),this)"function"==typeof this[t]&&(this[t]=this[t].bind(this));this._addMiscListeners()};(Rl.prototype=Object.create(Ti.prototype)).constructor=Rl;var Dl=function(e,t){t.off("complete",e._onSegmentLoaderComplete),t.off("bytesTotal",e._onSegmentLoaderBytesTotal),t.off("loadError",e._onSegmentLoaderLoadError),t.off("bytesDownloaded",e._onSegmentLoaderBytesDownloaded)};Rl.prototype._addMiscListeners=function(){this.bandwidth&&this.workerState&&this.workerState.bitrateConfig&&this.workerState.bitrateConfig.enableAdaptiveBitrate&&this.bandwidth.on("bandwidthupdated",this._onBandwidthUpdated),this&&this.workerState&&this.workerState.on("representationChosen",this._onRepresentationChosen)},Rl.prototype._removeMiscListeners=function(){this&&this.bandwidth&&this.bandwidth.off("bandwidthupdated",this._onBandwidthUpdated),this&&this.workerState&&this.workerState.off("representationChosen",this._onRepresentationChosen)},Rl.prototype._findDuplicateSegmentLoader=function(e){if(e&&e.representations&&e.representations.length&&e.representations[0]&&e.representations[0].checksum&&this.checksumMap[e.representations[0].checksum]){var t=this.checksumMap[e.representations[0].checksum],n=t.segment;if(!n||!n.representations||e.representations.length!==n.representations.length)return null;for(var i=0;i<e.representations.length;i++)if(o=n.representations[i],!(r=e.representations[i])||!o||r.checksum!==o.checksum||r.contentLength!==o.contentLength||r.format!==o.format)return null;return Nl.info("Found duplicate segment: ["+e.id+"] === ["+n.id+"]."),t}var r,o;return null},Rl.prototype._onRepresentationChosen=function(e,t){!this.isInMidDuplicateSegmentResolve&&this.segMap[e]&&this.segMap[e].refCount>1&&(this.isInMidDuplicateSegmentResolve=!0,Object.keys(this.segMap).forEach(function(n){this.segMap[n]===this.segMap[e]&&e!==n&&this.workerState.trigger("representationChosen",n,t)}.bind(this)),this.isInMidDuplicateSegmentResolve=!1)},Rl.prototype._onSegmentLoaderComplete=function(e){Nl.info("SegmentLoader load complete"),e&&this.trigger("loader.complete",e.url,e.bps)},Rl.prototype._onSegmentLoaderBytesTotal=function(e){Nl.info("SegmentLoader bytesTotal: "+e),this.bytesTotal+=e,this.trigger("memory.increased",this.bytesTotal)},Rl.prototype._onSegmentLoaderLoadError=function(e){this.trigger("loadError",e)},Rl.prototype._onBandwidthUpdated=function(e){this.trigger("bandwidthupdated",e)},Rl.prototype._onSegmentLoaderBytesDownloaded=function(e){this.trigger("bytesDownloaded",e)},Rl.prototype.create=function(e,t){if(!e||!e.id)return Nl.error("Cannot create SegmentLoader for segment",e),null;if(!this.segMap.hasOwnProperty(e.id)){var n=this._findDuplicateSegmentLoader(e);n?(this.segMap[e.id]=n,this.segMap[e.id].refCount++,n.segment&&n.segment.chosenRepresentation&&this.workerState.trigger("representationChosen",e.id,n.segment.chosenRepresentation)):(this.segMap[e.id]=function(e,t,n){var i,r=function(e){return e&&e.metadata&&e.metadata.altLength>1}(e);return n=n||{},Il.isImageSegment(e)?(Ol.info("Creating ImageSegmentLoader"),i=new Il(e,t,n)):r&&n.alternatesEnabled?(Ol.info("Creating AlternateSegmentLoader"),i=new Cl(e,t,n)):(Ol.info("Creating SegmentLoader"),i=new vl(e,t,n)),i}(e,this.workerState,{useBuffer:this.workerState.playlist.includes(t),...this.segmentLoaderConfig}),e.representations&&e.representations.length&&e.representations[0]&&e.representations[0].checksum?this.checksumMap[e.representations[0].checksum]=this.segMap[e.id]:e.representations&&e.representations.length||Nl.error("Segment for node ["+t+"] has no representations:",e),function(e,t){t.on("complete",e._onSegmentLoaderComplete),t.on("bytesTotal",e._onSegmentLoaderBytesTotal),t.on("loadError",e._onSegmentLoaderLoadError),t.on("bytesDownloaded",e._onSegmentLoaderBytesDownloaded)}(this,this.segMap[e.id]),this.trigger("segmentloader.added",this.segMap[e.id],e.id),this.segMap[e.id].refCount=1)}return!t||this.segMap[e.id].nodeIds&&this.segMap[e.id].nodeIds[t]||(this.segMap[e.id].nodeIds=this.segMap[e.id].nodeIds||{},this.segMap[e.id].nodeIds[t]=!0),this.segMap[e.id]},Rl.prototype.destroy=function(e){if(arguments.length>1)for(var t=0;t<arguments.length;t++)this.destroy(arguments[t]);else if(Array.isArray(e))this.destroy.apply(this,e);else{var n=e&&"object"==typeof e?e.id:"string"==typeof e?e:null;if(e&&n)if(this.segMap.hasOwnProperty(n)){var i=this.segMap[n];delete this.segMap[n],i.refCount--,i.refCount||(e=i.segment,this.bytesTotal-=i.bytesTotal,Ll(i,ea)&&i.dispose(),e.representations&&e.representations.length&&e.representations[0]&&e.representations[0].checksum&&this.checksumMap[e.representations[0].checksum]&&delete this.checksumMap[e.representations[0].checksum],Dl(this,i),this.trigger("segmentloader.removed",i,n))}else Nl.warn("Cannot unload, SegmentLoader not found: "+n);else Nl.error("Cannot destroy SegmentLoader for segment",e)}},Rl.prototype.getByNodeId=function(e){var t=this.workerState.nodeIdToSegment(e);return this.create(t,e)},Rl.prototype.getBySegId=function(e){return this.segMap[e]},Rl.prototype.dispose=function(){for(var e in this.segMap)Ll(this.segMap[e],ea)&&this.segMap[e].dispose(),Dl(this,this.segMap[e]),this.trigger("segmentloader.removed",this.segMap[e],e);this._removeMiscListeners(),this.bandwidth&&"function"==typeof this.bandwidth.dispose&&this.bandwidth.dispose(),this.segMap={},this.bytesTotal=0,this.workerState=null,this.bandwidth=null};const Ml=me.createLogger("ImageSegmentDecoder","warn");var Fl=new WeakMap,Bl=new WeakMap,Ul=new WeakMap,jl=new WeakMap,zl=new WeakMap,Vl=new WeakMap,Wl=new WeakMap,Hl=new WeakSet;class $l extends Ti{constructor(e,t,n,i){super(),nl(this,Hl),tl(this,Fl,""),tl(this,Bl,null),tl(this,Ul,null),tl(this,jl,0),tl(this,zl,null),tl(this,Vl,null),tl(this,Wl,!0),Xa(Bl,this,e),Xa(Ul,this,t),Xa(jl,this,n||0),Xa(zl,this,i),Xa(Fl,this,`[#${Ka(Ul,this)}] [${Ka(Bl,this)} @ ${Ka(jl,this)}]`),Ml.debug(`${Ka(Fl,this)} [constructor] Playlist index: ${t}. Start time offset: ${n}`),this.onSegmentLoaderComplete=this.onSegmentLoaderComplete.bind(this),Ka(zl,this).switch(!0),Ya(Hl,this,ql).call(this),Ka(zl,this).completed&&(Ml.debug(`${Ka(Fl,this)} [constructor] Segment loader already completed`),this.onSegmentLoaderComplete())}dispose(){var e;if(Ml.debug(`[dispose] [${Ka(Bl,this)}]`),Ya(Hl,this,Yl).call(this),Xa(jl,this,0),Xa(zl,this,null),Xa(Wl,this,!0),Xa(Fl,this,""),"function"==typeof(null===(e=Ka(Vl,this))||void 0===e?void 0:e.close))try{Ka(Vl,this).close()}catch(e){}Xa(Vl,this,null)}onSegmentLoaderComplete(){var e,t;Ml.debug(`${Ka(Fl,this)} [onSegmentLoaderComplete]`),null!==(e=Ka(zl,this).imageBitmap)&&void 0!==e&&e.width&&null!==(t=Ka(zl,this).imageBitmap)&&void 0!==t&&t.height?(this.trigger("buffered"),Ka(Vl,this)||Xa(Vl,this,new VideoFrame(Ka(zl,this).imageBitmap,{duration:1e6*this.duration,timestamp:0})),Ka(Wl,this)||this.trigger("videoframes",[Ka(Vl,this)])):Ml.warn(`${Ka(Fl,this)} [onSegmentLoaderComplete] No image data found in segment loader`)}start(){Ml.debug(`${Ka(Fl,this)} [start]`),Xa(Wl,this,!1),Ka(zl,this).completed&&this.onSegmentLoaderComplete()}updateFreedBytes(){}updatePlaybackCurrentTime(){}get nodeId(){return Ka(Bl,this)}get segmentId(){var e;return null===(e=Ka(zl,this))||void 0===e?void 0:e.segmentId}get playlistIndex(){return Ka(Ul,this)}get duration(){var e,t;return null!==(e=null===(t=Ka(zl,this))||void 0===t||null===(t=t.representation)||void 0===t?void 0:t.duration)&&void 0!==e?e:0}get bufferedDuration(){return Ka(zl,this).completed?this.duration:0}}function Gl(e=!1){var t;const n=e?"on":"off";null===(t=Ka(zl,this))||void 0===t||t[n]("complete",this.onSegmentLoaderComplete)}function ql(){Ya(Hl,this,Gl).call(this,!0)}function Yl(){Ya(Hl,this,Gl).call(this,!1)}function Kl(e){if(!e)throw new Error("Assertion failed.")}$l.isImageSegment=sn;const Xl=e=>{const t=(e%360+360)%360;if(0===t||90===t||180===t||270===t)return t;throw new Error(`Invalid rotation ${e}.`)},Ql=e=>e&&e[e.length-1];class Zl{constructor(e){this.bytes=e,this.pos=0}seekToByte(e){this.pos=8*e}readBit(){var e;const t=Math.floor(this.pos/8),n=null!==(e=this.bytes[t])&&void 0!==e?e:0,i=7-(7&this.pos),r=(n&1<<i)>>i;return this.pos++,r}readBits(e){if(1===e)return this.readBit();let t=0;for(let n=0;n<e;n++)t<<=1,t|=this.readBit();return t}writeBits(e,t){const n=this.pos+e;for(let e=this.pos;e<n;e++){const i=Math.floor(e/8);let r=this.bytes[i];const o=7-(7&e);r&=~(1<<o),r|=(t&1<<n-e-1)>>n-e-1<<o,this.bytes[i]=r}this.pos=n}readAlignedByte(){var e;if(this.pos%8!=0)throw new Error("Bitstream is not byte-aligned.");const t=null!==(e=this.bytes[this.pos/8])&&void 0!==e?e:0;return this.pos+=8,t}skipBits(e){this.pos+=e}getBitsLeft(){return 8*this.bytes.length-this.pos}clone(){const e=new Zl(this.bytes);return e.pos=this.pos,e}}const Jl=e=>{let t=0;for(;0===e.readBits(1)&&t<32;)t++;if(t>=32)throw new Error("Invalid exponential-Golomb code.");return(1<<t)-1+e.readBits(t)},ec=e=>{const t=Jl(e);return 1&t?t+1>>1:-(t>>1)},tc=e=>e.constructor===Uint8Array?e:e instanceof ArrayBuffer?new Uint8Array(e):new Uint8Array(e.buffer,e.byteOffset,e.byteLength),nc=e=>e.constructor===DataView?e:e instanceof ArrayBuffer?new DataView(e):new DataView(e.buffer,e.byteOffset,e.byteLength),ic=new TextDecoder,rc=e=>Object.fromEntries(Object.entries(e).map((([e,t])=>[t,e]))),oc={bt709:1,bt470bg:5,smpte170m:6,bt2020:9,smpte432:12},sc=rc(oc),ac={bt709:1,smpte170m:6,linear:8,"iec61966-2-1":13,pq:16,hlg:18},lc=rc(ac),cc={rgb:0,bt709:1,bt470bg:5,smpte170m:6,"bt2020-ncl":9},uc=rc(cc),dc=e=>[...e].map((e=>e.toString(16).padStart(2,"0"))).join(""),hc=e=>(e=(e=(e=(e=(e=e>>1&1431655765|(1431655765&e)<<1)>>2&858993459|(858993459&e)<<2)>>4&252645135|(252645135&e)<<4)>>8&16711935|(16711935&e)<<8)>>16&65535|(65535&e)<<16)>>>0,pc=(e,t,n)=>{let i=0,r=e.length-1,o=-1;for(;i<=r;){const s=i+r>>1,a=n(e[s]);a===t?(o=s,r=s-1):a<t?i=s+1:r=s-1}return o},fc=(e,t,n)=>{let i=0,r=e.length-1,o=-1;for(;i<=r;){const s=i+(r-i+1)/2|0;n(e[s])<=t?(o=s,i=s+1):r=s-1}return o},gc=()=>{let e,t;return{promise:new Promise(((n,i)=>{e=n,t=i})),resolve:e,reject:t}},mc=(e,t)=>{for(let n=e.length-1;n>=0;n--)if(t(e[n]))return n;return-1},yc=e=>{throw new Error(`Unexpected value: ${e}`)},vc=(e,t,n)=>e.getUint8(t)<<16|e.getUint8(t+1)<<8|e.getUint8(t+2),bc=(e,t,n)=>Math.max(t,Math.min(n,e)),wc="und",kc=e=>{const t=Math.round(e);return Math.abs(e/t-1)<10*Number.EPSILON?t:e},xc=/^[a-z]{3}$/,Sc=e=>xc.test(e),Cc=1e6*(1+Number.EPSILON),_c=e=>"number"==typeof e&&!Number.isNaN(e);class Ec{constructor(e,t){if(this.data=e,this.mimeType=t,!(e instanceof Uint8Array))throw new TypeError("data must be a Uint8Array.");if("string"!=typeof t)throw new TypeError("mimeType must be a string.")}}class Tc{constructor(e,t,n,i){if(this.data=e,this.mimeType=t,this.name=n,this.description=i,!(e instanceof Uint8Array))throw new TypeError("data must be a Uint8Array.");if(void 0!==t&&"string"!=typeof t)throw new TypeError("mimeType, when provided, must be a string.");if(void 0!==n&&"string"!=typeof n)throw new TypeError("name, when provided, must be a string.");if(void 0!==i&&"string"!=typeof i)throw new TypeError("description, when provided, must be a string.")}}const Pc={default:!0,forced:!1,original:!1,commentary:!1,hearingImpaired:!1,visuallyImpaired:!1},Ic=["pcm-s16","pcm-s16be","pcm-s24","pcm-s24be","pcm-s32","pcm-s32be","pcm-f32","pcm-f32be","pcm-f64","pcm-f64be","pcm-u8","pcm-s8","ulaw","alaw"],Ac=[{maxPictureSize:36864,maxBitrate:2e5,level:10},{maxPictureSize:73728,maxBitrate:8e5,level:11},{maxPictureSize:122880,maxBitrate:18e5,level:20},{maxPictureSize:245760,maxBitrate:36e5,level:21},{maxPictureSize:552960,maxBitrate:72e5,level:30},{maxPictureSize:983040,maxBitrate:12e6,level:31},{maxPictureSize:2228224,maxBitrate:18e6,level:40},{maxPictureSize:2228224,maxBitrate:3e7,level:41},{maxPictureSize:8912896,maxBitrate:6e7,level:50},{maxPictureSize:8912896,maxBitrate:12e7,level:51},{maxPictureSize:8912896,maxBitrate:18e7,level:52},{maxPictureSize:35651584,maxBitrate:18e7,level:60},{maxPictureSize:35651584,maxBitrate:24e7,level:61},{maxPictureSize:35651584,maxBitrate:48e7,level:62}],Oc=e=>{const{codec:t,codecDescription:n,colorSpace:i,avcCodecInfo:r,hevcCodecInfo:o,vp9CodecInfo:s,av1CodecInfo:a}=e;if("avc"===t){if(Kl(null!==e.avcType),r){const t=new Uint8Array([r.avcProfileIndication,r.profileCompatibility,r.avcLevelIndication]);return`avc${e.avcType}.${dc(t)}`}if(!n||n.byteLength<4)throw new TypeError("AVC decoder description is not provided or is not at least 4 bytes long.");return`avc${e.avcType}.${dc(n.subarray(1,4))}`}if("hevc"===t){let e,t,i,r,s,a;if(o)e=o.generalProfileSpace,t=o.generalProfileIdc,i=hc(o.generalProfileCompatibilityFlags),r=o.generalTierFlag,s=o.generalLevelIdc,a=[...o.generalConstraintIndicatorFlags];else{if(!n||n.byteLength<23)throw new TypeError("HEVC decoder description is not provided or is not at least 23 bytes long.");const o=nc(n),l=o.getUint8(1);e=l>>6&3,t=31&l,i=hc(o.getUint32(2)),r=l>>5&1,s=o.getUint8(12),a=[];for(let e=0;e<6;e++)a.push(o.getUint8(6+e))}let l="hev1.";for(l+=["","A","B","C"][e]+t,l+=".",l+=i.toString(16).toUpperCase(),l+=".",l+=0===r?"L":"H",l+=s;a.length>0&&0===a[a.length-1];)a.pop();return a.length>0&&(l+=".",l+=a.map((e=>e.toString(16).toUpperCase())).join(".")),l}if("vp8"===t)return"vp8";if("vp9"===t){if(!s){const t=e.width*e.height;let n=Ql(Ac).level;for(const e of Ac)if(t<=e.maxPictureSize){n=e.level;break}return`vp09.00.${n.toString().padStart(2,"0")}.08`}let t=`vp09.${s.profile.toString().padStart(2,"0")}.${s.level.toString().padStart(2,"0")}.${s.bitDepth.toString().padStart(2,"0")}.${s.chromaSubsampling.toString().padStart(2,"0")}`;return t+=`.${s.colourPrimaries.toString().padStart(2,"0")}.${s.transferCharacteristics.toString().padStart(2,"0")}.${s.matrixCoefficients.toString().padStart(2,"0")}.${s.videoFullRangeFlag.toString().padStart(2,"0")}`,t.endsWith(".01.01.01.01.00")&&(t=t.slice(0,-15)),t}if("av1"===t){if(!a){const t=e.width*e.height;let n=Ql(Ac).level;for(const e of Ac)if(t<=e.maxPictureSize){n=e.level;break}return`av01.0.${n.toString().padStart(2,"0")}M.08`}const t=a.profile,n=a.level.toString().padStart(2,"0"),r=a.tier?"H":"M",o=a.bitDepth.toString().padStart(2,"0"),s=null!=i&&i.primaries?oc[i.primaries]:1,l=null!=i&&i.transfer?ac[i.transfer]:1,c=null!=i&&i.matrix?cc[i.matrix]:1,u=null!=i&&i.fullRange?1:0;let d=`av01.${t}.${n}${r}.${o}`;return d+=`.${a.monochrome?"1":"0"}.${(100*a.chromaSubsamplingX+10*a.chromaSubsamplingY+1*(a.chromaSubsamplingX&&a.chromaSubsamplingY?a.chromaSamplePosition:0)).toString().padStart(3,"0")}`,d+=`.${s.toString().padStart(2,"0")}`,d+=`.${l.toString().padStart(2,"0")}`,d+=`.${c.toString().padStart(2,"0")}`,d+=`.${u}`,d.endsWith(".0.110.01.01.01.0")&&(d=d.slice(0,-17)),d}throw new TypeError(`Unhandled codec '${t}'.`)},Lc=e=>{const{codec:t,codecDescription:n,aacCodecInfo:i}=e;if("aac"===t){if(!i)throw new TypeError("AAC codec info must be provided.");return i.isMpeg2?"mp4a.67":`mp4a.40.${Dc(n).objectType}`}if("mp3"===t)return"mp3";if("opus"===t)return"opus";if("vorbis"===t)return"vorbis";if("flac"===t)return"flac";if(t&&Ic.includes(t))return t;throw new TypeError(`Unhandled codec '${t}'.`)},Nc=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],Rc=[-1,1,2,3,4,5,6,8],Dc=e=>{if(!e||e.byteLength<2)throw new TypeError("AAC description must be at least 2 bytes long.");const t=new Zl(e);let n=t.readBits(5);31===n&&(n=32+t.readBits(6));const i=t.readBits(4);let r=null;15===i?r=t.readBits(24):i<Nc.length&&(r=Nc[i]);const o=t.readBits(4);let s=null;return o>=1&&o<=7&&(s=Rc[o]),{objectType:n,frequencyIndex:i,sampleRate:r,channelConfiguration:o,numberOfChannels:s}},Mc=/^pcm-([usf])(\d+)+(be)?$/;var Fc,Bc;!function(e){e[e.IDR=5]="IDR",e[e.SPS=7]="SPS",e[e.PPS=8]="PPS",e[e.SPS_EXT=13]="SPS_EXT"}(Fc||(Fc={})),function(e){e[e.RASL_N=8]="RASL_N",e[e.RASL_R=9]="RASL_R",e[e.BLA_W_LP=16]="BLA_W_LP",e[e.RSV_IRAP_VCL23=23]="RSV_IRAP_VCL23",e[e.VPS_NUT=32]="VPS_NUT",e[e.SPS_NUT=33]="SPS_NUT",e[e.PPS_NUT=34]="PPS_NUT",e[e.PREFIX_SEI_NUT=39]="PREFIX_SEI_NUT",e[e.SUFFIX_SEI_NUT=40]="SUFFIX_SEI_NUT"}(Bc||(Bc={}));const Uc=e=>{const t=[];let n=0;for(;n<e.length;){let i=-1,r=0;for(let t=n;t<e.length-3;t++){if(0===e[t]&&0===e[t+1]&&1===e[t+2]){i=t,r=3;break}if(t<e.length-4&&0===e[t]&&0===e[t+1]&&0===e[t+2]&&1===e[t+3]){i=t,r=4;break}}if(-1===i)break;if(n>0&&i>n){const r=e.subarray(n,i);r.length>0&&t.push(r)}n=i+r}if(n<e.length){const i=e.subarray(n);i.length>0&&t.push(i)}return t},jc=(e,t)=>{const n=[];let i=0;const r=new DataView(e.buffer,e.byteOffset,e.byteLength);for(;i+t<=e.length;){let o;1===t?o=r.getUint8(i):2===t?o=r.getUint16(i,!1):3===t?o=vc(r,i):4===t?o=r.getUint32(i,!1):(yc(t),Kl(!1)),i+=t;const s=e.subarray(i,i+o);n.push(s),i+=o}return n},zc=e=>{const t=[],n=e.length;for(let i=0;i<n;i++)i+2<n&&0===e[i]&&0===e[i+1]&&3===e[i+2]?(t.push(0,0),i+=2):t.push(e[i]);return new Uint8Array(t)},Vc=e=>31&e[0],Wc=e=>{try{const t=Uc(e),n=t.filter((e=>Vc(e)===Fc.SPS)),i=t.filter((e=>Vc(e)===Fc.PPS)),r=t.filter((e=>Vc(e)===Fc.SPS_EXT));if(0===n.length)return null;if(0===i.length)return null;const o=Hc(n[0]);Kl(null!==o);const s=100===o.profileIdc||110===o.profileIdc||122===o.profileIdc||144===o.profileIdc;return{configurationVersion:1,avcProfileIndication:o.profileIdc,profileCompatibility:o.constraintFlags,avcLevelIndication:o.levelIdc,lengthSizeMinusOne:3,sequenceParameterSets:n,pictureParameterSets:i,chromaFormat:s?o.chromaFormatIdc:null,bitDepthLumaMinus8:s?o.bitDepthLumaMinus8:null,bitDepthChromaMinus8:s?o.bitDepthChromaMinus8:null,sequenceParameterSetExt:s?r:null}}catch(e){return console.error("Error building AVC Decoder Configuration Record:",e),null}},Hc=e=>{try{const t=new Zl(zc(e));if(t.skipBits(1),t.skipBits(2),7!==t.readBits(5))return null;const n=t.readAlignedByte(),i=t.readAlignedByte(),r=t.readAlignedByte();Jl(t);let o=null,s=null,a=null;if((100===n||110===n||122===n||244===n||44===n||83===n||86===n||118===n||128===n)&&(o=Jl(t),3===o&&t.skipBits(1),s=Jl(t),a=Jl(t),t.skipBits(1),t.readBits(1)))for(let e=0;e<(3!==o?8:12);e++)if(t.readBits(1)){const n=e<6?16:64;let i=8,r=8;for(let e=0;e<n;e++)0!==r&&(r=(i+ec(t)+256)%256),i=0===r?i:r}Jl(t);const l=Jl(t);if(0===l)Jl(t);else if(1===l){t.skipBits(1),ec(t),ec(t);const e=Jl(t);for(let n=0;n<e;n++)ec(t)}return Jl(t),t.skipBits(1),Jl(t),Jl(t),{profileIdc:n,constraintFlags:i,levelIdc:r,frameMbsOnlyFlag:t.readBits(1),chromaFormatIdc:o,bitDepthLumaMinus8:s,bitDepthChromaMinus8:a}}catch(e){return console.error("Error parsing AVC SPS:",e),null}},$c=e=>e[0]>>1&63,Gc=e=>{try{const t=Uc(e),n=t.filter((e=>$c(e)===Bc.VPS_NUT)),i=t.filter((e=>$c(e)===Bc.SPS_NUT)),r=t.filter((e=>$c(e)===Bc.PPS_NUT)),o=t.filter((e=>$c(e)===Bc.PREFIX_SEI_NUT||$c(e)===Bc.SUFFIX_SEI_NUT));if(0===i.length||0===r.length)return null;const s=new Zl(zc(i[0]));s.skipBits(16),s.readBits(4);const a=s.readBits(3),l=s.readBits(1),{general_profile_space:c,general_tier_flag:u,general_profile_idc:d,general_profile_compatibility_flags:h,general_constraint_indicator_flags:p,general_level_idc:f}=qc(s,a);Jl(s);const g=Jl(s);3===g&&s.skipBits(1),Jl(s),Jl(s),s.readBits(1)&&(Jl(s),Jl(s),Jl(s),Jl(s));const m=Jl(s),y=Jl(s);Jl(s);for(let e=s.readBits(1)?0:a;e<=a;e++)Jl(s),Jl(s),Jl(s);Jl(s),Jl(s),Jl(s),Jl(s),Jl(s),Jl(s),s.readBits(1)&&s.readBits(1)&&Yc(s),s.skipBits(1),s.skipBits(1),s.readBits(1)&&(s.skipBits(4),s.skipBits(4),Jl(s),Jl(s),s.skipBits(1));const v=Jl(s);if(Kc(s,v),s.readBits(1)){const e=Jl(s);for(let t=0;t<e;t++)Jl(s),s.skipBits(1)}s.skipBits(1),s.skipBits(1);let b=0;s.readBits(1)&&(b=Qc(s,a));let w=0;if(r.length>0){const e=new Zl(zc(r[0]));e.skipBits(16),Jl(e),Jl(e),e.skipBits(1),e.skipBits(1),e.skipBits(3),e.skipBits(1),e.skipBits(1),Jl(e),Jl(e),ec(e),e.skipBits(1),e.skipBits(1),e.readBits(1)&&Jl(e),ec(e),ec(e),e.skipBits(1),e.skipBits(1),e.skipBits(1),e.skipBits(1);const t=e.readBits(1),n=e.readBits(1);w=t||n?t&&!n?2:!t&&n?3:0:0}return{configurationVersion:1,generalProfileSpace:c,generalTierFlag:u,generalProfileIdc:d,generalProfileCompatibilityFlags:h,generalConstraintIndicatorFlags:p,generalLevelIdc:f,minSpatialSegmentationIdc:b,parallelismType:w,chromaFormatIdc:g,bitDepthLumaMinus8:m,bitDepthChromaMinus8:y,avgFrameRate:0,constantFrameRate:0,numTemporalLayers:a+1,temporalIdNested:l,lengthSizeMinusOne:3,arrays:[...n.length?[{arrayCompleteness:1,nalUnitType:Bc.VPS_NUT,nalUnits:n}]:[],...i.length?[{arrayCompleteness:1,nalUnitType:Bc.SPS_NUT,nalUnits:i}]:[],...r.length?[{arrayCompleteness:1,nalUnitType:Bc.PPS_NUT,nalUnits:r}]:[],...o.length?[{arrayCompleteness:1,nalUnitType:$c(o[0]),nalUnits:o}]:[]]}}catch(e){return console.error("Error building HEVC Decoder Configuration Record:",e),null}},qc=(e,t)=>{const n=e.readBits(2),i=e.readBits(1),r=e.readBits(5);let o=0;for(let t=0;t<32;t++)o=o<<1|e.readBits(1);const s=new Uint8Array(6);for(let t=0;t<6;t++)s[t]=e.readBits(8);const a=e.readBits(8),l=[],c=[];for(let n=0;n<t;n++)l.push(e.readBits(1)),c.push(e.readBits(1));if(t>0)for(let n=t;n<8;n++)e.skipBits(2);for(let n=0;n<t;n++)l[n]&&e.skipBits(88),c[n]&&e.skipBits(8);return{general_profile_space:n,general_tier_flag:i,general_profile_idc:r,general_profile_compatibility_flags:o,general_constraint_indicator_flags:s,general_level_idc:a}},Yc=e=>{for(let t=0;t<4;t++)for(let n=0;n<(3===t?2:6);n++)if(e.readBits(1)){const n=Math.min(64,1<<4+(t<<1));t>1&&ec(e);for(let t=0;t<n;t++)ec(e)}else Jl(e)},Kc=(e,t)=>{const n=[];for(let i=0;i<t;i++)n[i]=Xc(e,i,t,n)},Xc=(e,t,n,i)=>{let r=0,o=0,s=0;if(0!==t&&(o=e.readBits(1)),o){var a;s=t===n?t-(Jl(e)+1):t-1,e.readBits(1),Jl(e);const o=null!==(a=i[s])&&void 0!==a?a:0;for(let t=0;t<=o;t++)e.readBits(1)||e.readBits(1);r=i[s]}else{const t=Jl(e),n=Jl(e);for(let n=0;n<t;n++)Jl(e),e.readBits(1);for(let t=0;t<n;t++)Jl(e),e.readBits(1);r=t+n}return r},Qc=(e,t)=>{if(e.readBits(1)&&255===e.readBits(8)&&(e.readBits(16),e.readBits(16)),e.readBits(1)&&e.readBits(1),e.readBits(1)&&(e.readBits(3),e.readBits(1),e.readBits(1)&&(e.readBits(8),e.readBits(8),e.readBits(8))),e.readBits(1)&&(Jl(e),Jl(e)),e.readBits(1),e.readBits(1),e.readBits(1),e.readBits(1)&&(Jl(e),Jl(e),Jl(e),Jl(e)),e.readBits(1)&&(e.readBits(32),e.readBits(32),e.readBits(1)&&Jl(e),e.readBits(1)&&Zc(e,!0,t)),e.readBits(1)){e.readBits(1),e.readBits(1),e.readBits(1);const t=Jl(e);return Jl(e),Jl(e),Jl(e),Jl(e),t}return 0},Zc=(e,t,n)=>{let i=!1,r=!1,o=!1;i=1===e.readBits(1),r=1===e.readBits(1),(i||r)&&(o=1===e.readBits(1),o&&(e.readBits(8),e.readBits(5),e.readBits(1),e.readBits(5)),e.readBits(4),e.readBits(4),o&&e.readBits(4),e.readBits(5),e.readBits(5),e.readBits(5));for(let t=0;t<=n;t++){let t=!0;1===e.readBits(1)||(t=1===e.readBits(1));let n=!1;t?Jl(e):n=1===e.readBits(1);let s=1;n||(s=Jl(e)+1),i&&Jc(e,s,o),r&&Jc(e,s,o)}},Jc=(e,t,n)=>{for(let i=0;i<t;i++)Jl(e),Jl(e),n&&(Jl(e),Jl(e)),e.readBits(1)},eu=e=>{const t=new Zl(e);if(2!==t.readBits(2))return null;const n=t.readBits(1),i=(t.readBits(1)<<1)+n;if(3===i&&t.skipBits(1),1===t.readBits(1))return null;if(0!==t.readBits(1))return null;if(t.skipBits(2),4817730!==t.readBits(24))return null;let r=8;i>=2&&(r=t.readBits(1)?12:10);const o=t.readBits(3);let s=0,a=0;if(7!==o)if(a=t.readBits(1),1===i||3===i){const e=t.readBits(1),n=t.readBits(1);s=e||n?e&&!n?2:1:3,t.skipBits(1)}else s=1;else s=3,a=1;const l=(t.readBits(16)+1)*(t.readBits(16)+1);let c=Ql(Ac).level;for(const e of Ac)if(l<=e.maxPictureSize){c=e.level;break}return{profile:i,level:c,bitDepth:r,chromaSubsampling:s,videoFullRangeFlag:a,colourPrimaries:2===o?1:1===o?6:2,transferCharacteristics:2===o?1:1===o?6:2,matrixCoefficients:7===o?0:2===o?1:1===o?6:2}},tu=function*(e){const t=new Zl(e),n=()=>{let e=0;for(let n=0;n<8;n++){const i=t.readAlignedByte();if(e|=(127&i)<<7*n,!(128&i))break;if(7===n&&128&i)return null}return e>=2**32-1?null:e};for(;t.getBitsLeft()>=8;){t.skipBits(1);const i=t.readBits(4),r=t.readBits(1),o=t.readBits(1);let s;if(t.skipBits(1),r&&t.skipBits(8),o){const e=n();if(null===e)return;s=e}else s=Math.floor(t.getBitsLeft()/8);Kl(t.pos%8==0),yield{type:i,data:e.subarray(t.pos/8,t.pos/8+s)},t.skipBits(8*s)}},nu=e=>{for(const{type:t,data:n}of tu(e)){if(1!==t)continue;const e=new Zl(n),i=e.readBits(3);e.readBits(1);let r=0,o=0,s=0;if(e.readBits(1))r=e.readBits(5);else{if(e.readBits(1)&&(e.skipBits(32),e.skipBits(32),e.readBits(1)))return null;const t=e.readBits(1);t&&(s=e.readBits(5),e.skipBits(32),e.skipBits(5),e.skipBits(5));const n=e.readBits(5);for(let i=0;i<=n;i++){e.skipBits(12);const n=e.readBits(5);if(0===i&&(r=n),n>7){const t=e.readBits(1);0===i&&(o=t)}if(t&&e.readBits(1)){const t=s+1;e.skipBits(t),e.skipBits(t),e.skipBits(1)}e.readBits(1)&&e.skipBits(4)}}const a=e.readBits(1);let l=8;2===i&&a?l=e.readBits(1)?12:10:i<=2&&(l=a?10:8);let c=0;1!==i&&(c=e.readBits(1));let u=1,d=1,h=0;return c||(0===i?(u=1,d=1):1===i?(u=0,d=0):12===l&&(u=e.readBits(1),u&&(d=e.readBits(1))),u&&d&&(h=e.readBits(2))),{profile:i,level:r,tier:o,bitDepth:l,monochrome:c,chromaSubsamplingX:u,chromaSubsamplingY:d,chromaSamplePosition:h}}return null};var iu;!function(e){e[e.STREAMINFO=0]="STREAMINFO",e[e.VORBIS_COMMENT=4]="VORBIS_COMMENT",e[e.PICTURE=6]="PICTURE"}(iu||(iu={}));class ru{constructor(e){this.input=e}}const ou=[],su=[],au=new Uint8Array(0);class lu{constructor(e,t,n,i,r=-1,o,s){if(this.data=e,this.type=t,this.timestamp=n,this.duration=i,this.sequenceNumber=r,e===au&&void 0===o)throw new Error("Internal error: byteLength must be explicitly provided when constructing metadata-only packets.");if(void 0===o&&(o=e.byteLength),!(e instanceof Uint8Array))throw new TypeError("data must be a Uint8Array.");if("key"!==t&&"delta"!==t)throw new TypeError('type must be either "key" or "delta".');if(!Number.isFinite(n))throw new TypeError("timestamp must be a number.");if(!Number.isFinite(i)||i<0)throw new TypeError("duration must be a non-negative number.");if(!Number.isFinite(r))throw new TypeError("sequenceNumber must be a number.");if(!Number.isInteger(o)||o<0)throw new TypeError("byteLength must be a non-negative integer.");if(void 0!==s&&("object"!=typeof s||!s))throw new TypeError("sideData, when provided, must be an object.");if(void 0!==(null==s?void 0:s.alpha)&&!(s.alpha instanceof Uint8Array))throw new TypeError("sideData.alpha, when provided, must be a Uint8Array.");if(void 0!==(null==s?void 0:s.alphaByteLength)&&(!Number.isInteger(s.alphaByteLength)||s.alphaByteLength<0))throw new TypeError("sideData.alphaByteLength, when provided, must be a non-negative integer.");this.byteLength=o,this.sideData=null!=s?s:{},this.sideData.alpha&&void 0===this.sideData.alphaByteLength&&(this.sideData.alphaByteLength=this.sideData.alpha.byteLength)}get isMetadataOnly(){return this.data===au}get microsecondTimestamp(){return Math.trunc(Cc*this.timestamp)}get microsecondDuration(){return Math.trunc(Cc*this.duration)}toEncodedVideoChunk(){if(this.isMetadataOnly)throw new TypeError("Metadata-only packets cannot be converted to a video chunk.");if("undefined"==typeof EncodedVideoChunk)throw new Error("Your browser does not support EncodedVideoChunk.");return new EncodedVideoChunk({data:this.data,type:this.type,timestamp:this.microsecondTimestamp,duration:this.microsecondDuration})}alphaToEncodedVideoChunk(e=this.type){if(!this.sideData.alpha)throw new TypeError("This packet does not contain alpha side data.");if(this.isMetadataOnly)throw new TypeError("Metadata-only packets cannot be converted to a video chunk.");if("undefined"==typeof EncodedVideoChunk)throw new Error("Your browser does not support EncodedVideoChunk.");return new EncodedVideoChunk({data:this.sideData.alpha,type:e,timestamp:this.microsecondTimestamp,duration:this.microsecondDuration})}toEncodedAudioChunk(){if(this.isMetadataOnly)throw new TypeError("Metadata-only packets cannot be converted to an audio chunk.");if("undefined"==typeof EncodedAudioChunk)throw new Error("Your browser does not support EncodedAudioChunk.");return new EncodedAudioChunk({data:this.data,type:this.type,timestamp:this.microsecondTimestamp,duration:this.microsecondDuration})}static fromEncodedChunk(e,t){var n;if(!(e instanceof EncodedVideoChunk||e instanceof EncodedAudioChunk))throw new TypeError("chunk must be an EncodedVideoChunk or EncodedAudioChunk.");const i=new Uint8Array(e.byteLength);return e.copyTo(i),new lu(i,e.type,e.timestamp/1e6,(null!==(n=e.duration)&&void 0!==n?n:0)/1e6,void 0,void 0,t)}clone(e){var t,n;if(void 0!==e&&("object"!=typeof e||null===e))throw new TypeError("options, when provided, must be an object.");if(void 0!==(null==e?void 0:e.timestamp)&&!Number.isFinite(e.timestamp))throw new TypeError("options.timestamp, when provided, must be a number.");if(void 0!==(null==e?void 0:e.duration)&&!Number.isFinite(e.duration))throw new TypeError("options.duration, when provided, must be a number.");return new lu(this.data,this.type,null!==(t=null==e?void 0:e.timestamp)&&void 0!==t?t:this.timestamp,null!==(n=null==e?void 0:e.duration)&&void 0!==n?n:this.duration,this.sequenceNumber,this.byteLength)}}const cu=e=>{if(!e||"object"!=typeof e)throw new TypeError("options must be an object.");if(void 0!==e.metadataOnly&&"boolean"!=typeof e.metadataOnly)throw new TypeError("options.metadataOnly, when defined, must be a boolean.");if(void 0!==e.verifyKeyPackets&&"boolean"!=typeof e.verifyKeyPackets)throw new TypeError("options.verifyKeyPackets, when defined, must be a boolean.");if(e.verifyKeyPackets&&e.metadataOnly)throw new TypeError("options.verifyKeyPackets and options.metadataOnly cannot be enabled together.")},uu=e=>{if(!_c(e))throw new TypeError("timestamp must be a number.")},du=(e,t,n)=>n.verifyKeyPackets?t.then((async t=>{if(!t||"delta"===t.type)return t;const n=await e.determinePacketType(t);return n&&(t.type=n),t})):t;class hu{constructor(e){if(!(e instanceof pu))throw new TypeError("track must be an InputTrack.");this._track=e}getFirstPacket(e={}){if(cu(e),this._track.input._disposed)throw new fd;return du(this._track,this._track._backing.getFirstPacket(e),e)}getPacket(e,t={}){if(uu(e),cu(t),this._track.input._disposed)throw new fd;return du(this._track,this._track._backing.getPacket(e,t),t)}getNextPacket(e,t={}){if(!(e instanceof lu))throw new TypeError("packet must be an EncodedPacket.");if(cu(t),this._track.input._disposed)throw new fd;return du(this._track,this._track._backing.getNextPacket(e,t),t)}async getKeyPacket(e,t={}){if(uu(e),cu(t),this._track.input._disposed)throw new fd;if(!t.verifyKeyPackets)return this._track._backing.getKeyPacket(e,t);const n=await this._track._backing.getKeyPacket(e,t);return n&&"delta"!==n.type&&"delta"===await this._track.determinePacketType(n)?this.getKeyPacket(n.timestamp-1/this._track.timeResolution,t):n}async getNextKeyPacket(e,t={}){if(!(e instanceof lu))throw new TypeError("packet must be an EncodedPacket.");if(cu(t),this._track.input._disposed)throw new fd;if(!t.verifyKeyPackets)return this._track._backing.getNextKeyPacket(e,t);const n=await this._track._backing.getNextKeyPacket(e,t);return n&&"delta"!==n.type&&"delta"===await this._track.determinePacketType(n)?this.getNextKeyPacket(n,t):n}packets(e,t,n={}){if(void 0!==e&&!(e instanceof lu))throw new TypeError("startPacket must be an EncodedPacket.");if(void 0!==e&&e.isMetadataOnly&&(null==n||!n.metadataOnly))throw new TypeError("startPacket can only be metadata-only if options.metadataOnly is enabled.");if(void 0!==t&&!(t instanceof lu))throw new TypeError("endPacket must be an EncodedPacket.");if(cu(n),this._track.input._disposed)throw new fd;const i=[];let{promise:r,resolve:o}=gc(),{promise:s,resolve:a}=gc(),l=!1,c=!1,u=null;const d=[];(async()=>{let u=null!=e?e:await this.getFirstPacket(n);for(;u&&!c&&!this._track.input._disposed&&!(t&&u.sequenceNumber>=(null==t?void 0:t.sequenceNumber));)i.length>Math.max(2,d.length)?(({promise:s,resolve:a}=gc()),await s):(i.push(u),o(),({promise:r,resolve:o}=gc()),u=await this.getNextPacket(u,n));l=!0,o()})().catch((e=>{u||(u=e,o())}));const h=this._track;return{async next(){for(;;){if(h.input._disposed)throw new fd;if(c)return{value:void 0,done:!0};if(u)throw u;if(i.length>0){const e=i.shift(),t=performance.now();for(d.push(t);d.length>0&&t-d[0]>=1e3;)d.shift();return a(),{value:e,done:!1}}if(l)return{value:void 0,done:!0};await r}},return:async()=>(c=!0,a(),o(),{value:void 0,done:!0}),async throw(e){throw e},[Symbol.asyncIterator](){return this}}}}class pu{constructor(e,t){this.input=e,this._backing=t}isVideoTrack(){return this instanceof fu}isAudioTrack(){return this instanceof gu}get id(){return this._backing.getId()}get internalCodecId(){return this._backing.getInternalCodecId()}get languageCode(){return this._backing.getLanguageCode()}get name(){return this._backing.getName()}get timeResolution(){return this._backing.getTimeResolution()}get disposition(){return this._backing.getDisposition()}getFirstTimestamp(){return this._backing.getFirstTimestamp()}computeDuration(){return this._backing.computeDuration()}async computePacketStats(e=1/0){const t=new hu(this);let n=1/0,i=-1/0,r=0,o=0;for await(const s of t.packets(void 0,void 0,{metadataOnly:!0})){if(r>=e&&s.timestamp>=i)break;n=Math.min(n,s.timestamp),i=Math.max(i,s.timestamp+s.duration),r++,o+=s.byteLength}return{packetCount:r,averagePacketRate:r?Number((r/(i-n)).toPrecision(16)):0,averageBitrate:r?Number((8*o/(i-n)).toPrecision(16)):0}}}class fu extends pu{constructor(e,t){super(e,t),this._backing=t}get type(){return"video"}get codec(){return this._backing.getCodec()}get codedWidth(){return this._backing.getCodedWidth()}get codedHeight(){return this._backing.getCodedHeight()}get rotation(){return this._backing.getRotation()}get displayWidth(){return this._backing.getRotation()%180==0?this._backing.getCodedWidth():this._backing.getCodedHeight()}get displayHeight(){return this._backing.getRotation()%180==0?this._backing.getCodedHeight():this._backing.getCodedWidth()}getColorSpace(){return this._backing.getColorSpace()}async hasHighDynamicRange(){const e=await this._backing.getColorSpace();return"bt2020"===e.primaries||"smpte432"===e.primaries||"pg"===e.transfer||"hlg"===e.transfer||"bt2020-ncl"===e.matrix}canBeTransparent(){return this._backing.canBeTransparent()}getDecoderConfig(){return this._backing.getDecoderConfig()}async getCodecParameterString(){var e;const t=await this._backing.getDecoderConfig();return null!==(e=null==t?void 0:t.codec)&&void 0!==e?e:null}async canDecode(){try{const e=await this._backing.getDecoderConfig();if(!e)return!1;const t=this._backing.getCodec();return Kl(null!==t),!!ou.some((n=>n.supports(t,e)))||"undefined"!=typeof VideoDecoder&&!0===(await VideoDecoder.isConfigSupported(e)).supported}catch(e){return console.error("Error during decodability check:",e),!1}}async determinePacketType(e){if(!(e instanceof lu))throw new TypeError("packet must be an EncodedPacket.");if(e.isMetadataOnly)throw new TypeError("packet must not be metadata-only to determine its type.");if(null===this.codec)return null;const t=await this.getDecoderConfig();return Kl(t),((e,t,n)=>{switch(e){case"avc":{const e=((e,t)=>{if(t.description){const n=tc(t.description);return jc(e,1+(3&n[4]))}return Uc(e)})(n,t),i=e.some((e=>Vc(e)===Fc.IDR));return i?"key":"delta"}case"hevc":{const e=((e,t)=>{if(t.description){const n=tc(t.description);return jc(e,1+(3&n[21]))}return Uc(e)})(n,t),i=e.some((e=>{const t=$c(e);return Bc.BLA_W_LP<=t&&t<=Bc.RSV_IRAP_VCL23}));return i?"key":"delta"}case"vp8":return 1&n[0]?"delta":"key";case"vp9":{const e=new Zl(n);if(2!==e.readBits(2))return null;const t=e.readBits(1);return 3===(e.readBits(1)<<1)+t&&e.skipBits(1),e.readBits(1)?null:0===e.readBits(1)?"key":"delta"}case"av1":{let e=!1;for(const{type:t,data:i}of tu(n))if(1===t){const t=new Zl(i);t.skipBits(4),e=!!t.readBits(1)}else if(3===t||6===t||7===t){if(e)return"key";const t=new Zl(i);return t.readBits(1)?null:0===t.readBits(2)?"key":"delta"}return null}default:yc(e),Kl(!1)}})(this.codec,t,e.data)}}class gu extends pu{constructor(e,t){super(e,t),this._backing=t}get type(){return"audio"}get codec(){return this._backing.getCodec()}get numberOfChannels(){return this._backing.getNumberOfChannels()}get sampleRate(){return this._backing.getSampleRate()}getDecoderConfig(){return this._backing.getDecoderConfig()}async getCodecParameterString(){var e;const t=await this._backing.getDecoderConfig();return null!==(e=null==t?void 0:t.codec)&&void 0!==e?e:null}async canDecode(){try{const e=await this._backing.getDecoderConfig();if(!e)return!1;const t=this._backing.getCodec();return Kl(null!==t),!!su.some((n=>n.supports(t,e)))||(!!e.codec.startsWith("pcm-")||"undefined"!=typeof AudioDecoder&&!0===(await AudioDecoder.isConfigSupported(e)).supported)}catch(e){return console.error("Error during decodability check:",e),!1}}async determinePacketType(e){if(!(e instanceof lu))throw new TypeError("packet must be an EncodedPacket.");return null===this.codec?null:"key"}}const mu=e=>{let t=Sd(e);const n=Id(e,4);let i=8;1===t&&(t=_d(e),i=16);const r=t-i;return r<0?null:{name:n,totalSize:t,headerSize:i,contentSize:r}},yu=e=>Cd(e)/65536,vu=e=>Cd(e)/1073741824,bu=e=>{let t=0;for(let n=0;n<4;n++){t<<=7;const n=bd(e);if(t|=127&n,!(128&n))break}return t},wu=e=>{let t=wd(e);return e.skip(2),t=Math.min(t,e.remainingLength),ic.decode(vd(e,t))},ku=e=>{const t=mu(e);if(!t||"data"!==t.name)return null;if(e.remainingLength<8)return null;const n=Sd(e);e.skip(4);const i=vd(e,t.contentSize-8);switch(n){case 1:return ic.decode(i);case 2:return new TextDecoder("utf-16be").decode(i);case 13:return new Ec(i,"image/jpeg");case 14:return new Ec(i,"image/png");case 27:return new Ec(i,"image/bmp");default:return i}};class xu extends ru{constructor(e){super(e),this.moovSlice=null,this.currentTrack=null,this.tracks=[],this.metadataPromise=null,this.movieTimescale=-1,this.movieDurationInTimescale=-1,this.isQuickTime=!1,this.metadataTags={},this.currentMetadataKeys=null,this.isFragmented=!1,this.fragmentTrackDefaults=[],this.currentFragment=null,this.lastReadFragment=null,this.reader=e._reader}async computeDuration(){const e=await this.getTracks(),t=await Promise.all(e.map((e=>e.computeDuration())));return Math.max(0,...t)}async getTracks(){return await this.readMetadata(),this.tracks.map((e=>e.inputTrack))}async getMimeType(){await this.readMetadata();const e=await Promise.all(this.tracks.map((e=>e.inputTrack.getCodecParameterString())));return(e=>{let t=(e.hasVideo?"video/":e.hasAudio?"audio/":"application/")+(e.isQuickTime?"quicktime":"mp4");return e.codecStrings.length>0&&(t+=`; codecs="${[...new Set(e.codecStrings)].join(", ")}"`),t})({isQuickTime:this.isQuickTime,hasVideo:this.tracks.some((e=>{var t;return"video"===(null===(t=e.info)||void 0===t?void 0:t.type)})),hasAudio:this.tracks.some((e=>{var t;return"audio"===(null===(t=e.info)||void 0===t?void 0:t.type)})),codecStrings:e.filter(Boolean)})}async getMetadataTags(){return await this.readMetadata(),this.metadataTags}readMetadata(){return this.metadataPromise??=(async()=>{let e=0;for(;;){let t=this.reader.requestSliceRange(e,8,16);if(t instanceof Promise&&(t=await t),!t)break;const n=e,i=mu(t);if(!i)break;if("ftyp"===i.name){const e=Id(t,4);this.isQuickTime="qt  "===e}else if("moov"===i.name){let e=this.reader.requestSlice(t.filePos,i.contentSize);if(e instanceof Promise&&(e=await e),!e)break;this.moovSlice=e,this.readContiguousBoxes(this.moovSlice),this.tracks.sort(((e,t)=>Number(t.disposition.default)-Number(e.disposition.default)));for(const e of this.tracks)e.editListOffset-=Math.round(e.editListPreviousSegmentDurations/this.movieTimescale*e.timescale);break}e=n+i.totalSize}if(this.isFragmented&&null!==this.reader.fileSize){let e=this.reader.requestSlice(this.reader.fileSize-4,4);e instanceof Promise&&(e=await e),Kl(e);const t=Sd(e),n=this.reader.fileSize-t;if(n>=0&&n<=this.reader.fileSize-16){let e=this.reader.requestSliceRange(n,8,16);if(e instanceof Promise&&(e=await e),e){const t=mu(e);if(t&&"mfra"===t.name){let n=this.reader.requestSlice(e.filePos,t.contentSize);n instanceof Promise&&(n=await n),n&&this.readContiguousBoxes(n)}}}}})()}getSampleTableForTrack(e){var t;if(e.sampleTable)return e.sampleTable;const n={sampleTimingEntries:[],sampleCompositionTimeOffsets:[],sampleSizes:[],keySampleIndices:null,chunkOffsets:[],sampleToChunk:[],presentationTimestamps:null,presentationTimestampIndexMap:null};e.sampleTable=n,Kl(this.moovSlice);const i=this.moovSlice.slice(e.sampleTableByteOffset);if(this.currentTrack=e,this.traverseBox(i),this.currentTrack=null,"audio"===(null===(t=e.info)||void 0===t?void 0:t.type)&&e.info.codec&&Ic.includes(e.info.codec)&&0===n.sampleCompositionTimeOffsets.length){var r;Kl("audio"===(null===(r=e.info)||void 0===r?void 0:r.type));const t=(e=>{if(Kl(Ic.includes(e)),"ulaw"===e)return{dataType:"ulaw",sampleSize:1,littleEndian:!0,silentValue:255};if("alaw"===e)return{dataType:"alaw",sampleSize:1,littleEndian:!0,silentValue:213};const t=Mc.exec(e);let n;return Kl(t),n="u"===t[1]?"unsigned":"s"===t[1]?"signed":"float",{dataType:n,sampleSize:Number(t[2])/8,littleEndian:"be"!==t[3],silentValue:"pcm-u8"===e?128:0}})(e.info.codec),i=[],o=[];for(let r=0;r<n.sampleToChunk.length;r++){const s=n.sampleToChunk[r],a=n.sampleToChunk[r+1],l=(a?a.startChunkIndex:n.chunkOffsets.length)-s.startChunkIndex;for(let r=0;r<l;r++){const a=s.startSampleIndex+r*s.samplesPerChunk,l=a+s.samplesPerChunk,c=fc(n.sampleTimingEntries,a,(e=>e.startIndex)),u=n.sampleTimingEntries[c],d=fc(n.sampleTimingEntries,l,(e=>e.startIndex)),h=n.sampleTimingEntries[d],p=u.startDecodeTimestamp+(a-u.startIndex)*u.delta,f=h.startDecodeTimestamp+(l-h.startIndex)*h.delta-p,g=Ql(i);g&&g.delta===f?g.count++:i.push({startIndex:s.startChunkIndex+r,startDecodeTimestamp:p,count:1,delta:f}),o.push(s.samplesPerChunk*t.sampleSize*e.info.numberOfChannels)}s.startSampleIndex=s.startChunkIndex,s.samplesPerChunk=1}n.sampleTimingEntries=i,n.sampleSizes=o}if(n.sampleCompositionTimeOffsets.length>0){n.presentationTimestamps=[];for(const e of n.sampleTimingEntries)for(let t=0;t<e.count;t++)n.presentationTimestamps.push({presentationTimestamp:e.startDecodeTimestamp+t*e.delta,sampleIndex:e.startIndex+t});for(const e of n.sampleCompositionTimeOffsets)for(let t=0;t<e.count;t++){const i=n.presentationTimestamps[e.startIndex+t];i&&(i.presentationTimestamp+=e.offset)}n.presentationTimestamps.sort(((e,t)=>e.presentationTimestamp-t.presentationTimestamp)),n.presentationTimestampIndexMap=Array(n.presentationTimestamps.length).fill(-1);for(let e=0;e<n.presentationTimestamps.length;e++)n.presentationTimestampIndexMap[n.presentationTimestamps[e].sampleIndex]=e}return n}async readFragment(e){var t;if((null===(t=this.lastReadFragment)||void 0===t?void 0:t.moofOffset)===e)return this.lastReadFragment;let n=this.reader.requestSliceRange(e,8,16);n instanceof Promise&&(n=await n),Kl(n);const i=mu(n);Kl("moof"===(null==i?void 0:i.name));let r=this.reader.requestSlice(e,i.totalSize);r instanceof Promise&&(r=await r),Kl(r),this.traverseBox(r);const o=this.lastReadFragment;Kl(o&&o.moofOffset===e);for(const[,e]of o.trackData){const t=e.track,{fragmentPositionCache:n}=t;if(!e.startTimestampIsFinal){const i=t.fragmentLookupTable.find((e=>e.moofOffset===o.moofOffset));if(i)Au(e,i.timestamp);else{const t=fc(n,o.moofOffset-1,(e=>e.moofOffset));-1!==t&&Au(e,n[t].endTimestamp)}e.startTimestampIsFinal=!0}const i=fc(n,e.startTimestamp,(e=>e.startTimestamp));-1!==i&&n[i].moofOffset===o.moofOffset||n.splice(i+1,0,{moofOffset:o.moofOffset,startTimestamp:e.startTimestamp,endTimestamp:e.endTimestamp})}return o}readContiguousBoxes(e){const t=e.filePos;for(;e.filePos-t<=e.length-8&&this.traverseBox(e););}*iterateContiguousBoxes(e){const t=e.filePos;for(;e.filePos-t<=e.length-8;){const t=e.filePos,n=mu(e);if(!n)break;yield{boxInfo:n,slice:e},e.filePos=t+n.totalSize}}traverseBox(e){const t=e.filePos,n=mu(e);if(!n)return!1;const i=e.filePos,r=t+n.totalSize;switch(n.name){case"mdia":case"minf":case"dinf":case"mfra":case"edts":case"wave":this.readContiguousBoxes(e.slice(i,n.contentSize));break;case"mvhd":{const t=bd(e);e.skip(3),1===t?(e.skip(16),this.movieTimescale=Sd(e),this.movieDurationInTimescale=_d(e)):(e.skip(8),this.movieTimescale=Sd(e),this.movieDurationInTimescale=Sd(e))}break;case"trak":{const t={id:-1,demuxer:this,inputTrack:null,disposition:{...Pc},info:null,timescale:-1,durationInMovieTimescale:-1,durationInMediaTimescale:-1,rotation:0,internalCodecId:null,name:null,languageCode:wc,sampleTableByteOffset:-1,sampleTable:null,fragmentLookupTable:[],currentFragmentState:null,fragmentPositionCache:[],editListPreviousSegmentDurations:0,editListOffset:0};this.currentTrack=t,this.readContiguousBoxes(e.slice(i,n.contentSize)),-1!==t.id&&-1!==t.timescale&&null!==t.info&&("video"===t.info.type&&-1!==t.info.width?(t.inputTrack=new fu(this.input,new Cu(t)),this.tracks.push(t)):"audio"===t.info.type&&-1!==t.info.numberOfChannels&&(t.inputTrack=new gu(this.input,new _u(t)),this.tracks.push(t))),this.currentTrack=null}break;case"tkhd":{const t=this.currentTrack;if(!t)break;const n=bd(e),i=kd(e);if(t.disposition.default=!!(1&i),0===n)e.skip(8),t.id=Sd(e),e.skip(4),t.durationInMovieTimescale=Sd(e);else{if(1!==n)throw new Error(`Incorrect track header version ${n}.`);e.skip(16),t.id=Sd(e),e.skip(4),t.durationInMovieTimescale=_d(e)}e.skip(16);const r=[yu(e),yu(e),vu(e),yu(e),yu(e),vu(e),yu(e),yu(e),vu(e)],o=Xl((y=Ou(r),90*Math.round(y/90)));Kl(0===o||90===o||180===o||270===o),t.rotation=o}break;case"elst":{const t=this.currentTrack;if(!t)break;const n=bd(e);e.skip(3);let i=!1,r=0;const o=Sd(e);for(let s=0;s<o;s++){const o=1===n?_d(e):Sd(e),s=1===n?Ed(e):Cd(e),a=yu(e);if(0!==o){if(i){console.warn("Unsupported edit list: multiple edits are not currently supported. Only using first edit.");break}if(-1!==s){if(1!==a){console.warn("Unsupported edit list entry: media rate must be 1.");break}t.editListPreviousSegmentDurations=r,t.editListOffset=s,i=!0}else r+=o}}}break;case"mdhd":{const t=this.currentTrack;if(!t)break;const n=bd(e);e.skip(3),0===n?(e.skip(8),t.timescale=Sd(e),t.durationInMediaTimescale=Sd(e)):1===n&&(e.skip(16),t.timescale=Sd(e),t.durationInMediaTimescale=_d(e));let i=wd(e);if(i>0){t.languageCode="";for(let e=0;e<3;e++)t.languageCode=String.fromCharCode(96+(31&i))+t.languageCode,i>>=5;Sc(t.languageCode)||(t.languageCode=wc)}}break;case"hdlr":{const t=this.currentTrack;if(!t)break;e.skip(8);const n=Id(e,4);"vide"===n?t.info={type:"video",width:-1,height:-1,codec:null,codecDescription:null,colorSpace:null,avcType:null,avcCodecInfo:null,hevcCodecInfo:null,vp9CodecInfo:null,av1CodecInfo:null}:"soun"===n&&(t.info={type:"audio",numberOfChannels:-1,sampleRate:-1,codec:null,codecDescription:null,aacCodecInfo:null})}break;case"stbl":{const r=this.currentTrack;if(!r)break;r.sampleTableByteOffset=t,this.readContiguousBoxes(e.slice(i,n.contentSize))}break;case"stsd":{const t=this.currentTrack;if(!t)break;if(null===t.info||t.sampleTable)break;const n=bd(e);e.skip(3);const i=Sd(e);for(let r=0;r<i;r++){const i=e.filePos,r=mu(e);if(!r)break;t.internalCodecId=r.name;const o=r.name.toLowerCase();if("video"===t.info.type)"avc1"===o||"avc3"===o?(t.info.codec="avc",t.info.avcType="avc1"===o?1:3):"hvc1"===o||"hev1"===o?t.info.codec="hevc":"vp08"===o?t.info.codec="vp8":"vp09"===o?t.info.codec="vp9":"av01"===o?t.info.codec="av1":console.warn(`Unsupported video codec (sample entry type '${r.name}').`),e.skip(24),t.info.width=wd(e),t.info.height=wd(e),e.skip(50),this.readContiguousBoxes(e.slice(e.filePos,i+r.totalSize-e.filePos));else{"mp4a"===o||("opus"===o?t.info.codec="opus":"flac"===o?t.info.codec="flac":"twos"===o||"sowt"===o||"raw "===o||"in24"===o||"in32"===o||"fl32"===o||"fl64"===o||"lpcm"===o||"ipcm"===o||"fpcm"===o||("ulaw"===o?t.info.codec="ulaw":"alaw"===o?t.info.codec="alaw":console.warn(`Unsupported audio codec (sample entry type '${r.name}').`))),e.skip(8);const s=wd(e);e.skip(6);let a=wd(e),l=wd(e);e.skip(4);let c=Sd(e)/65536;if(0===n&&s>0)if(1===s)e.skip(4),l=8*Sd(e),e.skip(8);else if(2===s){e.skip(4),c=Pd(e),a=Sd(e),e.skip(4),l=Sd(e);const n=Sd(e);if(e.skip(8),"lpcm"===o){const e=l+7>>3,i=Boolean(1&n),r=Boolean(2&n),o=4&n?-1:0;l>0&&l<=64&&(i?32===l&&(t.info.codec=r?"pcm-f32be":"pcm-f32"):o&1<<e-1?1===e?t.info.codec="pcm-s8":2===e?t.info.codec=r?"pcm-s16be":"pcm-s16":3===e?t.info.codec=r?"pcm-s24be":"pcm-s24":4===e&&(t.info.codec=r?"pcm-s32be":"pcm-s32"):1===e&&(t.info.codec="pcm-u8")),null===t.info.codec&&console.warn("Unsupported PCM format.")}}"opus"===t.info.codec&&(c=48e3),t.info.numberOfChannels=a,t.info.sampleRate=c,"twos"===o?8===l?t.info.codec="pcm-s8":16===l?t.info.codec="pcm-s16be":(console.warn(`Unsupported sample size ${l} for codec 'twos'.`),t.info.codec=null):"sowt"===o?8===l?t.info.codec="pcm-s8":16===l?t.info.codec="pcm-s16":(console.warn(`Unsupported sample size ${l} for codec 'sowt'.`),t.info.codec=null):"raw "===o?t.info.codec="pcm-u8":"in24"===o?t.info.codec="pcm-s24be":"in32"===o?t.info.codec="pcm-s32be":"fl32"===o?t.info.codec="pcm-f32be":"fl64"===o?t.info.codec="pcm-f64be":"ipcm"===o?t.info.codec="pcm-s16be":"fpcm"===o&&(t.info.codec="pcm-f32be"),this.readContiguousBoxes(e.slice(e.filePos,i+r.totalSize-e.filePos))}}}break;case"avcC":{const t=this.currentTrack;if(!t)break;Kl(t.info),t.info.codecDescription=vd(e,n.contentSize)}break;case"hvcC":{const t=this.currentTrack;if(!t)break;Kl(t.info),t.info.codecDescription=vd(e,n.contentSize)}break;case"vpcC":{var o;const t=this.currentTrack;if(!t)break;Kl("video"===(null===(o=t.info)||void 0===o?void 0:o.type)),e.skip(4);const n=bd(e),i=bd(e),r=bd(e),s=r>>4,a=r>>1&7,l=1&r,c=bd(e),u=bd(e),d=bd(e);t.info.vp9CodecInfo={profile:n,level:i,bitDepth:s,chromaSubsampling:a,videoFullRangeFlag:l,colourPrimaries:c,transferCharacteristics:u,matrixCoefficients:d}}break;case"av1C":{var s;const t=this.currentTrack;if(!t)break;Kl("video"===(null===(s=t.info)||void 0===s?void 0:s.type)),e.skip(1);const n=bd(e),i=n>>5,r=31&n,o=bd(e),a=o>>6&1;t.info.av1CodecInfo={profile:i,level:r,tier:o>>7,bitDepth:2===i&&a?o>>5&1?12:10:a?10:8,monochrome:o>>4&1,chromaSubsamplingX:o>>3&1,chromaSubsamplingY:o>>2&1,chromaSamplePosition:3&o}}break;case"colr":{var a;const t=this.currentTrack;if(!t)break;if(Kl("video"===(null===(a=t.info)||void 0===a?void 0:a.type)),"nclx"!==Id(e,4))break;const n=wd(e),i=wd(e),r=wd(e),o=Boolean(128&bd(e));t.info.colorSpace={primaries:sc[n],transfer:lc[i],matrix:uc[r],fullRange:o}}break;case"esds":{var l;const t=this.currentTrack;if(!t)break;Kl("audio"===(null===(l=t.info)||void 0===l?void 0:l.type)),e.skip(4),Kl(3===bd(e)),bu(e),e.skip(2);const n=bd(e),i=!!(64&n),r=!!(32&n);if(!!(128&n)&&e.skip(2),i){const t=bd(e);e.skip(t)}r&&e.skip(2),Kl(4===bd(e));const o=bu(e),s=e.filePos,a=bd(e);if(64===a||103===a?(t.info.codec="aac",t.info.aacCodecInfo={isMpeg2:103===a}):105===a||107===a?t.info.codec="mp3":221===a?t.info.codec="vorbis":console.warn(`Unsupported audio codec (objectTypeIndication ${a}) - discarding track.`),e.skip(12),o>e.filePos-s){Kl(5===bd(e));const n=bu(e);if(t.info.codecDescription=vd(e,n),"aac"===t.info.codec){const e=Dc(t.info.codecDescription);null!==e.numberOfChannels&&(t.info.numberOfChannels=e.numberOfChannels),null!==e.sampleRate&&(t.info.sampleRate=e.sampleRate)}}}break;case"enda":{var c;const t=this.currentTrack;if(!t)break;Kl("audio"===(null===(c=t.info)||void 0===c?void 0:c.type)),255&wd(e)&&("pcm-s16be"===t.info.codec?t.info.codec="pcm-s16":"pcm-s24be"===t.info.codec?t.info.codec="pcm-s24":"pcm-s32be"===t.info.codec?t.info.codec="pcm-s32":"pcm-f32be"===t.info.codec?t.info.codec="pcm-f32":"pcm-f64be"===t.info.codec&&(t.info.codec="pcm-f64"))}break;case"pcmC":{var u;const t=this.currentTrack;if(!t)break;Kl("audio"===(null===(u=t.info)||void 0===u?void 0:u.type)),e.skip(4);const n=bd(e),i=Boolean(1&n),r=bd(e);"pcm-s16be"===t.info.codec?i?16===r?t.info.codec="pcm-s16":24===r?t.info.codec="pcm-s24":32===r?t.info.codec="pcm-s32":(console.warn(`Invalid ipcm sample size ${r}.`),t.info.codec=null):16===r?t.info.codec="pcm-s16be":24===r?t.info.codec="pcm-s24be":32===r?t.info.codec="pcm-s32be":(console.warn(`Invalid ipcm sample size ${r}.`),t.info.codec=null):"pcm-f32be"===t.info.codec&&(i?32===r?t.info.codec="pcm-f32":64===r?t.info.codec="pcm-f64":(console.warn(`Invalid fpcm sample size ${r}.`),t.info.codec=null):32===r?t.info.codec="pcm-f32be":64===r?t.info.codec="pcm-f64be":(console.warn(`Invalid fpcm sample size ${r}.`),t.info.codec=null));break}case"dOps":{var d;const t=this.currentTrack;if(!t)break;Kl("audio"===(null===(d=t.info)||void 0===d?void 0:d.type)),e.skip(1);const n=bd(e),i=wd(e),r=Sd(e),o=xd(e),s=bd(e);let a;a=0!==s?vd(e,2+n):new Uint8Array(0);const l=new Uint8Array(19+a.byteLength),c=new DataView(l.buffer);c.setUint32(0,1332770163,!1),c.setUint32(4,1214603620,!1),c.setUint8(8,1),c.setUint8(9,n),c.setUint16(10,i,!0),c.setUint32(12,r,!0),c.setInt16(16,o,!0),c.setUint8(18,s),l.set(a,19),t.info.codecDescription=l,t.info.numberOfChannels=n}break;case"dfLa":{var h;const t=this.currentTrack;if(!t)break;Kl("audio"===(null===(h=t.info)||void 0===h?void 0:h.type)),e.skip(4);const n=127,i=128,o=e.filePos;for(;e.filePos<r;){const r=bd(e),o=kd(e);if((r&n)===iu.STREAMINFO){e.skip(10);const n=Sd(e),i=1+(n>>9&7);t.info.sampleRate=n>>>12,t.info.numberOfChannels=i,e.skip(20)}else e.skip(o);if(r&i)break}const s=e.filePos;e.filePos=o;const a=vd(e,s-o),l=new Uint8Array(4+a.byteLength);new DataView(l.buffer).setUint32(0,1716281667,!1),l.set(a,4),t.info.codecDescription=l}break;case"stts":{const t=this.currentTrack;if(!t)break;if(!t.sampleTable)break;e.skip(4);const n=Sd(e);let i=0,r=0;for(let o=0;o<n;o++){const n=Sd(e),o=Sd(e);t.sampleTable.sampleTimingEntries.push({startIndex:i,startDecodeTimestamp:r,count:n,delta:o}),i+=n,r+=n*o}}break;case"ctts":{const t=this.currentTrack;if(!t)break;if(!t.sampleTable)break;e.skip(4);const n=Sd(e);let i=0;for(let r=0;r<n;r++){const n=Sd(e),r=Cd(e);t.sampleTable.sampleCompositionTimeOffsets.push({startIndex:i,count:n,offset:r}),i+=n}}break;case"stsz":{const t=this.currentTrack;if(!t)break;if(!t.sampleTable)break;e.skip(4);const n=Sd(e),i=Sd(e);if(0===n)for(let n=0;n<i;n++){const n=Sd(e);t.sampleTable.sampleSizes.push(n)}else t.sampleTable.sampleSizes.push(n)}break;case"stz2":{const t=this.currentTrack;if(!t)break;if(!t.sampleTable)break;e.skip(4),e.skip(3);const n=bd(e),i=Sd(e),r=vd(e,Math.ceil(i*n/8)),o=new Zl(r);for(let e=0;e<i;e++){const e=o.readBits(n);t.sampleTable.sampleSizes.push(e)}}break;case"stss":{const t=this.currentTrack;if(!t)break;if(!t.sampleTable)break;e.skip(4),t.sampleTable.keySampleIndices=[];const n=Sd(e);for(let i=0;i<n;i++){const n=Sd(e)-1;t.sampleTable.keySampleIndices.push(n)}0!==t.sampleTable.keySampleIndices[0]&&t.sampleTable.keySampleIndices.unshift(0)}break;case"stsc":{const t=this.currentTrack;if(!t)break;if(!t.sampleTable)break;e.skip(4);const n=Sd(e);for(let i=0;i<n;i++){const n=Sd(e)-1,i=Sd(e),r=Sd(e);t.sampleTable.sampleToChunk.push({startSampleIndex:-1,startChunkIndex:n,samplesPerChunk:i,sampleDescriptionIndex:r})}let i=0;for(let e=0;e<t.sampleTable.sampleToChunk.length;e++)t.sampleTable.sampleToChunk[e].startSampleIndex=i,e<t.sampleTable.sampleToChunk.length-1&&(i+=(t.sampleTable.sampleToChunk[e+1].startChunkIndex-t.sampleTable.sampleToChunk[e].startChunkIndex)*t.sampleTable.sampleToChunk[e].samplesPerChunk)}break;case"stco":{const t=this.currentTrack;if(!t)break;if(!t.sampleTable)break;e.skip(4);const n=Sd(e);for(let i=0;i<n;i++){const n=Sd(e);t.sampleTable.chunkOffsets.push(n)}}break;case"co64":{const t=this.currentTrack;if(!t)break;if(!t.sampleTable)break;e.skip(4);const n=Sd(e);for(let i=0;i<n;i++){const n=_d(e);t.sampleTable.chunkOffsets.push(n)}}break;case"mvex":this.isFragmented=!0,this.readContiguousBoxes(e.slice(i,n.contentSize));break;case"mehd":{const t=bd(e);e.skip(3);const n=1===t?_d(e):Sd(e);this.movieDurationInTimescale=n}break;case"trex":{e.skip(4);const t=Sd(e),n=Sd(e),i=Sd(e),r=Sd(e),o=Sd(e);this.fragmentTrackDefaults.push({trackId:t,defaultSampleDescriptionIndex:n,defaultSampleDuration:i,defaultSampleSize:r,defaultSampleFlags:o})}break;case"tfra":{const t=bd(e);e.skip(3);const n=Sd(e),i=this.tracks.find((e=>e.id===n));if(!i)break;const r=Sd(e),o=[bd,wd,kd,Sd],s=o[(48&r)>>4],a=o[(12&r)>>2],l=o[3&r],c=Sd(e);for(let n=0;n<c;n++){const n=1===t?_d(e):Sd(e),r=1===t?_d(e):Sd(e);s(e),a(e),l(e),i.fragmentLookupTable.push({timestamp:n,moofOffset:r})}i.fragmentLookupTable.sort(((e,t)=>e.timestamp-t.timestamp));for(let e=0;e<i.fragmentLookupTable.length-1;e++)i.fragmentLookupTable[e].timestamp===i.fragmentLookupTable[e+1].timestamp&&(i.fragmentLookupTable.splice(e+1,1),e--)}break;case"moof":this.currentFragment={moofOffset:t,moofSize:n.totalSize,implicitBaseDataOffset:t,trackData:new Map},this.readContiguousBoxes(e.slice(i,n.contentSize)),this.lastReadFragment=this.currentFragment,this.currentFragment=null;break;case"traf":if(Kl(this.currentFragment),this.readContiguousBoxes(e.slice(i,n.contentSize)),this.currentTrack){const e=this.currentFragment.trackData.get(this.currentTrack.id);if(e){const{currentFragmentState:t}=this.currentTrack;Kl(t),null!==t.startTimestamp&&(Au(e,t.startTimestamp),e.startTimestampIsFinal=!0)}this.currentTrack.currentFragmentState=null,this.currentTrack=null}break;case"tfhd":{var p,f,g,m;Kl(this.currentFragment),e.skip(1);const t=kd(e),n=Boolean(1&t),i=Boolean(2&t),r=Boolean(8&t),o=Boolean(16&t),s=Boolean(32&t),a=Boolean(65536&t),l=Boolean(131072&t),c=Sd(e),u=this.tracks.find((e=>e.id===c));if(!u)break;const d=this.fragmentTrackDefaults.find((e=>e.trackId===c));this.currentTrack=u,u.currentFragmentState={baseDataOffset:this.currentFragment.implicitBaseDataOffset,sampleDescriptionIndex:null!==(p=null==d?void 0:d.defaultSampleDescriptionIndex)&&void 0!==p?p:null,defaultSampleDuration:null!==(f=null==d?void 0:d.defaultSampleDuration)&&void 0!==f?f:null,defaultSampleSize:null!==(g=null==d?void 0:d.defaultSampleSize)&&void 0!==g?g:null,defaultSampleFlags:null!==(m=null==d?void 0:d.defaultSampleFlags)&&void 0!==m?m:null,startTimestamp:null},n?u.currentFragmentState.baseDataOffset=_d(e):l&&(u.currentFragmentState.baseDataOffset=this.currentFragment.moofOffset),i&&(u.currentFragmentState.sampleDescriptionIndex=Sd(e)),r&&(u.currentFragmentState.defaultSampleDuration=Sd(e)),o&&(u.currentFragmentState.defaultSampleSize=Sd(e)),s&&(u.currentFragmentState.defaultSampleFlags=Sd(e)),a&&(u.currentFragmentState.defaultSampleDuration=0)}break;case"tfdt":{const t=this.currentTrack;if(!t)break;Kl(t.currentFragmentState);const n=bd(e);e.skip(3);const i=0===n?Sd(e):_d(e);t.currentFragmentState.startTimestamp=i}break;case"trun":{const t=this.currentTrack;if(!t)break;if(Kl(this.currentFragment),Kl(t.currentFragmentState),this.currentFragment.trackData.has(t.id)){console.warn("Can't have two trun boxes for the same track in one fragment. Ignoring...");break}const n=bd(e),i=kd(e),r=Boolean(1&i),o=Boolean(4&i),s=Boolean(256&i),a=Boolean(512&i),l=Boolean(1024&i),c=Boolean(2048&i),u=Sd(e);let d=t.currentFragmentState.baseDataOffset;r&&(d+=Cd(e));let h=null;o&&(h=Sd(e));let p=d;if(0===u){this.currentFragment.implicitBaseDataOffset=p;break}let f=0;const g={track:t,startTimestamp:0,endTimestamp:0,firstKeyFrameTimestamp:null,samples:[],presentationTimestamps:[],startTimestampIsFinal:!1};this.currentFragment.trackData.set(t.id,g);for(let i=0;i<u;i++){let r,o,u;s?r=Sd(e):(Kl(null!==t.currentFragmentState.defaultSampleDuration),r=t.currentFragmentState.defaultSampleDuration),a?o=Sd(e):(Kl(null!==t.currentFragmentState.defaultSampleSize),o=t.currentFragmentState.defaultSampleSize),l?u=Sd(e):(Kl(null!==t.currentFragmentState.defaultSampleFlags),u=t.currentFragmentState.defaultSampleFlags),0===i&&null!==h&&(u=h);let d=0;c&&(d=0===n?Sd(e):Cd(e)),g.samples.push({presentationTimestamp:f+d,duration:r,byteOffset:p,byteSize:o,isKeyFrame:!(65536&u)}),p+=o,f+=r}g.presentationTimestamps=g.samples.map(((e,t)=>({presentationTimestamp:e.presentationTimestamp,sampleIndex:t}))).sort(((e,t)=>e.presentationTimestamp-t.presentationTimestamp));for(let e=0;e<g.presentationTimestamps.length;e++){const t=g.presentationTimestamps[e],n=g.samples[t.sampleIndex];null===g.firstKeyFrameTimestamp&&n.isKeyFrame&&(g.firstKeyFrameTimestamp=n.presentationTimestamp),e<g.presentationTimestamps.length-1&&(n.duration=g.presentationTimestamps[e+1].presentationTimestamp-t.presentationTimestamp)}const m=g.samples[g.presentationTimestamps[0].sampleIndex],y=g.samples[Ql(g.presentationTimestamps).sampleIndex];g.startTimestamp=m.presentationTimestamp,g.endTimestamp=y.presentationTimestamp+y.duration,this.currentFragment.implicitBaseDataOffset=p}break;case"udta":{const t=this.iterateContiguousBoxes(e.slice(i,n.contentSize));for(const{boxInfo:e,slice:n}of t){if("meta"!==e.name&&!this.currentTrack){const t=n.filePos;this.metadataTags.raw??={},this.metadataTags.raw[e.name]??=""===e.name[0]?wu(n):vd(n,e.contentSize),n.filePos=t}switch(e.name){case"meta":n.skip(-e.headerSize),this.traverseBox(n);break;case"nam":case"name":this.currentTrack?this.currentTrack.name=ic.decode(vd(n,e.contentSize)):this.metadataTags.title??=wu(n);break;case"des":this.currentTrack||(this.metadataTags.description??=wu(n));break;case"ART":this.currentTrack||(this.metadataTags.artist??=wu(n));break;case"alb":this.currentTrack||(this.metadataTags.album??=wu(n));break;case"albr":this.currentTrack||(this.metadataTags.albumArtist??=wu(n));break;case"gen":this.currentTrack||(this.metadataTags.genre??=wu(n));break;case"day":if(!this.currentTrack){const e=new Date(wu(n));Number.isNaN(e.getTime())||(this.metadataTags.date??=e)}break;case"cmt":this.currentTrack||(this.metadataTags.comment??=wu(n));break;case"lyr":this.currentTrack||(this.metadataTags.lyrics??=wu(n))}}}break;case"meta":{if(this.currentTrack)break;const t=0!==Sd(e);this.currentMetadataKeys=new Map,this.readContiguousBoxes(t?e.slice(i,n.contentSize):e.slice(i+4,n.contentSize-4)),this.currentMetadataKeys=null}break;case"keys":{if(!this.currentMetadataKeys)break;e.skip(4);const t=Sd(e);for(let n=0;n<t;n++){const t=Sd(e);e.skip(4);const i=ic.decode(vd(e,t-8));this.currentMetadataKeys.set(n+1,i)}}break;case"ilst":{if(!this.currentMetadataKeys)break;const t=this.iterateContiguousBoxes(e.slice(i,n.contentSize));for(const{boxInfo:e,slice:n}of t){let t=e.name;const i=(t.charCodeAt(0)<<24)+(t.charCodeAt(1)<<16)+(t.charCodeAt(2)<<8)+t.charCodeAt(3);this.currentMetadataKeys.has(i)&&(t=this.currentMetadataKeys.get(i));const r=ku(n);switch(this.metadataTags.raw??={},this.metadataTags.raw[t]??=r,t){case"nam":case"titl":case"com.apple.quicktime.title":case"title":"string"==typeof r&&(this.metadataTags.title??=r);break;case"des":case"desc":case"dscp":case"com.apple.quicktime.description":case"description":"string"==typeof r&&(this.metadataTags.description??=r);break;case"ART":case"com.apple.quicktime.artist":case"artist":"string"==typeof r&&(this.metadataTags.artist??=r);break;case"alb":case"albm":case"com.apple.quicktime.album":case"album":"string"==typeof r&&(this.metadataTags.album??=r);break;case"aART":case"album_artist":"string"==typeof r&&(this.metadataTags.albumArtist??=r);break;case"cmt":case"com.apple.quicktime.comment":case"comment":"string"==typeof r&&(this.metadataTags.comment??=r);break;case"gen":case"gnre":case"com.apple.quicktime.genre":case"genre":"string"==typeof r&&(this.metadataTags.genre??=r);break;case"lyr":case"lyrics":"string"==typeof r&&(this.metadataTags.lyrics??=r);break;case"day":case"rldt":case"com.apple.quicktime.creationdate":case"date":if("string"==typeof r){const e=new Date(r);Number.isNaN(e.getTime())||(this.metadataTags.date??=e)}break;case"covr":case"com.apple.quicktime.artwork":r instanceof Ec?(this.metadataTags.images??=[],this.metadataTags.images.push({data:r.data,kind:"coverFront",mimeType:r.mimeType})):r instanceof Uint8Array&&(this.metadataTags.images??=[],this.metadataTags.images.push({data:r,kind:"coverFront",mimeType:"image/*"}));break;case"track":if("string"==typeof r){const e=r.split("/"),t=Number.parseInt(e[0],10),n=e[1]&&Number.parseInt(e[1],10);Number.isInteger(t)&&t>0&&(this.metadataTags.trackNumber??=t),n&&Number.isInteger(n)&&n>0&&(this.metadataTags.tracksTotal??=n)}break;case"trkn":if(r instanceof Uint8Array&&r.length>=6){const e=nc(r),t=e.getUint16(2,!1),n=e.getUint16(4,!1);t>0&&(this.metadataTags.trackNumber??=t),n>0&&(this.metadataTags.tracksTotal??=n)}break;case"disc":case"disk":if(r instanceof Uint8Array&&r.length>=6){const e=nc(r),t=e.getUint16(2,!1),n=e.getUint16(4,!1);t>0&&(this.metadataTags.discNumber??=t),n>0&&(this.metadataTags.discsTotal??=n)}}}}}var y;return e.filePos=r,!0}}class Su{constructor(e){this.internalTrack=e,this.packetToSampleIndex=new WeakMap,this.packetToFragmentLocation=new WeakMap}getId(){return this.internalTrack.id}getCodec(){throw new Error("Not implemented on base class.")}getInternalCodecId(){return this.internalTrack.internalCodecId}getName(){return this.internalTrack.name}getLanguageCode(){return this.internalTrack.languageCode}getTimeResolution(){return this.internalTrack.timescale}getDisposition(){return this.internalTrack.disposition}async computeDuration(){var e,t;const n=await this.getPacket(1/0,{metadataOnly:!0});return(null!==(e=null==n?void 0:n.timestamp)&&void 0!==e?e:0)+(null!==(t=null==n?void 0:n.duration)&&void 0!==t?t:0)}async getFirstTimestamp(){var e;const t=await this.getFirstPacket({metadataOnly:!0});return null!==(e=null==t?void 0:t.timestamp)&&void 0!==e?e:0}async getFirstPacket(e){const t=await this.fetchPacketForSampleIndex(0,e);return t||!this.internalTrack.demuxer.isFragmented?t:this.performFragmentedLookup(null,(e=>e.trackData.get(this.internalTrack.id)?{sampleIndex:0,correctSampleFound:!0}:{sampleIndex:-1,correctSampleFound:!1}),-1/0,1/0,e)}mapTimestampIntoTimescale(e){return kc(e*this.internalTrack.timescale)+this.internalTrack.editListOffset}async getPacket(e,t){const n=this.mapTimestampIntoTimescale(e),i=this.internalTrack.demuxer.getSampleTableForTrack(this.internalTrack),r=Eu(i,n),o=await this.fetchPacketForSampleIndex(r,t);return Lu(i)&&this.internalTrack.demuxer.isFragmented?this.performFragmentedLookup(null,(e=>{const t=e.trackData.get(this.internalTrack.id);if(!t)return{sampleIndex:-1,correctSampleFound:!1};const i=fc(t.presentationTimestamps,n,(e=>e.presentationTimestamp));return{sampleIndex:-1!==i?t.presentationTimestamps[i].sampleIndex:-1,correctSampleFound:-1!==i&&n<t.endTimestamp}}),n,n,t):o}async getNextPacket(e,t){const n=this.packetToSampleIndex.get(e);if(void 0!==n)return this.fetchPacketForSampleIndex(n+1,t);const i=this.packetToFragmentLocation.get(e);if(void 0===i)throw new Error("Packet was not created from this track.");return this.performFragmentedLookup(i.fragment,(e=>{if(e===i.fragment){const t=e.trackData.get(this.internalTrack.id);if(i.sampleIndex+1<t.samples.length)return{sampleIndex:i.sampleIndex+1,correctSampleFound:!0}}else if(e.trackData.get(this.internalTrack.id))return{sampleIndex:0,correctSampleFound:!0};return{sampleIndex:-1,correctSampleFound:!1}}),-1/0,1/0,t)}async getKeyPacket(e,t){const n=this.mapTimestampIntoTimescale(e),i=this.internalTrack.demuxer.getSampleTableForTrack(this.internalTrack),r=Eu(i,n),o=-1===r?-1:Pu(i,r),s=await this.fetchPacketForSampleIndex(o,t);return Lu(i)&&this.internalTrack.demuxer.isFragmented?this.performFragmentedLookup(null,(e=>{const t=e.trackData.get(this.internalTrack.id);if(!t)return{sampleIndex:-1,correctSampleFound:!1};const i=mc(t.presentationTimestamps,(e=>t.samples[e.sampleIndex].isKeyFrame&&e.presentationTimestamp<=n));return{sampleIndex:-1!==i?t.presentationTimestamps[i].sampleIndex:-1,correctSampleFound:-1!==i&&n<t.endTimestamp}}),n,n,t):s}async getNextKeyPacket(e,t){const n=this.packetToSampleIndex.get(e);if(void 0!==n){const e=this.internalTrack.demuxer.getSampleTableForTrack(this.internalTrack),i=Iu(e,n);return this.fetchPacketForSampleIndex(i,t)}const i=this.packetToFragmentLocation.get(e);if(void 0===i)throw new Error("Packet was not created from this track.");return this.performFragmentedLookup(i.fragment,(e=>{if(e===i.fragment){const t=e.trackData.get(this.internalTrack.id).samples.findIndex(((e,t)=>e.isKeyFrame&&t>i.sampleIndex));if(-1!==t)return{sampleIndex:t,correctSampleFound:!0}}else{const t=e.trackData.get(this.internalTrack.id);if(t&&null!==t.firstKeyFrameTimestamp){const e=t.samples.findIndex((e=>e.isKeyFrame));return Kl(-1!==e),{sampleIndex:e,correctSampleFound:!0}}}return{sampleIndex:-1,correctSampleFound:!1}}),-1/0,1/0,t)}async fetchPacketForSampleIndex(e,t){if(-1===e)return null;const n=this.internalTrack.demuxer.getSampleTableForTrack(this.internalTrack),i=Tu(n,e);if(!i)return null;let r;if(t.metadataOnly)r=au;else{let e=this.internalTrack.demuxer.reader.requestSlice(i.sampleOffset,i.sampleSize);e instanceof Promise&&(e=await e),Kl(e),r=vd(e,i.sampleSize)}const o=new lu(r,i.isKeyFrame?"key":"delta",(i.presentationTimestamp-this.internalTrack.editListOffset)/this.internalTrack.timescale,i.duration/this.internalTrack.timescale,e,i.sampleSize);return this.packetToSampleIndex.set(o,e),o}async fetchPacketInFragment(e,t,n){if(-1===t)return null;const i=e.trackData.get(this.internalTrack.id).samples[t];let r;if(Kl(i),n.metadataOnly)r=au;else{let e=this.internalTrack.demuxer.reader.requestSlice(i.byteOffset,i.byteSize);e instanceof Promise&&(e=await e),Kl(e),r=vd(e,i.byteSize)}const o=new lu(r,i.isKeyFrame?"key":"delta",(i.presentationTimestamp-this.internalTrack.editListOffset)/this.internalTrack.timescale,i.duration/this.internalTrack.timescale,e.moofOffset+t,i.byteSize);return this.packetToFragmentLocation.set(o,{fragment:e,sampleIndex:t}),o}async performFragmentedLookup(e,t,n,i,r){var o,s;const a=this.internalTrack.demuxer;let l=null,c=null,u=-1;if(e){const{sampleIndex:n,correctSampleFound:i}=t(e);if(i)return this.fetchPacketInFragment(e,n,r);-1!==n&&(c=e,u=n)}const d=fc(this.internalTrack.fragmentLookupTable,n,(e=>e.timestamp)),h=-1!==d?this.internalTrack.fragmentLookupTable[d]:null,p=fc(this.internalTrack.fragmentPositionCache,n,(e=>e.startTimestamp)),f=-1!==p?this.internalTrack.fragmentPositionCache[p]:null,g=Math.max(null!==(o=null==h?void 0:h.moofOffset)&&void 0!==o?o:0,null!==(s=null==f?void 0:f.moofOffset)&&void 0!==s?s:0)||null;let m;for(e?null===g||e.moofOffset>=g?(m=e.moofOffset+e.moofSize,l=e):m=g:m=null!=g?g:0;;){if(l){const e=l.trackData.get(this.internalTrack.id);if(e&&e.startTimestamp>i)break}let e=a.reader.requestSliceRange(m,8,16);if(e instanceof Promise&&(e=await e),!e)break;const n=m,o=mu(e);if(!o)break;if("moof"===o.name){l=await a.readFragment(n);const{sampleIndex:e,correctSampleFound:i}=t(l);if(i)return this.fetchPacketInFragment(l,e,r);-1!==e&&(c=l,u=e)}m=n+o.totalSize}if(h&&(!c||c.moofOffset<h.moofOffset)){var y;const e=this.internalTrack.fragmentLookupTable[d-1];Kl(!e||e.timestamp<h.timestamp);const n=null!==(y=null==e?void 0:e.timestamp)&&void 0!==y?y:-1/0;return this.performFragmentedLookup(null,t,n,i,r)}return c?this.fetchPacketInFragment(c,u,r):null}}class Cu extends Su{constructor(e){super(e),this.decoderConfigPromise=null,this.internalTrack=e}getCodec(){return this.internalTrack.info.codec}getCodedWidth(){return this.internalTrack.info.width}getCodedHeight(){return this.internalTrack.info.height}getRotation(){return this.internalTrack.rotation}async getColorSpace(){var e,t,n,i;return{primaries:null===(e=this.internalTrack.info.colorSpace)||void 0===e?void 0:e.primaries,transfer:null===(t=this.internalTrack.info.colorSpace)||void 0===t?void 0:t.transfer,matrix:null===(n=this.internalTrack.info.colorSpace)||void 0===n?void 0:n.matrix,fullRange:null===(i=this.internalTrack.info.colorSpace)||void 0===i?void 0:i.fullRange}}async canBeTransparent(){return!1}async getDecoderConfig(){return this.internalTrack.info.codec?this.decoderConfigPromise??=(async(e,t)=>{if("vp9"!==this.internalTrack.info.codec||this.internalTrack.info.vp9CodecInfo){if("av1"===this.internalTrack.info.codec&&!this.internalTrack.info.av1CodecInfo){const e=await this.getFirstPacket({});this.internalTrack.info.av1CodecInfo=e&&nu(e.data)}}else{const e=await this.getFirstPacket({});this.internalTrack.info.vp9CodecInfo=e&&eu(e.data)}return{codec:Oc(this.internalTrack.info),codedWidth:this.internalTrack.info.width,codedHeight:this.internalTrack.info.height,description:null!==(e=this.internalTrack.info.codecDescription)&&void 0!==e?e:void 0,colorSpace:null!==(t=this.internalTrack.info.colorSpace)&&void 0!==t?t:void 0}})():null}}class _u extends Su{constructor(e){super(e),this.decoderConfig=null,this.internalTrack=e}getCodec(){return this.internalTrack.info.codec}getNumberOfChannels(){return this.internalTrack.info.numberOfChannels}getSampleRate(){return this.internalTrack.info.sampleRate}async getDecoderConfig(){var e;return this.internalTrack.info.codec?this.decoderConfig??={codec:Lc(this.internalTrack.info),numberOfChannels:this.internalTrack.info.numberOfChannels,sampleRate:this.internalTrack.info.sampleRate,description:null!==(e=this.internalTrack.info.codecDescription)&&void 0!==e?e:void 0}:null}}const Eu=(e,t)=>{if(e.presentationTimestamps){const n=fc(e.presentationTimestamps,t,(e=>e.presentationTimestamp));return-1===n?-1:e.presentationTimestamps[n].sampleIndex}{const n=fc(e.sampleTimingEntries,t,(e=>e.startDecodeTimestamp));if(-1===n)return-1;const i=e.sampleTimingEntries[n];return i.startIndex+Math.min(Math.floor((t-i.startDecodeTimestamp)/i.delta),i.count-1)}},Tu=(e,t)=>{const n=fc(e.sampleTimingEntries,t,(e=>e.startIndex)),i=e.sampleTimingEntries[n];if(!i||i.startIndex+i.count<=t)return null;let r=i.startDecodeTimestamp+(t-i.startIndex)*i.delta;const o=fc(e.sampleCompositionTimeOffsets,t,(e=>e.startIndex)),s=e.sampleCompositionTimeOffsets[o];s&&t-s.startIndex<s.count&&(r+=s.offset);const a=e.sampleSizes[Math.min(t,e.sampleSizes.length-1)],l=fc(e.sampleToChunk,t,(e=>e.startSampleIndex)),c=e.sampleToChunk[l];Kl(c);const u=c.startChunkIndex+Math.floor((t-c.startSampleIndex)/c.samplesPerChunk),d=e.chunkOffsets[u],h=c.startSampleIndex+(u-c.startChunkIndex)*c.samplesPerChunk;let p=0,f=d;if(1===e.sampleSizes.length)f+=a*(t-h),p+=a*c.samplesPerChunk;else for(let n=h;n<h+c.samplesPerChunk;n++){const i=e.sampleSizes[n];n<t&&(f+=i),p+=i}let g=i.delta;if(e.presentationTimestamps){const n=e.presentationTimestampIndexMap[t];Kl(void 0!==n),n<e.presentationTimestamps.length-1&&(g=e.presentationTimestamps[n+1].presentationTimestamp-r)}return{presentationTimestamp:r,duration:g,sampleOffset:f,sampleSize:a,chunkOffset:d,chunkSize:p,isKeyFrame:!e.keySampleIndices||-1!==pc(e.keySampleIndices,t,(e=>e))}},Pu=(e,t)=>{var n;if(!e.keySampleIndices)return t;const i=fc(e.keySampleIndices,t,(e=>e));return null!==(n=e.keySampleIndices[i])&&void 0!==n?n:-1},Iu=(e,t)=>{var n;if(!e.keySampleIndices)return t+1;const i=fc(e.keySampleIndices,t,(e=>e));return null!==(n=e.keySampleIndices[i+1])&&void 0!==n?n:-1},Au=(e,t)=>{e.startTimestamp+=t,e.endTimestamp+=t;for(const n of e.samples)n.presentationTimestamp+=t;for(const n of e.presentationTimestamps)n.presentationTimestamp+=t},Ou=e=>{const[t,,,n]=e,i=Math.hypot(t,n),r=-Math.atan2(n/i,t/i)*(180/Math.PI);return Number.isFinite(r)?r:0},Lu=e=>0===e.sampleSizes.length;var Nu;!function(e){e[e.EBML=440786851]="EBML",e[e.EBMLVersion=17030]="EBMLVersion",e[e.EBMLReadVersion=17143]="EBMLReadVersion",e[e.EBMLMaxIDLength=17138]="EBMLMaxIDLength",e[e.EBMLMaxSizeLength=17139]="EBMLMaxSizeLength",e[e.DocType=17026]="DocType",e[e.DocTypeVersion=17031]="DocTypeVersion",e[e.DocTypeReadVersion=17029]="DocTypeReadVersion",e[e.Void=236]="Void",e[e.Segment=408125543]="Segment",e[e.SeekHead=290298740]="SeekHead",e[e.Seek=19899]="Seek",e[e.SeekID=21419]="SeekID",e[e.SeekPosition=21420]="SeekPosition",e[e.Duration=17545]="Duration",e[e.Info=357149030]="Info",e[e.TimestampScale=2807729]="TimestampScale",e[e.MuxingApp=19840]="MuxingApp",e[e.WritingApp=22337]="WritingApp",e[e.Tracks=374648427]="Tracks",e[e.TrackEntry=174]="TrackEntry",e[e.TrackNumber=215]="TrackNumber",e[e.TrackUID=29637]="TrackUID",e[e.TrackType=131]="TrackType",e[e.FlagEnabled=185]="FlagEnabled",e[e.FlagDefault=136]="FlagDefault",e[e.FlagForced=21930]="FlagForced",e[e.FlagOriginal=21934]="FlagOriginal",e[e.FlagHearingImpaired=21931]="FlagHearingImpaired",e[e.FlagVisualImpaired=21932]="FlagVisualImpaired",e[e.FlagCommentary=21935]="FlagCommentary",e[e.FlagLacing=156]="FlagLacing",e[e.Name=21358]="Name",e[e.Language=2274716]="Language",e[e.LanguageBCP47=2274717]="LanguageBCP47",e[e.CodecID=134]="CodecID",e[e.CodecPrivate=25506]="CodecPrivate",e[e.CodecDelay=22186]="CodecDelay",e[e.SeekPreRoll=22203]="SeekPreRoll",e[e.DefaultDuration=2352003]="DefaultDuration",e[e.Video=224]="Video",e[e.PixelWidth=176]="PixelWidth",e[e.PixelHeight=186]="PixelHeight",e[e.AlphaMode=21440]="AlphaMode",e[e.Audio=225]="Audio",e[e.SamplingFrequency=181]="SamplingFrequency",e[e.Channels=159]="Channels",e[e.BitDepth=25188]="BitDepth",e[e.SimpleBlock=163]="SimpleBlock",e[e.BlockGroup=160]="BlockGroup",e[e.Block=161]="Block",e[e.BlockAdditions=30113]="BlockAdditions",e[e.BlockMore=166]="BlockMore",e[e.BlockAdditional=165]="BlockAdditional",e[e.BlockAddID=238]="BlockAddID",e[e.BlockDuration=155]="BlockDuration",e[e.ReferenceBlock=251]="ReferenceBlock",e[e.Cluster=524531317]="Cluster",e[e.Timestamp=231]="Timestamp",e[e.Cues=475249515]="Cues",e[e.CuePoint=187]="CuePoint",e[e.CueTime=179]="CueTime",e[e.CueTrackPositions=183]="CueTrackPositions",e[e.CueTrack=247]="CueTrack",e[e.CueClusterPosition=241]="CueClusterPosition",e[e.Colour=21936]="Colour",e[e.MatrixCoefficients=21937]="MatrixCoefficients",e[e.TransferCharacteristics=21946]="TransferCharacteristics",e[e.Primaries=21947]="Primaries",e[e.Range=21945]="Range",e[e.Projection=30320]="Projection",e[e.ProjectionType=30321]="ProjectionType",e[e.ProjectionPoseRoll=30325]="ProjectionPoseRoll",e[e.Attachments=423732329]="Attachments",e[e.AttachedFile=24999]="AttachedFile",e[e.FileDescription=18046]="FileDescription",e[e.FileName=18030]="FileName",e[e.FileMediaType=18016]="FileMediaType",e[e.FileData=18012]="FileData",e[e.FileUID=18094]="FileUID",e[e.Chapters=272869232]="Chapters",e[e.Tags=307544935]="Tags",e[e.Tag=29555]="Tag",e[e.Targets=25536]="Targets",e[e.TargetTypeValue=26826]="TargetTypeValue",e[e.TargetType=25546]="TargetType",e[e.TagTrackUID=25541]="TagTrackUID",e[e.TagEditionUID=25545]="TagEditionUID",e[e.TagChapterUID=25540]="TagChapterUID",e[e.TagAttachmentUID=25542]="TagAttachmentUID",e[e.SimpleTag=26568]="SimpleTag",e[e.TagName=17827]="TagName",e[e.TagLanguage=17530]="TagLanguage",e[e.TagString=17543]="TagString",e[e.TagBinary=17541]="TagBinary",e[e.ContentEncodings=28032]="ContentEncodings",e[e.ContentEncoding=25152]="ContentEncoding",e[e.ContentEncodingOrder=20529]="ContentEncodingOrder",e[e.ContentEncodingScope=20530]="ContentEncodingScope",e[e.ContentCompression=20532]="ContentCompression",e[e.ContentCompAlgo=16980]="ContentCompAlgo",e[e.ContentCompSettings=16981]="ContentCompSettings",e[e.ContentEncryption=20533]="ContentEncryption"}(Nu||(Nu={}));const Ru=[Nu.SeekHead,Nu.Info,Nu.Cluster,Nu.Tracks,Nu.Cues,Nu.Attachments,Nu.Chapters,Nu.Tags],Du=[Nu.EBML,Nu.Segment,...Ru],Mu=16,Fu=e=>{const t=bd(e);if(e.skip(-1),0===t)return null;let n=1,i=128;for(;!(t&i);)n++,i>>=1;return n},Bu=e=>{const t=bd(e);if(0===t)return null;let n=1,i=128;for(;!(t&i);)n++,i>>=1;let r=t&i-1;for(let t=1;t<n;t++)r*=256,r+=bd(e);return r},Uu=(e,t)=>{if(t<1||t>8)throw new Error("Bad unsigned int size "+t);let n=0;for(let i=0;i<t;i++)n*=256,n+=bd(e);return n},ju=e=>{const t=Fu(e);return null===t?null:Uu(e,t)},zu=e=>{let t=bd(e);return 255===t?t=null:(e.skip(-1),t=Bu(e),72057594037927940===t&&(t=null)),t},Vu=e=>{const t=ju(e);return null===t?null:{id:t,size:zu(e)}},Wu=(e,t)=>{const n=vd(e,t);let i=0;for(;i<t&&0!==n[i];)i+=1;return String.fromCharCode(...n.subarray(0,i))},Hu=(e,t)=>{const n=vd(e,t);let i=0;for(;i<t&&0!==n[i];)i+=1;return ic.decode(n.subarray(0,i))},$u=(e,t)=>{if(0===t)return 0;if(4!==t&&8!==t)throw new Error("Bad float size "+t);return 4===t?Td(e):Pd(e)},Gu=async(e,t,n,i)=>{const r=new Set(n);let o=t;for(;null===i||o<i;){let t=e.requestSliceRange(o,2,Mu);if(t instanceof Promise&&(t=await t),!t)break;const n=Vu(t);if(!n)break;if(r.has(n.id))return{pos:o,found:!0};Yu(n.size),o=t.filePos+n.size}return{pos:null!==i&&i>o?i:o,found:!1}},qu=async(e,t,n,i)=>{const r=new Set(n);let o=t;for(;o<i;){let t=e.requestSliceRange(o,0,Math.min(65536,i-o));if(t instanceof Promise&&(t=await t),!t)break;if(t.length<8)break;for(let e=0;e<t.length-8;e++){t.filePos=o;const e=ju(t);if(null!==e&&r.has(e))return o;o++}}return null};function Yu(e){if(null===e)throw new Error("Undefined element size is used in a place where it is not supported.")}var Ku,Xu,Qu;!function(e){e[e.None=0]="None",e[e.Xiph=1]="Xiph",e[e.FixedSize=2]="FixedSize",e[e.Ebml=3]="Ebml"}(Ku||(Ku={})),function(e){e[e.Block=1]="Block",e[e.Private=2]="Private",e[e.Next=4]="Next"}(Xu||(Xu={})),function(e){e[e.Zlib=0]="Zlib",e[e.Bzlib=1]="Bzlib",e[e.lzo1x=2]="lzo1x",e[e.HeaderStripping=3]="HeaderStripping"}(Qu||(Qu={}));const Zu=[{id:Nu.SeekHead,flag:"seekHeadSeen"},{id:Nu.Info,flag:"infoSeen"},{id:Nu.Tracks,flag:"tracksSeen"},{id:Nu.Cues,flag:"cuesSeen"}],Ju=10485760;class ed extends ru{constructor(e){super(e),this.readMetadataPromise=null,this.segments=[],this.currentSegment=null,this.currentTrack=null,this.currentCluster=null,this.currentBlock=null,this.currentBlockAdditional=null,this.currentCueTime=null,this.currentDecodingInstruction=null,this.currentTagTargetIsMovie=!0,this.currentSimpleTagName=null,this.currentAttachedFile=null,this.isWebM=!1,this.reader=e._reader}async computeDuration(){const e=await this.getTracks(),t=await Promise.all(e.map((e=>e.computeDuration())));return Math.max(0,...t)}async getTracks(){return await this.readMetadata(),this.segments.flatMap((e=>e.tracks.map((e=>e.inputTrack))))}async getMimeType(){await this.readMetadata();const e=await this.getTracks(),t=await Promise.all(e.map((e=>e.getCodecParameterString())));return(e=>{let t=(e.hasVideo?"video/":e.hasAudio?"audio/":"application/")+(e.isWebM?"webm":"x-matroska");return e.codecStrings.length>0&&(t+=`; codecs="${[...new Set(e.codecStrings.filter(Boolean))].join(", ")}"`),t})({isWebM:this.isWebM,hasVideo:this.segments.some((e=>e.tracks.some((e=>{var t;return"video"===(null===(t=e.info)||void 0===t?void 0:t.type)})))),hasAudio:this.segments.some((e=>e.tracks.some((e=>{var t;return"audio"===(null===(t=e.info)||void 0===t?void 0:t.type)})))),codecStrings:t.filter(Boolean)})}async getMetadataTags(){await this.readMetadata();for(const e of this.segments)e.metadataTagsCollected||(null!==this.reader.fileSize&&await this.loadSegmentMetadata(e),e.metadataTagsCollected=!0);let e={};for(const t of this.segments)e={...e,...t.metadataTags};return e}readMetadata(){return this.readMetadataPromise??=(async()=>{let e=0;for(;;){let t=this.reader.requestSliceRange(e,2,Mu);if(t instanceof Promise&&(t=await t),!t)break;const n=Vu(t);if(!n)break;const i=n.id;let r=n.size;const o=t.filePos;if(i===Nu.EBML){Yu(r);let e=this.reader.requestSlice(o,r);if(e instanceof Promise&&(e=await e),!e)break;this.readContiguousElements(e)}else if(i===Nu.Segment){if(await this.readSegment(o,r),null===r)break;if(null===this.reader.fileSize)break}else if(i===Nu.Cluster){if(null===this.reader.fileSize)break;null===r&&(r=(await Gu(this.reader,o,Du,this.reader.fileSize)).pos-o);const e=Ql(this.segments);e&&(e.elementEndPos=o+r)}Yu(r),e=o+r}})()}async readSegment(e,t){this.currentSegment={seekHeadSeen:!1,infoSeen:!1,tracksSeen:!1,cuesSeen:!1,tagsSeen:!1,attachmentsSeen:!1,timestampScale:-1,timestampFactor:-1,duration:-1,seekEntries:[],tracks:[],cuePoints:[],dataStartPos:e,elementEndPos:null===t?null:e+t,clusterSeekStartPos:e,lastReadCluster:null,metadataTags:{},metadataTagsCollected:!1},this.segments.push(this.currentSegment);let n=e;for(;null===this.currentSegment.elementEndPos||n<this.currentSegment.elementEndPos;){let e=this.reader.requestSliceRange(n,2,Mu);if(e instanceof Promise&&(e=await e),!e)break;const t=n,r=Vu(e);if(!r||!Ru.includes(r.id)&&r.id!==Nu.Void){var i;const e=await qu(this.reader,t,Ru,Math.min(null!==(i=this.currentSegment.elementEndPos)&&void 0!==i?i:1/0,t+Ju));if(e){n=e;continue}break}const{id:o,size:s}=r,a=e.filePos,l=Zu.findIndex((e=>e.id===o));if(-1!==l){this.currentSegment[Zu[l].flag]=!0,Yu(s);let e=this.reader.requestSlice(a,s);e instanceof Promise&&(e=await e),e&&this.readContiguousElements(e)}else if(o===Nu.Tags||o===Nu.Attachments){o===Nu.Tags?this.currentSegment.tagsSeen=!0:this.currentSegment.attachmentsSeen=!0,Yu(s);let e=this.reader.requestSlice(a,s);e instanceof Promise&&(e=await e),e&&this.readContiguousElements(e)}else if(o===Nu.Cluster){this.currentSegment.clusterSeekStartPos=t;break}if(null===s)break;n=a+s}if(this.currentSegment.seekEntries.sort(((e,t)=>e.segmentPosition-t.segmentPosition)),null!==this.reader.fileSize)for(const t of this.currentSegment.seekEntries){const n=Zu.find((e=>e.id===t.id));if(!n)continue;if(this.currentSegment[n.flag])continue;let i=this.reader.requestSliceRange(e+t.segmentPosition,2,Mu);if(i instanceof Promise&&(i=await i),!i)continue;const r=Vu(i);if(!r)continue;const{id:o,size:s}=r;if(o!==n.id)continue;Yu(s),this.currentSegment[n.flag]=!0;let a=this.reader.requestSlice(i.filePos,s);a instanceof Promise&&(a=await a),a&&this.readContiguousElements(a)}-1===this.currentSegment.timestampScale&&(this.currentSegment.timestampScale=1e6,this.currentSegment.timestampFactor=1e3),this.currentSegment.tracks.sort(((e,t)=>Number(t.disposition.default)-Number(e.disposition.default)));const r=new Map(this.currentSegment.tracks.map((e=>[e.id,e])));for(const e of this.currentSegment.cuePoints){const t=r.get(e.trackId);t&&t.cuePoints.push(e)}for(const e of this.currentSegment.tracks){e.cuePoints.sort(((e,t)=>e.time-t.time));for(let t=0;t<e.cuePoints.length-1;t++)e.cuePoints[t].time===e.cuePoints[t+1].time&&(e.cuePoints.splice(t+1,1),t--)}let o=null,s=-1/0;for(const e of this.currentSegment.tracks)e.cuePoints.length>s&&(s=e.cuePoints.length,o=e);for(const e of this.currentSegment.tracks)0===e.cuePoints.length&&(e.cuePoints=o.cuePoints);this.currentSegment=null}async readCluster(e,t){var n;if((null===(n=t.lastReadCluster)||void 0===n?void 0:n.elementStartPos)===e)return t.lastReadCluster;let i=this.reader.requestSliceRange(e,2,Mu);i instanceof Promise&&(i=await i),Kl(i);const r=e,o=Vu(i);Kl(o),Kl(o.id===Nu.Cluster);let s=o.size;const a=i.filePos;null===s&&(s=(await Gu(this.reader,a,Du,t.elementEndPos)).pos-a);let l=this.reader.requestSlice(a,s);l instanceof Promise&&(l=await l);const c={segment:t,elementStartPos:r,elementEndPos:a+s,dataStartPos:a,timestamp:-1,trackData:new Map};if(this.currentCluster=c,l){const e=this.readContiguousElements(l,Du);c.elementEndPos=e}for(const[,e]of c.trackData){const t=e.track;Kl(e.blocks.length>0);let n=!1;for(let t=0;t<e.blocks.length;t++){const i=e.blocks[t];i.timestamp+=c.timestamp,n||=i.lacing!==Ku.None}e.presentationTimestamps=e.blocks.map(((e,t)=>({timestamp:e.timestamp,blockIndex:t}))).sort(((e,t)=>e.timestamp-t.timestamp));for(let n=0;n<e.presentationTimestamps.length;n++){const i=e.blocks[e.presentationTimestamps[n].blockIndex];null===e.firstKeyFrameTimestamp&&i.isKeyFrame&&(e.firstKeyFrameTimestamp=i.timestamp),n<e.presentationTimestamps.length-1?i.duration=e.presentationTimestamps[n+1].timestamp-i.timestamp:0===i.duration&&null!=t.defaultDuration&&i.lacing===Ku.None&&(i.duration=t.defaultDuration)}n&&(this.expandLacedBlocks(e.blocks,t),e.presentationTimestamps=e.blocks.map(((e,t)=>({timestamp:e.timestamp,blockIndex:t}))).sort(((e,t)=>e.timestamp-t.timestamp)));const i=e.blocks[e.presentationTimestamps[0].blockIndex],o=e.blocks[Ql(e.presentationTimestamps).blockIndex];e.startTimestamp=i.timestamp,e.endTimestamp=o.timestamp+o.duration;const s=fc(t.clusterPositionCache,e.startTimestamp,(e=>e.startTimestamp));-1!==s&&t.clusterPositionCache[s].elementStartPos===r||t.clusterPositionCache.splice(s+1,0,{elementStartPos:c.elementStartPos,startTimestamp:e.startTimestamp})}return t.lastReadCluster=c,c}getTrackDataInCluster(e,t){let n=e.trackData.get(t);if(!n){const i=e.segment.tracks.find((e=>e.id===t));if(!i)return null;n={track:i,startTimestamp:0,endTimestamp:0,firstKeyFrameTimestamp:null,blocks:[],presentationTimestamps:[]},e.trackData.set(t,n)}return n}expandLacedBlocks(e,t){for(let i=0;i<e.length;i++){var n;const r=e[i];if(r.lacing===Ku.None)continue;r.decoded||(r.data=this.decodeBlockData(t,r.data),r.decoded=!0);const o=md.tempFromBytes(r.data),s=[],a=bd(o)+1;switch(r.lacing){case Ku.Xiph:{let e=0;for(let t=0;t<a-1;t++){let t=0;for(;o.bufferPos<o.length;){const n=bd(o);if(t+=n,n<255){s.push(t),e+=t;break}}}s.push(o.length-(o.bufferPos+e))}break;case Ku.FixedSize:{const e=Math.floor((o.length-1)/a);for(let t=0;t<a;t++)s.push(e)}break;case Ku.Ebml:{const e=Bu(o);Kl(null!==e);let t=e;s.push(t);let n=t;for(let e=1;e<a-1;e++){const e=o.bufferPos,i=Bu(o);Kl(null!==i),t+=i-((1<<7*(o.bufferPos-e)-1)-1),s.push(t),n+=t}s.push(o.length-(o.bufferPos+n))}break;default:Kl(!1)}Kl(s.length===a),e.splice(i,1);const l=r.duration||a*(null!==(n=t.defaultDuration)&&void 0!==n?n:0);for(let t=0;t<a;t++){const n=vd(o,s[t]);e.splice(i+t,0,{timestamp:r.timestamp+l*t/a,duration:l/a,isKeyFrame:r.isKeyFrame,data:n,lacing:Ku.None,decoded:!0,mainAdditional:r.mainAdditional})}i+=a,i--}}async loadSegmentMetadata(e){for(const t of e.seekEntries){if((t.id!==Nu.Tags||e.tagsSeen)&&(t.id!==Nu.Attachments||e.attachmentsSeen))continue;let n=this.reader.requestSliceRange(e.dataStartPos+t.segmentPosition,2,Mu);if(n instanceof Promise&&(n=await n),!n)continue;const i=Vu(n);if(!i||i.id!==t.id)continue;const{size:r}=i;Yu(r),Kl(!this.currentSegment),this.currentSegment=e;let o=this.reader.requestSlice(n.filePos,r);o instanceof Promise&&(o=await o),o&&this.readContiguousElements(o),this.currentSegment=null,t.id===Nu.Tags?e.tagsSeen=!0:t.id===Nu.Attachments&&(e.attachmentsSeen=!0)}}readContiguousElements(e,t){const n=e.filePos;for(;e.filePos-n<=e.length-2;){const n=e.filePos;if(!this.traverseElement(e,t))return n}return e.filePos}traverseElement(e,t){const n=Vu(e);if(!n)return!1;if(t&&t.includes(n.id))return!1;const{id:i,size:r}=n,o=e.filePos;switch(Yu(r),i){case Nu.DocType:this.isWebM="webm"===Wu(e,r);break;case Nu.Seek:{if(!this.currentSegment)break;const t={id:-1,segmentPosition:-1};this.currentSegment.seekEntries.push(t),this.readContiguousElements(e.slice(o,r)),-1!==t.id&&-1!==t.segmentPosition||this.currentSegment.seekEntries.pop()}break;case Nu.SeekID:{var s;const t=null===(s=this.currentSegment)||void 0===s?void 0:s.seekEntries[this.currentSegment.seekEntries.length-1];if(!t)break;t.id=Uu(e,r)}break;case Nu.SeekPosition:{var a;const t=null===(a=this.currentSegment)||void 0===a?void 0:a.seekEntries[this.currentSegment.seekEntries.length-1];if(!t)break;t.segmentPosition=Uu(e,r)}break;case Nu.TimestampScale:if(!this.currentSegment)break;this.currentSegment.timestampScale=Uu(e,r),this.currentSegment.timestampFactor=1e9/this.currentSegment.timestampScale;break;case Nu.Duration:if(!this.currentSegment)break;this.currentSegment.duration=$u(e,r);break;case Nu.TrackEntry:if(!this.currentSegment)break;if(this.currentTrack={id:-1,segment:this.currentSegment,demuxer:this,clusterPositionCache:[],cuePoints:[],disposition:{...Pc},inputTrack:null,codecId:null,codecPrivate:null,defaultDuration:null,name:null,languageCode:wc,decodingInstructions:[],info:null},this.readContiguousElements(e.slice(o,r)),this.currentTrack.decodingInstructions.some((e=>{var t;return"decompress"!==(null===(t=e.data)||void 0===t?void 0:t.type)||e.scope!==Xu.Block||e.data.algorithm!==Qu.HeaderStripping}))&&(console.warn(`Track #${this.currentTrack.id} has an unsupported content encoding; dropping.`),this.currentTrack=null),this.currentTrack&&-1!==this.currentTrack.id&&this.currentTrack.codecId&&this.currentTrack.info){const e=this.currentTrack.codecId.indexOf("/"),t=-1===e?this.currentTrack.codecId:this.currentTrack.codecId.slice(0,e);if("video"===this.currentTrack.info.type&&-1!==this.currentTrack.info.width&&-1!==this.currentTrack.info.height){"V_MPEG4/ISO/AVC"===this.currentTrack.codecId?(this.currentTrack.info.codec="avc",this.currentTrack.info.codecDescription=this.currentTrack.codecPrivate):"V_MPEGH/ISO/HEVC"===this.currentTrack.codecId?(this.currentTrack.info.codec="hevc",this.currentTrack.info.codecDescription=this.currentTrack.codecPrivate):"V_VP8"===t?this.currentTrack.info.codec="vp8":"V_VP9"===t?this.currentTrack.info.codec="vp9":"V_AV1"===t&&(this.currentTrack.info.codec="av1");const e=new fu(this.input,new nd(this.currentTrack));this.currentTrack.inputTrack=e,this.currentSegment.tracks.push(this.currentTrack)}else if("audio"===this.currentTrack.info.type&&-1!==this.currentTrack.info.numberOfChannels&&-1!==this.currentTrack.info.sampleRate){"A_AAC"===t?(this.currentTrack.info.codec="aac",this.currentTrack.info.aacCodecInfo={isMpeg2:this.currentTrack.codecId.includes("MPEG2")},this.currentTrack.info.codecDescription=this.currentTrack.codecPrivate):"A_MPEG/L3"===this.currentTrack.codecId?this.currentTrack.info.codec="mp3":"A_OPUS"===t?(this.currentTrack.info.codec="opus",this.currentTrack.info.codecDescription=this.currentTrack.codecPrivate,this.currentTrack.info.sampleRate=48e3):"A_VORBIS"===t?(this.currentTrack.info.codec="vorbis",this.currentTrack.info.codecDescription=this.currentTrack.codecPrivate):"A_FLAC"===t?(this.currentTrack.info.codec="flac",this.currentTrack.info.codecDescription=this.currentTrack.codecPrivate):"A_PCM/INT/LIT"===this.currentTrack.codecId?8===this.currentTrack.info.bitDepth?this.currentTrack.info.codec="pcm-u8":16===this.currentTrack.info.bitDepth?this.currentTrack.info.codec="pcm-s16":24===this.currentTrack.info.bitDepth?this.currentTrack.info.codec="pcm-s24":32===this.currentTrack.info.bitDepth&&(this.currentTrack.info.codec="pcm-s32"):"A_PCM/INT/BIG"===this.currentTrack.codecId?8===this.currentTrack.info.bitDepth?this.currentTrack.info.codec="pcm-u8":16===this.currentTrack.info.bitDepth?this.currentTrack.info.codec="pcm-s16be":24===this.currentTrack.info.bitDepth?this.currentTrack.info.codec="pcm-s24be":32===this.currentTrack.info.bitDepth&&(this.currentTrack.info.codec="pcm-s32be"):"A_PCM/FLOAT/IEEE"===this.currentTrack.codecId&&(32===this.currentTrack.info.bitDepth?this.currentTrack.info.codec="pcm-f32":64===this.currentTrack.info.bitDepth&&(this.currentTrack.info.codec="pcm-f64"));const e=new gu(this.input,new id(this.currentTrack));this.currentTrack.inputTrack=e,this.currentSegment.tracks.push(this.currentTrack)}}this.currentTrack=null;break;case Nu.TrackNumber:if(!this.currentTrack)break;this.currentTrack.id=Uu(e,r);break;case Nu.TrackType:{if(!this.currentTrack)break;const t=Uu(e,r);1===t?this.currentTrack.info={type:"video",width:-1,height:-1,rotation:0,codec:null,codecDescription:null,colorSpace:null,alphaMode:!1}:2===t&&(this.currentTrack.info={type:"audio",numberOfChannels:-1,sampleRate:-1,bitDepth:-1,codec:null,codecDescription:null,aacCodecInfo:null})}break;case Nu.FlagEnabled:if(!this.currentTrack)break;Uu(e,r)||(this.currentSegment.tracks.pop(),this.currentTrack=null);break;case Nu.FlagDefault:if(!this.currentTrack)break;this.currentTrack.disposition.default=!!Uu(e,r);break;case Nu.FlagForced:if(!this.currentTrack)break;this.currentTrack.disposition.forced=!!Uu(e,r);break;case Nu.FlagOriginal:if(!this.currentTrack)break;this.currentTrack.disposition.original=!!Uu(e,r);break;case Nu.FlagHearingImpaired:if(!this.currentTrack)break;this.currentTrack.disposition.hearingImpaired=!!Uu(e,r);break;case Nu.FlagVisualImpaired:if(!this.currentTrack)break;this.currentTrack.disposition.visuallyImpaired=!!Uu(e,r);break;case Nu.FlagCommentary:if(!this.currentTrack)break;this.currentTrack.disposition.commentary=!!Uu(e,r);break;case Nu.CodecID:if(!this.currentTrack)break;this.currentTrack.codecId=Wu(e,r);break;case Nu.CodecPrivate:if(!this.currentTrack)break;this.currentTrack.codecPrivate=vd(e,r);break;case Nu.DefaultDuration:if(!this.currentTrack)break;this.currentTrack.defaultDuration=this.currentTrack.segment.timestampFactor*Uu(e,r)/1e9;break;case Nu.Name:if(!this.currentTrack)break;this.currentTrack.name=Hu(e,r);break;case Nu.Language:if(!this.currentTrack)break;if(this.currentTrack.languageCode!==wc)break;this.currentTrack.languageCode=Wu(e,r),Sc(this.currentTrack.languageCode)||(this.currentTrack.languageCode=wc);break;case Nu.LanguageBCP47:{if(!this.currentTrack)break;const t=Wu(e,r).split("-")[0];this.currentTrack.languageCode=t||wc}break;case Nu.Video:var l;if("video"!==(null===(l=this.currentTrack)||void 0===l||null===(l=l.info)||void 0===l?void 0:l.type))break;this.readContiguousElements(e.slice(o,r));break;case Nu.PixelWidth:var c;if("video"!==(null===(c=this.currentTrack)||void 0===c||null===(c=c.info)||void 0===c?void 0:c.type))break;this.currentTrack.info.width=Uu(e,r);break;case Nu.PixelHeight:var u;if("video"!==(null===(u=this.currentTrack)||void 0===u||null===(u=u.info)||void 0===u?void 0:u.type))break;this.currentTrack.info.height=Uu(e,r);break;case Nu.AlphaMode:var d;if("video"!==(null===(d=this.currentTrack)||void 0===d||null===(d=d.info)||void 0===d?void 0:d.type))break;this.currentTrack.info.alphaMode=1===Uu(e,r);break;case Nu.Colour:var h;if("video"!==(null===(h=this.currentTrack)||void 0===h||null===(h=h.info)||void 0===h?void 0:h.type))break;this.currentTrack.info.colorSpace={},this.readContiguousElements(e.slice(o,r));break;case Nu.MatrixCoefficients:{var p,f;if("video"!==(null===(p=this.currentTrack)||void 0===p||null===(p=p.info)||void 0===p?void 0:p.type)||!this.currentTrack.info.colorSpace)break;const t=Uu(e,r),n=null!==(f=uc[t])&&void 0!==f?f:null;this.currentTrack.info.colorSpace.matrix=n}break;case Nu.Range:var g;if("video"!==(null===(g=this.currentTrack)||void 0===g||null===(g=g.info)||void 0===g?void 0:g.type)||!this.currentTrack.info.colorSpace)break;this.currentTrack.info.colorSpace.fullRange=2===Uu(e,r);break;case Nu.TransferCharacteristics:{var m,y;if("video"!==(null===(m=this.currentTrack)||void 0===m||null===(m=m.info)||void 0===m?void 0:m.type)||!this.currentTrack.info.colorSpace)break;const t=Uu(e,r),n=null!==(y=lc[t])&&void 0!==y?y:null;this.currentTrack.info.colorSpace.transfer=n}break;case Nu.Primaries:{var v,b;if("video"!==(null===(v=this.currentTrack)||void 0===v||null===(v=v.info)||void 0===v?void 0:v.type)||!this.currentTrack.info.colorSpace)break;const t=Uu(e,r),n=null!==(b=sc[t])&&void 0!==b?b:null;this.currentTrack.info.colorSpace.primaries=n}break;case Nu.Projection:var w;if("video"!==(null===(w=this.currentTrack)||void 0===w||null===(w=w.info)||void 0===w?void 0:w.type))break;this.readContiguousElements(e.slice(o,r));break;case Nu.ProjectionPoseRoll:{var k;if("video"!==(null===(k=this.currentTrack)||void 0===k||null===(k=k.info)||void 0===k?void 0:k.type))break;const t=-$u(e,r);try{this.currentTrack.info.rotation=Xl(t)}catch{}}break;case Nu.Audio:var x;if("audio"!==(null===(x=this.currentTrack)||void 0===x||null===(x=x.info)||void 0===x?void 0:x.type))break;this.readContiguousElements(e.slice(o,r));break;case Nu.SamplingFrequency:var S;if("audio"!==(null===(S=this.currentTrack)||void 0===S||null===(S=S.info)||void 0===S?void 0:S.type))break;this.currentTrack.info.sampleRate=$u(e,r);break;case Nu.Channels:var C;if("audio"!==(null===(C=this.currentTrack)||void 0===C||null===(C=C.info)||void 0===C?void 0:C.type))break;this.currentTrack.info.numberOfChannels=Uu(e,r);break;case Nu.BitDepth:var _;if("audio"!==(null===(_=this.currentTrack)||void 0===_||null===(_=_.info)||void 0===_?void 0:_.type))break;this.currentTrack.info.bitDepth=Uu(e,r);break;case Nu.CuePoint:if(!this.currentSegment)break;this.readContiguousElements(e.slice(o,r)),this.currentCueTime=null;break;case Nu.CueTime:this.currentCueTime=Uu(e,r);break;case Nu.CueTrackPositions:{if(null===this.currentCueTime)break;Kl(this.currentSegment);const t={time:this.currentCueTime,trackId:-1,clusterPosition:-1};this.currentSegment.cuePoints.push(t),this.readContiguousElements(e.slice(o,r)),-1!==t.trackId&&-1!==t.clusterPosition||this.currentSegment.cuePoints.pop()}break;case Nu.CueTrack:{var E;const t=null===(E=this.currentSegment)||void 0===E?void 0:E.cuePoints[this.currentSegment.cuePoints.length-1];if(!t)break;t.trackId=Uu(e,r)}break;case Nu.CueClusterPosition:{var T;const t=null===(T=this.currentSegment)||void 0===T?void 0:T.cuePoints[this.currentSegment.cuePoints.length-1];if(!t)break;Kl(this.currentSegment),t.clusterPosition=this.currentSegment.dataStartPos+Uu(e,r)}break;case Nu.Timestamp:if(!this.currentCluster)break;this.currentCluster.timestamp=Uu(e,r);break;case Nu.SimpleBlock:{var P;if(!this.currentCluster)break;const t=Bu(e);if(null===t)break;const n=this.getTrackDataInCluster(this.currentCluster,t);if(!n)break;const i=xd(e),s=bd(e),a=s>>1&3;let l=!!(128&s);"audio"===(null===(P=n.track.info)||void 0===P?void 0:P.type)&&n.track.info.codec&&(l=!0);const c=vd(e,r-(e.filePos-o));n.blocks.push({timestamp:i,duration:0,isKeyFrame:l,data:c,lacing:a,decoded:!(n.track.decodingInstructions.length>0),mainAdditional:null})}break;case Nu.BlockGroup:if(!this.currentCluster)break;this.readContiguousElements(e.slice(o,r)),this.currentBlock=null;break;case Nu.Block:{if(!this.currentCluster)break;const t=Bu(e);if(null===t)break;const n=this.getTrackDataInCluster(this.currentCluster,t);if(!n)break;const i=xd(e),s=bd(e)>>1&3,a=vd(e,r-(e.filePos-o));this.currentBlock={timestamp:i,duration:0,isKeyFrame:!0,data:a,lacing:s,decoded:!(n.track.decodingInstructions.length>0),mainAdditional:null},n.blocks.push(this.currentBlock)}break;case Nu.BlockAdditions:this.readContiguousElements(e.slice(o,r));break;case Nu.BlockMore:if(!this.currentBlock)break;this.currentBlockAdditional={addId:1,data:null},this.readContiguousElements(e.slice(o,r)),this.currentBlockAdditional.data&&1===this.currentBlockAdditional.addId&&(this.currentBlock.mainAdditional=this.currentBlockAdditional.data),this.currentBlockAdditional=null;break;case Nu.BlockAdditional:if(!this.currentBlockAdditional)break;this.currentBlockAdditional.data=vd(e,r);break;case Nu.BlockAddID:if(!this.currentBlockAdditional)break;this.currentBlockAdditional.addId=Uu(e,r);break;case Nu.BlockDuration:if(!this.currentBlock)break;this.currentBlock.duration=Uu(e,r);break;case Nu.ReferenceBlock:if(!this.currentBlock)break;this.currentBlock.isKeyFrame=!1;break;case Nu.Tag:this.currentTagTargetIsMovie=!0,this.readContiguousElements(e.slice(o,r));break;case Nu.Targets:this.readContiguousElements(e.slice(o,r));break;case Nu.TargetTypeValue:50!==Uu(e,r)&&(this.currentTagTargetIsMovie=!1);break;case Nu.TagTrackUID:case Nu.TagEditionUID:case Nu.TagChapterUID:case Nu.TagAttachmentUID:this.currentTagTargetIsMovie=!1;break;case Nu.SimpleTag:if(!this.currentTagTargetIsMovie)break;this.currentSimpleTagName=null,this.readContiguousElements(e.slice(o,r));break;case Nu.TagName:this.currentSimpleTagName=Hu(e,r);break;case Nu.TagString:{if(!this.currentSimpleTagName)break;const t=Hu(e,r);this.processTagValue(this.currentSimpleTagName,t)}break;case Nu.TagBinary:{if(!this.currentSimpleTagName)break;const t=vd(e,r);this.processTagValue(this.currentSimpleTagName,t)}break;case Nu.AttachedFile:{var I;if(!this.currentSegment)break;this.currentAttachedFile={fileUid:null,fileName:null,fileMediaType:null,fileData:null,fileDescription:null},this.readContiguousElements(e.slice(o,r));const t=this.currentSegment.metadataTags;var A,O,L;if(this.currentAttachedFile.fileUid&&this.currentAttachedFile.fileData&&(t.raw??={},t.raw[this.currentAttachedFile.fileUid.toString()]=new Tc(this.currentAttachedFile.fileData,null!==(A=this.currentAttachedFile.fileMediaType)&&void 0!==A?A:void 0,null!==(O=this.currentAttachedFile.fileName)&&void 0!==O?O:void 0,null!==(L=this.currentAttachedFile.fileDescription)&&void 0!==L?L:void 0)),null!==(I=this.currentAttachedFile.fileMediaType)&&void 0!==I&&I.startsWith("image/")&&this.currentAttachedFile.fileData){var N,R;const e=this.currentAttachedFile.fileName;let n="unknown";if(e){const t=e.toLowerCase();t.startsWith("cover.")?n="coverFront":t.startsWith("back.")&&(n="coverBack")}t.images??=[],t.images.push({data:this.currentAttachedFile.fileData,mimeType:this.currentAttachedFile.fileMediaType,kind:n,name:null!==(N=this.currentAttachedFile.fileName)&&void 0!==N?N:void 0,description:null!==(R=this.currentAttachedFile.fileDescription)&&void 0!==R?R:void 0})}this.currentAttachedFile=null}break;case Nu.FileUID:if(!this.currentAttachedFile)break;this.currentAttachedFile.fileUid=((e,t)=>{if(t<1)throw new Error("Bad unsigned int size "+t);let n=0n;for(let i=0;i<t;i++)n<<=8n,n+=BigInt(bd(e));return n})(e,r);break;case Nu.FileName:if(!this.currentAttachedFile)break;this.currentAttachedFile.fileName=Hu(e,r);break;case Nu.FileMediaType:if(!this.currentAttachedFile)break;this.currentAttachedFile.fileMediaType=Wu(e,r);break;case Nu.FileData:if(!this.currentAttachedFile)break;this.currentAttachedFile.fileData=vd(e,r);break;case Nu.FileDescription:if(!this.currentAttachedFile)break;this.currentAttachedFile.fileDescription=Hu(e,r);break;case Nu.ContentEncodings:if(!this.currentTrack)break;this.readContiguousElements(e.slice(o,r)),this.currentTrack.decodingInstructions.sort(((e,t)=>t.order-e.order));break;case Nu.ContentEncoding:this.currentDecodingInstruction={order:0,scope:Xu.Block,data:null},this.readContiguousElements(e.slice(o,r)),this.currentDecodingInstruction.data&&this.currentTrack.decodingInstructions.push(this.currentDecodingInstruction),this.currentDecodingInstruction=null;break;case Nu.ContentEncodingOrder:if(!this.currentDecodingInstruction)break;this.currentDecodingInstruction.order=Uu(e,r);break;case Nu.ContentEncodingScope:if(!this.currentDecodingInstruction)break;this.currentDecodingInstruction.scope=Uu(e,r);break;case Nu.ContentCompression:if(!this.currentDecodingInstruction)break;this.currentDecodingInstruction.data={type:"decompress",algorithm:Qu.Zlib,settings:null},this.readContiguousElements(e.slice(o,r));break;case Nu.ContentCompAlgo:var D;if("decompress"!==(null===(D=this.currentDecodingInstruction)||void 0===D||null===(D=D.data)||void 0===D?void 0:D.type))break;this.currentDecodingInstruction.data.algorithm=Uu(e,r);break;case Nu.ContentCompSettings:var M;if("decompress"!==(null===(M=this.currentDecodingInstruction)||void 0===M||null===(M=M.data)||void 0===M?void 0:M.type))break;this.currentDecodingInstruction.data.settings=vd(e,r);break;case Nu.ContentEncryption:if(!this.currentDecodingInstruction)break;this.currentDecodingInstruction.data={type:"decrypt"}}return e.filePos=o+r,!0}decodeBlockData(e,t){Kl(e.decodingInstructions.length>0);let n=t;for(const t of e.decodingInstructions)if(Kl(t.data),"decompress"===t.data.type&&t.data.algorithm===Qu.HeaderStripping&&t.data.settings&&t.data.settings.length>0){const e=t.data.settings,i=new Uint8Array(e.length+n.length);i.set(e,0),i.set(n,e.length),n=i}return n}processTagValue(e,t){var n;if(null===(n=this.currentSegment)||void 0===n||!n.metadataTags)return;const i=this.currentSegment.metadataTags;if(i.raw??={},i.raw[e]??=t,"string"==typeof t)switch(e.toLowerCase()){case"title":i.title??=t;break;case"description":i.description??=t;break;case"artist":i.artist??=t;break;case"album":i.album??=t;break;case"album_artist":i.albumArtist??=t;break;case"genre":i.genre??=t;break;case"comment":i.comment??=t;break;case"lyrics":i.lyrics??=t;break;case"date":{const e=new Date(t);Number.isNaN(e.getTime())||(i.date??=e)}break;case"track_number":case"part_number":{const e=t.split("/"),n=Number.parseInt(e[0],10),r=e[1]&&Number.parseInt(e[1],10);Number.isInteger(n)&&n>0&&(i.trackNumber??=n),r&&Number.isInteger(r)&&r>0&&(i.tracksTotal??=r)}break;case"disc_number":case"disc":{const e=t.split("/"),n=Number.parseInt(e[0],10),r=e[1]&&Number.parseInt(e[1],10);Number.isInteger(n)&&n>0&&(i.discNumber??=n),r&&Number.isInteger(r)&&r>0&&(i.discsTotal??=r)}}}}class td{constructor(e){this.internalTrack=e,this.packetToClusterLocation=new WeakMap}getId(){return this.internalTrack.id}getCodec(){throw new Error("Not implemented on base class.")}getInternalCodecId(){return this.internalTrack.codecId}async computeDuration(){var e,t;const n=await this.getPacket(1/0,{metadataOnly:!0});return(null!==(e=null==n?void 0:n.timestamp)&&void 0!==e?e:0)+(null!==(t=null==n?void 0:n.duration)&&void 0!==t?t:0)}getName(){return this.internalTrack.name}getLanguageCode(){return this.internalTrack.languageCode}async getFirstTimestamp(){var e;const t=await this.getFirstPacket({metadataOnly:!0});return null!==(e=null==t?void 0:t.timestamp)&&void 0!==e?e:0}getTimeResolution(){return this.internalTrack.segment.timestampFactor}getDisposition(){return this.internalTrack.disposition}async getFirstPacket(e){return this.performClusterLookup(null,(e=>e.trackData.get(this.internalTrack.id)?{blockIndex:0,correctBlockFound:!0}:{blockIndex:-1,correctBlockFound:!1}),-1/0,1/0,e)}intoTimescale(e){return kc(e*this.internalTrack.segment.timestampFactor)}async getPacket(e,t){const n=this.intoTimescale(e);return this.performClusterLookup(null,(e=>{const t=e.trackData.get(this.internalTrack.id);if(!t)return{blockIndex:-1,correctBlockFound:!1};const i=fc(t.presentationTimestamps,n,(e=>e.timestamp));return{blockIndex:-1!==i?t.presentationTimestamps[i].blockIndex:-1,correctBlockFound:-1!==i&&n<t.endTimestamp}}),n,n,t)}async getNextPacket(e,t){const n=this.packetToClusterLocation.get(e);if(void 0===n)throw new Error("Packet was not created from this track.");return this.performClusterLookup(n.cluster,(e=>{if(e===n.cluster){const t=e.trackData.get(this.internalTrack.id);if(n.blockIndex+1<t.blocks.length)return{blockIndex:n.blockIndex+1,correctBlockFound:!0}}else if(e.trackData.get(this.internalTrack.id))return{blockIndex:0,correctBlockFound:!0};return{blockIndex:-1,correctBlockFound:!1}}),-1/0,1/0,t)}async getKeyPacket(e,t){const n=this.intoTimescale(e);return this.performClusterLookup(null,(e=>{const t=e.trackData.get(this.internalTrack.id);if(!t)return{blockIndex:-1,correctBlockFound:!1};const i=mc(t.presentationTimestamps,(e=>t.blocks[e.blockIndex].isKeyFrame&&e.timestamp<=n));return{blockIndex:-1!==i?t.presentationTimestamps[i].blockIndex:-1,correctBlockFound:-1!==i&&n<t.endTimestamp}}),n,n,t)}async getNextKeyPacket(e,t){const n=this.packetToClusterLocation.get(e);if(void 0===n)throw new Error("Packet was not created from this track.");return this.performClusterLookup(n.cluster,(e=>{if(e===n.cluster){const t=e.trackData.get(this.internalTrack.id).blocks.findIndex(((e,t)=>e.isKeyFrame&&t>n.blockIndex));if(-1!==t)return{blockIndex:t,correctBlockFound:!0}}else{const t=e.trackData.get(this.internalTrack.id);if(t&&null!==t.firstKeyFrameTimestamp){const e=t.blocks.findIndex((e=>e.isKeyFrame));return Kl(-1!==e),{blockIndex:e,correctBlockFound:!0}}}return{blockIndex:-1,correctBlockFound:!1}}),-1/0,1/0,t)}async fetchPacketInCluster(e,t,n){var i;if(-1===t)return null;const r=e.trackData.get(this.internalTrack.id).blocks[t];Kl(r),r.decoded||(r.data=this.internalTrack.demuxer.decodeBlockData(this.internalTrack,r.data),r.decoded=!0);const o=n.metadataOnly?au:r.data,s=r.timestamp/this.internalTrack.segment.timestampFactor,a=r.duration/this.internalTrack.segment.timestampFactor,l={};r.mainAdditional&&"video"===(null===(i=this.internalTrack.info)||void 0===i?void 0:i.type)&&this.internalTrack.info.alphaMode&&(l.alpha=n.metadataOnly?au:r.mainAdditional,l.alphaByteLength=r.mainAdditional.byteLength);const c=new lu(o,r.isKeyFrame?"key":"delta",s,a,e.dataStartPos+t,r.data.byteLength,l);return this.packetToClusterLocation.set(c,{cluster:e,blockIndex:t}),c}async performClusterLookup(e,t,n,i,r){var o,s;const{demuxer:a,segment:l}=this.internalTrack;let c=null,u=null,d=-1;if(e){const{blockIndex:n,correctBlockFound:i}=t(e);if(i)return this.fetchPacketInCluster(e,n,r);-1!==n&&(u=e,d=n)}const h=fc(this.internalTrack.cuePoints,n,(e=>e.time)),p=-1!==h?this.internalTrack.cuePoints[h]:null,f=fc(this.internalTrack.clusterPositionCache,n,(e=>e.startTimestamp)),g=-1!==f?this.internalTrack.clusterPositionCache[f]:null,m=Math.max(null!==(o=null==p?void 0:p.clusterPosition)&&void 0!==o?o:0,null!==(s=null==g?void 0:g.elementStartPos)&&void 0!==s?s:0)||null;let y;for(e?null===m||e.elementStartPos>=m?(y=e.elementEndPos,c=e):y=m:y=null!=m?m:l.clusterSeekStartPos;null===l.elementEndPos||y<=l.elementEndPos-2;){if(c){const e=c.trackData.get(this.internalTrack.id);if(e&&e.startTimestamp>i)break}let e=a.reader.requestSliceRange(y,2,Mu);if(e instanceof Promise&&(e=await e),!e)break;const n=y,o=Vu(e);if(!o||!Ru.includes(o.id)&&o.id!==Nu.Void){var v;const e=await qu(a.reader,n,Ru,Math.min(null!==(v=l.elementEndPos)&&void 0!==v?v:1/0,n+Ju));if(e){y=e;continue}break}const s=o.id;let h=o.size;const p=e.filePos;if(s===Nu.Cluster){c=await a.readCluster(n,l),h=c.elementEndPos-p;const{blockIndex:e,correctBlockFound:i}=t(c);if(i)return this.fetchPacketInCluster(c,e,r);-1!==e&&(u=c,d=e)}null===h&&(Kl(s!==Nu.Cluster),h=(await Gu(a.reader,p,Du,l.elementEndPos)).pos-p);const f=p+h;if(null===l.elementEndPos){let e=a.reader.requestSliceRange(f,2,Mu);if(e instanceof Promise&&(e=await e),!e)break;if(ju(e)===Nu.Segment){l.elementEndPos=f;break}}y=f}if(p&&(!u||u.elementStartPos<p.clusterPosition)){var b;const e=this.internalTrack.cuePoints[h-1];Kl(!e||e.time<p.time);const n=null!==(b=null==e?void 0:e.time)&&void 0!==b?b:-1/0;return this.performClusterLookup(null,t,n,i,r)}return u?this.fetchPacketInCluster(u,d,r):null}}class nd extends td{constructor(e){super(e),this.decoderConfigPromise=null,this.internalTrack=e}getCodec(){return this.internalTrack.info.codec}getCodedWidth(){return this.internalTrack.info.width}getCodedHeight(){return this.internalTrack.info.height}getRotation(){return this.internalTrack.info.rotation}async getColorSpace(){var e,t,n,i;return{primaries:null===(e=this.internalTrack.info.colorSpace)||void 0===e?void 0:e.primaries,transfer:null===(t=this.internalTrack.info.colorSpace)||void 0===t?void 0:t.transfer,matrix:null===(n=this.internalTrack.info.colorSpace)||void 0===n?void 0:n.matrix,fullRange:null===(i=this.internalTrack.info.colorSpace)||void 0===i?void 0:i.fullRange}}async canBeTransparent(){return this.internalTrack.info.alphaMode}async getDecoderConfig(){return this.internalTrack.info.codec?this.decoderConfigPromise??=(async(e,t)=>{let n=null;return("vp9"===this.internalTrack.info.codec||"av1"===this.internalTrack.info.codec||"avc"===this.internalTrack.info.codec&&!this.internalTrack.info.codecDescription||"hevc"===this.internalTrack.info.codec&&!this.internalTrack.info.codecDescription)&&(n=await this.getFirstPacket({})),{codec:Oc({width:this.internalTrack.info.width,height:this.internalTrack.info.height,codec:this.internalTrack.info.codec,codecDescription:this.internalTrack.info.codecDescription,colorSpace:this.internalTrack.info.colorSpace,avcType:1,avcCodecInfo:"avc"===this.internalTrack.info.codec&&n?Wc(n.data):null,hevcCodecInfo:"hevc"===this.internalTrack.info.codec&&n?Gc(n.data):null,vp9CodecInfo:"vp9"===this.internalTrack.info.codec&&n?eu(n.data):null,av1CodecInfo:"av1"===this.internalTrack.info.codec&&n?nu(n.data):null}),codedWidth:this.internalTrack.info.width,codedHeight:this.internalTrack.info.height,description:null!==(e=this.internalTrack.info.codecDescription)&&void 0!==e?e:void 0,colorSpace:null!==(t=this.internalTrack.info.colorSpace)&&void 0!==t?t:void 0}})():null}}class id extends td{constructor(e){super(e),this.decoderConfig=null,this.internalTrack=e}getCodec(){return this.internalTrack.info.codec}getNumberOfChannels(){return this.internalTrack.info.numberOfChannels}getSampleRate(){return this.internalTrack.info.sampleRate}async getDecoderConfig(){var e;return this.internalTrack.info.codec?this.decoderConfig??={codec:Lc({codec:this.internalTrack.info.codec,codecDescription:this.internalTrack.info.codecDescription,aacCodecInfo:this.internalTrack.info.aacCodecInfo}),numberOfChannels:this.internalTrack.info.numberOfChannels,sampleRate:this.internalTrack.info.sampleRate,description:null!==(e=this.internalTrack.info.codecDescription)&&void 0!==e?e:void 0}:null}}class rd{}class od extends rd{async _getMajorBrand(e){let t=e._reader.requestSlice(0,12);return t instanceof Promise&&(t=await t),t?(t.skip(4),"ftyp"!==Id(t,4)?null:Id(t,4)):null}_createDemuxer(e){return new xu(e)}}class sd extends od{async _canReadInput(e){const t=await this._getMajorBrand(e);return!!t&&"qt  "!==t}get name(){return"MP4"}get mimeType(){return"video/mp4"}}class ad extends rd{async isSupportedEBMLOfDocType(e,t){let n=e._reader.requestSlice(0,Mu);if(n instanceof Promise&&(n=await n),!n)return!1;const i=Fu(n);if(null===i)return!1;if(i<1||i>8)return!1;if(Uu(n,i)!==Nu.EBML)return!1;const r=zu(n);if(null===r)return!1;let o=e._reader.requestSlice(n.filePos,r);if(o instanceof Promise&&(o=await o),!o)return!1;const s=n.filePos;for(;o.filePos<=s+r-2;){const e=Vu(o);if(!e)break;const{id:n,size:i}=e,r=o.filePos;if(null===i)return!1;switch(n){case Nu.EBMLVersion:case Nu.EBMLReadVersion:if(1!==Uu(o,i))return!1;break;case Nu.DocType:if(Wu(o,i)!==t)return!1;break;case Nu.DocTypeVersion:if(Uu(o,i)>4)return!1}o.filePos=r+i}return!0}_canReadInput(e){return this.isSupportedEBMLOfDocType(e,"matroska")}_createDemuxer(e){return new ed(e)}get name(){return"Matroska"}get mimeType(){return"video/x-matroska"}}class ld extends ad{_canReadInput(e){return this.isSupportedEBMLOfDocType(e,"webm")}get name(){return"WebM"}get mimeType(){return"video/webm"}}const cd=new sd,ud=new ld;class dd{constructor(){this._disposed=!1,this._sizePromise=null,this.onread=null}async getSizeOrNull(){if(this._disposed)throw new fd;return this._sizePromise??=Promise.resolve(this._retrieveSize())}async getSize(){if(this._disposed)throw new fd;const e=await this.getSizeOrNull();if(null===e)throw new Error("Cannot determine the size of an unsized source.");return e}}class hd extends dd{constructor(e,t={}){var n;if(!(e instanceof ReadableStream))throw new TypeError("stream must be a ReadableStream.");if(!t||"object"!=typeof t)throw new TypeError("options must be an object.");if(void 0!==t.maxCacheSize&&(!_c(t.maxCacheSize)||t.maxCacheSize<0))throw new TypeError("options.maxCacheSize, when provided, must be a non-negative number.");super(),this._reader=null,this._cache=[],this._pendingSlices=[],this._currentIndex=0,this._targetIndex=0,this._maxRequestedIndex=0,this._endIndex=null,this._pulling=!1,this._stream=e,this._maxCacheSize=null!==(n=t.maxCacheSize)&&void 0!==n?n:16777216}_retrieveSize(){return this._endIndex}_read(e,t){if(null!==this._endIndex&&t>this._endIndex)return null;this._maxRequestedIndex=Math.max(this._maxRequestedIndex,t);const n=fc(this._cache,e,(e=>e.start)),i=-1!==n?this._cache[n]:null;if(i&&i.start<=e&&t<=i.end)return{bytes:i.bytes,view:i.view,offset:i.start};let r=e;const o=new Uint8Array(t-e);if(-1!==n)for(let i=n;i<this._cache.length;i++){const n=this._cache[i];if(n.start>=t)break;const s=Math.max(e,n.start);s>r&&this._throwDueToCacheMiss();const a=Math.min(t,n.end);s<a&&(o.set(n.bytes.subarray(s-n.start,a-n.start),s-e),r=a)}if(r===t)return{bytes:o,view:nc(o),offset:e};this._currentIndex>r&&this._throwDueToCacheMiss();const{promise:s,resolve:a,reject:l}=gc();return this._pendingSlices.push({start:e,end:t,bytes:o,resolve:a,reject:l}),this._targetIndex=Math.max(this._targetIndex,t),this._pulling||(this._pulling=!0,this._pull().catch((e=>{if(this._pulling=!1,!(this._pendingSlices.length>0))throw e;this._pendingSlices.forEach((t=>t.reject(e))),this._pendingSlices.length=0}))),s}_throwDueToCacheMiss(){throw new Error("Read is before the cached region. With ReadableStreamSource, you must access the data more sequentially or increase the size of its cache.")}async _pull(){for(this._reader??=this._stream.getReader();this._currentIndex<this._targetIndex&&!this._disposed;){const{done:e,value:t}=await this._reader.read();if(e){for(const e of this._pendingSlices)e.resolve(null);this._pendingSlices.length=0,this._endIndex=this._currentIndex;break}const n=this._currentIndex,i=this._currentIndex+t.byteLength;for(let e=0;e<this._pendingSlices.length;e++){const r=this._pendingSlices[e],o=Math.max(n,r.start),s=Math.min(i,r.end);o<s&&(r.bytes.set(t.subarray(o-n,s-n),o-r.start),s===r.end&&(r.resolve({bytes:r.bytes,view:nc(r.bytes),offset:r.start}),this._pendingSlices.splice(e,1),e--))}for(this._cache.push({start:n,end:i,bytes:t,view:nc(t),age:0});this._cache.length>0&&!(this._maxRequestedIndex-this._cache[0].end<=this._maxCacheSize);)this._cache.shift();this._currentIndex+=t.byteLength}this._pulling=!1}_dispose(){this._pendingSlices.length=0,this._cache.length=0}}Symbol.dispose??=Symbol("Symbol.dispose");class pd{get disposed(){return this._disposed}constructor(e){if(this._demuxerPromise=null,this._format=null,this._disposed=!1,!e||"object"!=typeof e)throw new TypeError("options must be an object.");if(!Array.isArray(e.formats)||e.formats.some((e=>!(e instanceof rd))))throw new TypeError("options.formats must be an array of InputFormat.");if(!(e.source instanceof dd))throw new TypeError("options.source must be a Source.");if(e.source._disposed)throw new Error("options.source must not be disposed.");this._formats=e.formats,this._source=e.source,this._reader=new gd(e.source)}_getDemuxer(){return this._demuxerPromise??=(async()=>{this._reader.fileSize=await this._source.getSizeOrNull();for(const e of this._formats)if(await e._canReadInput(this))return this._format=e,e._createDemuxer(this);throw new Error("Input has an unsupported or unrecognizable format.")})()}get source(){return this._source}async getFormat(){return await this._getDemuxer(),Kl(this._format),this._format}async computeDuration(){return(await this._getDemuxer()).computeDuration()}async getTracks(){return(await this._getDemuxer()).getTracks()}async getVideoTracks(){return(await this.getTracks()).filter((e=>e.isVideoTrack()))}async getAudioTracks(){return(await this.getTracks()).filter((e=>e.isAudioTrack()))}async getPrimaryVideoTrack(){var e;return null!==(e=(await this.getTracks()).find((e=>e.isVideoTrack())))&&void 0!==e?e:null}async getPrimaryAudioTrack(){var e;return null!==(e=(await this.getTracks()).find((e=>e.isAudioTrack())))&&void 0!==e?e:null}async getMimeType(){return(await this._getDemuxer()).getMimeType()}async getMetadataTags(){return(await this._getDemuxer()).getMetadataTags()}dispose(){this._disposed||(this._disposed=!0,this._source._disposed=!0,this._source._dispose())}[Symbol.dispose](){this.dispose()}}class fd extends Error{constructor(e="Input has been disposed."){super(e),this.name="InputDisposedError"}}class gd{constructor(e){this.source=e}requestSlice(e,t){if(this.source._disposed)throw new fd;if(null!==this.fileSize&&e+t>this.fileSize)return null;const n=e+t,i=this.source._read(e,n);return i instanceof Promise?i.then((t=>t?new md(t.bytes,t.view,t.offset,e,n):null)):i?new md(i.bytes,i.view,i.offset,e,n):null}requestSliceRange(e,t,n){if(this.source._disposed)throw new fd;if(null!==this.fileSize)return this.requestSlice(e,bc(this.fileSize-e,t,n));{const i=this.requestSlice(e,n),r=i=>{if(i)return i;const r=i=>(Kl(null!==i),this.requestSlice(e,bc(i-e,t,n))),o=this.source._retrieveSize();return o instanceof Promise?o.then(r):r(o)};return i instanceof Promise?i.then(r):r(i)}}}class md{constructor(e,t,n,i,r){this.bytes=e,this.view=t,this.offset=n,this.start=i,this.end=r,this.bufferPos=i-n}static tempFromBytes(e){return new md(e,nc(e),0,0,e.length)}get length(){return this.end-this.start}get filePos(){return this.offset+this.bufferPos}set filePos(e){this.bufferPos=e-this.offset}get remainingLength(){return Math.max(this.end-this.filePos,0)}skip(e){this.bufferPos+=e}slice(e,t=this.end-e){if(e<this.start||e+t>this.end)throw new RangeError("Slicing outside of original slice.");return new md(this.bytes,this.view,this.offset,e,e+t)}}const yd=(e,t)=>{if(e.filePos<e.start||e.filePos+t>e.end)throw new RangeError(`Tried reading [${e.filePos}, ${e.filePos+t}), but slice is [${e.start}, ${e.end}). This is likely an internal error, please report it alongside the file that caused it.`)},vd=(e,t)=>{yd(e,t);const n=e.bytes.subarray(e.bufferPos,e.bufferPos+t);return e.bufferPos+=t,n},bd=e=>(yd(e,1),e.view.getUint8(e.bufferPos++)),wd=e=>{yd(e,2);const t=e.view.getUint16(e.bufferPos,!1);return e.bufferPos+=2,t},kd=e=>{yd(e,3);const t=vc(e.view,e.bufferPos);return e.bufferPos+=3,t},xd=e=>{yd(e,2);const t=e.view.getInt16(e.bufferPos,!1);return e.bufferPos+=2,t},Sd=e=>{yd(e,4);const t=e.view.getUint32(e.bufferPos,!1);return e.bufferPos+=4,t},Cd=e=>{yd(e,4);const t=e.view.getInt32(e.bufferPos,!1);return e.bufferPos+=4,t},_d=e=>4294967296*Sd(e)+Sd(e),Ed=e=>4294967296*Cd(e)+Sd(e),Td=e=>{yd(e,4);const t=e.view.getFloat32(e.bufferPos,!1);return e.bufferPos+=4,t},Pd=e=>{yd(e,8);const t=e.view.getFloat64(e.bufferPos,!1);return e.bufferPos+=8,t},Id=(e,t)=>{yd(e,t);let n="";for(let i=0;i<t;i++)n+=String.fromCharCode(e.bytes[e.bufferPos++]);return n},Ad=me.createLogger("FMp4Demuxer","warn");var Od=new WeakMap,Ld=new WeakMap,Nd=new WeakMap,Rd=new WeakMap,Dd=new WeakMap,Md=new WeakMap,Fd=new WeakMap,Bd=new WeakSet;async function Ud(){if(Ka(Dd,this))return;Xa(Dd,this,!0);const{readable:e,writable:t}=new TransformStream;Xa(Od,this,t.getWriter());const n=new hd(e);Xa(Ld,this,new pd({formats:[cd],source:n}));const i=await Ka(Ld,this).getPrimaryVideoTrack();if(!i)return void Ad.error("[#initIfNeeded] No primary video track found in MP4");const r=await i.getDecoderConfig();Ad.debug("[#initIfNeeded] Triggering config event:",r),this.trigger("config",r),Xa(Nd,this,new hu(i)),Xa(Rd,this,(async()=>{let e=[];for await(const r of Ka(Nd,this).packets()){if(Ka(Md,this))break;var t=Math.round(1e6*r.timestamp);null===Ka(Fd,this)&&Xa(Fd,this,t);var n=t-Ka(Fd,this);n<0&&(n=0);var i=null!=r.duration?Math.round(1e6*r.duration):0;e.push({type:r.type,timestamp:n,duration:i,data:r.data}),e.length>=6&&(this.trigger("samples",e),e=[])}e.length&&this.trigger("samples",e),this.trigger("complete")})())}const jd=me.createLogger("WebMDemuxer","warn");var zd=new WeakMap,Vd=new WeakMap,Wd=new WeakMap,Hd=new WeakMap,$d=new WeakMap,Gd=new WeakMap,qd=new WeakMap,Yd=new WeakMap,Kd=new WeakSet;async function Xd(){if(Ka($d,this))return;Xa($d,this,!0);const{readable:e,writable:t}=new TransformStream;Xa(Vd,this,t.getWriter());const n=new hd(e);Xa(Wd,this,new pd({formats:[ud],source:n}));const i=await Ka(Wd,this).getPrimaryVideoTrack();if(!i)return void jd.error("[#initIfNeeded] No primary video track found in WebM");const r=await i.getDecoderConfig();Xa(qd,this,!0),jd.debug("[#initIfNeeded] Triggering config event:",r),this.trigger("config",r),Xa(Hd,this,new hu(i)),(async()=>{for await(const e of Ka(Hd,this).packets()){if(Ka(Gd,this))break;const t={type:e.type,timestamp:Math.round(1e6*e.timestamp),duration:null!=e.duration?Math.round(1e6*e.duration):0,data:e.data};Ka(Yd,this).push(t)}Ka(Yd,this).flush(),this.trigger("complete")})()}const Qd=me.createLogger("demuxerFactory","warn"),Zd={FMp4Demuxer:class extends Ti{constructor(){Ad.debug("[constructor]"),super(),nl(this,Bd),tl(this,Od,null),tl(this,Ld,null),tl(this,Nd,null),tl(this,Rd,null),tl(this,Dd,!1),tl(this,Md,!1),tl(this,Fd,null)}dispose(){Ad.debug("[dispose]"),Xa(Md,this,!0);try{var e;null===(e=Ka(Nd,this))||void 0===e||e.close()}catch(e){}try{var t;const e=null===(t=Ka(Od,this))||void 0===t?void 0:t.close();e&&"function"==typeof e.catch&&e.catch((()=>{}))}catch(e){}try{var n,i;null===(n=Ka(Ld,this))||void 0===n||null===(i=n.dispose)||void 0===i||i.call(n)}catch(e){}Xa(Nd,this,null),Xa(Od,this,null),Xa(Ld,this,null)}static isSupported(e){return Ad.debug(`[FMp4Demuxer.isSupported] Format: ${e}`),null==e?void 0:e.startsWith("fmp4")}append(e){var t;Ad.debug(`[append] ${e.byteLength} bytes [${e.byteOffset} - ${e.byteOffset+e.byteLength}]`),Ya(Bd,this,Ud).call(this),null===(t=Ka(Od,this))||void 0===t||t.write(e)}endOfStream(){Ad.debug("[endOfStream]");try{var e;const t=null===(e=Ka(Od,this))||void 0===e?void 0:e.close();t&&"function"==typeof t.catch&&t.catch((()=>{}))}catch(e){}Xa(Od,this,null)}},WebMDemuxer:class extends Ti{constructor(e,t={}){var n,i;jd.debug("[constructor]"),super(),nl(this,Kd),tl(this,zd,null),tl(this,Vd,null),tl(this,Wd,null),tl(this,Hd,null),tl(this,$d,!1),tl(this,Gd,!1),tl(this,qd,!1),tl(this,Yd,null),Xa(zd,this,e),this.onSamplesThrottlerTick=this.onSamplesThrottlerTick.bind(this),Xa(Yd,this,Qr(this.onSamplesThrottlerTick,null!==(n=null==t?void 0:t.samplesThrottleInterval)&&void 0!==n?n:100,null!==(i=null==t?void 0:t.samplesMaxCountPerTick)&&void 0!==i?i:10))}dispose(){var e;jd.debug("[dispose]"),Xa(Gd,this,!0);try{var t;null===(t=Ka(Hd,this))||void 0===t||t.close()}catch(e){}try{var n;const e=null===(n=Ka(Vd,this))||void 0===n?void 0:n.close();e&&"function"==typeof e.catch&&e.catch((()=>{}))}catch(e){}try{var i,r;null===(i=Ka(Wd,this))||void 0===i||null===(r=i.dispose)||void 0===r||r.call(i)}catch(e){}null===(e=Ka(Yd,this))||void 0===e||e.dispose(),Xa(Hd,this,null),Xa(Vd,this,null),Xa(Wd,this,null),Xa(Yd,this,null)}static isSupported(e){return null==e?void 0:e.startsWith("webm")}onSamplesThrottlerTick(e){e&&e.length&&(jd.info(`[onSamplesThrottlerTick] ${e.length} samples`),this.trigger("samples",e))}append(e){var t;Ya(Kd,this,Xd).call(this),null===(t=Ka(Vd,this))||void 0===t||t.write(e)}endOfStream(){jd.debug("[endOfStream]");try{var e;const t=null===(e=Ka(Vd,this))||void 0===e?void 0:e.close();t&&"function"==typeof t.catch&&t.catch((()=>{}))}catch(e){}Xa(Vd,this,null)}}};const Jd=me.createLogger("VideoSegmentDecoder","warn"),eh=93312e3,th="no-preference";let nh="",ih=!1;var rh=new WeakMap,oh=new WeakMap,sh=new WeakMap,ah=new WeakMap,lh=new WeakMap,ch=new WeakMap,uh=new WeakMap,dh=new WeakMap,hh=new WeakMap,ph=new WeakMap,fh=new WeakMap,gh=new WeakMap,mh=new WeakMap,yh=new WeakMap,vh=new WeakMap,bh=new WeakMap,wh=new WeakMap,kh=new WeakMap,xh=new WeakMap,Sh=new WeakMap,Ch=new WeakMap,_h=new WeakMap,Eh=new WeakMap,Th=new WeakMap,Ph=new WeakMap,Ih=new WeakMap,Ah=new WeakSet;class Oh extends Ti{constructor(e,t,n,i,r={}){var o,s,a,l,c,u;super(),nl(this,Ah),tl(this,rh,null),tl(this,oh,""),tl(this,sh,!1),tl(this,ah,null),tl(this,lh,null),tl(this,ch,0),tl(this,uh,0),tl(this,dh,null),tl(this,hh,null),tl(this,ph,null),tl(this,fh,null),tl(this,gh,!1),tl(this,mh,0),tl(this,yh,3110400),tl(this,vh,41708),tl(this,bh,.2),tl(this,wh,th),tl(this,kh,0),tl(this,xh,0),tl(this,Sh,[]),tl(this,Ch,!1),tl(this,_h,0),tl(this,Eh,eh),tl(this,Th,0),tl(this,Ph,0),tl(this,Ih,0),Xa(rh,this,r),Xa(ah,this,e),Xa(lh,this,t),Xa(ch,this,n||0),Xa(dh,this,i),Xa(oh,this,`[#${Ka(lh,this)}] [${Ka(ah,this)} @ ${Ka(ch,this)}]`),Jd.debug(`${Ka(oh,this)} [constructor] Playlist index: ${t}. Start time offset: ${n}. Options:`,r),nh||(nh=bi(self.env,"os.name","").toLowerCase(),ih=nh.includes("android"),Jd.info(`${Ka(oh,this)} [constructor] Detected OS: "${nh}". Is Android: ${ih}`)),Xa(gh,this,null!==(o=null==r?void 0:r.convertFramesToBitmaps)&&void 0!==o&&o),Xa(bh,this,null!==(s=null==r?void 0:r.androidFixEndOfSegmentDelta)&&void 0!==s?s:.2),Xa(wh,this,null!==(a=null==r?void 0:r.hardwareAcceleration)&&void 0!==a?a:th),Xa(Eh,this,null!==(l=null==r?void 0:r.maxBufferedBytes)&&void 0!==l?l:eh),Xa(fh,this,Qr(Ya(Ah,this,Wh).bind(this),null!==(c=null==r?void 0:r.videoFramesThrottleInterval)&&void 0!==c?c:100,{maxQueueSize:null!==(u=null==r?void 0:r.videoFramesMaxCountPerTick)&&void 0!==u?u:6,immediatelyFlushFirst:2})),this.onSegmentLoaderProgress=this.onSegmentLoaderProgress.bind(this),this.onSegmentLoaderComplete=this.onSegmentLoaderComplete.bind(this),this.onDemuxerConfig=this.onDemuxerConfig.bind(this),this.onDemuxerSamples=this.onDemuxerSamples.bind(this),this.onDemuxerComplete=this.onDemuxerComplete.bind(this),Ka(dh,this).switch(!0),Ya(Ah,this,Dh).call(this),Ka(dh,this).completed&&(Jd.debug(`${Ka(oh,this)} [constructor] Segment loader already completed`),this.onSegmentLoaderComplete())}dispose(){var e,t;Jd.debug(`[dispose] [${Ka(ah,this)}]`),Ya(Ah,this,Mh).call(this),Ya(Ah,this,Uh).call(this),null===(e=Ka(hh,this))||void 0===e||e.dispose(),((null===(t=Ka(fh,this))||void 0===t?void 0:t.dispose())||[]).forEach((e=>e.close()));try{var n;null===(n=Ka(ph,this))||void 0===n||n.close()}catch(e){}Xa(ph,this,null),Xa(ch,this,0),Xa(dh,this,null),Xa(hh,this,null),Xa(fh,this,null),Xa(Th,this,0),Xa(Ph,this,0),Xa(Ih,this,0),Xa(kh,this,0),Xa(xh,this,0),Xa(_h,this,0),Xa(sh,this,!1),Xa(uh,this,0),Xa(Sh,this,[]),Xa(oh,this,"")}onSegmentLoaderProgress(){Jd.debug(`[onSegmentLoaderProgress] [${Ka(ah,this)}]`),Ya(Ah,this,jh).call(this)}onSegmentLoaderComplete(){Jd.debug(`[onSegmentLoaderComplete] [${Ka(ah,this)}]`),Xa(_h,this,this.duration),this.trigger("buffered"),Ka(sh,this)?(Ya(Ah,this,jh).call(this),Ka(hh,this).endOfStream()):Jd.debug(`${Ka(oh,this)} [onSegmentLoaderComplete] Not yet started processing`)}onDemuxerConfig(e){Jd.debug(`[onDemuxerConfig] [${Ka(ah,this)}]`),Xa(ph,this,new self.VideoDecoder({output:Ya(Ah,this,zh).bind(this),error:Ya(Ah,this,Vh).bind(this)}));const t={...Ya(Ah,this,Hh).call(this),...e};Jd.debug(`${Ka(oh,this)} [onDemuxerConfig] Configuring decoder:`,t),Ka(ph,this).configure(t)}onDemuxerSamples(e){if(!e||0===e.length)return;Jd.debug(`${Ka(oh,this)} [onDemuxerSamples] Got ${e.length} samples`,e);const t=e.map((e=>new self.EncodedVideoChunk(e)));if(this.bufferedDuration<this.duration){const e=t[t.length-1];Xa(_h,this,Math.max(Ka(_h,this),(e.timestamp+(e.duration||0))/1e6)),this.trigger("buffered")}Ya(Ah,this,Xh).call(this,t)}async onDemuxerComplete(){Jd.debug(`[onDemuxerComplete] [${Ka(ah,this)}]`);try{var e,t;await Ya(Ah,this,qh).call(this),await(null===(e=Ka(ph,this))||void 0===e?void 0:e.flush()),null===(t=Ka(fh,this))||void 0===t||t.flush(),Jd.debug(`${Ka(oh,this)} [onDemuxerComplete] Decoder flush complete, triggering 'complete' event.`),this.trigger("complete")}catch(e){var n;if(null!=e&&null!==(n=e.message)&&void 0!==n&&n.toLowerCase().includes("abort"))return void Jd.debug(`${Ka(oh,this)} [onDemuxerComplete] Decoder flush aborted`);Ya(Ah,this,Vh).call(this,e)}}start(){Jd.debug(`[start] [${Ka(ah,this)}]`),Xa(sh,this,!0),Ka(dh,this).completed?(Jd.debug(`${Ka(oh,this)} [start] Segment loader already completed`),this.onSegmentLoaderComplete()):(Jd.debug(`${Ka(oh,this)} [start] Starting to process available bytes`),Ya(Ah,this,jh).call(this))}updateFreedBytes(e){Xa(Ph,this,e),Qa(Ah,this,Nh)<Ka(Eh,this)?(Jd.debug(`${Ka(oh,this)} [updateFreedBytes] Processing more chunks for decoding. Freed bytes: ${Qa(Ah,this,Lh)}. Retained bytes: ${Qa(Ah,this,Nh)}`),Xa(Ch,this,!1),Ya(Ah,this,Gh).call(this)):Jd.debug(`${Ka(oh,this)} [updateFreedBytes] Max buffered bytes reached (${Qa(Ah,this,Nh)} >= ${Ka(Eh,this)})`)}updatePlaybackCurrentTime(e){Xa(ch,this,Math.max(e,Ka(ch,this))),Xa(uh,this,0),Xa(Ch,this,!1),Ya(Ah,this,Gh).call(this)}get nodeId(){return Ka(ah,this)}get segmentId(){var e;return null===(e=Ka(dh,this))||void 0===e?void 0:e.segmentId}get playlistIndex(){return Ka(lh,this)}get duration(){var e,t;return null!==(e=null===(t=Ka(dh,this))||void 0===t||null===(t=t.representation)||void 0===t?void 0:t.duration)&&void 0!==e?e:0}get bufferedDuration(){return Ka(_h,this)}}function Lh(e){return Ka(Ph,e)+Ka(Ih,e)}function Nh(e){return Ka(Th,e)-Qa(Ah,e,Lh)}function Rh(e=!1){var t,n;const i=e?"on":"off";null===(t=Ka(dh,this))||void 0===t||t[i]("progress",this.onSegmentLoaderProgress),null===(n=Ka(dh,this))||void 0===n||n[i]("complete",this.onSegmentLoaderComplete)}function Dh(){Ya(Ah,this,Rh).call(this,!0)}function Mh(){Ya(Ah,this,Rh).call(this,!1)}function Fh(e=!1){var t,n,i;if(!Ka(hh,this))return;const r=e?"on":"off";null===(t=Ka(hh,this))||void 0===t||t[r]("config",this.onDemuxerConfig),null===(n=Ka(hh,this))||void 0===n||n[r]("samples",this.onDemuxerSamples),null===(i=Ka(hh,this))||void 0===i||i[r]("complete",this.onDemuxerComplete)}function Bh(){Ya(Ah,this,Fh).call(this,!0)}function Uh(){Ya(Ah,this,Fh).call(this,!1)}function jh(){if(!Ka(sh,this))return;const e=Ka(dh,this).bytesLoaded-Ka(mh,this);if(e<=0)return;var t;Ka(hh,this)||(Xa(hh,this,function(e,t={}){const{format:n}=e;Qd.debug(`Creating demuxer for format: ${n}`);for(const[i,r]of Object.entries(Zd))if(Qd.debug(`Checking demuxer "${i}" for format: ${n}`),r.isSupported(n))return Qd.debug(`Demuxer "${i}" found for format: ${n}`),new r(e,t);return Qd.error(`No demuxer found for format: ${n}`),null}(null===(t=Ka(dh,this))||void 0===t?void 0:t.representation,Ka(rh,this))),Ya(Ah,this,Bh).call(this)),Jd.debug(`${Ka(oh,this)} [#processAvailableBytes] Available bytes: ${e}`);const n=new Uint8Array(Ka(dh,this).arrayBuffer,Ka(mh,this),e);Ka(hh,this).append(n),Xa(mh,this,Ka(mh,this)+e)}async function zh(e){var t;Jd.debug(`${Ka(oh,this)} [#onDecodedVideoFrame] Got frame @ ${e.timestamp/1e6} seconds.`,e);const n=e.allocationSize();Xa(Th,this,Ka(Th,this)+n),n!==Ka(yh,this)&&(Jd.debug(`${Ka(oh,this)} [#onDecodedVideoFrame] Presumed frame size changed from ${Ka(yh,this)} to ${n} bytes`),Xa(yh,this,n)),e.duration!==Ka(vh,this)&&(Jd.debug(`${Ka(oh,this)} [#onDecodedVideoFrame] Presumed frame duration changed from ${Ka(vh,this)} to ${e.duration} microseconds`),Xa(vh,this,e.duration)),Xa(xh,this,e.timestamp),Xa(kh,this,(t=Ka(kh,this),--t)),Qa(Ah,this,Nh)>=Ka(Eh,this)?(Jd.info(`${Ka(oh,this)} [#onDecodedVideoFrame] Max buffered bytes reached (${Qa(Ah,this,Nh)} >= ${Ka(Eh,this)})`),Xa(Ch,this,!0)):Jd.info(`${Ka(oh,this)} [#onDecodedVideoFrame] Frame size: ${n} bytes. Retained bytes: ${Qa(Ah,this,Nh)}`);let i=e;if(Ka(gh,this)){Jd.debug(`${Ka(oh,this)} [#onDecodedVideoFrame] Converting frame to bitmap @ ${e.timestamp/1e6} seconds`);const t=ih&&e.timestamp/1e6>=this.duration-Ka(bh,this);t&&Jd.debug(`${Ka(oh,this)} [#onDecodedVideoFrame] Applying Android fix for end of segment @ ${e.timestamp/1e6} seconds`);const r=await createImageBitmap(e,{premultiplyAlpha:t?"none":"default"});r.timestamp=e.timestamp,r.duration=e.duration,r.displayWidth=e.displayWidth,r.displayHeight=e.displayHeight,r.allocatedBytes=n,e.close(),i=r}const r=1e6*Ka(ch,this);if(r>0&&i.timestamp+i.duration<r||Ka(uh,this)>0&&i.timestamp<Ka(uh,this))return Jd.debug(`${Ka(oh,this)} [#onDecodedVideoFrame] Skipping frame @ ${i.timestamp/1e6} seconds (before requested time ${Ka(ch,this)})`),i.close(),Xa(Ih,this,Ka(Ih,this)+n),void Ya(Ah,this,Gh).call(this);Jd.debug(`${Ka(oh,this)} [#onDecodedVideoFrame] Not skipping frame.`,{requestedStartTime:r,timestamp:i.timestamp,duration:i.duration}),Ka(fh,this).push(i)}function Vh(e){"AbortError"!==e.name?(Jd.error(`[#onDecoderError] [${Ka(ah,this)}]`,e),this.trigger("error",e)):Jd.debug(`${Ka(oh,this)} [#onDecoderError] Decoder error aborted`)}function Wh(e){Jd.info(`${Ka(oh,this)} [#notifyVideoFrames] Sending ${e.length} frames (${e[0].timestamp/1e6} - ${e[e.length-1].timestamp/1e6})`),this.trigger("videoframes",e)}function Hh(){var e,t,n;let i=null===(e=Ka(dh,this))||void 0===e||null===(e=e.representation)||void 0===e?void 0:e.codecs;return"vp9"===i&&(i="vp09.00.40.08"),{codec:i,codedWidth:null===(t=Ka(dh,this))||void 0===t||null===(t=t.representation)||void 0===t?void 0:t.width,codedHeight:null===(n=Ka(dh,this))||void 0===n||null===(n=n.representation)||void 0===n?void 0:n.height,hardwareAcceleration:Ka(wh,this),optimizeForLatency:!0}}function $h(){const e=1e6*Ka(ch,this);if(e<Ka(xh,this))return 0;const t=e-Ka(xh,this),n=Math.round(t/Ka(vh,this));return Math.min(Ka(kh,this),n)}function Gh(){if(Ka(ph,this)&&Ka(Sh,this).length&&!Ka(Ch,this))for(Ya(Ah,this,Kh).call(this),Ya(Ah,this,Yh).call(this);Ka(Sh,this).length>0&&!Ka(Ch,this);){var e,t;let n=Ka(Sh,this)[0];const i=Ya(Ah,this,$h).call(this);if(Qa(Ah,this,Nh)+(Ka(kh,this)-i)*Ka(yh,this)>=Ka(Eh,this)){Jd.debug(`${Ka(oh,this)} [#processChunksForDecoding] Pausing decoding before frame @ ${Ka(Sh,this)[0].timestamp/1e6} seconds, due to max buffered bytes expected to be reached`),Xa(Ch,this,!0);break}Ka(Sh,this).shift(),null===(t=Ka(ph,this))||void 0===t||t.decode(n),Xa(kh,this,(e=Ka(kh,this),++e)),Jd.info(`${Ka(oh,this)} [#processChunksForDecoding] Decoding chunk @ ${n.timestamp/1e6} seconds (${Ka(kh,this)} samples queued)`)}}async function qh(){for(;Ka(Sh,this).length>0;)Ya(Ah,this,Gh).call(this),await ln(10)}function Yh(){if(0===Ka(uh,this))return;let e=-1;const t=Ka(Sh,this).findIndex((e=>e.timestamp===Ka(uh,this))),n=Ka(Sh,this).slice(0,t+1);for(let t=0;t<n.length;t++)"key"===n[t].type&&(e=t);-1!==e&&(Jd.debug(`${Ka(oh,this)} [#pruneChunksBeforeStartChunkGroup] Pruning ${e} chunks before start chunk`),Ka(Sh,this).splice(0,e))}function Kh(){if(!(0===Ka(uh,this)&&Ka(ch,this)>0))return;const e=1e6*Ka(ch,this);for(const t of Ka(Sh,this)){const n=t.timestamp;if(n<=e&&e<n+(t.duration||0)){Xa(uh,this,n),Jd.debug(`${Ka(oh,this)} [#searchAndSetStartChunkTimestamp] Found start chunk @ ${Ka(uh,this)/1e6} seconds`);break}}}function Xh(e){Ka(Sh,this).push(...e),Ya(Ah,this,Gh).call(this)}const Qh=me.createLogger("segmentDecoderFactory","warn");const Zh=me.createLogger("DecodingManager","warn");var Jh=new WeakMap,ep=new WeakMap,tp=new WeakMap,np=new WeakMap,ip=new WeakMap,rp=new WeakSet;class op extends Ti{constructor(e){Zh.debug("[constructor]",e),super(),nl(this,rp),tl(this,Jh,void 0),tl(this,ep,void 0),tl(this,tp,void 0),tl(this,np,[]),tl(this,ip,null);const{workerState:t,segmentStore:n,segmentDecoderConfig:i={}}=e;Xa(Jh,this,t),Xa(ep,this,n),Xa(tp,this,i),this.onPlaylistAppend=this.onPlaylistAppend.bind(this),this.onPlaylistReset=this.onPlaylistReset.bind(this),Ya(rp,this,ap).call(this)}dispose(){var e;Zh.debug("[dispose]"),Ya(rp,this,lp).call(this),Ka(np,this).forEach((e=>{Ya(rp,this,dp).call(this,e),e.dispose()})),Ka(np,this).length=0,Ya(rp,this,dp).call(this,Ka(ip,this)),null===(e=Ka(ip,this))||void 0===e||e.dispose(),Xa(ip,this,null)}onPlaylistAppend(e,t,n=0){Ka(Jh,this).isNullNode(e)?Zh.debug.force(`[onPlaylistAppend] [${e}] Null node - skipping`):(Zh.debug(`[onPlaylistAppend] [${e}]`),Ya(rp,this,hp).call(this,{nodeId:e,index:t.length-1,startTimeOffset:n}))}onPlaylistReset(){var e;Zh.debug("[onPlaylistReset]"),Ka(np,this).forEach((e=>{Ya(rp,this,dp).call(this,e),e.dispose()})),Ya(rp,this,dp).call(this,Ka(ip,this)),null===(e=Ka(ip,this))||void 0===e||e.dispose(),Xa(ip,this,null),Xa(np,this,[])}onSegDecoderBuffered(e){if(!e)return void Zh.warn("[onSegDecoderBuffered] No SegmentDecoder provided");const t={nodeId:e.nodeId,segmentId:e.segmentId,playlistIndex:e.playlistIndex,buffered:e.bufferedDuration,duration:e.duration};Zh.debug(`[onSegDecoderBuffered] [${e.nodeId}]`,t),this.trigger("buffered",t)}onSegDecoderVideoFrames(e,t){if(!e)return void Zh.warn("[onSegDecoderVideoFrames] No SegmentDecoder provided");const n={nodeId:e.nodeId,segmentId:e.segmentId,playlistIndex:e.playlistIndex,duration:e.duration,framesMeta:t.map((e=>({timestamp:e.timestamp,duration:e.duration,displayWidth:e.displayWidth,displayHeight:e.displayHeight,allocatedBytes:e.allocatedBytes}))),frames:t};Zh.debug(`[onSegDecoderVideoFrames] [${e.nodeId}] Sending ${(null==t?void 0:t.length)||0} frames`,n),this.trigger("videoframes",n)}onSegDecoderComplete(e){e?(Zh.debug(`[onSegDecoderComplete] [#${e.playlistIndex}] [${e.nodeId}]`),Ya(rp,this,dp).call(this,e),e.dispose(),Ka(ip,this)===e?(Xa(ip,this,null),Ya(rp,this,pp).call(this)):Zh.warn(`[onSegDecoderComplete] [#${e.playlistIndex}] [${e.nodeId}] Not the current VideoSegmentDecoder`)):Zh.warn("[onSegDecoderComplete] No VideoSegmentDecoder provided")}onSegDecoderError(e,t){e?(Zh.error(`[onSegDecoderError] [${e.nodeId}]`,t),Ya(rp,this,dp).call(this,e),e.dispose(),this.trigger("error",t)):Zh.warn("[onSegDecoderError] No VideoSegmentDecoder provided")}updateFreedBytes({playlistIndex:e,bytes:t}){var n;(null===(n=Ka(ip,this))||void 0===n?void 0:n.playlistIndex)===e&&(Zh.debug(`[updateFreedBytes] [#${e}] ${t} bytes`),Ka(ip,this).updateFreedBytes(t))}updatePlaybackIndex({playlistIndex:e}){var t;if(Zh.debug(`[updatePlaybackIndex] [#${e}]`),(null===(t=Ka(ip,this))||void 0===t?void 0:t.playlistIndex)===e)return;const n=Ka(np,this).findIndex((t=>t.playlistIndex===e));var i;-1!==n&&(Ka(np,this).splice(0,n).forEach((t=>{Zh.debug(`[updatePlaybackIndex] [#${e}] Removing queued VideoSegmentDecoder [${t.nodeId}] #${t.playlistIndex}`),Ya(rp,this,dp).call(this,t),t.dispose()})),Ka(ip,this)&&Ka(ip,this).playlistIndex<e&&(Ya(rp,this,dp).call(this,Ka(ip,this)),null===(i=Ka(ip,this))||void 0===i||i.dispose(),Xa(ip,this,null),Ya(rp,this,pp).call(this)))}updatePlaybackCurrentTime({playlistIndex:e,currentTime:t}){var n;(null===(n=Ka(ip,this))||void 0===n?void 0:n.playlistIndex)===e&&(Zh.debug(`[updatePlaybackCurrentTime] [#${e}] ${t} seconds`),Ka(ip,this).updatePlaybackCurrentTime(t))}}function sp(e=!1){var t,n;const i=e?"on":"off";null===(t=Ka(Jh,this))||void 0===t||t[i]("workerstate.playlist.append",this.onPlaylistAppend),null===(n=Ka(Jh,this))||void 0===n||n[i]("workerstate.playlist.reset",this.onPlaylistReset)}function ap(){Ya(rp,this,sp).call(this,!0)}function lp(){Ya(rp,this,sp).call(this,!1)}function cp(e=!1,t=null){if(!t)return;const n=e?"on":"off",i=e?[["buffered",this.onSegDecoderBuffered.bind(this,t)],["videoframes",this.onSegDecoderVideoFrames.bind(this,t)],["complete",this.onSegDecoderComplete.bind(this,t)],["error",this.onSegDecoderError.bind(this,t)]]:t.__listeners;e&&(t.__listeners=i);for(const[e,i]of t.__listeners)t[n](e,i)}function up(e){Ya(rp,this,cp).call(this,!0,e)}function dp(e){Ya(rp,this,cp).call(this,!1,e)}function hp({nodeId:e,index:t,startTimeOffset:n=0}){Zh.debug(`[#queueNode] [${e}] #${t}`);const i=Ka(ep,this).getByNodeId(e);if(!i)throw new Error(`[#queueNode] [${e}] No segment loader found`);const r=function(e,t,n,i,r){return $l.isImageSegment(null==i?void 0:i.segment)?(Qh.debug(`[createDecoder] Creating ImageSegmentDecoder for node "${e}" at index #${t}`),new $l(e,t,n,i,r)):(Qh.debug(`[createDecoder] Creating VideoSegmentDecoder for node "${e}" at index #${t}`),new Oh(e,t,n,i,r))}(e,t,n,i,Ka(tp,this));Ya(rp,this,up).call(this,r),Ka(np,this).push(r),i.representation?this.onSegDecoderBuffered(r):i.once("representationChosen",(()=>{this.onSegDecoderBuffered(r)})),Ya(rp,this,pp).call(this)}function pp(){var e;Ka(ip,this)?Zh.debug(`[#handleNextNode] [${null===(e=Ka(ip,this))||void 0===e?void 0:e.nodeId}] Already handling a node`):0!==Ka(np,this).length?(Xa(ip,this,Ka(np,this).shift()),Zh.debug(`[#handleNextNode] [${Ka(ip,this).nodeId}] #${Ka(ip,this).playlistIndex} Starting to handle node`),Ka(ip,this).start()):Zh.debug("[#handleNextNode] No more nodes to handle")}var fp=(e,t)=>{const n=me.createLogger("webcodecsWorker","warn"),i=new Js(e,e.env,t),r=["appendNode","loadNode","reset","setForceBaseUrl","setBitrateMultiplier","updateBaseUrl","updateBitrate","updateRepo","updateRepoDiff","updateSegment","updateContainerResolution"];let o,s=null,a=null,l=null,c=null,u=null,d=null,h=null,p=!1,f=!1;const g=e=>{o.updateBitrate(e),p||(p=!0,setTimeout((()=>{p&&c&&(i.post("updateBitrate",c.bitrate),p=!1)}),1e3))},m=e=>{i.post("loadError",e)},y=(e,t)=>{f&&e&&t&&i.post("downloadComplete",{url:e,bps:t})},v=e=>{const t=e.reduce(((e,t)=>e+t),0);t>0&&i.post("bytesDownloaded",t)},b=e=>{h.push(e)},w=e=>{n.debug("-> onRepresentationsChosenTick() - Called with "+(e&&e.length)+" segments."),i.post("representationsChosen",e)},k=(e,t)=>{n.debug("-> onRepresentationChosen()"),d.push({segId:e,chosenRep:t})},x=e=>{i.post("nodeLoading",e)},S=e=>{i.post("nodeLoadingPausing",e)},C=e=>{i.post("nodeLoadingComplete",e)},_=e=>{i.post("videoframes",e,"frames")},E=e=>{i.post("buffered",e)},T=e=>{i.post("error",e)};i.on("message",((e,t)=>{n.info("Worker got message: ["+e+"] "+(t||"")),"function"==typeof o[e]?((e,t)=>{const r=`${e}.complete`;n.debug("-> notifyComplete("+e+") - posting message: ["+r+"]"),i.post(r,t)})(e,o[e](t)):n.error("Unknown msg: "+e)})),o=new function(){this.init=e=>{if(n.info("init"),c&&Ll(c,ea)&&c.dispose(),c=new Da(e),u&&Ll(u,ea)&&u.dispose(),u=new Rl(c),e.workerState=c,e.segmentStore=u,s&&Ll(s,ea)&&s.dispose(),s=Aa(e),!s||!Ll(s,ta))throw new Error("Failed to create LoadingManager, or concrete LoadingManager does not conform to ILoadingManager interface.");if(a=Oa(e),!a||!Ll(a,na))throw new Error("Failed to create MemoryManager, or concrete MemoryManager does not conform to IMemoryManager interface.");l=new op(e),d=Zr.createThrottler(w,250,{immediatelyFlushFirst:!0}),h=Zr.createThrottler(v,3e3),n.debug("-> addControllersListeners()"),u?(u.on("bandwidthupdated",g),u.on("loadError",m),u.on("loader.complete",y),u.on("bytesDownloaded",b)):n.error("No segmentStore - cannot add listeners"),s&&(s.on("handler.handling",x),s.on("handler.pausing",S),s.on("handler.complete",C)),c&&c.on("representationChosen",k),l&&(l.on("videoframes",_),l.on("buffered",E),l.on("error",T))},this.monitorDownloads=e=>{f=e},this.forceMemorySweep=function(){if(a&&"function"==typeof a.forceSweep)return a.forceSweep()},this.updatePlaybackIndex=e=>{var t;null===(t=l)||void 0===t||t.updatePlaybackIndex(e)},this.updatePlaybackCurrentTime=e=>{var t;null===(t=l)||void 0===t||t.updatePlaybackCurrentTime(e)},this.updateFreedBytes=e=>{var t;null===(t=l)||void 0===t||t.updateFreedBytes(e)},this.dispose=()=>{n.debug("-> removeControllersListeners()"),u&&(u.off("bandwidthupdated",g),u.off("loadError",m),u.off("loader.complete",y),u.off("bytesDownloaded",b)),s&&(s.off("handler.handling",x),s.off("handler.pausing",S),s.off("handler.complete",C)),c&&c.off("representationChosen",k),l&&(l.off("videoframes",_),l.off("buffered",E),l.off("error",T)),s&&Ll(s,ea)&&s.dispose(),a&&Ll(a,ea)&&a.dispose(),u&&Ll(u,ea)&&u.dispose(),c&&Ll(c,ea)&&c.dispose(),l&&Ll(l,ea)&&l.dispose(),d&&Ll(d,ea)&&d.dispose(),h&&Ll(h,ea)&&h.dispose(),s=null,a=null,l=null,c=null,u=null,d=null,h=null,p=!1},this.reset=()=>{},this.terminate=()=>{e.close()},r.forEach((e=>{this[e]=(...t)=>{var n;null===(n=c)||void 0===n||n[e](...t)}}))},me.enableAll()},gp=me.createLogger("specializedWorkerFactory","warn"),mp={initWorker:function(e,t){if(t&&t.type)switch(t.type){case"webcodecs":gp.info("Initializing WebCodecs worker"),fp(e,t.options);break;case"webaudio":gp.info("Initializing WebAudio worker"),function(e,t){var n=me.createLogger("webAudioWorker","warn"),i=new Js(e,e.env,t),r=null,o=null,s=null,a=null,l=null,c=null,u=null,d=!1,h=!1;let p=!1;var f;const g=function(){r=setTimeout((function(){a&&a.incrementAppendingIndex()}),0)};var m=function(e){f.updateBitrate(e),d||(d=!0,setTimeout((function(){d&&a&&(i.post("updateBitrate",a.bitrate),d=!1)}),1e3))},y=function(e){i.post("loadError",e)},v=function(e,t){h&&e&&t&&i.post("downloadComplete",{url:e,bps:t})},b=function(e){if(e.length>0){for(var t=0,n=0;n<e.length;++n)t+=e[n];i.post("bytesDownloaded",t)}},w=function(e){u.push(e)},k=function(e){n.debug("-> onRepresentationsChosenTick() - Called with "+(e&&e.length)+" segments."),i.post("representationsChosen",e)},x=function(e,t){n.debug("-> onRepresentationChosen()"),c.push({segId:e,chosenRep:{...t,width:null,height:null}})},S=function(e){i.post("nodeLoading",e)},C=function(e){i.post("nodeLoadingPausing",e)},_=function(e){i.post("nodeLoadingComplete",e)};i.on("message",(function(e,t){var r,o;n.info("Worker got message: ["+e+"] "+(t||"")),"function"==typeof f[e]?(f[e](t),n.debug("-> notifyComplete("+(r=e)+") - posting message: ["+(o=r+".complete")+"]"),i.post(o)):n.error("Unknown msg: "+e)})),f=new function(){this.init=function(e){n.info("init"),a&&Ll(a,ea)&&a.dispose(),a=new Da(e),p=e.skipLoadingSuspectedSilent;const t=a.isNullNode;if(a.isNullNode=function(e){var n;const i=a.nodeIdToSegment(e);return t(e)||p&&(null==i||null===(n=i.metadata)||void 0===n?void 0:n.isSuspectedSilent)||sn(i)},l&&Ll(l,ea)&&l.dispose(),l=new Rl(a),e.workerState=a,e.segmentStore=l,o&&Ll(o,ea)&&o.dispose(),!(o=Aa(e))||!Ll(o,ta))throw new Error("Failed to create LoadingManager, or concrete LoadingManager does not conform to ILoadingManager interface.");if(!(s=Oa(e))||!Ll(s,na))throw new Error("Failed to create MemoryManager, or concrete MemoryManager does not conform to IMemoryManager interface.");c=Zr.createThrottler(k,250,{immediatelyFlushFirst:!0}),u=Zr.createThrottler(b,100),n.debug("-> addControllersListeners()"),l?(l.on("bandwidthupdated",m),l.on("loadError",y),l.on("loader.complete",v),l.on("bytesDownloaded",w)):n.error("No segmentStore - cannot add listeners"),o&&(o.on("handler.handling",S),o.on("handler.pausing",C),o.on("handler.complete",_)),a&&a.on("representationChosen",x)},this.appendNode=function(e){if(a&&a.appendNode(e),l&&a){var t;const s=a.nodeIdToSegment(e);if(p&&null!=s&&null!==(t=s.metadata)&&void 0!==t&&t.isSuspectedSilent||sn(s))return a.chooseRepresentation(s,{chosenRepOverrides:{url:null,bandwidth:0,format:"silent",label:"silent"}}),function(e,t){n.debug(`-> notifyAppendSilentNode("${e}")`,t),i.post("appendSilentNode",{nodeId:e,rep:{...t,...!t.origSamples&&{audioSamplingRate:44100,frontPadSamples:0,backPadSamples:0,origSamples:44100*t.duration}}})}(e,s.chosenRepresentation),void g();var r=l.getByNodeId(e);"function"==typeof r.switch&&r.switch(!0);var o=function(){!function(e,t,r){n.debug("-> notifyAppendArrayBuffer("+e+")"),i.post("appendArrayBuffer",{nodeId:e,rep:r.chosenRepresentation,arrayBuffer:t},"arrayBuffer")}(e,r.arrayBuffer,r.segment),g()};r.completed?o.apply():r.once("complete",o)}},this.updateRepo=function(e){a&&a.updateRepo(e)},this.updateRepoDiff=function(e){a&&a.updateRepoDiff(e)},this.updateSegment=function(e){a&&a.updateSegment(e)},this.reset=function(){a&&(a.reset(),clearTimeout(r))},this.updateBitrate=function(e){a&&a.updateBitrate(e)},this.updateBaseUrl=function(e){a&&a.updateBaseUrl(e)},this.setForceBaseUrl=function(e){a&&a.setForceBaseUrl(e)},this.setBitrateMultiplier=function(e){a&&a.setBitrateMultiplier(e)},this.loadNode=function(e){a&&a.loadNode(e)},this.monitorDownloads=function(e){h=e},this.dispose=function(){n.debug("-> removeControllersListeners()"),l&&(l.off("bandwidthupdated",m),l.off("loadError",y),l.off("loader.complete",v),l.off("bytesDownloaded",w)),o&&(o.off("handler.handling",S),o.off("handler.pausing",C),o.off("handler.complete",_)),a&&a.off("representationChosen",x),o&&Ll(o,ea)&&o.dispose(),s&&Ll(s,ea)&&s.dispose(),l&&Ll(l,ea)&&l.dispose(),a&&Ll(a,ea)&&a.dispose(),c&&Ll(c,ea)&&c.dispose(),u&&Ll(u,ea)&&u.dispose(),o=null,s=null,a=null,l=null,c=null,u=null,d=!1},this.terminate=function(){e.close()}},me.enableAll()}(e,t.options);break;default:gp.error("Unknown worker type: "+t.type)}else gp.error("Unable to initialize worker - no type given.")}};function yp(e){var t=we,n=mp;function i(){e.log.info("Posting 'mainWorkerStarted' message."),e.postMessage({name:"mainWorkerStarted"})}t.enableAll(),e.log=t.createLogger("mainWorker","warn"),e.log.info("Worker Started"),e.addEventListener("message",(function r(o){var s=o.data;e.log.info("Worker got message: ["+s.name+"] "+(s.data?s.data:"")),"probeStarted"===s.name?i():"initWorker"===s.name?(s.data&&s.data.env&&(e.env=s.data.env,"undefined"!=typeof window&&(window.env=s.data.env),e.env.queryParams&&t._initWithQueryParams(e.env.queryParams)),s.data&&s.data.type&&"function"==typeof t._setGlobalPrefix&&t._setGlobalPrefix("["+s.data.type+"Worker]::"),n.initWorker(e,s.data),e.removeEventListener("message",r),e.postMessage({name:"specializedWorkerInitialized"})):e.log.error("Unkown msg: "+s.name)})),i()}function vp(){var e=new Ti;for(var t in window)window.hasOwnProperty(t)&&!Object.prototype.hasOwnProperty.call(this,t)&&(this[t]=window.prop);this.addEventListener=function(){e.on.apply(e,Array.prototype.slice.call(arguments))},this.removeEventListener=function(){e.off.apply(e,Array.prototype.slice.call(arguments))},this.postMessage=function(t){e.trigger("workermessage",{data:t})},this.close=function(){e.removeAllListeners()},this.ee=e}function bp(e){this.workerFunc=e,this.ee=new Ti,this.workerContext=new vp,this.isPseudoWorker=!0,this.workerContext.ee.on("workermessage",function(e){this.ee.trigger("message",e)}.bind(this)),setTimeout(e.bind(null,this.workerContext),0)}bp.prototype.onmessage=function(){this.ee.on.apply(this.ee,["message"].concat(Array.prototype.slice.call(arguments)))},bp.prototype.onerror=function(){this.ee.on.apply(this.ee,["error"].concat(Array.prototype.slice.call(arguments)))},bp.prototype.addEventListener=function(){this.ee.on.apply(this.ee,Array.prototype.slice.call(arguments))},bp.prototype.removeEventListener=function(){this.ee.off.apply(this.ee,Array.prototype.slice.call(arguments))},bp.prototype.postMessage=function(e){this.workerContext.ee.trigger("message",{data:e})},bp.prototype.terminate=function(){this.ee.removeAllListeners()};var wp=ki.getObjectProperty(Ae,"browser.name","").toLowerCase(),kp=ki.getObjectProperty(Ae,"browser.version",0),xp=ki.getObjectProperty(Ae,"engine.name","").toLowerCase(),Sp=ki.getObjectProperty(Ae,"os.name","").toLowerCase(),Cp=ki.getObjectProperty(Ae,"os.version",0),_p="ios"===Sp,Ep=wp.indexOf("safari")>=0,Tp=_p&&Cp&&ki.compareVersions(Cp,"15.0.0","<")||!_p&&Ep&&kp&&ki.compareVersions(kp,"15.0","<"),Pp=0===wp.indexOf("ie")||0===wp.indexOf("edge")&&"blink"!==xp,Ip=ji.extend({name:"WorkerFactory",logLevel:"warn",defaults:{microsoftTimeout:3,forcePseudoWorker:"boolean"==typeof Ae.queryParams.forcepseudoworker?Ae.queryParams.forcepseudoworker:Pp||Tp},saveWorker:function(e,t){this.workers=this.workers||{},this.workers[e]=t},discardWorker:function(e){this.workers&&this.workers[e]&&delete this.workers[e]},createWorkerInstance:function(e){return this.getSetting("forcePseudoWorker"),new bp(yp)},createWorker:function(e,t){var n=this,i=this.createWorkerInstance(t),r=ki.uuid();return this.saveWorker(r,i),S.promise((function(o,s){var a,l,c,u,d=!1,h=function(){n.log.info("Adding listeners"),i.addEventListener("message",l),i.addEventListener("error",a),Pp&&(n.log.info("Running on Microsoft browser, setting timeout to ensure that worker is valid."),u=setTimeout(c,1e3*n.getSetting("microsoftTimeout"))),i.postMessage({name:"probeStarted"})},p=function(){n.log.info("Removing listeners"),i.removeEventListener("message",l),i.removeEventListener("error",a),clearTimeout(u),n.discardWorker(r)};c=function(){n.log.warn("Timeout creating '"+e+"' worker. Terminating and creating another one (forcing pseudo worker)."),i&&(p(),i.terminate(),i=null),i=n.createWorkerInstance(ki.extend({},t,{forcePseudoWorker:!0})),r=ki.uuid(),h()},a=function(e){n.log.error("Worker error",e),p(),s(e)},l=function(r){n.log.info("Received message",r),r&&r.data&&"mainWorkerStarted"===r.data.name?d||(i.postMessage({name:"initWorker",data:{type:e,env:Ae,options:t}}),d=!0):r&&r.data&&"specializedWorkerInitialized"===r.data.name?(n.log.info("Successfully created '"+e+"' worker, resolving."),p(),o(i)):(n.log.error("Unknown worker msg",r),p(),s(r))},h()}))}}),Ap=[10,11,20,21,30,31,40,41,50,51,52,60,61,62],Op={10:{maxLumaSampleRate:829440,maxLumaSamplesPerPicture:36864},11:{maxLumaSampleRate:2764800,maxLumaSamplesPerPicture:73728},20:{maxLumaSampleRate:4608e3,maxLumaSamplesPerPicture:122880},21:{maxLumaSampleRate:9216e3,maxLumaSamplesPerPicture:245760},30:{maxLumaSampleRate:20736e3,maxLumaSamplesPerPicture:552960},31:{maxLumaSampleRate:36864e3,maxLumaSamplesPerPicture:983040},40:{maxLumaSampleRate:83558400,maxLumaSamplesPerPicture:2228224},41:{maxLumaSampleRate:160432128,maxLumaSamplesPerPicture:2228224},50:{maxLumaSampleRate:311951360,maxLumaSamplesPerPicture:8912896},51:{maxLumaSampleRate:588251136,maxLumaSamplesPerPicture:8912896},52:{maxLumaSampleRate:1176502272,maxLumaSamplesPerPicture:8912896},60:{maxLumaSampleRate:1176502272,maxLumaSamplesPerPicture:35651584},61:{maxLumaSampleRate:2353004544,maxLumaSamplesPerPicture:35651584},62:{maxLumaSampleRate:4706009088,maxLumaSamplesPerPicture:35651584}},Lp=me.createLogger("vp9Utils","warn"),Np={};Object.keys(Jo).forEach((function(e){Jo[e].mediaCapabilitiesConfig&&(Np[e]=Jo[e].mediaCapabilitiesConfig)}));const Rp=ki.getObjectProperty(Ae,"os.name","").toLowerCase();var Dp=ji.extend({name:"MediaCapabilities",logLevel:"warn",excludeFuncFromAutoDebug:["calcVP9Level","getFullVP9CodecStr","getMediaConfig","getRepContentType","constructMediaConfigFromRepresentation","scoreFormat"],defaults:{isEnabled:!0,smoothPoints:"ios"===Rp?0:10,powerEfficientPoints:10},isSupported:!1,getRepContentType:function(e){var t=e.codecs;return"vp9"===t&&(t=function(e){return e&&"object"==typeof e?"vp9"!==e.codecs?e.codecs:"vp09.00."+function(e,t,n){if("number"!=typeof e||"number"!=typeof t||"number"!=typeof n||e<=0||t<=0||n<=0)return Lp.error("[calcVP9Level] Invalid arguments",e,t,n),40;for(var i,r,o=e*t,s=o*n,a=0,l=Ap.length;a<l&&!(s<=(r=Op[i=Ap[a]]).maxLumaSampleRate&&o<=r.maxLumaSamplesPerPicture);++a);return i||40}(e.width,e.height,e.frameRate)+".08":(Lp.error("[getFullVP9CodecStrFromRep] Invalid argument:",e),"")}(e)),e.mimeType+'; codecs="'+t+'"'},constructMediaConfigFromRepresentation:function(e){var t=Np[e.format],n={};return t.audio&&(n.audio=ki.extend({},t.audio,{contentType:this.getRepContentType(e),channels:e.channels||t.audio.channels||2,bitrate:e.audioBandwidth||e.bandwidth||t.audio.bitrate,samplerate:e.audioSamplingRate||t.audio.samplerate||44100})),t.video&&(n.video=ki.extend({},t.video,{contentType:this.getRepContentType(e),width:e.width||t.video.width||1920,height:e.height||t.video.height||1080,bitrate:e.videoBandwidth||e.bandwidth||t.video.bitrate,framerate:e.frameRate||t.video.framerate||23.976})),n},getMediaConfig:function(e,t){var n;return(t=t||{}).ivd&&Array.isArray(t.ivd.representations)&&(n=t.ivd.representations.find((function(t){return t.format===e}))),ki.extend({},n?this.constructMediaConfigFromRepresentation(n):Np[e],{type:t.isMediaSource?"media-source":"file"})},scoreFormat:function(e,t){if(t=t||{},e&&e.name&&Np[e.name]){var n=this.getMediaConfig(e.name,t);return this.log.info('[scoreFormat] Calling mediaCapabilities.decodingInfo() for format "'+e.name+'" with the following MediaConfig:',n),I.navigator.mediaCapabilities.decodingInfo(n).then(function(t){e.mediaCapabilities=t,e.mcScore=e.mcScore||0,t.supported?(t.smooth&&(e.mcScore+=this.getSetting("smoothPoints")),t.powerEfficient&&(e.mcScore+=this.getSetting("powerEfficientPoints")),this.log.info("[scoreFormat] ["+e.name+"] Got result",t,"for config",n)):this.log.warn("[scoreFormat] MediaCapabilities returned NOT SUPPORTED for format:",e.name)}.bind(this)).catch(function(t){const n=t instanceof TypeError?"debug":"error";this.log[n]("[scoreFormat] Could not retrieve MediaCapabilitiesInfo for '"+e.name+"'",t),e.mediaCapabilities={},e.mcScore=e.mcScore||0}.bind(this))}this.log.warn("[scoreFormat] Invalid/unknown format:",e)},sortFormats:function(e,t){if(t=t||{isMediaSource:!1,ivd:null},!this.isSupported||!this.getSetting("isEnabled")||e&&e.length<=1)return S(e);if(!e||!Array.isArray(e)||!e.reduce((function(e,t){return e&&t.name&&Np.hasOwnProperty(t.name)}),!0))return this.log.error("[sortFormats] Invalid formats array (or unknown format):",e),S(e);var n=[];return e.forEach((function(i,r){i.mcScore=e.length-r,n.push(this.scoreFormat(i,t))}),this),S.all(n).then(function(){var t=e.sort((function(e,t){return t.mcScore-e.mcScore}));return this.log.info("[sortFormats] Sorted formats:",t.map((function(e){return{name:e.name,mediaCapabilities:e.mediaCapabilities,mcScore:e.mcScore}}))),t}.bind(this))},ctor:function(){this.isSupported=I&&I.navigator&&I.navigator.mediaCapabilities&&"function"==typeof I.navigator.mediaCapabilities.decodingInfo,this.log.info("MediaCapabilities API is "+(this.isSupported?"SUPPORTED":"NOT SUPPORTED")+" and "+(this.getSetting("isEnabled")?"ENABLED":"NOT ENABLED"))}});const Mp="ios"===ki.getObjectProperty(Ae,"os.name","").toLowerCase();var Fp=ds.extend({name:"WebAudioEngine",logLevel:"warn",defaults:{bitrateMultiplierMultiplier:6,bitrateConfig:{enableAdaptiveBitrate:Xi.getDefault("adaptiveBitrateEnabled"),ivdStrategy:Xi.getDefault("ivdStrategy"),alpha:.15,bitrateMultiplier:9,enableCacheDetection:!0,cacheRate:Ae.isDesktop?8e7:2e7,cacheFactor:3,cacheScoreThreshold:.85,factorScoreWeight:.5,updateInterval:.1},segmentLoaderConfig:{forceTransBufferBinaryLoader:!0,forceXhrOnEdge:!0,forceStreamBinaryLoader:!1,chunkSize:512e3,maxProgressElapsedTime:.5,retries:5,retryDelay:.4,maxReadDuration:.04,alternatesEnabled:!0},memory:{type:"constrained",maxmemory:Ae.isDesktop?12e6:2e6,logic:{and:{infutureplaylist:!1,or:{inrepo:!1,innextlevels:{depth:3,value:!1}}}}},swCacheEnabled:!!Ae.queryParams.forceswcache||!Ae.queryParams.noswcache,forcePseudoWorker:!1,vorbisMaxSuspectedSilentKbps:15,vorbisSuspectedSilentIgnoreRepsShorterThan:3,skipLoadingSuspectedSilent:!0,priorityLoadingManager:{enabled:Xi.getDefault("priorityLoadingEnabled")}},excludeFuncFromAutoDebug:["getWorkerSafeSegment","getWorkerSafeNode","getIsUnlockingRequired","getBuffered","transformIvd","isRepSupported","isRepOfChosenFormat"],api:null,events:null,repository:null,manager:null,video:null,worker:null,workerMsgChannel:null,workerStartedDefer:null,bitrate:null,baseUrl:null,forceBaseUrl:null,baseUrlLoadVariants:null,workerInitedPromise:null,isWorkerReady:!1,repoSyncHelper:null,supportedFormatNames:null,bufferedEncodedDuration:0,mediaCapabilities:null,addWorkerListeners:function(){this.workerMsgChannel&&(this.workerMsgChannel.on("message",this.onWorkerMessage),this.workerMsgChannel.on("log",this.onWorkerLog),this.workerMsgChannel.on("updateBitrate",this.onWorkerUpdateBitrate),this.workerMsgChannel.on("representationChosen",this.onWorkerRepresentationChosen),this.workerMsgChannel.on("representationsChosen",this.onWorkerRepresentationsChosen),this.workerMsgChannel.on("loadError",this.onWorkerLoadError),this.workerMsgChannel.on("downloadComplete",this.onWorkerDownloadComplete),this.workerMsgChannel.on("bytesDownloaded",this.onWorkerBytesDownloaded),this.workerMsgChannel.on("nodeLoading",this.onWorkerNodeLoading),this.workerMsgChannel.on("nodeLoadingPausing",this.onWorkerNodeLoadingPausing),this.workerMsgChannel.on("nodeLoadingComplete",this.onWorkerNodeLoadingComplete))},removeWorkerListeners:function(){this.workerMsgChannel&&(this.workerMsgChannel.off("message",this.onWorkerMessage),this.workerMsgChannel.off("log",this.onWorkerLog),this.workerMsgChannel.off("updateBitrate",this.onWorkerUpdateBitrate),this.workerMsgChannel.off("representationChosen",this.onWorkerRepresentationChosen),this.workerMsgChannel.off("representationsChosen",this.onWorkerRepresentationsChosen),this.workerMsgChannel.off("loadError",this.onWorkerLoadError),this.workerMsgChannel.off("downloadComplete",this.onWorkerDownloadComplete),this.workerMsgChannel.off("bytesDownloaded",this.onWorkerBytesDownloaded),this.workerMsgChannel.off("nodeLoading",this.onWorkerNodeLoading),this.workerMsgChannel.off("nodeLoadingPausing",this.onWorkerNodeLoadingPausing),this.workerMsgChannel.off("nodeLoadingComplete",this.onWorkerNodeLoadingComplete))},disposeWorker:function(){this.postMessage("dispose"),this.isWorkerReady=!1},postMessage:function(e,t){this.workerStartedDefer&&"fulfilled"===this.workerStartedDefer.promise.inspect().state&&(this.log.info(`Posting message [${e}] with data:`,t),this.workerMsgChannel.post(e,t))},initWorker:function(e){return S.all([this.workerStartedDefer.promise,this.sortFormats(e)]).then(function(){return this.repoSyncHelper||(this.repoSyncHelper=new Na(this.repository,this.getWorkerSafeNode,this.getWorkerSafeSegment),this.repoSyncHelper.on("repochange",this.onRepoChange)),S.promise(function(e){this.workerMsgChannel.once("init.complete",e),this.postMessage("init",ki.extend(!0,{repo:this.repoSyncHelper.getFullRepo(),environment:Ae,bitrate:this.bitrate,bitrateConfig:this.getSetting("bitrateConfig"),baseUrl:this.baseUrl,forceBaseUrl:this.forceBaseUrl,segmentLoaderConfig:{baseUrlLoadVariants:this.baseUrlLoadVariants}},this.settings)),this.isWorkerReady=!0}.bind(this))}.bind(this))},appendWorkerNode:function(e){return S.promise(function(t){this.workerMsgChannel.once("appendArrayBuffer",(function(e){t(e)})),this.workerMsgChannel.once("appendSilentNode",(function({nodeId:n,rep:i}){n===e.id&&t({nodeId:n,rep:i,appendSilentNode:!0})})),this.ensureWorkerRepoValid(),this.postMessage("appendNode",e.id),0===e.duration&&this.workerMsgChannel.trigger("appendArrayBuffer")}.bind(this))},resetWorker:function(){return S.promise(function(e){this.workerMsgChannel.once("reset.complete",e),this.postMessage("reset")}.bind(this))},onWorkerMessage:function(e,t){this.log.info("Main got message: ["+e+"]",t||"")},onWorkerLog:function(e){this.log.info(e)},onWorkerUpdateBitrate:function(e){this.bitrate=e,this.trigger("bitrateUpdated",this.bitrate)},onWorkerRepresentationChosen:function(e){this.repoSyncHelper.execFuncWhileIgnoringRepoChanges(function(){this.trigger("representationChosen",e.segId,e.chosenRep)}.bind(this))},onWorkerRepresentationsChosen:function(e){this.repoSyncHelper.execFuncWhileIgnoringRepoChanges(function(){this.trigger("representationsChosen",e)}.bind(this))},onWorkerLoadError:function(e){e.isLast?(this.log.error("Error when downloading "+e.url+", no more retries. status code: "+e.status+", attempt #"+e.attempt+", errorMsg: "+e.errorMsg),this.notifyError(82,e.url,e.status,e.attempt,e.errorMsg)):(this.log.warn("Error when downloading "+e.url+". status code: "+e.status+", attempt #"+e.attempt+", errorMsg: "+e.errorMsg),this.notifyError(83,e.url,e.status,e.attempt,e.errorMsg))},onWorkerDownloadComplete:function(e){this.trigger("downloadComplete",e.url,e.bps)},onWorkerBytesDownloaded:function(e){this.trigger("bytesDownloaded",e)},onWorkerNodeLoading:function(e){this.trigger("nodeLoading",e)},onWorkerNodeLoadingPausing:function(e){this.trigger("nodeLoadingPausing",e)},onWorkerNodeLoadingComplete:function(e){this.trigger("nodeLoadingComplete",e)},addAudioContextManagerListeners:function(){this.manager&&this.manager.on("contextnotprogress",this.onContextNotProgress)},removeAudioContextManagerListeners:function(){this.manager&&this.manager.off("contextnotprogress",this.onContextNotProgress)},onContextNotProgress:function(e){Mp?(this.api.exports.trigger("contextnotprogress"),this.log.warn("audio context time is not progressing, we should init new context and seek to",e="number"==typeof e?e:this.api.exports.currentTime),this.api.exports.pause(),this.reset().then(function(){this.manager.initAudioContext(),this.api.exports.currentTime=e}.bind(this))):this.log.warn("Detected audio context time not progressing on a non-iOS device, ignoring.")},getWorkerSafeNode:function(e){return e&&"function"==typeof e.getWorkerSafeNode&&e.getWorkerSafeNode()},getWorkerSafeSegment:function(e){if(!e._webAudioChosenFormat)for(var t=0;t<this.formats.length;t++)if(e.hasFormat(this.formats[t].name)){e._webAudioChosenFormat=this.formats[t];break}return e.getWorkerSafeSegment({filterRepresentations:function(t){return sn(e)||e._webAudioChosenFormat&&this.isRepOfChosenFormat(t,e._webAudioChosenFormat)}.bind(this)})},doUpdateWorkerRepo:function(){this.postMessage("updateRepoDiff",this.repoSyncHelper.flushDiff())},scheduleWorkerRepoUpdate:function(){this.updateWorkerRepoScheduled||(this.updateWorkerRepoScheduled=!0,setTimeout(function(){this.updateWorkerRepoScheduled&&(this.doUpdateWorkerRepo(),this.updateWorkerRepoScheduled=!1)}.bind(this),0))},onRepoChange:function(){this.isWorkerReady&&this.scheduleWorkerRepoUpdate()},ensureWorkerRepoValid:function(){this.updateWorkerRepoScheduled&&(this.doUpdateWorkerRepo(),this.updateWorkerRepoScheduled=!1)},sortFormats:function(e){return this.mediaCapabilities.sortFormats(this.formats,{isMediaSource:!1,ivd:e.segment}).then(function(e){this.formats=e,this.supportedFormatNames=e.map((function(e){return e.name})),this.log.info("Sorted formats according to decoding capabilities:",this.supportedFormatNames)}.bind(this))},appendNode:function(e,t){t=t||0;var n=this.repository.get(e),i=n&&n.segment&&n.segment.id;return n&&i?(this.workerInitedPromise||(this.workerInitedPromise=this.initWorker(n)),this.workerInitedPromise.then((function(){return n})).then(this.appendWorkerNode).then(function(r){if(0!==n.duration&&r&&r.nodeId===e){var o=r.rep&&r.rep.alternates&&r.rep.alternates.length&&r.rep.alternates[0]||r.rep;this.bufferedEncodedDuration+=o&&o.duration||0;var s,a=(s=n)&&(s.supernode||s);return r.appendSilentNode?this.manager.appendSilentNode(i,o,t,a,e):this.manager.append(i,r.rep,r.arrayBuffer,t,a,e)}}.bind(this))):S.reject(new Error("Unknown node: ",e))},reset:function(e){return this.workerStartedDefer.promise.then(this.resetWorker).then(this.manager.reset).then(function(){this.bufferedEncodedDuration=0,e||(this.workerInitedPromise=null)}.bind(this))},endStream:function(){return S()},seek:function(e,t){return this.reset(!0).then(this.appendNode.bind(this,e,t)).then(function(){this.log.info("Seek complete")}.bind(this))},getBuffered:function(){return this.manager&&this.manager.isUnlocked?this.manager.getBuffered():this.bufferedEncodedDuration},videoTech:function(){return"webaudio"},updateBitrate:function(e){this.bitrate=e,this.postMessage("updateBitrate",e)},updateBaseUrl:function(e){this.baseUrl=e,this.postMessage("updateBaseUrl",e)},setForceBaseUrl:function(e){this.forceBaseUrl=e,this.postMessage("setForceBaseUrl",e)},setBitrateMultiplier:function(e){e*=this.getSetting("bitrateMultiplierMultiplier",1),this.setSetting("bitrateConfig.bitrateMultiplier",e),this.postMessage("setBitrateMultiplier",e)},isRepSupported:function(e){return this.supportedFormatNames.indexOf(e.format)>=0},transformIvd:function(e){if(!e||!e.representations||!e.representations.length)return e;const t=e.representations.filter((e=>"vorbis"===e.codecs)).filter((e=>e.duration>=this.getSetting("vorbisSuspectedSilentIgnoreRepsShorterThan")));return e.metadata=e.metadata||{},e.metadata.isSuspectedSilent=t.length&&t.every((e=>e.bandwidth<=1e3*this.getSetting("vorbisMaxSuspectedSilentKbps"))),e.representations=sn(e)?e.representations:e.representations.filter(this.isRepSupported),e},isRepOfChosenFormat:function(e,t){return!(!t||!t.name)&&(e.format===t.name||t.aliases&&t.aliases.indexOf(e.format)>=0)},loadNode:function(e){var t=this.repository.get(e);t?t.resolve().then(function(){t.subnodes&&t.subnodes.length&&(t=t.subnodes[0]),this.ensureWorkerRepoValid(),this.postMessage("loadNode",t.id)}.bind(this)):this.log.warn("[loadNode] Unable to load unknown node:",e)},monitorDownloads:function(e){this.workerStartedDefer.promise.done(function(){this.postMessage("monitorDownloads",e)}.bind(this))},setBaseUrlLoadVariants:function(e){this.baseUrlLoadVariants=e},getNeededFormatNames:function(){return this.supportedFormatNames},ctor:function(e,t,n,i){this._super(t,n,i),this.supportedFormatNames=(this.formats||[]).map((function(e){return e.name})),this.manager=new Ks(this.options,this.api),this.video=new Xs(this.options,this.api,e,this.manager),this.addErrorListener(this.manager),this.addErrorListener(this.video),this.addAudioContextManagerListeners(),this.workerStartedDefer=S.defer(),new Ip(this.options).createWorker("webaudio",{forcePseudoWorker:this.getSetting("forcePseudoWorker"),WorkerMsgChannel:this.options&&this.options.WorkerMsgChannel||{}}).then(function(e){this.worker=e,this.workerMsgChannel=new Js(this.worker,Ae,this.options),this.addWorkerListeners(),this.workerStartedDefer.resolve()}.bind(this)),this.mediaCapabilities=new Dp(this.options),this.defineProperty("repo",(function(){return{nodes:this.repository.nodeMap,segments:this.repository.segmentMap}}))},dispose:function(){this._super.apply(this,arguments),this.removeWorkerListeners(),this.removeAudioContextManagerListeners(),this.repoSyncHelper&&(this.repoSyncHelper.off("repochange",this.onRepoChange),this.repoSyncHelper.dispose()),this.workerMsgChannel&&this.workerMsgChannel.dispose(),this.worker&&(this.disposeWorker(),this.postMessage("terminate"),this.worker=null),this.manager=null}});function Bp(e){var t,n=0;for(e=e.split("").reverse().join(""),t=0;t<e.length;t++)n=e.charCodeAt(t)+((n<<5)-n);var i="";for(t=0;t<3;t++)i+=("00"+(n>>8*t&255).toString(16)).substr(-2);return"#"+i}function Up(e,t){if(0===e.indexOf("#")&&(e=e.slice(1)),3===e.length&&(e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]),6!==e.length)throw new Error("Invalid HEX color.");return.299*parseInt(e.slice(0,2),16)+.587*parseInt(e.slice(2,4),16)+.114*parseInt(e.slice(4,6),16)>186?"#000000":"#FFFFFF"}var jp=hs.extend({name:"NullVideo",logLevel:"warn",defaults:{styleString:"position: absolute; display: flex; align-items: center; justify-content: center;",textStyleString:"margin: 0; font-size: 50px; text-align: center;"},excludeFuncFromAutoDebug:["currentTime","onTick","getCanvas","getVideoWidth","getVideoHeight","getCurrentSegmentIndex","getCurrentSegmentTime","getPlaybackRate","setPlaybackRate"],api:null,events:null,_volume:1,_muted:!1,_paused:!0,_currentTime:0,prevTick:NaN,presentationTime:null,vidDiv:null,textDiv:null,rtsDiv:null,canvas:null,canvasContext:null,manager:null,addAPIListeners:function(){this.api.on("nodestart",this.onNodeStart),this.api.on("playlistreset",this.onPlaylistReset)},removeAPIListeners:function(){this.api.off("nodestart",this.onNodeStart),this.api.off("playlistreset",this.onPlaylistReset)},removeRtsDiv:function(){this.rtsDiv&&this.rtsDiv.parentNode&&(this.rtsDiv.parentNode.removeChild(this.rtsDiv),this.rtsDiv=null)},onRtsNodeStart:function(e,t,n){var i,r,o,s;this.removeRtsDiv(),this.textDiv.innerHTML="",this.rtsDiv=document.createElement("div"),this.rtsDiv.setAttribute("style","position: absolute; left: 0; top: 0; width: 100%; height: 100%;"),t=t||1,n=n||1;for(var a=0;a<t;++a)for(var l=0;l<n;++l)i=document.createElement("div"),s=Up(o=Bp(e.id+"__"+(10*a+l))),i.setAttribute("style","position: absolute;display: flex;align-items: center;justify-content: center;left: "+(100/n*l).toFixed(2)+"%;top: "+(100/t*a).toFixed(2)+"%;width: "+(100/n).toFixed(2)+"%;height: "+(100/t).toFixed(2)+"%;background-color: "+o+";"),(r=document.createElement("div")).setAttribute("style",this.getSetting("textStyleString")),r.style.color=s,r.innerHTML=e.id+"<BR/>("+a+", "+l+")",i.appendChild(r),this.rtsDiv.appendChild(i),this.canvas&&(this.canvasContext.fillStyle=o,this.canvasContext.fillRect(1/n*l*this.canvas.width,1/t*a*this.canvas.height,1/n*this.canvas.width,1/t*this.canvas.height),this.canvasContext.fillStyle=s,this.canvasContext.font="40px Times New Roman",this.canvasContext.textAlign="center",this.canvasContext.fillText(e.id+" ("+a+", "+l+")",1/n*l*this.canvas.width+1/n*this.canvas.width/2,1/t*a*this.canvas.height+1/t*this.canvas.height/2));this.vidDiv.appendChild(this.rtsDiv)},onNodeStart:function(e){if(e.metadata&&"rts"===e.metadata.type&&(e.metadata.rows>1||e.metadata.cols>1))this.onRtsNodeStart(e,e.metadata.rows,e.metadata.cols);else{this.removeRtsDiv();var t=Bp(e.id),n=Up(t);this.vidDiv.style.backgroundColor=t,this.textDiv.style.color=n,this.textDiv.innerHTML=e.id,this.canvas&&(this.canvasContext.fillStyle=t,this.canvasContext.fillRect(0,0,this.canvas.width,this.canvas.height),this.canvasContext.fillStyle=n,this.canvasContext.font="150px Times New Roman",this.canvasContext.textAlign="center",this.canvasContext.fillText(e.id,this.canvas.width/2,this.canvas.height/2))}},onPlaylistReset:function(){this.removeRtsDiv(),this.textDiv.innerHTML=""},notifyPause:function(){this.trigger(this.events.pause)},notifyPlay:function(){this.trigger(this.events.play)},notifyPlaying:function(){this.trigger(this.events.playing)},onTick:function(){var e=O();this._currentTime+=(e-this.prevTick)/1e3,this.prevTick=e},startTick:function(){this.prevTick=O(),Zr.start(this.onTick),this._paused=!1,this.notifyPlay(),this.notifyPlaying()},stopTick:function(){Zr.stop(this.onTick),this._paused=!0,this.prevTick=NaN,this.notifyPause()},getCanvas:function(){return this.canvas||(this.canvas=document.createElement("canvas"),this.canvasContext=this.canvas.getContext("2d"),this.canvas.width=this.getVideoWidth(),this.canvas.height=this.getVideoHeight(),this.canvas.videoWidth=this.canvas.width,this.canvas.videoHeight=this.canvas.height,this.api.exports.currentNode&&this.onNodeStart(this.api.exports.currentNode)),this.canvas},setOtherVideos:function(e){e&&e.length&&e[0]&&e[0].name&&"webaudiovideo"!==e[0].name.toLowerCase()&&this.vidDiv&&this.vidDiv.parentNode&&(this.log.info("[setOtherVideos] Detected composite mode and the Null engine should not be displayed, removing from DOM"),this.vidDiv.parentNode.removeChild(this.vidDiv))},setManager:function(e){this.manager=e,this.manager.on("segmentend",function(e){this.trigger("segmentend",e)}.bind(this))},play:function(e){return(e=e||{}).wait?S():S().then(this.startTick)},pause:function(){return S().then(this.stopTick)},currentTime:function(){return this.presentationTime?this.presentationTime.getPresentationTime():0},getVolume:function(){return this._volume},setVolume:function(e){if("number"!=typeof e||isNaN(e))this.log.warn("Bad volume argument, ignoring.",e);else{if(e<0||e>1){var t=e<0?0:1;this.log.warn("Volume value out of range [0, 1]. Changing to "+t),e=t}this._volume!==e&&(this._volume=e,this.trigger(this.events.volumechange))}},getMuted:function(){return this._muted},setMuted:function(e){this._muted!==(e=!!e)&&(this._muted=e,this.trigger(this.events.volumechange))},getPaused:function(){return this._paused},getVideoWidth:function(){return 1920},getVideoHeight:function(){return 1080},getCurrentVideoTotalFrames:function(){return Math.round(this._currentTime/(1/23.976))},getCurrentVideoDroppedFrames:function(){return 0},getPlaybackRate:function(){return this.presentationTime?this.presentationTime.getPlaybackRate():1},setPlaybackRate:function(e){this.presentationTime&&this.presentationTime.setPlaybackRate(e)},getCurrentSegmentIndex:function(){return this.manager&&this.manager.getCurrentSegmentIndex()||0},getCurrentSegmentTime:function(){return this.manager&&this.manager.getCurrentSegmentTime()||0},ctor:function(e,t){this._super.apply(this,arguments);var n={};Object.defineProperty(n,"currentTime",{enumerable:!0,get:function(){return this._currentTime}.bind(this)}),this.presentationTime=new Is(this.options,n),this.addAPIListeners(),this.vidDiv=document.createElement("div"),this.vidDiv.setAttribute("style",this.getSetting("styleString")),this.vidDiv.setAttribute("class","eko-null-engine"),this.textDiv=document.createElement("div"),this.textDiv.setAttribute("style",this.getSetting("textStyleString")),this.vidDiv.appendChild(this.textDiv),t.appendChild(this.vidDiv)},dispose:function(){this._super.apply(this,arguments),this.removeAPIListeners(),this.presentationTime&&"function"==typeof this.presentationTime.dispose&&this.presentationTime.dispose(),this.presentationTime=null}}),zp=ds.extend({name:"NullManager",logLevel:"warn",defaults:{},excludeFuncFromAutoDebug:["currentTime","getCurrentSegmentIndex","getCurrentSegmentTime"],api:null,video:null,playingSegments:[],currentSegmentIndex:0,onSubNodeStart:function(){this.updateCurrentSegmentIndex()},onNodeStart:function(e){e.subnodes&&e.subnodes.length||this.updateCurrentSegmentIndex()},addApiListeners:function(){this.api&&(this.api.on("subnodestart",this.onSubNodeStart),this.api.on("nodestart",this.onNodeStart))},removeApiListeners:function(){this.api&&(this.api.off("subnodestart",this.onSubNodeStart),this.api.off("nodestart",this.onNodeStart))},updateCurrentSegmentIndex:function(){if(this.playingSegments.length)if(this.currentSegmentIndex>=this.playingSegments.length)this.log.warn("[updateCurrentSegmentIndex] Unexpected state, this.currentSegmentIndex === "+this.currentSegmentIndex+", but this.playingSegments.length === "+this.playingSegments.length);else{var e=this.playingSegments[this.currentSegmentIndex][0],t=this.video.currentTime();if(!(t>=e.offset&&t<=e.offset+e.duration))for(var n=this.currentSegmentIndex+1;n<this.playingSegments.length;n++)if(t>=(e=this.playingSegments[n][0]).offset&&t<=e.offset+e.duration){this.currentSegmentIndex=n,this.trigger("segmentend",!1);break}}else this.currentSegmentIndex=0},push:function(e){var t=this.playingSegments.length&&this.playingSegments[this.playingSegments.length-1][0];this.playingSegments.push([{offset:t?t.offset+t.duration:0,duration:e.duration,meta:{segId:e.segment.id}}])},currentTime:function(){return this.video.currentTime()},reset:function(){this.currentSegmentIndex=0,this.playingSegments.length=0},getCurrentSegmentIndex:function(){return this.currentSegmentIndex},getCurrentSegmentTime:function(){var e,t;return this.currentTime()-(null!==(e=null===(t=this.playingSegments)||void 0===t||null===(t=t[this.currentSegmentIndex])||void 0===t||null===(t=t[0])||void 0===t?void 0:t.offset)&&void 0!==e?e:0)},ctor:function(e,t){this.api=e,this.video=t,this.addApiListeners()},dispose:function(){this._super.apply(this,arguments),this.removeApiListeners()}}),Vp=ds.extend({name:"NullEngine",logLevel:"warn",defaults:{bufferedDelay:.1},excludeFuncFromAutoDebug:[],api:null,events:null,repository:null,video:null,_buffered:0,manager:null,nodes:[],calcBuffered:function(){this._buffered=this.nodes.reduce((function(e,t){return e+t.duration}),0)},appendNode:function(e){var t=this.repo.nodes[e];return S().then(function(){this.nodes.push(t),this.manager.push(t),setTimeout(this.calcBuffered,1e3*this.getSetting("bufferedDelay"))}.bind(this))},reset:function(){return S().then(function(){this.nodes.length=0,this.calcBuffered(),this.video._currentTime=0,this.manager.reset()}.bind(this))},seek:function(e,t){return S().then(function(){return this.nodes.length=0,this.calcBuffered(),this.manager.reset(),this.appendNode(e)}.bind(this)).then(function(){this.video._currentTime=t}.bind(this))},getBuffered:function(){return this._buffered},videoTech:function(){return"null"},ctor:function(e,t,n){this._super(t,n),this.video=new jp(this.options,this.api,e),this.manager=new zp(this.options,this.api,this.video),this.video.setManager(this.manager),this.addErrorListener(this.video),this.addErrorListener(this.manager),this.defineProperty("repo",(function(){return{nodes:this.repository.nodeMap,segments:this.repository.segmentMap}}))}});const Wp=hs.extend({name:"FallbackVideo",logLevel:"warn",defaults:{imageLoadRetries:3,muted:Xi.getDefault("muted")},excludeFuncFromAutoDebug:["currentTime","onTick","getCanvas","getVideoWidth","getVideoHeight","getCurrentSegmentIndex","getCurrentSegmentTime","getPlaybackRate","setPlaybackRate","getNodeImageUrl","doesNodeHaveImage"],el:null,api:null,engine:null,events:null,_volume:1,_muted:!1,_paused:!0,_currentTime:0,prevTick:NaN,presentationTime:null,canvas:null,canvasContext:null,addAPIListeners:function(){this.api.on("nodestart",this.onNodeStart),this.api.on("playlistreset",this.onPlaylistReset),this.api.on("playlistpush",this.onPlaylistPush),this.on("imageloaded",this.onImageLoaded)},removeAPIListeners:function(){this.api.off("nodestart",this.onNodeStart),this.api.off("playlistreset",this.onPlaylistReset),this.api.off("playlistpush",this.onPlaylistPush),this.off("imageloaded",this.onImageLoaded)},onNodeStart:function(e){e.img?this.drawNodeImage(e):this.log.warn(`[onNodeStart] [${e.id}] Node has no image, skipping drawing`)},onPlaylistReset:function(){this.canvasContext.clearRect(0,0,this.canvas.width,this.canvas.height)},onPlaylistPush:function(e){this.initNodeImage(e)},onImageLoaded:function(e,t){var n;this.log.info(`[onImageLoaded] [${e.id}] Image loaded: ${t.src}`),(null===(n=e.metadata)||void 0===n||null===(n=n.frame)||void 0===n?void 0:n.contentWidth)<=0&&(e.metadata.frame={contentWidth:t.width,contentHeight:t.height,contentX:0,contentY:0,width:t.width,height:t.height}),this.loadImagesAhead()},loadImagesAhead:function(){const e=Array.prototype.slice.call(this.api.exports.playlist);if(!e.every((e=>e.img&&e.img.complete))||!e.length)return;let t={},n={};const i=e=>{this.api.exports.repository.has(e)&&(this.api.exports.repository.get(e).prefetch||[]).filter((e=>this.api.exports.repository.has(e))).map((e=>this.api.exports.repository.get(e))).forEach((e=>{n[e.id]||(n[e.id]=!0,e.img&&e.img.complete?i(e.id):e.img||(t[e.id]=e))}))};i(e[e.length-1].id),Object.keys(t).map((e=>this.api.exports.repository.get(e))).forEach(this.initNodeImage)},initNodeImage:async function(e){if(e.img||!this.doesNodeHaveImage(e))return void(e.img||(e.noimg=!0));if(e.isDurationUnknown&&(this.log.info(`[initNodeImage] [${e.id}] Waiting for node duration to be resolved`),await e.resolve(),e.img))return;void 0===e.data.imageStartOffset&&(e.data.imageStartOffset=e.duration/2);const t=new Image;t.crossOrigin="anonymous",t.src=this.getNodeImageUrl(e),e.img=t,this.log.info(`[initNodeImage] [${e.id}] Initialized image: ${t.src}`),t.addEventListener("load",(()=>this.trigger("imageloaded",e,t)),{once:!0}),t.addEventListener("error",(()=>{delete e.img,e.imgRetries=(e.imgRetries||0)+1,e.imgRetries<this.getSetting("imageLoadRetries")?(this.log.warn(`[initNodeImage] Failed to load image for node "${e.id}", retrying: ${t.src}`),this.initNodeImage(e),e.id===this.api.currentNodeId&&this.drawNodeImage(e)):this.log.error(`[initNodeImage] Failed to load image for node "${e.id}" after ${e.imgRetries} retries: ${t.src}`)}),{once:!0})},drawNodeImage:function(e){if(!e||!e.img)return;const t=()=>{if(!e.img.complete)return;let t=!1;this.canvas.width===e.img.width&&this.canvas.height===e.img.height||(this.canvas.width=e.img.width,this.canvas.height=e.img.height,this.canvas.videoWidth=this.canvas.width,this.canvas.videoHeight=this.canvas.height,t=!0),this.canvasContext.drawImage(e.img,0,0,this.canvas.width,this.canvas.height),t&&this.trigger(this.events.resize,e.img.width,e.img.height)};e.img.complete?t():e.img.addEventListener("load",t,{once:!0})},doesNodeHaveImage:function(e){return!!this.getNodeImageUrl(e)},getNodeImageUrl:function(e){var t;return null==e||null===(t=e.getImageUrl)||void 0===t?void 0:t.call(e)},notifyPause:function(){this.trigger(this.events.pause)},notifyPlay:function(){this.trigger(this.events.play)},notifyPlaying:function(){this.trigger(this.events.playing)},onTick:function(){var e=O();this._currentTime+=(e-this.prevTick)/1e3,this.prevTick=e},startTick:function(){this.prevTick=O(),Zr.start(this.onTick),this._paused=!1,this.notifyPlay(),this.notifyPlaying()},stopTick:function(){Zr.stop(this.onTick),this._paused=!0,this.prevTick=NaN,this.notifyPause()},getCanvas:function(){return this.canvas||(this.canvas=document.createElement("canvas"),this.canvasContext=this.canvas.getContext("2d"),this.canvas.width=1920,this.canvas.height=1080,this.canvas.videoWidth=this.canvas.width,this.canvas.videoHeight=this.canvas.height,this.api.exports.currentNode&&this.onNodeStart(this.api.exports.currentNode)),this.canvas},play:function(e){return(e=e||{}).wait?S():S().then(this.startTick)},pause:function(){return S().then(this.stopTick)},currentTime:function(){return this.presentationTime?this.presentationTime.getPresentationTime():0},getVolume:function(){return this._volume},setVolume:function(e){if("number"!=typeof e||isNaN(e))this.log.warn("Bad volume argument, ignoring.",e);else{if(e<0||e>1){var t=e<0?0:1;this.log.warn("Volume value out of range [0, 1]. Changing to "+t),e=t}this._volume!==e&&(this._volume=e,this.trigger(this.events.volumechange))}},getMuted:function(){return this._muted},setMuted:function(e){this._muted!==(e=!!e)&&(this._muted=e,this.trigger(this.events.volumechange))},getPaused:function(){return this._paused},getVideoWidth:function(){return this.canvas?this.canvas.width:1920},getVideoHeight:function(){return this.canvas?this.canvas.height:1080},getCurrentVideoTotalFrames:function(){return Math.round(this._currentTime/(1/23.976))},getCurrentVideoDroppedFrames:function(){return 0},getPlaybackRate:function(){return this.presentationTime?this.presentationTime.getPlaybackRate():1},setPlaybackRate:function(e){this.presentationTime&&this.presentationTime.setPlaybackRate(e)},ctor:function(e,t,n){this._super.apply(this,arguments),this.api=e,this.engine=n,this.el=t,this._muted=!!this.getSetting("muted");var i={};Object.defineProperty(i,"currentTime",{enumerable:!0,get:function(){return this._currentTime}.bind(this)}),this.presentationTime=new Is(this.options,i),this.addAPIListeners(),this.el.appendChild(this.getCanvas())},dispose:function(){this._super.apply(this,arguments),this.removeAPIListeners(),this.presentationTime&&"function"==typeof this.presentationTime.dispose&&this.presentationTime.dispose(),this.presentationTime=null;const e=this.getCanvas();e&&e.parentNode&&e.parentNode.removeChild(e)}});var Hp=ds.extend({name:"FallbackEngine",logLevel:"warn",defaults:{bufferedDelay:.01},excludeFuncFromAutoDebug:["normalizeNode","denormalizeNode"],api:null,events:null,repository:null,video:null,_buffered:0,nodes:[],calcBuffered:function(){let e=0;for(let t=0;t<this.nodes.length;t++){const n=this.nodes[t],i=n.supernode||n;if(!(i.noimg||i.img&&i.img.complete))break;e+=n.duration}this._buffered=e},onImageLoaded:function(){this.calcBuffered()},normalizeNode:function(e){return e.data=e.data||{},e.data.imageUrl=e.data.imageUrl||e.data.fallbackImageUrl,e},denormalizeNode:function(e){e&&e.data&&e.data.fallbackImageUrl===e.data.imageUrl&&delete e.data.imageUrl},appendNode:function(e){const t=this.repo.nodes[e];return S().then(function(){this.nodes.push(t),setTimeout(this.calcBuffered,1e3*this.getSetting("bufferedDelay"))}.bind(this))},reset:function(){return S().then(function(){this.nodes.length=0,this.calcBuffered(),this.video._currentTime=0}.bind(this))},seek:function(e,t){return S().then(function(){return this.nodes.length=0,this.calcBuffered(),this.appendNode(e)}.bind(this)).then(function(){this.video._currentTime=t||0}.bind(this))},getBuffered:function(){return this._buffered},videoTech:function(){return"fallback"},ctor:function(e,t,n){this._super(t,n),this.video=new Wp(this.options,this.api,e,this),this.video.on("imageloaded",this.onImageLoaded),this.repository.get("all").forEach(this.normalizeNode),this.repository.on("node.added",this.normalizeNode),this.repository.on("node.updated",this.normalizeNode),this.addErrorListener(this.video),this.defineProperty("repo",(function(){return{nodes:this.repository.nodeMap,segments:this.repository.segmentMap}}))},dispose:function(){this._super(),this.repository.get("all").forEach(this.denormalizeNode),this.repository.off("node.added",this.normalizeNode),this.repository.off("node.updated",this.normalizeNode),this.video.off("imageloaded",this.onImageLoaded),this.removeErrorListener(this.video),this.video.dispose()}});const $p=hs.extend({name:"MetamorphosisVideo",logLevel:"warn",excludeFuncFromAutoDebug:["getVideoWidth","getVideoHeight","currentTime","getPlaybackRate","setPlaybackRate","getCurrentVideoTotalFrames","getCurrentVideoDroppedFrames"],api:null,events:null,srcVideo:null,distVideo:null,isSrcVideoActive:!0,addVideoListeners:function(e){if(!e)return;const t=[this.events.resize,this.events.timeupdate,this.events.volumechange,this.events.audiolockedchange,this.events.loadeddata,this.events.playing,this.events.waiting,this.events.play,this.events.pause,this.events.ended];e.__metamorphosisListeners=e.__metamorphosisListeners||{},t.forEach((t=>{const n=(...e)=>{this.trigger(t,...e)};e.__metamorphosisListeners[t]=n,e.on(t,n)})),this.addErrorListener(e)},removeVideoListeners:function(e){e&&e.__metamorphosisListeners&&(Object.entries(e.__metamorphosisListeners).forEach((([t,n])=>{e.off(t,n)})),e.__metamorphosisListeners=null,this.removeErrorListener(e))},switchToDestVideo:function(){this.log.info(`[switchToDestVideo] Switching to dest video: ${this.destVideo.name}`),this.isSrcVideoActive=!1;const e=!this.api.exports.paused;this.removeVideoListeners(this.srcVideo),this.addVideoListeners(this.destVideo),this.srcVideo.dispose(),this.srcVideo=null,e&&this.play()},abandonDestVideo:function(){this.log.info(`[abandonDestVideo] Abandoning dest video: ${this.destVideo.name}`),this.isSrcVideoActive=!0,this.removeVideoListeners(this.destVideo),this.destVideo.dispose(),this.destVideo=null},play:function(e){this.activeVideo.play(e)},pause:function(e){this.activeVideo.pause(e)},currentTime:function(){return this.activeVideo.currentTime()},getVolume:function(){return this.activeVideo.getVolume()},setVolume:function(e){this.videos.forEach((t=>t.setVolume(e)))},getMuted:function(){return this.activeVideo.getMuted()},setMuted:function(e){this.videos.forEach((t=>t.setMuted(e)))},getPaused:function(){return this.activeVideo.getPaused()},getVideoWidth:function(){return this.activeVideo.getVideoWidth()},getVideoHeight:function(){return this.activeVideo.getVideoHeight()},getPlaybackRate:function(){return this.activeVideo.getPlaybackRate()},setPlaybackRate:function(e){this.videos.forEach((t=>t.setPlaybackRate(e)))},getIsAudioLocked:function(){return this.activeVideo.getIsAudioLocked()},getCurrentVideoTotalFrames:function(){return this.activeVideo.getCurrentVideoTotalFrames()},getCurrentVideoDroppedFrames:function(){return this.activeVideo.getCurrentVideoDroppedFrames()},ctor:function(e,t,n){this.srcVideo=t,this.destVideo=n,this.defineProperty("activeVideo",(()=>this.isSrcVideoActive?this.srcVideo:this.destVideo)),this.defineProperty("videos",(()=>[this.srcVideo,this.destVideo].filter(Boolean))),this._super.apply(this,arguments),this.addVideoListeners(this.activeVideo)},dispose:function(){this._super.apply(this,arguments),this.videos.forEach((e=>{this.removeVideoListeners(e)}))}}),Gp=ds.extend({name:"MetamorphosisEngine",logLevel:"warn",defaults:{waitForApiEventBeforeInitingDestEngineLoading:"canplay",destEngineReadyCheckInterval:.1,destEngineReadyCheckTimeout:15,minCanplayBuffer:Xi.getDefault("minCanplayBuffer"),bufferFullDelta:.35,waitForNextSeekToSwitch:!0,switchAsapIfNotVisible:!0,noSeekTimeout:5},excludeFuncFromAutoDebug:["videoTech","updateBitrate","getBuffered","isRepSupported","getIsUnlockingRequired","transformIvd","getNeededFormatNames","getEngineDuration","getEngineString"],api:null,events:null,repository:null,video:null,srcEngine:null,destEngine:null,isSrcEngineActive:!0,isDestEngineLoadingAllowed:!1,isDestEngineReadyForSwitch:!1,didNoSeekTimeoutOccur:!1,isPlayerVisible:function(){return"visible"===document.visibilityState&&this.api.pluginCtx.presumedVisibility.isPresumedVisible},onVisibilityChange:function(){this.getSetting("switchAsapIfNotVisible")&&(this.isPlayerVisible()||this.isSrcEngineActive&&this.isDestEngineReadyForSwitch&&(this.log.info("[onVisibilityChange] Player is not visible and destination engine is ready for switch. Switching immediately."),this.switchToDestEngine()))},onDocumentVisibilityChange:function(){this.onVisibilityChange()},onPresumedVisibilityChange:function(){this.onVisibilityChange()},doAddRemoveVisibilityListeners:function(e=!1){const t=e?"addEventListener":"removeEventListener";this.api.exports&&this.api.exports[e?"on":"off"]("presumedvisibilitychange",this.onPresumedVisibilityChange),document&&document[t]("visibilitychange",this.onDocumentVisibilityChange)},addVisibilityListeners:function(){this.doAddRemoveVisibilityListeners(!0)},removeVisibilityListeners:function(){this.doAddRemoveVisibilityListeners(!1)},addEngineListeners:function(e){e&&(e.__metamorphosisListeners=e.__metamorphosisListeners||{},["bitrateUpdated","downloadComplete","bytesDownloaded","representationChosen","representationsChosen","nodeLoading","nodeLoadingPausing","nodeLoadingComplete"].forEach((t=>{const n=(...e)=>{this.trigger(t,...e)};e.__metamorphosisListeners[t]=n,e.on(t,n)})),this.addErrorListener(e))},removeEngineListeners:function(e){e&&e.__metamorphosisListeners&&(Object.entries(e.__metamorphosisListeners).forEach((([t,n])=>{e.off(t,n)})),e.__metamorphosisListeners=null,this.removeErrorListener(e))},queueDestEngineAction:function(e,...t){this.destEngine&&(this.destEngine.__metamorphosisQueuedActions=this.destEngine.__metamorphosisQueuedActions||[],this.destEngine.__metamorphosisQueuedActions.push([e,t]))},dequeueDestEngineActions:async function(){if(!this.destEngine.__metamorphosisQueuedActions)return;const e=this.destEngine.__metamorphosisQueuedActions.findLastIndex((([e])=>"reset"===e)),t=this.destEngine.__metamorphosisQueuedActions.findLastIndex((([e])=>"seek"===e)),n=this.destEngine.__metamorphosisQueuedActions.slice(e>t?e+1:Math.max(t,0));for(const[e,t]of n)this.log.info(`[dequeueDestEngineActions] Executing queued action: ${e}`,t),await this.destEngine[e](...t);this.destEngine.__metamorphosisQueuedActions=null},switchToDestEngine:function(){this.log.info(`[switchToDestEngine] Switching to destination engine: ${this.destEngine.videoTech()}`),this.isSrcEngineActive&&this.isDestEngineReadyForSwitch?(this.isSrcEngineActive=!1,this.video.switchToDestVideo(),this.removeEngineListeners(this.srcEngine),this.srcEngine.dispose(),this.srcEngine=null,this.api.exports.trigger("enginechange",this.destEngine.engineStr)):this.log.warn("[switchToDestEngine] Cannot switch to destination engine. Already switched, or destination engine is not ready.")},abandonDestEngine:function(){this.log.info(`[abandonDestEngine] Abandoning destination engine: ${this.destEngine.name}. Continuing with source engine.`),this.isSrcEngineActive=!0,this.isDestEngineLoadingAllowed=!1,this.isDestEngineReadyForSwitch=!1,this.video.abandonDestVideo(),this.removeEngineListeners(this.destEngine),this.destEngine.dispose(),this.destEngine=null,this.api.exports.trigger("metamorphosis.abandondestengine")},attemptToNotifyNeedSeekToSwitch:function(){this.isSrcEngineActive&&this.didNoSeekTimeoutOccur&&this.isDestEngineReadyForSwitch&&(this.log.info('[attemptToNotifyNeedSeekToSwitch] Triggering "metamorphosis.needseektoswitch" event to ask for a seek to switch.'),this.api.exports.trigger("metamorphosis.needseektoswitch"))},onDestEngineReadyForSwitch:function(){if(this.api.exports.trigger("metamorphosis.destengineready"),this.isDestEngineReadyForSwitch=!0,this.getSetting("waitForNextSeekToSwitch")&&this.isPlayerVisible())return this.log.info("[onDestEngineReadyForSwitch] Destination engine is ready for switch, but waiting for next seek event to switch."),void this.attemptToNotifyNeedSeekToSwitch();this.log.info("[onDestEngineReadyForSwitch] Destination engine is ready for switch. Switching immediately."),this.switchToDestEngine()},onDestEngineNotReadyTimeout:function(){this.log.info("[onDestEngineNotReadyTimeout] Destination engine not ready for switch. Disposing of dest engine and continuing with source engine."),this.abandonDestEngine()},getEngineDuration:function(){return this.api.pluginCtx.controller._duration-this.api.pluginCtx.controller._playbackOffset},waitForDestEngineToBeReadyForSwitch:function(){const e=this.getSetting("minCanplayBuffer"),t=this.getSetting("bufferFullDelta");Zr.predicator((()=>{const n=this.destEngine.getBuffered();return n>0&&(n>=e||n>=this.getEngineDuration()-t)}),{onFulfilled:this.onDestEngineReadyForSwitch,onTimeout:this.onDestEngineNotReadyTimeout,interval:1e3*this.getSetting("destEngineReadyCheckInterval"),timeout:1e3*this.getSetting("destEngineReadyCheckTimeout")})},onApiEventToInitDestEngineLoading:function(){if(!this.isDestEngineLoadingAllowed&&(this.api.exports.trigger("metamorphosis.destengineloadstart"),this.isDestEngineLoadingAllowed=!0,this.dequeueDestEngineActions(),this.waitForDestEngineToBeReadyForSwitch(),this.getSetting("waitForNextSeekToSwitch")&&"number"==typeof this.getSetting("noSeekTimeout"))){const e=1e3*this.getSetting("noSeekTimeout");setTimeout((()=>{this.didNoSeekTimeoutOccur=!0,this.attemptToNotifyNeedSeekToSwitch()}),e)}},appendNode:function(e){const t=this.activeEngine.appendNode(e);return this.isSrcEngineActive&&(this.isDestEngineLoadingAllowed?this.destEngine.appendNode(e):this.queueDestEngineAction("appendNode",e)),t},reset:function(){const e=this.activeEngine.reset();return this.isSrcEngineActive&&(this.isDestEngineLoadingAllowed?this.destEngine.reset():this.queueDestEngineAction("reset")),e},endStream:function(){return this.activeEngine.endStream()},seek:function(e,t){this.isSrcEngineActive&&this.isDestEngineReadyForSwitch&&this.getSetting("waitForNextSeekToSwitch")&&this.switchToDestEngine();const n=this.activeEngine.seek(e,t);return this.isSrcEngineActive&&(this.isDestEngineLoadingAllowed?this.destEngine.seek(e,t):this.queueDestEngineAction("seek",e,t)),n},getBuffered:function(){return this.activeEngine.getBuffered()},videoTech:function(){return`metamorphosis_${this.activeEngine.engineStr}`},updateBitrate:function(e){this.engines.forEach((function(t){t.updateBitrate(e)}))},updateBaseUrl:function(e){this.engines.forEach((function(t){t.updateBaseUrl(e)}))},setForceBaseUrl:function(e){this.engines.forEach((function(t){t.setForceBaseUrl(e)}))},setBitrateMultiplier:function(e){this.engines.forEach((function(t){t.setBitrateMultiplier(e)}))},isRepSupported:function(e){return this.engines.reduce((function(t,n){return t&&n.isRepSupported(e)}),!0)},getIsUnlockingRequired:function(){return this.engines.reduce((function(e,t){return e||t.getIsUnlockingRequired()}),!1)},loadNode:function(){this.engines.forEach((function(e){e.loadNode()}))},monitorDownloads:function(e){this.engines.forEach((function(t){t.monitorDownloads(e)}))},setBaseUrlLoadVariants:function(e){this.engines.forEach((function(t){t.setBaseUrlLoadVariants(e)}))},getNeededFormatNames:function(){var e=[];return this.engines.forEach((function(t){e=e.concat(t.neededFormatNames)})),e},transformIvd:function(e){for(const t of this.engines)e=t.transformIvd(e);return e},ctor:function(e,t,n,i,r){if(this._super(t,n),!i||!r)return void this.notifyError("Missing source or destination engines in call to MetamorphosisEngine constructor");this.srcEngine=i,this.destEngine=r,this.video=new $p(this.options,this.api,this.srcEngine.video,this.destEngine.video),this.addErrorListener(this.video),this.defineProperty("activeEngine",(()=>this.isSrcEngineActive?this.srcEngine:this.destEngine)),this.defineProperty("engines",(()=>[this.srcEngine,this.destEngine].filter(Boolean))),this.engines.forEach((e=>{this.addEngineListeners(e)})),this.addVisibilityListeners();const o=this.getSetting("waitForApiEventBeforeInitingDestEngineLoading");o?this.api.exports.once(o,this.onApiEventToInitDestEngineLoading):this.onApiEventToInitDestEngineLoading()},dispose:function(){this._super.apply(this,arguments),this.engines.forEach((e=>{e&&(this.removeEngineListeners(e),e.dispose())})),this.removeVisibilityListeners(),this.removeErrorListener(this.video),this.video.dispose();const e=this.getSetting("waitForApiEventBeforeInitingDestEngineLoading");e&&this.api.exports.off(e,this.onApiEventToInitDestEngineLoading)}});var qp=ji.extend({name:"Canvas",logLevel:"warn",version:"0.0.1",excludeFuncFromAutoDebug:["drawFrame"],defaults:{fps:40,drawFrame:null,canvasStyle:{position:"absolute",visibility:"visible",top:"0px",left:"0px",width:"100%",height:"100%"},canvasWidth:854,canvasHeight:480,backColor:"black"},canvasElement:null,canvasContext:null,fps:null,userDrawFrame:null,drawFrame:function(...e){this.canvasContext&&"function"==typeof this.userDrawFrame&&this.userDrawFrame(this.canvasElement,this.canvasContext,...e)},clearFrame:function(){this.canvasElement&&this.canvasContext&&(this.canvasContext.fillStyle=this.getSetting("backColor","black"),this.canvasContext.fillRect(0,0,this.canvasElement.width,this.canvasElement.height))},initCanvas:function(e){this.canvasElement&&this.disposeCanvas(),this.canvasElement=document.createElement("canvas");var t=this.getSetting("canvasStyle",null);for(var n in t)this.canvasElement.style[n]=t[n];this.canvasElement.width=this.getSetting("canvasWidth"),this.canvasElement.height=this.getSetting("canvasHeight");var i=this.canvasElement;Object.defineProperty(i,"videoWidth",{enumerable:!0,get:function(){return i.width}}),Object.defineProperty(i,"videoHeight",{enumerable:!0,get:function(){return i.height}}),e.appendChild(this.canvasElement);var r=this.canvasElement.getContext("2d");r.imageSmoothingQuality="low",r.mozImageSmoothingQuality="low",r.webkitImageSmoothingQuality="low",r.msImageSmoothingQuality="low",r.imageSmoothingEnabled=!1,r.mozImageSmoothingEnabled=!1,r.webkitImageSmoothingEnabled=!1,r.msImageSmoothingEnabled=!1,this.canvasContext=r,this.fps=this.getSetting("fps",24)},cloneCanvas:function(e){var t=document.createElement("canvas");return e&&(t.width=e.width,t.height=e.height,t.width&&t.height&&t.getContext("2d").drawImage(e,0,0,e.width,e.height,0,0,t.width,t.height)),t},disposeCanvas:function(){this.canvasElement&&(this.canvasElement.parentNode.removeChild(this.canvasElement),this.canvasElement=null,this.canvasContext=null),this.stopTick()},startTick:function(){Zr.start(this.drawFrame,this.fps>0?1e3/this.fps:0)},stopTick:function(){Zr.stop(this.drawFrame)},ctor:function(e,t){this.initCanvas(e),this.userDrawFrame=t},dispose:function(){this._super.apply(this,arguments),this.disposeCanvas()}});function Yp(e,t,n,i){return{playlistIndex:n,nodeId:e,segmentId:t,duration:i,frames:[],totalAllocatedBytes:0,freedAllocatedBytes:0,currDrawnFrameTimestamp:-1,buffered:0}}const Kp=hs.extend({name:"WebCodecsVideo",logLevel:"warn",defaults:{updatePlaybackCurrentTimeInterval:.25,noNextFrameToleranceSeconds:.1,seekSleepTimeWhileWaitingForMoreFrames:10,bufferedImpl:"loaded"},excludeFuncFromAutoDebug:["getVideoWidth","getVideoHeight","getPlaybackRate","setPlaybackRate","getVolume","getMuted","getIsAudioLocked","drawFrame","pushFrames","getCanvas","getBuffered","getCurrentVideoTotalFrames","getCurrentVideoDroppedFrames","doDrawFrame","onBuffered","getBufferedLoaded","getBufferedDecoded"],api:null,events:null,canvas:null,didRenderFirstFrame:!1,segmentObjectsPlaylist:[],droppedFramesCount:0,totalFramesCount:0,addRemoveAPIListeners:function(e=!1){var t;null===(t=this.api)||void 0===t||t[e?"on":"off"]("playlistreset",this.onPlaylistReset)},addAPIListeners:function(){this.addRemoveAPIListeners(!0)},removeAPIListeners:function(){this.addRemoveAPIListeners(!1)},onPlaylistReset:function(){var e;null===(e=this.canvas)||void 0===e||e.clearFrame(),this.reset()},onSyncMasterVideoSegmentEnd:function(e){this.trigger("updateplaybackindex",{playlistIndex:this.currSegIndex}),e?this.closeAllFrames():this.segmentObjectsPlaylist.slice(0,this.currSegIndex).forEach((({frames:e},t)=>{e.length&&(this.log.debug(`[onSyncMasterVideoSegmentEnd] Closing all frames for segment #${t}`),e.forEach((e=>e.close())),e.length=0)}))},addRemoveSyncMasterVideoListeners:function(e=!1){this.syncMasterVideo&&this.syncMasterVideo[e?"on":"off"]("segmentend",this.onSyncMasterVideoSegmentEnd)},addSyncMasterVideoListeners:function(){this.addRemoveSyncMasterVideoListeners(!0)},removeSyncMasterVideoListeners:function(){this.addRemoveSyncMasterVideoListeners(!1)},reset:function(){this.closeAllFrames(),this.segmentObjectsPlaylist=[],this.didRenderFirstFrame=!1},notifyPause:function(){this.trigger(this.events.pause)},notifyPlay:function(){this.trigger(this.events.play)},notifyPlaying:function(){this.trigger(this.events.playing)},pushFrames:function({nodeId:e,segmentId:t,playlistIndex:n,duration:i,frames:r,framesMeta:o}){if(r&&r.length){if(this.log.info(`[pushFrames] [${e}] [${t}] #${n} Pushing ${r.length} frames for playback`,r),this.segmentObjectsPlaylist[n]=this.segmentObjectsPlaylist[n]||Yp(e,t,n,i),r[0]instanceof ImageBitmap)for(let e=0;e<r.length;e++)r[e].timestamp=o[e].timestamp,r[e].duration=o[e].duration,r[e].displayWidth=o[e].displayWidth,r[e].displayHeight=o[e].displayHeight,r[e].allocatedBytes=o[e].allocatedBytes;r.forEach((e=>{const t=function(e){return e?e.__closed?0:"function"==typeof e.allocationSize?e.allocationSize():e.allocatedBytes?e.allocatedBytes:e.displayWidth*e.displayHeight*1.5:0}(e),i=e.close.bind(e);this.segmentObjectsPlaylist[n].totalAllocatedBytes+=t,e.close=()=>{var r;e.__closed||(null!==(r=this.segmentObjectsPlaylist)&&void 0!==r&&r[n]&&(this.segmentObjectsPlaylist[n].freedAllocatedBytes+=t),i(),e.__closed=!0)}})),this.segmentObjectsPlaylist[n].frames.push(...r),this.segmentObjectsPlaylist[n].frames.sort(((e,t)=>e.timestamp-t.timestamp)),this.didRenderFirstFrame||(this.log.info(`[pushFrames] [${e}] [${t}] #${n} Drawing first frame immediately @ ${(r[0].timestamp/1e6).toFixed(3)}`),this.didRenderFirstFrame=!0,this.canvas.drawFrame(!0))}else this.log.warn(`[pushFrames] [${e}] [${t}] #${n} No frames to push`)},onBuffered:function({nodeId:e,segmentId:t,playlistIndex:n,duration:i,buffered:r}){this.log.info(`[onBuffered] [${e}] [${t}] #${n} Buffered ${r.toFixed(3)}s / ${i.toFixed(3)}s`),this.segmentObjectsPlaylist[n]=this.segmentObjectsPlaylist[n]||Yp(e,t,n,i),this.segmentObjectsPlaylist[n].buffered=r},doDrawFrame:function(e,t){t.drawImage(e,0,0,e.displayWidth,e.displayHeight),e.close()},drawFrame:function(e,t,n=!1){const i=this.syncMasterVideo.getCurrentSegmentTime();let r=this.segmentObjectsPlaylist[this.currSegIndex];if(!r)return void this.trigger(this.events.waiting);const{frames:o}=r;if(!o.length){if(r.currDrawnFrameEndTime>i)return;if(r.currDrawnFrameTimestamp<=i&&i<r.currDrawnFrameTimestamp+this.getSetting("noNextFrameToleranceSeconds",.1))return;return void this.trigger(this.events.waiting)}if(r.currDrawnFrameTimestamp<=i&&i<o[0].timestamp/1e6&&!n)return;let s=n?0:o.findIndex(((e,t,n)=>{var r;const o=null!==(r=n[t+1])&&void 0!==r?r:{timestamp:Number.POSITIVE_INFINITY};return e.timestamp/1e6<=i&&i<o.timestamp/1e6}));if(-1===s)return void this.trigger(this.events.waiting);const a=o.splice(0,s);this.droppedFramesCount+=a.length,this.totalFramesCount+=a.length+1,a.forEach((e=>e.close()));const l=o.shift();l&&(r.currDrawnFrameTimestamp=l.timestamp/1e6,r.currDrawnFrameEndTime=r.currDrawnFrameTimestamp+l.duration/1e6,e.width===l.displayWidth&&e.height===l.displayHeight||(e.width=l.displayWidth,e.height=l.displayHeight,this.log.debug(`[drawFrame] [${r.nodeId}] [${r.segmentId}] #${r.playlistIndex} Resized canvas to ${e.width}x${e.height}`),this.trigger(this.events.resize,e.width,e.height)),this.log.debug(`[drawFrame] [${r.nodeId}] [${r.segmentId}] #${r.playlistIndex} Drawing frame ${(l.timestamp/1e6).toFixed(3)} (currSegAudioTime === ${i.toFixed(3)})${a.length?`[DISCARDED ${a.length} FRAMES ${(a[0].timestamp/1e6).toFixed(3)} - ${(a[a.length-1].timestamp/1e6).toFixed(3)}]`:""}`),this.doDrawFrame(l,t))},setOtherEngines:function(e){this.otherEngines=e,this.addSyncMasterVideoListeners()},closeAllFrames:function(){this.segmentObjectsPlaylist.forEach((({frames:e})=>{e.forEach((e=>e.close()))}))},getCanvas:function(){var e;const t=null===(e=this.canvas)||void 0===e?void 0:e.canvasElement;return!t||t.videoWidth===t.width&&t.videoHeight===t.height||(t.videoWidth=t.width,t.videoHeight=t.height),t},onUpdatePlaybackCurrentTimeTick:function(){this.trigger("updateplaybackcurrenttime",{playlistIndex:this.currSegIndex,currentTime:this.syncMasterVideo.getCurrentSegmentTime()})},startUpdatePlaybackCurrentTimeTick:function(){Zr.start(this.onUpdatePlaybackCurrentTimeTick,1e3*this.getSetting("updatePlaybackCurrentTimeInterval"))},stopUpdatePlaybackCurrentTimeTick:function(){Zr.stop(this.onUpdatePlaybackCurrentTimeTick)},play:async function(){return this.canvas.startTick(),this.startUpdatePlaybackCurrentTimeTick(),Promise.resolve()},pause:function(){return this.canvas.stopTick(),this.stopUpdatePlaybackCurrentTimeTick(),this.onUpdatePlaybackCurrentTimeTick(),Promise.resolve()},getBufferedLoaded:function(){const e=this.segmentObjectsPlaylist.slice(0,-1).reduce(((e,{duration:t})=>e+t),0),t=this.segmentObjectsPlaylist[this.segmentObjectsPlaylist.length-1];return e+((null==t?void 0:t.buffered)||0)},getBufferedDecoded:function(){var e;const t=this.segmentObjectsPlaylist.findLastIndex((e=>{var t;return!(null==e||null===(t=e.frames)||void 0===t||!t.length)})),n=this.segmentObjectsPlaylist.slice(0,t).reduce(((e,{duration:t})=>e+t),0),i=this.segmentObjectsPlaylist[t],r=null==i?void 0:i.frames[(null==i||null===(e=i.frames)||void 0===e?void 0:e.length)-1];return n+((null==r?void 0:r.timestamp)||0)/1e6},getBuffered:function(){if(!this.segmentObjectsPlaylist.some((({frames:e})=>e.length>0))){const e=this.segmentObjectsPlaylist[this.currSegIndex];if(null==e||!e.currDrawnFrameEndTime)return 0}return"decoded"===this.getSetting("bufferedImpl")?this.getBufferedDecoded():this.getBufferedLoaded()},getVideoWidth:function(){var e,t;return null!==(e=null===(t=this.canvas)||void 0===t||null===(t=t.canvasElement)||void 0===t?void 0:t.width)&&void 0!==e?e:0},getVideoHeight:function(){var e,t;return null!==(e=null===(t=this.canvas)||void 0===t||null===(t=t.canvasElement)||void 0===t?void 0:t.height)&&void 0!==e?e:0},getCurrentVideoTotalFrames:function(){return this.totalFramesCount},getCurrentVideoDroppedFrames:function(){return this.droppedFramesCount},ctor:function(e,t){var n;this._super.apply(this,arguments),this.addAPIListeners(),this.canvas=new qp({...this.options,Canvas:{fps:0,...null===(n=this.options)||void 0===n?void 0:n.Canvas}},t,this.drawFrame),this.defineProperty("syncMasterVideo",(function(){return this.otherEngines[0].video})),this.defineProperty("currSegIndex",(()=>this.syncMasterVideo.getCurrentSegmentIndex()))},dispose:function(){this._super.apply(this,arguments),this.removeAPIListeners(),this.removeSyncMasterVideoListeners(),this.closeAllFrames()}});function Xp(e){return new Promise(((t,n)=>{navigator.serviceWorker.controller?t(navigator.serviceWorker.controller):(navigator.serviceWorker.addEventListener("controllerchange",(()=>{t(navigator.serviceWorker.controller)})),null!=e&&e.timeout&&setTimeout((()=>{n(new Error("Timeout while waiting for service worker controller"))}),e.timeout))}))}const Qp={body:JSON.stringify({status:404,message:"No local server registered"}),options:{status:404,statusText:"Not Found",headers:{"Content-Type":"application/json"}}};let Zp=null;const Jp=ji.extend({name:"ServiceWorkerManager",logLevel:"warn",defaults:{serviceWorkerPath:"/service-worker.min.js",localServerHost:"sw-local.eko.com",maxInitRetries:2,controllerPromiseTimeout:.1},excludeFuncFromAutoDebug:["getBaseUrl","onServiceWorkerMessage","postMessageToServiceWorker","onServiceWorkerLog","postFetchResponse","getLocalServerHost"],localServerCallbackFunc:(e,t)=>{const{body:n,options:i}=Qp;t(n,i)},initCompleteDefer:null,didSendInitClientMessage:!1,initRetryCount:0,onServiceWorkerFetch:function(e){if("function"!=typeof this.localServerCallbackFunc)return void this.log.warn("[onServiceWorkerFetch] Unexpected state - no local server registered",e);const{url:t}=e;this.log.info(`[onServiceWorkerFetch] ${t}`),this.localServerCallbackFunc(e,((e,n)=>{this.postFetchResponse(t,e,n)}))},onServiceWorkerClientInited:function(e){this.log.info("[onServiceWorkerClientInited] Service worker successfully inited this client:",e)},onServiceWorkerLog:function({level:e="info",message:t}){this.log[e](`[onServiceWorkerLog] ${t}`)},addSelfListeners:function(){this.on("clientinited",this.onServiceWorkerClientInited),this.on("fetch",this.onServiceWorkerFetch),this.on("log",this.onServiceWorkerLog)},removeSelfListeners:function(){this.off("clientinited",this.onServiceWorkerClientInited),this.off("fetch",this.onServiceWorkerFetch),this.off("log",this.onServiceWorkerLog)},onServiceWorkerMessage:function(e){const t=e.data;t&&t.type&&("log"!==t.type&&this.log.debug("[onServiceWorkerMessage] Triggering event:",t.type,t.data),this.trigger(t.type,t.data))},addServiceWorkerListeners:function(){navigator.serviceWorker.addEventListener("message",this.onServiceWorkerMessage)},removeServiceWorkerListeners:function(){navigator.serviceWorker.removeEventListener("message",this.onServiceWorkerMessage)},initClient:function(){this.postMessageToServiceWorker("initclient"),this.didSendInitClientMessage=!0},initServer:async function(){const e=function(e){return e&&"string"==typeof e?new URL(e,document.location).href:e}(this.getSetting("serviceWorkerPath"));let t;this.log.info("[initServer] Registering service worker:",e);try{t=await navigator.serviceWorker.register(e),this.log.info("[initServer] Service worker registered successfully"),await navigator.serviceWorker.ready,this.log.info("[initServer] Service worker ready");try{await Xp({timeout:1e3*this.getSetting("controllerPromiseTimeout")}),this.log.info('[initServer] Service worker is active and in control of page, sending "initclient" message'),this.initClient()}catch(e){if(this.initRetryCount>=this.getSetting("maxInitRetries"))return void this.log.error("[initServer] Max retries reached, aborting");this.log.warn("[initServer] Service worker is not in control of page, hard refresh suspected, unregistering service worker and trying again"),this.initRetryCount+=1,await t.unregister(),this.log.info("[initServer] Service worker unregistered, retrying init"),await this.initServer()}}catch(e){this.log.warn("[initServer] Failed to register service worker",e)}finally{this.log.info("[initServer] Service worker registration complete, resolving initComplete promise"),this.initCompleteDefer.resolve(),t&&"function"==typeof t.update&&(async()=>{this.log.info("[initServer] Attempting to update service worker");try{await t.update(),this.log.info("[initServer] Service worker updated successfully"),this.initClient()}catch(e){this.log.warn("[initServer] Failed to update service worker:",e)}})()}},postMessageToServiceWorker:async function(e,t){if(!navigator.serviceWorker.controller)return await Xp(),void this.postMessageToServiceWorker(e,t);this.log.info(`[postMessageToServiceWorker] Posting message [${e}]:`,t),navigator.serviceWorker.controller.postMessage({type:e,data:t})},postFetchResponse:function(e,t,n){this.postMessageToServiceWorker("fetchresponse",{url:e,body:t,options:n})},registerLocalServer:function(e){if(!e||"function"!=typeof e)throw new Error("[registerLocalServer] Callback function is required");this.localServerCallbackFunc=e},getLocalServerHost:function(){return this.getSetting("localServerHost")},getInitCompletePromise:function(){return this.initCompleteDefer.promise},performCacheSweep:function(e){const{urlsToDelete:t=[],urlsToKeep:n=[]}=e||{};this.postMessageToServiceWorker("cachesweep",{urlsToDelete:t,urlsToKeep:n})},ctor:function(){if(this._super.apply(this,arguments),Zp)throw new Error("[ctor] Service worker manager is a singleton, use ServiceWorkerManager.getInstance() instead");if(Zp=this,this.initCompleteDefer=S.defer(),!("serviceWorker"in window.navigator))return this.log.warn("[ctor] Service worker is not supported on current environment, skipping"),void this.initCompleteDefer.resolve();this.addServiceWorkerListeners(),this.addSelfListeners(),this.initServer()},dispose:function(){this._super.apply(this,arguments),this.didSendInitClientMessage&&this.postMessageToServiceWorker("disposeclient"),this.removeServiceWorkerListeners(),this.removeSelfListeners()}});Jp.getInstance=function(e){return Zp||(Zp=new Jp(e)),Zp};const ef=ki.getObjectProperty(Ae,"browser.name","").toLowerCase(),tf=ki.getObjectProperty(Ae,"os.name","").toLowerCase(),nf="ios"===tf,rf=ef.indexOf("safari")>=0||nf,of=ds.extend({name:"WebCodecsEngine",logLevel:"warn",defaults:{updateFreedBytesInterval:.1,bitrateConfig:{enableAdaptiveBitrate:Xi.getDefault("adaptiveBitrateEnabled"),ivdStrategy:Xi.getDefault("ivdStrategy"),ivdResolutionFilterEnabled:Xi.getDefault("ivdResolutionFilterEnabled"),alpha:.15,bitrateMultiplier:1.5,enableCacheDetection:!0,cacheRate:Ae.isDesktop?8e7:2e7,cacheFactor:3,cacheScoreThreshold:.85,factorScoreWeight:.5,updateInterval:.1},segmentDecoderConfig:{convertFramesToBitmaps:"android"===tf,androidFixEndOfSegmentDelta:.2,hardwareAcceleration:Xi.getDefault("hardwareAcceleration")},shouldResetOnVisibilityChange:nf,segmentLoaderConfig:{forceTransBufferBinaryLoader:!0,forceXhrOnEdge:!0,forceStreamBinaryLoader:!1,chunkSize:512e3,maxProgressElapsedTime:.5,retries:5,retryDelay:.4,maxReadDuration:.04},memory:{type:"constrained",maxmemory:Ae.isDesktop?1e8:25e6,logic:{and:{infutureplaylist:!1,or:{inrepo:!1,innextlevels:{depth:3,value:!1}}}}},forcePseudoWorker:!0,swCacheEnabled:!!Ae.queryParams.forceswcache||!Ae.queryParams.noswcache,priorityLoadingManager:{enabled:Xi.getDefault("priorityLoadingEnabled")}},excludeFuncFromAutoDebug:["videoTech","updateBitrate","getBuffered","isRepSupported","isRepOfChosenFormat","getIsUnlockingRequired","transformIvd","getWorkerSafeNode","getWorkerSafeSegment","doUpdateWorkerRepo","getNeededFormatNames","onWorkerBuffered","onWorkerVideoFrames","onUpdateFreedBytesTick","onWorkerBytesDownloaded","onWorkerDownloadComplete","onVideoUpdatePlaybackIndex","onVideoUpdatePlaybackCurrentTime"],api:null,events:null,repository:null,video:null,worker:null,workerMsgChannel:null,bitrate:null,baseUrl:null,forceBaseUrl:null,baseUrlLoadVariants:null,workerStartedPromise:null,workerInitedPromise:null,isWorkerReady:!1,repoSyncHelper:null,supportedFormatNames:null,mediaCapabilities:null,addRemoveWorkerListeners:function(e=!1){var t,n,i,r,o,s,a,l,c,u,d,h,p,f;const g=e?"on":"off";null===(t=this.workerMsgChannel)||void 0===t||t[g]("message",this.onWorkerMessage),null===(n=this.workerMsgChannel)||void 0===n||n[g]("log",this.onWorkerLog),null===(i=this.workerMsgChannel)||void 0===i||i[g]("updateBitrate",this.onWorkerUpdateBitrate),null===(r=this.workerMsgChannel)||void 0===r||r[g]("representationChosen",this.onWorkerRepresentationChosen),null===(o=this.workerMsgChannel)||void 0===o||o[g]("representationsChosen",this.onWorkerRepresentationsChosen),null===(s=this.workerMsgChannel)||void 0===s||s[g]("loadError",this.onWorkerLoadError),null===(a=this.workerMsgChannel)||void 0===a||a[g]("downloadComplete",this.onWorkerDownloadComplete),null===(l=this.workerMsgChannel)||void 0===l||l[g]("bytesDownloaded",this.onWorkerBytesDownloaded),null===(c=this.workerMsgChannel)||void 0===c||c[g]("nodeLoading",this.onWorkerNodeLoading),null===(u=this.workerMsgChannel)||void 0===u||u[g]("nodeLoadingPausing",this.onWorkerNodeLoadingPausing),null===(d=this.workerMsgChannel)||void 0===d||d[g]("nodeLoadingComplete",this.onWorkerNodeLoadingComplete),null===(h=this.workerMsgChannel)||void 0===h||h[g]("videoframes",this.onWorkerVideoFrames),null===(p=this.workerMsgChannel)||void 0===p||p[g]("buffered",this.onWorkerBuffered),null===(f=this.workerMsgChannel)||void 0===f||f[g]("error",this.onWorkerError)},addWorkerListeners:function(){this.addRemoveWorkerListeners(!0)},removeWorkerListeners:function(){this.addRemoveWorkerListeners(!1)},disposeWorker:function(){this.postMessage("dispose"),this.isWorkerReady=!1},postMessage:function(e,t){this.workerMsgChannel&&(this.log.info(`Posting message [${e}] with data:`,t),this.workerMsgChannel.post(e,t))},initWorker:async function(e){await Promise.all([this.workerStartedPromise,this.sortFormats(e)]),this.repoSyncHelper||(this.repoSyncHelper=new Na(this.repository,this.getWorkerSafeNode,this.getWorkerSafeSegment),this.repoSyncHelper.on("repochange",this.onRepoChange)),await new Promise((e=>{this.workerMsgChannel.once("init.complete",e),this.postMessage("init",ki.extend(!0,{repo:this.repoSyncHelper.getFullRepo(),environment:Ae,bitrate:this.bitrate,bitrateConfig:this.getSetting("bitrateConfig"),baseUrl:this.baseUrl,forceBaseUrl:this.forceBaseUrl,segmentLoaderConfig:{baseUrlLoadVariants:this.baseUrlLoadVariants},segmentDecoderConfig:this.getSetting("segmentDecoderConfig"),containerResolution:this.getContainerResolution()},this.settings)),this.isWorkerReady=!0})),this.getSetting("swCacheEnabled")&&await Jp.getInstance().getInitCompletePromise()},appendWorkerNode:async function(e,t){return new Promise((n=>{this.workerMsgChannel.once("appendNode.complete",n),this.ensureWorkerRepoValid(),this.postMessage("appendNode",{nodeId:e.id,startTimeOffset:t})}))},resetWorker:async function(){return new Promise((e=>{this.workerMsgChannel.once("reset.complete",e),this.postMessage("reset")}))},onWorkerMessage:function(e,t){this.log.info("Main got message: ["+e+"]",t||"")},onContainerResize:function(){this.postMessage("updateContainerResolution",this.getContainerResolution())},addRemoveDocumentListeners:function(e=!1){document[e?"addEventListener":"removeEventListener"]("visibilitychange",this.onVisibilityChange)},addDocumentListeners:function(){this.addRemoveDocumentListeners(!0)},removeDocumentListeners:function(){this.addRemoveDocumentListeners(!1)},onVisibilityChange:async function(){this.getSetting("shouldResetOnVisibilityChange")&&"hidden"===document.visibilityState&&(this.log.info("[onVisibilityChange] Document hidden, resetting engine..."),await this.reset(!0),await this.doRecover(),this.log.info("[onVisibilityChange] Recover complete"))},addRemoveVideoListeners:function(e=!1){if(!this.video)return;const t=e?"on":"off";this.video[t]("updateplaybackindex",this.onVideoUpdatePlaybackIndex),this.video[t]("updateplaybackcurrenttime",this.onVideoUpdatePlaybackCurrentTime),e?this.addErrorListener(this.video):this.removeErrorListener(this.video)},addVideoListeners:function(){this.addRemoveVideoListeners(!0)},removeVideoListeners:function(){this.addRemoveVideoListeners(!1)},onVideoUpdatePlaybackIndex:function(e){this.postMessage("updatePlaybackIndex",e)},onVideoUpdatePlaybackCurrentTime:function(e){this.postMessage("updatePlaybackCurrentTime",e)},onWorkerLog:function(e){this.log.info(e)},onWorkerUpdateBitrate:function(e){this.bitrate=e,this.trigger("bitrateUpdated",this.bitrate)},onWorkerRepresentationChosen:function(e){this.repoSyncHelper.execFuncWhileIgnoringRepoChanges((()=>{this.trigger("representationChosen",e.segId,e.chosenRep)}))},onWorkerRepresentationsChosen:function(e){this.repoSyncHelper.execFuncWhileIgnoringRepoChanges((()=>{this.trigger("representationsChosen",e)}))},onWorkerLoadError:function(e){e.isLast?(this.log.error("Error downloading "+e.url+", no more retries. status code: "+e.status+", attempt #"+e.attempt+", errorMsg: "+e.errorMsg),this.notifyError(82,e.url,e.status,e.attempt,e.errorMsg)):(this.log.warn("Error downloading "+e.url+". status code: "+e.status+", attempt #"+e.attempt+", errorMsg: "+e.errorMsg),this.notifyError(83,e.url,e.status,e.attempt,e.errorMsg))},onWorkerDownloadComplete:function(e){this.trigger("downloadComplete",e.url,e.bps)},onWorkerBytesDownloaded:function(e){this.trigger("bytesDownloaded",e)},onWorkerNodeLoading:function(e){this.trigger("nodeLoading",e)},onWorkerNodeLoadingPausing:function(e){this.trigger("nodeLoadingPausing",e)},onWorkerNodeLoadingComplete:function(e){this.trigger("nodeLoadingComplete",e)},onWorkerVideoFrames:function(e){this.video.pushFrames(e)},onWorkerBuffered:function(e){this.video.onBuffered(e)},onWorkerError:async function(e){this.log.error("[onWorkerError] Caught error (will attempt to recover):",e),await this.doRecover()},onServiceWorkerCacheFull:function(){this.workerMsgChannel.once("forceMemorySweep.complete",(e=>{Jp.getInstance().performCacheSweep(e)})),this.postMessage("forceMemorySweep")},getWorkerSafeNode:function(e){return e&&"function"==typeof e.getWorkerSafeNode&&e.getWorkerSafeNode()},getWorkerSafeSegment:function(e){if(!e._webcodecsChosenFormat)for(let t=0;t<this.formats.length;t++)if(e.hasFormat(this.formats[t].name)){e._webcodecsChosenFormat=this.formats[t];break}return e.getWorkerSafeSegment({filterRepresentations:t=>sn(e)||e._webcodecsChosenFormat&&this.isRepOfChosenFormat(t,e._webcodecsChosenFormat)})},doUpdateWorkerRepo:function(){this.postMessage("updateRepoDiff",this.repoSyncHelper.flushDiff())},scheduleWorkerRepoUpdate:function(){this.updateWorkerRepoScheduled||(this.updateWorkerRepoScheduled=!0,setTimeout((()=>{this.updateWorkerRepoScheduled&&(this.doUpdateWorkerRepo(),this.updateWorkerRepoScheduled=!1)}),0))},onRepoChange:function(){this.isWorkerReady&&this.scheduleWorkerRepoUpdate()},ensureWorkerRepoValid:function(){this.updateWorkerRepoScheduled&&(this.doUpdateWorkerRepo(),this.updateWorkerRepoScheduled=!1)},doRecover:async function(){await new Promise((e=>{"visible"===document.visibilityState&&e();const t=()=>{"visible"===document.visibilityState&&(document.removeEventListener("visibilitychange",t),e())};document.addEventListener("visibilitychange",t)})),this.log.warn("[doRecover] Attempting to recover..."),this.api.exports.currentTime=this.api.exports.currentTime},sortFormats:function(e){return this.mediaCapabilities.sortFormats(this.formats,{isMediaSource:!1,ivd:e.segment}).then((e=>{this.formats=e,this.supportedFormatNames=e.map((function(e){return e.name})),this.log.info("Sorted formats according to decoding capabilities:",this.supportedFormatNames)}))},setOtherEngines:function(e){var t;null===(t=this.video)||void 0===t||t.setOtherEngines(e)},onUpdateFreedBytesTick:function(){let e=this.video.segmentObjectsPlaylist[this.video.currSegIndex];if(!e)return;const t={playlistIndex:e.playlistIndex,bytes:e.freedAllocatedBytes};this.log.debug("Updating freed bytes:",t),this.postMessage("updateFreedBytes",t)},appendNode:async function(e,t=0){if(!(e&&this.repo&&this.repo.nodes&&this.repo.nodes.hasOwnProperty(e)))throw new Error(`[appendNode] Invalid nodeId: ${e}`);const n=this.repo.nodes[e];this.workerInitedPromise||(this.workerInitedPromise=this.initWorker(n)),await this.workerInitedPromise,this.isWorkerReady&&await this.appendWorkerNode(n,t)},reset:async function(e){await this.workerStartedPromise,await this.resetWorker(),await this.video.reset(),e||(this.workerInitedPromise=null)},seek:async function(e,t){this.log.info(`[seek] Seeking to [${e}] @ ${t}`),await this.reset(!0),await this.appendNode(e,t)},getBuffered:function(){return this.video.getBuffered()},videoTech:function(){return"webcodecs"},updateBitrate:function(e){this.bitrate=e,this.postMessage("updateBitrate",e)},updateBaseUrl:function(e){this.baseUrl=e,this.postMessage("updateBaseUrl",e)},setForceBaseUrl:function(e){this.forceBaseUrl=e,this.postMessage("setForceBaseUrl",e)},setBitrateMultiplier:function(e){e*=this.getSetting("bitrateMultiplierMultiplier",1),this.setSetting("bitrateConfig.bitrateMultiplier",e),this.postMessage("setBitrateMultiplier",e)},transformIvd:function(e){return e&&e.representations&&e.representations.length?(sn(e)||(e.representations=e.representations.filter(this.isRepSupported)),e):e},isRepSupported:function(e){return this.supportedFormatNames.indexOf(e.format)>=0},isRepOfChosenFormat:function(e,t){return!(!t||!t.name)&&(e.format===t.name||t.aliases&&t.aliases.indexOf(e.format)>=0)},loadNode:async function(e){let t=this.repository.get(e);t?(await t.resolve(),t.subnodes&&t.subnodes.length&&(t=t.subnodes[0]),this.ensureWorkerRepoValid(),this.postMessage("loadNode",t.id)):this.log.warn("[loadNode] Unable to load unknown node:",e)},monitorDownloads:async function(e){await this.workerStartedPromise,this.postMessage("monitorDownloads",e)},setBaseUrlLoadVariants:function(e){this.baseUrlLoadVariants=e},getNeededFormatNames:function(){return this.supportedFormatNames},ctor:function(e,t,n,i){this._super(t,n,i),this.supportedFormatNames=(this.formats||[]).map((function(e){return e.name})),this.video=new Kp(this.options,this.api,e),this.addVideoListeners(),this.getSetting("swCacheEnabled")&&(Jp.getInstance(this.options),Jp.getInstance().on("cachefull",this.onServiceWorkerCacheFull)),this.workerStartedPromise=new Promise((e=>{var t;new Ip({...this.options,WorkerFactory:{forcePseudoWorker:rf,...null===(t=this.options)||void 0===t?void 0:t.WorkerFactory}}).createWorker("webcodecs",{forcePseudoWorker:this.getSetting("forcePseudoWorker"),WorkerMsgChannel:this.options&&this.options.WorkerMsgChannel||{}}).then((t=>{this.worker=t,this.workerMsgChannel=new Js(this.worker,Ae,this.options),this.addWorkerListeners(),e()}))})),this.mediaCapabilities=new Dp(this.options),Zr.start(this.onUpdateFreedBytesTick,1e3*this.getSetting("updateFreedBytesInterval")),this.addDocumentListeners(),this.defineProperty("repo",(function(){return{nodes:this.repository.nodeMap,segments:this.repository.segmentMap}}))},dispose:function(){this._super.apply(this,arguments),Zr.stop(this.onUpdateFreedBytesTick),this.removeWorkerListeners(),this.removeDocumentListeners(),this.removeVideoListeners(),this.getSetting("swCacheEnabled")&&Jp.getInstance().off("cachefull",this.onServiceWorkerCacheFull),this.repoSyncHelper&&(this.repoSyncHelper.off("repochange",this.onRepoChange),this.repoSyncHelper.dispose()),this.workerMsgChannel&&this.workerMsgChannel.dispose(),this.worker&&(this.disposeWorker(),this.postMessage("terminate"),this.worker=null),this.video&&(this.video.dispose(),this.video=null)}});var sf=ji.extend({name:"EngineFactory",logLevel:"warn",doCreateEngine:function(e,t,n,i){var r=null,o=e&&e.videoTech?e.videoTech:"unknown";switch(o){case"webcodecs":r=new of(this.options,t,n,i,e.formats);break;case"webaudio":r=new Fp(this.options,t,n,i,e.formats);break;case"null":r=new Vp(this.options,t,n,i);break;case"fallback":r=new Hp(this.options,t,n,i);break;case"metamorphosis":{const[o,s]=e.components.map((e=>this.doCreateEngine(e,t,n,i)));r=new Gp(this.options,t,n,i,o,s);break}case"composite":var s=[];e.components.forEach(function(e){s.push(this.doCreateEngine(e,t,n,i))}.bind(this)),r=new bs(this.options,t,n,i,s);break;default:this.log.error('The "'+o+'" engine is not available.'),this.notifyError(11,o)}return r},createEngine:async function(e,t,n){var i=(await us.create(this.options)).detect();return this.log.info("engineTechDetected",i),this.doCreateEngine(i,e,t,n)}}),af=ji.extend({name:"CdnOptimizer",logLevel:"warn",version:"0.0.1",defaults:{unsupportedEngines:[],enableMonitorCdns:!0,numberOfSamplesToMonitor:3,monitorInterval:NaN,testFilePath:"/efu/testCdn.json"},engine:null,cdns:null,api:null,monitoring:!1,monitorTimeoutRef:NaN,_currentCdn:null,_baseUrl:null,updateBaseUrlProtocol:function(e){var t=function(e){return ki.doesUrlIncludeProtocol(e)?e:window.location.protocol+e};if(Array.isArray(e))return e.map(t);var n={};for(var i in e)n[i]=e[i],n[i].baseUrls=n[i].baseUrls.map(t);return n},doesEngineSupportCdnMonitor:function(){return-1===this.getSetting("unsupportedEngines").indexOf(this.engine.videoTech())},isCdnAvailable:function(e){var t=e+this.getSetting("testFilePath");return S.promise((function(e){kr.get(t).then((function(){e(!0)})).catch((function(){e(!1)}))}))},onlyAvailableCdns:function(e){var t={},n=[],i=Object.keys(e);i.forEach(function(i){t[i]=e[i].testUrl?this.isCdnAvailable(e[i].testUrl):S(!0),n.push(t[i])}.bind(this));var r={};return S.all(n).then((function(t){for(var n=0;n<i.length;++n){var o=i[n];t[n]&&(r[o]=e[o])}return r}))},chooseRandomCdn:function(e){return e[Math.floor(Math.random()*e.length)]},chooseFasterCdn:function(){var e,t,n=NaN;for(var i in this.log.debug("CDNs bandwidth data:",this.cdnBandwidthAggregator),this.cdnBandwidthAggregator)t=this.averageArrayValue(this.cdnBandwidthAggregator[i]),(isNaN(n)||t>n)&&(n=t,e=i);return e},averageArrayValue:function(e){for(var t=0,n=0;n<e.length;++n)t+=e[n];return t/e.length},urlToCdn:function(e){for(var t in this.cdns)for(var n=this.cdns[t],i=0;i<n.baseUrls.length;i++)if(e.startsWith(n.baseUrls[i]))return t;return null},getAllBaseUrl:function(e){var t=[];for(var n in e)for(var i=this.cdns[n],r=0;r<i.length;r++)t.push(i[r].baseUrls);return t},normalizeInput:function(e){var t=e;return"string"==typeof e?t=[e]:ki.isPlainObject(e)&&(Object.keys(e).forEach((function(t){"string"==typeof e[t]?e[t]={baseUrls:[e[t]]}:Array.isArray(e[t])&&(e[t]={baseUrls:e[t]})})),t=e),t},startMonitorCdns:function(){this.log.info("Start monitor CDNs."),this.monitoring=!0,this.cdnBandwidthAggregator={},this._currentCdn=this.cdnToMonitor.shift(),this.log.info("Current CDN updated to",this._currentCdn),this._baseUrl=this.cdns[this._currentCdn].baseUrls,this.cdnBandwidthAggregator[this._currentCdn]=[],this.engine.monitorDownloads(!0)},onEngineDownloadComplete:function(e,t){if(this.monitoring){var n=this.urlToCdn(e);null!==n&&this.cdnBandwidthAggregator[n]&&Array.isArray(this.cdnBandwidthAggregator[n])?(this.cdnBandwidthAggregator[n].push(t),n===this._currentCdn&&this.cdnBandwidthAggregator[n].length>=this.getSetting("numberOfSamplesToMonitor")&&this.switchCdn()):this.log.warn("Downloaded url is not from one of the CDNs.")}},switchCdn:function(){if(0===this.cdnToMonitor.length){this.monitoring=!1,this.engine.monitorDownloads(!1);var e=this.chooseFasterCdn();this.log.info("CDN "+e+" was faster and chosen."),e!==this._currentCdn&&(this._currentCdn=e,this._baseUrl=this.cdns[this._currentCdn].baseUrls,this.engine.updateBaseUrl(this._baseUrl)),this.api.trigger("cdnchosen",{cdn:this._currentCdn,baseUrl:this._baseUrl,cdnsBandwidth:this.cdnBandwidthAggregator}),isNaN(this.getSetting("monitorInterval"))||(this.monitorTimeoutRef=setTimeout(this.onMonitorTimeout,1e3*this.getSetting("monitorInterval")),this.log.info("Monitor CDNs again was scheduled to start in "+this.getSetting("monitorInterval")+" seconds."))}else this._currentCdn=this.cdnToMonitor.shift(),this.log.info("Current CDN updated to",this._currentCdn),this._baseUrl=this.cdns[this._currentCdn].baseUrls,this.cdnBandwidthAggregator[this._currentCdn]=[],this.engine.updateBaseUrl(this._baseUrl)},onMonitorTimeout:function(){this.monitorTimeoutRef=NaN,this.cdnToMonitor=this.availableCdns&&this.availableCdns.slice()||Object.keys(this.cdns),this.startMonitorCdns(),this.engine.updateBaseUrl(this._baseUrl)},initCdn:function(e){if(null===this.cdns){e=this.normalizeInput(e),this.cdns=this.updateBaseUrlProtocol(e);var t=Object.keys(this.cdns).filter(function(e){return!this.cdns[e].hasOwnProperty("testUrl")}.bind(this));if(Array.isArray(this.cdns))this._baseUrl=this.cdns;else if(1===Object.keys(this.cdns).length)this._currentCdn=Object.keys(this.cdns)[0],this._baseUrl=this.cdns[this._currentCdn].baseUrls;else if(this.getSetting("enableMonitorCdns")&&this.doesEngineSupportCdnMonitor()){if(0===t.length)throw new Error("[CdnOptimizer] Cannot init baseUrl synchronously - all CDNs has testUrl");t.length===Object.keys(this.cdns).length?(this.cdnToMonitor=Object.keys(this.cdns),this.startMonitorCdns()):(this._currentCdn=t[0],this._baseUrl=this.cdns[this._currentCdn].baseUrls,this.onlyAvailableCdns(this.cdns).then(function(e){this.cdnToMonitor=Object.keys(e),this.cdnToMonitor.length>1&&(this.availableCdns=Object.keys(e),this.startMonitorCdns())}.bind(this)).catch(function(e){this.log.warn("[CdnOptimizer] Failed to get available CDNs ("+e.message+"), not monitoring.")}.bind(this)))}else this._currentCdn=this.chooseRandomCdn(t),this._baseUrl=this.cdns[this._currentCdn].baseUrls,this.log.info("CDN "+this._currentCdn+" was chosen randomly.");this.engine.updateBaseUrl(this._baseUrl),this.doesEngineSupportCdnMonitor()&&!Array.isArray(this.cdns)&&Object.keys(this.cdns).length>1&&this.engine.setBaseUrlLoadVariants(this.getAllBaseUrl(this.cdns))}else this.log.warn("CDN initialization already called.")},ctor:function(e,t){this.engine=e,this.engine.on("downloadComplete",this.onEngineDownloadComplete),this.api=t.exports,this.defineProperty("baseUrl",(function(){return this._baseUrl})),this.defineProperty("cdn",(function(){return this._currentCdn})),this.expose({initCdn:this.initCdn})},dispose:function(){this._super.apply(this,arguments),this.engine.off("downloadComplete",this.onEngineDownloadComplete),isNaN(this.monitorTimeoutRef)||clearTimeout(this.monitorTimeoutRef)}}),lf=ji.extend({name:"DownloadAggregator",logLevel:"warn",version:"0.0.1",defaults:{},engine:null,_totalDownloadSize:0,_totalDownloadedBytes:0,bytesToMB:function(e){return parseFloat((e/1048576).toFixed(3),10)},onEngineBytesDownloaded:function(e){this._totalDownloadedBytes+=e||0;var t=this.bytesToMB(e);t&&(this._totalDownloadSize+=t,this.log.info("Total downloads size:",this._totalDownloadSize,"MB"))},ctor:function(e){this.engine=e,this.engine.on("bytesDownloaded",this.onEngineBytesDownloaded),this.defineProperty("totalDownloadSize",(function(){return this._totalDownloadSize})),this.defineProperty("totalDownloadedBytes",(function(){return this._totalDownloadedBytes}))},dispose:function(){this._super.apply(this,arguments),this.engine.off("bytesDownloaded",this.onEngineBytesDownloaded)}}),cf=ji.extend({name:"StreamQuality",logLevel:"warn",excludeFuncFromAutoDebug:["onWaitingTick","onPlayingTick","calcWindowProps","onWaiting"],defaults:{tickerInterval:.5,treatSeekingAsWaiting:!1,windowDuration:120},core:null,controller:null,playingStartTime:null,waitingStartTime:null,waitingCount:0,_totalPlayingTime:0,_totalWaitingTime:0,windowTotalPlayingTime:0,windowTotalWaitingTime:0,windowDuration:NaN,windowStateEntries:[],calcWindowProps:function(){if(!this.windowDuration||this.windowDuration<0||"number"!=typeof this.windowDuration)return this.windowTotalPlayingTime=this._totalPlayingTime,void(this.windowTotalWaitingTime=this._totalWaitingTime);for(var e,t=0,n=0,i=0,r=0;t<this.windowDuration&&r<this.windowStateEntries.length;)t+=(e=this.windowStateEntries[r]).duration,"playing"===e.state?n+=e.duration:i+=e.duration,r++;t>this.windowDuration&&("playing"===e.state?n-=t-this.windowDuration:i-=t-this.windowDuration),r<this.windowStateEntries.length&&this.windowStateEntries.splice(r),this.windowTotalPlayingTime=n,this.windowTotalWaitingTime=i},onPlayingTick:function(){var e=ki.getTime(),t=(e-this.playingStartTime)/1e3;this._totalPlayingTime+=t,this.playingStartTime=e,this.windowStateEntries[0].duration+=t,this.calcWindowProps()},onWaitingTick:function(){var e=ki.getTime(),t=(e-this.waitingStartTime)/1e3;this._totalWaitingTime+=t,this.waitingStartTime=e,this.windowStateEntries[0].duration+=t,this.calcWindowProps()},onStateChanged:function(e,t){var n=e&&e.name.toLowerCase().replace("state","")||"",i=t&&t.name.toLowerCase().replace("state","")||"",r=ki.getTime(),o=n.indexOf("playing")>=0,s=n.indexOf("waiting")>=0||this.getSetting("treatSeekingAsWaiting")&&n.indexOf("seeking")>=0&&this.windowTotalPlayingTime;o&&this.playingStartTime?(Zr.stop(this.onPlayingTick),this.onPlayingTick(),this.playingStartTime=null):s&&this.waitingStartTime&&(Zr.stop(this.onWaitingTick),this.onWaitingTick(),this.waitingStartTime=null);var a=i.indexOf("playing")>=0,l=i.indexOf("waiting")>=0||this.getSetting("treatSeekingAsWaiting")&&i.indexOf("seeking")>=0&&this.windowTotalPlayingTime;a?(this.playingStartTime=r,this.windowStateEntries.unshift({state:"playing",duration:0}),Zr.start(this.onPlayingTick,1e3*this.getSetting("tickerInterval"))):l&&(this.waitingStartTime=r,this.windowStateEntries.unshift({state:"waiting",duration:0}),Zr.start(this.onWaitingTick,1e3*this.getSetting("tickerInterval"))),this.log.info("[onStateChanged] Switched from '"+n+"' to '"+i+"'. Total Waiting: "+this._totalWaitingTime.toFixed(2)+", Total Playing: "+this._totalPlayingTime.toFixed(2)),this.trigger("stateChanged")},onWaiting:function(){this.waitingCount++,this.log.info(`[onWaiting] Incremented the waiting count: ${this.waitingCount}`)},addControllerListeners:function(){this.controller&&this.controller.on("stateChanged",this.onStateChanged),this.core&&this.core.exports.on("waiting",this.onWaiting)},removeControllerListeners:function(){this.controller&&this.controller.off("stateChanged",this.onStateChanged),this.core&&this.core.exports.off("waiting",this.onWaiting)},ctor:function(e,t){this.core=e,this.controller=t,this.windowDuration=this.getSetting("windowDuration",60),this.addControllerListeners(),this.defineProperty("isWaiting",(function(){return null!==this.waitingStartTime})),this.defineProperty("isPlaying",(function(){return null!==this.playingStartTime})),this.defineProperty("totalPlayingTime",(function(){const e=this.isPlaying?(ki.getTime()-this.playingStartTime)/1e3:0;return this._totalPlayingTime+e})),this.defineProperty("totalWaitingTime",(function(){const e=this.isWaiting?(ki.getTime()-this.waitingStartTime)/1e3:0;return this._totalWaitingTime+e}))},dispose:function(){this.removeControllerListeners(),Zr.stop(this.onPlayingTick),Zr.stop(this.onWaitingTick)}}),uf=ji.extend({name:"PlaybackQuality",logLevel:"warn",excludeFuncFromAutoDebug:[],defaults:{},video:null,ctor:function(e){this.video=e,this.defineProperty("totalVideoFrames",(function(){return this.video.getCurrentVideoTotalFrames()})),this.defineProperty("droppedVideoFrames",(function(){return this.video.getCurrentVideoDroppedFrames()}))},dispose:function(){this._super.apply(this,arguments)}}),df=ji.extend({name:"Framerate",logLevel:"warn",excludeFuncFromAutoDebug:["onIntervalTick","onFrameTick"],defaults:{stopOnVisibilityHidden:!0,framerateInterval:1},prevTickTime:NaN,frameCount:0,fps:60,onIntervalTick:function(){var e=O();this.fps=this.frameCount/((e-this.prevTickTime)/1e3),this.frameCount=0,this.prevTickTime=e,this.log.info("[onIntervalTick] Calculates FPS: "+this.fps.toFixed(0)),this._prevFps!==this.fps&&(this.trigger("fps",this.fps),this._prevFps=this.fps)},onFrameTick:function(){this.frameCount++},startTick:function(){this.frameCount=0,this.prevTickTime=O(),Zr.start(this.onFrameTick,0),Zr.start(this.onIntervalTick,1e3*this.getSetting("framerateInterval"))},stopTick:function(){this.frameCount=0,Zr.stop(this.onFrameTick),Zr.stop(this.onIntervalTick)},onDocumentVisibilityChange:function(){if(this.getSetting("stopOnVisibilityHidden"))switch(document.visibilityState){case"visible":this.startTick();break;case"hidden":this.stopTick()}},addDocumentListeners:function(){document&&document.addEventListener("visibilitychange",this.onDocumentVisibilityChange)},removeDocumentListeners:function(){document&&document.removeEventListener("visibilitychange",this.onDocumentVisibilityChange)},ctor:function(){this.addDocumentListeners(),this.startTick()},dispose:function(){this.removeDocumentListeners(),this.stopTick()}}),hf=ji.extend({name:"QoE",logLevel:"warn",excludeFuncFromAutoDebug:["calcScore","calcStreamQualityScore","calcFpsScore","updateStatus","isUsingLowestRep","isAlertStatus"],defaults:{calcScoreInterval:1,streamQualityWeight:.8,fpsWeight:.2,fpsMathFuncType:"quad",bestFpsMobile:27,bestFpsDesktop:57,waitingMultiplier:1,statusFloors:{excellent:.98,good:.85,fair:.7,poor:0,alert:0},alertStatusCeil:.3,fpsGracePeriod:2},core:null,streamQuality:null,framerate:null,mathFuncFactory:null,fpsMathFuncInstance:null,bestFps:NaN,score:1,streamQualityScore:NaN,fpsScore:NaN,status:"",startTime:NaN,isInFpsGracePeriod:!1,calcStreamQualityScore:function(){var e,t=this.streamQuality.windowTotalWaitingTime,n=this.streamQuality.windowTotalPlayingTime;return 0===t?e=1:t>n?e=0:(e=1-t*this.getSetting("waitingMultiplier")/(n||1),e=ao.clamp(e,0,1)),this.log.info("[calcStreamQualityScore] Calculated stream quality score: "+(100*e).toFixed(0)+"%. Total waiting: "+t+", total playing: "+n),e},calcFpsScore:function(){if(this.isInFpsGracePeriod)return this.isInFpsGracePeriod=O()-this.startTime<=1e3*this.getSetting("fpsGracePeriod"),1;var e=this.framerate.fps,t=this.fpsMathFuncInstance.applyFunc(e);return t=ao.clamp(t,0,1),this.log.info("[calcFpsScore] Calculated FPS score: "+(100*t).toFixed(0)+"%. According to fps: "+e+" / "+this.bestFps),t},calcScore:function(){this.streamQualityScore=this.calcStreamQualityScore(),this.fpsScore=this.calcFpsScore();var e=this.streamQualityScore*this.getSetting("streamQualityWeight")+this.fpsScore*this.getSetting("fpsWeight");e!==this.score&&(this.log.info("[calcScore] Score updated: "+(100*e).toFixed(0)+"%"),this.score=e,this.trigger("qoescore",this.score),this.core.exports.trigger("qoescore",this.score)),this.updateStatus()},isUsingLowestRep:function(){if(!this.core.exports.currentNode||!this.core.exports.currentNode.segment||!this.core.exports.currentNode.segment.chosenRepresentation)return!1;var e=!1,t=this.core.exports.currentNode.segment.chosenRepresentation,n=t&&t.components?Object.keys(t.components).sort().map((function(e){return t.components[e]})):[t],i=this.core.exports.currentNode.segment.subsegments&&this.core.exports.currentNode.segment.subsegments.length?this.core.exports.currentNode.segment.subsegments[this.core.exports.currentNode.segment.currentSubSegmentIndex]:this.core.exports.currentNode.segment;return n.forEach((function(t){if(t&&t.mimeType&&-1!==t.mimeType.indexOf("video")){var n=i.representations.filter((function(e){return!e.altIndex&&e.format===t.format})).map((function(e){return e.bandwidth})).sort((function(e,t){return e-t}));e=n.length&&n[0]===t.bandwidth||!1}})),e&&this.log.info("[isUsingLowestRep] Using lowest video representation:",t),e},isAlertStatus:function(){return this.score<=this.settings.alertStatusCeil&&this.streamQuality.isWaiting&&this.core.exports.currentTime>0&&this.isUsingLowestRep()},updateStatus:function(){var e=this.status,t="",n=this.settings.statusFloors;this.score>=n.excellent?t="excellent":this.score>=n.good?t="good":this.score>=n.fair?t="fair":(t="poor",("alert"===e&&this.score<=this.settings.alertStatusCeil||this.isAlertStatus())&&(t="alert")),t&&e!==t&&(this.log.info("[updateStatus] Status updated: "+t),this.status=t,this.trigger("qoestatus",this.status),this.core.exports.trigger("qoestatus",this.status))},onStreamQualityStateChanged:function(){this.updateStatus()},startTick:function(){Zr.start(this.calcScore,1e3*this.getSetting("calcScoreInterval"))},stopTick:function(){Zr.stop(this.calcScore)},initFpsMathFunc:function(e){this.bestFps=this.getSetting(Ae.isDesktop?"bestFpsDesktop":"bestFpsMobile"),this.fpsMathFuncInstance=this.mathFuncFactory.createWithPoints(e||this.getSetting("fpsMathFuncType"),[{x:0,y:0},{x:this.bestFps,y:1}])},ctor:function(e,t,n,i){this.core=e,this.streamQuality=t,this.framerate=n,this.mathFuncFactory=i,this.startTime=O(),this.isInFpsGracePeriod=this.getSetting("fpsGracePeriod")>0,this.getSetting("fpsWeight")+this.getSetting("streamQualityWeight")!==1&&(this.log.warn("Detected misconfiguration of QoE. Setting streamQualityWeight = 0.8 and fpsWeight = 0.2."),this.setSetting("streamQualityWeight",.8),this.setSetting("fpsWeight",.2)),this.initFpsMathFunc(this.getSetting("fpsMathFuncType")),this.startTick(),this.streamQuality.on("stateChanged",this.onStreamQualityStateChanged),this.defineProperty("scoreGetter",(function(){return this.score})),this.defineProperty("framerateGetter",(function(){return this.framerate.fps})),this.defineProperty("statusGetter",(function(){return this.status})),this.defineProperty("streamQualityScoreGetter",(function(){return this.streamQualityScore})),this.defineProperty("fpsScoreGetter",(function(){return this.fpsScore})),this.defineProperty("streamQualityWindowTotalWaitingTimeGetter",(function(){return this.streamQuality.windowTotalWaitingTime})),this.defineProperty("streamQualityWindowTotalPlayingTimeGetter",(function(){return this.streamQuality.windowTotalPlayingTime})),this.defineProperty("streamQualityTotalWaitingTimeGetter",(function(){return this.streamQuality.totalWaitingTime})),this.defineProperty("streamQualityTotalPlayingTimeGetter",(function(){return this.streamQuality.totalPlayingTime})),this.expose({score:this.exposeProperty("scoreGetter","score"),status:this.exposeProperty("statusGetter","status"),envFps:this.exposeProperty("framerateGetter","envFps"),envFpsScore:this.exposeProperty("fpsScoreGetter","envFpsScore"),streamQualityWindowTotalWaitingTime:this.exposeProperty("streamQualityWindowTotalWaitingTimeGetter","streamQualityWindowTotalWaitingTime"),streamQualityWindowTotalPlayingTime:this.exposeProperty("streamQualityWindowTotalPlayingTimeGetter","streamQualityWindowTotalPlayingTime"),streamQualityTotalWaitingTime:this.exposeProperty("streamQualityTotalWaitingTimeGetter","streamQualityTotalWaitingTime"),streamQualityTotalPlayingTime:this.exposeProperty("streamQualityTotalPlayingTimeGetter","streamQualityTotalPlayingTime"),streamQualityScore:this.exposeProperty("streamQualityScoreGetter","streamQualityScore")})},dispose:function(){this.stopTick(),this.streamQuality&&"function"==typeof this.streamQuality.off&&this.streamQuality.off("stateChanged",this.onStreamQualityStateChanged)}}),pf=ji.extend({name:"BitrateMultiplier",logLevel:"warn",excludeFuncFromAutoDebug:[],defaults:{min:{webcodecs:1.5,null:1.5,fallback:1.5,webaudio:1.5},max:{webcodecs:6,null:6,fallback:6,webaudio:6},initial:{webcodecs:1.5,null:1.5,fallback:1.5,webaudio:1.5},dynamicValueEnabled:!0,mathFuncType:"cubic"},engine:null,qoe:null,mathFuncFactory:null,min:0,max:0,value:0,resolveNumericValueSetting:function(e){if("number"==typeof e)return e;if(!e)return 0;if("function"==typeof e)return this.resolveNumericValueSetting(e());var t=NaN;if("object"==typeof e){var n=[this.engine.videoTech()];0===n[0].indexOf("composite")?n=n[0].substring(9).split(",").map((function(e){return e.replace(/[\(\)]/g,"").trim()})):0===n[0].indexOf("metamorphosis")&&(n=this.engine.engines.map((e=>e.engineStr))),t=Math.max.apply(null,n.map(function(t){var n=NaN;return e&&e.hasOwnProperty(t)?n=e[t]:this.log.warn('[resolveNumericValueSetting] Object missing a "'+t+'" property.'),n}.bind(this)))}return this.resolveNumericValueSetting(t)},initMathFunc:function(e){this.mathFuncInstance=this.mathFuncFactory.createWithPoints(e||this.getSetting("mathFuncType"),[{x:0,y:this.max},{x:1,y:this.min}])},applyBitrateMultiplierValue:function(e){(e=ao.clamp(e,this.min,this.max))&&this.value!==e&&(this.log.info("Setting new bitrate multiplier value: "+e+" in range ["+this.min+", "+this.max+"]"),this.value=e,this.engine.setBitrateMultiplier(e),this.trigger("bitrateMultiplierUpdated",e))},onQoEScoreUpdated:function(e){var t=NaN;this.mathFuncInstance&&"function"==typeof this.mathFuncInstance.applyFunc&&(t=this.mathFuncInstance.applyFunc(e),t=ao.clamp(t,this.min,this.max)),this.applyBitrateMultiplierValue(t)},addQoEListeners:function(){this.qoe&&this.qoe.on("qoescore",this.onQoEScoreUpdated)},removeQoEListeners:function(){this.qoe&&this.qoe.off("qoescore",this.onQoEScoreUpdated)},ctor:function(e,t,n){this.engine=e,this.qoe=t,this.mathFuncFactory=n,this.min=this.resolveNumericValueSetting(this.getSetting("min")),this.max=this.resolveNumericValueSetting(this.getSetting("max")),this.applyBitrateMultiplierValue(this.resolveNumericValueSetting(this.getSetting("initial"))),this.getSetting("dynamicValueEnabled")&&(this.addQoEListeners(),this.initMathFunc(this.getSetting("mathFuncType")))},dispose:function(){this.removeQoEListeners()}}),ff=ki.getObjectProperty(Ae,"os.name","").toLowerCase();function gf(e){return(e/1e6).toFixed(2)+" Mbps"}function mf(e){return"resource"===e.entryType&&e.transferSize>0&&e.encodedBodySize>0&&e.transferSize>e.encodedBodySize&&e.duration>0&&e.responseEnd>e.requestStart}var yf=ji.extend({name:"BitrateGuesstimator",logLevel:"warn",excludeFuncFromAutoDebug:["hasRTEntriesWithNonZeroTransferSize","calcDownlinkBps","calcResourceTimingBps","resolveConnectionTypeBps","resolveUABps","getTimestamp"],defaults:{persistentStorage:{key:"ekoBitrate",ttl:-1},priorities:[["resourceTiming","downlink","persistentValue"],["resourceTiming","downlink"],["resourceTiming","persistentValue","ua"],["resourceTiming","ua","defaultBitrate"],["downlink","persistentValue"],["downlink"],["persistentValue"],["connectionType"],["ua"],["defaultBitrate"]],defaultBitrate:25e5,connectionType:{"slow-2g":5e4,"2g":7e4,"3g":7e5,"4g":35e5,bluetooth:75e4,cellular:75e4,ethernet:35e5,none:0,wifi:25e5,wimax:25e5},ua:{desktop:25e5,ios:25e5,android:25e5}},isNetworkInfoSupported:null,isResourceTimingSupported:null,persistentValue:null,ua:null,hasRTEntriesWithNonZeroTransferSize:function(){return!(!this.isResourceTimingSupported||!I.performance.getEntriesByType("resource").some(mf))},getTimestamp:function(){return Math.round(Date.now()/1e3)},savePersistentValue:function(e){if(this.persistentValue!==e){try{if(!I||!I.localStorage||"function"!=typeof I.localStorage.setItem)return}catch(e){return}var t=this.getTimestamp();this.log.info("[savePersistentValue] Saving persistent value "+gf(e)+" with timestamp "+t),I.localStorage.setItem(this.getSetting("persistentStorage.key"),JSON.stringify({value:e,timestamp:t})),this.persistentValue=e}else this.log.info("[savePersistentValue] Not saving value, as it is the same as the current value in storage.")},loadPersistentValue:function(){try{if(!I||!I.localStorage||"function"!=typeof I.localStorage.getItem)return}catch(e){return}var e=I.localStorage.getItem(this.getSetting("persistentStorage.key"));if(e){var t,n,i=this.getSetting("persistentStorage.ttl");try{return t=JSON.parse(e),n=this.getTimestamp()-t.timestamp,i<0||n<=i?(this.log.info("[loadPersistentValue] A fresh persistent value was found ("+gf(t.value)+"). "+n+" seconds elapsed."),t.value):(this.log.info("[loadPersistentValue] Persistent value found but it expired. "+n+" seconds elapsed."),null)}catch(e){return void this.log.warn("[loadPersistentValue] Error encountered when trying to parse local storage item.",e)}}else this.log.info("[loadPersistentValue] No persistent value found.")},calcResourceTimingBps:function(){if(!this.isResourceTimingSupported||!this.hasRTEntriesWithNonZeroTransferSize())return this.log.info("[calcResourceTimingBps] Returning NaN because resource timing is not supported or there are no valid resource timing entries with non-zero transfer size."),NaN;var e=I.performance.getEntriesByType("resource").filter(mf);return this.log.info("[calcResourceTimingBps] Found "+e.length+" relevant resource timing entries:",e),ao.avg(e.map((function(e){return 8*e.transferSize/((e.responseEnd-e.requestStart)/1e3)})))},calcDownlinkBps:function(){return this.isNetworkInfoSupported&&I.navigator.connection.downlink&&1e6*I.navigator.connection.downlink||NaN},resolveConnectionTypeBps:function(){var e;return this.isNetworkInfoSupported&&(e=I.navigator.connection.effectiveType||I.navigator.connection.type)&&this.getSetting("connectionType",{}).hasOwnProperty(e)?this.getSetting("connectionType."+e):NaN},resolveUABps:function(){return Ae.isDesktop?this.getSetting("ua.desktop"):this.getSetting("ua").hasOwnProperty(ff)?this.getSetting("ua."+ff):NaN},update:function(e){this.savePersistentValue(e)},guesstimate:function(){var e,t={defaultBitrate:this.getSetting("defaultBitrate"),resourceTiming:this.calcResourceTimingBps(),downlink:this.calcDownlinkBps(),connectionType:this.resolveConnectionTypeBps(),persistentValue:this.persistentValue,ua:this.ua},n={defaultBitrate:"Default Bitrate",resourceTiming:"Resource Timing",downlink:"Downlink",connectionType:"Connection Type",persistentValue:"Persistent Value",ua:"User Agent Sniffing"};this.log.info("[guesstimate] Resolved values:\n    Resource Timing    : "+gf(t.resourceTiming)+"\n    Downlink           : "+gf(t.downlink)+"\n    Persistent Value   : "+gf(t.persistentValue)+"\n    Connection Type    : "+gf(t.connectionType)+"\n    UA Sniffing        : "+gf(t.ua)+"\n    Default            : "+gf(t.defaultBitrate));for(var i=this.getSetting("priorities"),r=0;r<i.length;r++){var o=i.find((function(e){return e.every((function(e){return!!t[e]}))}));o?(this.log.info("[guesstimate] "+o.map((function(e){return'"'+n[e]+'"'})).join(" + ")+" available, returning "+(o.length>1?"their average":"its value")),e=ao.avg(o.map((function(e){return t[e]})))):this.log.warn("[guesstimate] Unexpected state - no best guess found.")}return e&&this.savePersistentValue(e),this.log.info("[guesstimate] Returning value: ",gf(e)),e},ctor:function(){this.isNetworkInfoSupported=!!(I&&I.navigator&&I.navigator.connection),this.isResourceTimingSupported=!(!I||!I.performance||"function"!=typeof I.performance.getEntriesByType),this.persistentValue=this.loadPersistentValue(),this.ua=this.resolveUABps()}}),vf=ji.extend({name:"Deprecator",logLevel:"warn",version:"0.0.1",defaults:{logWarningOnlyOnce:!0},playerCtx:null,api:null,origListenersMethods:null,deprecatedEvents:{},warned:{},getNestedObject:function(e){for(var t={},n=t,i=e.split("."),r=i.length,o=0;o<r-1;++o)n[i[o]]={},n=n[i[o]];return t},getInnerObject:function(e,t){for(var n=e,i=t.split("."),r=0;r<i.length-1;++r)n=e[i[r]];return n},getCurrentFunction:function(e){for(var t=this.api,n=e.split("."),i=0;i<n.length;++i)t=t[n[i]];return t},setValue:function(e,t){try{ki.setObjectProperty(this.api,e,t)}catch(e){}},getValue:function(e,t){return ki.getObjectProperty(this.api,e,t)},doLogDeprecationWarning:function(e,t,n,i){this.log.warn("DEPRECATION WARNING: The '"+e+"' "+t+" is being deprecated. Please use the '"+n+"' "+i+" instead.")},doLogDeprecationWarningOnce:function(e,t,n,i){var r=[e,t,n,i].join(":");this.warned[r]||(this.log.warn("DEPRECATION WARNING: The '"+e+"' "+t+" is being deprecated. Please use the '"+n+"' "+i+" instead."),this.warned[r]=!0)},rootKey:function(e){return e.split(".")[0]},lastKey:function(e){var t=e.split(".");return t[t.length-1]},overrideListenersMethods:function(){this.origListenersMethods={on:this.api.on,once:this.api.once,off:this.api.off,trigger:this.api.trigger},this.api.on=this.depOn,this.api.once=this.depOnce,this.api.off=this.depOff,this.api.trigger=this.depTrigger},depOn:function(e,t,n){this.deprecatedEvents.hasOwnProperty(e)?(this.logDeprecationWarning(e,"event",this.deprecatedEvents[e],"event"),this.origListenersMethods.on.call(this.playerCtx,this.deprecatedEvents[e],t,n)):this.origListenersMethods.on.apply(this.playerCtx,arguments)},depOnce:function(e,t,n){this.deprecatedEvents.hasOwnProperty(e)?(this.logDeprecationWarning(e,"event",this.deprecatedEvents[e],"event"),this.origListenersMethods.once.call(this.playerCtx,this.deprecatedEvents[e],t,n)):this.origListenersMethods.once.apply(this.playerCtx,arguments)},depOff:function(e,t,n){this.deprecatedEvents.hasOwnProperty(e)?(this.logDeprecationWarning(e,"event",this.deprecatedEvents[e],"event"),this.origListenersMethods.off.call(this.playerCtx,this.deprecatedEvents[e],t,n)):this.origListenersMethods.off.apply(this.playerCtx,arguments)},depTrigger:function(e){this.deprecatedEvents.hasOwnProperty(e)&&(this.logDeprecationWarning(e,"event",this.deprecatedEvents[e],"event"),arguments[0]=this.deprecatedEvents[e]),this.origListenersMethods.trigger.apply(this.playerCtx,arguments)},createDeprecatedMethodToMethod:function(e,t){return function(){return this.logDeprecationWarning(e,"function",t,"function"),this.getCurrentFunction(t).apply(this.playerCtx,arguments)}.bind(this)},createDeprecatedMethodToSetter:function(e,t){return function(){this.logDeprecationWarning(e,"function",t,"property"),arguments&&1===arguments.length?this.setValue(t,arguments[0]):this.log.error("Cannot set value, too many arguments were given to "+e)}.bind(this)},createDeprecatedMethodToGetter:function(e,t,n){return function(){return this.logDeprecationWarning(e,"function",t,"property"),this.getValue(t,n)}.bind(this)},createDeprecatedProperty:function(e,t,n){n=n||{};var i={enumerable:!0};return i.get=function(){return this.logDeprecationWarning(e,"property",t,"property"),this.getValue(t,n.defaultValue)}.bind(this),n.readonly||(i.set=function(n){this.logDeprecationWarning(e,"property",t,"property"),this.setValue(t,n)}.bind(this)),i},exposeAliasMethod:function(e,t){var n=this.getNestedObject(e);this.getInnerObject(n,e)[this.lastKey(e)]=t;var i=this.rootKey(e);this.api[i]?ki.extend(this.api[i],n[i]):this.api=ki.extend(!0,this.api,n)},exposeAliasProperty:function(e,t){var n=this.getNestedObject(e),i=this.rootKey(e);this.api[i]?ki.extend(this.api[i],n[i]):this.api=ki.extend(!0,this.api,n);var r=this.getInnerObject(this.api,e);Object.defineProperty(r,this.lastKey(e),t)},exposeDeprecatedEvent:function(e){var t=e.replace(".","");this.api.events.hasOwnProperty(t)||(this.api.events[t]=e)},addMethod:function(e,t){if(e&&t&&"string"==typeof e&&"string"==typeof t){var n=this.createDeprecatedMethodToMethod(e,t);this.exposeAliasMethod(e,n)}else this.log.error("Cannot add method, invalid params was given: "+e+", "+t)},addEvent:function(e,t){e&&t&&"string"==typeof e&&"string"==typeof t?(this.deprecatedEvents[e]=t,this.exposeDeprecatedEvent(e)):this.log.error("Cannot add event, invalid params was given: "+e+", "+t)},addSetter:function(e,t){if(e&&t&&"string"==typeof e&&"string"==typeof t){var n=this.createDeprecatedMethodToSetter(e,t);this.exposeAliasMethod(e,n)}else this.log.error("Cannot add setter, invalid params was given: "+e+", "+t)},addGetter:function(e,t){if(e&&t&&"string"==typeof e&&"string"==typeof t){var n=this.createDeprecatedMethodToGetter(e,t);this.exposeAliasMethod(e,n)}else this.log.error("Cannot add event, invalid params was given: "+e+", "+t)},addProperty:function(e,t,n){if(e&&t&&"string"==typeof e&&"string"==typeof t){var i=this.createDeprecatedProperty(e,t,n);this.exposeAliasProperty(e,i)}else this.log.error("Cannot add property, invalid params was given: "+e+", "+t)},ctor:function(e){this.playerCtx=e,this.api=e.exports,this.logDeprecationWarning=this.getSetting("logWarningOnlyOnce")?this.doLogDeprecationWarningOnce:this.doLogDeprecationWarning,this.overrideListenersMethods(),this.expose({addMethod:this.addMethod,addEvent:this.addEvent,addProperty:this.addProperty,addSetter:this.addSetter,addGetter:this.addGetter})},dispose:function(){this._super.apply(this,arguments)}}),bf="android"===ki.getObjectProperty(Ae,"os.name","").toLowerCase(),wf=parseInt(ki.getObjectProperty(Ae,"os.version",0),10),kf=bf&&wf>=8,xf=ji.extend({name:"AndroidPiPManager",logLevel:"warn",excludeFuncFromAutoDebug:["resolveVideoEl"],defaults:{enabled:!0,canvasTimeout:2},core:null,containerEl:null,isInPiPCanvasMode:!1,canvasTimeoutRef:null,prevVidDisplayValue:"",vidEl:null,vidStyleMutationObserver:null,canvasModuleInstance:null,resolveVideoEl:function(){return this.containerEl&&"function"==typeof this.containerEl.querySelector&&this.containerEl.querySelector("video")},enterCanvasMode:function(){this.isInPiPCanvasMode?this.log.info("[enterCanvasMode] Already in PiP canvas mode - returning"):(this.vidEl=this.resolveVideoEl(),this.vidEl&&"none"!==this.vidEl.style.display?(this.canvasModuleInstance=new qp({canvasWidth:this.vidEl.videoWidth,canvasHeight:this.vidEl.videoHeight},this.vidEl.parentNode,function(e,t){this.vidEl&&this.vidEl.videoWidth&&this.vidEl.videoHeight&&e&&e.width&&e.height&&t.drawImage(this.vidEl,0,0,this.vidEl.videoWidth,this.vidEl.videoHeight,0,0,e.width,e.height)}.bind(this)),this.canvasModuleInstance.canvasElement.style.cssText=this.vidEl.style.cssText,this.canvasModuleInstance.startTick(),this.prevVidDisplayValue=this.vidEl.style.display,this.vidEl.style.display="none",this.vidStyleMutationObserver=new MutationObserver(function(){this.vidEl&&this.canvasModuleInstance&&(this.log.info("[enterCanvasMode] Detected video style change, applying same style to canvas element"),this.canvasModuleInstance.canvasElement.style.cssText=this.vidEl.style.cssText,this.canvasModuleInstance.canvasElement.style.display="")}.bind(this)),this.vidStyleMutationObserver.observe(this.vidEl,{attributes:!0,attributeFilter:["style"]}),this.isInPiPCanvasMode=!0,this.canvasTimeoutRef=setTimeout(this.exitCanvasMode,1e3*this.getSetting("canvasTimeout")),this.log.info("[enterCanvasMode] Replaced video with canvas")):this.log.info("[enterCanvasMode] Video is not being displayed - no need to replace it with canvas, returning"))},exitCanvasMode:function(){this.isInPiPCanvasMode?(this.vidStyleMutationObserver&&this.vidStyleMutationObserver.disconnect(),this.vidEl&&(this.vidEl.style.display=this.prevVidDisplayValue),this.canvasModuleInstance&&this.canvasModuleInstance.dispose(),clearTimeout(this.canvasTimeoutRef),this.vidStyleMutationObserver=null,this.canvasTimeoutRef=null,this.prevVidDisplayValue="",this.canvasModuleInstance=null,this.vidEl=null,this.isInPiPCanvasMode=!1,this.log.info("[exitCanvasMode] Removed canvas and restored video")):this.log.info("[exitCanvasMode] Not in PiP canvas mode - returning")},onFullscreenChange:function(e){e?this.enterCanvasMode():this.exitCanvasMode()},addCoreListeners:function(){this.core&&this.core.on(this.core.events.fullscreenchange,this.onFullscreenChange)},removeCoreListeners:function(){this.core&&this.core.off(this.core.events.fullscreenchange,this.onFullscreenChange)},ctor:function(e,t){kf?this.getSetting("enabled")?(this.log.info("AndroidPiPManager is enabled and env supports PiP - initializing"),this.core=e,this.containerEl=t,this.addCoreListeners()):this.log.info("Android PiP manager is disabled - doing nothing"):this.log.info("Current environment does not support picture-in-picture - doing nothing")},dispose:function(){this._super.apply(this,arguments),this.removeCoreListeners()}}),Sf="ios"===ki.getObjectProperty(Ae,"os.name","").toLowerCase();const Cf=parseFloat(ki.getObjectProperty(Ae,"os.version","0.0.1").split(".")[0]);var _f=ji.extend({name:"SilentiOSManager",logLevel:"warn",excludeFuncFromAutoDebug:[],defaults:{enabled:!0,disableAutoResumeOnVisibilityChange:!0,hlsUrl:"https://video.eko.com/s/player/iosringer/silence.m3u8"},audio:null,initAudio:function(){this.disposeAudio(),this.audio=new window.Audio,this.audio.setAttribute("preload",""),this.audio.setAttribute("loop",""),this.audio.src=this.getSetting("hlsUrl"),this.audio.addEventListener("playing",this.onAudioPlaying)},disposeAudio:function(){if(this.audio){try{this.audio.pause(),this.audio.removeEventListener("playing",this.onAudioPlaying),Cf<17&&(this.audio.src="",this.audio.load())}catch(e){this.log.warn("Error disposing audio:",e)}this.audio=null}},onAudioPlaying:function(){this.removeGestureListeners()},onUserGesture:async function(){if(this.audio)try{await this.audio.play()}catch(e){this.log.warn("Error playing audio:",e)}},addGestureListeners:function(){document.addEventListener("touchend",this.onUserGesture,!0)},removeGestureListeners:function(){document.removeEventListener("touchend",this.onUserGesture,!0)},onDocumentVisibilityChange:function(){"visible"===document.visibilityState?(this.initAudio(),this.addGestureListeners()):"hidden"===document.visibilityState&&(this.removeGestureListeners(),this.disposeAudio())},addDocumentVisibilityListeners:function(){document.addEventListener("visibilitychange",this.onDocumentVisibilityChange,!0)},removeDocumentVisibilityListeners:function(){document.removeEventListener("visibilitychange",this.onDocumentVisibilityChange,!0)},ctor:function(e){var t;Sf?this.getSetting("enabled")?(this.log.info("SilentiOSManager is enabled and we're running on an iOS device - initializing"),null!==(t=window.navigator)&&void 0!==t&&t.audioSession&&(this.log.info("Audio session type set to playback to avoid muted audio"),window.navigator.audioSession.type="playback"),this.initAudio(),this.addGestureListeners(),this.addDocumentVisibilityListeners(),this.getSetting("disableAutoResumeOnVisibilityChange")&&e&&"function"==typeof e.setSetting&&e.setSetting("autoResumeOnVisibilityChange",!1)):this.log.info("SilentiOSManager is disabled - doing nothing"):this.log.info("Current environment is not an iOS device - doing nothing")},dispose:function(){this._super.apply(this,arguments),this.removeGestureListeners(),this.removeDocumentVisibilityListeners(),this.disposeAudio()}});function Ef(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var Tf=(()=>"function"==typeof Symbol&&Symbol.observable||"@@observable")(),Pf=()=>Math.random().toString(36).substring(7).split("").join("."),If={INIT:`@@redux/INIT${Pf()}`,REPLACE:`@@redux/REPLACE${Pf()}`};function Af(e,t,n){if("function"!=typeof e)throw new Error(Ef(2));if("function"==typeof t&&"function"==typeof n||"function"==typeof n&&"function"==typeof arguments[3])throw new Error(Ef(0));if("function"==typeof t&&void 0===n&&(n=t,t=void 0),void 0!==n){if("function"!=typeof n)throw new Error(Ef(1));return n(Af)(e,t)}let i=e,r=t,o=new Map,s=o,a=0,l=!1;function c(){s===o&&(s=new Map,o.forEach(((e,t)=>{s.set(t,e)})))}function u(){if(l)throw new Error(Ef(3));return r}function d(e){if("function"!=typeof e)throw new Error(Ef(4));if(l)throw new Error(Ef(5));let t=!0;c();const n=a++;return s.set(n,e),function(){if(t){if(l)throw new Error(Ef(6));t=!1,c(),s.delete(n),o=null}}}function h(e){if(!function(e){if("object"!=typeof e||null===e)return!1;let t=e;for(;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||null===Object.getPrototypeOf(e)}(e))throw new Error(Ef(7));if(void 0===e.type)throw new Error(Ef(8));if("string"!=typeof e.type)throw new Error(Ef(17));if(l)throw new Error(Ef(9));try{l=!0,r=i(r,e)}finally{l=!1}return(o=s).forEach((e=>{e()})),e}return h({type:If.INIT}),{dispatch:h,subscribe:d,getState:u,replaceReducer:function(e){if("function"!=typeof e)throw new Error(Ef(10));i=e,h({type:If.REPLACE})},[Tf]:function(){const e=d;return{subscribe(t){if("object"!=typeof t||null===t)throw new Error(Ef(11));function n(){t.next&&t.next(u())}return n(),{unsubscribe:e(n)}},[Tf](){return this}}}}}function Of(...e){return 0===e.length?e=>e:1===e.length?e[0]:e.reduce(((e,t)=>(...n)=>e(t(...n))))}var Lf,Nf,Rf,Df=({dispatch:e,getState:t})=>n=>i=>"function"==typeof i?i(e,t,void 0):n(i),Mf={};function Ff(){if(Nf)return Lf;Nf=1;var e,t=Object.defineProperty,n=Object.getOwnPropertyDescriptor,i=Object.getOwnPropertyNames,r=Object.prototype.hasOwnProperty,o={};function s(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}((e,n)=>{for(var i in n)t(e,i,{get:n[i],enumerable:!0})})(o,{__DO_NOT_USE__ActionTypes:()=>c,applyMiddleware:()=>y,bindActionCreators:()=>g,combineReducers:()=>p,compose:()=>m,createStore:()=>d,isAction:()=>v,isPlainObject:()=>u,legacy_createStore:()=>h}),e=o,Lf=((e,o,s,a)=>{if(o&&"object"==typeof o||"function"==typeof o)for(let s of i(o))r.call(e,s)||void 0===s||t(e,s,{get:()=>o[s],enumerable:!(a=n(o,s))||a.enumerable});return e})(t({},"__esModule",{value:!0}),e);var a=(()=>"function"==typeof Symbol&&Symbol.observable||"@@observable")(),l=()=>Math.random().toString(36).substring(7).split("").join("."),c={INIT:`@@redux/INIT${l()}`,REPLACE:`@@redux/REPLACE${l()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${l()}`};function u(e){if("object"!=typeof e||null===e)return!1;let t=e;for(;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||null===Object.getPrototypeOf(e)}function d(e,t,n){if("function"!=typeof e)throw new Error(s(2));if("function"==typeof t&&"function"==typeof n||"function"==typeof n&&"function"==typeof arguments[3])throw new Error(s(0));if("function"==typeof t&&void 0===n&&(n=t,t=void 0),void 0!==n){if("function"!=typeof n)throw new Error(s(1));return n(d)(e,t)}let i=e,r=t,o=new Map,l=o,h=0,p=!1;function f(){l===o&&(l=new Map,o.forEach(((e,t)=>{l.set(t,e)})))}function g(){if(p)throw new Error(s(3));return r}function m(e){if("function"!=typeof e)throw new Error(s(4));if(p)throw new Error(s(5));let t=!0;f();const n=h++;return l.set(n,e),function(){if(t){if(p)throw new Error(s(6));t=!1,f(),l.delete(n),o=null}}}function y(e){if(!u(e))throw new Error(s(7));if(void 0===e.type)throw new Error(s(8));if("string"!=typeof e.type)throw new Error(s(17));if(p)throw new Error(s(9));try{p=!0,r=i(r,e)}finally{p=!1}return(o=l).forEach((e=>{e()})),e}return y({type:c.INIT}),{dispatch:y,subscribe:m,getState:g,replaceReducer:function(e){if("function"!=typeof e)throw new Error(s(10));i=e,y({type:c.REPLACE})},[a]:function(){const e=m;return{subscribe(t){if("object"!=typeof t||null===t)throw new Error(s(11));function n(){t.next&&t.next(g())}return n(),{unsubscribe:e(n)}},[a](){return this}}}}}function h(e,t,n){return d(e,t,n)}function p(e){const t=Object.keys(e),n={};for(let i=0;i<t.length;i++){const r=t[i];"function"==typeof e[r]&&(n[r]=e[r])}const i=Object.keys(n);let r;try{!function(e){Object.keys(e).forEach((t=>{const n=e[t];if(void 0===n(void 0,{type:c.INIT}))throw new Error(s(12));if(void 0===n(void 0,{type:c.PROBE_UNKNOWN_ACTION()}))throw new Error(s(13))}))}(n)}catch(e){r=e}return function(e={},t){if(r)throw r;let o=!1;const a={};for(let r=0;r<i.length;r++){const l=i[r],c=e[l],u=(0,n[l])(c,t);if(void 0===u)throw new Error(s(14));a[l]=u,o=o||u!==c}return o=o||i.length!==Object.keys(e).length,o?a:e}}function f(e,t){return function(...n){return t(e.apply(this,n))}}function g(e,t){if("function"==typeof e)return f(e,t);if("object"!=typeof e||null===e)throw new Error(s(16));const n={};for(const i in e){const r=e[i];"function"==typeof r&&(n[i]=f(r,t))}return n}function m(...e){return 0===e.length?e=>e:1===e.length?e[0]:e.reduce(((e,t)=>(...n)=>e(t(...n))))}function y(...e){return t=>(n,i)=>{const r=t(n,i);let o=()=>{throw new Error(s(15))};const a={getState:r.getState,dispatch:(e,...t)=>o(e,...t)},l=e.map((e=>e(a)));return o=m(...l)(r.dispatch),{...r,dispatch:o}}}function v(e){return u(e)&&"type"in e&&"string"==typeof e.type}return Lf}var Bf=function(){if(Rf)return Mf;Rf=1,Mf.__esModule=!0,Mf.createDynamicMiddlewares=Mf.resetMiddlewares=Mf.removeMiddleware=Mf.addMiddleware=void 0;var e=Ff(),t=function(){var t=[],n=[],i=void 0;return{enhancer:function(t){return i=t,function(t){return function(i){return e.compose.apply(void 0,n)(t)(i)}}},addMiddleware:function(){for(var e,r,o=arguments.length,s=Array(o),a=0;a<o;a++)s[a]=arguments[a];(e=n).push.apply(e,s.map((function(e){return e(i)}))),(r=t).push.apply(r,s)},removeMiddleware:function(e){var i=t.findIndex((function(t){return t===e}));-1!==i?(t=t.filter((function(e,t){return t!==i})),n=n.filter((function(e,t){return t!==i}))):console.error("Middleware does not exist!",e)},resetMiddlewares:function(){n=[],t=[]}}},n=t();Mf.default=n.enhancer;var i=n.removeMiddleware,r=n.resetMiddlewares;return Mf.addMiddleware=n.addMiddleware,Mf.removeMiddleware=i,Mf.resetMiddlewares=r,Mf.createDynamicMiddlewares=t,Mf}(),Uf=r(Bf),jf=Object.freeze({PLAYER_VOLUME_CHANGE:"PLAYER_VOLUME_CHANGE",PLAYER_SEEK_START:"PLAYER_SEEK_START",PLAYER_SEEK_END:"PLAYER_SEEK_END",PLAYER_PLAYING:"PLAYER_PLAYING",PLAYER_PAUSE:"PLAYER_PAUSE",PLAYER_PAUSE_STATE_CHANGE:"PLAYER_PAUSE_STATE_CHANGE",PLAYER_WAITING:"PLAYER_WAITING",PLAYER_ENDED:"PLAYER_ENDED",PLAYER_PLAYLIST_RESET:"PLAYER_PLAYLIST_RESET",PLAYER_ENTER_FULLSCREEN:"PLAYER_ENTER_FULLSCREEN",PLAYER_EXIT_FULLSCREEN:"PLAYER_EXIT_FULLSCREEN",PLAYER_CHANNEL_SWITCHED:"PLAYER_CHANNEL_SWITCHED",PLAYER_NODE_START:"PLAYER_NODE_START",PLAYER_TIME_UPDATE:"PLAYER_TIME_UPDATE",PLAYER_DIMENSIONS:"PLAYER_DIMENSIONS",PLAYER_AUDIO_LOCKED_CHANGE:"PLAYER_AUDIO_LOCKED_CHANGE"});const zf=function(){return{type:jf.PLAYER_SEEK_END}};var Vf=ji.extend({name:"PlayerReduxBridge",logLevel:"warn",excludeFuncFromAutoDebug:["onTimeUpdate"],defaults:{timeupdateEnabled:!0,dimensionsInterval:.25},api:null,videoScaler:null,controller:null,reduxStore:null,dispatch:null,dimensionsThrottler:null,addRemoveAPIListeners:function(e){this.api&&(this.api[e="add"===e?"on":"off"]("volumechange",this.onVolumeChange),this.api[e]("seeking",this.onSeeking),this.api[e]("seeked",this.onSeeked),this.api[e]("error",this.onError),this.api[e]("waiting",this.onWaiting),this.api[e]("playing",this.onPlaying),this.api[e]("pause",this.onPause),this.api[e]("ended",this.onEnded),this.api[e]("fullscreenchange",this.onFullscreenChange),this.api[e]("audiolockedchange",this.onAudioLockedChange),this.api[e]("playlistreset",this.onPlaylistReset),this.api[e]("nodestart",this.onNodeStart),this.api[e]("switched",this.onChannelSwitched),this.getSetting("timeupdateEnabled")&&this.api[e]("timeupdate",this.onTimeUpdate))},addAPIListeners:function(){this.addRemoveAPIListeners("add")},removeAPIListeners:function(){this.addRemoveAPIListeners("remove")},addRemoveVideoScalerListeners:function(e){this.videoScaler&&this.videoScaler[e="add"===e?"on":"off"]("videoscaled",this.onVideoScaled)},addVideoScalerListeners:function(){this.addRemoveVideoScalerListeners("add")},removeVideoScalerListeners:function(){this.addRemoveVideoScalerListeners("remove")},addRemoveControllerListeners:function(e){this.controller&&this.controller[e="add"===e?"on":"off"]("pausestatechange",this.onPauseStateChange)},addControllerListeners:function(){this.addRemoveControllerListeners("add")},removeControllerListeners:function(){this.addRemoveControllerListeners("remove")},onPauseStateChange:function(e){this.dispatch(function(e){return{type:jf.PLAYER_PAUSE_STATE_CHANGE,isPaused:!!e}}(e))},onVideoScaled:function(e){this.dimensionsThrottler.push(e)},onPlaying:function(){this.dispatch({type:jf.PLAYER_PLAYING})},onPause:function(){this.dispatch({type:jf.PLAYER_PAUSE})},onEnded:function(){this.dispatch({type:jf.PLAYER_ENDED})},onWaiting:function(){this.dispatch({type:jf.PLAYER_WAITING})},onPlaylistReset:function(){this.dispatch({type:jf.PLAYER_PLAYLIST_RESET})},onNodeStart:function(){var e=this.api.currentNode||{};this.dispatch({type:jf.PLAYER_NODE_START,currentNodeId:this.api.currentNodeId,currentVideoTrackIndex:e.currentVideoTrackIndex||0,currentAudioTrackIndex:e.currentAudioTrackIndex||0,isCurrentNodeParallel:!!e.isParallel}),this.settings.timeupdateEnabled&&this.onTimeUpdate()},onChannelSwitched:function(){var e=this.api.currentNode||{};this.dispatch({type:jf.PLAYER_CHANNEL_SWITCHED,currentVideoTrackIndex:e.currentVideoTrackIndex||0,currentAudioTrackIndex:e.currentAudioTrackIndex||0})},onVolumeChange:function(){this.dispatch({type:jf.PLAYER_VOLUME_CHANGE,volume:this.api.volume,muted:this.api.muted})},onSeeking:function(){this.dispatch({type:jf.PLAYER_SEEK_START})},onTimeUpdate:function(){var e;this.dispatch({type:jf.PLAYER_TIME_UPDATE,currentTime:(e={currentTime:this.api.currentTime,currentNodeTime:this.api.currentNodeTime,currentNodeDuration:this.api.currentNodeDuration}).currentTime,currentNodeTime:e.currentNodeTime,currentNodeDuration:e.currentNodeDuration,currentNodeProgress:ao.clamp(e.currentNodeTime/e.currentNodeDuration,0,1),currentNodeRemainingTime:Math.max(e.currentNodeDuration-e.currentNodeTime,0)})},onSeeked:function(){this.dispatch(zf()),this.onNodeStart()},onError:function(e){e instanceof Li&&25===e.id&&this.dispatch(zf())},onFullscreenChange:function(e){this.dispatch(e?{type:jf.PLAYER_ENTER_FULLSCREEN}:{type:jf.PLAYER_EXIT_FULLSCREEN})},onAudioLockedChange:function(){this.dispatch({type:jf.PLAYER_AUDIO_LOCKED_CHANGE,isAudioLocked:this.api.isAudioLocked})},dispatchDimensions:function(e){var t;e&&e.length&&(t=e[e.length-1]),this.dispatch(function(e,t,n){return e=e||0,t=t||0,n=n||new ko,{type:jf.PLAYER_DIMENSIONS,containerWidth:e,containerHeight:t,videoLeftPercent:n.leftPercent,videoTopPercent:n.topPercent,videoWidthPercent:n.widthPercent,videoHeightPercent:n.heightPercent}}(this.api.containerWidth,this.api.containerHeight,t))},ctor:function(e,t,n,i){this.api=e.exports,this.videoScaler=t,this.controller=n,this.reduxStore=i,this.dispatch=i.dispatch,this.dimensionsThrottler=Zr.createThrottler(this.dispatchDimensions,1e3*this.getSetting("dimensionsInterval")),this.addAPIListeners(),this.addVideoScalerListeners(),this.addControllerListeners(),setTimeout(this.onVolumeChange.bind(this),0)},dispose:function(){this._super.apply(this,arguments),this.removeAPIListeners(),this.removeVideoScalerListeners(),this.removeControllerListeners(),this.dimensionsThrottler&&this.dimensionsThrottler.dispose()}}),Wf={volume:1,muted:!1,isPlaying:!1,isPaused:!0,isSeeking:!1,isWaiting:!1,isEnded:!1,isFullscreen:!1,isAudioLocked:!0,currentNodeId:"",currentVideoTrackIndex:0,currentAudioTrackIndex:0,isCurrentNodeParallel:!1,currentNodeTime:0,currentNodeDuration:0,currentNodeProgress:0,currentNodeRemainingTime:0,containerWidth:0,containerHeight:0,videoLeftPercent:0,videoTopPercent:0,videoWidthPercent:100,videoHeightPercent:100,currentChannel:0,isCurrentNodeRts:!1};function Hf(e,t){if(!jf.hasOwnProperty(t.type))return e||Wf;var n=Object.assign({},e);switch(t.type){case jf.PLAYER_VOLUME_CHANGE:n.volume=t.volume,n.muted=t.muted;break;case jf.PLAYER_SEEK_START:n.isSeeking=!0;break;case jf.PLAYER_SEEK_END:n.isSeeking=!1,n.isWaiting=!1;break;case jf.PLAYER_PLAYING:n.isEnded=!1,n.isPaused=!1,n.isPlaying=!0,n.isWaiting=!1;break;case jf.PLAYER_PAUSE:n.isPaused=!0,n.isPlaying=!1;break;case jf.PLAYER_PAUSE_STATE_CHANGE:n.isPaused=t.isPaused;break;case jf.PLAYER_WAITING:n.isWaiting=!0;break;case jf.PLAYER_ENDED:n.isEnded=!0,n.isPlaying=!1,n.isPaused=!0,n.isWaiting=!1;break;case jf.PLAYER_PLAYLIST_RESET:n.isPlaying=!1,n.isPaused=!0,n.isEnded=!0,n.isWaiting=!1,n.isSeeking=!1,n.currentNodeId="",n.currentVideoTrackIndex=0,n.currentAudioTrackIndex=0,n.isCurrentNodeParallel=!1,n.currentChannel=0,n.isCurrentNodeRts=!1;break;case jf.PLAYER_NODE_START:n.currentNodeId=t.currentNodeId,n.currentVideoTrackIndex=t.currentVideoTrackIndex,n.currentAudioTrackIndex=t.currentAudioTrackIndex,n.isCurrentNodeParallel=t.isCurrentNodeParallel,n.currentChannel=t.currentVideoTrackIndex,n.isCurrentNodeRts=t.isCurrentNodeParallel;break;case jf.PLAYER_CHANNEL_SWITCHED:n.currentVideoTrackIndex=t.currentVideoTrackIndex,n.currentAudioTrackIndex=t.currentAudioTrackIndex,n.currentChannel=t.currentVideoTrackIndex;break;case jf.PLAYER_ENTER_FULLSCREEN:n.isFullscreen=!0;break;case jf.PLAYER_EXIT_FULLSCREEN:n.isFullscreen=!1;break;case jf.PLAYER_AUDIO_LOCKED_CHANGE:n.isAudioLocked=t.isAudioLocked;break;case jf.PLAYER_TIME_UPDATE:n.currentTime=t.currentTime,n.currentNodeDuration=t.currentNodeDuration,n.currentNodeProgress=t.currentNodeProgress,n.currentNodeTime=t.currentNodeTime,n.currentNodeRemainingTime=t.currentNodeRemainingTime;break;case jf.PLAYER_DIMENSIONS:n.containerWidth=t.containerWidth,n.containerHeight=t.containerHeight,n.videoLeftPercent=t.videoLeftPercent,n.videoTopPercent=t.videoTopPercent,n.videoWidthPercent=t.videoWidthPercent,n.videoHeightPercent=t.videoHeightPercent}return n}var $f=Object.assign({},Ae);function Gf(e,t){return e||$f}var qf="@@chameleon/ADD_REDUCER"+Math.random().toString(36).substring(7).split("").join("."),Yf=ji.extend({name:"ReduxManager",logLevel:"warn",defaults:{devToolsEnabled:!0,devToolsOptions:{actionsDenylist:["DECISION_TIME_UPDATE","PLAYER_TIME_UPDATE"]}},store:null,reducersMap:null,playerReduxBridge:null,registerReducer:function(e,t){"function"==typeof t&&"string"==typeof e?this.reducersMap[e]!==t&&(this.reducersMap.hasOwnProperty(e)&&this.log.warn("[registerReducer] Reducer '"+e+"' already exists. Overriding."),this.reducersMap[e]=t,this.store.dispatch({type:qf,name:e})):this.log.error("[registerReducer] Invalid arguments:",e,t)},mainReducer:function(e,t){e=e||{};var n={};return Object.keys(this.reducersMap).forEach((function(i){n[i]=(0,this.reducersMap[i])(e[i],t)}),this),n},ctor:function(e,t,n){this.reducersMap={};var i=this.getSetting("devToolsEnabled")&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__(this.getSetting("devToolsOptions"))||Of;this.store=Af(this.mainReducer,i(function(...e){return t=>(n,i)=>{const r=t(n,i);let o=()=>{throw new Error(Ef(15))};const s={getState:r.getState,dispatch:(e,...t)=>o(e,...t)},a=e.map((e=>e(s)));return o=Of(...a)(r.dispatch),{...r,dispatch:o}}}(Df,Uf))),this.registerReducer("player",Hf),this.registerReducer("environment",Gf),this.playerReduxBridge=new Vf(this.options,e,t,n,this.store),this.addErrorListener(this.playerReduxBridge),this.defineProperty("reduxStore",(function(){return this.store})),this.expose({reduxStore:this.exposeProperty("reduxStore"),addReduxMiddleware:Bf.addMiddleware})}}),Kf={corruptedVideoFrames:0,creationTime:0,totalVideoFrames:0,droppedVideoFrames:0};function Xf(e,{trustReadyStateHaveEnoughData:t=!0}={}){return e instanceof HTMLImageElement?e.complete?1/0:0:e&&t&&4===e.readyState&&e.duration||e&&e.buffered&&e.buffered.length&&e.buffered.end(e.buffered.length-1)||e&&3===e.readyState&&Math.min(e.duration,e.currentTime+1)||0}var Qf={getTotalBuffered:Xf,getReadyStateString:function(e){var t;switch(e&&e.readyState){case 0:t="HAVE_NOTHING";break;case 1:t="HAVE_METADATA";break;case 2:t="HAVE_CURRENT_DATA";break;case 3:t="HAVE_FUTURE_DATA";break;case 4:t="HAVE_ENOUGH_DATA";break;default:t=""}return t},getVideoPlaybackQuality:function(e){var t=Kf;if(e&&"function"==typeof e.getVideoPlaybackQuality)try{t=e.getVideoPlaybackQuality()}catch(e){}return t},isStalled:function(e){const t=Xf(e,{trustReadyStateHaveEnoughData:!1});return 0===t||isNaN(e.duration)||t<e.duration&&e.currentTime>=t||e.readyState<=3},HAVE_NOTHING:0,HAVE_METADATA:1,HAVE_CURRENT_DATA:2,HAVE_FUTURE_DATA:3,HAVE_ENOUGH_DATA:4},Zf="main.1104225",Jf=ji.extend({name:"PlayerPerformance",logLevel:"warn",excludeFuncFromAutoDebug:["onCuepointTimeout","onStartedPlaying"],defaults:{cuepoints:[1,5,10,15,20,25,30,45,60,90,120]},core:null,onCuepointTimeout:function(e){this.log.info(`[onCuepointTimeout] Triggering the "playerperformance" event after ${e} seconds`),this.core.exports.trigger("playerperformance",{cuepoint:e})},onStartedPlaying:function(){this.log.info('[onStartedPlaying] Playback started, setting up cuepoint timeouts to trigger the "playerperformance" event'),this.getSetting("cuepoints",[]).forEach((e=>{setTimeout(this.onCuepointTimeout.bind(this,e),1e3*e)}))},addPerformanceListeners:function(){this.addRemovePerformanceListeners(!0)},removePerformanceListeners:function(){this.addRemovePerformanceListeners(!1)},addRemovePerformanceListeners:function(e){this.core.exports[e?"once":"off"]("playing",this.onStartedPlaying)},ctor:function(e){this.core=e,this.addPerformanceListeners()},dispose:function(){this.removePerformanceListeners()}});class eg{constructor(){}}var tg=ji.extend({name:"Core",logLevel:"warn",defaults:{containerStyle:Xi.getDefault("containerStyle")},el:null,container:null,interludeVideoContainer:null,videoWrapperElement:null,pluginCtx:null,loggerFactory:me,environment:Ae,events:{timeupdate:"timeupdate",durationchange:"durationchange",volumechange:"volumechange",audiolockedchange:"audiolockedchange",loadeddata:"loadeddata",playing:"playing",waiting:"waiting",canplay:"canplay",requiresuseraction:"requiresuseraction",play:"play",pause:"pause",ended:"ended",fullscreenchange:"fullscreenchange",ratechange:"ratechange",switched:"switched",switching:"switching",seeking:"seeking",seeked:"seeked",nodestart:"nodestart",nodeend:"nodeend",playlistcritical:"playlistcritical",nodecritical:"nodecritical",error:"error",warning:"warning",playlistreset:"playlistreset",playlistpush:"playlistpush",plugininit:"plugininit",containerresize:"containerresize",resize:"resize",qoescore:"qoescore",qoestatus:"qoestatus"},exportEventEmitterMethods:function(){this.expose({on:this.on,once:this.once,off:this.off,trigger:this.trigger})},deprecateOldAPIs:function(e){e.addEvent("playlist.push","playlistpush"),e.addEvent("playlist.reset","playlistreset"),e.addEvent("playlist.critical","playlistcritical"),e.addEvent("qoe.score","qoescore"),e.addEvent("qoe.status","qoestatus")},getContainer:function(e){var t=null;if(e)if("string"==typeof e){try{t=document.querySelector(e)}catch(e){}t||(this.log.error("Could not successfully resolve selector: "+e),this.notifyError(72,e))}else t=e;else this.log.error("No video container element (or selector) provided."),this.notifyError(26);return t&&"function"==typeof t.appendChild||(this.log.error("Could not resolve container DOM element."),this.notifyError(85,e)),t},initContainer:function(){if(!this.container||!this.container.style)return this.log.error("Could not initialize container."),void this.notifyError(84,this.container);var e=this.getSetting("containerStyle",null);for(var t in e)this.container.style[t]=e[t];this.interludeVideoContainer=document.createElement("div"),this.interludeVideoContainer.setAttribute("style","width: 100%; height: 100%; position: relative; overflow: hidden;"),this.interludeVideoContainer.setAttribute("class","interludevideo"),this.videoWrapperElement=document.createElement("div"),this.videoWrapperElement.setAttribute("style","width: 100%; height: 100%; position: relative; overflow: hidden;"),this.videoProxyElement=document.createElement("div"),this.videoProxyElement.setAttribute("style","width: 100%; height: 100%; position: relative; overflow: hidden;"),this.interludeVideoContainer.appendChild(this.videoWrapperElement),this.videoWrapperElement.appendChild(this.videoProxyElement),this.container.appendChild(this.interludeVideoContainer)},getVersion:function(){return Zf},ctor:function(e){this.el=e,this.expose({__doAsyncInit:this.__doAsyncInit})},__doAsyncInit:async function(){delete this.exports.__doAsyncInit,this.options=Xi.processOptions(this.options),this.exposedOptions=Xi.createReadonlyOptions(this.options),this.settings=ki.extend(!0,{},this.settings,this.defaults,this.options[this.name]||{}),this.options.playerInstanceId=this.options.playerInstanceId||ki.uuid(),this.exportEventEmitterMethods(),this.exports.events=this.events,this.container=this.getContainer(this.el),this.initContainer();var e=new Ji(this.options),t=new jr(this.options,this),n=await new sf(this.options).createEngine(this.videoProxyElement,this,t),i=new vo(this.options,t),r=new bo(this.options,this,this.container),o=new yo(this.options,this,t,i),s=new af(this.options,n,this),a=new lf(this.options,n),l=new vf(this.options,this),c=new eg(this.options,this),u=new yf(this.options),d=new Lo(this.options,this,this.interludeVideoContainer,this.videoWrapperElement,this.videoProxyElement,n.video),h=new Bo(this.options,this.videoProxyElement,this);const p=new Uo(this.options,this);var f=new fo(this.options,i,t,n,this,o,r,s,l,c,u,h,p),g=new jo(this.options,this),m=new wo(this.options,i,t,n,f,h,l,this),y=new Vo(this.options),v=new Wo(this.options,this,t,f,i,y);const b=new Jf(this.options,this);var w=new cf(this.options,this,f),k=new uf(this.options,n.video),x=new df(this.options),C=new zs(this.options),_=new hf(this.options,this,w,x,C),E=new pf(this.options,n,_,C),T=new xf(this.options,this,this.container),P=new _f(this.options,f),I=new Yf(this.options,this,d,f),A=new $i(this.options,this.pluginCtx={player:this.exports,core:this,autoplay:e,repository:t,engine:n,video:n.video,playlist:i,fullScreen:r,cuePoints:o,controller:f,videoScaler:d,rts:h,stream:m,container:g,cdnOptimizer:s,downloadAggregator:a,config:Xi,environment:Ae,loggerFactory:me,BaseModuleClass:ji,utils:ki,networkUtils:kr,mediaUtils:Qf,mathUtils:ao,pathUtils:$t,urlUtils:Xt,ticker:Zr,tweener:Ws,when:S,EventEmitter:Ti,PlayerCtx:qi,InterludeError:Li,asyncIvdLoadingManager:v,assetsDeliveryService:y,AudioSegment:Es,playerPerformance:b,streamQuality:w,playbackQuality:k,bitrateMultiplier:E,bitrateGuesstimator:u,mathFuncFactory:C,framerate:x,qoe:_,deprecator:l,formatMap:Jo,reduxManager:I,Node:pr,SubNode:cr,Segment:yr,SubSegment:gr,silentiOSManager:P,IvdTransformer:Ar,androidPiPManager:T,presumedVisibility:p},this);ki.extend(qi.get(this.options.playerInstanceId),this.pluginCtx),this.addErrorListener(e),this.addErrorListener(t),this.addErrorListener(n),this.addErrorListener(i),this.addErrorListener(r),this.addErrorListener(o),this.addErrorListener(f),this.addErrorListener(g),this.addErrorListener(d),this.addErrorListener(h),this.addErrorListener(m),this.addErrorListener(s),this.addErrorListener(A),this.addErrorListener(v),this.addErrorListener(y),this.addErrorListener(w),this.addErrorListener(k),this.addErrorListener(E),this.addErrorListener(C),this.addErrorListener(x),this.addErrorListener(_),this.addErrorListener(l),this.addErrorListener(I),this.addErrorListener(T),this.addErrorListener(P),this.defineProperty("version",this.getVersion),this.defineProperty("getOptions",(function(){return this.exposedOptions})),this.defineProperty("totalDownloadedBytes",(()=>a.totalDownloadedBytes)),this.expose(n.video.exports),this.expose(f.exports),this.expose(r.exports),this.expose(m.exports),this.expose(g.exports),this.expose(A.exports),this.expose(I.exports),this.expose(e.exports),this.exports.repository=t.exports,this.exports.playlist=i.exports,this.exports.qoe=_.exports,this.exposeProperty("getOptions","options"),this.exposeProperty("version"),this.exposeProperty("totalDownloadedBytes"),this.deprecateOldAPIs(l),A.runInitialInit(this.options.plugins)}});function ng(e){try{return window.eval(e),!0}catch(e){}return!1}const ig={class:function(){return ng("class Something {}")},arrowFunction:function(){return ng("var f = x => 1")},let:function(){return ng("let a = 1")},const:function(){return ng("const a = 1")},newArrayFeatures:function(){return void 0!==Array.prototype.find&&void 0!==Array.prototype.findIndex&&void 0!==Array.from&&void 0!==Array.of&&void 0!==Array.prototype.entries&&void 0!==Array.prototype.keys&&void 0!==Array.prototype.copyWithin&&void 0!==Array.prototype.fill},newObjectFeatures:function(){return void 0!==Object.assign&&void 0!==Object.setPrototypeOf&&void 0!==Object.getOwnPropertySymbols&&void 0!==Object.is},collections:function(){return"undefined"!=typeof Map&&"undefined"!=typeof WeakMap&&"undefined"!=typeof Set&&"undefined"!=typeof WeakSet},generators:function(){return ng("function* test() {}")},promises:function(){return"undefined"!=typeof Promise},templateStrings:function(){return ng("var a = `a`")},symbols:function(){return"undefined"!=typeof Symbol&&"function"==typeof Symbol.for},destructuring:function(){return ng("var { first: f, last: l } = { first: 'Jane', last: 'Doe' }")},spread:function(){return ng("Math.max(...[ 5, 10 ])")},defaultParamValues:function(){return ng("function test (one = 1) {}")}};var rg=ki.getObjectProperty(Ae,"os.name","").toLowerCase(),og=parseFloat(ki.getObjectProperty(Ae,"os.version",0))||0,sg=ki.getObjectProperty(Ae,"browser.name","").toLowerCase(),ag=parseInt(ki.getObjectProperty(Ae,"browser.major",0),10),lg=ki.getObjectProperty(Ae,"engine.name","").toLowerCase(),cg=me.createLogger("PlayerEnv","warn");async function ug(e){var t;try{if(t=function(){return Array.prototype.slice.call(arguments).every((function(e){var t=ig[e];if(t&&"function"==typeof t)return t();throw new Error("no detection available by this name: "+e)}))}("class","arrowFunction","let","const","newArrayFeatures","newObjectFeatures","collections","promises","templateStrings","destructuring","spread","defaultParamValues")){var n=ki.extend({logLevel:"disable",throwErrors:!1},e||{});t=!!(await us.create({EngineTech:n})).detect()}t&&"android"===rg&&(0===sg.indexOf("samsung")&&("blink"!==lg||ag<9)||"firefox"===sg&&ag<68)&&(t=!1)}catch(e){cg.info("[isSupported] Caught error:",e),t=!1}return t}function dg(e){var t;try{var n=ki.extend({logLevel:"disable",throwErrors:!1},e||{});t=new us({EngineTech:n}).supportedEngines()}catch(e){t=[]}return t}const hg={isSupported:ug,isDeviceSupported:function(e){return ug(e)||"android"===rg&&(og>=4||Ae.os&&void 0===Ae.os.version)},supportedEngines:dg,techsSupported:function(){return cg.warn("DEPRECATION WARNING: The 'techsSupported()' function is being deprecated. Please use the 'supportedEngines()' function instead."),dg.apply(null,arguments)},environment:Ae};"object"==typeof globalExports&&globalExports&&(globalExports.InterludePlayerEnv=hg);var pg=me.createLogger("InterludePlayer","warn");let fg=!1;var gg=null,mg=function(e,t){if(!e)throw new Error("Interlude Player's constructor must get an element (or selector) as first argument.");this.exports=new tg(t=t||{},e).exports};function yg(e,t){if(!fg)throw new Error("await InterludePlayer.create() must be used to instantiate InterludePlayer.");var n=arguments;function i(){return mg.apply(this,n)}return i.prototype=Object.create(mg.prototype),pg.info("Initializing InterludePlayer with element:",e,"and options:",t),(new i).exports}yg.create=async function(e,t){fg=!0;const n=new yg(e,t);return fg=!1,await n.__doAsyncInit(),n},yg.registerPlugin=$i.registerPlugin,yg.isSupported=hg.isSupported,yg.isDeviceSupported=hg.isDeviceSupported,yg.supportedEngines=hg.supportedEngines,yg.techsSupported=hg.techsSupported,Object.defineProperty(yg,"version",{enumerable:!0,get:function(){return Zf}}),Object.defineProperty(yg,"ivdVersion",{enumerable:!0,get:function(){return null===gg&&(gg=Fr.getIvdVersion()),gg}}),Object.defineProperty(yg,"environment",{enumerable:!0,get:function(){return hg.environment}}),Object.defineProperty(yg,"registeredPlugins",{enumerable:!0,get:function(){return $i.registeredPlugins}}),Object.defineProperty(yg,"utils",{enumerable:!0,get:function(){return ki}}),"object"==typeof globalExports&&globalExports?globalExports.InterludePlayer=yg:"undefined"!=typeof window&&(window.InterludePlayer=yg);var vg,bg,wg,kg,xg,Sg,Cg={exports:{}},_g={};function Eg(){if(bg)return vg;bg=1;var e=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable;return vg=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;var i=Object.getOwnPropertyNames(t).map((function(e){return t[e]}));if("0123456789"!==i.join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(e){r[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(e){return!1}}()?Object.assign:function(i,r){for(var o,s,a=function(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}(i),l=1;l<arguments.length;l++){for(var c in o=Object(arguments[l]))t.call(o,c)&&(a[c]=o[c]);if(e){s=e(o);for(var u=0;u<s.length;u++)n.call(o,s[u])&&(a[s[u]]=o[s[u]])}}return a},vg}function Tg(){return xg?kg:(xg=1,kg="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED")}var Pg=(Sg||(Sg=1,Cg.exports=function(){if(wg)return _g;wg=1;var e=Eg(),t="function"==typeof Symbol&&Symbol.for,n=t?Symbol.for("react.element"):60103,i=t?Symbol.for("react.portal"):60106,r=t?Symbol.for("react.fragment"):60107,o=t?Symbol.for("react.strict_mode"):60108,s=t?Symbol.for("react.profiler"):60114,a=t?Symbol.for("react.provider"):60109,l=t?Symbol.for("react.context"):60110,c=t?Symbol.for("react.forward_ref"):60112,u=t?Symbol.for("react.suspense"):60113,d=t?Symbol.for("react.memo"):60115,h=t?Symbol.for("react.lazy"):60116,p="function"==typeof Symbol&&Symbol.iterator;function f(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var g={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m={};function y(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||g}function v(){}function b(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||g}y.prototype.isReactComponent={},y.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error(f(85));this.updater.enqueueSetState(this,e,t,"setState")},y.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},v.prototype=y.prototype;var w=b.prototype=new v;w.constructor=b,e(w,y.prototype),w.isPureReactComponent=!0;var k={current:null},x=Object.prototype.hasOwnProperty,S={key:!0,ref:!0,__self:!0,__source:!0};function C(e,t,i){var r,o={},s=null,a=null;if(null!=t)for(r in void 0!==t.ref&&(a=t.ref),void 0!==t.key&&(s=""+t.key),t)x.call(t,r)&&!S.hasOwnProperty(r)&&(o[r]=t[r]);var l=arguments.length-2;if(1===l)o.children=i;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];o.children=c}if(e&&e.defaultProps)for(r in l=e.defaultProps)void 0===o[r]&&(o[r]=l[r]);return{$$typeof:n,type:e,key:s,ref:a,props:o,_owner:k.current}}function _(e){return"object"==typeof e&&null!==e&&e.$$typeof===n}var E=/\/+/g,T=[];function P(e,t,n,i){if(T.length){var r=T.pop();return r.result=e,r.keyPrefix=t,r.func=n,r.context=i,r.count=0,r}return{result:e,keyPrefix:t,func:n,context:i,count:0}}function I(e){e.result=null,e.keyPrefix=null,e.func=null,e.context=null,e.count=0,10>T.length&&T.push(e)}function A(e,t,r,o){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var a=!1;if(null===e)a=!0;else switch(s){case"string":case"number":a=!0;break;case"object":switch(e.$$typeof){case n:case i:a=!0}}if(a)return r(o,e,""===t?"."+L(e,0):t),1;if(a=0,t=""===t?".":t+":",Array.isArray(e))for(var l=0;l<e.length;l++){var c=t+L(s=e[l],l);a+=A(s,c,r,o)}else if("function"==typeof(c=null===e||"object"!=typeof e?null:"function"==typeof(c=p&&e[p]||e["@@iterator"])?c:null))for(e=c.call(e),l=0;!(s=e.next()).done;)a+=A(s=s.value,c=t+L(s,l++),r,o);else if("object"===s)throw r=""+e,Error(f(31,"[object Object]"===r?"object with keys {"+Object.keys(e).join(", ")+"}":r,""));return a}function O(e,t,n){return null==e?0:A(e,"",t,n)}function L(e,t){return"object"==typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+(""+e).replace(/[=:]/g,(function(e){return t[e]}))}(e.key):t.toString(36)}function N(e,t){e.func.call(e.context,t,e.count++)}function R(e,t,i){var r=e.result,o=e.keyPrefix;e=e.func.call(e.context,t,e.count++),Array.isArray(e)?D(e,r,i,(function(e){return e})):null!=e&&(_(e)&&(e=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(e,o+(!e.key||t&&t.key===e.key?"":(""+e.key).replace(E,"$&/")+"/")+i)),r.push(e))}function D(e,t,n,i,r){var o="";null!=n&&(o=(""+n).replace(E,"$&/")+"/"),O(e,R,t=P(t,o,i,r)),I(t)}var M={current:null};function F(){var e=M.current;if(null===e)throw Error(f(321));return e}var B={ReactCurrentDispatcher:M,ReactCurrentBatchConfig:{suspense:null},ReactCurrentOwner:k,IsSomeRendererActing:{current:!1},assign:e};return _g.Children={map:function(e,t,n){if(null==e)return e;var i=[];return D(e,i,null,t,n),i},forEach:function(e,t,n){if(null==e)return e;O(e,N,t=P(null,null,t,n)),I(t)},count:function(e){return O(e,(function(){return null}),null)},toArray:function(e){var t=[];return D(e,t,null,(function(e){return e})),t},only:function(e){if(!_(e))throw Error(f(143));return e}},_g.Component=y,_g.Fragment=r,_g.Profiler=s,_g.PureComponent=b,_g.StrictMode=o,_g.Suspense=u,_g.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=B,_g.cloneElement=function(t,i,r){if(null==t)throw Error(f(267,t));var o=e({},t.props),s=t.key,a=t.ref,l=t._owner;if(null!=i){if(void 0!==i.ref&&(a=i.ref,l=k.current),void 0!==i.key&&(s=""+i.key),t.type&&t.type.defaultProps)var c=t.type.defaultProps;for(u in i)x.call(i,u)&&!S.hasOwnProperty(u)&&(o[u]=void 0===i[u]&&void 0!==c?c[u]:i[u])}var u=arguments.length-2;if(1===u)o.children=r;else if(1<u){c=Array(u);for(var d=0;d<u;d++)c[d]=arguments[d+2];o.children=c}return{$$typeof:n,type:t.type,key:s,ref:a,props:o,_owner:l}},_g.createContext=function(e,t){return void 0===t&&(t=null),(e={$$typeof:l,_calculateChangedBits:t,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider={$$typeof:a,_context:e},e.Consumer=e},_g.createElement=C,_g.createFactory=function(e){var t=C.bind(null,e);return t.type=e,t},_g.createRef=function(){return{current:null}},_g.forwardRef=function(e){return{$$typeof:c,render:e}},_g.isValidElement=_,_g.lazy=function(e){return{$$typeof:h,_ctor:e,_status:-1,_result:null}},_g.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},_g.useCallback=function(e,t){return F().useCallback(e,t)},_g.useContext=function(e,t){return F().useContext(e,t)},_g.useDebugValue=function(){},_g.useEffect=function(e,t){return F().useEffect(e,t)},_g.useImperativeHandle=function(e,t,n){return F().useImperativeHandle(e,t,n)},_g.useLayoutEffect=function(e,t){return F().useLayoutEffect(e,t)},_g.useMemo=function(e,t){return F().useMemo(e,t)},_g.useReducer=function(e,t,n){return F().useReducer(e,t,n)},_g.useRef=function(e){return F().useRef(e)},_g.useState=function(e){return F().useState(e)},_g.version="16.14.0",_g}()),Cg.exports),Ig=r(Pg);window.React=Ig;var Ag,Og,Lg,Ng,Rg=n({__proto__:null,default:Ig},[Pg]),Dg={exports:{}},Mg={},Fg={exports:{}},Bg={},Ug=(Ng||(Ng=1,function e(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(e){console.error(e)}}(),Dg.exports=function(){if(Lg)return Mg;Lg=1;var e=Rg,t=Eg(),n=(Og||(Og=1,Fg.exports=(Ag||(Ag=1,function(e){var t,n,i,r,o;if("undefined"==typeof window||"function"!=typeof MessageChannel){var s=null,a=null,l=function(){if(null!==s)try{var t=e.unstable_now();s(!0,t),s=null}catch(e){throw setTimeout(l,0),e}},c=Date.now();e.unstable_now=function(){return Date.now()-c},t=function(e){null!==s?setTimeout(t,0,e):(s=e,setTimeout(l,0))},n=function(e,t){a=setTimeout(e,t)},i=function(){clearTimeout(a)},r=function(){return!1},o=e.unstable_forceFrameRate=function(){}}else{var u=window.performance,d=window.Date,h=window.setTimeout,p=window.clearTimeout;if("undefined"!=typeof console){var f=window.cancelAnimationFrame;"function"!=typeof window.requestAnimationFrame&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://fb.me/react-polyfills"),"function"!=typeof f&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://fb.me/react-polyfills")}if("object"==typeof u&&"function"==typeof u.now)e.unstable_now=function(){return u.now()};else{var g=d.now();e.unstable_now=function(){return d.now()-g}}var m=!1,y=null,v=-1,b=5,w=0;r=function(){return e.unstable_now()>=w},o=function(){},e.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing framerates higher than 125 fps is not unsupported"):b=0<e?Math.floor(1e3/e):5};var k=new MessageChannel,x=k.port2;k.port1.onmessage=function(){if(null!==y){var t=e.unstable_now();w=t+b;try{y(!0,t)?x.postMessage(null):(m=!1,y=null)}catch(e){throw x.postMessage(null),e}}else m=!1},t=function(e){y=e,m||(m=!0,x.postMessage(null))},n=function(t,n){v=h((function(){t(e.unstable_now())}),n)},i=function(){p(v),v=-1}}function S(e,t){var n=e.length;e.push(t);e:for(;;){var i=n-1>>>1,r=e[i];if(!(void 0!==r&&0<E(r,t)))break e;e[i]=t,e[n]=r,n=i}}function C(e){return void 0===(e=e[0])?null:e}function _(e){var t=e[0];if(void 0!==t){var n=e.pop();if(n!==t){e[0]=n;e:for(var i=0,r=e.length;i<r;){var o=2*(i+1)-1,s=e[o],a=o+1,l=e[a];if(void 0!==s&&0>E(s,n))void 0!==l&&0>E(l,s)?(e[i]=l,e[a]=n,i=a):(e[i]=s,e[o]=n,i=o);else{if(!(void 0!==l&&0>E(l,n)))break e;e[i]=l,e[a]=n,i=a}}}return t}return null}function E(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}var T=[],P=[],I=1,A=null,O=3,L=!1,N=!1,R=!1;function D(e){for(var t=C(P);null!==t;){if(null===t.callback)_(P);else{if(!(t.startTime<=e))break;_(P),t.sortIndex=t.expirationTime,S(T,t)}t=C(P)}}function M(e){if(R=!1,D(e),!N)if(null!==C(T))N=!0,t(F);else{var i=C(P);null!==i&&n(M,i.startTime-e)}}function F(t,o){N=!1,R&&(R=!1,i()),L=!0;var s=O;try{for(D(o),A=C(T);null!==A&&(!(A.expirationTime>o)||t&&!r());){var a=A.callback;if(null!==a){A.callback=null,O=A.priorityLevel;var l=a(A.expirationTime<=o);o=e.unstable_now(),"function"==typeof l?A.callback=l:A===C(T)&&_(T),D(o)}else _(T);A=C(T)}if(null!==A)var c=!0;else{var u=C(P);null!==u&&n(M,u.startTime-o),c=!1}return c}finally{A=null,O=s,L=!1}}function B(e){switch(e){case 1:return-1;case 2:return 250;case 5:return 1073741823;case 4:return 1e4;default:return 5e3}}var U=o;e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(e){e.callback=null},e.unstable_continueExecution=function(){N||L||(N=!0,t(F))},e.unstable_getCurrentPriorityLevel=function(){return O},e.unstable_getFirstCallbackNode=function(){return C(T)},e.unstable_next=function(e){switch(O){case 1:case 2:case 3:var t=3;break;default:t=O}var n=O;O=t;try{return e()}finally{O=n}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=U,e.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=O;O=e;try{return t()}finally{O=n}},e.unstable_scheduleCallback=function(r,o,s){var a=e.unstable_now();if("object"==typeof s&&null!==s){var l=s.delay;l="number"==typeof l&&0<l?a+l:a,s="number"==typeof s.timeout?s.timeout:B(r)}else s=B(r),l=a;return r={id:I++,callback:o,priorityLevel:r,startTime:l,expirationTime:s=l+s,sortIndex:-1},l>a?(r.sortIndex=l,S(P,r),null===C(T)&&r===C(P)&&(R?i():R=!0,n(M,l-a))):(r.sortIndex=s,S(T,r),N||L||(N=!0,t(F))),r},e.unstable_shouldYield=function(){var t=e.unstable_now();D(t);var n=C(T);return n!==A&&null!==A&&null!==n&&null!==n.callback&&n.startTime<=t&&n.expirationTime<A.expirationTime||r()},e.unstable_wrapCallback=function(e){var t=O;return function(){var n=O;O=t;try{return e.apply(this,arguments)}finally{O=n}}}}(Bg)),Bg)),Fg.exports);function i(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}if(!e)throw Error(i(227));function r(e,t,n,i,r,o,s,a,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(e){this.onError(e)}}var o=!1,s=null,a=!1,l=null,c={onError:function(e){o=!0,s=e}};function u(e,t,n,i,a,l,u,d,h){o=!1,s=null,r.apply(c,arguments)}var d=null,h=null,p=null;function f(e,t,n){var r=e.type||"unknown-event";e.currentTarget=p(n),function(e,t,n,r,c,d,h,p,f){if(u.apply(this,arguments),o){if(!o)throw Error(i(198));var g=s;o=!1,s=null,a||(a=!0,l=g)}}(r,t,void 0,e),e.currentTarget=null}var g=null,m={};function y(){if(g)for(var e in m){var t=m[e],n=g.indexOf(e);if(!(-1<n))throw Error(i(96,e));if(!b[n]){if(!t.extractEvents)throw Error(i(97,e));for(var r in b[n]=t,n=t.eventTypes){var o=void 0,s=n[r],a=t,l=r;if(w.hasOwnProperty(l))throw Error(i(99,l));w[l]=s;var c=s.phasedRegistrationNames;if(c){for(o in c)c.hasOwnProperty(o)&&v(c[o],a,l);o=!0}else s.registrationName?(v(s.registrationName,a,l),o=!0):o=!1;if(!o)throw Error(i(98,r,e))}}}}function v(e,t,n){if(k[e])throw Error(i(100,e));k[e]=t,x[e]=t.eventTypes[n].dependencies}var b=[],w={},k={},x={};function S(e){var t,n=!1;for(t in e)if(e.hasOwnProperty(t)){var r=e[t];if(!m.hasOwnProperty(t)||m[t]!==r){if(m[t])throw Error(i(102,t));m[t]=r,n=!0}}n&&y()}var C=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement),_=null,E=null,T=null;function P(e){if(e=h(e)){if("function"!=typeof _)throw Error(i(280));var t=e.stateNode;t&&(t=d(t),_(e.stateNode,e.type,t))}}function I(e){E?T?T.push(e):T=[e]:E=e}function A(){if(E){var e=E,t=T;if(T=E=null,P(e),t)for(e=0;e<t.length;e++)P(t[e])}}function O(e,t){return e(t)}function L(e,t,n,i,r){return e(t,n,i,r)}function N(){}var R=O,D=!1,M=!1;function F(){null===E&&null===T||(N(),A())}function B(e,t,n){if(M)return e(t,n);M=!0;try{return R(e,t,n)}finally{M=!1,F()}}var U=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,j=Object.prototype.hasOwnProperty,z={},V={};function W(e,t,n,i,r,o){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=o}var H={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){H[e]=new W(e,0,!1,e,null,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];H[t]=new W(t,1,!1,e[1],null,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){H[e]=new W(e,2,!1,e.toLowerCase(),null,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){H[e]=new W(e,2,!1,e,null,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){H[e]=new W(e,3,!1,e.toLowerCase(),null,!1)})),["checked","multiple","muted","selected"].forEach((function(e){H[e]=new W(e,3,!0,e,null,!1)})),["capture","download"].forEach((function(e){H[e]=new W(e,4,!1,e,null,!1)})),["cols","rows","size","span"].forEach((function(e){H[e]=new W(e,6,!1,e,null,!1)})),["rowSpan","start"].forEach((function(e){H[e]=new W(e,5,!1,e.toLowerCase(),null,!1)}));var $=/[\-:]([a-z])/g;function G(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace($,G);H[t]=new W(t,1,!1,e,null,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace($,G);H[t]=new W(t,1,!1,e,"http://www.w3.org/1999/xlink",!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace($,G);H[t]=new W(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1)})),["tabIndex","crossOrigin"].forEach((function(e){H[e]=new W(e,1,!1,e.toLowerCase(),null,!1)})),H.xlinkHref=new W("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0),["src","href","action","formAction"].forEach((function(e){H[e]=new W(e,1,!1,e.toLowerCase(),null,!0)}));var q=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function Y(e,t,n,i){var r=H.hasOwnProperty(t)?H[t]:null;(null!==r?0===r.type:!i&&2<t.length&&("o"===t[0]||"O"===t[0])&&("n"===t[1]||"N"===t[1]))||(function(e,t,n,i){if(null==t||function(e,t,n,i){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!i&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,i))return!0;if(i)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,r,i)&&(n=null),i||null===r?function(e){return!!j.call(V,e)||!j.call(z,e)&&(U.test(e)?V[e]=!0:(z[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):r.mustUseProperty?e[r.propertyName]=null===n?3!==r.type&&"":n:(t=r.attributeName,i=r.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(r=r.type)||4===r&&!0===n?"":""+n,i?e.setAttributeNS(i,t,n):e.setAttribute(t,n))))}q.hasOwnProperty("ReactCurrentDispatcher")||(q.ReactCurrentDispatcher={current:null}),q.hasOwnProperty("ReactCurrentBatchConfig")||(q.ReactCurrentBatchConfig={suspense:null});var K=/^(.*)[\\\/]/,X="function"==typeof Symbol&&Symbol.for,Q=X?Symbol.for("react.element"):60103,Z=X?Symbol.for("react.portal"):60106,J=X?Symbol.for("react.fragment"):60107,ee=X?Symbol.for("react.strict_mode"):60108,te=X?Symbol.for("react.profiler"):60114,ne=X?Symbol.for("react.provider"):60109,ie=X?Symbol.for("react.context"):60110,re=X?Symbol.for("react.concurrent_mode"):60111,oe=X?Symbol.for("react.forward_ref"):60112,se=X?Symbol.for("react.suspense"):60113,ae=X?Symbol.for("react.suspense_list"):60120,le=X?Symbol.for("react.memo"):60115,ce=X?Symbol.for("react.lazy"):60116,ue=X?Symbol.for("react.block"):60121,de="function"==typeof Symbol&&Symbol.iterator;function he(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=de&&e[de]||e["@@iterator"])?e:null}function pe(e){if(null==e)return null;if("function"==typeof e)return e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case J:return"Fragment";case Z:return"Portal";case te:return"Profiler";case ee:return"StrictMode";case se:return"Suspense";case ae:return"SuspenseList"}if("object"==typeof e)switch(e.$$typeof){case ie:return"Context.Consumer";case ne:return"Context.Provider";case oe:var t=e.render;return t=t.displayName||t.name||"",e.displayName||(""!==t?"ForwardRef("+t+")":"ForwardRef");case le:return pe(e.type);case ue:return pe(e.render);case ce:if(e=1===e._status?e._result:null)return pe(e)}return null}function fe(e){var t="";do{e:switch(e.tag){case 3:case 4:case 6:case 7:case 10:case 9:var n="";break e;default:var i=e._debugOwner,r=e._debugSource,o=pe(e.type);n=null,i&&(n=pe(i.type)),i=o,o="",r?o=" (at "+r.fileName.replace(K,"")+":"+r.lineNumber+")":n&&(o=" (created by "+n+")"),n="\n    in "+(i||"Unknown")+o}t+=n,e=e.return}while(e);return t}function ge(e){switch(typeof e){case"boolean":case"number":case"object":case"string":case"undefined":return e;default:return""}}function me(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function ye(e){e._valueTracker||(e._valueTracker=function(e){var t=me(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),i=""+e[t];if(!e.hasOwnProperty(t)&&void 0!==n&&"function"==typeof n.get&&"function"==typeof n.set){var r=n.get,o=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return r.call(this)},set:function(e){i=""+e,o.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(e){i=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function ve(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),i="";return e&&(i=me(e)?e.checked?"true":"false":e.value),(e=i)!==n&&(t.setValue(e),!0)}function be(e,n){var i=n.checked;return t({},n,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=i?i:e._wrapperState.initialChecked})}function we(e,t){var n=null==t.defaultValue?"":t.defaultValue,i=null!=t.checked?t.checked:t.defaultChecked;n=ge(null!=t.value?t.value:n),e._wrapperState={initialChecked:i,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function ke(e,t){null!=(t=t.checked)&&Y(e,"checked",t,!1)}function xe(e,t){ke(e,t);var n=ge(t.value),i=t.type;if(null!=n)"number"===i?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===i||"reset"===i)return void e.removeAttribute("value");t.hasOwnProperty("value")?Ce(e,t.type,n):t.hasOwnProperty("defaultValue")&&Ce(e,t.type,ge(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Se(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var i=t.type;if(("submit"===i||"reset"===i)&&null==t.value)return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function Ce(e,t,n){"number"===t&&e.ownerDocument.activeElement===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}function _e(n,i){return n=t({children:void 0},i),(i=function(t){var n="";return e.Children.forEach(t,(function(e){null!=e&&(n+=e)})),n}(i.children))&&(n.children=i),n}function Ee(e,t,n,i){if(e=e.options,t){t={};for(var r=0;r<n.length;r++)t["$"+n[r]]=!0;for(n=0;n<e.length;n++)r=t.hasOwnProperty("$"+e[n].value),e[n].selected!==r&&(e[n].selected=r),r&&i&&(e[n].defaultSelected=!0)}else{for(n=""+ge(n),t=null,r=0;r<e.length;r++){if(e[r].value===n)return e[r].selected=!0,void(i&&(e[r].defaultSelected=!0));null!==t||e[r].disabled||(t=e[r])}null!==t&&(t.selected=!0)}}function Te(e,n){if(null!=n.dangerouslySetInnerHTML)throw Error(i(91));return t({},n,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Pe(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(i(92));if(Array.isArray(n)){if(!(1>=n.length))throw Error(i(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:ge(n)}}function Ie(e,t){var n=ge(t.value),i=ge(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=i&&(e.defaultValue=""+i)}function Ae(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function Oe(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?Oe(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var Ne,Re=function(e){return"undefined"!=typeof MSApp&&MSApp.execUnsafeLocalFunction?function(t,n,i,r){MSApp.execUnsafeLocalFunction((function(){return e(t,n)}))}:e}((function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((Ne=Ne||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Ne.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}}));function De(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}function Me(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Fe={animationend:Me("Animation","AnimationEnd"),animationiteration:Me("Animation","AnimationIteration"),animationstart:Me("Animation","AnimationStart"),transitionend:Me("Transition","TransitionEnd")},Be={},Ue={};function je(e){if(Be[e])return Be[e];if(!Fe[e])return e;var t,n=Fe[e];for(t in n)if(n.hasOwnProperty(t)&&t in Ue)return Be[e]=n[t];return e}C&&(Ue=document.createElement("div").style,"AnimationEvent"in window||(delete Fe.animationend.animation,delete Fe.animationiteration.animation,delete Fe.animationstart.animation),"TransitionEvent"in window||delete Fe.transitionend.transition);var ze=je("animationend"),Ve=je("animationiteration"),We=je("animationstart"),He=je("transitionend"),$e="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Ge=new("function"==typeof WeakMap?WeakMap:Map);function qe(e){var t=Ge.get(e);return void 0===t&&(t=new Map,Ge.set(e,t)),t}function Ye(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{!!(1026&(t=e).effectTag)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function Ke(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&null!==(e=e.alternate)&&(t=e.memoizedState),null!==t)return t.dehydrated}return null}function Xe(e){if(Ye(e)!==e)throw Error(i(188))}function Qe(e){if(e=function(e){var t=e.alternate;if(!t){if(null===(t=Ye(e)))throw Error(i(188));return t!==e?null:e}for(var n=e,r=t;;){var o=n.return;if(null===o)break;var s=o.alternate;if(null===s){if(null!==(r=o.return)){n=r;continue}break}if(o.child===s.child){for(s=o.child;s;){if(s===n)return Xe(o),e;if(s===r)return Xe(o),t;s=s.sibling}throw Error(i(188))}if(n.return!==r.return)n=o,r=s;else{for(var a=!1,l=o.child;l;){if(l===n){a=!0,n=o,r=s;break}if(l===r){a=!0,r=o,n=s;break}l=l.sibling}if(!a){for(l=s.child;l;){if(l===n){a=!0,n=s,r=o;break}if(l===r){a=!0,r=s,n=o;break}l=l.sibling}if(!a)throw Error(i(189))}}if(n.alternate!==r)throw Error(i(190))}if(3!==n.tag)throw Error(i(188));return n.stateNode.current===n?e:t}(e),!e)return null;for(var t=e;;){if(5===t.tag||6===t.tag)return t;if(t.child)t.child.return=t,t=t.child;else{if(t===e)break;for(;!t.sibling;){if(!t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}}return null}function Ze(e,t){if(null==t)throw Error(i(30));return null==e?t:Array.isArray(e)?Array.isArray(t)?(e.push.apply(e,t),e):(e.push(t),e):Array.isArray(t)?[e].concat(t):[e,t]}function Je(e,t,n){Array.isArray(e)?e.forEach(t,n):e&&t.call(n,e)}var et=null;function tt(e){if(e){var t=e._dispatchListeners,n=e._dispatchInstances;if(Array.isArray(t))for(var i=0;i<t.length&&!e.isPropagationStopped();i++)f(e,t[i],n[i]);else t&&f(e,t,n);e._dispatchListeners=null,e._dispatchInstances=null,e.isPersistent()||e.constructor.release(e)}}function nt(e){if(null!==e&&(et=Ze(et,e)),e=et,et=null,e){if(Je(e,tt),et)throw Error(i(95));if(a)throw e=l,a=!1,l=null,e}}function it(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}function rt(e){if(!C)return!1;var t=(e="on"+e)in document;return t||((t=document.createElement("div")).setAttribute(e,"return;"),t="function"==typeof t[e]),t}var ot=[];function st(e){e.topLevelType=null,e.nativeEvent=null,e.targetInst=null,e.ancestors.length=0,10>ot.length&&ot.push(e)}function at(e,t,n,i){if(ot.length){var r=ot.pop();return r.topLevelType=e,r.eventSystemFlags=i,r.nativeEvent=t,r.targetInst=n,r}return{topLevelType:e,eventSystemFlags:i,nativeEvent:t,targetInst:n,ancestors:[]}}function lt(e){var t=e.targetInst,n=t;do{if(!n){e.ancestors.push(n);break}var i=n;if(3===i.tag)i=i.stateNode.containerInfo;else{for(;i.return;)i=i.return;i=3!==i.tag?null:i.stateNode.containerInfo}if(!i)break;5!==(t=n.tag)&&6!==t||e.ancestors.push(n),n=Tn(i)}while(n);for(n=0;n<e.ancestors.length;n++){t=e.ancestors[n];var r=it(e.nativeEvent);i=e.topLevelType;var o=e.nativeEvent,s=e.eventSystemFlags;0===n&&(s|=64);for(var a=null,l=0;l<b.length;l++){var c=b[l];c&&(c=c.extractEvents(i,t,o,r,s))&&(a=Ze(a,c))}nt(a)}}function ct(e,t,n){if(!n.has(e)){switch(e){case"scroll":Wt(t,"scroll",!0);break;case"focus":case"blur":Wt(t,"focus",!0),Wt(t,"blur",!0),n.set("blur",null),n.set("focus",null);break;case"cancel":case"close":rt(e)&&Wt(t,e,!0);break;case"invalid":case"submit":case"reset":break;default:-1===$e.indexOf(e)&&Vt(e,t)}n.set(e,null)}}var ut,dt,ht,pt=!1,ft=[],gt=null,mt=null,yt=null,vt=new Map,bt=new Map,wt=[],kt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput close cancel copy cut paste click change contextmenu reset submit".split(" "),xt="focus blur dragenter dragleave mouseover mouseout pointerover pointerout gotpointercapture lostpointercapture".split(" ");function St(e,t,n,i,r){return{blockedOn:e,topLevelType:t,eventSystemFlags:32|n,nativeEvent:r,container:i}}function Ct(e,t){switch(e){case"focus":case"blur":gt=null;break;case"dragenter":case"dragleave":mt=null;break;case"mouseover":case"mouseout":yt=null;break;case"pointerover":case"pointerout":vt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":bt.delete(t.pointerId)}}function _t(e,t,n,i,r,o){return null===e||e.nativeEvent!==o?(e=St(t,n,i,r,o),null!==t&&null!==(t=Pn(t))&&dt(t),e):(e.eventSystemFlags|=i,e)}function Et(e){var t=Tn(e.target);if(null!==t){var i=Ye(t);if(null!==i)if(13===(t=i.tag)){if(null!==(t=Ke(i)))return e.blockedOn=t,void n.unstable_runWithPriority(e.priority,(function(){ht(i)}))}else if(3===t&&i.stateNode.hydrate)return void(e.blockedOn=3===i.tag?i.stateNode.containerInfo:null)}e.blockedOn=null}function Tt(e){if(null!==e.blockedOn)return!1;var t=qt(e.topLevelType,e.eventSystemFlags,e.container,e.nativeEvent);if(null!==t){var n=Pn(t);return null!==n&&dt(n),e.blockedOn=t,!1}return!0}function Pt(e,t,n){Tt(e)&&n.delete(t)}function It(){for(pt=!1;0<ft.length;){var e=ft[0];if(null!==e.blockedOn){null!==(e=Pn(e.blockedOn))&&ut(e);break}var t=qt(e.topLevelType,e.eventSystemFlags,e.container,e.nativeEvent);null!==t?e.blockedOn=t:ft.shift()}null!==gt&&Tt(gt)&&(gt=null),null!==mt&&Tt(mt)&&(mt=null),null!==yt&&Tt(yt)&&(yt=null),vt.forEach(Pt),bt.forEach(Pt)}function At(e,t){e.blockedOn===t&&(e.blockedOn=null,pt||(pt=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,It)))}function Ot(e){function t(t){return At(t,e)}if(0<ft.length){At(ft[0],e);for(var n=1;n<ft.length;n++){var i=ft[n];i.blockedOn===e&&(i.blockedOn=null)}}for(null!==gt&&At(gt,e),null!==mt&&At(mt,e),null!==yt&&At(yt,e),vt.forEach(t),bt.forEach(t),n=0;n<wt.length;n++)(i=wt[n]).blockedOn===e&&(i.blockedOn=null);for(;0<wt.length&&null===(n=wt[0]).blockedOn;)Et(n),null===n.blockedOn&&wt.shift()}var Lt={},Nt=new Map,Rt=new Map,Dt=["abort","abort",ze,"animationEnd",Ve,"animationIteration",We,"animationStart","canplay","canPlay","canplaythrough","canPlayThrough","durationchange","durationChange","emptied","emptied","encrypted","encrypted","ended","ended","error","error","gotpointercapture","gotPointerCapture","load","load","loadeddata","loadedData","loadedmetadata","loadedMetadata","loadstart","loadStart","lostpointercapture","lostPointerCapture","playing","playing","progress","progress","seeking","seeking","stalled","stalled","suspend","suspend","timeupdate","timeUpdate",He,"transitionEnd","waiting","waiting"];function Mt(e,t){for(var n=0;n<e.length;n+=2){var i=e[n],r=e[n+1],o="on"+(r[0].toUpperCase()+r.slice(1));o={phasedRegistrationNames:{bubbled:o,captured:o+"Capture"},dependencies:[i],eventPriority:t},Rt.set(i,t),Nt.set(i,o),Lt[r]=o}}Mt("blur blur cancel cancel click click close close contextmenu contextMenu copy copy cut cut auxclick auxClick dblclick doubleClick dragend dragEnd dragstart dragStart drop drop focus focus input input invalid invalid keydown keyDown keypress keyPress keyup keyUp mousedown mouseDown mouseup mouseUp paste paste pause pause play play pointercancel pointerCancel pointerdown pointerDown pointerup pointerUp ratechange rateChange reset reset seeked seeked submit submit touchcancel touchCancel touchend touchEnd touchstart touchStart volumechange volumeChange".split(" "),0),Mt("drag drag dragenter dragEnter dragexit dragExit dragleave dragLeave dragover dragOver mousemove mouseMove mouseout mouseOut mouseover mouseOver pointermove pointerMove pointerout pointerOut pointerover pointerOver scroll scroll toggle toggle touchmove touchMove wheel wheel".split(" "),1),Mt(Dt,2);for(var Ft="change selectionchange textInput compositionstart compositionend compositionupdate".split(" "),Bt=0;Bt<Ft.length;Bt++)Rt.set(Ft[Bt],0);var Ut=n.unstable_UserBlockingPriority,jt=n.unstable_runWithPriority,zt=!0;function Vt(e,t){Wt(t,e,!1)}function Wt(e,t,n){var i=Rt.get(t);switch(void 0===i?2:i){case 0:i=Ht.bind(null,t,1,e);break;case 1:i=$t.bind(null,t,1,e);break;default:i=Gt.bind(null,t,1,e)}e.addEventListener(t,i,!!n)}function Ht(e,t,n,i){D||N();var r=Gt,o=D;D=!0;try{L(r,e,t,n,i)}finally{(D=o)||F()}}function $t(e,t,n,i){jt(Ut,Gt.bind(null,e,t,n,i))}function Gt(e,t,n,i){if(zt)if(0<ft.length&&-1<kt.indexOf(e))e=St(null,e,t,n,i),ft.push(e);else{var r=qt(e,t,n,i);if(null===r)Ct(e,i);else if(-1<kt.indexOf(e))e=St(r,e,t,n,i),ft.push(e);else if(!function(e,t,n,i,r){switch(t){case"focus":return gt=_t(gt,e,t,n,i,r),!0;case"dragenter":return mt=_t(mt,e,t,n,i,r),!0;case"mouseover":return yt=_t(yt,e,t,n,i,r),!0;case"pointerover":var o=r.pointerId;return vt.set(o,_t(vt.get(o)||null,e,t,n,i,r)),!0;case"gotpointercapture":return bt.set(o=r.pointerId,_t(bt.get(o)||null,e,t,n,i,r)),!0}return!1}(r,e,t,n,i)){Ct(e,i),e=at(e,i,null,t);try{B(lt,e)}finally{st(e)}}}}function qt(e,t,n,i){if(null!==(n=Tn(n=it(i)))){var r=Ye(n);if(null===r)n=null;else{var o=r.tag;if(13===o){if(null!==(n=Ke(r)))return n;n=null}else if(3===o){if(r.stateNode.hydrate)return 3===r.tag?r.stateNode.containerInfo:null;n=null}else r!==n&&(n=null)}}e=at(e,i,n,t);try{B(lt,e)}finally{st(e)}return null}var Yt={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Kt=["Webkit","ms","Moz","O"];function Xt(e,t,n){return null==t||"boolean"==typeof t||""===t?"":n||"number"!=typeof t||0===t||Yt.hasOwnProperty(e)&&Yt[e]?(""+t).trim():t+"px"}function Qt(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var i=0===n.indexOf("--"),r=Xt(n,t[n],i);"float"===n&&(n="cssFloat"),i?e.setProperty(n,r):e[n]=r}}Object.keys(Yt).forEach((function(e){Kt.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Yt[t]=Yt[e]}))}));var Zt=t({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Jt(e,t){if(t){if(Zt[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(i(137,e,""));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(i(60));if("object"!=typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(i(61))}if(null!=t.style&&"object"!=typeof t.style)throw Error(i(62,""))}}function en(e,t){if(-1===e.indexOf("-"))return"string"==typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var tn="http://www.w3.org/1999/xhtml";function nn(e,t){var n=qe(e=9===e.nodeType||11===e.nodeType?e:e.ownerDocument);t=x[t];for(var i=0;i<t.length;i++)ct(t[i],e,n)}function rn(){}function on(e){if(void 0===(e=e||("undefined"!=typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function sn(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function an(e,t){var n,i=sn(e);for(e=0;i;){if(3===i.nodeType){if(n=e+i.textContent.length,e<=t&&n>=t)return{node:i,offset:t-e};e=n}e:{for(;i;){if(i.nextSibling){i=i.nextSibling;break e}i=i.parentNode}i=void 0}i=sn(i)}}function ln(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?ln(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function cn(){for(var e=window,t=on();t instanceof e.HTMLIFrameElement;){try{var n="string"==typeof t.contentWindow.location.href}catch(e){n=!1}if(!n)break;t=on((e=t.contentWindow).document)}return t}function un(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var dn="$",hn="/$",pn="$?",fn="$!",gn=null,mn=null;function yn(e,t){switch(e){case"button":case"input":case"select":case"textarea":return!!t.autoFocus}return!1}function vn(e,t){return"textarea"===e||"option"===e||"noscript"===e||"string"==typeof t.children||"number"==typeof t.children||"object"==typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var bn="function"==typeof setTimeout?setTimeout:void 0,wn="function"==typeof clearTimeout?clearTimeout:void 0;function kn(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break}return e}function xn(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if(n===dn||n===fn||n===pn){if(0===t)return e;t--}else n===hn&&t++}e=e.previousSibling}return null}var Sn=Math.random().toString(36).slice(2),Cn="__reactInternalInstance$"+Sn,_n="__reactEventHandlers$"+Sn,En="__reactContainere$"+Sn;function Tn(e){var t=e[Cn];if(t)return t;for(var n=e.parentNode;n;){if(t=n[En]||n[Cn]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=xn(e);null!==e;){if(n=e[Cn])return n;e=xn(e)}return t}n=(e=n).parentNode}return null}function Pn(e){return!(e=e[Cn]||e[En])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function In(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(i(33))}function An(e){return e[_n]||null}function On(e){do{e=e.return}while(e&&5!==e.tag);return e||null}function Ln(e,t){var n=e.stateNode;if(!n)return null;var r=d(n);if(!r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!=typeof n)throw Error(i(231,t,typeof n));return n}function Nn(e,t,n){(t=Ln(e,n.dispatchConfig.phasedRegistrationNames[t]))&&(n._dispatchListeners=Ze(n._dispatchListeners,t),n._dispatchInstances=Ze(n._dispatchInstances,e))}function Rn(e){if(e&&e.dispatchConfig.phasedRegistrationNames){for(var t=e._targetInst,n=[];t;)n.push(t),t=On(t);for(t=n.length;0<t--;)Nn(n[t],"captured",e);for(t=0;t<n.length;t++)Nn(n[t],"bubbled",e)}}function Dn(e,t,n){e&&n&&n.dispatchConfig.registrationName&&(t=Ln(e,n.dispatchConfig.registrationName))&&(n._dispatchListeners=Ze(n._dispatchListeners,t),n._dispatchInstances=Ze(n._dispatchInstances,e))}function Mn(e){e&&e.dispatchConfig.registrationName&&Dn(e._targetInst,null,e)}function Fn(e){Je(e,Rn)}var Bn=null,Un=null,jn=null;function zn(){if(jn)return jn;var e,t,n=Un,i=n.length,r="value"in Bn?Bn.value:Bn.textContent,o=r.length;for(e=0;e<i&&n[e]===r[e];e++);var s=i-e;for(t=1;t<=s&&n[i-t]===r[o-t];t++);return jn=r.slice(e,1<t?1-t:void 0)}function Vn(){return!0}function Wn(){return!1}function Hn(e,t,n,i){for(var r in this.dispatchConfig=e,this._targetInst=t,this.nativeEvent=n,e=this.constructor.Interface)e.hasOwnProperty(r)&&((t=e[r])?this[r]=t(n):"target"===r?this.target=i:this[r]=n[r]);return this.isDefaultPrevented=(null!=n.defaultPrevented?n.defaultPrevented:!1===n.returnValue)?Vn:Wn,this.isPropagationStopped=Wn,this}function $n(e,t,n,i){if(this.eventPool.length){var r=this.eventPool.pop();return this.call(r,e,t,n,i),r}return new this(e,t,n,i)}function Gn(e){if(!(e instanceof this))throw Error(i(279));e.destructor(),10>this.eventPool.length&&this.eventPool.push(e)}function qn(e){e.eventPool=[],e.getPooled=$n,e.release=Gn}t(Hn.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!=typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=Vn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!=typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=Vn)},persist:function(){this.isPersistent=Vn},isPersistent:Wn,destructor:function(){var e,t=this.constructor.Interface;for(e in t)this[e]=null;this.nativeEvent=this._targetInst=this.dispatchConfig=null,this.isPropagationStopped=this.isDefaultPrevented=Wn,this._dispatchInstances=this._dispatchListeners=null}}),Hn.Interface={type:null,target:null,currentTarget:function(){return null},eventPhase:null,bubbles:null,cancelable:null,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:null,isTrusted:null},Hn.extend=function(e){function n(){}function i(){return r.apply(this,arguments)}var r=this;n.prototype=r.prototype;var o=new n;return t(o,i.prototype),(i.prototype=o).constructor=i,i.Interface=t({},r.Interface,e),i.extend=r.extend,qn(i),i},qn(Hn);var Yn=Hn.extend({data:null}),Kn=Hn.extend({data:null}),Xn=[9,13,27,32],Qn=C&&"CompositionEvent"in window,Zn=null;C&&"documentMode"in document&&(Zn=document.documentMode);var Jn=C&&"TextEvent"in window&&!Zn,ei=C&&(!Qn||Zn&&8<Zn&&11>=Zn),ti=String.fromCharCode(32),ni={beforeInput:{phasedRegistrationNames:{bubbled:"onBeforeInput",captured:"onBeforeInputCapture"},dependencies:["compositionend","keypress","textInput","paste"]},compositionEnd:{phasedRegistrationNames:{bubbled:"onCompositionEnd",captured:"onCompositionEndCapture"},dependencies:"blur compositionend keydown keypress keyup mousedown".split(" ")},compositionStart:{phasedRegistrationNames:{bubbled:"onCompositionStart",captured:"onCompositionStartCapture"},dependencies:"blur compositionstart keydown keypress keyup mousedown".split(" ")},compositionUpdate:{phasedRegistrationNames:{bubbled:"onCompositionUpdate",captured:"onCompositionUpdateCapture"},dependencies:"blur compositionupdate keydown keypress keyup mousedown".split(" ")}},ii=!1;function ri(e,t){switch(e){case"keyup":return-1!==Xn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"blur":return!0;default:return!1}}function oi(e){return"object"==typeof(e=e.detail)&&"data"in e?e.data:null}var si=!1,ai={eventTypes:ni,extractEvents:function(e,t,n,i){var r;if(Qn)e:{switch(e){case"compositionstart":var o=ni.compositionStart;break e;case"compositionend":o=ni.compositionEnd;break e;case"compositionupdate":o=ni.compositionUpdate;break e}o=void 0}else si?ri(e,n)&&(o=ni.compositionEnd):"keydown"===e&&229===n.keyCode&&(o=ni.compositionStart);return o?(ei&&"ko"!==n.locale&&(si||o!==ni.compositionStart?o===ni.compositionEnd&&si&&(r=zn()):(Un="value"in(Bn=i)?Bn.value:Bn.textContent,si=!0)),o=Yn.getPooled(o,t,n,i),(r||null!==(r=oi(n)))&&(o.data=r),Fn(o),r=o):r=null,(e=Jn?function(e,t){switch(e){case"compositionend":return oi(t);case"keypress":return 32!==t.which?null:(ii=!0,ti);case"textInput":return(e=t.data)===ti&&ii?null:e;default:return null}}(e,n):function(e,t){if(si)return"compositionend"===e||!Qn&&ri(e,t)?(e=zn(),jn=Un=Bn=null,si=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return ei&&"ko"!==t.locale?null:t.data}}(e,n))?((t=Kn.getPooled(ni.beforeInput,t,n,i)).data=e,Fn(t)):t=null,null===r?t:null===t?r:[r,t]}},li={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ci(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!li[e.type]:"textarea"===t}var ui={change:{phasedRegistrationNames:{bubbled:"onChange",captured:"onChangeCapture"},dependencies:"blur change click focus input keydown keyup selectionchange".split(" ")}};function di(e,t,n){return(e=Hn.getPooled(ui.change,e,t,n)).type="change",I(n),Fn(e),e}var hi=null,pi=null;function fi(e){nt(e)}function gi(e){if(ve(In(e)))return e}function mi(e,t){if("change"===e)return t}var yi=!1;function vi(){hi&&(hi.detachEvent("onpropertychange",bi),pi=hi=null)}function bi(e){if("value"===e.propertyName&&gi(pi))if(e=di(pi,e,it(e)),D)nt(e);else{D=!0;try{O(fi,e)}finally{D=!1,F()}}}function wi(e,t,n){"focus"===e?(vi(),pi=n,(hi=t).attachEvent("onpropertychange",bi)):"blur"===e&&vi()}function ki(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return gi(pi)}function xi(e,t){if("click"===e)return gi(t)}function Si(e,t){if("input"===e||"change"===e)return gi(t)}C&&(yi=rt("input")&&(!document.documentMode||9<document.documentMode));var Ci={eventTypes:ui,_isInputEventSupported:yi,extractEvents:function(e,t,n,i){var r=t?In(t):window,o=r.nodeName&&r.nodeName.toLowerCase();if("select"===o||"input"===o&&"file"===r.type)var s=mi;else if(ci(r))if(yi)s=Si;else{s=ki;var a=wi}else(o=r.nodeName)&&"input"===o.toLowerCase()&&("checkbox"===r.type||"radio"===r.type)&&(s=xi);if(s&&(s=s(e,t)))return di(s,n,i);a&&a(e,r,t),"blur"===e&&(e=r._wrapperState)&&e.controlled&&"number"===r.type&&Ce(r,"number",r.value)}},_i=Hn.extend({view:null,detail:null}),Ei={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ti(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Ei[e])&&!!t[e]}function Pi(){return Ti}var Ii=0,Ai=0,Oi=!1,Li=!1,Ni=_i.extend({screenX:null,screenY:null,clientX:null,clientY:null,pageX:null,pageY:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,getModifierState:Pi,button:null,buttons:null,relatedTarget:function(e){return e.relatedTarget||(e.fromElement===e.srcElement?e.toElement:e.fromElement)},movementX:function(e){if("movementX"in e)return e.movementX;var t=Ii;return Ii=e.screenX,Oi?"mousemove"===e.type?e.screenX-t:0:(Oi=!0,0)},movementY:function(e){if("movementY"in e)return e.movementY;var t=Ai;return Ai=e.screenY,Li?"mousemove"===e.type?e.screenY-t:0:(Li=!0,0)}}),Ri=Ni.extend({pointerId:null,width:null,height:null,pressure:null,tangentialPressure:null,tiltX:null,tiltY:null,twist:null,pointerType:null,isPrimary:null}),Di={mouseEnter:{registrationName:"onMouseEnter",dependencies:["mouseout","mouseover"]},mouseLeave:{registrationName:"onMouseLeave",dependencies:["mouseout","mouseover"]},pointerEnter:{registrationName:"onPointerEnter",dependencies:["pointerout","pointerover"]},pointerLeave:{registrationName:"onPointerLeave",dependencies:["pointerout","pointerover"]}},Mi={eventTypes:Di,extractEvents:function(e,t,n,i,r){var o="mouseover"===e||"pointerover"===e,s="mouseout"===e||"pointerout"===e;if(o&&!(32&r)&&(n.relatedTarget||n.fromElement)||!s&&!o)return null;if(o=i.window===i?i:(o=i.ownerDocument)?o.defaultView||o.parentWindow:window,s?(s=t,null!==(t=(t=n.relatedTarget||n.toElement)?Tn(t):null)&&(t!==Ye(t)||5!==t.tag&&6!==t.tag)&&(t=null)):s=null,s===t)return null;if("mouseout"===e||"mouseover"===e)var a=Ni,l=Di.mouseLeave,c=Di.mouseEnter,u="mouse";else"pointerout"!==e&&"pointerover"!==e||(a=Ri,l=Di.pointerLeave,c=Di.pointerEnter,u="pointer");if(e=null==s?o:In(s),o=null==t?o:In(t),(l=a.getPooled(l,s,n,i)).type=u+"leave",l.target=e,l.relatedTarget=o,(n=a.getPooled(c,t,n,i)).type=u+"enter",n.target=o,n.relatedTarget=e,u=t,(i=s)&&u)e:{for(c=u,s=0,e=a=i;e;e=On(e))s++;for(e=0,t=c;t;t=On(t))e++;for(;0<s-e;)a=On(a),s--;for(;0<e-s;)c=On(c),e--;for(;s--;){if(a===c||a===c.alternate)break e;a=On(a),c=On(c)}a=null}else a=null;for(c=a,a=[];i&&i!==c&&(null===(s=i.alternate)||s!==c);)a.push(i),i=On(i);for(i=[];u&&u!==c&&(null===(s=u.alternate)||s!==c);)i.push(u),u=On(u);for(u=0;u<a.length;u++)Dn(a[u],"bubbled",l);for(u=i.length;0<u--;)Dn(i[u],"captured",n);return 64&r?[l,n]:[l]}},Fi="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},Bi=Object.prototype.hasOwnProperty;function Ui(e,t){if(Fi(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++)if(!Bi.call(t,n[i])||!Fi(e[n[i]],t[n[i]]))return!1;return!0}var ji=C&&"documentMode"in document&&11>=document.documentMode,zi={select:{phasedRegistrationNames:{bubbled:"onSelect",captured:"onSelectCapture"},dependencies:"blur contextmenu dragend focus keydown keyup mousedown mouseup selectionchange".split(" ")}},Vi=null,Wi=null,Hi=null,$i=!1;function Gi(e,t){var n=t.window===t?t.document:9===t.nodeType?t:t.ownerDocument;return $i||null==Vi||Vi!==on(n)?null:(n="selectionStart"in(n=Vi)&&un(n)?{start:n.selectionStart,end:n.selectionEnd}:{anchorNode:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset},Hi&&Ui(Hi,n)?null:(Hi=n,(e=Hn.getPooled(zi.select,Wi,e,t)).type="select",e.target=Vi,Fn(e),e))}var qi={eventTypes:zi,extractEvents:function(e,t,n,i,r,o){if(!(o=!(r=o||(i.window===i?i.document:9===i.nodeType?i:i.ownerDocument)))){e:{r=qe(r),o=x.onSelect;for(var s=0;s<o.length;s++)if(!r.has(o[s])){r=!1;break e}r=!0}o=!r}if(o)return null;switch(r=t?In(t):window,e){case"focus":(ci(r)||"true"===r.contentEditable)&&(Vi=r,Wi=t,Hi=null);break;case"blur":Hi=Wi=Vi=null;break;case"mousedown":$i=!0;break;case"contextmenu":case"mouseup":case"dragend":return $i=!1,Gi(n,i);case"selectionchange":if(ji)break;case"keydown":case"keyup":return Gi(n,i)}return null}},Yi=Hn.extend({animationName:null,elapsedTime:null,pseudoElement:null}),Ki=Hn.extend({clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Xi=_i.extend({relatedTarget:null});function Qi(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}var Zi={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ji={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},er=_i.extend({key:function(e){if(e.key){var t=Zi[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=Qi(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?Ji[e.keyCode]||"Unidentified":""},location:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,repeat:null,locale:null,getModifierState:Pi,charCode:function(e){return"keypress"===e.type?Qi(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?Qi(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),tr=Ni.extend({dataTransfer:null}),nr=_i.extend({touches:null,targetTouches:null,changedTouches:null,altKey:null,metaKey:null,ctrlKey:null,shiftKey:null,getModifierState:Pi}),ir=Hn.extend({propertyName:null,elapsedTime:null,pseudoElement:null}),rr=Ni.extend({deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:null,deltaMode:null}),or={eventTypes:Lt,extractEvents:function(e,t,n,i){var r=Nt.get(e);if(!r)return null;switch(e){case"keypress":if(0===Qi(n))return null;case"keydown":case"keyup":e=er;break;case"blur":case"focus":e=Xi;break;case"click":if(2===n.button)return null;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":e=Ni;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":e=tr;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":e=nr;break;case ze:case Ve:case We:e=Yi;break;case He:e=ir;break;case"scroll":e=_i;break;case"wheel":e=rr;break;case"copy":case"cut":case"paste":e=Ki;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":e=Ri;break;default:e=Hn}return Fn(t=e.getPooled(r,t,n,i)),t}};if(g)throw Error(i(101));g=Array.prototype.slice.call("ResponderEventPlugin SimpleEventPlugin EnterLeaveEventPlugin ChangeEventPlugin SelectEventPlugin BeforeInputEventPlugin".split(" ")),y(),d=An,h=Pn,p=In,S({SimpleEventPlugin:or,EnterLeaveEventPlugin:Mi,ChangeEventPlugin:Ci,SelectEventPlugin:qi,BeforeInputEventPlugin:ai});var sr=[],ar=-1;function lr(e){0>ar||(e.current=sr[ar],sr[ar]=null,ar--)}function cr(e,t){ar++,sr[ar]=e.current,e.current=t}var ur={},dr={current:ur},hr={current:!1},pr=ur;function fr(e,t){var n=e.type.contextTypes;if(!n)return ur;var i=e.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===t)return i.__reactInternalMemoizedMaskedChildContext;var r,o={};for(r in n)o[r]=t[r];return i&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=o),o}function gr(e){return null!=e.childContextTypes}function mr(){lr(hr),lr(dr)}function yr(e,t,n){if(dr.current!==ur)throw Error(i(168));cr(dr,t),cr(hr,n)}function vr(e,n,r){var o=e.stateNode;if(e=n.childContextTypes,"function"!=typeof o.getChildContext)return r;for(var s in o=o.getChildContext())if(!(s in e))throw Error(i(108,pe(n)||"Unknown",s));return t({},r,{},o)}function br(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||ur,pr=dr.current,cr(dr,e),cr(hr,hr.current),!0}function wr(e,t,n){var r=e.stateNode;if(!r)throw Error(i(169));n?(e=vr(e,t,pr),r.__reactInternalMemoizedMergedChildContext=e,lr(hr),lr(dr),cr(dr,e)):lr(hr),cr(hr,n)}var kr=n.unstable_runWithPriority,xr=n.unstable_scheduleCallback,Sr=n.unstable_cancelCallback,Cr=n.unstable_requestPaint,_r=n.unstable_now,Er=n.unstable_getCurrentPriorityLevel,Tr=n.unstable_ImmediatePriority,Pr=n.unstable_UserBlockingPriority,Ir=n.unstable_NormalPriority,Ar=n.unstable_LowPriority,Or=n.unstable_IdlePriority,Lr={},Nr=n.unstable_shouldYield,Rr=void 0!==Cr?Cr:function(){},Dr=null,Mr=null,Fr=!1,Br=_r(),Ur=1e4>Br?_r:function(){return _r()-Br};function jr(){switch(Er()){case Tr:return 99;case Pr:return 98;case Ir:return 97;case Ar:return 96;case Or:return 95;default:throw Error(i(332))}}function zr(e){switch(e){case 99:return Tr;case 98:return Pr;case 97:return Ir;case 96:return Ar;case 95:return Or;default:throw Error(i(332))}}function Vr(e,t){return e=zr(e),kr(e,t)}function Wr(e,t,n){return e=zr(e),xr(e,t,n)}function Hr(e){return null===Dr?(Dr=[e],Mr=xr(Tr,Gr)):Dr.push(e),Lr}function $r(){if(null!==Mr){var e=Mr;Mr=null,Sr(e)}Gr()}function Gr(){if(!Fr&&null!==Dr){Fr=!0;var e=0;try{var t=Dr;Vr(99,(function(){for(;e<t.length;e++){var n=t[e];do{n=n(!0)}while(null!==n)}})),Dr=null}catch(t){throw null!==Dr&&(Dr=Dr.slice(e+1)),xr(Tr,$r),t}finally{Fr=!1}}}function qr(e,t,n){return 1073741821-(1+((1073741821-e+t/10)/(n/=10)|0))*n}function Yr(e,n){if(e&&e.defaultProps)for(var i in n=t({},n),e=e.defaultProps)void 0===n[i]&&(n[i]=e[i]);return n}var Kr={current:null},Xr=null,Qr=null,Zr=null;function Jr(){Zr=Qr=Xr=null}function eo(e){var t=Kr.current;lr(Kr),e.type._context._currentValue=t}function to(e,t){for(;null!==e;){var n=e.alternate;if(e.childExpirationTime<t)e.childExpirationTime=t,null!==n&&n.childExpirationTime<t&&(n.childExpirationTime=t);else{if(!(null!==n&&n.childExpirationTime<t))break;n.childExpirationTime=t}e=e.return}}function no(e,t){Xr=e,Zr=Qr=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(e.expirationTime>=t&&(As=!0),e.firstContext=null)}function io(e,t){if(Zr!==e&&!1!==t&&0!==t)if("number"==typeof t&&1073741823!==t||(Zr=e,t=1073741823),t={context:e,observedBits:t,next:null},null===Qr){if(null===Xr)throw Error(i(308));Qr=t,Xr.dependencies={expirationTime:0,firstContext:t,responders:null}}else Qr=Qr.next=t;return e._currentValue}var ro=!1;function oo(e){e.updateQueue={baseState:e.memoizedState,baseQueue:null,shared:{pending:null},effects:null}}function so(e,t){t.updateQueue===(e=e.updateQueue)&&(t.updateQueue={baseState:e.baseState,baseQueue:e.baseQueue,shared:e.shared,effects:e.effects})}function ao(e,t){return(e={expirationTime:e,suspenseConfig:t,tag:0,payload:null,callback:null,next:null}).next=e}function lo(e,t){if(null!==(e=e.updateQueue)){var n=(e=e.shared).pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}}function co(e,t){var n=e.alternate;null!==n&&so(n,e),null===(n=(e=e.updateQueue).baseQueue)?(e.baseQueue=t.next=t,t.next=t):(t.next=n.next,n.next=t)}function uo(e,n,i,r){var o=e.updateQueue;ro=!1;var s=o.baseQueue,a=o.shared.pending;if(null!==a){if(null!==s){var l=s.next;s.next=a.next,a.next=l}s=a,o.shared.pending=null,null!==(l=e.alternate)&&null!==(l=l.updateQueue)&&(l.baseQueue=a)}if(null!==s){var c=o.baseState,u=0,d=null,h=null,p=null;if(null!==(l=s.next))for(var f=l;;){if((a=f.expirationTime)<r){var g={expirationTime:f.expirationTime,suspenseConfig:f.suspenseConfig,tag:f.tag,payload:f.payload,callback:f.callback,next:null};null===p?(h=p=g,d=c):p=p.next=g,a>u&&(u=a)}else{null!==p&&(p=p.next={expirationTime:1073741823,suspenseConfig:f.suspenseConfig,tag:f.tag,payload:f.payload,callback:f.callback,next:null}),ml(a,f.suspenseConfig);e:{var m=e,y=f;switch(a=n,g=i,y.tag){case 1:if("function"==typeof(m=y.payload)){c=m.call(g,c,a);break e}c=m;break e;case 3:m.effectTag=-4097&m.effectTag|64;case 0:if(null==(a="function"==typeof(m=y.payload)?m.call(g,c,a):m))break e;c=t({},c,a);break e;case 2:ro=!0}}null!==f.callback&&(e.effectTag|=32,null===(a=o.effects)?o.effects=[f]:a.push(f))}if(null===(f=f.next)||f===l){if(null===(a=o.shared.pending))break;f=s.next=a.next,a.next=l,o.baseQueue=s=a,o.shared.pending=null}}null===p?d=c:p.next=h,o.baseState=d,o.baseQueue=p,yl(u),e.expirationTime=u,e.memoizedState=c}}function ho(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],o=r.callback;if(null!==o){if(r.callback=null,r=o,o=n,"function"!=typeof r)throw Error(i(191,r));r.call(o)}}}var po=q.ReactCurrentBatchConfig,fo=(new e.Component).refs;function go(e,n,i,r){i=null==(i=i(r,n=e.memoizedState))?n:t({},n,i),e.memoizedState=i,0===e.expirationTime&&(e.updateQueue.baseState=i)}var mo={isMounted:function(e){return!!(e=e._reactInternalFiber)&&Ye(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternalFiber;var i=il(),r=po.suspense;(r=ao(i=rl(i,e,r),r)).payload=t,null!=n&&(r.callback=n),lo(e,r),ol(e,i)},enqueueReplaceState:function(e,t,n){e=e._reactInternalFiber;var i=il(),r=po.suspense;(r=ao(i=rl(i,e,r),r)).tag=1,r.payload=t,null!=n&&(r.callback=n),lo(e,r),ol(e,i)},enqueueForceUpdate:function(e,t){e=e._reactInternalFiber;var n=il(),i=po.suspense;(i=ao(n=rl(n,e,i),i)).tag=2,null!=t&&(i.callback=t),lo(e,i),ol(e,n)}};function yo(e,t,n,i,r,o,s){return"function"==typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(i,o,s):!(t.prototype&&t.prototype.isPureReactComponent&&Ui(n,i)&&Ui(r,o))}function vo(e,t,n){var i=!1,r=ur,o=t.contextType;return"object"==typeof o&&null!==o?o=io(o):(r=gr(t)?pr:dr.current,o=(i=null!=(i=t.contextTypes))?fr(e,r):ur),t=new t(n,o),e.memoizedState=null!=t.state?t.state:null,t.updater=mo,e.stateNode=t,t._reactInternalFiber=e,i&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=r,e.__reactInternalMemoizedMaskedChildContext=o),t}function bo(e,t,n,i){e=t.state,"function"==typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,i),"function"==typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,i),t.state!==e&&mo.enqueueReplaceState(t,t.state,null)}function wo(e,t,n,i){var r=e.stateNode;r.props=n,r.state=e.memoizedState,r.refs=fo,oo(e);var o=t.contextType;"object"==typeof o&&null!==o?r.context=io(o):(o=gr(t)?pr:dr.current,r.context=fr(e,o)),uo(e,n,r,i),r.state=e.memoizedState,"function"==typeof(o=t.getDerivedStateFromProps)&&(go(e,t,o,n),r.state=e.memoizedState),"function"==typeof t.getDerivedStateFromProps||"function"==typeof r.getSnapshotBeforeUpdate||"function"!=typeof r.UNSAFE_componentWillMount&&"function"!=typeof r.componentWillMount||(t=r.state,"function"==typeof r.componentWillMount&&r.componentWillMount(),"function"==typeof r.UNSAFE_componentWillMount&&r.UNSAFE_componentWillMount(),t!==r.state&&mo.enqueueReplaceState(r,r.state,null),uo(e,n,r,i),r.state=e.memoizedState),"function"==typeof r.componentDidMount&&(e.effectTag|=4)}var ko=Array.isArray;function xo(e,t,n){if(null!==(e=n.ref)&&"function"!=typeof e&&"object"!=typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(i(309));var r=n.stateNode}if(!r)throw Error(i(147,e));var o=""+e;return null!==t&&null!==t.ref&&"function"==typeof t.ref&&t.ref._stringRef===o?t.ref:(t=function(e){var t=r.refs;t===fo&&(t=r.refs={}),null===e?delete t[o]:t[o]=e},t._stringRef=o,t)}if("string"!=typeof e)throw Error(i(284));if(!n._owner)throw Error(i(290,e))}return e}function So(e,t){if("textarea"!==e.type)throw Error(i(31,"[object Object]"===Object.prototype.toString.call(t)?"object with keys {"+Object.keys(t).join(", ")+"}":t,""))}function Co(e){function t(t,n){if(e){var i=t.lastEffect;null!==i?(i.nextEffect=n,t.lastEffect=n):t.firstEffect=t.lastEffect=n,n.nextEffect=null,n.effectTag=8}}function n(n,i){if(!e)return null;for(;null!==i;)t(n,i),i=i.sibling;return null}function r(e,t){for(e=new Map;null!==t;)e.set(null!==t.key?t.key:t.index,t),t=t.sibling;return e}function o(e,t){return(e=Fl(e,t)).index=0,e.sibling=null,e}function s(t,n,i){return t.index=i,e?null!==(i=t.alternate)?(i=i.index)<n?(t.effectTag=2,n):i:(t.effectTag=2,n):n}function a(t){return e&&null===t.alternate&&(t.effectTag=2),t}function l(e,t,n,i){return null===t||6!==t.tag?((t=jl(n,e.mode,i)).return=e,t):((t=o(t,n)).return=e,t)}function c(e,t,n,i){return null!==t&&t.elementType===n.type?((i=o(t,n.props)).ref=xo(e,t,n),i.return=e,i):((i=Bl(n.type,n.key,n.props,null,e.mode,i)).ref=xo(e,t,n),i.return=e,i)}function u(e,t,n,i){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=zl(n,e.mode,i)).return=e,t):((t=o(t,n.children||[])).return=e,t)}function d(e,t,n,i,r){return null===t||7!==t.tag?((t=Ul(n,e.mode,i,r)).return=e,t):((t=o(t,n)).return=e,t)}function h(e,t,n){if("string"==typeof t||"number"==typeof t)return(t=jl(""+t,e.mode,n)).return=e,t;if("object"==typeof t&&null!==t){switch(t.$$typeof){case Q:return(n=Bl(t.type,t.key,t.props,null,e.mode,n)).ref=xo(e,null,t),n.return=e,n;case Z:return(t=zl(t,e.mode,n)).return=e,t}if(ko(t)||he(t))return(t=Ul(t,e.mode,n,null)).return=e,t;So(e,t)}return null}function p(e,t,n,i){var r=null!==t?t.key:null;if("string"==typeof n||"number"==typeof n)return null!==r?null:l(e,t,""+n,i);if("object"==typeof n&&null!==n){switch(n.$$typeof){case Q:return n.key===r?n.type===J?d(e,t,n.props.children,i,r):c(e,t,n,i):null;case Z:return n.key===r?u(e,t,n,i):null}if(ko(n)||he(n))return null!==r?null:d(e,t,n,i,null);So(e,n)}return null}function f(e,t,n,i,r){if("string"==typeof i||"number"==typeof i)return l(t,e=e.get(n)||null,""+i,r);if("object"==typeof i&&null!==i){switch(i.$$typeof){case Q:return e=e.get(null===i.key?n:i.key)||null,i.type===J?d(t,e,i.props.children,r,i.key):c(t,e,i,r);case Z:return u(t,e=e.get(null===i.key?n:i.key)||null,i,r)}if(ko(i)||he(i))return d(t,e=e.get(n)||null,i,r,null);So(t,i)}return null}function g(i,o,a,l){for(var c=null,u=null,d=o,g=o=0,m=null;null!==d&&g<a.length;g++){d.index>g?(m=d,d=null):m=d.sibling;var y=p(i,d,a[g],l);if(null===y){null===d&&(d=m);break}e&&d&&null===y.alternate&&t(i,d),o=s(y,o,g),null===u?c=y:u.sibling=y,u=y,d=m}if(g===a.length)return n(i,d),c;if(null===d){for(;g<a.length;g++)null!==(d=h(i,a[g],l))&&(o=s(d,o,g),null===u?c=d:u.sibling=d,u=d);return c}for(d=r(i,d);g<a.length;g++)null!==(m=f(d,i,g,a[g],l))&&(e&&null!==m.alternate&&d.delete(null===m.key?g:m.key),o=s(m,o,g),null===u?c=m:u.sibling=m,u=m);return e&&d.forEach((function(e){return t(i,e)})),c}function m(o,a,l,c){var u=he(l);if("function"!=typeof u)throw Error(i(150));if(null==(l=u.call(l)))throw Error(i(151));for(var d=u=null,g=a,m=a=0,y=null,v=l.next();null!==g&&!v.done;m++,v=l.next()){g.index>m?(y=g,g=null):y=g.sibling;var b=p(o,g,v.value,c);if(null===b){null===g&&(g=y);break}e&&g&&null===b.alternate&&t(o,g),a=s(b,a,m),null===d?u=b:d.sibling=b,d=b,g=y}if(v.done)return n(o,g),u;if(null===g){for(;!v.done;m++,v=l.next())null!==(v=h(o,v.value,c))&&(a=s(v,a,m),null===d?u=v:d.sibling=v,d=v);return u}for(g=r(o,g);!v.done;m++,v=l.next())null!==(v=f(g,o,m,v.value,c))&&(e&&null!==v.alternate&&g.delete(null===v.key?m:v.key),a=s(v,a,m),null===d?u=v:d.sibling=v,d=v);return e&&g.forEach((function(e){return t(o,e)})),u}return function(e,r,s,l){var c="object"==typeof s&&null!==s&&s.type===J&&null===s.key;c&&(s=s.props.children);var u="object"==typeof s&&null!==s;if(u)switch(s.$$typeof){case Q:e:{for(u=s.key,c=r;null!==c;){if(c.key===u){if(7===c.tag){if(s.type===J){n(e,c.sibling),(r=o(c,s.props.children)).return=e,e=r;break e}}else if(c.elementType===s.type){n(e,c.sibling),(r=o(c,s.props)).ref=xo(e,c,s),r.return=e,e=r;break e}n(e,c);break}t(e,c),c=c.sibling}s.type===J?((r=Ul(s.props.children,e.mode,l,s.key)).return=e,e=r):((l=Bl(s.type,s.key,s.props,null,e.mode,l)).ref=xo(e,r,s),l.return=e,e=l)}return a(e);case Z:e:{for(c=s.key;null!==r;){if(r.key===c){if(4===r.tag&&r.stateNode.containerInfo===s.containerInfo&&r.stateNode.implementation===s.implementation){n(e,r.sibling),(r=o(r,s.children||[])).return=e,e=r;break e}n(e,r);break}t(e,r),r=r.sibling}(r=zl(s,e.mode,l)).return=e,e=r}return a(e)}if("string"==typeof s||"number"==typeof s)return s=""+s,null!==r&&6===r.tag?(n(e,r.sibling),(r=o(r,s)).return=e,e=r):(n(e,r),(r=jl(s,e.mode,l)).return=e,e=r),a(e);if(ko(s))return g(e,r,s,l);if(he(s))return m(e,r,s,l);if(u&&So(e,s),void 0===s&&!c)switch(e.tag){case 1:case 0:throw e=e.type,Error(i(152,e.displayName||e.name||"Component"))}return n(e,r)}}var _o=Co(!0),Eo=Co(!1),To={},Po={current:To},Io={current:To},Ao={current:To};function Oo(e){if(e===To)throw Error(i(174));return e}function Lo(e,t){switch(cr(Ao,t),cr(Io,e),cr(Po,To),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Le(null,"");break;default:t=Le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}lr(Po),cr(Po,t)}function No(){lr(Po),lr(Io),lr(Ao)}function Ro(e){Oo(Ao.current);var t=Oo(Po.current),n=Le(t,e.type);t!==n&&(cr(Io,e),cr(Po,n))}function Do(e){Io.current===e&&(lr(Po),lr(Io))}var Mo={current:0};function Fo(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||n.data===pn||n.data===fn))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(64&t.effectTag)return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}function Bo(e,t){return{responder:e,props:t}}var Uo=q.ReactCurrentDispatcher,jo=q.ReactCurrentBatchConfig,zo=0,Vo=null,Wo=null,Ho=null,$o=!1;function Go(){throw Error(i(321))}function qo(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Fi(e[n],t[n]))return!1;return!0}function Yo(e,t,n,r,o,s){if(zo=s,Vo=t,t.memoizedState=null,t.updateQueue=null,t.expirationTime=0,Uo.current=null===e||null===e.memoizedState?ys:vs,e=n(r,o),t.expirationTime===zo){s=0;do{if(t.expirationTime=0,!(25>s))throw Error(i(301));s+=1,Ho=Wo=null,t.updateQueue=null,Uo.current=bs,e=n(r,o)}while(t.expirationTime===zo)}if(Uo.current=ms,t=null!==Wo&&null!==Wo.next,zo=0,Ho=Wo=Vo=null,$o=!1,t)throw Error(i(300));return e}function Ko(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===Ho?Vo.memoizedState=Ho=e:Ho=Ho.next=e,Ho}function Xo(){if(null===Wo){var e=Vo.alternate;e=null!==e?e.memoizedState:null}else e=Wo.next;var t=null===Ho?Vo.memoizedState:Ho.next;if(null!==t)Ho=t,Wo=e;else{if(null===e)throw Error(i(310));e={memoizedState:(Wo=e).memoizedState,baseState:Wo.baseState,baseQueue:Wo.baseQueue,queue:Wo.queue,next:null},null===Ho?Vo.memoizedState=Ho=e:Ho=Ho.next=e}return Ho}function Qo(e,t){return"function"==typeof t?t(e):t}function Zo(e){var t=Xo(),n=t.queue;if(null===n)throw Error(i(311));n.lastRenderedReducer=e;var r=Wo,o=r.baseQueue,s=n.pending;if(null!==s){if(null!==o){var a=o.next;o.next=s.next,s.next=a}r.baseQueue=o=s,n.pending=null}if(null!==o){r=r.baseState;var l=a=s=null,c=o=o.next;do{var u=c.expirationTime;if(u<zo){var d={expirationTime:c.expirationTime,suspenseConfig:c.suspenseConfig,action:c.action,eagerReducer:c.eagerReducer,eagerState:c.eagerState,next:null};null===l?(a=l=d,s=r):l=l.next=d,u>Vo.expirationTime&&(Vo.expirationTime=u,yl(u))}else null!==l&&(l=l.next={expirationTime:1073741823,suspenseConfig:c.suspenseConfig,action:c.action,eagerReducer:c.eagerReducer,eagerState:c.eagerState,next:null}),ml(u,c.suspenseConfig),r=c.eagerReducer===e?c.eagerState:e(r,c.action);c=c.next}while(null!==c&&c!==o);null===l?s=r:l.next=a,Fi(r,t.memoizedState)||(As=!0),t.memoizedState=r,t.baseState=s,t.baseQueue=l,n.lastRenderedState=r}return[t.memoizedState,n.dispatch]}function Jo(e){var t=Xo(),n=t.queue;if(null===n)throw Error(i(311));n.lastRenderedReducer=e;var r=n.dispatch,o=n.pending,s=t.memoizedState;if(null!==o){n.pending=null;var a=o=o.next;do{s=e(s,a.action),a=a.next}while(a!==o);Fi(s,t.memoizedState)||(As=!0),t.memoizedState=s,null===t.baseQueue&&(t.baseState=s),n.lastRenderedState=s}return[s,r]}function es(e){var t=Ko();return"function"==typeof e&&(e=e()),t.memoizedState=t.baseState=e,e=(e=t.queue={pending:null,dispatch:null,lastRenderedReducer:Qo,lastRenderedState:e}).dispatch=gs.bind(null,Vo,e),[t.memoizedState,e]}function ts(e,t,n,i){return e={tag:e,create:t,destroy:n,deps:i,next:null},null===(t=Vo.updateQueue)?(Vo.updateQueue=t={lastEffect:null},t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(i=n.next,n.next=e,e.next=i,t.lastEffect=e),e}function ns(){return Xo().memoizedState}function is(e,t,n,i){var r=Ko();Vo.effectTag|=e,r.memoizedState=ts(1|t,n,void 0,void 0===i?null:i)}function rs(e,t,n,i){var r=Xo();i=void 0===i?null:i;var o=void 0;if(null!==Wo){var s=Wo.memoizedState;if(o=s.destroy,null!==i&&qo(i,s.deps))return void ts(t,n,o,i)}Vo.effectTag|=e,r.memoizedState=ts(1|t,n,o,i)}function os(e,t){return is(516,4,e,t)}function ss(e,t){return rs(516,4,e,t)}function as(e,t){return rs(4,2,e,t)}function ls(e,t){return"function"==typeof t?(e=e(),t(e),function(){t(null)}):null!=t?(e=e(),t.current=e,function(){t.current=null}):void 0}function cs(e,t,n){return n=null!=n?n.concat([e]):null,rs(4,2,ls.bind(null,t,e),n)}function us(){}function ds(e,t){return Ko().memoizedState=[e,void 0===t?null:t],e}function hs(e,t){var n=Xo();t=void 0===t?null:t;var i=n.memoizedState;return null!==i&&null!==t&&qo(t,i[1])?i[0]:(n.memoizedState=[e,t],e)}function ps(e,t){var n=Xo();t=void 0===t?null:t;var i=n.memoizedState;return null!==i&&null!==t&&qo(t,i[1])?i[0]:(e=e(),n.memoizedState=[e,t],e)}function fs(e,t,n){var i=jr();Vr(98>i?98:i,(function(){e(!0)})),Vr(97<i?97:i,(function(){var i=jo.suspense;jo.suspense=void 0===t?null:t;try{e(!1),n()}finally{jo.suspense=i}}))}function gs(e,t,n){var i=il(),r=po.suspense;r={expirationTime:i=rl(i,e,r),suspenseConfig:r,action:n,eagerReducer:null,eagerState:null,next:null};var o=t.pending;if(null===o?r.next=r:(r.next=o.next,o.next=r),t.pending=r,o=e.alternate,e===Vo||null!==o&&o===Vo)$o=!0,r.expirationTime=zo,Vo.expirationTime=zo;else{if(0===e.expirationTime&&(null===o||0===o.expirationTime)&&null!==(o=t.lastRenderedReducer))try{var s=t.lastRenderedState,a=o(s,n);if(r.eagerReducer=o,r.eagerState=a,Fi(a,s))return}catch(e){}ol(e,i)}}var ms={readContext:io,useCallback:Go,useContext:Go,useEffect:Go,useImperativeHandle:Go,useLayoutEffect:Go,useMemo:Go,useReducer:Go,useRef:Go,useState:Go,useDebugValue:Go,useResponder:Go,useDeferredValue:Go,useTransition:Go},ys={readContext:io,useCallback:ds,useContext:io,useEffect:os,useImperativeHandle:function(e,t,n){return n=null!=n?n.concat([e]):null,is(4,2,ls.bind(null,t,e),n)},useLayoutEffect:function(e,t){return is(4,2,e,t)},useMemo:function(e,t){var n=Ko();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var i=Ko();return t=void 0!==n?n(t):t,i.memoizedState=i.baseState=t,e=(e=i.queue={pending:null,dispatch:null,lastRenderedReducer:e,lastRenderedState:t}).dispatch=gs.bind(null,Vo,e),[i.memoizedState,e]},useRef:function(e){return Ko().memoizedState={current:e}},useState:es,useDebugValue:us,useResponder:Bo,useDeferredValue:function(e,t){var n=es(e),i=n[0],r=n[1];return os((function(){var n=jo.suspense;jo.suspense=void 0===t?null:t;try{r(e)}finally{jo.suspense=n}}),[e,t]),i},useTransition:function(e){var t=es(!1),n=t[0];return[ds(fs.bind(null,t=t[1],e),[t,e]),n]}},vs={readContext:io,useCallback:hs,useContext:io,useEffect:ss,useImperativeHandle:cs,useLayoutEffect:as,useMemo:ps,useReducer:Zo,useRef:ns,useState:function(){return Zo(Qo)},useDebugValue:us,useResponder:Bo,useDeferredValue:function(e,t){var n=Zo(Qo),i=n[0],r=n[1];return ss((function(){var n=jo.suspense;jo.suspense=void 0===t?null:t;try{r(e)}finally{jo.suspense=n}}),[e,t]),i},useTransition:function(e){var t=Zo(Qo),n=t[0];return[hs(fs.bind(null,t=t[1],e),[t,e]),n]}},bs={readContext:io,useCallback:hs,useContext:io,useEffect:ss,useImperativeHandle:cs,useLayoutEffect:as,useMemo:ps,useReducer:Jo,useRef:ns,useState:function(){return Jo(Qo)},useDebugValue:us,useResponder:Bo,useDeferredValue:function(e,t){var n=Jo(Qo),i=n[0],r=n[1];return ss((function(){var n=jo.suspense;jo.suspense=void 0===t?null:t;try{r(e)}finally{jo.suspense=n}}),[e,t]),i},useTransition:function(e){var t=Jo(Qo),n=t[0];return[hs(fs.bind(null,t=t[1],e),[t,e]),n]}},ws=null,ks=null,xs=!1;function Ss(e,t){var n=Dl(5,null,null,0);n.elementType="DELETED",n.type="DELETED",n.stateNode=t,n.return=e,n.effectTag=8,null!==e.lastEffect?(e.lastEffect.nextEffect=n,e.lastEffect=n):e.firstEffect=e.lastEffect=n}function Cs(e,t){switch(e.tag){case 5:return null!==(t=1!==t.nodeType||e.type.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,!0);default:return!1}}function _s(e){if(xs){var t=ks;if(t){var n=t;if(!Cs(e,t)){if(!(t=kn(n.nextSibling))||!Cs(e,t))return e.effectTag=-1025&e.effectTag|2,xs=!1,void(ws=e);Ss(ws,n)}ws=e,ks=kn(t.firstChild)}else e.effectTag=-1025&e.effectTag|2,xs=!1,ws=e}}function Es(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ws=e}function Ts(e){if(e!==ws)return!1;if(!xs)return Es(e),xs=!0,!1;var t=e.type;if(5!==e.tag||"head"!==t&&"body"!==t&&!vn(t,e.memoizedProps))for(t=ks;t;)Ss(e,t),t=kn(t.nextSibling);if(Es(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(i(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if(n===hn){if(0===t){ks=kn(e.nextSibling);break e}t--}else n!==dn&&n!==fn&&n!==pn||t++}e=e.nextSibling}ks=null}}else ks=ws?kn(e.stateNode.nextSibling):null;return!0}function Ps(){ks=ws=null,xs=!1}var Is=q.ReactCurrentOwner,As=!1;function Os(e,t,n,i){t.child=null===e?Eo(t,null,n,i):_o(t,e.child,n,i)}function Ls(e,t,n,i,r){n=n.render;var o=t.ref;return no(t,r),i=Yo(e,t,n,i,o,r),null===e||As?(t.effectTag|=1,Os(e,t,i,r),t.child):(t.updateQueue=e.updateQueue,t.effectTag&=-517,e.expirationTime<=r&&(e.expirationTime=0),Ks(e,t,r))}function Ns(e,t,n,i,r,o){if(null===e){var s=n.type;return"function"!=typeof s||Ml(s)||void 0!==s.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Bl(n.type,null,i,null,t.mode,o)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=s,Rs(e,t,s,i,r,o))}return s=e.child,r<o&&(n=null!==(n=n.compare)?n:Ui)(r=s.memoizedProps,i)&&e.ref===t.ref?Ks(e,t,o):(t.effectTag|=1,(e=Fl(s,i)).ref=t.ref,e.return=t,t.child=e)}function Rs(e,t,n,i,r,o){return null!==e&&Ui(e.memoizedProps,i)&&e.ref===t.ref&&(As=!1,r<o)?(t.expirationTime=e.expirationTime,Ks(e,t,o)):Ms(e,t,n,i,o)}function Ds(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.effectTag|=128)}function Ms(e,t,n,i,r){var o=gr(n)?pr:dr.current;return o=fr(t,o),no(t,r),n=Yo(e,t,n,i,o,r),null===e||As?(t.effectTag|=1,Os(e,t,n,r),t.child):(t.updateQueue=e.updateQueue,t.effectTag&=-517,e.expirationTime<=r&&(e.expirationTime=0),Ks(e,t,r))}function Fs(e,t,n,i,r){if(gr(n)){var o=!0;br(t)}else o=!1;if(no(t,r),null===t.stateNode)null!==e&&(e.alternate=null,t.alternate=null,t.effectTag|=2),vo(t,n,i),wo(t,n,i,r),i=!0;else if(null===e){var s=t.stateNode,a=t.memoizedProps;s.props=a;var l=s.context,c=n.contextType;c="object"==typeof c&&null!==c?io(c):fr(t,c=gr(n)?pr:dr.current);var u=n.getDerivedStateFromProps,d="function"==typeof u||"function"==typeof s.getSnapshotBeforeUpdate;d||"function"!=typeof s.UNSAFE_componentWillReceiveProps&&"function"!=typeof s.componentWillReceiveProps||(a!==i||l!==c)&&bo(t,s,i,c),ro=!1;var h=t.memoizedState;s.state=h,uo(t,i,s,r),l=t.memoizedState,a!==i||h!==l||hr.current||ro?("function"==typeof u&&(go(t,n,u,i),l=t.memoizedState),(a=ro||yo(t,n,a,i,h,l,c))?(d||"function"!=typeof s.UNSAFE_componentWillMount&&"function"!=typeof s.componentWillMount||("function"==typeof s.componentWillMount&&s.componentWillMount(),"function"==typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount()),"function"==typeof s.componentDidMount&&(t.effectTag|=4)):("function"==typeof s.componentDidMount&&(t.effectTag|=4),t.memoizedProps=i,t.memoizedState=l),s.props=i,s.state=l,s.context=c,i=a):("function"==typeof s.componentDidMount&&(t.effectTag|=4),i=!1)}else s=t.stateNode,so(e,t),a=t.memoizedProps,s.props=t.type===t.elementType?a:Yr(t.type,a),l=s.context,c="object"==typeof(c=n.contextType)&&null!==c?io(c):fr(t,c=gr(n)?pr:dr.current),(d="function"==typeof(u=n.getDerivedStateFromProps)||"function"==typeof s.getSnapshotBeforeUpdate)||"function"!=typeof s.UNSAFE_componentWillReceiveProps&&"function"!=typeof s.componentWillReceiveProps||(a!==i||l!==c)&&bo(t,s,i,c),ro=!1,s.state=l=t.memoizedState,uo(t,i,s,r),h=t.memoizedState,a!==i||l!==h||hr.current||ro?("function"==typeof u&&(go(t,n,u,i),h=t.memoizedState),(u=ro||yo(t,n,a,i,l,h,c))?(d||"function"!=typeof s.UNSAFE_componentWillUpdate&&"function"!=typeof s.componentWillUpdate||("function"==typeof s.componentWillUpdate&&s.componentWillUpdate(i,h,c),"function"==typeof s.UNSAFE_componentWillUpdate&&s.UNSAFE_componentWillUpdate(i,h,c)),"function"==typeof s.componentDidUpdate&&(t.effectTag|=4),"function"==typeof s.getSnapshotBeforeUpdate&&(t.effectTag|=256)):("function"!=typeof s.componentDidUpdate||a===e.memoizedProps&&l===e.memoizedState||(t.effectTag|=4),"function"!=typeof s.getSnapshotBeforeUpdate||a===e.memoizedProps&&l===e.memoizedState||(t.effectTag|=256),t.memoizedProps=i,t.memoizedState=h),s.props=i,s.state=h,s.context=c,i=u):("function"!=typeof s.componentDidUpdate||a===e.memoizedProps&&l===e.memoizedState||(t.effectTag|=4),"function"!=typeof s.getSnapshotBeforeUpdate||a===e.memoizedProps&&l===e.memoizedState||(t.effectTag|=256),i=!1);return Bs(e,t,n,i,o,r)}function Bs(e,t,n,i,r,o){Ds(e,t);var s=!!(64&t.effectTag);if(!i&&!s)return r&&wr(t,n,!1),Ks(e,t,o);i=t.stateNode,Is.current=t;var a=s&&"function"!=typeof n.getDerivedStateFromError?null:i.render();return t.effectTag|=1,null!==e&&s?(t.child=_o(t,e.child,null,o),t.child=_o(t,null,a,o)):Os(e,t,a,o),t.memoizedState=i.state,r&&wr(t,n,!0),t.child}function Us(e){var t=e.stateNode;t.pendingContext?yr(0,t.pendingContext,t.pendingContext!==t.context):t.context&&yr(0,t.context,!1),Lo(e,t.containerInfo)}var js,zs,Vs,Ws,Hs={dehydrated:null,retryTime:0};function $s(e,t,n){var i,r=t.mode,o=t.pendingProps,s=Mo.current,a=!1;if((i=!!(64&t.effectTag))||(i=!!(2&s)&&(null===e||null!==e.memoizedState)),i?(a=!0,t.effectTag&=-65):null!==e&&null===e.memoizedState||void 0===o.fallback||!0===o.unstable_avoidThisFallback||(s|=1),cr(Mo,1&s),null===e){if(void 0!==o.fallback&&_s(t),a){if(a=o.fallback,(o=Ul(null,r,0,null)).return=t,!(2&t.mode))for(o.child=e=null!==t.memoizedState?t.child.child:t.child;null!==e;)e.return=o,e=e.sibling;return(n=Ul(a,r,n,null)).return=t,o.sibling=n,t.memoizedState=Hs,t.child=o,n}return r=o.children,t.memoizedState=null,t.child=Eo(t,null,r,n)}if(null!==e.memoizedState){if(r=(e=e.child).sibling,a){if(o=o.fallback,(n=Fl(e,e.pendingProps)).return=t,!(2&t.mode)&&(a=null!==t.memoizedState?t.child.child:t.child)!==e.child)for(n.child=a;null!==a;)a.return=n,a=a.sibling;return(r=Fl(r,o)).return=t,n.sibling=r,n.childExpirationTime=0,t.memoizedState=Hs,t.child=n,r}return n=_o(t,e.child,o.children,n),t.memoizedState=null,t.child=n}if(e=e.child,a){if(a=o.fallback,(o=Ul(null,r,0,null)).return=t,o.child=e,null!==e&&(e.return=o),!(2&t.mode))for(o.child=e=null!==t.memoizedState?t.child.child:t.child;null!==e;)e.return=o,e=e.sibling;return(n=Ul(a,r,n,null)).return=t,o.sibling=n,n.effectTag|=2,o.childExpirationTime=0,t.memoizedState=Hs,t.child=o,n}return t.memoizedState=null,t.child=_o(t,e,o.children,n)}function Gs(e,t){e.expirationTime<t&&(e.expirationTime=t);var n=e.alternate;null!==n&&n.expirationTime<t&&(n.expirationTime=t),to(e.return,t)}function qs(e,t,n,i,r,o){var s=e.memoizedState;null===s?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:n,tailExpiration:0,tailMode:r,lastEffect:o}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=i,s.tail=n,s.tailExpiration=0,s.tailMode=r,s.lastEffect=o)}function Ys(e,t,n){var i=t.pendingProps,r=i.revealOrder,o=i.tail;if(Os(e,t,i.children,n),2&(i=Mo.current))i=1&i|2,t.effectTag|=64;else{if(null!==e&&64&e.effectTag)e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Gs(e,n);else if(19===e.tag)Gs(e,n);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}i&=1}if(cr(Mo,i),2&t.mode)switch(r){case"forwards":for(n=t.child,r=null;null!==n;)null!==(e=n.alternate)&&null===Fo(e)&&(r=n),n=n.sibling;null===(n=r)?(r=t.child,t.child=null):(r=n.sibling,n.sibling=null),qs(t,!1,r,n,o,t.lastEffect);break;case"backwards":for(n=null,r=t.child,t.child=null;null!==r;){if(null!==(e=r.alternate)&&null===Fo(e)){t.child=r;break}e=r.sibling,r.sibling=n,n=r,r=e}qs(t,!0,n,null,o,t.lastEffect);break;case"together":qs(t,!1,null,null,void 0,t.lastEffect);break;default:t.memoizedState=null}else t.memoizedState=null;return t.child}function Ks(e,t,n){null!==e&&(t.dependencies=e.dependencies);var r=t.expirationTime;if(0!==r&&yl(r),t.childExpirationTime<n)return null;if(null!==e&&t.child!==e.child)throw Error(i(153));if(null!==t.child){for(n=Fl(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)(n=n.sibling=Fl(e=e.sibling,e.pendingProps)).return=t;n.sibling=null}return t.child}function Xs(e,t){switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var i=null;null!==n;)null!==n.alternate&&(i=n),n=n.sibling;null===i?t||null===e.tail?e.tail=null:e.tail.sibling=null:i.sibling=null}}function Qs(e,n,r){var o=n.pendingProps;switch(n.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return null;case 1:case 17:return gr(n.type)&&mr(),null;case 3:return No(),lr(hr),lr(dr),(r=n.stateNode).pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||!Ts(n)||(n.effectTag|=4),zs(n),null;case 5:Do(n),r=Oo(Ao.current);var s=n.type;if(null!==e&&null!=n.stateNode)Vs(e,n,s,o,r),e.ref!==n.ref&&(n.effectTag|=128);else{if(!o){if(null===n.stateNode)throw Error(i(166));return null}if(e=Oo(Po.current),Ts(n)){s=n.type;var a=n.memoizedProps;switch((o=n.stateNode)[Cn]=n,o[_n]=a,s){case"iframe":case"object":case"embed":Vt("load",o);break;case"video":case"audio":for(e=0;e<$e.length;e++)Vt($e[e],o);break;case"source":Vt("error",o);break;case"img":case"image":case"link":Vt("error",o),Vt("load",o);break;case"form":Vt("reset",o),Vt("submit",o);break;case"details":Vt("toggle",o);break;case"input":we(o,a),Vt("invalid",o),nn(r,"onChange");break;case"select":o._wrapperState={wasMultiple:!!a.multiple},Vt("invalid",o),nn(r,"onChange");break;case"textarea":Pe(o,a),Vt("invalid",o),nn(r,"onChange")}for(var l in Jt(s,a),e=null,a)if(a.hasOwnProperty(l)){var c=a[l];"children"===l?"string"==typeof c?o.textContent!==c&&(e=["children",c]):"number"==typeof c&&o.textContent!==""+c&&(e=["children",""+c]):k.hasOwnProperty(l)&&null!=c&&nn(r,l)}switch(s){case"input":ye(o),Se(o,a,!0);break;case"textarea":ye(o),Ae(o);break;case"select":case"option":break;default:"function"==typeof a.onClick&&(o.onclick=rn)}n.updateQueue=r=e,null!==r&&(n.effectTag|=4)}else{switch(l=9===r.nodeType?r:r.ownerDocument,e===tn&&(e=Oe(s)),e===tn?"script"===s?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"==typeof o.is?e=l.createElement(s,{is:o.is}):(e=l.createElement(s),"select"===s&&(l=e,o.multiple?l.multiple=!0:o.size&&(l.size=o.size))):e=l.createElementNS(e,s),e[Cn]=n,e[_n]=o,js(e,n,!1,!1),n.stateNode=e,l=en(s,o),s){case"iframe":case"object":case"embed":Vt("load",e),c=o;break;case"video":case"audio":for(c=0;c<$e.length;c++)Vt($e[c],e);c=o;break;case"source":Vt("error",e),c=o;break;case"img":case"image":case"link":Vt("error",e),Vt("load",e),c=o;break;case"form":Vt("reset",e),Vt("submit",e),c=o;break;case"details":Vt("toggle",e),c=o;break;case"input":we(e,o),c=be(e,o),Vt("invalid",e),nn(r,"onChange");break;case"option":c=_e(e,o);break;case"select":e._wrapperState={wasMultiple:!!o.multiple},c=t({},o,{value:void 0}),Vt("invalid",e),nn(r,"onChange");break;case"textarea":Pe(e,o),c=Te(e,o),Vt("invalid",e),nn(r,"onChange");break;default:c=o}Jt(s,c);var u=c;for(a in u)if(u.hasOwnProperty(a)){var d=u[a];"style"===a?Qt(e,d):"dangerouslySetInnerHTML"===a?null!=(d=d?d.__html:void 0)&&Re(e,d):"children"===a?"string"==typeof d?("textarea"!==s||""!==d)&&De(e,d):"number"==typeof d&&De(e,""+d):"suppressContentEditableWarning"!==a&&"suppressHydrationWarning"!==a&&"autoFocus"!==a&&(k.hasOwnProperty(a)?null!=d&&nn(r,a):null!=d&&Y(e,a,d,l))}switch(s){case"input":ye(e),Se(e,o,!1);break;case"textarea":ye(e),Ae(e);break;case"option":null!=o.value&&e.setAttribute("value",""+ge(o.value));break;case"select":e.multiple=!!o.multiple,null!=(r=o.value)?Ee(e,!!o.multiple,r,!1):null!=o.defaultValue&&Ee(e,!!o.multiple,o.defaultValue,!0);break;default:"function"==typeof c.onClick&&(e.onclick=rn)}yn(s,o)&&(n.effectTag|=4)}null!==n.ref&&(n.effectTag|=128)}return null;case 6:if(e&&null!=n.stateNode)Ws(e,n,e.memoizedProps,o);else{if("string"!=typeof o&&null===n.stateNode)throw Error(i(166));r=Oo(Ao.current),Oo(Po.current),Ts(n)?(o=n.memoizedProps,(r=n.stateNode)[Cn]=n,r.nodeValue!==o&&(n.effectTag|=4)):((r=(9===r.nodeType?r:r.ownerDocument).createTextNode(o))[Cn]=n,n.stateNode=r)}return null;case 13:return lr(Mo),o=n.memoizedState,64&n.effectTag?(n.expirationTime=r,n):(r=null!==o,o=!1,null===e?void 0!==n.memoizedProps.fallback&&Ts(n):(o=null!==(s=e.memoizedState),r||null===s||null!==(s=e.child.sibling)&&(null!==(a=n.firstEffect)?(n.firstEffect=s,s.nextEffect=a):(n.firstEffect=n.lastEffect=s,s.nextEffect=null),s.effectTag=8)),r&&!o&&2&n.mode&&(null===e&&!0!==n.memoizedProps.unstable_avoidThisFallback||1&Mo.current?Fa===Ta&&(Fa=Aa):(Fa!==Ta&&Fa!==Aa||(Fa=Oa),0!==Va&&null!==Ra&&(Hl(Ra,Ma),$l(Ra,Va)))),(r||o)&&(n.effectTag|=4),null);case 4:return No(),zs(n),null;case 10:return eo(n),null;case 19:if(lr(Mo),null===(o=n.memoizedState))return null;if(s=!!(64&n.effectTag),null===(a=o.rendering)){if(s)Xs(o,!1);else if(Fa!==Ta||null!==e&&64&e.effectTag)for(a=n.child;null!==a;){if(null!==(e=Fo(a))){for(n.effectTag|=64,Xs(o,!1),null!==(s=e.updateQueue)&&(n.updateQueue=s,n.effectTag|=4),null===o.lastEffect&&(n.firstEffect=null),n.lastEffect=o.lastEffect,o=n.child;null!==o;)a=r,(s=o).effectTag&=2,s.nextEffect=null,s.firstEffect=null,s.lastEffect=null,null===(e=s.alternate)?(s.childExpirationTime=0,s.expirationTime=a,s.child=null,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null):(s.childExpirationTime=e.childExpirationTime,s.expirationTime=e.expirationTime,s.child=e.child,s.memoizedProps=e.memoizedProps,s.memoizedState=e.memoizedState,s.updateQueue=e.updateQueue,s.dependencies=null===(a=e.dependencies)?null:{expirationTime:a.expirationTime,firstContext:a.firstContext,responders:a.responders}),o=o.sibling;return cr(Mo,1&Mo.current|2),n.child}a=a.sibling}}else{if(!s)if(null!==(e=Fo(a))){if(n.effectTag|=64,s=!0,null!==(r=e.updateQueue)&&(n.updateQueue=r,n.effectTag|=4),Xs(o,!0),null===o.tail&&"hidden"===o.tailMode&&!a.alternate)return null!==(n=n.lastEffect=o.lastEffect)&&(n.nextEffect=null),null}else 2*Ur()-o.renderingStartTime>o.tailExpiration&&1<r&&(n.effectTag|=64,s=!0,Xs(o,!1),n.expirationTime=n.childExpirationTime=r-1);o.isBackwards?(a.sibling=n.child,n.child=a):(null!==(r=o.last)?r.sibling=a:n.child=a,o.last=a)}return null!==o.tail?(0===o.tailExpiration&&(o.tailExpiration=Ur()+500),o.rendering=r=o.tail,o.tail=r.sibling,o.lastEffect=n.lastEffect,o.renderingStartTime=Ur(),r.sibling=null,n=Mo.current,cr(Mo,s?1&n|2:1&n),r):null}throw Error(i(156,n.tag))}function Zs(e){switch(e.tag){case 1:gr(e.type)&&mr();var t=e.effectTag;return 4096&t?(e.effectTag=-4097&t|64,e):null;case 3:if(No(),lr(hr),lr(dr),64&(t=e.effectTag))throw Error(i(285));return e.effectTag=-4097&t|64,e;case 5:return Do(e),null;case 13:return lr(Mo),4096&(t=e.effectTag)?(e.effectTag=-4097&t|64,e):null;case 19:return lr(Mo),null;case 4:return No(),null;case 10:return eo(e),null;default:return null}}function Js(e,t){return{value:e,source:t,stack:fe(t)}}js=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},zs=function(){},Vs=function(e,n,i,r,o){var s=e.memoizedProps;if(s!==r){var a,l,c=n.stateNode;switch(Oo(Po.current),e=null,i){case"input":s=be(c,s),r=be(c,r),e=[];break;case"option":s=_e(c,s),r=_e(c,r),e=[];break;case"select":s=t({},s,{value:void 0}),r=t({},r,{value:void 0}),e=[];break;case"textarea":s=Te(c,s),r=Te(c,r),e=[];break;default:"function"!=typeof s.onClick&&"function"==typeof r.onClick&&(c.onclick=rn)}for(a in Jt(i,r),i=null,s)if(!r.hasOwnProperty(a)&&s.hasOwnProperty(a)&&null!=s[a])if("style"===a)for(l in c=s[a])c.hasOwnProperty(l)&&(i||(i={}),i[l]="");else"dangerouslySetInnerHTML"!==a&&"children"!==a&&"suppressContentEditableWarning"!==a&&"suppressHydrationWarning"!==a&&"autoFocus"!==a&&(k.hasOwnProperty(a)?e||(e=[]):(e=e||[]).push(a,null));for(a in r){var u=r[a];if(c=null!=s?s[a]:void 0,r.hasOwnProperty(a)&&u!==c&&(null!=u||null!=c))if("style"===a)if(c){for(l in c)!c.hasOwnProperty(l)||u&&u.hasOwnProperty(l)||(i||(i={}),i[l]="");for(l in u)u.hasOwnProperty(l)&&c[l]!==u[l]&&(i||(i={}),i[l]=u[l])}else i||(e||(e=[]),e.push(a,i)),i=u;else"dangerouslySetInnerHTML"===a?(c=c?c.__html:void 0,null!=(u=u?u.__html:void 0)&&c!==u&&(e=e||[]).push(a,u)):"children"===a?c===u||"string"!=typeof u&&"number"!=typeof u||(e=e||[]).push(a,""+u):"suppressContentEditableWarning"!==a&&"suppressHydrationWarning"!==a&&(k.hasOwnProperty(a)?(null!=u&&nn(o,a),e||c===u||(e=[])):(e=e||[]).push(a,u))}i&&(e=e||[]).push("style",i),(n.updateQueue=o=e)&&(n.effectTag|=4)}},Ws=function(e,t,n,i){n!==i&&(t.effectTag|=4)};var ea="function"==typeof WeakSet?WeakSet:Set;function ta(e,t){var n=t.source,i=t.stack;null===i&&null!==n&&(i=fe(n)),null!==n&&pe(n.type),t=t.value,null!==e&&1===e.tag&&pe(e.type);try{console.error(t)}catch(e){setTimeout((function(){throw e}))}}function na(e){var t=e.ref;if(null!==t)if("function"==typeof t)try{t(null)}catch(t){Il(e,t)}else t.current=null}function ia(e,t){switch(t.tag){case 0:case 11:case 15:case 22:case 3:case 5:case 6:case 4:case 17:return;case 1:if(256&t.effectTag&&null!==e){var n=e.memoizedProps,r=e.memoizedState;t=(e=t.stateNode).getSnapshotBeforeUpdate(t.elementType===t.type?n:Yr(t.type,n),r),e.__reactInternalSnapshotBeforeUpdate=t}return}throw Error(i(163))}function ra(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var i=n.destroy;n.destroy=void 0,void 0!==i&&i()}n=n.next}while(n!==t)}}function oa(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{(n.tag&e)===e&&(n.destroy=(0,n.create)()),n=n.next}while(n!==t)}}function sa(e,t,n){switch(n.tag){case 0:case 11:case 15:case 22:return void oa(3,n);case 1:if(e=n.stateNode,4&n.effectTag)if(null===t)e.componentDidMount();else{var r=n.elementType===n.type?t.memoizedProps:Yr(n.type,t.memoizedProps);e.componentDidUpdate(r,t.memoizedState,e.__reactInternalSnapshotBeforeUpdate)}return void(null!==(t=n.updateQueue)&&ho(n,t,e));case 3:if(null!==(t=n.updateQueue)){if(e=null,null!==n.child)switch(n.child.tag){case 5:case 1:e=n.child.stateNode}ho(n,t,e)}return;case 5:return e=n.stateNode,void(null===t&&4&n.effectTag&&yn(n.type,n.memoizedProps)&&e.focus());case 6:case 4:case 12:case 19:case 17:case 20:case 21:return;case 13:return void(null===n.memoizedState&&(n=n.alternate,null!==n&&(n=n.memoizedState,null!==n&&(n=n.dehydrated,null!==n&&Ot(n)))))}throw Error(i(163))}function aa(e,t,n){switch("function"==typeof Nl&&Nl(t),t.tag){case 0:case 11:case 14:case 15:case 22:if(null!==(e=t.updateQueue)&&null!==(e=e.lastEffect)){var i=e.next;Vr(97<n?97:n,(function(){var e=i;do{var n=e.destroy;if(void 0!==n){var r=t;try{n()}catch(e){Il(r,e)}}e=e.next}while(e!==i)}))}break;case 1:na(t),"function"==typeof(n=t.stateNode).componentWillUnmount&&function(e,t){try{t.props=e.memoizedProps,t.state=e.memoizedState,t.componentWillUnmount()}catch(t){Il(e,t)}}(t,n);break;case 5:na(t);break;case 4:pa(e,t,n)}}function la(e){var t=e.alternate;e.return=null,e.child=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.alternate=null,e.firstEffect=null,e.lastEffect=null,e.pendingProps=null,e.memoizedProps=null,e.stateNode=null,null!==t&&la(t)}function ca(e){return 5===e.tag||3===e.tag||4===e.tag}function ua(e){e:{for(var t=e.return;null!==t;){if(ca(t)){var n=t;break e}t=t.return}throw Error(i(160))}switch(t=n.stateNode,n.tag){case 5:var r=!1;break;case 3:case 4:t=t.containerInfo,r=!0;break;default:throw Error(i(161))}16&n.effectTag&&(De(t,""),n.effectTag&=-17);e:t:for(n=e;;){for(;null===n.sibling;){if(null===n.return||ca(n.return)){n=null;break e}n=n.return}for(n.sibling.return=n.return,n=n.sibling;5!==n.tag&&6!==n.tag&&18!==n.tag;){if(2&n.effectTag)continue t;if(null===n.child||4===n.tag)continue t;n.child.return=n,n=n.child}if(!(2&n.effectTag)){n=n.stateNode;break e}}r?da(e,n,t):ha(e,n,t)}function da(e,t,n){var i=e.tag,r=5===i||6===i;if(r)e=r?e.stateNode:e.stateNode.instance,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!=(n=n._reactRootContainer)||null!==t.onclick||(t.onclick=rn));else if(4!==i&&null!==(e=e.child))for(da(e,t,n),e=e.sibling;null!==e;)da(e,t,n),e=e.sibling}function ha(e,t,n){var i=e.tag,r=5===i||6===i;if(r)e=r?e.stateNode:e.stateNode.instance,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==i&&null!==(e=e.child))for(ha(e,t,n),e=e.sibling;null!==e;)ha(e,t,n),e=e.sibling}function pa(e,t,n){for(var r,o,s=t,a=!1;;){if(!a){a=s.return;e:for(;;){if(null===a)throw Error(i(160));switch(r=a.stateNode,a.tag){case 5:o=!1;break e;case 3:case 4:r=r.containerInfo,o=!0;break e}a=a.return}a=!0}if(5===s.tag||6===s.tag){e:for(var l=e,c=s,u=n,d=c;;)if(aa(l,d,u),null!==d.child&&4!==d.tag)d.child.return=d,d=d.child;else{if(d===c)break e;for(;null===d.sibling;){if(null===d.return||d.return===c)break e;d=d.return}d.sibling.return=d.return,d=d.sibling}o?(c=s.stateNode,8===(l=r).nodeType?l.parentNode.removeChild(c):l.removeChild(c)):r.removeChild(s.stateNode)}else if(4===s.tag){if(null!==s.child){r=s.stateNode.containerInfo,o=!0,s.child.return=s,s=s.child;continue}}else if(aa(e,s,n),null!==s.child){s.child.return=s,s=s.child;continue}if(s===t)break;for(;null===s.sibling;){if(null===s.return||s.return===t)return;4===(s=s.return).tag&&(a=!1)}s.sibling.return=s.return,s=s.sibling}}function fa(e,t){switch(t.tag){case 0:case 11:case 14:case 15:case 22:return void ra(3,t);case 1:case 12:case 17:return;case 5:var n=t.stateNode;if(null!=n){var r=t.memoizedProps,o=null!==e?e.memoizedProps:r;e=t.type;var s=t.updateQueue;if(t.updateQueue=null,null!==s){for(n[_n]=r,"input"===e&&"radio"===r.type&&null!=r.name&&ke(n,r),en(e,o),t=en(e,r),o=0;o<s.length;o+=2){var a=s[o],l=s[o+1];"style"===a?Qt(n,l):"dangerouslySetInnerHTML"===a?Re(n,l):"children"===a?De(n,l):Y(n,a,l,t)}switch(e){case"input":xe(n,r);break;case"textarea":Ie(n,r);break;case"select":t=n._wrapperState.wasMultiple,n._wrapperState.wasMultiple=!!r.multiple,null!=(e=r.value)?Ee(n,!!r.multiple,e,!1):t!==!!r.multiple&&(null!=r.defaultValue?Ee(n,!!r.multiple,r.defaultValue,!0):Ee(n,!!r.multiple,r.multiple?[]:"",!1))}}}return;case 6:if(null===t.stateNode)throw Error(i(162));return void(t.stateNode.nodeValue=t.memoizedProps);case 3:return void((t=t.stateNode).hydrate&&(t.hydrate=!1,Ot(t.containerInfo)));case 13:if(n=t,null===t.memoizedState?r=!1:(r=!0,n=t.child,Ha=Ur()),null!==n)e:for(e=n;;){if(5===e.tag)s=e.stateNode,r?"function"==typeof(s=s.style).setProperty?s.setProperty("display","none","important"):s.display="none":(s=e.stateNode,o=null!=(o=e.memoizedProps.style)&&o.hasOwnProperty("display")?o.display:null,s.style.display=Xt("display",o));else if(6===e.tag)e.stateNode.nodeValue=r?"":e.memoizedProps;else{if(13===e.tag&&null!==e.memoizedState&&null===e.memoizedState.dehydrated){(s=e.child.sibling).return=e,e=s;continue}if(null!==e.child){e.child.return=e,e=e.child;continue}}if(e===n)break;for(;null===e.sibling;){if(null===e.return||e.return===n)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}return void ga(t);case 19:return void ga(t)}throw Error(i(163))}function ga(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new ea),t.forEach((function(t){var i=Ol.bind(null,e,t);n.has(t)||(n.add(t),t.then(i,i))}))}}var ma="function"==typeof WeakMap?WeakMap:Map;function ya(e,t,n){(n=ao(n,null)).tag=3,n.payload={element:null};var i=t.value;return n.callback=function(){qa||(qa=!0,Ya=i),ta(e,t)},n}function va(e,t,n){(n=ao(n,null)).tag=3;var i=e.type.getDerivedStateFromError;if("function"==typeof i){var r=t.value;n.payload=function(){return ta(e,t),i(r)}}var o=e.stateNode;return null!==o&&"function"==typeof o.componentDidCatch&&(n.callback=function(){"function"!=typeof i&&(null===Ka?Ka=new Set([this]):Ka.add(this),ta(e,t));var n=t.stack;this.componentDidCatch(t.value,{componentStack:null!==n?n:""})}),n}var ba,wa=Math.ceil,ka=q.ReactCurrentDispatcher,xa=q.ReactCurrentOwner,Sa=0,Ca=8,_a=16,Ea=32,Ta=0,Pa=1,Ia=2,Aa=3,Oa=4,La=5,Na=Sa,Ra=null,Da=null,Ma=0,Fa=Ta,Ba=null,Ua=1073741823,ja=1073741823,za=null,Va=0,Wa=!1,Ha=0,$a=500,Ga=null,qa=!1,Ya=null,Ka=null,Xa=!1,Qa=null,Za=90,Ja=null,el=0,tl=null,nl=0;function il(){return(Na&(_a|Ea))!==Sa?1073741821-(Ur()/10|0):0!==nl?nl:nl=1073741821-(Ur()/10|0)}function rl(e,t,n){if(!(2&(t=t.mode)))return 1073741823;var r=jr();if(!(4&t))return 99===r?1073741823:1073741822;if((Na&_a)!==Sa)return Ma;if(null!==n)e=qr(e,0|n.timeoutMs||5e3,250);else switch(r){case 99:e=1073741823;break;case 98:e=qr(e,150,100);break;case 97:case 96:e=qr(e,5e3,250);break;case 95:e=2;break;default:throw Error(i(326))}return null!==Ra&&e===Ma&&--e,e}function ol(e,t){if(50<el)throw el=0,tl=null,Error(i(185));if(null!==(e=sl(e,t))){var n=jr();1073741823===t?(Na&Ca)!==Sa&&(Na&(_a|Ea))===Sa?ul(e):(ll(e),Na===Sa&&$r()):ll(e),(4&Na)===Sa||98!==n&&99!==n||(null===Ja?Ja=new Map([[e,t]]):(void 0===(n=Ja.get(e))||n>t)&&Ja.set(e,t))}}function sl(e,t){e.expirationTime<t&&(e.expirationTime=t);var n=e.alternate;null!==n&&n.expirationTime<t&&(n.expirationTime=t);var i=e.return,r=null;if(null===i&&3===e.tag)r=e.stateNode;else for(;null!==i;){if(n=i.alternate,i.childExpirationTime<t&&(i.childExpirationTime=t),null!==n&&n.childExpirationTime<t&&(n.childExpirationTime=t),null===i.return&&3===i.tag){r=i.stateNode;break}i=i.return}return null!==r&&(Ra===r&&(yl(t),Fa===Oa&&Hl(r,Ma)),$l(r,t)),r}function al(e){var t=e.lastExpiredTime;if(0!==t)return t;if(!Wl(e,t=e.firstPendingTime))return t;var n=e.lastPingedTime;return 2>=(e=n>(e=e.nextKnownPendingLevel)?n:e)&&t!==e?0:e}function ll(e){if(0!==e.lastExpiredTime)e.callbackExpirationTime=1073741823,e.callbackPriority=99,e.callbackNode=Hr(ul.bind(null,e));else{var t=al(e),n=e.callbackNode;if(0===t)null!==n&&(e.callbackNode=null,e.callbackExpirationTime=0,e.callbackPriority=90);else{var i=il();if(i=1073741823===t?99:1===t||2===t?95:0>=(i=10*(1073741821-t)-10*(1073741821-i))?99:250>=i?98:5250>=i?97:95,null!==n){if(e.callbackExpirationTime===t&&e.callbackPriority>=i)return;n!==Lr&&Sr(n)}e.callbackExpirationTime=t,e.callbackPriority=i,t=1073741823===t?Hr(ul.bind(null,e)):Wr(i,cl.bind(null,e),{timeout:10*(1073741821-t)-Ur()}),e.callbackNode=t}}}function cl(e,t){if(nl=0,t)return Gl(e,t=il()),ll(e),null;var n=al(e);if(0!==n){if(t=e.callbackNode,(Na&(_a|Ea))!==Sa)throw Error(i(327));if(El(),e===Ra&&n===Ma||pl(e,n),null!==Da){var r=Na;Na|=_a;for(var o=gl();;)try{bl();break}catch(t){fl(e,t)}if(Jr(),Na=r,ka.current=o,Fa===Pa)throw t=Ba,pl(e,n),Hl(e,n),ll(e),t;if(null===Da)switch(o=e.finishedWork=e.current.alternate,e.finishedExpirationTime=n,r=Fa,Ra=null,r){case Ta:case Pa:throw Error(i(345));case Ia:Gl(e,2<n?2:n);break;case Aa:if(Hl(e,n),n===(r=e.lastSuspendedTime)&&(e.nextKnownPendingLevel=xl(o)),1073741823===Ua&&10<(o=Ha+$a-Ur())){if(Wa){var s=e.lastPingedTime;if(0===s||s>=n){e.lastPingedTime=n,pl(e,n);break}}if(0!==(s=al(e))&&s!==n)break;if(0!==r&&r!==n){e.lastPingedTime=r;break}e.timeoutHandle=bn(Sl.bind(null,e),o);break}Sl(e);break;case Oa:if(Hl(e,n),n===(r=e.lastSuspendedTime)&&(e.nextKnownPendingLevel=xl(o)),Wa&&(0===(o=e.lastPingedTime)||o>=n)){e.lastPingedTime=n,pl(e,n);break}if(0!==(o=al(e))&&o!==n)break;if(0!==r&&r!==n){e.lastPingedTime=r;break}if(1073741823!==ja?r=10*(1073741821-ja)-Ur():1073741823===Ua?r=0:(r=10*(1073741821-Ua)-5e3,0>(r=(o=Ur())-r)&&(r=0),(n=10*(1073741821-n)-o)<(r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*wa(r/1960))-r)&&(r=n)),10<r){e.timeoutHandle=bn(Sl.bind(null,e),r);break}Sl(e);break;case La:if(1073741823!==Ua&&null!==za){s=Ua;var a=za;if(0>=(r=0|a.busyMinDurationMs)?r=0:(o=0|a.busyDelayMs,r=(s=Ur()-(10*(1073741821-s)-(0|a.timeoutMs||5e3)))<=o?0:o+r-s),10<r){Hl(e,n),e.timeoutHandle=bn(Sl.bind(null,e),r);break}}Sl(e);break;default:throw Error(i(329))}if(ll(e),e.callbackNode===t)return cl.bind(null,e)}}return null}function ul(e){var t=e.lastExpiredTime;if(t=0!==t?t:1073741823,(Na&(_a|Ea))!==Sa)throw Error(i(327));if(El(),e===Ra&&t===Ma||pl(e,t),null!==Da){var n=Na;Na|=_a;for(var r=gl();;)try{vl();break}catch(t){fl(e,t)}if(Jr(),Na=n,ka.current=r,Fa===Pa)throw n=Ba,pl(e,t),Hl(e,t),ll(e),n;if(null!==Da)throw Error(i(261));e.finishedWork=e.current.alternate,e.finishedExpirationTime=t,Ra=null,Sl(e),ll(e)}return null}function dl(e,t){var n=Na;Na|=1;try{return e(t)}finally{(Na=n)===Sa&&$r()}}function hl(e,t){var n=Na;Na&=-2,Na|=Ca;try{return e(t)}finally{(Na=n)===Sa&&$r()}}function pl(e,t){e.finishedWork=null,e.finishedExpirationTime=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,wn(n)),null!==Da)for(n=Da.return;null!==n;){var i=n;switch(i.tag){case 1:null!=(i=i.type.childContextTypes)&&mr();break;case 3:No(),lr(hr),lr(dr);break;case 5:Do(i);break;case 4:No();break;case 13:case 19:lr(Mo);break;case 10:eo(i)}n=n.return}Ra=e,Da=Fl(e.current,null),Ma=t,Fa=Ta,Ba=null,ja=Ua=1073741823,za=null,Va=0,Wa=!1}function fl(e,t){for(;;){try{if(Jr(),Uo.current=ms,$o)for(var n=Vo.memoizedState;null!==n;){var i=n.queue;null!==i&&(i.pending=null),n=n.next}if(zo=0,Ho=Wo=Vo=null,$o=!1,null===Da||null===Da.return)return Fa=Pa,Ba=t,Da=null;e:{var r=e,o=Da.return,s=Da,a=t;if(t=Ma,s.effectTag|=2048,s.firstEffect=s.lastEffect=null,null!==a&&"object"==typeof a&&"function"==typeof a.then){var l=a;if(!(2&s.mode)){var c=s.alternate;c?(s.updateQueue=c.updateQueue,s.memoizedState=c.memoizedState,s.expirationTime=c.expirationTime):(s.updateQueue=null,s.memoizedState=null)}var u=!!(1&Mo.current),d=o;do{var h;if(h=13===d.tag){var p=d.memoizedState;if(null!==p)h=null!==p.dehydrated;else{var f=d.memoizedProps;h=void 0!==f.fallback&&(!0!==f.unstable_avoidThisFallback||!u)}}if(h){var g=d.updateQueue;if(null===g){var m=new Set;m.add(l),d.updateQueue=m}else g.add(l);if(!(2&d.mode)){if(d.effectTag|=64,s.effectTag&=-2981,1===s.tag)if(null===s.alternate)s.tag=17;else{var y=ao(1073741823,null);y.tag=2,lo(s,y)}s.expirationTime=1073741823;break e}a=void 0,s=t;var v=r.pingCache;if(null===v?(v=r.pingCache=new ma,a=new Set,v.set(l,a)):void 0===(a=v.get(l))&&(a=new Set,v.set(l,a)),!a.has(s)){a.add(s);var b=Al.bind(null,r,l,s);l.then(b,b)}d.effectTag|=4096,d.expirationTime=t;break e}d=d.return}while(null!==d);a=Error((pe(s.type)||"A React component")+" suspended while rendering, but no fallback UI was specified.\n\nAdd a <Suspense fallback=...> component higher in the tree to provide a loading indicator or placeholder to display."+fe(s))}Fa!==La&&(Fa=Ia),a=Js(a,s),d=o;do{switch(d.tag){case 3:l=a,d.effectTag|=4096,d.expirationTime=t,co(d,ya(d,l,t));break e;case 1:l=a;var w=d.stateNode;if(!(64&d.effectTag||"function"!=typeof d.type.getDerivedStateFromError&&(null===w||"function"!=typeof w.componentDidCatch||null!==Ka&&Ka.has(w)))){d.effectTag|=4096,d.expirationTime=t,co(d,va(d,l,t));break e}}d=d.return}while(null!==d)}Da=kl(Da)}catch(e){t=e;continue}break}}function gl(){var e=ka.current;return ka.current=ms,null===e?ms:e}function ml(e,t){e<Ua&&2<e&&(Ua=e),null!==t&&e<ja&&2<e&&(ja=e,za=t)}function yl(e){e>Va&&(Va=e)}function vl(){for(;null!==Da;)Da=wl(Da)}function bl(){for(;null!==Da&&!Nr();)Da=wl(Da)}function wl(e){var t=ba(e.alternate,e,Ma);return e.memoizedProps=e.pendingProps,null===t&&(t=kl(e)),xa.current=null,t}function kl(e){Da=e;do{var t=Da.alternate;if(e=Da.return,2048&Da.effectTag){if(null!==(t=Zs(Da)))return t.effectTag&=2047,t;null!==e&&(e.firstEffect=e.lastEffect=null,e.effectTag|=2048)}else{if(t=Qs(t,Da,Ma),1===Ma||1!==Da.childExpirationTime){for(var n=0,i=Da.child;null!==i;){var r=i.expirationTime,o=i.childExpirationTime;r>n&&(n=r),o>n&&(n=o),i=i.sibling}Da.childExpirationTime=n}if(null!==t)return t;null!==e&&!(2048&e.effectTag)&&(null===e.firstEffect&&(e.firstEffect=Da.firstEffect),null!==Da.lastEffect&&(null!==e.lastEffect&&(e.lastEffect.nextEffect=Da.firstEffect),e.lastEffect=Da.lastEffect),1<Da.effectTag&&(null!==e.lastEffect?e.lastEffect.nextEffect=Da:e.firstEffect=Da,e.lastEffect=Da))}if(null!==(t=Da.sibling))return t;Da=e}while(null!==Da);return Fa===Ta&&(Fa=La),null}function xl(e){var t=e.expirationTime;return t>(e=e.childExpirationTime)?t:e}function Sl(e){var t=jr();return Vr(99,Cl.bind(null,e,t)),null}function Cl(e,t){do{El()}while(null!==Qa);if((Na&(_a|Ea))!==Sa)throw Error(i(327));var n=e.finishedWork,r=e.finishedExpirationTime;if(null===n)return null;if(e.finishedWork=null,e.finishedExpirationTime=0,n===e.current)throw Error(i(177));e.callbackNode=null,e.callbackExpirationTime=0,e.callbackPriority=90,e.nextKnownPendingLevel=0;var o=xl(n);if(e.firstPendingTime=o,r<=e.lastSuspendedTime?e.firstSuspendedTime=e.lastSuspendedTime=e.nextKnownPendingLevel=0:r<=e.firstSuspendedTime&&(e.firstSuspendedTime=r-1),r<=e.lastPingedTime&&(e.lastPingedTime=0),r<=e.lastExpiredTime&&(e.lastExpiredTime=0),e===Ra&&(Da=Ra=null,Ma=0),1<n.effectTag?null!==n.lastEffect?(n.lastEffect.nextEffect=n,o=n.firstEffect):o=n:o=n.firstEffect,null!==o){var s=Na;Na|=Ea,xa.current=null,gn=zt;var a=cn();if(un(a)){if("selectionStart"in a)var l={start:a.selectionStart,end:a.selectionEnd};else{var c=(l=(l=a.ownerDocument)&&l.defaultView||window).getSelection&&l.getSelection();if(c&&0!==c.rangeCount){l=c.anchorNode;var u=c.anchorOffset,d=c.focusNode;c=c.focusOffset;var h=0,p=-1,f=-1,g=0,m=0,y=a,v=null;e:for(;;){for(var b;y!==l||0!==u&&3!==y.nodeType||(p=h+u),y!==d||0!==c&&3!==y.nodeType||(f=h+c),3===y.nodeType&&(h+=y.nodeValue.length),null!==(b=y.firstChild);)v=y,y=b;for(;;){if(y===a)break e;if(v===l&&++g===u&&(p=h),v===d&&++m===c&&(f=h),null!==(b=y.nextSibling))break;v=(y=v).parentNode}y=b}l=-1===p||-1===f?null:{start:p,end:f}}else l=null}l=l||{start:0,end:0}}else l=null;mn={activeElementDetached:null,focusedElem:a,selectionRange:l},zt=!1,Ga=o;do{try{_l()}catch(e){if(null===Ga)throw Error(i(330));Il(Ga,e),Ga=Ga.nextEffect}}while(null!==Ga);Ga=o;do{try{for(a=e,l=t;null!==Ga;){var w=Ga.effectTag;if(16&w&&De(Ga.stateNode,""),128&w){var k=Ga.alternate;if(null!==k){var x=k.ref;null!==x&&("function"==typeof x?x(null):x.current=null)}}switch(1038&w){case 2:ua(Ga),Ga.effectTag&=-3;break;case 6:ua(Ga),Ga.effectTag&=-3,fa(Ga.alternate,Ga);break;case 1024:Ga.effectTag&=-1025;break;case 1028:Ga.effectTag&=-1025,fa(Ga.alternate,Ga);break;case 4:fa(Ga.alternate,Ga);break;case 8:pa(a,u=Ga,l),la(u)}Ga=Ga.nextEffect}}catch(e){if(null===Ga)throw Error(i(330));Il(Ga,e),Ga=Ga.nextEffect}}while(null!==Ga);if(x=mn,k=cn(),l=x.selectionRange,k!==(w=x.focusedElem)&&w&&w.ownerDocument&&ln(w.ownerDocument.documentElement,w)){null!==l&&un(w)&&(k=l.start,void 0===(x=l.end)&&(x=k),"selectionStart"in w?(w.selectionStart=k,w.selectionEnd=Math.min(x,w.value.length)):(x=(k=w.ownerDocument||document)&&k.defaultView||window).getSelection&&(x=x.getSelection(),u=w.textContent.length,a=Math.min(l.start,u),l=void 0===l.end?a:Math.min(l.end,u),!x.extend&&a>l&&(u=l,l=a,a=u),u=an(w,a),d=an(w,l),u&&d&&(1!==x.rangeCount||x.anchorNode!==u.node||x.anchorOffset!==u.offset||x.focusNode!==d.node||x.focusOffset!==d.offset)&&((k=k.createRange()).setStart(u.node,u.offset),x.removeAllRanges(),a>l?(x.addRange(k),x.extend(d.node,d.offset)):(k.setEnd(d.node,d.offset),x.addRange(k))))),k=[];for(x=w;x=x.parentNode;)1===x.nodeType&&k.push({element:x,left:x.scrollLeft,top:x.scrollTop});for("function"==typeof w.focus&&w.focus(),w=0;w<k.length;w++)(x=k[w]).element.scrollLeft=x.left,x.element.scrollTop=x.top}zt=!!gn,mn=gn=null,e.current=n,Ga=o;do{try{for(w=e;null!==Ga;){var S=Ga.effectTag;if(36&S&&sa(w,Ga.alternate,Ga),128&S){k=void 0;var C=Ga.ref;null!==C&&(k=Ga.stateNode,"function"==typeof C?C(k):C.current=k)}Ga=Ga.nextEffect}}catch(e){if(null===Ga)throw Error(i(330));Il(Ga,e),Ga=Ga.nextEffect}}while(null!==Ga);Ga=null,Rr(),Na=s}else e.current=n;if(Xa)Xa=!1,Qa=e,Za=t;else for(Ga=o;null!==Ga;)t=Ga.nextEffect,Ga.nextEffect=null,Ga=t;if(0===(t=e.firstPendingTime)&&(Ka=null),1073741823===t?e===tl?el++:(el=0,tl=e):el=0,"function"==typeof Ll&&Ll(n.stateNode,r),ll(e),qa)throw qa=!1,e=Ya,Ya=null,e;return(Na&Ca)!==Sa||$r(),null}function _l(){for(;null!==Ga;){var e=Ga.effectTag;256&e&&ia(Ga.alternate,Ga),!(512&e)||Xa||(Xa=!0,Wr(97,(function(){return El(),null}))),Ga=Ga.nextEffect}}function El(){if(90!==Za){var e=97<Za?97:Za;return Za=90,Vr(e,Tl)}}function Tl(){if(null===Qa)return!1;var e=Qa;if(Qa=null,(Na&(_a|Ea))!==Sa)throw Error(i(331));var t=Na;for(Na|=Ea,e=e.current.firstEffect;null!==e;){try{var n=e;if(512&n.effectTag)switch(n.tag){case 0:case 11:case 15:case 22:ra(5,n),oa(5,n)}}catch(t){if(null===e)throw Error(i(330));Il(e,t)}n=e.nextEffect,e.nextEffect=null,e=n}return Na=t,$r(),!0}function Pl(e,t,n){lo(e,t=ya(e,t=Js(n,t),1073741823)),null!==(e=sl(e,1073741823))&&ll(e)}function Il(e,t){if(3===e.tag)Pl(e,e,t);else for(var n=e.return;null!==n;){if(3===n.tag){Pl(n,e,t);break}if(1===n.tag){var i=n.stateNode;if("function"==typeof n.type.getDerivedStateFromError||"function"==typeof i.componentDidCatch&&(null===Ka||!Ka.has(i))){lo(n,e=va(n,e=Js(t,e),1073741823)),null!==(n=sl(n,1073741823))&&ll(n);break}}n=n.return}}function Al(e,t,n){var i=e.pingCache;null!==i&&i.delete(t),Ra===e&&Ma===n?Fa===Oa||Fa===Aa&&1073741823===Ua&&Ur()-Ha<$a?pl(e,Ma):Wa=!0:Wl(e,n)&&(0!==(t=e.lastPingedTime)&&t<n||(e.lastPingedTime=n,ll(e)))}function Ol(e,t){var n=e.stateNode;null!==n&&n.delete(t),0==(t=0)&&(t=rl(t=il(),e,null)),null!==(e=sl(e,t))&&ll(e)}ba=function(e,t,n){var r=t.expirationTime;if(null!==e){var o=t.pendingProps;if(e.memoizedProps!==o||hr.current)As=!0;else{if(r<n){switch(As=!1,t.tag){case 3:Us(t),Ps();break;case 5:if(Ro(t),4&t.mode&&1!==n&&o.hidden)return t.expirationTime=t.childExpirationTime=1,null;break;case 1:gr(t.type)&&br(t);break;case 4:Lo(t,t.stateNode.containerInfo);break;case 10:r=t.memoizedProps.value,cr(Kr,(o=t.type._context)._currentValue),o._currentValue=r;break;case 13:if(null!==t.memoizedState)return 0!==(r=t.child.childExpirationTime)&&r>=n?$s(e,t,n):(cr(Mo,1&Mo.current),null!==(t=Ks(e,t,n))?t.sibling:null);cr(Mo,1&Mo.current);break;case 19:if(r=t.childExpirationTime>=n,64&e.effectTag){if(r)return Ys(e,t,n);t.effectTag|=64}if(null!==(o=t.memoizedState)&&(o.rendering=null,o.tail=null),cr(Mo,Mo.current),!r)return null}return Ks(e,t,n)}As=!1}}else As=!1;switch(t.expirationTime=0,t.tag){case 2:if(r=t.type,null!==e&&(e.alternate=null,t.alternate=null,t.effectTag|=2),e=t.pendingProps,o=fr(t,dr.current),no(t,n),o=Yo(null,t,r,e,o,n),t.effectTag|=1,"object"==typeof o&&null!==o&&"function"==typeof o.render&&void 0===o.$$typeof){if(t.tag=1,t.memoizedState=null,t.updateQueue=null,gr(r)){var s=!0;br(t)}else s=!1;t.memoizedState=null!=o.state?o.state:null,oo(t);var a=r.getDerivedStateFromProps;"function"==typeof a&&go(t,r,a,e),o.updater=mo,t.stateNode=o,o._reactInternalFiber=t,wo(t,r,e,n),t=Bs(null,t,r,!0,s,n)}else t.tag=0,Os(null,t,o,n),t=t.child;return t;case 16:e:{if(o=t.elementType,null!==e&&(e.alternate=null,t.alternate=null,t.effectTag|=2),e=t.pendingProps,function(e){if(-1===e._status){e._status=0;var t=e._ctor;t=t(),e._result=t,t.then((function(t){0===e._status&&(t=t.default,e._status=1,e._result=t)}),(function(t){0===e._status&&(e._status=2,e._result=t)}))}}(o),1!==o._status)throw o._result;switch(t.type=o=o._result,s=t.tag=function(e){if("function"==typeof e)return Ml(e)?1:0;if(null!=e){if((e=e.$$typeof)===oe)return 11;if(e===le)return 14}return 2}(o),e=Yr(o,e),s){case 0:t=Ms(null,t,o,e,n);break e;case 1:t=Fs(null,t,o,e,n);break e;case 11:t=Ls(null,t,o,e,n);break e;case 14:t=Ns(null,t,o,Yr(o.type,e),r,n);break e}throw Error(i(306,o,""))}return t;case 0:return o=t.pendingProps,Ms(e,t,r=t.type,o=t.elementType===r?o:Yr(r,o),n);case 1:return o=t.pendingProps,Fs(e,t,r=t.type,o=t.elementType===r?o:Yr(r,o),n);case 3:if(Us(t),r=t.updateQueue,null===e||null===r)throw Error(i(282));if(r=t.pendingProps,o=null!==(o=t.memoizedState)?o.element:null,so(e,t),uo(t,r,null,n),(r=t.memoizedState.element)===o)Ps(),t=Ks(e,t,n);else{if((o=t.stateNode.hydrate)&&(ks=kn(t.stateNode.containerInfo.firstChild),ws=t,o=xs=!0),o)for(n=Eo(t,null,r,n),t.child=n;n;)n.effectTag=-3&n.effectTag|1024,n=n.sibling;else Os(e,t,r,n),Ps();t=t.child}return t;case 5:return Ro(t),null===e&&_s(t),s=null!==e?e.memoizedProps:null,a=(o=t.pendingProps).children,vn(r=t.type,o)?a=null:null!==s&&vn(r,s)&&(t.effectTag|=16),Ds(e,t),4&t.mode&&1!==n&&o.hidden?(t.expirationTime=t.childExpirationTime=1,t=null):(Os(e,t,a,n),t=t.child),t;case 6:return null===e&&_s(t),null;case 13:return $s(e,t,n);case 4:return Lo(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=_o(t,null,r,n):Os(e,t,r,n),t.child;case 11:return o=t.pendingProps,Ls(e,t,r=t.type,o=t.elementType===r?o:Yr(r,o),n);case 7:return Os(e,t,t.pendingProps,n),t.child;case 8:case 12:return Os(e,t,t.pendingProps.children,n),t.child;case 10:e:{r=t.type._context,a=t.memoizedProps,s=(o=t.pendingProps).value;var l=t.type._context;if(cr(Kr,l._currentValue),l._currentValue=s,null!==a)if(0==(s=Fi(l=a.value,s)?0:0|("function"==typeof r._calculateChangedBits?r._calculateChangedBits(l,s):1073741823))){if(a.children===o.children&&!hr.current){t=Ks(e,t,n);break e}}else for(null!==(l=t.child)&&(l.return=t);null!==l;){var c=l.dependencies;if(null!==c){a=l.child;for(var u=c.firstContext;null!==u;){if(u.context===r&&u.observedBits&s){1===l.tag&&((u=ao(n,null)).tag=2,lo(l,u)),l.expirationTime<n&&(l.expirationTime=n),null!==(u=l.alternate)&&u.expirationTime<n&&(u.expirationTime=n),to(l.return,n),c.expirationTime<n&&(c.expirationTime=n);break}u=u.next}}else a=10===l.tag&&l.type===t.type?null:l.child;if(null!==a)a.return=l;else for(a=l;null!==a;){if(a===t){a=null;break}if(null!==(l=a.sibling)){l.return=a.return,a=l;break}a=a.return}l=a}Os(e,t,o.children,n),t=t.child}return t;case 9:return o=t.type,r=(s=t.pendingProps).children,no(t,n),r=r(o=io(o,s.unstable_observedBits)),t.effectTag|=1,Os(e,t,r,n),t.child;case 14:return s=Yr(o=t.type,t.pendingProps),Ns(e,t,o,s=Yr(o.type,s),r,n);case 15:return Rs(e,t,t.type,t.pendingProps,r,n);case 17:return o=t.pendingProps,o=t.elementType===(r=t.type)?o:Yr(r,o),null!==e&&(e.alternate=null,t.alternate=null,t.effectTag|=2),t.tag=1,gr(r)?(e=!0,br(t)):e=!1,no(t,n),vo(t,r,o),wo(t,r,o,n),Bs(null,t,r,!0,e,n);case 19:return Ys(e,t,n)}throw Error(i(156,t.tag))};var Ll=null,Nl=null;function Rl(e,t,n,i){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.effectTag=0,this.lastEffect=this.firstEffect=this.nextEffect=null,this.childExpirationTime=this.expirationTime=0,this.alternate=null}function Dl(e,t,n,i){return new Rl(e,t,n,i)}function Ml(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Fl(e,t){var n=e.alternate;return null===n?((n=Dl(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.effectTag=0,n.nextEffect=null,n.firstEffect=null,n.lastEffect=null),n.childExpirationTime=e.childExpirationTime,n.expirationTime=e.expirationTime,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,n.dependencies=null===(t=e.dependencies)?null:{expirationTime:t.expirationTime,firstContext:t.firstContext,responders:t.responders},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Bl(e,t,n,r,o,s){var a=2;if(r=e,"function"==typeof e)Ml(e)&&(a=1);else if("string"==typeof e)a=5;else e:switch(e){case J:return Ul(n.children,o,s,t);case re:a=8,o|=7;break;case ee:a=8,o|=1;break;case te:return(e=Dl(12,n,t,8|o)).elementType=te,e.type=te,e.expirationTime=s,e;case se:return(e=Dl(13,n,t,o)).type=se,e.elementType=se,e.expirationTime=s,e;case ae:return(e=Dl(19,n,t,o)).elementType=ae,e.expirationTime=s,e;default:if("object"==typeof e&&null!==e)switch(e.$$typeof){case ne:a=10;break e;case ie:a=9;break e;case oe:a=11;break e;case le:a=14;break e;case ce:a=16,r=null;break e;case ue:a=22;break e}throw Error(i(130,null==e?e:typeof e,""))}return(t=Dl(a,n,t,o)).elementType=e,t.type=r,t.expirationTime=s,t}function Ul(e,t,n,i){return(e=Dl(7,e,i,t)).expirationTime=n,e}function jl(e,t,n){return(e=Dl(6,e,null,t)).expirationTime=n,e}function zl(e,t,n){return(t=Dl(4,null!==e.children?e.children:[],e.key,t)).expirationTime=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Vl(e,t,n){this.tag=t,this.current=null,this.containerInfo=e,this.pingCache=this.pendingChildren=null,this.finishedExpirationTime=0,this.finishedWork=null,this.timeoutHandle=-1,this.pendingContext=this.context=null,this.hydrate=n,this.callbackNode=null,this.callbackPriority=90,this.lastExpiredTime=this.lastPingedTime=this.nextKnownPendingLevel=this.lastSuspendedTime=this.firstSuspendedTime=this.firstPendingTime=0}function Wl(e,t){var n=e.firstSuspendedTime;return e=e.lastSuspendedTime,0!==n&&n>=t&&e<=t}function Hl(e,t){var n=e.firstSuspendedTime,i=e.lastSuspendedTime;n<t&&(e.firstSuspendedTime=t),(i>t||0===n)&&(e.lastSuspendedTime=t),t<=e.lastPingedTime&&(e.lastPingedTime=0),t<=e.lastExpiredTime&&(e.lastExpiredTime=0)}function $l(e,t){t>e.firstPendingTime&&(e.firstPendingTime=t);var n=e.firstSuspendedTime;0!==n&&(t>=n?e.firstSuspendedTime=e.lastSuspendedTime=e.nextKnownPendingLevel=0:t>=e.lastSuspendedTime&&(e.lastSuspendedTime=t+1),t>e.nextKnownPendingLevel&&(e.nextKnownPendingLevel=t))}function Gl(e,t){var n=e.lastExpiredTime;(0===n||n>t)&&(e.lastExpiredTime=t)}function ql(e,t,n,r){var o=t.current,s=il(),a=po.suspense;s=rl(s,o,a);e:if(n){t:{if(Ye(n=n._reactInternalFiber)!==n||1!==n.tag)throw Error(i(170));var l=n;do{switch(l.tag){case 3:l=l.stateNode.context;break t;case 1:if(gr(l.type)){l=l.stateNode.__reactInternalMemoizedMergedChildContext;break t}}l=l.return}while(null!==l);throw Error(i(171))}if(1===n.tag){var c=n.type;if(gr(c)){n=vr(n,c,l);break e}}n=l}else n=ur;return null===t.context?t.context=n:t.pendingContext=n,(t=ao(s,a)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),lo(o,t),ol(o,s),s}function Yl(e){return(e=e.current).child?e.child.stateNode:null}function Kl(e,t){null!==(e=e.memoizedState)&&null!==e.dehydrated&&e.retryTime<t&&(e.retryTime=t)}function Xl(e,t){Kl(e,t),(e=e.alternate)&&Kl(e,t)}function Ql(e,t,n){var i=new Vl(e,t,n=null!=n&&!0===n.hydrate),r=Dl(3,null,null,2===t?7:1===t?3:0);i.current=r,r.stateNode=i,oo(r),e[En]=i.current,n&&0!==t&&function(e,t){var n=qe(t);kt.forEach((function(e){ct(e,t,n)})),xt.forEach((function(e){ct(e,t,n)}))}(0,9===e.nodeType?e:e.ownerDocument),this._internalRoot=i}function Zl(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Jl(e,t,n,i,r){var o=n._reactRootContainer;if(o){var s=o._internalRoot;if("function"==typeof r){var a=r;r=function(){var e=Yl(s);a.call(e)}}ql(t,s,e,r)}else{if(o=n._reactRootContainer=function(e,t){if(t||(t=!(!(t=e?9===e.nodeType?e.documentElement:e.firstChild:null)||1!==t.nodeType||!t.hasAttribute("data-reactroot"))),!t)for(var n;n=e.lastChild;)e.removeChild(n);return new Ql(e,0,t?{hydrate:!0}:void 0)}(n,i),s=o._internalRoot,"function"==typeof r){var l=r;r=function(){var e=Yl(s);l.call(e)}}hl((function(){ql(t,s,e,r)}))}return Yl(s)}function ec(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Zl(t))throw Error(i(200));return function(e,t,n){var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:Z,key:null==i?null:""+i,children:e,containerInfo:t,implementation:n}}(e,t,null,n)}Ql.prototype.render=function(e){ql(e,this._internalRoot,null,null)},Ql.prototype.unmount=function(){var e=this._internalRoot,t=e.containerInfo;ql(null,e,null,(function(){t[En]=null}))},ut=function(e){if(13===e.tag){var t=qr(il(),150,100);ol(e,t),Xl(e,t)}},dt=function(e){13===e.tag&&(ol(e,3),Xl(e,3))},ht=function(e){if(13===e.tag){var t=il();ol(e,t=rl(t,e,null)),Xl(e,t)}},_=function(e,t,n){switch(t){case"input":if(xe(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var o=An(r);if(!o)throw Error(i(90));ve(r),xe(r,o)}}}break;case"textarea":Ie(e,n);break;case"select":null!=(t=n.value)&&Ee(e,!!n.multiple,t,!1)}},O=dl,L=function(e,t,n,i,r){var o=Na;Na|=4;try{return Vr(98,e.bind(null,t,n,i,r))}finally{(Na=o)===Sa&&$r()}},N=function(){(Na&(1|_a|Ea))===Sa&&(function(){if(null!==Ja){var e=Ja;Ja=null,e.forEach((function(e,t){Gl(t,e),ll(t)})),$r()}}(),El())},R=function(e,t){var n=Na;Na|=2;try{return e(t)}finally{(Na=n)===Sa&&$r()}};var tc={Events:[Pn,In,An,S,w,Fn,function(e){Je(e,Mn)},I,A,Gt,nt,El,{current:!1}]};return function(e){var n=e.findFiberByHostInstance;!function(e){if("undefined"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__)return!1;var t=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(t.isDisabled||!t.supportsFiber)return!0;try{var n=t.inject(e);Ll=function(e){try{t.onCommitFiberRoot(n,e,void 0,!(64&~e.current.effectTag))}catch(e){}},Nl=function(e){try{t.onCommitFiberUnmount(n,e)}catch(e){}}}catch(e){}}(t({},e,{overrideHookState:null,overrideProps:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:q.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Qe(e))?null:e.stateNode},findFiberByHostInstance:function(e){return n?n(e):null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null}))}({findFiberByHostInstance:Tn,bundleType:0,version:"16.14.0",rendererPackageName:"react-dom"}),Mg.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tc,Mg.createPortal=ec,Mg.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternalFiber;if(void 0===t){if("function"==typeof e.render)throw Error(i(188));throw Error(i(268,Object.keys(e)))}return null===(e=Qe(t))?null:e.stateNode},Mg.flushSync=function(e,t){if((Na&(_a|Ea))!==Sa)throw Error(i(187));var n=Na;Na|=1;try{return Vr(99,e.bind(null,t))}finally{Na=n,$r()}},Mg.hydrate=function(e,t,n){if(!Zl(t))throw Error(i(200));return Jl(null,e,t,!0,n)},Mg.render=function(e,t,n){if(!Zl(t))throw Error(i(200));return Jl(null,e,t,!1,n)},Mg.unmountComponentAtNode=function(e){if(!Zl(e))throw Error(i(40));return!!e._reactRootContainer&&(hl((function(){Jl(null,null,e,!1,(function(){e._reactRootContainer=null,e[En]=null}))})),!0)},Mg.unstable_batchedUpdates=dl,Mg.unstable_createPortal=function(e,t){return ec(e,t,2<arguments.length&&void 0!==arguments[2]?arguments[2]:null)},Mg.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Zl(n))throw Error(i(200));if(null==e||void 0===e._reactInternalFiber)throw Error(i(38));return Jl(e,t,n,!1,r)},Mg.version="16.14.0",Mg}()),Dg.exports),jg=r(Ug);window.ReactDOM=jg;var zg,Vg,Wg,Hg,$g,Gg,qg,Yg,Kg,Xg,Qg,Zg,Jg,em,tm,nm,im,rm,om,sm,am,lm,cm,um,dm,hm,pm,fm,gm,mm,ym,vm,bm,wm,km,xm,Sm,Cm,_m,Em=n({__proto__:null,default:jg},[Ug]),Tm={};function Pm(){return Cm?Sm:(Cm=1,Sm=[{event:"playing",once:!0,trackAs:"startedplaying"},{event:"window.pagehide",trackAs:"dropoff"},{event:"window.orientationchange",trackAs:"orientationchange"},{event:"document.visibilitychange",trackAs:"visibilitychange"},{event:"switched",trackAs:"channelswitched"},"fullscreenchange","loadeddata","canplay","play","pause","playing","waiting","seeking","seeked","ended","cdnchosen","playerperformance","contextnotprogress","enginechange","metamorphosis.destengineloadstart","metamorphosis.destengineready","metamorphosis.abandondestengine"])}!function(){if(_m)return Tm;_m=1;var e=Vg?zg:(Vg=1,zg={name:"tracker",type:"plugin",options:{autoInit:!1,version:"0.0.1",deps:[{name:"debug",optional:"orderonly"}]}}),t={once:!1,trackAs:""},n=function(){if(xm)return km;xm=1;var e=(Hg||(Hg=1,Wg=function(e){var t=e.player;return{regex:/^.*$/,fn:function(){return{playerinstanceid:e.core.options.playerInstanceId||"DEFAULT",isautoplay:!!t.options.autoplay,isdebugenabled:!!t.initedPlugins.debug,playerversion:t.version||"0.0.0",playerengine:t.engine||"unknown",playerkbps:e.controller.bitrate/1e3||0,playerqoe:t.qoe.score||0,playerqoestatus:t.qoe.status||"",playerfps:"number"==typeof t.qoe.envFps?t.qoe.envFps:0,playerbitratemultiplier:e.bitrateMultiplier.value||0,playerstatename:e.controller._state.name.split("State")[0].toLowerCase(),totalplayingtime:e.streamQuality.totalPlayingTime||0,totalwaitingtime:e.streamQuality.totalWaitingTime||0,waitingcount:e.streamQuality.waitingCount||0,totalvideoframes:Math.max(e.playbackQuality.totalVideoFrames,0)||0,droppedvideoframes:e.playbackQuality.droppedVideoFrames||0,ismuted:!!t.muted,isaudiolocked:!!t.isAudioLocked,isfullscreen:!!t.isFullscreen,playervolume:t.volume||0,playercontainerwidth:t.containerWidth||0,playercontainerheight:t.containerHeight||0,ispresumedvisible:t.tracker.isPresumedVisible||!1,encodeprofile:e.assetsDeliveryService.settings.profile||""}},schema:"iglu:com.helloeko/player/jsonschema/1-0-6"}}),Wg),t=Gg?$g:(Gg=1,$g=function(e){return{regex:"playerperformance",fn:function(e){return{cuepoint:e.cuepoint||0}},schema:"iglu:com.helloeko/playerperformance/jsonschema/1-0-0"}}),n=(Yg||(Yg=1,qg=function(e){var t=e.player,n=e.IvdTransformer.engineTechs;return{regex:/^.*$/,fn:function(){var e=t.currentNode,i=e&&e.segment&&e.segment.subsegments&&e.segment.subsegments.length?e.segment.subsegments[e.segment.currentSubSegmentIndex]:e&&e.segment;if(!i||!i.chosenRepresentation||!i.chosenRepresentation.width)return{segmentvideowidth:0,segmentvideoheight:0,segmentvideoformat:""};var r,o,s=i.chosenRepresentation;return s.components?(r=s.components[n.WEBCODECS]||s,o=s.components[n.WEB_AUDIO]||s):(r=s,o=s),{segmentvideowidth:r.width||0,segmentvideoheight:r.height||0,segmentvideoformat:r.format||"",segmentaudioformat:o.format||"",segmentvideorep:r.label||"",segmentaudiorep:o.label||"",segmentmeasuredvideokbps:r.measuredBandwidth/1e3||0,segmentmeasuredaudiokbps:o.measuredBandwidth/1e3||0,segmentchosenvideokbps:r.bandwidth/1e3||0,segmentchosenaudiokbps:o.bandwidth/1e3||0,segmentvideobitrates:i.representations.filter((function(e){return!e.altIndex&&e.format===r.format})).map((function(e){return e.bandwidth/1e3||0})).sort((function(e,t){return e-t})),segmentaudiobitrates:i.representations.filter((function(e){return!e.altIndex&&e.format===o.format})).map((function(e){return e.bandwidth/1e3||0})).sort((function(e,t){return e-t})),segmentvideobitratemultiplier:r.bitrateMultiplier||0,segmentaudiobitratemultiplier:o.bitrateMultiplier||0,segmentaudiourl:o.url||"",segmentvideourl:r.url||""}},schema:"iglu:com.helloeko/segment/jsonschema/1-0-1"}}),qg),i=(Xg||(Xg=1,Kg=function(e){var t=e.player;return{regex:/^.*$/,fn:function(){var e=t.currentNode;return{currentnodeid:t.currentNodeId||"",currentnodeindex:t.currentNodeIndex||0,currentnodechannelcount:e&&e.videoTracksCount||1,currentnodechannelindex:e&&e.currentVideoTrackIndex||0,currentnodetime:t.currentNodeTime||0,currentnodeduration:t.currentNodeDuration||0,currentnodeisspark:!!(e&&e.data&&e.data.spark),currentnodestudioname:e&&e.data&&e.data.studioMeta&&e.data.studioMeta.name||"",currentnodeprofile:e&&e.metadata&&e.metadata.profile||""}},schema:"iglu:com.helloeko/currentnode/jsonschema/1-0-1"}}),Kg),r=Zg?Qg:(Zg=1,Qg=function(){return{regex:"channelswitched",fn:function(e,t){return{previouschannelindex:Number(e),currentchannelindex:Number(t)}},schema:"iglu:com.helloeko/channelswitched/jsonschema/1-0-0"}}),o=em?Jg:(em=1,Jg=function(e,t){var n={projectid:t&&t.project&&t.project.id||"",aliasedid:t&&t.project&&t.project.aliasedid||"",projecttitle:t&&t.project&&t.project.title||"",projectslug:t&&t.project&&t.project.slug||"",showid:t&&t.project&&t.project.showId||"",showtitle:t&&t.project&&t.project.showTitle||"",showslug:t&&t.project&&t.project.showSlug||"",episodenumber:t&&t.project&&t.project.episodeNumber||0,watchtimeseconds:t&&t.project&&t.project.watchTimeSeconds||0,apiversion:t&&t.project&&t.project.APIVersion||""};return{regex:/^.*$/,fn:function(){return n},schema:"iglu:com.helloeko/project/jsonschema/1-0-0",disabled:!n.projectid}}),s=nm?tm:(nm=1,tm=function(){return{regex:"cdnchosen",fn:function(e){var t=e.cdnsBandwidth||{},n=Object.keys(t),i={};return n.forEach((function(e){i[e]=t[e].map((function(e){return e/1e3||0}))})),{baseurl:e.baseUrl||[],cdnname:e.cdn||"",cdnsbandwidth:i}},schema:"iglu:com.helloeko/cdnchosen/jsonschema/1-0-0"}}),a=rm?im:(rm=1,im=function(e,t){var n={};return t&&t.instance&&(t.instance.id&&(n.id=t.instance.id),t.instance.schemaVersion&&(n.schemaVersion=t.instance.schemaVersion),t.instance.lastPublishedBy&&(n.lastPublishedBy=t.instance.lastPublishedBy),t.instance.lastPublishedAt&&(n.lastPublishedAt=t.instance.lastPublishedAt)),{regex:/^.*$/,fn:function(){return n},schema:"iglu:com.helloeko/instance/jsonschema/1-0-0",disabled:!n.id}}),l=sm?om:(sm=1,om=function(e,t){var n={};return t&&t.template&&(t.template.id&&(n.id=t.template.id),t.template.name&&(n.name=t.template.name),t.template.schemaId&&(n.schemaId=t.template.schemaId),t.template.implementation&&(n.implementation=t.template.implementation)),{regex:/^.*$/,fn:function(){return n},schema:"iglu:com.helloeko/template/jsonschema/2-0-0",disabled:!n.id}}),c=lm?am:(lm=1,am=function(e,t){var n={};return t&&t.space&&t.space.id&&(n={...t.space}),{regex:/^.*$/,fn:function(){return n},schema:"iglu:com.helloeko/space/jsonschema/1-0-2",disabled:!n.id}}),u=um?cm:(um=1,cm=function(e,t){var n={};return t&&t.organization&&t.organization.id&&(n.id=t.organization.id),{regex:/.*/,fn:function(){return n},schema:"iglu:com.helloeko/organization/jsonschema/1-0-0",disabled:!n.id}}),d=hm?dm:(hm=1,dm=function(e,t){var n={};return t&&t.asset&&(n=t.asset),{regex:/.*/,fn:function(){return n},schema:"iglu:com.helloeko/asset/jsonschema/1-0-0",disabled:!t.asset}}),h=fm?pm:(fm=1,pm=function(e,t){var n={};return t&&t.product&&(n.items=[t.product]),{regex:/.*/,fn:function(){return n},schema:"iglu:com.helloeko/products/jsonschema/1-0-1",disabled:!n.items}}),p=mm?gm:(mm=1,gm=function(e,t){var n={};return t&&t.publishItem&&(t.publishItem.id&&(n.id=t.publishItem.id),t.publishItem.productId&&(n.productid=t.publishItem.productId),t.publishItem.salesChannelId&&(n.saleschannelid=t.publishItem.salesChannelId),t.publishItem.salesChannelName&&(n.saleschannelname=t.publishItem.salesChannelName),t.publishItem.salesChannelType&&(n.saleschanneltype=t.publishItem.salesChannelType)),{regex:/^.*$/,fn:function(){return n},schema:"iglu:com.helloeko/publishitem/jsonschema/1-0-0",disabled:!n.id}}),f=vm?ym:(vm=1,ym=function(e,t){var n;return{regex:/.*/,fn:function(){var e;return{embeddingapp:null===(e=window.eko)||void 0===e||null===(e=e.environment)||void 0===e?void 0:e.embeddingApp}},schema:"iglu:com.helloeko/environment/jsonschema/1-0-0",disabled:!(null!==(n=window.eko)&&void 0!==n&&n.environment)}});const g=(wm||(wm=1,bm=function(e){const t=e.player,n=e.utils.getTime;let i=0,r=0;const o=()=>{r||(r=n())};return t.on("seeking",(()=>{i||(i=n())})),t.on("seeked",o),{regex:"seeked",fn:function(){o();const e=i&&r&&r>i?(r-i)/1e3:0;return i=0,r=0,{seekduration:e}},schema:"iglu:com.helloeko/seeked/jsonschema/1-0-0"}}),bm);var m=[e,t,n,i,r,o,s,a,l,c,u,d,h,p,f,g];return km={init:function(e,t,n,i){m.forEach((function(r){var o=r(e,n,i);o.disabled?i.info("[Packers] Not registering disabled packer: '"+o.schema+"'."):(i.info("[Packers] Registering packer for schema '"+o.schema+"' with regex: "+o.regex),t.registerContextPacker({match:o.regex,getData:o.fn,schema:o.schema}))}))}},km}(),r=Pm();i&&i.InterludePlayer&&i.InterludePlayer.registerPlugin?i.InterludePlayer.registerPlugin(e.name,(function(i,o){var s=i.BaseModuleClass.extend({name:"Tracker",logLevel:"warn",version:e.options.version,excludeFuncFromAutoDebug:["logEAMissingError","onTrackedEvent","calcForwarderIdFromOptions"],defaults:{defaultForwarders:r,forwarders:[],project:{id:"",aliasedid:"",title:"",slug:"",showId:"",showTitle:"",showSlug:"",episodeNumber:0,watchTimeSeconds:0},trackingEnabled:!0},events:{},forwarders:{},hasLoggedEAMissingError:!1,onWindowPageHide:function(){i.player.trigger("window.pagehide")},onWindowOrientationChange:function(){i.player.trigger("window.orientationchange")},onDocumentVisibilityChange:function(){i.player.trigger("document.visibilitychange")},addDocumentListeners:function(){window.addEventListener("pagehide",this.onWindowPageHide),window.addEventListener("orientationchange",this.onWindowOrientationChange),document.addEventListener("visibilitychange",this.onDocumentVisibilityChange)},removeDocumentListeners:function(){window.removeEventListener("pagehide",this.onWindowPageHide),window.removeEventListener("orientationchange",this.onWindowOrientationChange),document.removeEventListener("visibilitychange",this.onDocumentVisibilityChange)},calcForwarderIdFromOptions:function(e){return e.event+":"+!!e.once+":"+e.trackAs},logEAMissingError:function(){this.settings.trackingEnabled&&(this.hasLoggedEAMissingError||(this.log.error("EkoAnalytics not found on the window"),this.hasLoggedEAMissingError=!0))},onTrackedEvent:function(e,t){var n=[t.trackAs||e].concat(Array.prototype.slice.call(arguments,2));this.track.apply(this,n)},normalizeOpts:function(e){return!(!e||"object"==typeof e&&!e.event||"string"!=typeof e&&"object"!=typeof e)&&("string"==typeof e?i.utils.extend({event:e},t):i.utils.extend({},t,e))},registerContextPacker:function(e){window.EkoAnalytics?window.EkoAnalytics("registerContextPacker",e):this.logEAMissingError()},addEventForwarder:function(e){var t=this.normalizeOpts(e);if(t){var n=this.calcForwarderIdFromOptions(t);this.forwarders[n]?this.log.warn("[addEventForwarder] Tracker for '"+t.event+"' with these options has already been setup - ignoring",t):(this.forwarders[n]={event:t.event,options:t,listener:this.onTrackedEvent.bind(this,t.event,t)},i.player[t.once?"once":"on"](t.event,this.forwarders[n].listener))}else this.log.error("[addEventForwarder] Invalid argument given, expected a string, or an object that contains an 'event' property, instead got:",e)},removeEventForwarder:function(e){var t=this.normalizeOpts(e);if(t){var n=this.calcForwarderIdFromOptions(t);this.forwarders[n]?(i.player.off(t.event,this.forwarders[n].listener),delete this.forwarders[n]):this.log.warn("[removeEventForwarder] Tracker for '"+t.event+"' with these options was not found - ignoring",t)}else this.log.error("[removeEventForwarder] Invalid argument given, expected a string, or an object that contains an 'event' property, instead got:",e)},track:function(e){if(this.settings.trackingEnabled)if(window.EkoAnalytics)if(e&&"string"==typeof e){var t=Array.prototype.slice.call(arguments,1);this.log.info("[track] Tracking event '"+e+"' with args:",t),window.EkoAnalytics.apply(window.EkoAnalytics,["track",e].concat(t))}else this.log.error("[track] Invalid first argument given, expected a string, instead got:",e);else this.logEAMissingError()},ctor:function(){i.utils.extend(!0,i.player.events,this.events),n.init(i,this,this.settings,this.log),this.getSetting("defaultForwarders",[]).forEach(this.addEventForwarder),this.getSetting("forwarders",[]).forEach(this.addEventForwarder),this.addDocumentListeners(),this.defineProperty("isPresumedVisible",(function(){return i.presumedVisibility.isPresumedVisible})),this.defineProperty("getVersion",(function(){return this.version})),i.player.pluginInited("debug").then(function(){var e=i.player.debug.__getComponent("eventsPanel")(i);i.player.debug.addTab("Tracker",e.dom);var t=this.track;this.track=function(){t.apply(this,arguments),e.addEvent.apply(e,arguments)}}.bind(this)),this.expose({track:this.track,addEventForwarder:this.addEventForwarder,removeEventForwarder:this.removeEventForwarder,registerContextPacker:this.registerContextPacker,version:this.exposeProperty("getVersion","version"),isPresumedVisible:this.exposeProperty("isPresumedVisible")})},dispose:function(){this._super.apply(this,arguments),Object.keys(this.forwarders).forEach(function(e){this.removeEventForwarder(this.forwarders[e].options)}.bind(this)),this.removeDocumentListeners()}});i.player.tracker=new s({Tracker:o}).exports}),e.options):i&&i.console&&i.console.error&&i.console.error("Could not register tracker plugin")}();var Im,Am,Om,Lm,Nm,Rm,Dm,Mm,Fm,Bm,Um,jm,zm,Vm,Wm,Hm,$m,Gm,qm,Ym,Km,Xm,Qm,Zm,Jm,ey,ty,ny,iy,ry,oy,sy,ay,ly,cy,uy,dy,hy,py,fy,gy,my,yy,vy,by,wy,ky,xy,Sy,Cy,_y,Ey,Ty,Py={};function Iy(){return Am?Im:(Am=1,Im={name:"decision",type:"plugin",options:{autoInit:!1,version:"2.0.0",deps:[{name:"tracker",optional:"orderonly"},{name:"debug",optional:"orderonly"}]}})}function Ay(){if(Lm)return Om;Lm=1;var e=function(){};e.prototype.registerProperty=function(e,t){this[e]=t},e.prototype.removeProperty=function(e){delete this[e]},e.prototype.registerAllPropertiesOf=function(e){Object.keys(e).forEach((function(t){this.registerProperty(t,e[t])}),this)};var t=new e;return Om=t}function Oy(){if(Rm)return Nm;Rm=1;var e=Ay();return Nm={ensureNode:function(t){if(t&&e.player.repository.has(t))return e.player.repository.get(t);e.notifyError("Node could not be found in the repository ("+t+").")},warnIfNotSubset:function(t=[],n=[]){n.forEach((function(n){-1===t.indexOf(n)&&e.log.warn("options.defaults contains a node that is not in options.children ("+n.id+").")}))}},Nm}function Ly(){if(Bm)return Fm;Bm=1;var e,t=Ay();function n(){var e=new t.EventEmitter;this.on=e.on.bind(e),this.once=e.once.bind(e),this.off=e.off.bind(e),this.trigger=e.trigger.bind(e),this.addEventListeners()}return Object.defineProperty(n.prototype,"array",{get:function(){return Array.prototype.slice.call(t.player.playlist).filter((function(e,n){return!(n>t.player.currentNodeIndex&&e.data&&!0===e.data.decisionIgnore)}))},configurable:!0}),n.prototype.push=function(e){return t.player.playlist.push(e)},n.prototype._onPlaylistPush=function(e,t){e.data&&!0===e.data.decisionIgnore||this.trigger("playlistpush",e,t)},n.prototype.addEventListeners=function(){this._onPlaylistPush=this._onPlaylistPush.bind(this),t.player.on("playlistpush",this._onPlaylistPush)},n.getInstance=function(t){return e&&!t||(e=new n),e},Fm=n}function Ny(){if(jm)return Um;jm=1;var e=Ay();function t(t,n,i){var r;if(t.isParallel&&i&&i._channelsDefaults){var o=e.player&&e.player.currentNode&&e.player.currentNode.currentVideoTrackIndex||0;r=!!i._channelsDefaults[o]&&i._channelsDefaults[o]}else{var s=i.defaults||n;r=!(!s||!s.length)&&s[Math.floor(Math.random()*s.length)]}return e.log.debug("Default decider returned",r),r}return t.isDefaultDecider=!0,Um=t}function Ry(){if(Xm)return Km;Xm=1;var e=Ay();function t(e,t){return e>=0?e:t+e}return Km={normalizeStartTime:function(n,i){var r=e.controller.nodeDuration(n),o=t(e.getSetting("startTime"),r),s=e.controller.getCriticalTime();return"number"!=typeof i||r<=s?o:i>r-s?(e.log.warn("Requested decision start time is past critical time - using default time instead ("+n.id+")."),o):i=t(i,r)},normalizeEndTime:function(n,i){var r=e.controller.nodeDuration(n);return"number"!=typeof i?{endTime:r,endTimeIsDefault:!0}:i=t(i,r)},normalizeCheckpointTime:function(t,n,i){var r=e.controller.nodeDuration(t);return e.mathUtils.clamp(n+i,0,r)}}}function Dy(){if(Zm)return Qm;Zm=1;var e=Ry(),t=Oy(),n=Ay();return Qm={normalizeAddArgs:function(i,r,o,s){var a,l,c,u,d,h,p,f,g;n.utils.isPlainObject(r)&&(o=r,r=void 0),i=t.ensureNode(i),o=n.utils.extend(!1,{},{children:r},o);var m=n.utils.extend(!1,{},s?{}:i.data&&i.data.decision||{},o);return!m.children&&s||(a=(a=[].concat(a=m.children||[])).map(t.ensureNode)),m.defaults&&(l=(l=[].concat(m.defaults)).map(t.ensureNode)),c=m._channelsDefaults,void 0===m.startTime&&!0===s||(u=e.normalizeStartTime(i,m.startTime)),void 0===m.endTime&&!0===s||(d=e.normalizeEndTime(i,m.endTime)),void 0!==u&&void 0!==d&&u>d?n.notifyError("Decision start time is past decision end time ("+i.id+")."):(h=m&&m.decider,void 0===(p=m&&void 0!==m.prefetch?m.prefetch:void 0)&&!0!==s&&(p=n.getSetting("prefetch")),f=m&&m.checkpoints,!0!==s&&(f=n.utils.extend(!0,{},n.getSetting("checkpoints"),f)),f&&f.hasOwnProperty("time")&&(f.normalizedTime=e.normalizeCheckpointTime(i,u,f.time)),void 0===(g=m&&m.includeInCheckpoints)&&!0!==s&&(g=n.getSetting("includeInCheckpoints")),{parent:i,children:a,defaults:l,_channelsDefaults:c,startTime:u,endTime:d,decider:h,prefetch:p,checkpoints:f,includeInCheckpoints:g,autoPushSingleChild:m&&m.autoPushSingleChild,autoSelectLoopingNode:m&&m.autoSelectLoopingNode})}},Qm}function My(){if(ey)return Jm;ey=1;var e=Dy(),t=Ay(),n=Oy(),i=["checkpoints"];return Jm={update:function(r,o,s){var a=e.normalizeAddArgs(r.parent,o,s,!0);n.warnIfNotSubset(a.children||r.children,a.defaults||r.defaults),r.beforeUpdate(),Object.keys(a).forEach((function(e){if("parent"!==e&&void 0!==a[e])return i.indexOf(e)>-1?t.utils.extend(!0,r[e],a[e]):void(r[e]=a[e])})),r.afterUpdate()}},Jm}function Fy(){return hy?dy:(hy=1,dy={addOrUpdateDebugLine:function(e,t,n){var i=e.getAttribute("id")+"-"+t.toLowerCase().replace(/\W+/g,"_"),r=e.querySelector("#"+i);r?(r.classList.add("ekodebug-decision-debugline-changed"),window.setTimeout((function(){r.classList.remove("ekodebug-decision-debugline-changed")}),2220)):((r=document.createElement("div")).setAttribute("id",i),r.setAttribute("class","ekodebug-decision-debugline"),r.innerHTML='<span class="label"></span>: <span class="value"></span>',r.querySelector(".label").innerText=t,e.appendChild(r)),r.querySelector(".value").innerText=n}})}function By(e,t){void 0===t&&(t={});var n=t.insertAt;if(e&&"undefined"!=typeof document){var i=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css","top"===n&&i.firstChild?i.insertBefore(r,i.firstChild):i.appendChild(r),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e))}}function Uy(){return vy?yy:(vy=1,yy=Object.freeze({DECISION_ADDED:"DECISION_ADDED",DECISION_UPDATED:"DECISION_UPDATED",DECISION_REMOVED:"DECISION_REMOVED",DECISION_START:"DECISION_START",DECISION_END:"DECISION_END",DECISION_MADE:"DECISION_MADE",DECISION_TIME_UPDATE:"DECISION_TIME_UPDATE"}))}function jy(){if(xy)return ky;xy=1;var e=function(){if(wy)return by;wy=1;var e=Uy();function t(e){return e&&e.parent&&e.parent.id||""}function n(e){return(e||[]).map((function(e){return e&&e.id||""}))}function i(e,t){return e&&e.selected&&e.selected.node?{node:e.selected.node.id||"",autoDecided:e.selected.autoDecided||!1,seek:e.selected.seek||!1,data:e.selected.data||{},selectionTime:"number"==typeof t?t:void 0}:{}}function r(e){return e&&e.duration?e.duration-e.remainingTime:0}return by={decisionAdded:function(o){var s=t(o);return{type:e.DECISION_ADDED,id:s,parent:s,children:n(o.children),defaults:n(o.defaults),state:o.state||"",time:r(o),duration:o.duration||0,progress:o.progress||0,remainingTime:o.remainingTime||o.duration||0,selected:i(o)}},decisionUpdated:function(o){var s=t(o);return{type:e.DECISION_UPDATED,id:s,parent:s,children:n(o.children),defaults:n(o.defaults),state:o.state||"",time:r(o),duration:o.duration||0,progress:o.progress||0,remainingTime:o.remainingTime||o.duration||0,selected:i(o)}},decisionRemoved:function(n){var i=t(n);return{type:e.DECISION_REMOVED,id:i}},decisionStart:function(n){var r=t(n);return{type:e.DECISION_START,id:r,state:n.state,selected:i(n)}},decisionEnd:function(n){var i=t(n);return{type:e.DECISION_END,id:i,state:n.state}},decisionMade:function(n){var o=t(n);return{type:e.DECISION_MADE,id:o,state:n.state,selected:i(n,r(n))}},decisionTimeUpdate:function(n){var i=t(n);return{type:e.DECISION_TIME_UPDATE,id:i,time:r(n),progress:n.progress,remainingTime:n.remainingTime}}},by}();return ky=function(t){var n=t.player,i=n&&n.reduxStore&&n.reduxStore.dispatch,r=t.BaseModuleClass.extend({name:"DecisionReduxBridge",logLevel:"warn",excludeFuncFromAutoDebug:["onDecisionTimeUpdate"],decisionRepo:null,addRemoveDecisionRepoListeners:function(e){this.decisionRepo&&(this.decisionRepo[e="add"===e?"on":"off"]("added",this.onDecisionAdded),this.decisionRepo[e]("updated",this.onDecisionUpdated),this.decisionRepo[e]("removed",this.onDecisionRemoved))},addDecisionRepoListeners:function(){this.addRemoveDecisionRepoListeners("add")},removeDecisionRepoListeners:function(){this.addRemoveDecisionRepoListeners("remove")},onDecisionAdded:function(t){this.addDecisionListeners(t),i(e.decisionAdded(t))},onDecisionUpdated:function(t){this.removeDecisionListeners(t),this.addDecisionListeners(t),i(e.decisionUpdated(t))},onDecisionRemoved:function(t){this.removeDecisionListeners(t),i(e.decisionRemoved(t))},addRemoveDecisionListeners:function(e,t){t?(t[e="add"===e?"on":"off"]("start",this.onDecisionStart),t[e]("end",this.onDecisionEnd),t[e]("made",this.onDecisionMade),t[e]("timeupdate",this.onDecisionTimeUpdate)):this.log.warn("[addRemoveDecisionListeners] No decision instance given:",e,t)},addDecisionListeners:function(e){this.addRemoveDecisionListeners("add",e||this.currDecision)},removeDecisionListeners:function(e){this.addRemoveDecisionListeners("remove",e||this.currDecision)},onDecisionStart:function(t){i(e.decisionStart(t))},onDecisionEnd:function(t){i(e.decisionEnd(t))},onDecisionMade:function(t){i(e.decisionMade(t))},onDecisionTimeUpdate:function(t){i(e.decisionTimeUpdate(t))},ctor:function(e){"function"==typeof i&&(this.decisionRepo=e,this.addDecisionRepoListeners())},dispose:function(){this._super.apply(this,arguments),this.removeDecisionRepoListeners()}});return r},ky}function zy(){if(Cy)return Sy;Cy=1;var e=Iy(),t=function(){if(uy)return cy;uy=1;var e=function(){if(ly)return ay;ly=1;var e=Ay(),t=Oy(),n=Mm?Dm:(Mm=1,Dm=function(e,t){t.forEach((function(t){e.addPrefetch(t)}))}),i=Ly(),r=function(){if(Hm)return Wm;Hm=1;var e=function(){if(Vm)return zm;Vm=1;var e=Ay(),t=Oy(),n=Ny();return zm={test:function(i){return!(!0!==e.getSetting("autoPushSingleChild",!1)||!0!==i.autoPushSingleChild||!i||!i.children||1!==i.children.length||i.defaults&&1!==i.defaults.length||i.defaults&&1===i.defaults.length&&t.ensureNode(i.defaults[0])!==t.ensureNode(i.children[0])||i.decider||e.getSetting("decider")!==n||i.parent.isParallel&&i._channelsDefaults)}}}(),t=Ly();return Wm=function(n){if(n!==this.parent)return!1;if(!0!==e.test(this))return!1;var i=this.children[0],r=t.getInstance().array.length;setTimeout(function(){var e=t.getInstance().array.length;t.getInstance().array[e-1]===this.parent&&e===r&&i!==this.parent&&(t.getInstance().push(i),this.selected.autoDecided=!0)}.bind(this),0)}}(),o=function(){if(Gm)return $m;Gm=1;var e=Ay();function t(e,t,n){this.setProps(e,t,n),this.maybeRegisterCheckpoint()}return t.prototype.setProps=function(e,t,n){this.parent=e,this.children=t||[],this.enabled=n.enabled,this.singleChild=n.singleChild,this.normalizedTime=n.normalizedTime},t.prototype.maybeRegisterCheckpoint=function(){this.enabled&&(0===this.children.length||1===this.children.length&&!this.singleChild||e.player.pluginInited("checkpoints").then(function(){e.player.checkpoints.register(this.parent,this.normalizedTime,{tags:["decision",this.parent.id]}),this.registeredCheckpointAtTime=this.normalizedTime}.bind(this)))},t.prototype.maybeUnregisterCheckpoint=function(){e.player.pluginInited("checkpoints").then(function(){this.hasOwnProperty("registeredCheckpointAtTime")&&(e.player.checkpoints.unregister(this.parent,this.registeredCheckpointAtTime),delete this.registeredCheckpointAtTime)}.bind(this))},t.prototype.update=function(e,t,n){var i=!0;t=t||[],i=(i=i&&this.children.length===t.length)&&this.children.reduce((function(e,n,i){return e&&n===t[i]}),!0),(i=(i=(i=i&&this.enabled===n.enabled)&&this.singleChild===n.singleChild)&&this.normalizedTime===n.normalizedTime)||(this.setProps(e,t,n),this.maybeUnregisterCheckpoint(),this.maybeRegisterCheckpoint())},t.prototype.dispose=function(){this.maybeUnregisterCheckpoint()},$m=t}(),s=function(){if(Ym)return qm;Ym=1;var e=Ay();function t(e){this.instance=e,this.onStart=this.onStart.bind(this),this.onEnd=this.onEnd.bind(this),this.onAutoPush=this.onAutoPush.bind(this),this.onUpdated=this.onUpdated.bind(this),this.onMade=this.onMade.bind(this),this.addEventListeners()}return t.prototype.onStart=function(t){e.player.trigger("decision.start",t.parent,t),t.parent.trigger("decision.start",t.parent,t)},t.prototype.onEnd=function(t){e.player.trigger("decision.end",t.parent,t),t.parent.trigger("decision.end",t.parent,t)},t.prototype.onAutoPush=function(t,n){e.player.trigger("decision.autopush",t,n)},t.prototype.onUpdated=function(t){e.player.trigger("decision.updated",t.parent,t),t.parent.trigger("decision.updated",t.parent,t)},t.prototype.onMade=function(t){e.player.trigger("decision.made",t.parent,t),t.parent.trigger("decision.made",t.parent,t)},t.prototype.addEventListeners=function(){this.instance.on("start",this.onStart),this.instance.on("end",this.onEnd),this.instance.on("autopush",this.onAutoPush),this.instance.on("updated",this.onUpdated),this.instance.on("made",this.onMade)},t.prototype.removeEventListeners=function(){this.instance.off("start",this.onStart),this.instance.off("end",this.onEnd),this.instance.off("autopush",this.onAutoPush),this.instance.off("updated",this.onUpdated),this.instance.off("made",this.onMade)},t.prototype.dispose=function(){this.removeEventListeners()},qm=t}(),a=function(){if(ny)return ty;ny=1;var e=My();return ty=function(t,n,i,r){Object.defineProperty(n,i,{get:function(){return t[i]},set:r?void 0:function(n){var r={};return r[i]=n,e.update(t,r),n},enumerable:!0})},ty}(),l=function(){if(ry)return iy;ry=1;var e=My();return iy=function(t,n){Object.defineProperty(n,"checkpoints",{get:function(){return function(t){var n={};return Object.defineProperty(n,"time",{get:function(){return t.checkpoints.time},set:function(n){return e.update(t,{checkpoints:{time:n}}),n},enumerable:!0}),Object.defineProperty(n,"enabled",{get:function(){return t.checkpoints.enabled},set:function(n){return e.update(t,{checkpoints:{enabled:n}}),n},enumerable:!0}),Object.defineProperty(n,"singleChild",{get:function(){return t.checkpoints.singleChild},set:function(n){return e.update(t,{checkpoints:{singleChild:n}}),n},enumerable:!0}),n}(t)},set:function(n){return e.update(t,{checkpoints:n}),n},enumerable:!0})},iy}(),c=function(){if(sy)return oy;sy=1;var e=Ay(),t=Ny();return oy=function(n,i,r,o,s){var a,l={defaults:o,_channelsDefaults:s};"function"==typeof n&&(a=n(i,r,l));var c=e.getSetting("decider");return void 0===a&&"function"==typeof c&&(a=c(i,r,l)),void 0===a&&c!==t&&(a=t(i,r,l)),a},oy}(),u="inactive",d="active",h="made",p=function(t,i,a,l,c,d,h,p,f,g,m){var y=new e.EventEmitter;this.on=y.on.bind(y),this.once=y.once.bind(y),this.off=y.off.bind(y),this.trigger=y.trigger.bind(y),this.parent=t,this.children=i,this.defaults=a,this._channelsDefaults=l,this.startTime=c,Object.defineProperty(this,"endTime",{get:function(){return this._endTime},set:function(e){this._endTime="object"==typeof e?e.endTime:e,this.endTimeIsDefault="object"==typeof e&&e.endTimeIsDefault}}),this.endTime=d,this.decider=h,this.prefetch=p,this.prefetch&&n(this.parent,this.children),this._onGlobalTimeUpdate=this._onGlobalTimeUpdate.bind(this),this._onStartTime=this._onStartTime.bind(this),this._onEndTime=this._onEndTime.bind(this),this._onNodeCritical=this._onNodeCritical.bind(this),this._onParentPushedToPlaylist=r.bind(this),this._onFilteredPlaylistPush=this._onFilteredPlaylistPush.bind(this),this._onSeeked=this._onSeeked.bind(this),this._handleListeners=this._handleListeners.bind(this),this.make=this.make.bind(this),this._state=u,this.selected={},this._handleListeners("on"),this.checkpoints=f,this.decisionCheckpointer=new o(this.parent,this.children,this.checkpoints),this.globalEventForwarder=new s(this),this.includeInCheckpoints=g,this.autoSelectLoopingNode=m,this.isLooping=!1,this.autoPushSingleChild=!0,this.defineLegacyDataProp()};return Object.defineProperty(p.prototype,"data",{get:function(){var e={};return a(this,e,"parent",!0),a(this,e,"children"),a(this,e,"defaults"),a(this,e,"_channelsDefaults"),a(this,e,"selected",!0),a(this,e,"decider"),a(this,e,"startTime"),a(this,e,"endTime"),a(this,e,"endTimeIsDefault"),a(this,e,"prefetch"),l(this,e),a(this,e,"includeInCheckpoints"),a(this,e,"autoSelectLoopingNode"),a(this,e,"state",!0),a(this,e,"autoPushSingleChild"),a(this,e,"duration",!0),a(this,e,"remainingTime",!0),a(this,e,"progress",!0),e}}),Object.defineProperty(p.prototype,"exports",{get:function(){return e.utils.extend(this.data,{on:this.on,off:this.off,once:this.once,trigger:this.trigger,make:this.make})}}),p.prototype.defineLegacyDataProp=function(){this.parent.data=this.parent.data||{},Object.defineProperty(this.parent.data,"_decision",{get:function(){return this.data}.bind(this),configurable:!0})},p.prototype.removeLegacyDataProp=function(){this.parent.data&&this.parent.data._decision&&delete this.parent.data._decision},p.prototype.make=function(n,r){var o;if(r=r||{},this.state!==u)if(this.state!==h||r.seek){if(n?o=t.ensureNode(n):(o=c(this.decider,this.parent,this.children,this.defaults,this._channelsDefaults))&&(o=t.ensureNode(o)),o)if(this.isLooping=r.autoDecided&&o===e.player.currentNode&&this.autoSelectLoopingNode,this.isLooping||this._setState(h,o,r),r.seek)e.player.seek(o);else{var s=i.getInstance().push(o);r.autoDecided&&this.trigger("autopush",o,s-1)}}else e.log.warn("Attempted to call make() on an an already-made decision. Returning.");else e.log.warn("Attempted to call make() on an inactive decision. Returning.")},Object.defineProperty(p.prototype,"duration",{get:function(){return this.endTime-this.startTime}}),Object.defineProperty(p.prototype,"remainingTime",{get:function(){return this.state===u||e.player.currentNodeTime<this.startTime?this.duration:e.player.currentNodeTime>this.endTime?0:this.endTime-e.player.currentNodeTime}}),Object.defineProperty(p.prototype,"progress",{get:function(){return(this.duration-this.remainingTime)/this.duration}}),p.prototype._setState=function(e,t,n){switch(n=n||{},this._state=e,e){case u:this.selected={},this.isLooping=!1,this.trigger("end",this),this._stopForwardingTimeUpdates();break;case d:this.trigger("start",this),this._startForwardingTimeUpdates();break;case h:this.isLooping=!1,this.selected={node:t,autoDecided:n.autoDecided||!1,seek:n.seek||!1,data:n.data||{}},this.trigger("made",this)}},Object.defineProperty(p.prototype,"state",{get:function(){return this._state},set:p.prototype._setState}),Object.defineProperty(p.prototype,"_endTimeEventName",{get:function(){return this.endTimeIsDefault?"nodeend":"timeupdate:"+this.endTime}}),p.prototype._startForwardingTimeUpdates=function(){e.player.on("timeupdate",this._onGlobalTimeUpdate)},p.prototype._stopForwardingTimeUpdates=function(){e.player.off("timeupdate",this._onGlobalTimeUpdate)},p.prototype._onGlobalTimeUpdate=function(){this.trigger("timeupdate",this)},p.prototype._onStartTime=function(){if(!this.isLooping){this._setState(d);var t=i.getInstance().array,n=e.player.currentNodeIndex;n!==t.length-1&&this._setState(h,t[n+1],{autoDecided:!1})}},p.prototype._onEndTime=function(){this.isLooping||(this.state===d&&this.make(void 0,{autoDecided:!0}),this._setState(u))},p.prototype._onNodeCritical=function(){this.state===d&&this.make(void 0,{autoDecided:!0})},p.prototype._onFilteredPlaylistPush=function(t){this.state!==d||this.isLooping&&t===e.player.currentNode||this._setState(h,t,{autoDecided:!1})},p.prototype._onSeeked=function(){this.state!==d&&this.state!==h||this._setState(u)},p.prototype._handleListeners=function(t){this.parent[t]("timeupdate:"+this.startTime,this._onStartTime),this.parent[t](this._endTimeEventName,this._onEndTime),this.parent[t]("nodecritical",this._onNodeCritical),this.parent[t]("playlistpush",this._onParentPushedToPlaylist),i.getInstance()[t]("playlistpush",this._onFilteredPlaylistPush),e.player[t]("seeked",this._onSeeked),e.player[t]("playlistreset",this._onSeeked)},p.prototype.beforeUpdate=function(){this._handleListeners("off")},p.prototype.afterUpdate=function(){this._handleListeners("on"),this.prefetch&&n(this.parent,this.children),this.decisionCheckpointer.update(this.parent,this.children,this.checkpoints),this.trigger("updated",this)},p.prototype.dispose=function(){this._handleListeners("off"),this.removeLegacyDataProp(),this.decisionCheckpointer.dispose(),this.globalEventForwarder.dispose(),this._stopForwardingTimeUpdates()},p.prototype.serialize=function(){var e=function(e){return"string"==typeof e?e:e.id},t=this.children&&this.children.map(e),n=this.defaults&&this.defaults.map(e),i=null;return this._channelsDefaults&&(i=this._channelsDefaults.map(e)),{children:t,defaults:n,_channelsDefaults:i,startTime:this.startTime,endTime:this.endTime,endTimeIsDefault:this.endTimeIsDefault,prefetch:this.prefetch,checkpoints:this.checkpoints,includeInCheckpoints:this.includeInCheckpoints,autoPushSingleChild:this.autoPushSingleChild,autoSelectLoopingNode:this.autoSelectLoopingNode}},ay=p}(),t=Dy(),n=Oy(),i=Ay(),r=My(),o=function(){this.nodeIdToDecisionInstances={};var e=new i.EventEmitter;this.on=e.on.bind(e),this.off=e.off.bind(e),this.once=e.once.bind(e),this.trigger=e.trigger.bind(e)};return o.prototype.add=function(n,r,o){var s=t.normalizeAddArgs(n,r,o);if(this.nodeIdToDecisionInstances[s.parent.id])return i.log.warn("Decision already exists for node "+s.parent.id+". Calling `update()` instead."),this.update(n,r,o);var a=new e(s.parent,s.children,s.defaults,s._channelsDefaults,s.startTime,s.endTime,s.decider,s.prefetch,s.checkpoints,s.includeInCheckpoints,s.autoSelectLoopingNode);return this.nodeIdToDecisionInstances[s.parent.id]=a,this.trigger("added",a.exports),a.exports},o.prototype.get=function(e){if("string"==typeof e&&"all"===e)return Object.keys(this.nodeIdToDecisionInstances).map(function(e){return this.nodeIdToDecisionInstances[e].exports}.bind(this));var t=n.ensureNode(e);return this.nodeIdToDecisionInstances[t.id]&&this.nodeIdToDecisionInstances[t.id].exports},o.prototype.update=function(e,t,i){e=n.ensureNode(e);var o=this.nodeIdToDecisionInstances[e.id];return o?(r.update(o,t,i),this.trigger("updated",o.exports),o.exports):this.add(e,t,i)},o.prototype.remove=function(e){var t=n.ensureNode(e),i=this.nodeIdToDecisionInstances[t.id];return i&&"function"==typeof i.dispose&&i.dispose(),delete this.nodeIdToDecisionInstances[t.id],this.trigger("removed",i),t},o.prototype.dispose=function(){Object.keys(this.nodeIdToDecisionInstances).forEach((function(e){this.remove(e)}),this)},o.prototype.serialize=function(){var e={};return Object.keys(this.nodeIdToDecisionInstances).forEach((function(t){"function"==typeof this.nodeIdToDecisionInstances[t].serialize&&!0===this.nodeIdToDecisionInstances[t].includeInCheckpoints&&(e[t]=this.nodeIdToDecisionInstances[t].serialize())}),this),e},o.prototype.deserialize=function(e){e&&Object.keys(e).forEach((function(t){this.update(t,e[t])}),this)},cy=o}(),n=Ay(),i=Ny(),r=function(){if(my)return gy;my=1;var e=Ay(),t=function(){if(fy)return py;fy=1;var e=Fy(),t=function(e){this.instance=e,this.decisionInstanceDiv=this.createDecisionInstanceDiv(e),this.onParentNodeStart=this.onParentNodeStart.bind(this),this.onParentNodeEnd=this.onParentNodeEnd.bind(this),this.onStart=this.onStart.bind(this),this.onMade=this.onMade.bind(this),this.onEnd=this.onEnd.bind(this),this.addInstanceListeners(),this.addParentListeners()};return Object.defineProperty(t.prototype,"DOMElement",{get:function(){return this.decisionInstanceDiv}}),t.prototype.onParentNodeStart=function(){e.addOrUpdateDebugLine(this.decisionInstanceDiv,"state",this.instance.state),this.decisionInstanceDiv.classList.remove("node-inactive"),this.decisionInstanceDiv.classList.add("node-active")},t.prototype.onParentNodeEnd=function(){this.decisionInstanceDiv.classList.remove("node-active"),this.decisionInstanceDiv.classList.add("node-inactive")},t.prototype.addParentListeners=function(){this.instance.parent.on("nodestart",this.onParentNodeStart),this.instance.parent.on("nodeend",this.onParentNodeEnd)},t.prototype.removeParentListeners=function(){this.instance.parent.off("nodestart",this.onParentNodeStart),this.instance.parent.off("nodeend",this.onParentNodeEnd)},t.prototype.onStart=function(t){e.addOrUpdateDebugLine(this.decisionInstanceDiv,"state",t.state)},t.prototype.onMade=function(t){e.addOrUpdateDebugLine(this.decisionInstanceDiv,"state",t.state),e.addOrUpdateDebugLine(this.decisionInstanceDiv,"selected",t.selected&&t.selected.node&&t.selected.node.id)},t.prototype.onEnd=function(t){e.addOrUpdateDebugLine(this.decisionInstanceDiv,"state",t.state)},t.prototype.addInstanceListeners=function(){this.instance.on("start",this.onStart),this.instance.on("made",this.onMade),this.instance.on("end",this.onEnd)},t.prototype.removeInstanceListeners=function(){this.instance.off("start",this.onStart),this.instance.off("made",this.onMade),this.instance.off("end",this.onEnd)},t.prototype.createDecisionInstanceDiv=function(t){var n=document.createElement("div");return n.setAttribute("class","ekodebug-decision-instance"),n.setAttribute("id","ekodebug-decision-instance-"+t.parent.id.replace(/\W+/g,"_")),n.classList.add("node-inactive"),e.addOrUpdateDebugLine(n,"Node Id",t.parent.id),e.addOrUpdateDebugLine(n,"children",t.children.map((function(e){return e.id})).join(", ")),e.addOrUpdateDebugLine(n,"startTime",t.startTime),e.addOrUpdateDebugLine(n,"endTime",t.endTime),n},t.prototype.dispose=function(){this.removeInstanceListeners(),this.removeParentListeners()},py=t}(),n=function(e){this._pluginInstance=e,this.onDecisionAdd=this.onDecisionAdd.bind(this),this.onDecisionRemove=this.onDecisionRemove.bind(this),this.addPluginListeners(),this.addDebugOverlay(),this.nodeIdToDebugDecisionInstances={},this._pluginInstance.get("all").forEach(this.onDecisionAdd)};return n.prototype.addPluginListeners=function(){this._pluginInstance.on("debug.add",this.onDecisionAdd),this._pluginInstance.on("debug.remove",this.onDecisionRemove)},n.prototype.removePluginListeners=function(){this._pluginInstance.off("debug.add",this.onDecisionAdd),this._pluginInstance.off("debug.remove",this.onDecisionRemove)},n.prototype.onDecisionAdd=function(e){var n=new t(e);this._decisionInstanceContainer.appendChild(n.DOMElement),this.nodeIdToDebugDecisionInstances[e.parent.id]=n},n.prototype.onDecisionRemove=function(e){var t=this.nodeIdToDebugDecisionInstances[e.id];t&&(t.dispose(),this._decisionInstanceContainer.removeChild(t.DOMElement),delete this.nodeIdToDebugDecisionInstances[e.id])},n.prototype.addDebugOverlay=function(){if(e.player.debug&&"function"==typeof e.player.debug.addTab){var t=document.createElement("div");t.setAttribute("class","ekodebug-decision"),t.innerHTML='<div class="ekodebug-decision-main">\n    <div class="ekodebug-decision-decision-instance-container"></div>\n</div>\n',e.player.debug.addTab("decision",t,{title:"Decision"}),this._decisionInstanceContainer=t.querySelector(".ekodebug-decision-decision-instance-container")}else this.log.debug("[addDebugOverlay]::","cannot add overlay - debug plugin not available.")},gy=n}(),o=jy();return Sy={initFunction:function(s,a){var l=s.BaseModuleClass.extend({name:"Decision",logLevel:"warn",_version:e.options.version,defaults:{checkpoints:{enabled:!0,singleChild:!1,time:-5},prefetch:!0,autoPushSingleChild:!0,startTime:1e-4,decider:i,includeInCheckpoints:!0},events:{decisionstart:"decision.start",decisionmade:"decision.made",decisionend:"decision.end",decisionautopush:"decision.autopush",decisionupdated:"decision.updated"},decisionReduxBridge:null,exposeSetting:function(e,t){this.exports=this.exports||{},Object.defineProperty(this.exports,e,{enumerable:!0,get:this.getSetting.bind(this,e),set:t?void 0:this.setSetting.bind(this,e)})},initTracking:function(){s.player.tracker&&(s.player.tracker.registerContextPacker({match:"decision.made",schema:"iglu:com.helloeko/decision_made/jsonschema/1-0-0",getData:function(e,t){return{parent:t&&t.parent&&t.parent.id||"",children:t&&t.children&&t.children.map((function(e){return e.id}))||[],selected_node:t&&t.selected&&t.selected.node&&t.selected.node.id||"",selected_autodecided:!!(t&&t.selected&&t.selected.autoDecided)}}}),s.player.tracker.addEventForwarder("decision.made"))},add:function(e,t,n){var i=this.decisionRepo.add(e,t,n);return this.trigger("debug.add",i),i},get:function(e){return this.decisionRepo.get(e)},update:function(e,t,n){return this.decisionRepo.update(e,t,n)},data:function(e){var t=this.decisionRepo.get(e);return s.utils.extend(!1,{},t.data)},remove:function(e){return e=this.decisionRepo.remove(e),this.trigger("debug.remove",e),e},saveState:function(){return this.decisionRepo.serialize()},restoreState:function(e){return this.decisionRepo.deserialize(e)},ctor:function(){n.registerAllPropertiesOf(s),n.registerProperty("getSetting",this.getSetting),n.registerProperty("log",this.log),n.registerProperty("notifyError",this.notifyError),this.decisionRepo=new t,s.utils.extend(!0,s.player.events,this.events),this.decisionReduxBridge=new(o(s))(a,this.decisionRepo),this.initTracking(),this.exposeSetting("prefetch"),this.exposeSetting("autoPushSingleChild"),this.exposeSetting("startTime"),this.exposeSetting("decider"),s.player.pluginInited("checkpoints").then(function(){s.player.checkpoints.registerModule("decision",this.saveState,this.restoreState,{deps:[]})}.bind(this)),this.expose({add:this.add,update:this.update,get:this.get,remove:this.remove,data:this.get,dispose:this.dispose,getDecisionStartTime:function(e){var t=this.get(e);return t?t.startTime:void 0}.bind(this),getDecisionEndTime:function(e){var t=this.get(e);return t?t.endTime:void 0}.bind(this)}),this.defineProperty("version",(function(){return this._version})),this.exposeProperty("version"),s.player.pluginInited("debug").then(function(){this.debugManager=new r(this)}.bind(this))},dispose:function(){this._super(),this.decisionRepo.dispose()}}),c=new l({Decision:a});return s.player.decision=c.exports,c}},Sy}By("div.ekodebug-decision-main {\n    position: absolute;\n    display: inline-block;\n    z-index: 999;\n    bottom: 50px;\n    left: 10px;\n    max-width: 100%;\n\n    color: #000;\n    opacity: 0.65;\n\n    text-align: center;\n    font-size: 16px;\n    font-family: sans-serif;\n\n    transition: all .4s ease;\n}\n\ndiv.ekodebug-decision-debugline {\n    width: 100%;\n    padding-bottom: 5px;\n    padding-top: 5px;\n}\n\ndiv.ekodebug-decision-debugline > span.value {\n    font-weight: 100;\n}\n\n.ekodebug-decision-debugline-changed {\n    animation: redglow 2s forwards;\n}\n\n@keyframes redglow {\n    from {\n        background-color: white; \n    }\n    50% {\n        background-color: #D18181;\n    }\n    to {\n        background-color: white; \n    }\n}\n\ndiv.ekodebug-decision-requests-container {\n    margin: 5px;\n}\n\ndiv.ekodebug-decision-instance {\n    transition: all .4s ease;\n    display: inline-block;\n    background-color: #fff;\n    border-radius: 3px;\n    margin-right: 5px;\n    padding: 0px 10px 0px 10px;\n}\n\ndiv.ekodebug-decision-instance.node-inactive {\n    display: none;\n}\n\ndiv.ekodebug-decision-instance.node-active {\n    display: inline-block;\n}\n\ndiv.ekodebug-decision-instance-container {\n    margin: 5px;\n}\n"),function(){if(Ty)return Py;Ty=1;var e=zy(),t=Iy(),n=function(){if(Ey)return _y;Ey=1;var e=Uy(),t={parent:"",children:[],defaults:[],state:"",time:0,duration:0,progress:0,remainingTime:0,selected:{}},n={};return _y=function(i,r){if(!e.hasOwnProperty(r.type))return i||n;var o=Object.assign({},i);return r.type===e.DECISION_REMOVED?delete o[r.id]:o[r.id]=function(n,i){var r=Object.assign({},n||t);switch(i.type){case e.DECISION_ADDED:case e.DECISION_UPDATED:r.parent=i.parent,r.children=i.children,r.defaults=i.defaults,r.state=i.state,r.time=i.time,r.duration=i.duration,r.progress=i.progress,r.remainingTime=i.remainingTime,r.selected=i.selected;break;case e.DECISION_START:r.state=i.state,r.selected=i.selected;break;case e.DECISION_END:r.state=i.state;break;case e.DECISION_MADE:r.state=i.state,r.selected=i.selected;break;case e.DECISION_TIME_UPDATE:r.time=i.time,r.progress=i.progress,r.remainingTime=i.remainingTime}return r}(o[r.id],r),o},_y}();t.options.redux={reducer:n},function(e,n,i){e&&e.InterludePlayer&&e.InterludePlayer.registerPlugin?e.InterludePlayer.registerPlugin(i,n,t.options):e&&e.console&&e.console.error&&e.console.error("Could not register "+i+" plugin")}(window||Py,e.initFunction,t.name)}();var Vy,Wy,Hy,$y={};!function(){if(Hy)return $y;Hy=1;var e=Wy?Vy:(Wy=1,Vy={name:"overlays",type:"plugin",options:{autoInit:!1,version:"0.0.6",deps:[{name:"uitools",optional:!0}]}});!function(t){var n=["all"],i={display:"none"},r={display:"none"};t&&t.InterludePlayer&&t.InterludePlayer.registerPlugin?t.InterludePlayer.registerPlugin(e.name,(function(t,o){var s=t.BaseModuleClass.extend({name:"Overlays",logLevel:"warn",version:e.options.version,defaults:{masterContainerStyle:{display:"block",position:"absolute",width:"100%",height:"100%",top:"0",left:"0",overflow:"hidden","backface-visibility":"hidden","-webkit-backface-visibility":"hidden","-webkit-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","pointer-events":"none"},fastclickOptions:null,defaultOptions:{wrapperStyle:{display:"block",position:"absolute",width:"100%",height:"100%",top:"0",left:"0",overflow:"hidden"},boxing:!0,scaling:!1,fastclick:!0,pointerEvents:!0,width:854,height:480,visible:!0,hideTimeout:5e3,includeInCheckpoints:!0}},overlays:{},masterContainer:null,masterWidth:0,masterHeight:0,didLazyInit:!1,events:{overlaysresize:"overlays.resize"},onMasterResize:function(){var e=this.masterContainer.offsetWidth,t=this.masterContainer.offsetHeight;this.masterWidth===e&&this.masterHeight===t||(this.masterWidth=e,this.masterHeight=t,this.resizeOverlays())},onVideoScaled:function(){this.resizeOverlays((function(e){return e.options.boxing}))},generateRandomId:function(){return(Math.random()+1).toString(36).substring(7)},styleObjectToString:function(e){var t="";for(var n in e)t+=n+": "+e[n]+"; ";return t.trim()},cssRulesObjToString:function(e,t){var n=e;return n+="{",(n+=this.styleObjectToString(t))+"}"},addStyleTag:function(){var e=document.createElement("style");e.type="text/css";var t=this.cssRulesObjToString("body.inSpark .overlayWrapper",r),n=this.cssRulesObjToString(".overlayWrapper",this.getSetting("defaultOptions.wrapperStyle")),o=this.cssRulesObjToString(".overlayHidden",i);e.appendChild(document.createTextNode(t)),e.appendChild(document.createTextNode(n)),e.appendChild(document.createTextNode(o)),(document.head||document.getElementsByTagName("head")[0]).appendChild(e)},resizeOverlays:function(e){for(var n in this.overlays)e&&!e(this.overlays[n])||this.applyTransforms(this.overlays[n]);t.player.trigger(this.events.overlaysresize)},addResizeListener:function(){window.addResizeListener&&window.addResizeListener(this.masterContainer,this.onMasterResize)},removeResizeListener:function(){if(window.removeResizeListener&&this.masterContainer)try{window.removeResizeListener(this.masterContainer,this.onMasterResize)}catch(e){}},applyTransforms:function(e){var n=e.el.parentNode,i=e.options,r=window.getComputedStyle(n,null).getPropertyValue("display");if(i.visible||"none"!==r){var o=t.utils.extend({},i.wrapperStyle),s="min"===i.boxing&&t.videoScaler.videoWrapperWidth*t.videoScaler.videoWrapperHeight<this.masterWidth*this.masterHeight||"max"===i.boxing&&t.videoScaler.videoWrapperWidth*t.videoScaler.videoWrapperHeight>this.masterWidth*this.masterHeight||"boolean"==typeof i.boxing&&i.boxing;if(s){var a=function(e){var t={};if(e&&"string"==typeof e){var n=e.split(";");(n=n.filter((function(e){return!!e})).map((function(e){return e.split(":").map((function(e){return e.trim()}))}))).forEach((function(e){e&&2===e.length&&(t[e[0]]=e[1])}))}return t}(t.videoScaler.videoWrapperEl&&t.videoScaler.videoWrapperEl.style.cssText);t.utils.extend(o,a={position:a.position||"absolute",top:a.top||0,left:a.left||0,width:a.width||"100%",height:a.height||"100%"})}if(i.scaling){var l=(s?t.videoScaler.videoWrapperWidth:this.masterWidth)/i.width,c=(s?t.videoScaler.videoWrapperHeight:this.masterHeight)/i.height,u=i.width,d=i.height,h=function(){d=c*i.height/l,c=l},p=function(){u=l*i.width/c,l=c};"width"===i.scaling?h():"height"===i.scaling?p():"min"===i.scaling?l<c?h():p():"max"===i.scaling&&(l>c?h():p());var f=o.transform||o["-webkit-transform"]||o["-moz-transform"]||o["-o-transform"]||"",g=o["transform-origin"]||o["-webkit-transform-origin"]||o["-moz-transform-origin"]||o["-o-transform-origin"]||"";f=("scale("+l+", "+c+") "+f).trim(),g=("left top "+g).trim(),o=t.utils.extend(o,{width:u+"px",height:d+"px","-webkit-transform":f,"-ms-transform":f,"-moz-transform":f,"-o-transform":f,transform:f,"-webkit-transform-origin":g,"-ms-transform-origin":g,"-moz-transform-origin":g,"-o-transform-origin":g,"transform-origin":g})}o.display&&delete o.display,i.visible||n.classList.add("overlayHidden");var m=this.styleObjectToString(o);e.styleCssText!==m&&(n.style.cssText=m,e.styleCssText=m)}},initMasterContainer:function(){this.masterContainer=document.createElement("div"),this.masterContainer.setAttribute("id","overlays-"+this.generateRandomId()),this.masterContainer.setAttribute("class","overlaysmastercontainer"),this.masterContainer.setAttribute("style",this.styleObjectToString(this.getSetting("masterContainerStyle"))),t.core.container.appendChild(this.masterContainer)},disposeMasterContainer:function(){this.masterContainer&&this.masterContainer.parentNode&&this.masterContainer.parentNode.removeChild(this.masterContainer),this.masterContainer=null},createWrapper:function(e,t){var n=document.createElement("div");return n.setAttribute("id",e+"-wrapper-"+this.generateRandomId()),n.classList.add("overlayWrapper"),!t.fastclick&&n.classList&&n.classList.add&&n.classList.add("needsclick"),n},wrapElement:function(e,t){var n=this.createWrapper(e,t.options);return n.appendChild(t.el),this.applyTransforms(t),n},doLazyInit:function(){this.addResizeListener(),t.videoScaler.on("videoscaled",this.onVideoScaled),this.onMasterResize(),t.player.uitools&&t.player.uitools.Fastclick?(this.log.info("[doLazyInit] Attaching Fastclick to master container"),t.player.uitools.Fastclick.attach(this.masterContainer,this.getSetting("fastclickOptions"))):this.log.info("[doLazyInit] uitools plugin was not found, not attaching Fastclick to master container")},saveState:function(){return Object.keys(this.overlays).filter((function(e){return this.overlays[e].options&&this.overlays[e].options.includeInCheckpoints}),this).map((function(e){var t=this.overlays[e];return{id:e,innerHTML:t.el.parentNode.innerHTML,options:t.options}}),this)},restoreState:function(e){if(e&&Array.isArray(e)){var n={};Object.keys(this.overlays).forEach((function(e){this.overlays[e].options&&this.overlays[e].options.includeInCheckpoints&&(n[e]={el:this.overlays[e].el,show:this.overlays[e].options.show,hide:this.overlays[e].options.hide},this.remove(e))}),this),e.forEach((function(e){var i,r;n[e.id]||this.log.warn("[restoreState] DOM Element for overlay '"+e.id+"' was not found. Creating new DOM element."),this.add(e.id,n[e.id]&&n[e.id].el||(i=e.innerHTML,(r=document.createElement("div")).innerHTML=i,r.firstChild),t.utils.extend(e.options,{show:n[e.id]&&n[e.id].show,hide:n[e.id]&&n[e.id].hide}))}),this)}},add:function(e,i,r){return"string"!=typeof e?(this.log.error("First argument to the overlays.add() method should be id of type string. Instead got:",e),null):this.overlays.hasOwnProperty(e)?(this.log.error("An overlay with id '"+e+"' already exists. Please remove it before adding."),null):"object"==typeof i&&i instanceof Node&&1===i.nodeType?r&&"object"!=typeof r?(this.log.error("Third (optional) argument to the overlays.add() method should be an options object. Instead got:",r),null):n.indexOf(e)>=0?(this.log.error("Could not create overlay, id '"+e+"' is a reserved keyword."),null):(this.didLazyInit||(this.doLazyInit(),this.didLazyInit=!0),(r=t.utils.extend(!0,{},this.getSetting("defaultOptions"),r||{})).wrapperStyle["pointer-events"]=r.pointerEvents?"auto":"none",i.overlayId=e,this.overlays[e]={el:i,options:r},this.masterContainer.appendChild(this.wrapElement(e,this.overlays[e])),"function"!=typeof r.show&&"function"!=typeof r.hide||this.log.warn("[add] Overlay '"+e+"' uses the show/hide options. They cannot be serialized/deserialized when checkpoints are saved/restored, thus these options will be deprecated in the near future. Instead, use the 2nd argument of the show()/hide() methods."),i):(this.log.error("Second argument to the overlays.add() method should be a DOM element. Instead got:",i),null)},remove:function(e){var t=null;if("all"===e)return t=Object.keys(this.overlays).map(function(e){return this.remove(e)}.bind(this)),t;if(e&&this.overlays.hasOwnProperty(e)){var n=this.overlays[e].el;n.parentNode&&n.parentNode.parentNode&&(n.parentNode.parentNode.removeChild(n.parentNode),n.parentNode.removeChild(n)),t=n,delete this.overlays[e]}else e&&"string"==typeof e?this.log.error("An overlay with id '"+e+"' was not found."):this.log.error("Argument for the overlays.remove() method is expected to be of type string. Instead got:",e);return t},has:function(e){return this.overlays.hasOwnProperty(e)},get:function(e){var t=null;return"all"===e?t=Object.keys(this.overlays).map(function(e){return this.overlays[e].el}.bind(this)):e&&this.overlays.hasOwnProperty(e)?t=this.overlays[e].el:e&&"string"==typeof e?this.log.error("An overlay with id '"+e+"' was not found."):this.log.error("Argument for the overlays.get() method is expected to be of type string. Instead got:",e),t},show:function(e,t){if(e&&"string"==typeof e||this.log.error("Argument for the overlays.show() method is expected to be of type string. Instead got:",e),"all"!==e){var n=this.get(e),i=function(){this.overlays[e].options.visible=!0,this.overlays[e].options.hiding=!1,n.parentNode.classList.remove("overlayHidden"),this.applyTransforms(this.overlays[e])}.bind(this);if(n){var r=t||this.overlays[e].options.show;i(),r&&"function"==typeof r&&r(n)}}else Object.keys(this.overlays).forEach(function(e){this.show(e,t)}.bind(this))},hide:function(e,t,n){if(e&&"string"==typeof e||this.log.error("Argument for the overlays.hide() method is expected to be of type string. Instead got:",e),"all"!==e){var i=this.get(e),r=!1,o=n&&n.timeout||this.overlays[e].options.hideTimeout,s=function(){!r&&i&&i.parentNode&&this.overlays[e]&&this.overlays[e].options&&(r=!0,this.overlays[e].options.visible=!1,this.overlays[e].options.hiding=!1,i.parentNode.classList.add("overlayHidden"))}.bind(this);if(i){var a=t||this.overlays[e].options.hide;if(a&&"function"==typeof a){var l=this.generateRandomId();this.overlays[e].options.hiding=l,a(i,s),setTimeout(function(){r||this.overlays[e].options.hiding!==l||(this.log.warn("User hide function for id '"+e+"' did not invoke hide callback (2nd argument) before timeout. Forcing overlay hide."),s())}.bind(this),o)}else s()}}else Object.keys(this.overlays).forEach(function(e){this.hide(e,t,n)}.bind(this))},ctor:function(){t.utils.extend(!0,t.player.events,this.events),this.initMasterContainer(),this.addStyleTag(),this.defineProperty("getVersion",(function(){return this.version})),t.player.pluginInited("checkpoints").then(function(){t.player.checkpoints.registerModule("overlays",this.saveState,this.restoreState,{deps:[]})}.bind(this)),this.expose({add:this.add,remove:this.remove,get:this.get,has:this.has,show:this.show,hide:this.hide,version:this.exposeProperty("getVersion","version")})},dispose:function(){this._super.apply(this,arguments),this.removeResizeListener(),t.videoScaler.off("videoscaled",this.onVideoScaled),this.disposeMasterContainer()}});t.player.overlays=new s({Overlays:o}).exports}),e.options):t&&t.console&&t.console.error&&t.console.error("Could not register overlays plugin")}(window||$y)}();var Gy,qy,Yy,Ky={};!function(){if(Yy)return Ky;Yy=1;var e=qy?Gy:(qy=1,Gy={name:"interactions",type:"plugin",options:{autoInit:!1,version:"1.1.0",deps:[{name:"tracker",optional:"orderonly"}]}});!function(t){t&&t.InterludePlayer&&t.InterludePlayer.registerPlugin?t.InterludePlayer.registerPlugin(e.name,(function(t,n){var i=t.BaseModuleClass.extend({name:"Interactions",logLevel:"warn",version:e.options.version,defaults:{trackAnalytics:!0},events:{interactionsreport:"interactions.report"},_sessionInteractionCount:0,trackInteraction:function(e){t.player.analytics&&t.player.analytics.ia("interaction",e||{})},migrateProp:function(e,t,n){e&&void 0!==e[t]&&(e[n]=e[t],delete e[t])},migrateV1:function(e,t,n){var i={id:e,data:t,analyticsData:n};return this.migrateProp(i.analyticsData,"interactionSelectedNodeId","decisionnodeid"),this.migrateProp(i.analyticsData,"interactionActionType","studioelementtype"),this.migrateProp(i.analyticsData,"interactionConnectOn","decisionconnecton"),this.migrateProp(i.analyticsData,"interactionElementText","elementtext"),this.migrateProp(i.analyticsData,"interactionSelectedChannelIndex","selectedchannelindex"),i},getInteractionsContext:function(e,t,n){var i=this.migrateV1(e,t||{},n||{}),r=i.analyticsData,o={elementid:String(i.id||"")};return["decision","switchChannel","share","nextVideo","openUrl","replayVideo"].indexOf(r.studioelementtype)>=0&&(o.studioelementtype=r.studioelementtype),"string"==typeof r.elementtext&&(o.elementtext=r.elementtext),"string"==typeof r.decisionnodeid&&(o.decisionnodeid=r.decisionnodeid),["NODE_END","CLICK"].indexOf(r.decisionconnecton)>=0&&(o.decisionconnecton=r.decisionconnecton),"number"!=typeof r.selectedchannelindex&&"string"!=typeof r.selectedchannelindex||(o.selectedchannelindex=r.selectedchannelindex),"string"==typeof r.elementurl&&(o.elementurl=r.elementurl),o},report:function(e,n,i){t.player.trigger(this.events.interactionsreport,e,n,this.getInteractionsContext(e,n,i&&i.analyticsData)),i&&i.hasOwnProperty("trackAnalytics")?i.trackAnalytics&&this.trackInteraction(i&&i.analyticsData):this.getSetting("trackAnalytics")&&this.trackInteraction(i&&i.analyticsData),this._sessionInteractionCount+=1,t.player.trigger(this.events.interactionsreport+":"+this._sessionInteractionCount,e,n,this.getInteractionsContext(e,n,i&&i.analyticsData)),t.player.tracker&&(t.player.tracker.track("interactions.report",e,n,i&&i.analyticsData),this._sessionInteractionCount<3&&t.player.tracker.track("interactions.report:"+this._sessionInteractionCount,e,n,i&&i.analyticsData))},ctor:function(){t.utils.extend(!0,t.player.events,this.events),this.defineProperty("getVersion",(function(){return this.version})),t.player.tracker&&t.player.tracker.registerContextPacker({match:/^interactions\.\w+/,getData:this.getInteractionsContext,schema:"iglu:com.helloeko/interactions/jsonschema/1-0-1"}),this.expose({version:this.exposeProperty("getVersion","version"),report:this.report})},dispose:function(){this._super.apply(this,arguments)}});t.player.interactions=new i({Interactions:n}).exports}),e.options):t&&t.console&&t.console.error&&t.console.error("Could not register interactions plugin")}(window||Ky)}();var Xy,Qy,Zy,Jy={};!function(){if(Zy)return Jy;Zy=1;var e=Qy?Xy:(Qy=1,Xy={name:"ekoplaybutton",type:"plugin",options:{autoInit:!1,version:"0.0.3",deps:[]}});!function(t){t&&t.InterludePlayer&&t.InterludePlayer.registerPlugin?t.InterludePlayer.registerPlugin(e.name,(function(t,n){n=n||{};var i=t.BaseModuleClass.extend({name:"EkoPlayButton",version:e.options.version,logLevel:"warn",defaults:{fullscreen:!1},events:{ekoplaybuttonclick:"ekoplaybutton.click"},playBtnHtml:null,addPlayButtonDOMElement:function(){this.playBtnHtml||(this.playBtnHtml=document.createElement("div"),this.playBtnHtml.id="ekoPlayButton",this.playBtnHtml.style.width="100%",this.playBtnHtml.style.height="100%",this.playBtnHtml.style.top=0,this.playBtnHtml.style.left=0,this.playBtnHtml.style.position="absolute",this.playBtnHtml.style.cursor="pointer",this.playBtnHtml.style.zIndex=9999,t.player.container.appendChild(this.playBtnHtml))},removePlayButtonDOMElement:function(){this.playBtnHtml&&this.playBtnHtml.parentElement&&(this.playBtnHtml.parentElement.removeChild(this.playBtnHtml),this.playBtnHtml=null)},onPlaying:function(){this.removeClickListener(),this.removePlayButtonDOMElement(),this.removePlayerListeners()},onClick:function(){t.player.trigger(this.events.ekoplaybuttonclick);var e=this.getSetting("fullscreen",!1);"string"==typeof e&&(e="mobile"===e.toLowerCase().trim()&&!t.environment.isDesktop||"desktop"===e.toLowerCase().trim()&&t.environment.isDesktop),e&&t.player.isFullscreenSupported()&&t.player.requestFullscreen(),t.player.play()},addClickListener:function(){this.playBtnHtml&&this.playBtnHtml.addEventListener("click",this.onClick)},removeClickListener:function(){this.playBtnHtml&&this.playBtnHtml.removeEventListener("click",this.onClick)},addPlayerListeners:function(){t.player.on("playing",this.onPlaying)},removePlayerListeners:function(){t.player.off("playing",this.onPlaying)},initEkoPlayButton:function(){this.addPlayButtonDOMElement(),this.addClickListener(),this.addPlayerListeners()},ctor:function(){t.utils.extend(!0,t.player.events,this.events),"idle"===t.controller._state.name.split("State")[0].toLowerCase()&&this.initEkoPlayButton(),this.defineProperty("getVersion",(function(){return this.version})),this.expose({version:this.exposeProperty("getVersion","version")})},dispose:function(){this._super.apply(this,arguments),this.removePlayerListeners(),this.removeClickListener(),this.removePlayButtonDOMElement()}});t.player.ekoplaybutton=new i({EkoPlayButton:n}).exports}),e.options):t&&t.console&&t.console.error&&t.console.error("Could not register ekoplaybutton plugin")}(window||Jy)}();var ev,tv,nv,iv,rv,ov,sv,av={};function lv(){if(iv)return nv;function e(e){var t=document.createElement("canvas");return t.style.backfaceVisibility="hidden",e&&(t.width=e.width,t.height=e.height,t.width&&t.height&&t.getContext("2d").drawImage(e,0,0,e.width,e.height,0,0,t.width,t.height)),t}function t(e,t){e&&t&&"function"==typeof t.clearRect&&t.clearRect(0,0,e.width,e.height)}function n(n,i,r,o,s,a){if("function"==typeof a&&a._shouldPreventDefault)return n.info("[utils::resizeCanvas] Preventing default resize, calling custom resize function"),a(i,r,o,s);var l=e(i);i.width=o,i.height=s,l.width&&l.height&&i.width&&i.height&&r&&("function"==typeof r.drawImage?(n.info("[utils::resizeCanvas] Copying frame to resized 2D canvas"),t(i,r),r.drawImage(l,0,0,l.width,l.height,0,0,i.width,i.height)):n.info("[utils::resizeCanvas] Copying frame to a non-2D resized canvas (i.e. WebGL) is not supported")),"function"==typeof a&&a&&(n.info("[utils::resizeCanvas] Calling custom resize function"),a(i,r,o,s,l))}return iv=1,nv={cloneCanvas:e,clearFrame:t,resizeCanvas:n,isValidContextType:function(e){return!(!e||"2d"!==e&&"webgl"!==e&&"experimental-webgl"!==e&&"webgl2"!==e&&"experimental-webgl2"!==e&&"bitmaprenderer"!==e)},optimizeForPerformance:function(e,t){e&&"function"==typeof e.getContext&&(t=t||e.getContext("2d"))&&(t.imageSmoothingQuality="low",t.mozImageSmoothingQuality="low",t.webkitImageSmoothingQuality="low",t.msImageSmoothingQuality="low",t.imageSmoothingEnabled=!1,t.mozImageSmoothingEnabled=!1,t.webkitImageSmoothingEnabled=!1,t.msImageSmoothingEnabled=!1,t._origDrawImage||"function"!=typeof t.drawImage||(t._origDrawImage=t.drawImage,t.drawImage=function(){for(var e=1,n=arguments.length;e<n;++e)arguments[e]=Math.round(arguments[e]);t._origDrawImage.apply(t,arguments)}))},disposeOfCanvas:function(e,n){e&&(t(e,n),e.width=0,e.height=0,n&&n._origDrawImage&&(delete n.drawImage,n.drawImage=n._origDrawImage,delete n._origDrawImage))},resizeCanvasIfNecessary:function(e,t,i,r,o){if(!t.currentNode||!t.currentNode.segment||!t.currentNode.segment.metadata)return!1;let s=t.currentNode.segment.chosenRepresentation||{width:t.videoWidth,height:t.videoHeight},a=t.currentNode.segment.metadata,l=s.width/(o&&o.cropForRTS&&a.cols||1)||t.videoWidth,c=s.height/(o&&o.cropForRTS&&a.rows||1)||t.videoHeight;return!(!l||!c||i.width===l&&i.height===c||(n(e,i,r,l,c,o&&o.userResize),0))}},nv}function cv(){if(ov)return rv;ov=1;var e=lv();return rv=function(t){var n=t.BaseModuleClass.extend({name:"OffscreenVideoCanvas",logLevel:"warn",excludeFuncFromAutoDebug:["drawFrame"],defaults:{performanceOptimizationEnabled:!0,fps:40},canvas:null,canvasContext:null,drawFrame:function(){var n=t.controller.engineCurrentVideoElement;n&&n.videoWidth&&n.videoHeight&&(e.resizeCanvasIfNecessary(this.log,t.player,this.canvas,this.canvasContext),this.canvasContext.drawImage(n,0,0,n.videoWidth,n.videoHeight,0,0,this.canvas.width,this.canvas.height))},startTick:function(){t.ticker.start(this.drawFrame,1e3/this.settings.fps)},stopTick:function(){t.ticker.stop(this.drawFrame)},ctor:function(){this.log.info("[ctor] options:",this.options,"settings:",this.settings),this.canvas=document.createElement("canvas"),this.canvasContext=this.canvas.getContext("2d"),this.getSetting("performanceOptimizationEnabled")&&e.optimizeForPerformance(this.canvas,this.canvasContext),Object.defineProperty(this.canvas,"videoWidth",{enumerable:!0,get:function(){return this.canvas&&this.canvas.width||0}.bind(this)}),Object.defineProperty(this.canvas,"videoHeight",{enumerable:!0,get:function(){return this.canvas&&this.canvas.height||0}.bind(this)}),this.drawFrame(),this.startTick()},dispose:function(){this._super.apply(this,arguments),this.stopTick(),e.disposeOfCanvas(this.canvas,this.canvasContext),this.canvas=null,this.canvasContext=null}});return n},rv}!function(){if(sv)return av;sv=1;var e="2d",t=tv?ev:(tv=1,ev={name:"canvas",type:"plugin",options:{autoInit:!1,version:"1.0.0",deps:[]}}),n=lv(),r=cv();i&&i.InterludePlayer&&i.InterludePlayer.registerPlugin?i.InterludePlayer.registerPlugin(t.name,(function(i,o){const s=i.player.engine.startsWith("metamorphosis"),a=i.player.engine.includes("webcodecs")||s&&i.engine.destEngine.engineStr.includes("webcodecs")?s?i.engine.destEngine.engines[1].video:i.engine.engines[1].video:null;var l="ios"===i.environment.name,c=i.utils.getObjectProperty(i.environment,"browser.name","").toLowerCase().indexOf("safari")>=0||l,u=i.utils.getObjectProperty(i.environment,"os.version","");l&&i.utils.compareVersions(u,"17.4",">=");var d=i.BaseModuleClass.extend({name:"Canvas",logLevel:"warn",version:t.options.version,excludeFuncFromAutoDebug:["drawFrame"],defaults:{enableSafariWithMse:!1,bypassWebcodecsCanvas:!0,autoResize:!0,width:1280,height:720,fps:40,offscreenVideoCanvasEnabled:!l,performanceOptimizationEnabled:!0,drawFrame:null,viewportModeEnabled:!1,viewportModeMaxWidth:1920,viewportModeMaxHeight:1920,viewportModeMinWidth:500,viewportModeMinHeight:500,contextType:e,contextAttributes:null},canvasElement:null,canvasContext:null,fps:null,userDrawFrame:null,_externalSource:null,offscreenVideoCanvas:null,events:{},drawFrame:function(){var t,n,r;this._externalSource||this.offscreenVideoCanvas?(n=(t=this._externalSource||this.offscreenVideoCanvas.canvas).videoWidth||t.displayWidth||t.width,r=t.videoHeight||t.displayHeight||t.height,this.autoResize&&!this.viewportModeEnabled&&this.canvasElement&&this.canvasElement.width&&this.canvasElement.height&&n&&r&&(n!==this.canvasElement.width||r!==this.canvasElement.height)&&this.doResize(n,r)):t=i.controller.engineCurrentVideoElement,this.userDrawFrame?this.userDrawFrame.call(null,this.canvasElement,this.canvasContext,t,i):this.contextType===e&&this.canvasContext&&t&&this.canvasContext.drawImage(t,0,0,n||i.player.videoWidth,r||i.player.videoHeight)},calcViewportModeResolution:function(){const e=i.player.containerWidth*(window.devicePixelRatio||1),t=i.player.containerHeight*(window.devicePixelRatio||1);if(0===e||0===t)return this.log.info(`[calcViewportModeResolution] Container dimensions are ${e}x${t}. Returning minimum dimensions ${this.viewportModeMinWidth}x${this.viewportModeMinHeight}.`),{width:this.viewportModeMinWidth,height:this.viewportModeMinHeight};if(e>this.viewportModeMaxWidth||t>this.viewportModeMaxHeight){let n=Math.min(this.viewportModeMaxWidth/e,this.viewportModeMaxHeight/t);return{width:Math.round(e*n),height:Math.round(t*n)}}if(e<this.viewportModeMinWidth||t<this.viewportModeMinHeight){let n=Math.max(this.viewportModeMinWidth/e,this.viewportModeMinHeight/t);return{width:Math.round(e*n),height:Math.round(t*n)}}return{width:e,height:t}},onContainerResize:function(){if(!(this.viewportModeEnabled&&this.autoResize&&this.canvasElement&&this.canvasContext))return;const e=this.calcViewportModeResolution(),t=e.width,n=e.height;t===this.canvasElement.width&&n===this.canvasElement.height||this.doResize(t,n)},onVideoResize:function(){if(!this.autoResize||!this.canvasElement||!this.canvasContext||this.viewportModeEnabled)return;let e=this.canvasElement.width,t=this.canvasElement.height,r=n.resizeCanvasIfNecessary(this.log,i.player,this.canvasElement,this.canvasContext,{userResize:this.userResize,cropForRTS:!0});this.log.info(r?"[onVideoResize] Resized canvas from ("+e+"x"+t+") to ("+this.canvasElement.width+"x"+this.canvasElement.height+").":"[onVideoResize] Did not resize canvas. Current dimensions: ("+this.canvasElement.width+"x"+this.canvasElement.height+").")},doResize:function(e,t){this.log.info("[doResize] Resizing canvas from ("+this.canvasElement.width+"x"+this.canvasElement.height+") to ("+e+"x"+t+")."),n.resizeCanvas(this.log,this.canvasElement,this.canvasContext,e,t,this.userResize)},addPlayerListeners:function(){i.player.on("resize",this.onVideoResize),i.player.on("containerresize",this.onContainerResize),i.player.on("nodestart",this.onVideoResize),i.player.on("subnodestart",this.onVideoResize)},removePlayerListeners:function(){i.player.off("resize",this.onVideoResize),i.player.off("containerresize",this.onContainerResize),i.player.off("nodestart",this.onVideoResize),i.player.off("subnodestart",this.onVideoResize)},isSupported:function(){var t=!0;return function(){var t=document.createElement("canvas");return!(!t.getContext||!t.getContext(e))}()||(this.log.info("Plugin not supported - current browser does not support the canvas element."),t=!1),t&&this.log.info("Plugin is supported!"),t},hideVideoElement:function(){this.videoElement&&(c&&this.log.warn('[hideVideoElement] Hiding video, may cause "minized/maximized" issues on Safari/iOS.'),this.videoElement.style.display="none")},unhideVideoElement:function(){this.videoElement&&"none"===this.videoElement.style.display&&(this.videoElement.style.display="block")},onWebGLContextLost:function(){this.log.error("WebGL context lost"),i.player.tracker&&"function"==typeof i.player.tracker.track&&i.player.tracker.track("canvas.webglcontextlost")},addCanvasListeners:function(){this.canvasElement&&this.canvasElement.addEventListener("webglcontextlost",this.onWebGLContextLost)},removeCanvasListeners:function(){this.canvasElement&&this.canvasElement.removeEventListener("webglcontextlost",this.onWebGLContextLost)},initCanvas:function(t){if(this.isSupported()){if(t=i.utils.extend({},this.settings,t||{}),this.log.info("[initCanvas] Resolved options:",t),this.canvasElement&&this.disposeCanvas(),t.contextType&&!n.isValidContextType(t.contextType)&&this.log.warn("[init] Unknown 'contextType' given: "+t.contextType+". Will use "+this.getSetting("contextType",e)+" instead."),this.autoResize=t.autoResize,this.viewportModeEnabled=t.viewportModeEnabled,this.viewportModeMaxWidth=t.viewportModeMaxWidth,this.viewportModeMaxHeight=t.viewportModeMaxHeight,this.viewportModeMinWidth=t.viewportModeMinWidth,this.viewportModeMinHeight=t.viewportModeMinHeight,this.contextType=n.isValidContextType(t.contextType)&&t.contextType||n.isValidContextType(this.getSetting("contextType",e))&&this.getSetting("contextType",e)||e,this.contextAttributes=t.contextAttributes||this.getSetting("contextAttributes",null),this.log.info("Using context type '"+this.contextType+"' with attributes:",this.contextAttributes),this.usesAlpha=!!(t.alpha||this.contextAttributes&&this.contextAttributes.alpha),this.canvasElement=document.createElement("canvas"),this.addCanvasListeners(),this.canvasElement.style.cssText="position: absolute; visibility: visible; top: 0px; left: 0px; width: 100%; height: 100%;",this.videoElement.parentNode.appendChild(this.canvasElement),this.canvasContext=this.canvasElement.getContext(this.contextType,this.contextAttributes),this.canvasElement.width=this.viewportModeEnabled?this.calcViewportModeResolution().width:t.width,this.canvasElement.height=this.viewportModeEnabled?this.calcViewportModeResolution().height:t.height,this.fps="number"==typeof t.fps?t.fps:this.getSetting("fps"),this.log.info("Setting fps to "+this.fps),this.log.info("Setting drawFrame function."),this.userDrawFrame="function"==typeof t.drawFrame&&t.drawFrame||null,this.userResize="function"==typeof t.resize&&t.resize||null,a&&this.getSetting("bypassWebcodecsCanvas")&&!this.usesAlpha){const e=()=>{this.log.info("[initCanvas] [doOverrideDrawFrame] Overriding drawFrame function for webcodecs engine."),a.origDoDrawFrame=a.doDrawFrame,a.doDrawFrame=e=>{this._externalSource&&"function"==typeof this._externalSource.close&&this._externalSource.close(),this._externalSource=e}};s&&!i.player.engine.includes("webcodecs")?i.player.once("enginechange",e):e()}this.onVideoResize(),this.onContainerResize(i.player.containerWidth,i.player.containerHeight),this.addPlayerListeners(),i.controller.currentVideoSource=this.canvasElement,t.offscreenVideoCanvasEnabled&&(this.offscreenVideoCanvas=new(r(i))(i.utils.extend({},this.options,t))),t.performanceOptimizationEnabled&&this.contextType===e&&n.optimizeForPerformance(this.canvasElement,this.canvasContext),this.drawFrame(),("boolean"==typeof t.hideVideo?t.hideVideo:!this.usesAlpha)&&this.hideVideoElement(),this.startTick()}else this.log.error("Failed to initialize - the canvas plugin is not supported in current environment.")},disposeCanvas:function(){this.removePlayerListeners(),this.stopTick(),this.unhideVideoElement(),this.canvasElement&&this.canvasElement.parentNode&&this.canvasElement.parentNode.removeChild(this.canvasElement),this.removeCanvasListeners(),n.disposeOfCanvas(this.canvasElement,this.canvasContext),this.canvasElement=null,this.canvasContext=null,a&&this.getSetting("bypassWebcodecsCanvas")&&a.origDoDrawFrame&&(a.doDrawFrame=a.origDoDrawFrame,delete a.origDoDrawFrame),this.offscreenVideoCanvas&&(this.offscreenVideoCanvas.dispose(),this.offscreenVideoCanvas=null),i.controller.currentVideoSource=null,delete this.userDrawFrame,delete this.contextType,delete this.contextAttributes,delete this.usesAlpha},startTick:function(){i.ticker.start(this.drawFrame,this.fps<=0?0:1e3/this.fps)},stopTick:function(){i.ticker.stop(this.drawFrame)},ctor:function(){i.utils.extend(!0,i.player.events,this.events),n.isValidContextType(this.getSetting("contextType"))||(this.log.warn("Invalid value for 'contextType' option: "+this.getSetting("contextType")+". Falling back to 2d."),this.setSetting("contextType",e));var t=this.getSetting("fps");("number"!=typeof t||t<=0)&&this.log.warn("Invalid value for 'fps' option: "+t+". Falling back to 40."),this.defineProperty("videoElement",(function(){return i.rts.videoEl})),this.defineProperty("getVersion",(function(){return this.version})),this.defineProperty("getCanvas",(function(){return this.canvasElement})),this.defineProperty("getContext",(function(){return this.canvasContext})),this.defineProperty("externalSource",(function(){return this._externalSource}),(function(e){e.hasOwnProperty("videoWidth")&&e.hasOwnProperty("videoHeight")?this._externalSource=e:this.log.error("Cannot set 'externalSource', missing properties 'videoWidth' or 'videoHeight")})),this.expose({isSupported:this.isSupported,init:this.initCanvas,drawFrame:this.drawFrame,dispose:this.disposeCanvas,canvas:this.exposeProperty("getCanvas","canvas"),context:this.exposeProperty("getContext","context"),externalSource:this.exposeProperty("externalSource"),version:this.exposeProperty("getVersion","version")})},dispose:function(){this._super.apply(this,arguments),this.disposeCanvas()}});i.player.canvas=new d({Canvas:o}).exports}),t.options):i&&i.console&&i.console.error&&i.console.error("Could not register canvas plugin")}();var uv,dv,hv,pv={};!function(){if(hv)return pv;hv=1;var e=dv?uv:(dv=1,uv={name:"control",type:"plugin",options:{autoInit:!1,version:"0.0.1",deps:[{name:"tracker",optional:"orderonly"}],deprecates:["graph","seek"]}});!function(t){t&&t.InterludePlayer&&t.InterludePlayer.registerPlugin?t.InterludePlayer.registerPlugin(e.name,(function(t,n){var i=t.BaseModuleClass.extend({name:"Control",logLevel:"warn",version:e.options.version,defaults:{replayDelay:.1,active:!0,fastReplay:!0},events:{controlstop:"control.stop",controlreplay:"control.replay"},_replayNode:null,initTracking:function(){t.player.tracker&&(t.player.tracker.addEventForwarder(this.events.controlstop),t.player.tracker.addEventForwarder(this.events.controlreplay))},onPlayerEnded:function(){this.getSetting("fastReplay")&&setTimeout(function(){this.stop()}.bind(this),0)},addPlayerEventListeners:function(){t.player.on(t.player.events.ended,this.onPlayerEnded)},removePlayerEventListeners:function(){t.player.off(t.player.events.ended,this.onPlayerEnded)},isValidReplayNode:function(e){return!!e&&("string"==typeof e?t.player.repository.has(e):"object"==typeof e&&e.id?t.player.repository.has(e.id):!!Array.isArray(e)&&e.reduce(function(e,t){return e&&this.isValidReplayNode(t)}.bind(this),!0))},resolveReplayNodeId:function(e){var n=this.getSetting("fastReplay",!1);return e&&"object"==typeof e&&e.id||e||this._replayNode&&(this._replayNode.id||this._replayNode.map((function(e){return e.id})))||"string"==typeof n&&n||t.player.playlist.length&&t.player.playlist[0]&&t.player.playlist[0].id||""},doActiveStop:function(e){(e=this.resolveReplayNodeId(e))||this.log.warn("Control plugin in active mode and no replay node was set or given"),t.player.once(t.player.events.playlistreset,function(){t.player.trigger(t.player.events.controlstop),setTimeout(function(){e&&(t.player.playlist.length?this.log.error("[stop] Error pushing replay node to playlist - playlist is unexpectedly not empty."):"string"==typeof e?t.player.append(e):t.player.playlist.push.apply(t.player,e))}.bind(this),0)}.bind(this)),t.player.playlist.reset()},doPassiveStop:function(){if(t.player.playlist.length){var e=Array.prototype.slice.call(t.player.playlist,0);t.player.once(t.player.events.playlistreset,function(){t.player.trigger(t.player.events.controlstop),setTimeout(function(){t.player.playlist.length?this.log.error("[stop] Error pushing nodes to playlist - playlist is unexpectedly not empty."):t.player.playlist.push.apply(t.player.playlist,e)}.bind(this),0)}.bind(this)),t.player.playlist.reset()}},stop:function(e){this.getSetting("active",!1)?this.doActiveStop(e):this.doPassiveStop()},shouldUseFastReplay:function(e){var n=this.getSetting("fastReplay",!1);return e=this.resolveReplayNodeId(e),n&&0===t.player.currentTime&&t.player.playlist.length&&(!e||"string"==typeof e&&e===t.player.playlist[0].id||Array.isArray(e)&&e.reduce((function(e,n,i){return e&&n===t.player.playlist[i].id}),!0))},doFullReplay:function(e){var n=1e3*this.getSetting("replayDelay");if(this.isInMidReplay)this.log.warn("Ignoring replay(), already in mid-replay.");else{this.isInMidReplay=!0;var i=this;t.player.once(t.player.events.controlstop,(function(){setTimeout((function(){i.isInMidReplay=!1,t.player.playlist.length?(t.player.play(),t.player.trigger(t.player.events.controlreplay)):i.log.error("Cannot replay. Playlist is empty.")}),n)})),this.stop(e)}},doFastReplay:function(){t.player.play(),t.player.trigger(t.player.events.controlreplay)},replay:function(e){this.shouldUseFastReplay(e)?this.doFastReplay():this.doFullReplay(e)},setReplayNode:function(e){this.isValidReplayNode(e)?this._replayNode="string"==typeof e?t.player.repository.get(e):"object"==typeof e&&e.id?t.player.repository.get(e.id):e.map((function(e){return t.player.repository.get("string"==typeof e?e:e.id)})):this.log.error("Illegal replay node: "+e)},ctor:function(){t.utils.extend(!0,t.player.events,this.events),this.initTracking(),this.defineProperty("active",(function(){return!!this.getSetting("active",!1)}),(function(e){this.setSetting("active",!!e)})),this.defineProperty("getVersion",(function(){return this.version})),this.defineProperty("replayNode",(function(){return this._replayNode}),this.setReplayNode),t.deprecator.addMethod("seek.replay","control.replay"),t.deprecator.addMethod("seek.stop","control.stop"),t.deprecator.addEvent("seek.replay","control.replay"),t.deprecator.addEvent("seek.stop","control.stop"),t.deprecator.addSetter("graph.setHead","control.replayNode"),t.deprecator.addProperty("graph.headNode","control.replayNode"),this.addPlayerEventListeners(),this.expose({stop:this.stop,replay:this.replay,active:this.exposeProperty("active"),replayNode:this.exposeProperty("replayNode"),version:this.exposeProperty("getVersion","version")})},dispose:function(){this._super.apply(this,arguments),this.removePlayerEventListeners()}});t.player.control=new i({Control:n}).exports}),e.options):t&&t.console&&t.console.error&&t.console.error("Could not register control plugin")}(window||pv)}();var fv,gv,mv,yv={};!function(){if(mv)return yv;mv=1;var e=gv?fv:(gv=1,fv={name:"urls",type:"plugin",options:{autoInit:!1,version:"0.0.2",deps:[{name:"tracker",optional:"orderonly"}]}});!function(t){t&&t.InterludePlayer&&t.InterludePlayer.registerPlugin?t.InterludePlayer.registerPlugin(e.name,(function(t,n){var i=t.BaseModuleClass.extend({name:"Urls",logLevel:"warn",version:e.options.version,defaults:{mode:"self"},events:{urlsopen:"urls.open",urlsintent:"urls.intent"},initTracking:function(){t.player.tracker&&t.player.tracker.registerContextPacker({match:"urls.open",schema:"iglu:com.helloeko/urls_open/jsonschema/1-0-0",getData:function(e){return{url:e||""}}})},open:function(e){t.utils.isUrl(e)||this.notifyError("Could not open - illegal url: "+e),t.player.tracker.track(this.events.urlsopen,e);var n=this.getSetting("mode");switch(n){case"self":window&&window.open&&window.open(e);break;case"proxy":t.player.trigger("urls.intent",{url:e});break;default:this.notifyError("Could not open - illegal urls mode: "+n)}},ctor:function(){t.utils.extend(!0,t.player.events,this.events),this.initTracking(),this.defineProperty("getVersion",(function(){return this.version})),this.expose({open:this.open,version:this.exposeProperty("getVersion","version")})}});t.player.urls=new i({Urls:n}).exports}),e.options):t&&t.console&&t.console.error&&t.console.error("Could not register urls plugin")}(window||yv)}();var vv,bv,wv,kv,xv,Sv={exports:{}},Cv={exports:{}},_v={};function Ev(){return bv||(bv=1,Cv.exports=function(){if(vv)return _v;vv=1;var e="function"==typeof Symbol&&Symbol.for,t=e?Symbol.for("react.element"):60103,n=e?Symbol.for("react.portal"):60106,i=e?Symbol.for("react.fragment"):60107,r=e?Symbol.for("react.strict_mode"):60108,o=e?Symbol.for("react.profiler"):60114,s=e?Symbol.for("react.provider"):60109,a=e?Symbol.for("react.context"):60110,l=e?Symbol.for("react.async_mode"):60111,c=e?Symbol.for("react.concurrent_mode"):60111,u=e?Symbol.for("react.forward_ref"):60112,d=e?Symbol.for("react.suspense"):60113,h=e?Symbol.for("react.suspense_list"):60120,p=e?Symbol.for("react.memo"):60115,f=e?Symbol.for("react.lazy"):60116,g=e?Symbol.for("react.block"):60121,m=e?Symbol.for("react.fundamental"):60117,y=e?Symbol.for("react.responder"):60118,v=e?Symbol.for("react.scope"):60119;function b(e){if("object"==typeof e&&null!==e){var h=e.$$typeof;switch(h){case t:switch(e=e.type){case l:case c:case i:case o:case r:case d:return e;default:switch(e=e&&e.$$typeof){case a:case u:case f:case p:case s:return e;default:return h}}case n:return h}}}function w(e){return b(e)===c}return _v.AsyncMode=l,_v.ConcurrentMode=c,_v.ContextConsumer=a,_v.ContextProvider=s,_v.Element=t,_v.ForwardRef=u,_v.Fragment=i,_v.Lazy=f,_v.Memo=p,_v.Portal=n,_v.Profiler=o,_v.StrictMode=r,_v.Suspense=d,_v.isAsyncMode=function(e){return w(e)||b(e)===l},_v.isConcurrentMode=w,_v.isContextConsumer=function(e){return b(e)===a},_v.isContextProvider=function(e){return b(e)===s},_v.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===t},_v.isForwardRef=function(e){return b(e)===u},_v.isFragment=function(e){return b(e)===i},_v.isLazy=function(e){return b(e)===f},_v.isMemo=function(e){return b(e)===p},_v.isPortal=function(e){return b(e)===n},_v.isProfiler=function(e){return b(e)===o},_v.isStrictMode=function(e){return b(e)===r},_v.isSuspense=function(e){return b(e)===d},_v.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===i||e===c||e===o||e===r||e===d||e===h||"object"==typeof e&&null!==e&&(e.$$typeof===f||e.$$typeof===p||e.$$typeof===s||e.$$typeof===a||e.$$typeof===u||e.$$typeof===m||e.$$typeof===y||e.$$typeof===v||e.$$typeof===g)},_v.typeOf=b,_v}()),Cv.exports}function Tv(){if(kv)return wv;kv=1;var e=Tg();function t(){}function n(){}return n.resetWarningCache=t,wv=function(){function i(t,n,i,r,o,s){if(s!==e){var a=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw a.name="Invariant Violation",a}}function r(){return i}i.isRequired=i;var o={array:i,bigint:i,bool:i,func:i,number:i,object:i,string:i,symbol:i,any:i,arrayOf:r,element:i,elementType:i,instanceOf:r,node:i,objectOf:r,oneOf:r,oneOfType:r,shape:r,exact:r,checkPropTypes:n,resetWarningCache:t};return o.PropTypes=o,o}}function Pv(){return xv||(xv=1,Sv.exports=Tv()()),Sv.exports}var Iv,Av,Ov=r(Pv()),Lv=Ig.createContext(null),Nv=function(e){e()},Rv=function(){return Nv},Dv={notify:function(){}},Mv=function(){function e(e,t){this.store=e,this.parentSub=t,this.unsubscribe=null,this.listeners=Dv,this.handleChangeWrapper=this.handleChangeWrapper.bind(this)}var t=e.prototype;return t.addNestedSub=function(e){return this.trySubscribe(),this.listeners.subscribe(e)},t.notifyNestedSubs=function(){this.listeners.notify()},t.handleChangeWrapper=function(){this.onStateChange&&this.onStateChange()},t.isSubscribed=function(){return Boolean(this.unsubscribe)},t.trySubscribe=function(){this.unsubscribe||(this.unsubscribe=this.parentSub?this.parentSub.addNestedSub(this.handleChangeWrapper):this.store.subscribe(this.handleChangeWrapper),this.listeners=function(){var e=Rv(),t=null,n=null;return{clear:function(){t=null,n=null},notify:function(){e((function(){for(var e=t;e;)e.callback(),e=e.next}))},get:function(){for(var e=[],n=t;n;)e.push(n),n=n.next;return e},subscribe:function(e){var i=!0,r=n={callback:e,next:null,prev:n};return r.prev?r.prev.next=r:t=r,function(){i&&null!==t&&(i=!1,r.next?r.next.prev=r.prev:n=r.prev,r.prev?r.prev.next=r.next:t=r.next)}}}}())},t.tryUnsubscribe=function(){this.unsubscribe&&(this.unsubscribe(),this.unsubscribe=null,this.listeners.clear(),this.listeners=Dv)},e}();function Fv(e){var t=e.store,n=e.context,i=e.children,r=Pg.useMemo((function(){var e=new Mv(t);return e.onStateChange=e.notifyNestedSubs,{store:t,subscription:e}}),[t]),o=Pg.useMemo((function(){return t.getState()}),[t]);return Pg.useEffect((function(){var e=r.subscription;return e.trySubscribe(),o!==t.getState()&&e.notifyNestedSubs(),function(){e.tryUnsubscribe(),e.onStateChange=null}}),[r,o]),Ig.createElement((n||Lv).Provider,{value:r},i)}function Bv(){return Bv=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Bv.apply(this,arguments)}function Uv(e,t){if(null==e)return{};var n,i,r={},o=Object.keys(e);for(i=0;i<o.length;i++)t.indexOf(n=o[i])>=0||(r[n]=e[n]);return r}var jv=function(){if(Av)return Iv;Av=1;var e=Ev(),t={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},n={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},i={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},r={};function o(n){return e.isMemo(n)?i:r[n.$$typeof]||t}r[e.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},r[e.Memo]=i;var s=Object.defineProperty,a=Object.getOwnPropertyNames,l=Object.getOwnPropertySymbols,c=Object.getOwnPropertyDescriptor,u=Object.getPrototypeOf,d=Object.prototype;return Iv=function e(t,i,r){if("string"!=typeof i){if(d){var h=u(i);h&&h!==d&&e(t,h,r)}var p=a(i);l&&(p=p.concat(l(i)));for(var f=o(t),g=o(i),m=0;m<p.length;++m){var y=p[m];if(!(n[y]||r&&r[y]||g&&g[y]||f&&f[y])){var v=c(i,y);try{s(t,y,v)}catch(e){}}}}return t},Iv}(),zv=r(jv),Vv=Ev(),Wv="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement?Pg.useLayoutEffect:Pg.useEffect,Hv=[],$v=[null,null];function Gv(e,t){return[t.payload,e[1]+1]}function qv(e,t,n){Wv((function(){return e.apply(void 0,t)}),n)}function Yv(e,t,n,i,r,o,s){e.current=i,t.current=r,n.current=!1,o.current&&(o.current=null,s())}function Kv(e,t,n,i,r,o,s,a,l,c){if(e){var u=!1,d=null,h=function(){if(!u){var e,n,h=t.getState();try{e=i(h,r.current)}catch(e){n=e,d=e}n||(d=null),e===o.current?s.current||l():(o.current=e,a.current=e,s.current=!0,c({type:"STORE_UPDATED",payload:{error:n}}))}};return n.onStateChange=h,n.trySubscribe(),h(),function(){if(u=!0,n.tryUnsubscribe(),n.onStateChange=null,d)throw d}}}var Xv=function(){return[null,0]};function Qv(e,t){void 0===t&&(t={});var n=t.getDisplayName,i=void 0===n?function(e){return"ConnectAdvanced("+e+")"}:n,r=t.methodName,o=void 0===r?"connectAdvanced":r,s=t.renderCountProp,a=void 0===s?void 0:s,l=t.shouldHandleStateChanges,c=void 0===l||l,u=t.storeKey,d=void 0===u?"store":u,h=t.forwardRef,p=void 0!==h&&h,f=t.context,g=void 0===f?Lv:f,m=Uv(t,["getDisplayName","methodName","renderCountProp","shouldHandleStateChanges","storeKey","withRef","forwardRef","context"]),y=g;return function(t){var n=t.displayName||t.name||"Component",r=i(n),s=Bv({},m,{getDisplayName:i,methodName:o,renderCountProp:a,shouldHandleStateChanges:c,storeKey:d,displayName:r,wrappedComponentName:n,WrappedComponent:t}),l=m.pure,u=l?Pg.useMemo:function(e){return e()};function h(n){var i=Pg.useMemo((function(){var e=n.reactReduxForwardedRef,t=Uv(n,["reactReduxForwardedRef"]);return[n.context,e,t]}),[n]),r=i[0],o=i[1],a=i[2],l=Pg.useMemo((function(){return r&&r.Consumer&&Vv.isContextConsumer(Ig.createElement(r.Consumer,null))?r:y}),[r,y]),d=Pg.useContext(l),h=Boolean(n.store)&&Boolean(n.store.getState)&&Boolean(n.store.dispatch);Boolean(d)&&Boolean(d.store);var p=h?n.store:d.store,f=Pg.useMemo((function(){return function(t){return e(t.dispatch,s)}(p)}),[p]),g=Pg.useMemo((function(){if(!c)return $v;var e=new Mv(p,h?null:d.subscription),t=e.notifyNestedSubs.bind(e);return[e,t]}),[p,h,d]),m=g[0],v=g[1],b=Pg.useMemo((function(){return h?d:Bv({},d,{subscription:m})}),[h,d,m]),w=Pg.useReducer(Gv,Hv,Xv),k=w[0][0],x=w[1];if(k&&k.error)throw k.error;var S=Pg.useRef(),C=Pg.useRef(a),_=Pg.useRef(),E=Pg.useRef(!1),T=u((function(){return _.current&&a===C.current?_.current:f(p.getState(),a)}),[p,k,a]);qv(Yv,[C,S,E,a,T,_,v]),qv(Kv,[c,p,m,f,C,S,E,_,v,x],[p,m,f]);var P=Pg.useMemo((function(){return Ig.createElement(t,Bv({},T,{ref:o}))}),[o,t,T]);return Pg.useMemo((function(){return c?Ig.createElement(l.Provider,{value:b},P):P}),[l,P,b])}var f=l?Ig.memo(h):h;if(f.WrappedComponent=t,f.displayName=r,p){var g=Ig.forwardRef((function(e,t){return Ig.createElement(f,Bv({},e,{reactReduxForwardedRef:t}))}));return g.displayName=r,g.WrappedComponent=t,zv(g,t)}return zv(f,t)}}function Zv(e,t){return e===t?0!==e||0!==t||1/e==1/t:e!=e&&t!=t}function Jv(e,t){if(Zv(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(var r=0;r<n.length;r++)if(!Object.prototype.hasOwnProperty.call(t,n[r])||!Zv(e[n[r]],t[n[r]]))return!1;return!0}function eb(e,t){return function(){return t(e.apply(void 0,arguments))}}function tb(e){return function(t,n){var i=e(t,n);function r(){return i}return r.dependsOnOwnProps=!1,r}}function nb(e){return null!=e.dependsOnOwnProps?Boolean(e.dependsOnOwnProps):1!==e.length}function ib(e,t){return function(t,n){var i=function(e,t){return i.dependsOnOwnProps?i.mapToProps(e,t):i.mapToProps(e)};return i.dependsOnOwnProps=!0,i.mapToProps=function(t,n){i.mapToProps=e,i.dependsOnOwnProps=nb(e);var r=i(t,n);return"function"==typeof r&&(i.mapToProps=r,i.dependsOnOwnProps=nb(r),r=i(t,n)),r},i}}!function(e){var t,n=("undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==P?P:"undefined"!=typeof module?module:Function("return this")()).Symbol;"function"==typeof n?n.observable?t=n.observable:(t=n("observable"),n.observable=t):t="@@observable"}();var rb=[function(e){return"function"==typeof e?ib(e):void 0},function(e){return e?void 0:tb((function(e){return{dispatch:e}}))},function(e){return e&&"object"==typeof e?tb((function(t){return function(e,t){if("function"==typeof e)return eb(e,t);if("object"!=typeof e||null===e)throw new Error("bindActionCreators expected an object or a function, instead received "+(null===e?"null":typeof e)+'. Did you write "import ActionCreators from" instead of "import * as ActionCreators from"?');for(var n=Object.keys(e),i={},r=0;r<n.length;r++){var o=n[r],s=e[o];"function"==typeof s&&(i[o]=eb(s,t))}return i}(e,t)})):void 0}],ob=[function(e){return"function"==typeof e?ib(e):void 0},function(e){return e?void 0:tb((function(){return{}}))}];function sb(e,t,n){return Bv({},n,e,t)}var ab=[function(e){return"function"==typeof e?function(e){return function(t,n){var i,r=n.pure,o=n.areMergedPropsEqual,s=!1;return function(t,n,a){var l=e(t,n,a);return s?r&&o(l,i)||(i=l):(s=!0,i=l),i}}}(e):void 0},function(e){return e?void 0:function(){return sb}}];function lb(e,t,n,i){return function(r,o){return n(e(r,o),t(i,o),o)}}function cb(e,t,n,i,r){var o,s,a,l,c,u=r.areStatesEqual,d=r.areOwnPropsEqual,h=r.areStatePropsEqual,p=!1;return function(r,f){return p?function(r,p){var f,g,m=!d(p,s),y=!u(r,o);return o=r,s=p,m&&y?(a=e(o,s),t.dependsOnOwnProps&&(l=t(i,s)),c=n(a,l,s)):m?(e.dependsOnOwnProps&&(a=e(o,s)),t.dependsOnOwnProps&&(l=t(i,s)),c=n(a,l,s)):y?(f=e(o,s),g=!h(f,a),a=f,g&&(c=n(a,l,s)),c):c}(r,f):(a=e(o=r,s=f),l=t(i,s),c=n(a,l,s),p=!0,c)}}function ub(e,t){var n=t.initMapStateToProps,i=t.initMapDispatchToProps,r=t.initMergeProps,o=Uv(t,["initMapStateToProps","initMapDispatchToProps","initMergeProps"]),s=n(e,o),a=i(e,o),l=r(e,o);return(o.pure?cb:lb)(s,a,l,e,o)}function db(e,t,n){for(var i=t.length-1;i>=0;i--){var r=t[i](e);if(r)return r}return function(t,i){throw new Error("Invalid value of type "+typeof e+" for "+n+" argument when connecting component "+i.wrappedComponentName+".")}}function hb(e,t){return e===t}function pb(e){var t={},n=t.connectHOC,i=void 0===n?Qv:n,r=t.mapStateToPropsFactories,o=void 0===r?ob:r,s=t.mapDispatchToPropsFactories,a=void 0===s?rb:s,l=t.mergePropsFactories,c=void 0===l?ab:l,u=t.selectorFactory,d=void 0===u?ub:u;return function(e,t,n,r){void 0===r&&(r={});var s=r.pure,l=void 0===s||s,u=r.areStatesEqual,h=void 0===u?hb:u,p=r.areOwnPropsEqual,f=void 0===p?Jv:p,g=r.areStatePropsEqual,m=void 0===g?Jv:g,y=r.areMergedPropsEqual,v=void 0===y?Jv:y,b=Uv(r,["pure","areStatesEqual","areOwnPropsEqual","areStatePropsEqual","areMergedPropsEqual"]),w=db(e,o,"mapStateToProps"),k=db(t,a,"mapDispatchToProps"),x=db(n,c,"mergeProps");return i(d,Bv({methodName:"connect",getDisplayName:function(e){return"Connect("+e+")"},shouldHandleStateChanges:Boolean(e),initMapStateToProps:w,initMapDispatchToProps:k,initMergeProps:x,pure:l,areStatesEqual:h,areOwnPropsEqual:f,areStatePropsEqual:m,areMergedPropsEqual:v},b))}}var fb=pb();function gb(){return Pg.useContext(Lv)}var mb=function(e,t){return e===t};function yb(e){void 0===e&&(e=Lv);var t=e===Lv?gb:function(){return Pg.useContext(e)};return function(e,n){void 0===n&&(n=mb);var i=t(),r=function(e,t,n,i){var r,o=Pg.useReducer((function(e){return e+1}),0)[1],s=Pg.useMemo((function(){return new Mv(n,i)}),[n,i]),a=Pg.useRef(),l=Pg.useRef(),c=Pg.useRef(),u=Pg.useRef(),d=n.getState();try{r=e!==l.current||d!==c.current||a.current?e(d):u.current}catch(e){throw a.current&&(e.message+="\nThe error may be correlated with this previous error:\n"+a.current.stack+"\n\n"),e}return Wv((function(){l.current=e,c.current=d,u.current=r,a.current=void 0})),Wv((function(){function e(){try{var e=l.current(n.getState());if(t(e,u.current))return;u.current=e}catch(e){a.current=e}o()}return s.onStateChange=e,s.trySubscribe(),e(),function(){return s.tryUnsubscribe()}}),[n,s]),r}(e,n,i.store,i.subscription);return Pg.useDebugValue(r),r}}var vb,bb,wb=yb();Nv=Ug.unstable_batchedUpdates;var kb=r(bb?vb:(bb=1,vb={name:"ui",type:"plugin",options:{autoInit:!1,version:"1.0.1",deps:[{name:"overlays"},{name:"project",optional:"orderonly"},{name:"interactions",optional:"orderonly"}],loadingDeps:[{name:"react"},{name:"gsap"}]}}));let xb={};var Sb,Cb={DECISION:"DECISION",PARALLEL:"PARALLEL",GROUP:"GROUP",MENU_LAYER:"MENU_LAYER",Root:"Root",EkoGroup:"EkoGroup",EkoMenuLayer:"EkoMenuLayer",EkoButton:"EkoButton",EkoDecisionButton:"EkoDecisionButton",EkoLottieDecisionButton:"EkoLottieDecisionButton",EkoLottieTimer:"EkoLottieTimer",EkoSimpleButton:"EkoSimpleButton",EkoDefaultButton:"EkoDefaultButton",EkoParallelButton:"EkoParallelButton",EkoTimer:"EkoTimer",EkoTransition:"EkoTransition",EkoDefaultTimer:"EkoDefaultTimer",LegacyDefaultButton:"LegacyDefaultButton",LegacyBevelButton:"LegacyBevelButton",LegacyFacebookButton:"LegacyFacebookButton",LegacyFlatRoundButton:"LegacyFlatRoundButton",LegacyFunRoundButton:"LegacyFunRoundButton",LegacyLineButton:"LegacyLineButton",LegacyPlayButton:"LegacyPlayButton",LegacyReplayButton:"LegacyReplayButton",LegacySimpleButton:"LegacySimpleButton",LegacyTagButton:"LegacyTagButton",LegacyTextBoldButton:"LegacyTextBoldButton",LegacyTextButton:"LegacyTextButton",LegacyTumblerButton:"LegacyTumblerButton",LegacyTwitterButton:"LegacyTwitterButton",LegacyImageButton:"LegacyImageButton",LegacyPureTimer:"LegacyPureTimer",LegacyPieTimer:"LegacyPieTimer",LegacySimpleTimer:"LegacySimpleTimer",LegacyBarTimer:"LegacyBarTimer",LegacyStripTimer:"LegacyStripTimer",LegacyOldschoolTimer:"LegacyOldschoolTimer",LegacyClockTimer:"LegacyClockTimer",LegacyThermoTimer:"LegacyThermoTimer",LegacyCircleTimer:"LegacyCircleTimer",LegacyBounceToggle:"LegacyBounceToggle",LegacyCornerToggle:"LegacyCornerToggle",LegacySmoothToggle:"LegacySmoothToggle",LegacyElegantToggle:"LegacyElegantToggle",LegacyRollingToggle:"LegacyRollingToggle",LegacyWinkToggle:"LegacyWinkToggle",DECISION_SELECT:"DECISION_SELECT",TRIGGER_EVENT:"TRIGGER_EVENT",NODE_SELECT:"NODE_SELECT",PARALLEL_SWITCH:"PARALLEL_SWITCH",OPEN_URL:"OPEN_URL",SHARE:"SHARE",TOGGLE_PLAY:"TOGGLE_PLAY",PLAY_SOUND:"PLAY_SOUND",MENU_LAYER_EXPAND_COLLAPSE:"MENU_LAYER_EXPAND_COLLAPSE",REPORT_INTERACTION:"REPORT_INTERACTION",NEXT_VIDEO:"NEXT_VIDEO",REPLAY_VIDEO:"REPLAY_VIDEO",NODE_END:"NODE_END",CLICK:"CLICK",MENU_TOGGLE:"MENU_TOGGLE"},_b={},Eb=function(){if(Sb)return _b;Sb=1;var e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},t=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();Object.defineProperty(_b,"__esModule",{value:!0}),_b.copyProperties=i;var n=Symbol();function i(e,t){var n=!0,i=!1,r=void 0;try{for(var o,s=Object.getOwnPropertyNames(t)[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var a=o.value,l=Object.getOwnPropertyDescriptor(t,a);Object.defineProperty(e,a,l)}}catch(e){i=!0,r=e}finally{try{!n&&s.return&&s.return()}finally{if(i)throw r}}return e}return _b.Enum=function(){function r(){var t=arguments.length<=0||void 0===arguments[0]?void 0:arguments[0];if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),{}.hasOwnProperty.call(this.constructor,n))throw new Error("Enum classes cant be instantiated");"object"===(void 0===t?"undefined":e(t))&&null!==t&&i(this,t)}return t(r,[{key:"toString",value:function(){return this.constructor.name+"."+this.name}}],[{key:"initEnum",value:function(e){return Object.defineProperty(this,"enumValues",{value:[],configurable:!1,writable:!1,enumerable:!0}),Array.isArray(e)?this._enumValuesFromArray(e):this._enumValuesFromObject(e),Object.freeze(this.enumValues),this[n]=!0,this}},{key:"_enumValuesFromArray",value:function(e){var t=!0,n=!1,i=void 0;try{for(var r,o=e[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var s=r.value;this._pushEnumValue(new this,s)}}catch(e){n=!0,i=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw i}}}},{key:"_enumValuesFromObject",value:function(e){var t=!0,n=!1,i=void 0;try{for(var r,o=Object.keys(e)[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var s=r.value,a=new this(e[s]);this._pushEnumValue(a,s)}}catch(e){n=!0,i=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw i}}}},{key:"_pushEnumValue",value:function(e,t){e.name=t,e.ordinal=this.enumValues.length,Object.defineProperty(this,t,{value:e,configurable:!1,writable:!1,enumerable:!0}),this.enumValues.push(e)}},{key:"enumValueOf",value:function(e){return this.enumValues.find((function(t){return t.name===e}))}},{key:Symbol.iterator,value:function(){return this.enumValues[Symbol.iterator]()}}]),r}(),_b}();let Tb=class extends Eb.Enum{};const Pb={[Cb.DECISION]:{actions:["INITIALIZED","START","END","LINGER_TIMEOUT_START","LINGER_TIMEOUT_END","LINGER_TIMEOUT_CANCEL"],controllerKey:"decisionId"},[Cb.PARALLEL]:{actions:["INITIALIZED","START","END"],controllerKey:"parallelId"},[Cb.GROUP]:{actions:["INITIALIZED","SHOW","HIDE"],controllerKey:"groupId"},[Cb.MENU_LAYER]:{actions:["INITIALIZED","SHOW","HIDE","EXPAND","COLLAPSE"],controllerKey:"menuLayerId"}};let Ib={};Object.keys(Pb).forEach((e=>{Pb[e].actions.forEach((t=>{Ib[`UI_${e}_${t}`]={get controllerClass(){return Mb(e)},get controllerKey(){return Pb[e].controllerKey}}}))})),[].forEach((e=>{Ib[e=`UI_${e}`]=e})),Tb.initEnum(Ib);let Ab=[];function Ob(e={},t){switch(t.type){case Tb.UI_DECISION_INITIALIZED:return{...e,controllerType:Cb.DECISION,visible:!1,decisionActive:!1,inLingerTimeout:!1};case Tb.UI_DECISION_START:return{...e,visible:!0,decisionActive:!0,inLingerTimeout:!1};case Tb.UI_DECISION_END:return{...e,decisionActive:!1,visible:e.inLingerTimeout};case Tb.UI_DECISION_LINGER_TIMEOUT_START:return{...e,inLingerTimeout:!0};case Tb.UI_DECISION_LINGER_TIMEOUT_CANCEL:return{...e,inLingerTimeout:!1};case Tb.UI_DECISION_LINGER_TIMEOUT_END:return{...e,inLingerTimeout:!1,visible:e.decisionActive};default:return e}}function Lb(e={},t){switch(t.type){case Tb.UI_PARALLEL_INITIALIZED:return{...e,controllerType:Cb.PARALLEL,visible:!1};case Tb.UI_PARALLEL_START:return{...e,visible:!0};case Tb.UI_PARALLEL_END:return{...e,visible:!1};default:return e}}function Nb(e={},t){switch(t.type){case Tb.UI_GROUP_INITIALIZED:return{...e,controllerType:Cb.GROUP,visible:t.shouldShow};case Tb.UI_GROUP_SHOW:return{...e,visible:!0};case Tb.UI_GROUP_HIDE:return{...e,visible:!1};default:return e}}function Rb(e={},t){switch(t.type){case Tb.UI_MENU_LAYER_INITIALIZED:return{...e,controllerType:Cb.MENU_LAYER,visible:t.visible,expanded:t.expanded};case Tb.UI_MENU_LAYER_SHOW:return{...e,visible:!0};case Tb.UI_MENU_LAYER_HIDE:return{...e,visible:!1};case Tb.UI_MENU_LAYER_EXPAND:return{...e,expanded:!0};case Tb.UI_MENU_LAYER_COLLAPSE:return{...e,expanded:!1};default:return e}}const Db={[Cb.DECISION]:class{constructor(e,t){this.id=e,this.config=t,this.decision=xb.player.decision.get(this.id),Bb({type:Tb.UI_DECISION_INITIALIZED,decisionId:this.id}),this.onDecisionStart=this.onDecisionStart.bind(this),this.onDecisionEnd=this.onDecisionEnd.bind(this),this.onDecisionMade=this.onDecisionMade.bind(this),this.addListeners(),"active"===this.decision.state?this.decision.trigger("ui.start"):"made"===this.decision.state&&(this.decision.trigger("ui.start"),this.decision.trigger("ui.made"))}static getReducer(){return Ob}onDecisionStart(){Bb({type:Tb.UI_DECISION_START,decisionId:this.id})}onDecisionEnd(){Bb({type:Tb.UI_DECISION_END,decisionId:this.id})}onDecisionMade(){let e=this.decision.selected.data&&"linger"in this.decision.selected.data,t=e&&this.decision.selected.data.linger,n=!e&&!this.decision.selected.seek,i=`after_${this.id}`;if(clearTimeout(Ab[i]),Bb({type:Tb.UI_DECISION_LINGER_TIMEOUT_CANCEL,decisionId:this.id}),n||t){let e=1e3*(this.decision.selected.autoDecided?this.config.autoSelectionDisappearDelay:this.config.userSelectionDisappearDelay);Bb({type:Tb.UI_DECISION_LINGER_TIMEOUT_START,decisionId:this.id}),Bb((r=i,o=e,s={type:Tb.UI_DECISION_LINGER_TIMEOUT_END.name,decisionId:this.id},(e,t)=>(clearTimeout(Ab[r]),new Promise((function(t,n){Ab[r]=setTimeout((()=>{e(s),t()}),o)})))))}else this.decision.selected.seek&&this.onDecisionEnd();var r,o,s}addListeners(){this.decision.on("start",this.onDecisionStart),this.decision.on("ui.start",this.onDecisionStart),this.decision.on("end",this.onDecisionEnd),this.decision.on("ui.end",this.onDecisionEnd),this.decision.on("made",this.onDecisionMade),this.decision.on("ui.made",this.onDecisionMade)}},[Cb.PARALLEL]:class{constructor(e,t){this.id=e,this.config=t,this.boundOnParallelStart=this.onParallelStart.bind(this),this.boundOnParallelEnd=this.onParallelEnd.bind(this),Bb({type:Tb.UI_PARALLEL_INITIALIZED,parallelId:this.id});let n=this.node=xb.player.repository.get(this.config.nodeId),i=t.guiAppearTime/1e3,r=t.guiDisappearTime/1e3;n.on(`timeupdate:${i}`,this.boundOnParallelStart),n.on(`timeupdate:${r}`,this.boundOnParallelEnd),xb.player.on("checkpoints.restored",(()=>{if(xb.player.currentNode===n){let e=xb.player.currentNodeTime;e>=i&&e<=r&&this.boundOnParallelStart()}})),function(e,t,n,i){let r,o;o=function(){xb.player.on("seeked",r),xb.player.on("playlistcritical",r),xb.player.on("playlistreset",r),e.on("nodeend",r)},r=function(){n.call(i),xb.player.off("seeked",r),xb.player.off("playlistcritical",r),xb.player.off("playlistreset",r),e.off("nodeend",r)},e.on("nodestart",o)}(n,0,(()=>{xb.store.getState().ui.controllers[this.id].visible&&this.onParallelEnd()}),this)}static getReducer(){return Lb}onParallelStart(){Bb({type:Tb.UI_PARALLEL_START,parallelId:this.id}),xb.player.switch(this.config.defaultChannel)}onParallelEnd(){Bb({type:Tb.UI_PARALLEL_END,parallelId:this.id})}},[Cb.GROUP]:class{constructor(e,t){this.id=e,this.config=t||{},this.stateChangePending=!1;let n=this.shouldShow(xb.store.getState());Bb({type:Tb.UI_GROUP_INITIALIZED,groupId:this.id,shouldShow:n}),Ub(xb.store,null,((e,t)=>this.stateChangeAffector(e,t))),Ub(xb.store,(e=>e.ui.controllers[this.id]),((e,t)=>this.controllerStateChangeAffector(e,t)))}static getReducer(){return Nb}shouldShow(e){if(void 0===e)return!1;let t=e.player,n=e.variables,i=null,r=null;if(Array.isArray(this.config.showInNodes))i=-1!==this.config.showInNodes.indexOf(t.currentNodeId);else if("object"==typeof this.config.showInNodes){let e=this.config.showInNodes[t.currentNodeId];if(null==e)i=!1;else if("boolean"==typeof e)i=e;else{let n=t.currentNodeDuration;"hideTime"in e&&null!==e.hideTime&&(n=e.hideTime<0?t.currentNodeDuration+e.hideTime:e.hideTime),i=t.currentNodeTime>("showTime"in e&&null!==e.showTime?e.showTime:0)&&t.currentNodeTime<n}}return this.config.showIfVariables&&(r=Object.keys(this.config.showIfVariables).every((e=>"function"==typeof this.config.showIfVariables[e]?this.config.showIfVariables[e](n[e]):this.config.showIfVariables[e]===n[e]))),!0===i&&null===r||null===i&&!0===r||!0===i&&!0===r}stateChangeAffector(e,t){let n=this.shouldShow(e),i=this.shouldShow(t);!1===this.stateChangePending&&(!1===n&&!0===i?(this.stateChangePending=!0,Bb({type:Tb.UI_GROUP_SHOW,groupId:this.id})):!0===n&&!1===i&&(this.stateChangePending=!0,Bb({type:Tb.UI_GROUP_HIDE,groupId:this.id})))}controllerStateChangeAffector(e,t){this.stateChangePending&&(void 0===e||void 0!==e&&(!1===e.visible&&!0===t.visible||!0===e.visible&&!1===t.visible))&&(this.stateChangePending=!1)}},[Cb.MENU_LAYER]:class{constructor(e,t){this.id=e,this.config=t,Bb({type:Tb.UI_MENU_LAYER_INITIALIZED,menuLayerId:this.id,expanded:this.config.expanded,visible:this.shouldShow(xb.player.currentNodeId)}),this.addListeners()}static getReducer(){return Rb}shouldShow(e){return this.config.showInNodes&&-1!==this.config.showInNodes.indexOf(e)||"showInNodes"in this.config==0}addListeners(){xb.player.on("nodestart",(e=>{this.shouldShow(e.id)?Bb({type:Tb.UI_MENU_LAYER_SHOW,menuLayerId:this.id}):Bb({type:Tb.UI_MENU_LAYER_HIDE,menuLayerId:this.id})}))}}};function Mb(e){let t;return null==e?xb.log.error("UI Controller type is undefined. Did you create a UI Controller config with no type?"):t="string"==typeof e?Db[e]:e,t||xb.log.error("[getClassByControllerType] Unknown controller type",e),t}function Fb(e){let t;return e.includes("Legacy"),t=Promise.resolve(Ig.createElement("div",null,"TODO: implement getComponentPromise")),t}function Bb(e){"function"==typeof e?xb.store.dispatch(e):(e.type||console.error("Dispatch received undefined action"),xb.store.dispatch({...e,type:e.type.name}))}function Ub(e,t,n){let i,r=t||(e=>e);function o(){let t=r(e.getState());t!==i&&(n(i,t),i=t)}let s=e.subscribe(o);return o(),s}const jb=(e,t,n=void 0)=>{const i=n=>String.prototype.split.call(t,n).filter(Boolean).reduce(((e,t)=>null!=e?e[t]:e),e),r=i(/[,[\]]+?/)||i(/[,[\].]+?/);return void 0===r||r===e?n:r},zb=new URLSearchParams(window.location.search).get("imagePreloadDebug"),Vb=45e3,Wb=5;let Hb={},$b={},Gb={};function qb(e){e&&!(e in Hb)&&!(e in $b)&&!(e in Gb)&&(Object.keys($b).length>=Wb?(zb&&console.log("Image preload: Adding to queue",e),Gb[e]=!0):Yb(e))}function Yb(e){$b[e]=!0,function(e){return zb&&console.log("Image preload: starting to preload",e),new Promise(((t,n)=>{let i=new Image;i.onload=()=>{clearTimeout(r),t({url:e,width:i.naturalWidth,height:i.naturalHeight})};let r=setTimeout((()=>{n({err:"Image load timeout",url:e})}),Vb);i.src=e}))}(e).then((({url:e,width:t,height:n})=>{delete $b[e],Hb[e]=!0,zb&&(performance.getEntriesByName(e),console.log("Image preloaded",e,t,n),console.log("%c ",`font-size:1px; padding: 60px; background:url(${e}); background-size: contain; background-repeat: no-repeat; background-position: center; background-color: gray;`))})).catch((e=>{zb&&console.log("Image preload fail",e),delete $b[e.url]})).finally((()=>{Object.keys(Gb).length>0&&Object.keys($b).length<Wb&&function(){let e=Object.keys(Gb)[0];delete Gb[e],Yb(e)}()}))}function Kb(e,t){let n={guiId:e,player:xb.player};t.config.componentClass?Xb(t.config.componentClass,n):t.config.componentClassName&&(n.config=t.config,Fb(t.config.componentClassName).then((e=>{Xb(e.default,n)})))}function Xb(e,t){e.getImagesToPreload&&e.getImagesToPreload(t).forEach((e=>qb(e)))}var Qb,Zb,Jb,ew={exports:{}},tw=(Qb||(Qb=1,function(e){var t=Object.prototype.hasOwnProperty,n="~";function i(){}function r(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function o(e,t,i,o,s){if("function"!=typeof i)throw new TypeError("The listener must be a function");var a=new r(i,o||e,s),l=n?n+t:t;return e._events[l]?e._events[l].fn?e._events[l]=[e._events[l],a]:e._events[l].push(a):(e._events[l]=a,e._eventsCount++),e}function s(e,t){0==--e._eventsCount?e._events=new i:delete e._events[t]}function a(){this._events=new i,this._eventsCount=0}Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(n=!1)),a.prototype.eventNames=function(){var e,i,r=[];if(0===this._eventsCount)return r;for(i in e=this._events)t.call(e,i)&&r.push(n?i.slice(1):i);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(e)):r},a.prototype.listeners=function(e){var t=this._events[n?n+e:e];if(!t)return[];if(t.fn)return[t.fn];for(var i=0,r=t.length,o=new Array(r);i<r;i++)o[i]=t[i].fn;return o},a.prototype.listenerCount=function(e){var t=this._events[n?n+e:e];return t?t.fn?1:t.length:0},a.prototype.emit=function(e,t,i,r,o,s){var a=n?n+e:e;if(!this._events[a])return!1;var l,c,u=this._events[a],d=arguments.length;if(u.fn){switch(u.once&&this.removeListener(e,u.fn,void 0,!0),d){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,t),!0;case 3:return u.fn.call(u.context,t,i),!0;case 4:return u.fn.call(u.context,t,i,r),!0;case 5:return u.fn.call(u.context,t,i,r,o),!0;case 6:return u.fn.call(u.context,t,i,r,o,s),!0}for(c=1,l=new Array(d-1);c<d;c++)l[c-1]=arguments[c];u.fn.apply(u.context,l)}else{var h,p=u.length;for(c=0;c<p;c++)switch(u[c].once&&this.removeListener(e,u[c].fn,void 0,!0),d){case 1:u[c].fn.call(u[c].context);break;case 2:u[c].fn.call(u[c].context,t);break;case 3:u[c].fn.call(u[c].context,t,i);break;case 4:u[c].fn.call(u[c].context,t,i,r);break;default:if(!l)for(h=1,l=new Array(d-1);h<d;h++)l[h-1]=arguments[h];u[c].fn.apply(u[c].context,l)}}return!0},a.prototype.on=function(e,t,n){return o(this,e,t,n,!1)},a.prototype.once=function(e,t,n){return o(this,e,t,n,!0)},a.prototype.removeListener=function(e,t,i,r){var o=n?n+e:e;if(!this._events[o])return this;if(!t)return s(this,o),this;var a=this._events[o];if(a.fn)a.fn!==t||r&&!a.once||i&&a.context!==i||s(this,o);else{for(var l=0,c=[],u=a.length;l<u;l++)(a[l].fn!==t||r&&!a[l].once||i&&a[l].context!==i)&&c.push(a[l]);c.length?this._events[o]=1===c.length?c[0]:c:s(this,o)}return this},a.prototype.removeAllListeners=function(e){var t;return e?this._events[t=n?n+e:e]&&s(this,t):(this._events=new i,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,e.exports=a}(ew)),ew.exports),nw=r(tw);function iw(){return Jb?Zb:(Jb=1,Zb={SEMVER_SPEC_VERSION:"2.0.0",MAX_LENGTH:256,MAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER||9007199254740991,MAX_SAFE_COMPONENT_LENGTH:16})}var rw,ow,sw,aw,lw,cw,uw,dw,hw,pw,fw,gw,mw,yw={exports:{}};function vw(){if(ow)return rw;ow=1;const e="object"==typeof ut&&ut.env&&ut.env.NODE_DEBUG&&/\bsemver\b/i.test(ut.env.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};return rw=e}function bw(){return sw||(sw=1,function(e,t){const{MAX_SAFE_COMPONENT_LENGTH:n}=iw(),i=vw(),r=(t=e.exports={}).re=[],o=t.src=[],s=t.t={};let a=0;const l=(e,t,n)=>{const l=a++;i(l,t),s[e]=l,o[l]=t,r[l]=new RegExp(t,n?"g":void 0)};l("NUMERICIDENTIFIER","0|[1-9]\\d*"),l("NUMERICIDENTIFIERLOOSE","[0-9]+"),l("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*"),l("MAINVERSION",`(${o[s.NUMERICIDENTIFIER]})\\.(${o[s.NUMERICIDENTIFIER]})\\.(${o[s.NUMERICIDENTIFIER]})`),l("MAINVERSIONLOOSE",`(${o[s.NUMERICIDENTIFIERLOOSE]})\\.(${o[s.NUMERICIDENTIFIERLOOSE]})\\.(${o[s.NUMERICIDENTIFIERLOOSE]})`),l("PRERELEASEIDENTIFIER",`(?:${o[s.NUMERICIDENTIFIER]}|${o[s.NONNUMERICIDENTIFIER]})`),l("PRERELEASEIDENTIFIERLOOSE",`(?:${o[s.NUMERICIDENTIFIERLOOSE]}|${o[s.NONNUMERICIDENTIFIER]})`),l("PRERELEASE",`(?:-(${o[s.PRERELEASEIDENTIFIER]}(?:\\.${o[s.PRERELEASEIDENTIFIER]})*))`),l("PRERELEASELOOSE",`(?:-?(${o[s.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${o[s.PRERELEASEIDENTIFIERLOOSE]})*))`),l("BUILDIDENTIFIER","[0-9A-Za-z-]+"),l("BUILD",`(?:\\+(${o[s.BUILDIDENTIFIER]}(?:\\.${o[s.BUILDIDENTIFIER]})*))`),l("FULLPLAIN",`v?${o[s.MAINVERSION]}${o[s.PRERELEASE]}?${o[s.BUILD]}?`),l("FULL",`^${o[s.FULLPLAIN]}$`),l("LOOSEPLAIN",`[v=\\s]*${o[s.MAINVERSIONLOOSE]}${o[s.PRERELEASELOOSE]}?${o[s.BUILD]}?`),l("LOOSE",`^${o[s.LOOSEPLAIN]}$`),l("GTLT","((?:<|>)?=?)"),l("XRANGEIDENTIFIERLOOSE",`${o[s.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),l("XRANGEIDENTIFIER",`${o[s.NUMERICIDENTIFIER]}|x|X|\\*`),l("XRANGEPLAIN",`[v=\\s]*(${o[s.XRANGEIDENTIFIER]})(?:\\.(${o[s.XRANGEIDENTIFIER]})(?:\\.(${o[s.XRANGEIDENTIFIER]})(?:${o[s.PRERELEASE]})?${o[s.BUILD]}?)?)?`),l("XRANGEPLAINLOOSE",`[v=\\s]*(${o[s.XRANGEIDENTIFIERLOOSE]})(?:\\.(${o[s.XRANGEIDENTIFIERLOOSE]})(?:\\.(${o[s.XRANGEIDENTIFIERLOOSE]})(?:${o[s.PRERELEASELOOSE]})?${o[s.BUILD]}?)?)?`),l("XRANGE",`^${o[s.GTLT]}\\s*${o[s.XRANGEPLAIN]}$`),l("XRANGELOOSE",`^${o[s.GTLT]}\\s*${o[s.XRANGEPLAINLOOSE]}$`),l("COERCE",`(^|[^\\d])(\\d{1,${n}})(?:\\.(\\d{1,${n}}))?(?:\\.(\\d{1,${n}}))?(?:$|[^\\d])`),l("COERCERTL",o[s.COERCE],!0),l("LONETILDE","(?:~>?)"),l("TILDETRIM",`(\\s*)${o[s.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",l("TILDE",`^${o[s.LONETILDE]}${o[s.XRANGEPLAIN]}$`),l("TILDELOOSE",`^${o[s.LONETILDE]}${o[s.XRANGEPLAINLOOSE]}$`),l("LONECARET","(?:\\^)"),l("CARETTRIM",`(\\s*)${o[s.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",l("CARET",`^${o[s.LONECARET]}${o[s.XRANGEPLAIN]}$`),l("CARETLOOSE",`^${o[s.LONECARET]}${o[s.XRANGEPLAINLOOSE]}$`),l("COMPARATORLOOSE",`^${o[s.GTLT]}\\s*(${o[s.LOOSEPLAIN]})$|^$`),l("COMPARATOR",`^${o[s.GTLT]}\\s*(${o[s.FULLPLAIN]})$|^$`),l("COMPARATORTRIM",`(\\s*)${o[s.GTLT]}\\s*(${o[s.LOOSEPLAIN]}|${o[s.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",l("HYPHENRANGE",`^\\s*(${o[s.XRANGEPLAIN]})\\s+-\\s+(${o[s.XRANGEPLAIN]})\\s*$`),l("HYPHENRANGELOOSE",`^\\s*(${o[s.XRANGEPLAINLOOSE]})\\s+-\\s+(${o[s.XRANGEPLAINLOOSE]})\\s*$`),l("STAR","(<|>)?=?\\s*\\*"),l("GTE0","^\\s*>=\\s*0.0.0\\s*$"),l("GTE0PRE","^\\s*>=\\s*0.0.0-0\\s*$")}(yw,yw.exports)),yw.exports}function ww(){if(lw)return aw;lw=1;const e=["includePrerelease","loose","rtl"];return aw=t=>t?"object"!=typeof t?{loose:!0}:e.filter((e=>t[e])).reduce(((e,t)=>(e[t]=!0,e)),{}):{},aw}function kw(){if(hw)return dw;hw=1;const e=vw(),{MAX_LENGTH:t,MAX_SAFE_INTEGER:n}=iw(),{re:i,t:r}=bw(),o=ww(),{compareIdentifiers:s}=function(){if(uw)return cw;uw=1;const e=/^[0-9]+$/,t=(t,n)=>{const i=e.test(t),r=e.test(n);return i&&r&&(t=+t,n=+n),t===n?0:i&&!r?-1:r&&!i?1:t<n?-1:1};return cw={compareIdentifiers:t,rcompareIdentifiers:(e,n)=>t(n,e)},cw}();class a{constructor(s,l){if(l=o(l),s instanceof a){if(s.loose===!!l.loose&&s.includePrerelease===!!l.includePrerelease)return s;s=s.version}else if("string"!=typeof s)throw new TypeError(`Invalid Version: ${s}`);if(s.length>t)throw new TypeError(`version is longer than ${t} characters`);e("SemVer",s,l),this.options=l,this.loose=!!l.loose,this.includePrerelease=!!l.includePrerelease;const c=s.trim().match(l.loose?i[r.LOOSE]:i[r.FULL]);if(!c)throw new TypeError(`Invalid Version: ${s}`);if(this.raw=s,this.major=+c[1],this.minor=+c[2],this.patch=+c[3],this.major>n||this.major<0)throw new TypeError("Invalid major version");if(this.minor>n||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>n||this.patch<0)throw new TypeError("Invalid patch version");this.prerelease=c[4]?c[4].split(".").map((e=>{if(/^[0-9]+$/.test(e)){const t=+e;if(t>=0&&t<n)return t}return e})):[],this.build=c[5]?c[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(t){if(e("SemVer.compare",this.version,this.options,t),!(t instanceof a)){if("string"==typeof t&&t===this.version)return 0;t=new a(t,this.options)}return t.version===this.version?0:this.compareMain(t)||this.comparePre(t)}compareMain(e){return e instanceof a||(e=new a(e,this.options)),s(this.major,e.major)||s(this.minor,e.minor)||s(this.patch,e.patch)}comparePre(t){if(t instanceof a||(t=new a(t,this.options)),this.prerelease.length&&!t.prerelease.length)return-1;if(!this.prerelease.length&&t.prerelease.length)return 1;if(!this.prerelease.length&&!t.prerelease.length)return 0;let n=0;do{const i=this.prerelease[n],r=t.prerelease[n];if(e("prerelease compare",n,i,r),void 0===i&&void 0===r)return 0;if(void 0===r)return 1;if(void 0===i)return-1;if(i!==r)return s(i,r)}while(++n)}compareBuild(t){t instanceof a||(t=new a(t,this.options));let n=0;do{const i=this.build[n],r=t.build[n];if(e("prerelease compare",n,i,r),void 0===i&&void 0===r)return 0;if(void 0===r)return 1;if(void 0===i)return-1;if(i!==r)return s(i,r)}while(++n)}inc(e,t){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t),this.inc("pre",t);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t),this.inc("pre",t);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{let e=this.prerelease.length;for(;--e>=0;)"number"==typeof this.prerelease[e]&&(this.prerelease[e]++,e=-2);-1===e&&this.prerelease.push(0)}t&&(this.prerelease[0]===t?isNaN(this.prerelease[1])&&(this.prerelease=[t,0]):this.prerelease=[t,0]);break;default:throw new Error(`invalid increment argument: ${e}`)}return this.format(),this.raw=this.version,this}}return dw=a}function xw(){if(fw)return pw;fw=1;const{MAX_LENGTH:e}=iw(),{re:t,t:n}=bw(),i=kw(),r=ww();return pw=(o,s)=>{if(s=r(s),o instanceof i)return o;if("string"!=typeof o)return null;if(o.length>e)return null;if(!(s.loose?t[n.LOOSE]:t[n.FULL]).test(o))return null;try{return new i(o,s)}catch(e){return null}},pw}var Sw,Cw,_w,Ew,Tw,Pw,Iw,Aw,Ow,Lw,Nw,Rw,Dw,Mw,Fw,Bw,Uw,jw,zw,Vw,Ww,Hw,$w,Gw,qw,Yw,Kw,Xw,Qw=function(){if(mw)return gw;mw=1;const e=xw();return gw=(t,n)=>{const i=e(t,n);return i?i.version:null},gw}(),Zw=r(Qw);function Jw(){if(Aw)return Iw;Aw=1;const e=kw();return Iw=(t,n,i)=>new e(t,i).compare(new e(n,i)),Iw}function ek(){if(Mw)return Dw;Mw=1;const e=Jw();return Dw=(t,n,i)=>e(t,n,i)>0,Dw}function tk(){if(Yw)return qw;Yw=1;class e{constructor(t,n){if(n=i(n),t instanceof e)return t.loose===!!n.loose&&t.includePrerelease===!!n.includePrerelease?t:new e(t.raw,n);if(t instanceof r)return this.raw=t.value,this.set=[[t]],this.format(),this;if(this.options=n,this.loose=!!n.loose,this.includePrerelease=!!n.includePrerelease,this.raw=t,this.set=t.split(/\s*\|\|\s*/).map((e=>this.parseRange(e.trim()))).filter((e=>e.length)),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${t}`);if(this.set.length>1){const e=this.set[0];if(this.set=this.set.filter((e=>!h(e[0]))),0===this.set.length)this.set=[e];else if(this.set.length>1)for(const e of this.set)if(1===e.length&&p(e[0])){this.set=[e];break}}this.format()}format(){return this.range=this.set.map((e=>e.join(" ").trim())).join("||").trim(),this.range}toString(){return this.range}parseRange(e){e=e.trim();const t=`parseRange:${Object.keys(this.options).join(",")}:${e}`,i=n.get(t);if(i)return i;const s=this.options.loose;e=e.replace(s?a[l.HYPHENRANGELOOSE]:a[l.HYPHENRANGE],_(this.options.includePrerelease)),o("hyphen replace",e),e=e.replace(a[l.COMPARATORTRIM],c),o("comparator trim",e,a[l.COMPARATORTRIM]),e=(e=(e=e.replace(a[l.TILDETRIM],u)).replace(a[l.CARETTRIM],d)).split(/\s+/).join(" ");const p=s?a[l.COMPARATORLOOSE]:a[l.COMPARATOR],f=e.split(" ").map((e=>g(e,this.options))).join(" ").split(/\s+/).map((e=>C(e,this.options))).filter(this.options.loose?e=>!!e.match(p):()=>!0).map((e=>new r(e,this.options))),m=new Map;for(const e of f){if(h(e))return[e];m.set(e.value,e)}m.size>1&&m.has("")&&m.delete("");const y=[...m.values()];return n.set(t,y),y}intersects(t,n){if(!(t instanceof e))throw new TypeError("a Range is required");return this.set.some((e=>f(e,n)&&t.set.some((t=>f(t,n)&&e.every((e=>t.every((t=>e.intersects(t,n)))))))))}test(e){if(!e)return!1;if("string"==typeof e)try{e=new s(e,this.options)}catch(e){return!1}for(let t=0;t<this.set.length;t++)if(E(this.set[t],e,this.options))return!0;return!1}}qw=e;const t=function(){if(Pw)return Tw;Pw=1;const e=function(){if(Ew)return _w;function e(t){var n=this;if(n instanceof e||(n=new e),n.tail=null,n.head=null,n.length=0,t&&"function"==typeof t.forEach)t.forEach((function(e){n.push(e)}));else if(arguments.length>0)for(var i=0,r=arguments.length;i<r;i++)n.push(arguments[i]);return n}function t(e,t,n){var i=t===e.head?new r(n,null,t,e):new r(n,t,t.next,e);return null===i.next&&(e.tail=i),null===i.prev&&(e.head=i),e.length++,i}function n(e,t){e.tail=new r(t,e.tail,null,e),e.head||(e.head=e.tail),e.length++}function i(e,t){e.head=new r(t,null,e.head,e),e.tail||(e.tail=e.head),e.length++}function r(e,t,n,i){if(!(this instanceof r))return new r(e,t,n,i);this.list=i,this.value=e,t?(t.next=this,this.prev=t):this.prev=null,n?(n.prev=this,this.next=n):this.next=null}Ew=1,_w=e,e.Node=r,e.create=e,e.prototype.removeNode=function(e){if(e.list!==this)throw new Error("removing node which does not belong to this list");var t=e.next,n=e.prev;return t&&(t.prev=n),n&&(n.next=t),e===this.head&&(this.head=t),e===this.tail&&(this.tail=n),e.list.length--,e.next=null,e.prev=null,e.list=null,t},e.prototype.unshiftNode=function(e){if(e!==this.head){e.list&&e.list.removeNode(e);var t=this.head;e.list=this,e.next=t,t&&(t.prev=e),this.head=e,this.tail||(this.tail=e),this.length++}},e.prototype.pushNode=function(e){if(e!==this.tail){e.list&&e.list.removeNode(e);var t=this.tail;e.list=this,e.prev=t,t&&(t.next=e),this.tail=e,this.head||(this.head=e),this.length++}},e.prototype.push=function(){for(var e=0,t=arguments.length;e<t;e++)n(this,arguments[e]);return this.length},e.prototype.unshift=function(){for(var e=0,t=arguments.length;e<t;e++)i(this,arguments[e]);return this.length},e.prototype.pop=function(){if(this.tail){var e=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,e}},e.prototype.shift=function(){if(this.head){var e=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,e}},e.prototype.forEach=function(e,t){t=t||this;for(var n=this.head,i=0;null!==n;i++)e.call(t,n.value,i,this),n=n.next},e.prototype.forEachReverse=function(e,t){t=t||this;for(var n=this.tail,i=this.length-1;null!==n;i--)e.call(t,n.value,i,this),n=n.prev},e.prototype.get=function(e){for(var t=0,n=this.head;null!==n&&t<e;t++)n=n.next;if(t===e&&null!==n)return n.value},e.prototype.getReverse=function(e){for(var t=0,n=this.tail;null!==n&&t<e;t++)n=n.prev;if(t===e&&null!==n)return n.value},e.prototype.map=function(t,n){n=n||this;for(var i=new e,r=this.head;null!==r;)i.push(t.call(n,r.value,this)),r=r.next;return i},e.prototype.mapReverse=function(t,n){n=n||this;for(var i=new e,r=this.tail;null!==r;)i.push(t.call(n,r.value,this)),r=r.prev;return i},e.prototype.reduce=function(e,t){var n,i=this.head;if(arguments.length>1)n=t;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");i=this.head.next,n=this.head.value}for(var r=0;null!==i;r++)n=e(n,i.value,r),i=i.next;return n},e.prototype.reduceReverse=function(e,t){var n,i=this.tail;if(arguments.length>1)n=t;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");i=this.tail.prev,n=this.tail.value}for(var r=this.length-1;null!==i;r--)n=e(n,i.value,r),i=i.prev;return n},e.prototype.toArray=function(){for(var e=new Array(this.length),t=0,n=this.head;null!==n;t++)e[t]=n.value,n=n.next;return e},e.prototype.toArrayReverse=function(){for(var e=new Array(this.length),t=0,n=this.tail;null!==n;t++)e[t]=n.value,n=n.prev;return e},e.prototype.slice=function(t,n){(n=n||this.length)<0&&(n+=this.length),(t=t||0)<0&&(t+=this.length);var i=new e;if(n<t||n<0)return i;t<0&&(t=0),n>this.length&&(n=this.length);for(var r=0,o=this.head;null!==o&&r<t;r++)o=o.next;for(;null!==o&&r<n;r++,o=o.next)i.push(o.value);return i},e.prototype.sliceReverse=function(t,n){(n=n||this.length)<0&&(n+=this.length),(t=t||0)<0&&(t+=this.length);var i=new e;if(n<t||n<0)return i;t<0&&(t=0),n>this.length&&(n=this.length);for(var r=this.length,o=this.tail;null!==o&&r>n;r--)o=o.prev;for(;null!==o&&r>t;r--,o=o.prev)i.push(o.value);return i},e.prototype.splice=function(e,n,...i){e>this.length&&(e=this.length-1),e<0&&(e=this.length+e);for(var r=0,o=this.head;null!==o&&r<e;r++)o=o.next;var s=[];for(r=0;o&&r<n;r++)s.push(o.value),o=this.removeNode(o);for(null===o&&(o=this.tail),o!==this.head&&o!==this.tail&&(o=o.prev),r=0;r<i.length;r++)o=t(this,o,i[r]);return s},e.prototype.reverse=function(){for(var e=this.head,t=this.tail,n=e;null!==n;n=n.prev){var i=n.prev;n.prev=n.next,n.next=i}return this.head=t,this.tail=e,this};try{(Cw?Sw:(Cw=1,Sw=function(e){e.prototype[Symbol.iterator]=function*(){for(let e=this.head;e;e=e.next)yield e.value}}))(e)}catch(e){}return _w}(),t=Symbol("max"),n=Symbol("length"),i=Symbol("lengthCalculator"),r=Symbol("allowStale"),o=Symbol("maxAge"),s=Symbol("dispose"),a=Symbol("noDisposeOnSet"),l=Symbol("lruList"),c=Symbol("cache"),u=Symbol("updateAgeOnGet"),d=()=>1,h=(e,t,n)=>{const i=e[c].get(t);if(i){const t=i.value;if(p(e,t)){if(g(e,i),!e[r])return}else n&&(e[u]&&(i.value.now=Date.now()),e[l].unshiftNode(i));return t.value}},p=(e,t)=>{if(!t||!t.maxAge&&!e[o])return!1;const n=Date.now()-t.now;return t.maxAge?n>t.maxAge:e[o]&&n>e[o]},f=e=>{if(e[n]>e[t])for(let i=e[l].tail;e[n]>e[t]&&null!==i;){const t=i.prev;g(e,i),i=t}},g=(e,t)=>{if(t){const i=t.value;e[s]&&e[s](i.key,i.value),e[n]-=i.length,e[c].delete(i.key),e[l].removeNode(t)}};class m{constructor(e,t,n,i,r){this.key=e,this.value=t,this.length=n,this.now=i,this.maxAge=r||0}}const y=(e,t,n,i)=>{let o=n.value;p(e,o)&&(g(e,n),e[r]||(o=void 0)),o&&t.call(i,o.value,o.key,e)};return Tw=class{constructor(e){if("number"==typeof e&&(e={max:e}),e||(e={}),e.max&&("number"!=typeof e.max||e.max<0))throw new TypeError("max must be a non-negative number");this[t]=e.max||1/0;const n=e.length||d;if(this[i]="function"!=typeof n?d:n,this[r]=e.stale||!1,e.maxAge&&"number"!=typeof e.maxAge)throw new TypeError("maxAge must be a number");this[o]=e.maxAge||0,this[s]=e.dispose,this[a]=e.noDisposeOnSet||!1,this[u]=e.updateAgeOnGet||!1,this.reset()}set max(e){if("number"!=typeof e||e<0)throw new TypeError("max must be a non-negative number");this[t]=e||1/0,f(this)}get max(){return this[t]}set allowStale(e){this[r]=!!e}get allowStale(){return this[r]}set maxAge(e){if("number"!=typeof e)throw new TypeError("maxAge must be a non-negative number");this[o]=e,f(this)}get maxAge(){return this[o]}set lengthCalculator(e){"function"!=typeof e&&(e=d),e!==this[i]&&(this[i]=e,this[n]=0,this[l].forEach((e=>{e.length=this[i](e.value,e.key),this[n]+=e.length}))),f(this)}get lengthCalculator(){return this[i]}get length(){return this[n]}get itemCount(){return this[l].length}rforEach(e,t){t=t||this;for(let n=this[l].tail;null!==n;){const i=n.prev;y(this,e,n,t),n=i}}forEach(e,t){t=t||this;for(let n=this[l].head;null!==n;){const i=n.next;y(this,e,n,t),n=i}}keys(){return this[l].toArray().map((e=>e.key))}values(){return this[l].toArray().map((e=>e.value))}reset(){this[s]&&this[l]&&this[l].length&&this[l].forEach((e=>this[s](e.key,e.value))),this[c]=new Map,this[l]=new e,this[n]=0}dump(){return this[l].map((e=>!p(this,e)&&{k:e.key,v:e.value,e:e.now+(e.maxAge||0)})).toArray().filter((e=>e))}dumpLru(){return this[l]}set(e,r,u){if((u=u||this[o])&&"number"!=typeof u)throw new TypeError("maxAge must be a number");const d=u?Date.now():0,h=this[i](r,e);if(this[c].has(e)){if(h>this[t])return g(this,this[c].get(e)),!1;const i=this[c].get(e).value;return this[s]&&(this[a]||this[s](e,i.value)),i.now=d,i.maxAge=u,i.value=r,this[n]+=h-i.length,i.length=h,this.get(e),f(this),!0}const p=new m(e,r,h,d,u);return p.length>this[t]?(this[s]&&this[s](e,r),!1):(this[n]+=p.length,this[l].unshift(p),this[c].set(e,this[l].head),f(this),!0)}has(e){if(!this[c].has(e))return!1;const t=this[c].get(e).value;return!p(this,t)}get(e){return h(this,e,!0)}peek(e){return h(this,e,!1)}pop(){const e=this[l].tail;return e?(g(this,e),e.value):null}del(e){g(this,this[c].get(e))}load(e){this.reset();const t=Date.now();for(let n=e.length-1;n>=0;n--){const i=e[n],r=i.e||0;if(0===r)this.set(i.k,i.v);else{const e=r-t;e>0&&this.set(i.k,i.v,e)}}}prune(){this[c].forEach(((e,t)=>h(this,t,!1)))}},Tw}(),n=new t({max:1e3}),i=ww(),r=function(){if(Gw)return $w;Gw=1;const e=Symbol("SemVer ANY");class t{static get ANY(){return e}constructor(i,r){if(r=n(r),i instanceof t){if(i.loose===!!r.loose)return i;i=i.value}s("comparator",i,r),this.options=r,this.loose=!!r.loose,this.parse(i),this.value=this.semver===e?"":this.operator+this.semver.version,s("comp",this)}parse(t){const n=t.match(this.options.loose?i[r.COMPARATORLOOSE]:i[r.COMPARATOR]);if(!n)throw new TypeError(`Invalid comparator: ${t}`);this.operator=void 0!==n[1]?n[1]:"","="===this.operator&&(this.operator=""),this.semver=n[2]?new a(n[2],this.options.loose):e}toString(){return this.value}test(t){if(s("Comparator.test",t,this.options.loose),this.semver===e||t===e)return!0;if("string"==typeof t)try{t=new a(t,this.options)}catch(e){return!1}return o(t,this.operator,this.semver,this.options)}intersects(e,n){if(!(e instanceof t))throw new TypeError("a Comparator is required");if(n&&"object"==typeof n||(n={loose:!!n,includePrerelease:!1}),""===this.operator)return""===this.value||new l(e.value,n).test(this.value);if(""===e.operator)return""===e.value||new l(this.value,n).test(e.semver);const i=!(">="!==this.operator&&">"!==this.operator||">="!==e.operator&&">"!==e.operator),r=!("<="!==this.operator&&"<"!==this.operator||"<="!==e.operator&&"<"!==e.operator),s=this.semver.version===e.semver.version,a=!(">="!==this.operator&&"<="!==this.operator||">="!==e.operator&&"<="!==e.operator),c=o(this.semver,"<",e.semver,n)&&(">="===this.operator||">"===this.operator)&&("<="===e.operator||"<"===e.operator),u=o(this.semver,">",e.semver,n)&&("<="===this.operator||"<"===this.operator)&&(">="===e.operator||">"===e.operator);return i||r||s&&a||c||u}}$w=t;const n=ww(),{re:i,t:r}=bw(),o=function(){if(Hw)return Ww;Hw=1;const e=function(){if(Lw)return Ow;Lw=1;const e=Jw();return Ow=(t,n,i)=>0===e(t,n,i),Ow}(),t=function(){if(Rw)return Nw;Rw=1;const e=Jw();return Nw=(t,n,i)=>0!==e(t,n,i),Nw}(),n=ek(),i=function(){if(Bw)return Fw;Bw=1;const e=Jw();return Fw=(t,n,i)=>e(t,n,i)>=0,Fw}(),r=function(){if(jw)return Uw;jw=1;const e=Jw();return Uw=(t,n,i)=>e(t,n,i)<0,Uw}(),o=function(){if(Vw)return zw;Vw=1;const e=Jw();return zw=(t,n,i)=>e(t,n,i)<=0,zw}();return Ww=(s,a,l,c)=>{switch(a){case"===":return"object"==typeof s&&(s=s.version),"object"==typeof l&&(l=l.version),s===l;case"!==":return"object"==typeof s&&(s=s.version),"object"==typeof l&&(l=l.version),s!==l;case"":case"=":case"==":return e(s,l,c);case"!=":return t(s,l,c);case">":return n(s,l,c);case">=":return i(s,l,c);case"<":return r(s,l,c);case"<=":return o(s,l,c);default:throw new TypeError(`Invalid operator: ${a}`)}},Ww}(),s=vw(),a=kw(),l=tk();return $w}(),o=vw(),s=kw(),{re:a,t:l,comparatorTrimReplace:c,tildeTrimReplace:u,caretTrimReplace:d}=bw(),h=e=>"<0.0.0-0"===e.value,p=e=>""===e.value,f=(e,t)=>{let n=!0;const i=e.slice();let r=i.pop();for(;n&&i.length;)n=i.every((e=>r.intersects(e,t))),r=i.pop();return n},g=(e,t)=>(o("comp",e,t),e=b(e,t),o("caret",e),e=y(e,t),o("tildes",e),e=k(e,t),o("xrange",e),e=S(e,t),o("stars",e),e),m=e=>!e||"x"===e.toLowerCase()||"*"===e,y=(e,t)=>e.trim().split(/\s+/).map((e=>v(e,t))).join(" "),v=(e,t)=>e.replace(t.loose?a[l.TILDELOOSE]:a[l.TILDE],((t,n,i,r,s)=>{let a;return o("tilde",e,t,n,i,r,s),m(n)?a="":m(i)?a=`>=${n}.0.0 <${+n+1}.0.0-0`:m(r)?a=`>=${n}.${i}.0 <${n}.${+i+1}.0-0`:s?(o("replaceTilde pr",s),a=`>=${n}.${i}.${r}-${s} <${n}.${+i+1}.0-0`):a=`>=${n}.${i}.${r} <${n}.${+i+1}.0-0`,o("tilde return",a),a})),b=(e,t)=>e.trim().split(/\s+/).map((e=>w(e,t))).join(" "),w=(e,t)=>{o("caret",e,t);const n=t.includePrerelease?"-0":"";return e.replace(t.loose?a[l.CARETLOOSE]:a[l.CARET],((t,i,r,s,a)=>{let l;return o("caret",e,t,i,r,s,a),m(i)?l="":m(r)?l=`>=${i}.0.0${n} <${+i+1}.0.0-0`:m(s)?l="0"===i?`>=${i}.${r}.0${n} <${i}.${+r+1}.0-0`:`>=${i}.${r}.0${n} <${+i+1}.0.0-0`:a?(o("replaceCaret pr",a),l="0"===i?"0"===r?`>=${i}.${r}.${s}-${a} <${i}.${r}.${+s+1}-0`:`>=${i}.${r}.${s}-${a} <${i}.${+r+1}.0-0`:`>=${i}.${r}.${s}-${a} <${+i+1}.0.0-0`):(o("no pr"),l="0"===i?"0"===r?`>=${i}.${r}.${s}${n} <${i}.${r}.${+s+1}-0`:`>=${i}.${r}.${s}${n} <${i}.${+r+1}.0-0`:`>=${i}.${r}.${s} <${+i+1}.0.0-0`),o("caret return",l),l}))},k=(e,t)=>(o("replaceXRanges",e,t),e.split(/\s+/).map((e=>x(e,t))).join(" ")),x=(e,t)=>(e=e.trim()).replace(t.loose?a[l.XRANGELOOSE]:a[l.XRANGE],((n,i,r,s,a,l)=>{o("xRange",e,n,i,r,s,a,l);const c=m(r),u=c||m(s),d=u||m(a);return"="===i&&d&&(i=""),l=t.includePrerelease?"-0":"",c?n=">"===i||"<"===i?"<0.0.0-0":"*":i&&d?(u&&(s=0),a=0,">"===i?(i=">=",u?(r=+r+1,s=0,a=0):(s=+s+1,a=0)):"<="===i&&(i="<",u?r=+r+1:s=+s+1),"<"===i&&(l="-0"),n=`${i+r}.${s}.${a}${l}`):u?n=`>=${r}.0.0${l} <${+r+1}.0.0-0`:d&&(n=`>=${r}.${s}.0${l} <${r}.${+s+1}.0-0`),o("xRange return",n),n})),S=(e,t)=>(o("replaceStars",e,t),e.trim().replace(a[l.STAR],"")),C=(e,t)=>(o("replaceGTE0",e,t),e.trim().replace(a[t.includePrerelease?l.GTE0PRE:l.GTE0],"")),_=e=>(t,n,i,r,o,s,a,l,c,u,d,h,p)=>`${n=m(i)?"":m(r)?`>=${i}.0.0${e?"-0":""}`:m(o)?`>=${i}.${r}.0${e?"-0":""}`:s?`>=${n}`:`>=${n}${e?"-0":""}`} ${l=m(c)?"":m(u)?`<${+c+1}.0.0-0`:m(d)?`<${c}.${+u+1}.0-0`:h?`<=${c}.${u}.${d}-${h}`:e?`<${c}.${u}.${+d+1}-0`:`<=${l}`}`.trim(),E=(e,t,n)=>{for(let n=0;n<e.length;n++)if(!e[n].test(t))return!1;if(t.prerelease.length&&!n.includePrerelease){for(let n=0;n<e.length;n++)if(o(e[n].semver),e[n].semver!==r.ANY&&e[n].semver.prerelease.length>0){const i=e[n].semver;if(i.major===t.major&&i.minor===t.minor&&i.patch===t.patch)return!0}return!1}return!0};return qw}var nk,ik,rk=function(){if(Xw)return Kw;Xw=1;const e=tk();return Kw=(t,n,i)=>{try{n=new e(n,i)}catch(e){return!1}return n.test(t)},Kw}(),ok=r(rk),sk=function(){if(ik)return nk;ik=1;const e=kw(),t=xw(),{re:n,t:i}=bw();return nk=(r,o)=>{if(r instanceof e)return r;if("number"==typeof r&&(r=String(r)),"string"!=typeof r)return null;let s=null;if((o=o||{}).rtl){let e;for(;(e=n[i.COERCERTL].exec(r))&&(!s||s.index+s[0].length!==r.length);)s&&e.index+e[0].length===s.index+s[0].length||(s=e),n[i.COERCERTL].lastIndex=e.index+e[1].length+e[2].length;n[i.COERCERTL].lastIndex=-1}else s=r.match(n[i.COERCE]);return null===s?null:t(`${s[2]}.${s[3]||"0"}.${s[4]||"0"}`,o)},nk}(),ak=r(sk);function lk(e){let t;for(;e;)e.ekoMapStateToProps&&(t=t?ck(e.ekoMapStateToProps,t):e.ekoMapStateToProps),e=Object.getPrototypeOf(e);return t}function ck(e,t){return e&&t?(n,i)=>Object.assign(e(n,i),t(n,i)):e||t||void 0}By("#uiRootContainer {\n  width: 100%;\n  height: 100%;\n  position: relative;\n  z-index: 1;\n  pointer-events: none;\n}\n#uiRootContainer .eko_uiscope {\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  pointer-events: none;\n}\n#uiRootContainer .eko_uiscope.platformBelow {\n  z-index: 100;\n}\n#uiRootContainer .eko_uiscope.project {\n  z-index: 200;\n}\n#uiRootContainer .eko_uiscope.platformAbove {\n  z-index: 300;\n}\n#uiRootContainer .project > * {\n  pointer-events: all;\n}\n#uiRootContainer .ekoGroup, #uiRootContainer .ekoMenuLayer {\n  pointer-events: none;\n}\n#uiRootContainer .ekoGroup > *, #uiRootContainer .ekoMenuLayer > * {\n  pointer-events: all;\n}\n#uiRootContainer {\n  -webkit-perspective: 1;\n}\n\nbody.inSpark div[id*=uiPluginContainer-wrapper].overlayWrapper {\n  display: block;\n}");var uk,dk={},hk=function(){if(uk)return dk;function e(e,t){return e===t}function t(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,i=null,r=null;return function(){return function(e,t,n){if(null===t||null===n||t.length!==n.length)return!1;for(var i=t.length,r=0;r<i;r++)if(!e(t[r],n[r]))return!1;return!0}(n,i,arguments)||(r=t.apply(null,arguments)),i=arguments,r}}function n(e){for(var n=arguments.length,i=Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return function(){for(var n=arguments.length,r=Array(n),o=0;o<n;o++)r[o]=arguments[o];var s=0,a=r.pop(),l=function(e){var t=Array.isArray(e[0])?e[0]:e;if(!t.every((function(e){return"function"==typeof e}))){var n=t.map((function(e){return typeof e})).join(", ");throw new Error("Selector creators expect all input-selectors to be functions, instead received the following types: ["+n+"]")}return t}(r),c=e.apply(void 0,[function(){return s++,a.apply(null,arguments)}].concat(i)),u=t((function(){for(var e=[],t=l.length,n=0;n<t;n++)e.push(l[n].apply(null,arguments));return c.apply(null,e)}));return u.resultFunc=a,u.recomputations=function(){return s},u.resetRecomputations=function(){return s=0},u}}uk=1,dk.__esModule=!0,dk.defaultMemoize=t,dk.createSelectorCreator=n,dk.createStructuredSelector=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i;if("object"!=typeof e)throw new Error("createStructuredSelector expects first argument to be an object where each property is a selector, instead received a "+typeof e);var n=Object.keys(e);return t(n.map((function(t){return e[t]})),(function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return t.reduce((function(e,t,i){return e[n[i]]=t,e}),{})}))};var i=dk.createSelector=n(t);return dk}();const pk={};let fk={};function gk(e,t){return t&&t.decision&&t.decision[e]||pk}function mk(e,t){return t&&t.ui&&t.ui.controllers&&t.ui.controllers[e]||pk}function yk(e,t){return t&&t.player&&t.player.currentNodeId===e?t.player:pk}function vk(e){return fk[e]||(fk[e]=hk.createSelector([gk.bind(null,e),mk.bind(null,e),yk.bind(null,e)],((e,t,n)=>({...t,...e,nodeDuration:n.currentNodeDuration||0,nodeProgress:n.currentNodeProgress||0,nodeTime:n.currentNodeTime||0,nodeRemainingTime:n.currentNodeRemainingTime||0,selected:{...e.selected,nodeId:e.selected&&e.selected.node}})))),fk[e]}const bk={};let wk={};function kk(e,t){return t&&t.ui&&t.ui.controllers&&t.ui.controllers[e]||bk}function xk(e,t){return t&&t.player&&t.player.currentNodeId===e?t.player.currentVideoTrackIndex:0}function Sk(e){return wk[e]||(wk[e]=hk.createSelector([kk.bind(null,e),xk.bind(null,e)],((e,t)=>({...e,channelIndex:t})))),wk[e]}const Ck=(e,t)=>n=>{let i=e(n);return t?jb(i,t):i};function _k(e){var t=e&&e.ui&&e.ui.controllers||{},n={};return Object.keys(t).forEach((function(i){var r=t[i];n[i]=r.controllerType===Cb.DECISION?vk(i)(e):r.controllerType===Cb.PARALLEL?Sk(i)(e):r})),n}const Ek=function(){let e=null;const t=[];return{trigger:function(){e?e(...arguments):t.push(arguments)},addEventListener:function(n){if(null===e)for(e=n;t.length>0;)e(...t.shift())}}},Tk=e=>{let t=Array.from(e),n=t.map((e=>t=>e.includes("ui.controllers.")?function(e,t){let n=((e,t)=>{let n,i=[];do{n=t.exec(e),n&&(i=i.concat(i,Array.from(n)))}while(n);return i})(t,/ui\.controllers\.([\w-]+)(\.(.*))?/g),i=n[1],r=n[3],o=e.ui.controllers[i];return o.controllerType===Cb.DECISION?Ck(vk(i),r)(e):o.controllerType===Cb.PARALLEL?Ck(Sk(i),r)(e):jb(e,t)}(t,e):jb(t,e)));return hk.createSelector(n,((...e)=>{let n={};return t.forEach(((t,i)=>((e,t,n)=>(Object(e)!==e||(Array.isArray(t)||(t=t.toString().match(/[^.[\]]+/g)||[]),t.slice(0,-1).reduce(((e,n,i)=>Object(e[n])===e[n]?e[n]:e[n]=(0|Math.abs(t[i+1]))==+t[i+1]?[]:{}),e)[t[t.length-1]]=n),e))(n,t,e[i]))),n}))},Pk=(e,t,n,i)=>new Proxy(t,{get(r,o){let s=e[o],a=n?`${n}.${o}`:o;return"object"==typeof s&&null!==s?Pk(s,t[o]||{},a,i):(i(a),"function"==typeof s?s.bind(e):s)},has:(t,r)=>(n&&i(n),r in e),ownKeys:t=>(n&&i(n),Object.keys(e)),getOwnPropertyDescriptor:e=>({enumerable:!0,configurable:!0})}),Ik=()=>{let e=xb.player.reduxStore.getState();return{...e,ui:{...e.ui,controllers:_k(e)}}},Ak=(e,t)=>e.includes(t.path)?e:(player.debug&&xb.log.warn(`(${t.guiId}) Usage of props.globalState.${t.path} is deprecated and will be removed in future versions. Please see https://developer.eko.com/docs/state_and_redux.html`),[...e,t.path]);function Ok(e){const t=Pg.useRef(Ek());Pg.useEffect((()=>{t.current.addEventListener((t=>{i({path:t,guiId:e.guiId})}))}));const[n,i]=Pg.useReducer(Ak,[]),r=Pg.useMemo((()=>Tk(n)),[n]),o=wb(r),s=Pg.useMemo((()=>Pk(Ik(),o,null,(e=>t.current.trigger(e)))),[o]),a=Pg.useMemo((()=>({globalState:s})),[s]);return Ig.cloneElement(e.children,a)}var Lk={};function Nk(){var e=this.constructor.getDerivedStateFromProps(this.props,this.state);null!=e&&this.setState(e)}function Rk(e){this.setState(function(t){var n=this.constructor.getDerivedStateFromProps(e,t);return null!=n?n:null}.bind(this))}function Dk(e,t){try{var n=this.props,i=this.state;this.props=e,this.state=t,this.__reactInternalSnapshotFlag=!0,this.__reactInternalSnapshot=this.getSnapshotBeforeUpdate(n,i)}finally{this.props=n,this.state=i}}Nk.__suppressDeprecationWarning=!0,Rk.__suppressDeprecationWarning=!0,Dk.__suppressDeprecationWarning=!0;var Mk,Fk=Object.freeze({__proto__:null,polyfill:function(e){var t=e.prototype;if(!t||!t.isReactComponent)throw new Error("Can only polyfill class components");if("function"!=typeof e.getDerivedStateFromProps&&"function"!=typeof t.getSnapshotBeforeUpdate)return e;var n=null,i=null,r=null;if("function"==typeof t.componentWillMount?n="componentWillMount":"function"==typeof t.UNSAFE_componentWillMount&&(n="UNSAFE_componentWillMount"),"function"==typeof t.componentWillReceiveProps?i="componentWillReceiveProps":"function"==typeof t.UNSAFE_componentWillReceiveProps&&(i="UNSAFE_componentWillReceiveProps"),"function"==typeof t.componentWillUpdate?r="componentWillUpdate":"function"==typeof t.UNSAFE_componentWillUpdate&&(r="UNSAFE_componentWillUpdate"),null!==n||null!==i||null!==r)throw Error("Unsafe legacy lifecycles will not be called for components using new component APIs.\n\n"+(e.displayName||e.name)+" uses "+("function"==typeof e.getDerivedStateFromProps?"getDerivedStateFromProps()":"getSnapshotBeforeUpdate()")+" but also contains the following legacy lifecycles:"+(null!==n?"\n  "+n:"")+(null!==i?"\n  "+i:"")+(null!==r?"\n  "+r:"")+"\n\nThe above lifecycles should be removed. Learn more about this warning here:\nhttps://fb.me/react-async-component-lifecycle-hooks");if("function"==typeof e.getDerivedStateFromProps&&(t.componentWillMount=Nk,t.componentWillReceiveProps=Rk),"function"==typeof t.getSnapshotBeforeUpdate){if("function"!=typeof t.componentDidUpdate)throw new Error("Cannot polyfill getSnapshotBeforeUpdate() for components that do not define componentDidUpdate() on the prototype");t.componentWillUpdate=Dk;var o=t.componentDidUpdate;t.componentDidUpdate=function(e,t,n){o.call(this,e,t,this.__reactInternalSnapshotFlag?this.__reactInternalSnapshot:n)}}return e}});function Bk(){if(Mk)return Lk;Mk=1,Lk.__esModule=!0,Lk.default=Lk.EXITING=Lk.ENTERED=Lk.ENTERING=Lk.EXITED=Lk.UNMOUNTED=void 0;var e=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};i.get||i.set?Object.defineProperty(t,n,i):t[n]=e[n]}return t.default=e,t}(Pv()),t=r(Rg),n=r(Em),i=Fk;function r(e){return e&&e.__esModule?e:{default:e}}var o="unmounted";Lk.UNMOUNTED=o;var s="exited";Lk.EXITED=s;var a="entering";Lk.ENTERING=a;var l="entered";Lk.ENTERED=l;var c="exiting";Lk.EXITING=c;var u=function(e){var i,r;function u(t,n){var i;i=e.call(this,t,n)||this;var r,c=n.transitionGroup,u=c&&!c.isMounting?t.enter:t.appear;return i.appearStatus=null,t.in?u?(r=s,i.appearStatus=a):r=l:r=t.unmountOnExit||t.mountOnEnter?o:s,i.state={status:r},i.nextCallback=null,i}r=e,(i=u).prototype=Object.create(r.prototype),i.prototype.constructor=i,i.__proto__=r;var d=u.prototype;return d.getChildContext=function(){return{transitionGroup:null}},u.getDerivedStateFromProps=function(e,t){return e.in&&t.status===o?{status:s}:null},d.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},d.componentDidUpdate=function(e){var t=null;if(e!==this.props){var n=this.state.status;this.props.in?n!==a&&n!==l&&(t=a):n!==a&&n!==l||(t=c)}this.updateStatus(!1,t)},d.componentWillUnmount=function(){this.cancelNextCallback()},d.getTimeouts=function(){var e,t,n,i=this.props.timeout;return e=t=n=i,null!=i&&"number"!=typeof i&&(e=i.exit,t=i.enter,n=void 0!==i.appear?i.appear:t),{exit:e,enter:t,appear:n}},d.updateStatus=function(e,t){if(void 0===e&&(e=!1),null!==t){this.cancelNextCallback();var i=n.default.findDOMNode(this);t===a?this.performEnter(i,e):this.performExit(i)}else this.props.unmountOnExit&&this.state.status===s&&this.setState({status:o})},d.performEnter=function(e,t){var n=this,i=this.props.enter,r=this.context.transitionGroup?this.context.transitionGroup.isMounting:t,o=this.getTimeouts(),s=r?o.appear:o.enter;t||i?(this.props.onEnter(e,r),this.safeSetState({status:a},(function(){n.props.onEntering(e,r),n.onTransitionEnd(e,s,(function(){n.safeSetState({status:l},(function(){n.props.onEntered(e,r)}))}))}))):this.safeSetState({status:l},(function(){n.props.onEntered(e)}))},d.performExit=function(e){var t=this,n=this.props.exit,i=this.getTimeouts();n?(this.props.onExit(e),this.safeSetState({status:c},(function(){t.props.onExiting(e),t.onTransitionEnd(e,i.exit,(function(){t.safeSetState({status:s},(function(){t.props.onExited(e)}))}))}))):this.safeSetState({status:s},(function(){t.props.onExited(e)}))},d.cancelNextCallback=function(){null!==this.nextCallback&&(this.nextCallback.cancel(),this.nextCallback=null)},d.safeSetState=function(e,t){t=this.setNextCallback(t),this.setState(e,t)},d.setNextCallback=function(e){var t=this,n=!0;return this.nextCallback=function(i){n&&(n=!1,t.nextCallback=null,e(i))},this.nextCallback.cancel=function(){n=!1},this.nextCallback},d.onTransitionEnd=function(e,t,n){this.setNextCallback(n),!e||null==t&&!this.props.addEndListener?setTimeout(this.nextCallback,0):(this.props.addEndListener&&this.props.addEndListener(e,this.nextCallback),null!=t&&setTimeout(this.nextCallback,t))},d.render=function(){var e=this.state.status;if(e===o)return null;var n=this.props,i=n.children,r=function(e,t){if(null==e)return{};var n,i,r={},o=Object.keys(e);for(i=0;i<o.length;i++)t.indexOf(n=o[i])>=0||(r[n]=e[n]);return r}(n,["children"]);if(delete r.in,delete r.mountOnEnter,delete r.unmountOnExit,delete r.appear,delete r.enter,delete r.exit,delete r.timeout,delete r.addEndListener,delete r.onEnter,delete r.onEntering,delete r.onEntered,delete r.onExit,delete r.onExiting,delete r.onExited,"function"==typeof i)return i(e,r);var s=t.default.Children.only(i);return t.default.cloneElement(s,r)},u}(t.default.Component);function d(){}u.contextTypes={transitionGroup:e.object},u.childContextTypes={transitionGroup:function(){}},u.propTypes={},u.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:d,onEntering:d,onEntered:d,onExit:d,onExiting:d,onExited:d},u.UNMOUNTED=0,u.EXITED=1,u.ENTERING=2,u.ENTERED=3,u.EXITING=4;var h=(0,i.polyfill)(u);return Lk.default=h,Lk}var Uk=r(Bk());By("");const jk=400;function zk(e){return"transitionInDuration"in e?1e3*e.transitionInDuration:1e3}function Vk(e){return"transitionOutDuration"in e?1e3*e.transitionOutDuration:1e3}function Wk(e,t){let n;return n=e.transitionStyles?e.transitionStyles:{entering:{opacity:1},entered:{opacity:1},exiting:{opacity:0},exited:{opacity:0}},n={...n,entering:{...n.entering,transition:`all ${zk(e)}ms ease-out`},exiting:{...n.exiting,transition:`all ${Vk(e)}ms ease-in`}},n[t]}function Hk(e){let t="function"==typeof e.shouldShow,n="boolean"==typeof e.shouldShow,i="function"==typeof e.visibilitySelector,r=e.stateSourceId;const o=player.ui.useSelector((t=>{if(i)return e.visibilitySelector(t);if(r){let n=t.ui.controllers[e.stateSourceId];return n&&n.visible}return null})),[s,a]=Pg.useState(t?e.shouldShow():null);if(!e.enableTransition)return e.children;let l,c=Ig.Children.only(e.children);return n?l=e.shouldShow:t?l=s:r||i?l=o:xb.log.error("EkoTransition has no stateSource id or visibilitySelector defined"),Pg.useEffect((()=>{let n;return t&&(player.debug&&xb.log.warn(`${e.guiId}: Usage of shouldShow is deprecated and will be removed in future versions. Please see https://developer.eko.com/api/EkoTransition.html`),n=setInterval((()=>a(e.shouldShow())),jk)),()=>{t&&clearInterval(n)}}),[t]),Ig.createElement(Uk,{in:l,onEnter:e=>e.scrollTop,timeout:Math.max(zk(e),Vk(e)),mountOnEnter:!0,unmountOnExit:!0,appear:!0},(t=>Ig.createElement("div",{className:"ekoTransition",style:Wk(e,t)},c)))}function $k(e){let t=lk(e);return t&&(e=fb(t)(e)),e}function Gk(e,t,n){let i={transition:e.enableTransition,...n};return function(t){return i.legacyGlobalState&&(t=Ig.createElement(Ok,{guiId:e.guiId},t)),i.transition&&(t=Ig.createElement(Hk,{stateSourceId:e.stateSourceId,enableTransition:e.enableTransition,transitionInDuration:e.transitionInDuration,transitionOutDuration:e.transitionOutDuration,shouldShow:e.shouldShow,visibilitySelector:e.visibilitySelector,transitionStyles:e.transitionStyles,guiId:e.guiId},t)),t}}function qk(e){return{...e,player:xb.player,dispatchProcessHandler:Yk,key:e.guiId}}const Yk=e=>{xb.player.trigger("ui.processhandler",e)};function Kk(e){let t=e.config,n=qk(e),i={},r=null;const o="WrappedComponent"in t.componentClass,s=t.componentClass.prototype&&t.componentClass.prototype.isReactComponent;if(o)r=Ig.createElement(t.componentClass,n);else{let e=$k(t.componentClass);r=Ig.createElement(e,n)}return i.legacyGlobalState=s&&!o,r=Gk(e,0,i)(r),r}var Xk=Ig.memo(Kk);function Qk(e){let t=Pg.useRef(),[n,i]=Pg.useState(!1),[r,o]=Pg.useState(!1);Pg.useEffect((()=>{r||n||(i(!0),e.loadPromise.then((e=>{t.current=e,i(!1),o(!0)})))}),[]);let s=null;if(r){let n=t.current.default;e.wrapClassWith&&(n=e.wrapClassWith(n));let i=Ig.createElement(n,e.componentProps);s=e.wrapInstanceWith?e.wrapInstanceWith(i):i}return s}var Zk=Ig.memo(Qk);function Jk(e){let t=e.config,n=qk(e),i={legacyGlobalState:!1},r=Pg.useMemo((()=>Fb(t.componentClassName)),[t.componentClassName]),o=Pg.useMemo((()=>Gk(e,0,i)),[e,t]);return Ig.createElement(Zk,{loadPromise:r,wrapInstanceWith:o,wrapClassWith:$k,componentProps:n})}var ex=Ig.memo(Jk);function tx(e){return e.config.componentClass?Ig.createElement(Xk,e):e.config.componentClassName?Ig.createElement(ex,e):void 0}var nx=r(ek());function ix(e=[]){let t={};function n(e,n,i){i in t==0&&(t[i]={}),t[i][e]=n}return e.forEach((e=>{Object.keys(e.implementation).forEach((t=>{n(t,e.implementation[t],e.version)}))})),{get:function(e,n){if(n in t&&e in t[n])return t[n][e];{let i=Object.keys(t).filter((n=>e in t[n])),r=function(e,t){let n=[...e].sort(((e,t)=>nx(e,t)?1:-1)),i=null;for(let e=0;e<n.length&&!nx(n[e],t);e++)i=n[e];return i}(i,n);return t[r][e]}},set:n}}function rx(e){let[t,n]=Pg.useState([]);Pg.useEffect((()=>{const t=t=>{let i=sx(e.components);n(i)};return Ix("guiAdded",t),Ix("guiOverriden",t),t(),()=>{Ax("guiAdded",t),Ax("guiOverriden",t)}}),[]);let i=xb.player.ui.getConfigSchemaVersion(),r=ox.get("getComponents",i);return Pg.useMemo(r(t,{sortFunction:e.sortFunction,wrapFunction:e.wrapFunction}),[t])}let ox=ix();const sx=e=>"function"==typeof e?Object.keys(_x(e)):Array.isArray(e)?e:"string"==typeof e?[e]:void 0;ox.set("getComponents",((e,t)=>()=>e.map((e=>Ig.createElement(tx,Ja({guiId:e,key:e},Cx(e).props))))),"0.0.0"),ox.set("getComponents",((e,t)=>()=>{let n=e,{sortFunction:i,wrapFunction:r}=t;return i&&n.sort(((e,t)=>i(e,Cx(e),t,Cx(t)))),n.map((e=>{let t=Cx(e).props,n={...t,style:{...t.style,zIndex:t.zOrder}},i=Ig.createElement(tx,Ja({guiId:e,key:e},n));return r&&(i=r(i)),i}))}),"1.0.0");const ax=(e,t)=>e.includes(t.scope)?e:[...e,t.scope];function lx(e){const[t,n]=Pg.useReducer(ax,[]);Pg.useEffect((()=>{(()=>{let e=Object.values(_x((()=>!0))).map((e=>e.options.scope));return Array.from(new Set(e))})().forEach((e=>n({scope:e})));const e=e=>{if(Array.isArray(e.gui)){let t=new Set;e.gui.filter((e=>e.options&&e.options.scope)).forEach((e=>t.add(e.options.scope))),Array.from(t).forEach((e=>n({scope:e})))}else n({scope:e.gui.options.scope})};return Ix("guiAdded",e),Ix("guiOverriden",e),()=>{Ax("guiAdded",e),Ax("guiOverriden",e)}}));const i=t.map((t=>Ig.createElement("div",{className:`eko_uiscope ${t}`,key:t},Ig.createElement(rx,{components:(n,i)=>i.props.config.parentElement===e.guiId&&i.options&&i.options.scope===t}))));return Ig.createElement(Fv,{store:e.store},Ig.createElement("div",{id:"uiRootContainer"},i))}let cx={};function ux(e){e.name in cx==0?"GoogleFonts"===e.source?function(e){let{name:t,weights:n,display:i}=e,r=document.createElement("link");r.setAttribute("rel","stylesheet");let o=`https://fonts.googleapis.com/css?family=${t.replace(/ /gi,"+")}${n?`:${n.join(",")}`:""}`;i&&(o+=`&display=${i}`),r.setAttribute("href",o),document.head.appendChild(r),setTimeout((()=>{document.fonts&&document.fonts.load(`26px ${t}`).then((()=>{cx[t]=!0}))}),100)}({name:e.name,weights:e.weights,display:e.display}):"url"===e.source&&function(e){let t=document.createElement("link");t.setAttribute("rel","stylesheet"),t.setAttribute("href",e.url),document.head.appendChild(t)}({url:e.url}):xb.player.debug&&console.warn(`UI: attempted to load web font ${e.name}, but font already loaded. Ignoring.`)}const dx=["stateSourceId","enableTransition","fitToVideo","transitionInDuration","transitionOutDuration"],hx="root",px=new nw;let fx,gx={},mx={};function yx(e){return e&&e.prototype&&e.prototype.isReactComponent||e&&e.WrappedComponent||"function"==typeof e}function vx(e){delete e.props.config.componentClass,delete e.props.config.componentClassName,yx(e.component)?e.props.config.componentClass=e.component:"string"==typeof e.component?(e.props.config.componentClassName=e.component,e.props.type=e.props.config.componentClassName):xb.log.error(`[_extendGuiComponentData] got an invalid component type, ${JSON.stringify(e)}`)}function bx(e){return{scope:"project",...e}}function wx(e){var t;e.guiControllers=e.guiControllers||[],e.gui=e.gui||[],e.apiVersion=e.apiVersion?e.apiVersion:"0.0.0",e.apiVersion="0"===(t=e.apiVersion)?"0.0.1":Zw(t,{includePrerelease:!0}),e.schemaVersion&&(fx=e.schemaVersion),"0.0.0-fastload"===e.apiVersion||ok(ak(e.apiVersion),">=3.20.0")?function(e){let t=e.gui.map((e=>({id:e.id,component:e.component,props:e.props,options:bx({skipConfigPropValidation:!0,addedFromConfig:!0})})));e.guiControllers.forEach((e=>{xx(e.id,e.type,e.config)})),t.forEach((e=>kx(e.id,e.component,e.props,e.options))),px.emit("guiAdded",{gui:t}),e.fonts&&e.fonts.forEach((e=>ux(e)))}(e):function(e){e.guiControllers.forEach((e=>{xx(e)})),e.gui.forEach((e=>{kx(e)}))}(e)}function kx(e,t,n,i){i=i||{},n=n||{};let r=!0;if("object"==typeof e&&(i.skipConfigPropValidation=!0,t=e.component,n={config:e},e=e.id),!t)return void xb.log.error('[add] Ignoring add - missing "component" argument');if(!i.skipConfigPropValidation&&n.config)return void xb.log.error('[add] Ignoring add - "config" prop is reserved and cannot be used');if(mx[e])throw`[UI] [add] Ignoring add - gui with this id already exist: ${e}`;n.config=n.config||{},function(e){let t=dx;for(let n of t)n in e.config&&(e[n]=e.config[n],delete e.config[n])}(n),(i=bx(i)).addedFromConfig&&(r=!1,delete i.addedFromConfig);let o={component:t,props:n,options:i};vx(o),mx[e]=o,n.children&&(n.config.children=[],"enableTransition"in n==0&&(n.enableTransition=!0),n.children.forEach((t=>{let i=t.props||{};i.config=i.config||{},i.config.parentElement=e;let r={skipConfigPropValidation:!0,...t.options};n.config.children.push(t.id),kx(t.id,t.component,i,r)}))),n.config.parentElement!==hx&&"parentElement"in n.config!=0||function(e){let t=mx[hx];mx[e].props.config.parentElement=hx,t.props.config.children=[...t.props.config.children,e]}(e),Kb(e,n),r&&px.emit("guiAdded",{gui:o})}function xx(e,t,n){let i=!1;if("object"==typeof e&&("string"!=typeof e.type&&(i=!0),t=e.type,n=e,e=e.id),!t)return void xb.log.error('[addController] Ignoring add - missing "typeOrClass" argument');if(gx[e])return void xb.log.warn("[addController] Ignoring add - gui controller with this id already exist:",e);let r=Mb(t);gx[e]={config:n,instance:null};let o=i?new r(n):new r(e,n);gx[e].instance=o}function Sx(e,t,n){let i=!0,r=!1;null===t||"object"!=typeof t||yx(t)||(i=!1,r=!0,n={config:t},t=t.component);let o=[],s=[];(Array.isArray(e)?e:[e]).forEach((e=>{let a=[],l=[];if(e instanceof RegExp)for(let t in mx)e.test(t)&&(a.push(mx[t]),l.push(t));else mx[e]&&(a.push(mx[e]),l.push(e));a.length>0?(a.forEach(((e,o)=>{if(t&&(e.component=t,vx(e)),n){if(i&&n.config)return void xb.log.error('[override] Ignoring override - "config" prop is reserved and cannot be used');let t=e.props.config,o={...e.props,...n};t&&n.config&&(o.config={...t,...n.config}),r?e.props.config=o.config:e.props=o}Kb(l[o],e.props)})),s=s.concat(l),o=o.concat(a)):xb.log.error("[override] Could not find any gui with this id/regex:",e)})),Px({id:s,gui:o})}function Cx(e){return Array.isArray(e)?e.map((t=>e[t])):mx[e]}function _x(e,t){let n={};return Object.keys(mx).forEach((t=>{let i=mx[t];e(t,i)&&(n[t]=i)})),n}function Ex(e){function t(e){for(let t of dx)t in e.config==0&&(e.config[t]=e[t],delete e[t])}if(void 0===e){let e=Tx(null,{keepConfig:!0});return Object.keys(e).reduce(((n,i)=>(t(e[i]),n[i]=e[i].config,n)),{})}{if(!mx[e])return void xb.log.error("[getConfig] Could not find any gui with this id:",e);let n=Tx(e,{keepConfig:!0});return t(n),n.config}}function Tx(e,t={}){function n(e){return"keepConfig"in t==0&&delete e.config,e}return null==e?Object.keys(mx).reduce(((e,t)=>(e[t]=n({...mx[t].props}),e)),{}):mx[e]?n({...mx[e].props}):void xb.log.error("[getProps] Could not find any gui with this id:",e)}const Px=function(){let e,t=[],n=[],i=Date.now();function r(){px.emit("guiOverriden",{id:t,gui:n}),t=[],n=[],i=Date.now()}return function(o){Date.now()-i>300?r():(t=t.concat(o.id),n=n.concat(o.gui),clearTimeout(e),e=setTimeout(r,300))}}(),Ix=(e,t)=>px.addListener(e,t),Ax=(e,t)=>px.removeListener(e,t);function Ox(){return fx||"0.0.0"}function Lx(e){"pause"===e.action&&(e.pause_type="creative pause",e.creative_pause_type="studio action",window.InterludeAnalytics.off("beforeEventSend",Lx))}let Nx={[Cb.TRIGGER_EVENT]:function(e){if(!e.event||"string"!=typeof e.event)return void xb.log.warn("Missing 'event' value for TRIGGER_EVENT action");let t=void 0===e.args?[]:Array.isArray(e.args)?e.args:[e.args];xb.player.trigger.apply(xb.player,[e.event].concat(t))},[Cb.DECISION_SELECT]:function(e){e.targetNode?xb.player.decision.get(e.decisionId).make(e.targetNode,{seek:e.connectOn===Cb.CLICK,..."linger"in e&&{data:{linger:e.linger}}}):xb.log.warn("Missing node value for decision selection action")},[Cb.NODE_SELECT]:function(e){e.targetNode?e.connectOn===Cb.CLICK?xb.player.seek(e.targetNode):xb.player.append(e.targetNode):xb.log.warn("Missing node value for node selection action")},[Cb.PARALLEL_SWITCH]:function(e){xb.player.switch(e.channelIndex)},[Cb.OPEN_URL]:function(e){let t=e.url;t?(-1===t.indexOf("http")&&(t=`${window.location.protocol}//${t}`),xb.player.urls.open(t,"_blank")):xb.log.warn("Missing url value for opening url action")},[Cb.SHARE]:function(e){xb.player.share.share()},[Cb.TOGGLE_PLAY]:function(e){xb.player.paused?xb.player.play():(window.InterludeAnalytics&&"function"==typeof window.InterludeAnalytics.on&&window.InterludeAnalytics.on("beforeEventSend",Lx),xb.player.pause())},[Cb.PLAY_SOUND]:function(e){xb.player.audio.play(e.audioId)},[Cb.MENU_LAYER_EXPAND_COLLAPSE]:function(e){let t=e.menuLayerId;Bb(xb.store.getState().ui.controllers[t].expanded?{type:Tb.UI_MENU_LAYER_COLLAPSE,menuLayerId:t}:{type:Tb.UI_MENU_LAYER_EXPAND,menuLayerId:t})},[Cb.REPORT_INTERACTION]:function(e){if(!xb.player.interactions)return;let t=Tx(e.id);const n=xb.ctx.utils.extend({},e.data,{metadata:{studio:t&&t.studio}});xb.player.interactions&&xb.player.interactions.report(e.id,n,e.options)},[Cb.NEXT_VIDEO]:function(e){if(!xb.player.project)return void console.error("[nextVideoHandler] Project plugin was not found.");const t=xb.linkoutNextUp?"_blank":"_self";e.projectId?xb.player.project.navigateTo(e.projectId,{target:t}):xb.player.project.getNext().then((e=>{xb.player.project.navigateTo(e.id,{target:t})})).catch((e=>{console.error("[nextVideoHandler] Failed getting next project.",e)}))},[Cb.REPLAY_VIDEO]:function(e){e.nodeId?xb.player.control.replay(e.nodeId):xb.player.control.replay()}};By(".ekoGroup {\n  position: absolute;\n  transform-style: preserve-3d;\n}\n.ekoGroup > fieldset {\n  border: 0;\n  margin: 0;\n  padding: 0;\n}\n.ekoGroup > fieldset > legend {\n  position: absolute;\n  width: 1px;\n  height: 1px;\n  padding: 0;\n  margin: -1px;\n  overflow: hidden;\n  clip: rect(0, 0, 0, 0);\n  white-space: nowrap; /* added line */\n  border: 0;\n}\n.ekoGroup > fieldset > ul {\n  list-style-type: none;\n  margin: 0;\n  padding: 0;\n}");const Rx=ix([{version:"0.0.0",implementation:{getRenderOutput:function(e){return Ig.createElement("div",{className:e.className,style:e.style,key:e.key},e.children)},getWrapFunction:function(e){return e=>Ig.createElement("li",null,e)}}},{version:"1.0.0",implementation:{getRenderOutput:function(e){return Ig.createElement("div",{className:e.className,style:e.style,key:e.key},!1===e.containsButtonList?e.children:Ig.createElement("fieldset",null,e.legend?Ig.createElement("legend",null,e.legend):null,Ig.createElement("ul",null,e.children)))},getWrapFunction:function(e){return!1===e.containsButtonList?e=>e:e=>Ig.createElement("li",null,e)}}},{version:"1.1.0",implementation:{getRenderOutput:function(e){return Ig.createElement("div",{className:e.className,style:e.style,key:e.key},e.containsButtonList?Ig.createElement("fieldset",null,e.legend?Ig.createElement("legend",null,e.legend):null,Ig.createElement("ul",null,e.children)):e.children)},getWrapFunction:function(e){return e.containsButtonList?e=>Ig.createElement("li",null,e):e=>e}}}]);By(".ekoButton {\n  position: absolute;\n  background-color: var(--background-color);\n  color: black;\n  border-radius: 5px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  cursor: pointer;\n  transition: all 0.2s ease-in;\n  white-space: nowrap;\n  font-size: 12px;\n  padding: 10px;\n  pointer-events: all;\n}\n.ekoButton .disabled {\n  pointer-events: none;\n}\n\n.ekoButton[aria-disabled=true],\n#uiRootContainer .ekoGroup .ekoButton[role=img],\n#uiRootContainer .ekoGroup .disabled {\n  pointer-events: none;\n}");class Dx extends Ig.Component{constructor(e){super(e),this.containerRef=Ig.createRef(),this.boundEkoClickHandler=this.ekoClickHandler.bind(this),this.boundKeyDownHandler=this.keyDownHandler.bind(this)}ekoClickHandler(e){(this.props.config.handlers||[]).forEach((e=>this.props.dispatchProcessHandler(e))),this.clickHandler(e),this.props.clickHandler&&this.props.clickHandler.call(this,e)}clickHandler(){}keyDownHandler(e){" "!==e.key&&"Enter"!==e.key&&"Spacebar"!==e.key||(e.preventDefault(),this.ekoClickHandler(e))}getClassnames(){return"ekoButton"}getContent(){return this.getLabel()}getLabel(){return this.props.label||this.props.config.text}render(){let e=this.props.config,t=this.getClassnames(),n=!1!==this.props.interactable,i=n&&!0!==this.props.isPlayerPaused&&!0!==t.toLowerCase().includes("disabled"),r=n?{onClick:this.boundEkoClickHandler,onKeyDown:this.boundKeyDownHandler,role:"button",tabIndex:i?"0":"-1","aria-disabled":!i}:{role:"img"};return Ig.createElement("div",Ja({id:this.props.guiId,className:t,style:{...e.style,...this.props.style},key:this.props.guiId,ref:this.containerRef,"aria-label":this.getLabel()},r),this.getContent())}static ekoMapStateToProps(e,t){return{isPlayerPaused:e.player.isPaused}}}var Mx,Fx,Bx,Ux={exports:{}},jx=(Mx||(Mx=1,function(e){!function(){var t={}.hasOwnProperty;function n(){for(var e=[],i=0;i<arguments.length;i++){var r=arguments[i];if(r){var o=typeof r;if("string"===o||"number"===o)e.push(r);else if(Array.isArray(r)&&r.length){var s=n.apply(null,r);s&&e.push(s)}else if("object"===o)for(var a in r)t.call(r,a)&&r[a]&&e.push(a)}}return e.join(" ")}e.exports?(n.default=n,e.exports=n):window.classNames=n}()}(Ux)),Ux.exports),zx=r(jx);class Vx extends Dx{constructor(e){super(e),this.targetNodeId=this.getDecisionNodeId();let t=this.getDecisionSelectHandlerConfig();this.isDecisionSeek=t&&t.connectOn===Cb.CLICK}getDecisionSelectHandlerConfig(){return(this.props.config.handlers||[]).find((e=>e.type===Cb.DECISION_SELECT))}getClassNames(){let e=super.getClassnames(),t=this.props.selectedNodeId,n=zx({selected:this.targetNodeId&&t===this.targetNodeId,disabled:this.props.decisionInactive||t&&(this.props.selectedSeek||t&&!this.isDecisionSeek)});return e+=n?` ${n}`:"",e}getClassnames(){return this.getClassNames()}getDecisionNodeId(){let e=this.getDecisionSelectHandlerConfig();return e?e.targetNode:null}static ekoMapStateToProps(e,t){let n=e.decision[t.stateSourceId];return{selectedNodeId:n&&n.selected&&n.selected.node,selectedSeek:n&&n.selected&&n.selected.seek,decisionInactive:n&&"inactive"===n.state}}}function Wx(e,t){let n=e.props.lottieData.markers,i=n.find((e=>e.cm===`${t}-Start`)),r=n.find((e=>e.cm===`${t}-End`));return i&&r?[i.tm,r.tm]:null}var Hx=function(){if(Bx)return Fx;Bx=1;var e=.1,t="function"==typeof Float32Array;function n(e,t){return 1-3*t+3*e}function i(e,t){return 3*t-6*e}function r(e){return 3*e}function o(e,t,o){return((n(t,o)*e+i(t,o))*e+r(t))*e}function s(e,t,o){return 3*n(t,o)*e*e+2*i(t,o)*e+r(t)}function a(e){return e}return Fx=function(n,i,r,l){if(!(0<=n&&n<=1&&0<=r&&r<=1))throw new Error("bezier x values must be in [0, 1] range");if(n===i&&r===l)return a;for(var c=t?new Float32Array(11):new Array(11),u=0;u<11;++u)c[u]=o(u*e,n,r);return function(t){return 0===t?0:1===t?1:o(function(t){for(var i=0,a=1;10!==a&&c[a]<=t;++a)i+=e;--a;var l=i+(t-c[a])/(c[a+1]-c[a])*e,u=s(l,n,r);return u>=.001?function(e,t,n,i){for(var r=0;r<4;++r){var a=s(t,n,i);if(0===a)return t;t-=(o(t,n,i)-e)/a}return t}(t,l,n,r):0===u?l:function(e,t,n,i,r){var s,a,l=0;do{(s=o(a=t+(n-t)/2,i,r)-e)>0?n=a:t=a}while(Math.abs(s)>1e-7&&++l<10);return a}(t,i,i+e,n,r)}(t),i,l)}},Fx}(),$x=r(Hx);By(".ekoTimer {\n  position: absolute;\n}");const Gx=$x(.4,0,.6,1);class qx extends Ig.Component{constructor(e){super(e),this.containerRef=Ig.createRef(),this.boundEkoClickHandler=this.ekoClickHandler.bind(this)}ekoClickHandler(e){(this.props.config.handlers||[]).forEach((e=>this.props.dispatchProcessHandler(e))),this.clickHandler(e),this.props.clickHandler&&this.props.clickHandler.call(this,e)}clickHandler(){}getContent(){return null}getClassnames(){return"ekoTimer"}render(){let e=this.props.config,t=this.props.progress;return Ig.createElement("div",{id:this.props.guiId,className:this.getClassnames(),onClick:this.boundEkoClickHandler,style:{...e.style,...this.props.style,"--timer-progress":Gx(t)},key:this.props.guiId,ref:this.containerRef},this.getContent())}static ekoMapStateToProps(e,t){let n=e.decision[t.stateSourceId];return{progress:n&&n.progress}}}function Yx(e,t){let n=e.props.lottieData.markers,i=n.find((e=>e.cm===`${t}-Start`)),r=n.find((e=>e.cm===`${t}-End`));if(i&&r)return[i.tm,r.tm];console.error(`EkoLottieDecisionButton: No Start/End markers found with name ${t}`)}var Kx={[Cb.EkoGroup]:function(e){let t=e.config,n=e.player,i=n.ui.useFitToVideoStyle(),r=n.ui.getConfigSchemaVersion(),o=Rx.get("getWrapFunction",r)(e),s=Rx.get("getRenderOutput",r),a=Ig.createElement(n.ui._EkoComponentList,{components:(t,n)=>e.config.children.includes(t),sortFunction:(t,n,i,r)=>{let o=e.config.children,s=o.indexOf(t),a=o.indexOf(i);return s<a?-1:a<s?1:0},wrapFunction:o}),l=`ekoGroup ekoGroup_${e.guiId}`,c={...t.style,...e.style};return!1!==e.fitToVideo&&(c={...c,...i}),Ig.createElement(s,{className:l,style:c,key:e.guiId,legend:e.title,containsButtonList:e.containsButtonList},a)},[Cb.EkoButton]:Dx,[Cb.EkoDecisionButton]:Vx,[Cb.EkoLottieDecisionButton]:class extends Vx{componentDidUpdate(e){let{visible:t,selectedNodeId:n}=this.props;0===this.props.config.style.opacity||(!e.visible&&t?this.onStateVisible():e.visible&&!t?this.onStateHidden():e.visible&&t&&(e.selectedNodeId!==this.targetNodeId&&n===this.targetNodeId?this.onStateSelected():(null===e.selectedNodeId||void 0===e.selectedNodeId&&n&&n!==this.targetNodeId)&&this.onStateInactive()))}componentDidMount(){this.targetNodeId=this.getDecisionNodeId(),this.props.Lottie.setLocationHref(window.location.href),this.animation=this.props.Lottie.loadAnimation({container:this.containerRef.current,renderer:"svg",loop:!1,autoplay:!1,animationData:this.props.lottieData}),this.onStateVisible()}componentWillUnmount(){this.animation.destroy()}getContent(){return null}onStateVisible(){this.playMarker(["Appear","Idle"],!0)}onStateHidden(){this.targetNodeId===this.props.selectedNodeId?Wx(this,"Disappear-Selected")&&this.playMarker("Disappear-Selected"):Wx(this,"Disappear-NotSelected")&&this.playMarker("Disappear-NotSelected")}onStateSelected(){this.playMarker("Selected")}onStateInactive(){this.playMarker("NotSelected")}playMarker(e,t=!1){let n;"string"==typeof e?n=[e]:Array.isArray(e)&&(n=e);let i=n.map((e=>Wx(this,e)||(console.error(`EkoLottieDecisionButton: No Start/End markers found with name ${e}`),null)));i.length>0&&(this.animation.loop=t,this.animation.playSegments(i,!0))}static ekoMapStateToProps(e,t){let n=e.ui.controllers[t.stateSourceId];return{visible:n&&n.visible}}},[Cb.EkoLottieTimer]:class extends qx{constructor(e){super(e),this.boundDoRAF=this.doRAF.bind(this),this.isRAFActive=!1}componentDidMount(){this.isRAFActive=!0,this.boundDoRAF(),this.animation=this.props.Lottie.loadAnimation({container:this.containerRef.current,renderer:"svg",loop:!1,autoplay:!1,animationData:this.props.lottieData}),this.playMarker(["Appear"])}componentWillUnmount(){this.isRAFActive=!1,this.animation.destroy()}componentDidUpdate(e){let t=this.props;!e.visible&&t.visible||e.visible&&!t.visible&&this.onStateHidden()}doRAF(e){this.isRAFActive&&(this.onAnimationFrame(e),requestAnimationFrame(this.boundDoRAF))}onAnimationFrame(){let e=function(e,t,n){let i=e.decision[n.stateSourceId],r=t.decision.get(n.stateSourceId),o=e.ui.controllers[n.stateSourceId],s={inDecisionNode:t.currentNodeId===n.stateSourceId,nodeTime:t.currentNodeTime,nodeDuration:t.currentNodeDuration,nodeRemainingTime:t.currentNodeRemainingTime,decisionRemainingTime:r&&r.remainingTime,selectionTime:i&&i.selectionTime,decisionActive:o&&o.decisionActive,inLingerTimeout:o&&o.inLingerTimeout,duration:r&&r.duration};return o.controllerType===Cb.DECISION?s.selectedNodeId=i&&i.selected&&i.selected.node:o.controllerType===Cb.PARALLEL&&(s.channelIndex=i&&i.channelIndex),s}(this.props.player.reduxStore.getState(),this.props.player,this.props);if(this.prevNodeTime!==e.nodeTime&&e.inDecisionNode){let t;t=!1!==e.decisionActive||!1!==e.visible&&!e.inLingerTimeout?{currentNodeRemainingTime:e.nodeRemainingTime,currentDecisionPushToNodeEndDuration:e.selectionTime?e.nodeDuration-e.selectionTime:e.nodeDuration,currentDecisionDuration:e.duration,currentDecisionRemainingTime:e.decisionRemainingTime}:{currentNodeRemainingTime:e.nodeRemainingTime,currentDecisionPushToNodeEndDuration:0,currentDecisionDuration:e.duration,currentDecisionRemainingTime:0},this.onTimeChange(t,null!=e.selectedNodeId),this.prevNodeTime=e.nodeTime}}onStateVisible(){this.playMarker("Appear")}onStateHidden(){this.playMarker("Disappear")}onTimeChange(e,t){this.setMarkerProgress("Progress",(e.currentDecisionDuration-e.currentDecisionRemainingTime)/e.currentDecisionDuration)}getClassnames(){return"ekoTimer lottieTimer"}getContainer(){return this.containerRef.current}setMarkerProgress(e,t){if(this.animation&&this.animation.isPaused){let n=Yx(this,e),i=n[0]+Math.floor(t*(n[1]-n[0]));this.animation.goToAndStop(i,!0)}}playMarker(e,t=!1){let n;"string"==typeof e?n=[e]:Array.isArray(e)&&(n=e);let i=n.map((e=>Yx(this,e)));i.length>0&&(this.animation.loop=t,this.animation.playSegments(i,!0))}static ekoMapStateToProps(e,t){let n=e.ui.controllers[t.stateSourceId];return{visible:n&&n.visible}}},[Cb.EkoParallelButton]:class extends Dx{constructor(e){super(e),this.channelIndex=this.getChannelIndex()}getClassnames(){let e=super.getClassnames(),t=this.props.globalState.ui.controllers[this.props.stateSourceId],n=t&&t.channelIndex,i=Number.isInteger(this.channelIndex)&&n===this.channelIndex,r=zx({selected:i,disabled:i});return e+=r?` ${r}`:"",e}getChannelIndex(){let e=null;return(this.props.config.handlers||[]).forEach((t=>{t.type===Cb.PARALLEL_SWITCH&&null===e&&(e=t.channelIndex)})),e}},[Cb.EkoTimer]:qx,[Cb.EkoTransition]:Hk,connect:e=>t=>function(e,t){return n=>{let i=Pg.useRef(null),[r,o]=Pg.useState(!1),[s,a]=Pg.useState(!1),l=null;return Pg.useEffect((()=>{!1===s&&(a(!0),n.player.pluginInited("ui").then((()=>{let r=ck(lk(t),e);i.current=n.player.ui.connect(r)(t),o(!0)})))}),[e,t]),r&&(l=Ig.createElement(i.current,n)),l}}(e,t)};const Xx=e=>({containerWidth:e.player.containerWidth,containerHeight:e.player.containerHeight,videoWidthPercent:e.player.videoWidthPercent,videoHeightPercent:e.player.videoHeightPercent,videoLeftPercent:e.player.videoLeftPercent,videoTopPercent:e.player.videoTopPercent});function Qx(){let e,t,n,i,r,o=wb(Xx,Jv),s=o.containerWidth*(o.videoWidthPercent/100),a=o.containerHeight*(o.videoHeightPercent/100),l=Math.abs(1-s/a)<.1;return[e,t]=l||s/a<1?[270,480]:[854,480],n=Math.max(s/e,a/t),i=o.videoLeftPercent-(e*n/o.containerWidth*100-o.videoWidthPercent)/2,r=o.videoTopPercent-(t*n/o.containerHeight*100-o.videoHeightPercent)/2,Math.abs(i-o.videoLeftPercent)<1e-5&&(i=o.videoLeftPercent),Math.abs(r-o.videoTopPercent)<1e-5&&(r=o.videoTopPercent),{width:e+"px",height:t+"px",left:i+"%",top:r+"%",transform:`scaleX(${n}) scaleY(${n})`,transformOrigin:"top left"}}var Zx;kb.options.redux={reducer:function(e={},t){let n,i={...e,controllers:{...e.controllers}};if(Tb[t.type]&&(n=Tb[t.type].controllerClass)){let r=t[Tb[t.type].controllerKey],o=n.getReducer();i.controllers[r]=o(e.controllers[r],{...t,type:Tb[t.type]})}else{let n=t.controllerId;if(n){let r=gx[n];r.config.reducer&&(i.controllers[n]=(0,r.config.reducer)(e.controllers[n],t))}}return i}},InterludePlayer&&InterludePlayer.registerPlugin?InterludePlayer.registerPlugin(kb.name,(function(e,t){var n=new(e.BaseModuleClass.extend({name:"UI",logLevel:"warn",_version:kb.options.version,defaults:{},events:{},addPlayerListeners:function(){this.addOrRemovePlayerListeners("add")},removePlayerListeners:function(){this.addOrRemovePlayerListeners("remove")},addOrRemovePlayerListeners:function(t){e.player[t="add"===t?"on":"off"]("ui.processhandler",this.onProcessHandler)},onProcessHandler:function(e){!function(e){let t=Nx[e];return t||xb.log.error("[getHandlerByType] Unknown handler type:",e),t}(e.type)(e)},ctor:function(){e.utils.extend(!0,e.player.events,this.events),this.addPlayerListeners(),this.expose({add:kx,addController:xx,override:Sx,connect:fb,useSelector:wb,useFitToVideoStyle:Qx,_EkoComponentList:rx,getConfig:Ex,getProps:Tx,loadWebFont:ux,getConfigSchemaVersion:Ox,createFromConfig:wx,preloadImage:qb,constants:Cb}),this.defineProperty("version",(function(){return this._version})),this.exposeProperty("version"),xb.ctx=e,xb.player=e.player,xb.log=this.log,xb.store=e.player.reduxStore,xb.origin=t.origin,xb.projectId=t.projectId,xb.isPreview=t.isPreview,xb.isEkoApp=e.environment&&e.environment.isEkoApp,xb.linkoutNextUp=t.linkoutNextUp;for(let e in Kx)!1===["connect"].includes(e)&&this.expose({[e]:Kx[e]});"uitools"in e.player||(e.player.uitools={TweenMax:window.TweenMax}),function(){let e=document.createElement("div");e.setAttribute("id","uiPluginContainer"),e.setAttribute("style","width: 100%; height: 100%;"),xb.player.overlays.add(e.id,e,{pointerEvents:!1,scaling:!1,boxing:!1,includeInCheckpoints:!1}),mx[hx]={componentClass:Cb.Root,props:{config:{children:[]}},options:{scope:"project"}},jg.render(Ig.createElement(lx,{guiId:hx,store:xb.store}),e)}()},dispose:function(){this._super(),this.removePlayerListeners()}}))({UI:t});return e.player[kb.name]=e.utils.extend(e.player[kb.name]||{},n.exports),n}),kb.options):console&&console.error&&console.error("Could not register ui plugin");var Jx,eS,tS="undefined"!=typeof Symbol,nS="undefined"!=typeof Map,iS="undefined"!=typeof Set,rS=tS?Symbol("immer-nothing"):((Zx={})["immer-nothing"]=!0,Zx),oS=tS?Symbol("immer-draftable"):"__$immer_draftable",sS=tS?Symbol("immer-state"):"__$immer_state",aS=tS?Symbol.iterator:"@@iterator",lS=function(e,t){return lS=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},lS(e,t)};function cS(e,t){function n(){this.constructor=e}lS(e,t),e.prototype=(n.prototype=t.prototype,new n)}function uS(e){return!!e&&!!e[sS]}function dS(e){return!!e&&(function(e){if(!e||"object"!=typeof e)return!1;var t=Object.getPrototypeOf(e);return!t||t===Object.prototype}(e)||Array.isArray(e)||!!e[oS]||!!e.constructor[oS]||vS(e)||bS(e))}!function(e){e[e.Object=0]="Object",e[e.Array=1]="Array",e[e.Map=2]="Map",e[e.Set=3]="Set"}(Jx||(Jx={})),function(e){e[e.ProxyObject=0]="ProxyObject",e[e.ProxyArray=1]="ProxyArray",e[e.ES5Object=2]="ES5Object",e[e.ES5Array=3]="ES5Array",e[e.Map=4]="Map",e[e.Set=5]="Set"}(eS||(eS={}));var hS="undefined"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames;function pS(e,t){fS(e)===Jx.Object?hS(e).forEach((function(n){return t(n,e[n],e)})):e.forEach((function(n,i){return t(i,n,e)}))}function fS(e){if(e||CS(),e[sS])switch(e[sS].type){case eS.ES5Object:case eS.ProxyObject:return Jx.Object;case eS.ES5Array:case eS.ProxyArray:return Jx.Array;case eS.Map:return Jx.Map;case eS.Set:return Jx.Set}return Array.isArray(e)?Jx.Array:vS(e)?Jx.Map:bS(e)?Jx.Set:Jx.Object}function gS(e,t){return fS(e)===Jx.Map?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function mS(e,t){return fS(e)===Jx.Map?e.get(t):e[t]}function yS(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}function vS(e){return nS&&e instanceof Map}function bS(e){return iS&&e instanceof Set}function wS(e){return e.copy||e.base}function kS(e,t){if(void 0===t&&(t=!1),Array.isArray(e))return e.slice();var n=Object.create(Object.getPrototypeOf(e));return hS(e).forEach((function(i){if(i!==sS){var r=Object.getOwnPropertyDescriptor(e,i),o=r.value;if(r.get){if(!t)throw new Error("Immer drafts cannot have computed properties");o=r.get.call(e)}r.enumerable?n[i]=o:Object.defineProperty(n,i,{value:o,writable:!0,configurable:!0})}})),n}function xS(e,t){if(dS(e)&&!uS(e)&&!Object.isFrozen(e)){var n=fS(e);n===Jx.Set?e.add=e.clear=e.delete=SS:n===Jx.Map&&(e.set=e.clear=e.delete=SS),Object.freeze(e),t&&pS(e,(function(e,t){return xS(t,!0)}))}}function SS(){throw new Error("This object has been frozen and should not be mutated")}function CS(){throw new Error("Illegal state, please file a bug")}var _S=function(){function e(e,t){this.drafts=[],this.parent=e,this.immer=t,this.canAutoFreeze=!0}return e.prototype.usePatches=function(e){e&&(this.patches=[],this.inversePatches=[],this.patchListener=e)},e.prototype.revoke=function(){this.leave(),this.drafts.forEach(ES),this.drafts=null},e.prototype.leave=function(){this===e.current&&(e.current=this.parent)},e.enter=function(t){var n=new e(e.current,t);return e.current=n,n},e}();function ES(e){var t=e[sS];t.type===eS.ProxyObject||t.type===eS.ProxyArray?t.revoke():t.revoked=!0}function TS(e,t,n){var i=n.drafts[0],r=void 0!==t&&t!==i;if(e.willFinalize(n,t,r),r){if(i[sS].modified)throw n.revoke(),new Error("An immer producer returned a new value *and* modified its draft. Either return a new value *or* modify the draft.");dS(t)&&(t=PS(e,t,n),n.parent||OS(e,t)),n.patches&&(n.patches.push({op:"replace",path:[],value:t}),n.inversePatches.push({op:"replace",path:[],value:i[sS].base}))}else t=PS(e,i,n,[]);return n.revoke(),n.patches&&n.patchListener(n.patches,n.inversePatches),t!==rS?t:void 0}function PS(e,t,n,i){var r=t[sS];if(!r)return Object.isFrozen(t)?t:IS(e,t,n);if(r.scope!==n)return t;if(!r.modified)return OS(e,r.base,!0),r.base;if(!r.finalized){if(r.finalized=!0,IS(e,r.draft,n,i),e.onDelete&&r.type!==eS.Set)if(e.useProxies)pS(r.assigned,(function(t,n){n||e.onDelete(r,t)}));else{var o=r.copy;pS(r.base,(function(t){gS(o,t)||e.onDelete(r,t)}))}e.onCopy&&e.onCopy(r),e.autoFreeze&&n.canAutoFreeze&&xS(r.copy,!1),i&&n.patches&&function(e,t,n,i){switch(e.type){case eS.ProxyObject:case eS.ES5Object:case eS.Map:return function(e,t,n,i){var r=e.base,o=e.copy;pS(e.assigned,(function(e,s){var a=mS(r,e),l=mS(o,e),c=s?gS(r,e)?"replace":"add":"remove";if(a!==l||"replace"!==c){var u=t.concat(e);n.push("remove"===c?{op:c,path:u}:{op:c,path:u,value:l}),i.push("add"===c?{op:"remove",path:u}:"remove"===c?{op:"add",path:u,value:a}:{op:"replace",path:u,value:a})}}))}(e,t,n,i);case eS.ES5Array:case eS.ProxyArray:return function(e,t,n,i){var r,o,s=e.base,a=e.assigned,l=e.copy;l||CS(),l.length<s.length&&(s=(r=[l,s])[0],l=r[1],n=(o=[i,n])[0],i=o[1]);for(var c=l.length-s.length,u=0;s[u]===l[u]&&u<s.length;)++u;for(var d=s.length;d>u&&s[d-1]===l[d+c-1];)--d;for(var h=u;h<d;++h)if(a[h]&&l[h]!==s[h]){var p=t.concat([h]);n.push({op:"replace",path:p,value:l[h]}),i.push({op:"replace",path:p,value:s[h]})}var f=n.length;for(h=d+c-1;h>=d;--h)p=t.concat([h]),n[f+h-d]={op:"add",path:p,value:l[h]},i.push({op:"remove",path:p})}(e,t,n,i);case eS.Set:!function(e,t,n,i){var r=e.base,o=e.copy,s=0;r.forEach((function(e){if(!o.has(e)){var r=t.concat([s]);n.push({op:"remove",path:r,value:e}),i.unshift({op:"add",path:r,value:e})}s++})),s=0,o.forEach((function(e){if(!r.has(e)){var o=t.concat([s]);n.push({op:"add",path:o,value:e}),i.unshift({op:"remove",path:o,value:e})}s++}))}(e,t,n,i)}}(r,i,n.patches,n.inversePatches)}return r.copy}function IS(e,t,n,i){var r=t[sS];return r&&(r.type!==eS.ES5Object&&r.type!==eS.ES5Array||(r.copy=kS(r.draft,!0)),t=r.copy),pS(t,(function(o,s){return AS(e,n,t,r,t,o,s,i)})),t}function AS(e,t,n,i,r,o,s,a){if(s===r)throw Error("Immer forbids circular references");var l=!!i&&r===n,c=bS(r);if(uS(s)){var u=a&&l&&!c&&!gS(i.assigned,o)?a.concat(o):void 0;(function(e,t,n){switch(fS(e)){case Jx.Map:e.set(t,n);break;case Jx.Set:e.delete(t),e.add(n);break;default:e[t]=n}})(r,o,s=PS(e,s,t,u)),uS(s)&&(t.canAutoFreeze=!1)}else{if(l&&yS(s,mS(i.base,o)))return;dS(s)&&(pS(s,(function(r,o){return AS(e,t,n,i,s,r,o,a)})),t.parent||OS(e,s))}l&&e.onAssign&&!c&&e.onAssign(i,o,s)}function OS(e,t,n){void 0===n&&(n=!1),e.autoFreeze&&!uS(t)&&xS(t,n)}var LS={get:function(e,t){if(t===sS)return e;var n=e.drafts;if(!e.modified&&gS(n,t))return n[t];var i=wS(e)[t];if(e.finalized||!dS(i))return i;if(e.modified){if(i!==RS(e.base,t))return i;n=e.copy}return n[t]=e.scope.immer.createProxy(i,e)},has:function(e,t){return t in wS(e)},ownKeys:function(e){return Reflect.ownKeys(wS(e))},set:function(e,t,n){if(!e.modified){var i=RS(e.base,t);if(n?yS(i,n)||n===e.drafts[t]:yS(i,n)&&t in e.base)return!0;MS(e),DS(e)}return e.assigned[t]=!0,e.copy[t]=n,!0},deleteProperty:function(e,t){return void 0!==RS(e.base,t)||t in e.base?(e.assigned[t]=!1,MS(e),DS(e)):e.assigned[t]&&delete e.assigned[t],e.copy&&delete e.copy[t],!0},getOwnPropertyDescriptor:function(e,t){var n=wS(e),i=Reflect.getOwnPropertyDescriptor(n,t);return i&&(i.writable=!0,i.configurable=e.type!==eS.ProxyArray||"length"!==t),i},defineProperty:function(){throw new Error("Object.defineProperty() cannot be used on an Immer draft")},getPrototypeOf:function(e){return Object.getPrototypeOf(e.base)},setPrototypeOf:function(){throw new Error("Object.setPrototypeOf() cannot be used on an Immer draft")}},NS={};function RS(e,t){var n=e[sS],i=Reflect.getOwnPropertyDescriptor(n?wS(n):e,t);return i&&i.value}function DS(e){if(!e.modified){if(e.modified=!0,e.type===eS.ProxyObject||e.type===eS.ProxyArray){var t=e.copy=kS(e.base);pS(e.drafts,(function(e,n){t[e]=n})),e.drafts=void 0}e.parent&&DS(e.parent)}}function MS(e){e.copy||(e.copy=kS(e.base))}function FS(e,t,n){e.drafts.forEach((function(e){e[sS].finalizing=!0})),n?uS(t)&&t[sS].scope===e&&HS(e.drafts):(e.patches&&$S(e.drafts[0]),HS(e.drafts))}function BS(e,t){var n=e[sS];if(n&&!n.finalizing){n.finalizing=!0;var i=e[t];return n.finalizing=!1,i}return e[t]}function US(e){e.modified||(e.modified=!0,e.parent&&US(e.parent))}function jS(e){e.copy||(e.copy=zS(e.base))}function zS(e){var t=e&&e[sS];if(t){t.finalizing=!0;var n=kS(t.draft,!0);return t.finalizing=!1,n}return kS(e)}pS(LS,(function(e,t){NS[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}})),NS.deleteProperty=function(e,t){if(isNaN(parseInt(t)))throw new Error("Immer only supports deleting array indices");return LS.deleteProperty.call(this,e[0],t)},NS.set=function(e,t,n){if("length"!==t&&isNaN(parseInt(t)))throw new Error("Immer only supports setting array indices and the 'length' property");return LS.set.call(this,e[0],t,n,e[0])};var VS={};function WS(e){if(!0===e.revoked)throw new Error("Cannot use a proxy that has been revoked. Did you pass an object from inside an immer function to an async process? "+JSON.stringify(wS(e)))}function HS(e){for(var t=e.length-1;t>=0;t--){var n=e[t][sS];if(!n.modified)switch(n.type){case eS.ES5Array:qS(n)&&US(n);break;case eS.ES5Object:GS(n)&&US(n)}}}function $S(e){if(e&&"object"==typeof e){var t=e[sS];if(t){var n=t.base,i=t.draft,r=t.assigned,o=t.type;if(o===eS.ES5Object)pS(i,(function(e){e!==sS&&(void 0!==n[e]||gS(n,e)?r[e]||$S(i[e]):(r[e]=!0,US(t)))})),pS(n,(function(e){void 0!==i[e]||gS(i,e)||(r[e]=!1,US(t))}));else if(o===eS.ES5Array){if(qS(t)&&(US(t),r.length=!0),i.length<n.length)for(var s=i.length;s<n.length;s++)r[s]=!1;else for(s=n.length;s<i.length;s++)r[s]=!0;var a=Math.min(i.length,n.length);for(s=0;s<a;s++)void 0===r[s]&&$S(i[s])}}}}function GS(e){for(var t=e.base,n=e.draft,i=Object.keys(n),r=i.length-1;r>=0;r--){var o=i[r],s=t[o];if(void 0===s&&!gS(t,o))return!0;var a=n[o],l=a&&a[sS];if(l?l.base!==s:!yS(a,s))return!0}return i.length!==Object.keys(t).length}function qS(e){var t=e.draft;if(t.length!==e.base.length)return!0;var n=Object.getOwnPropertyDescriptor(t,t.length-1);return!(!n||n.get)}var YS=function(e){if(!e)throw new Error("Map is not polyfilled");function t(e,t){return this[sS]={type:eS.Map,parent:t,scope:t?t.scope:_S.current,modified:!1,finalized:!1,copy:void 0,assigned:void 0,base:e,draft:this,isManual:!1,revoked:!1},this}cS(t,e);var n=t.prototype;return Object.defineProperty(n,"size",{get:function(){return wS(this[sS]).size},enumerable:!0,configurable:!0}),n.has=function(e){return wS(this[sS]).has(e)},n.set=function(e,t){var n=this[sS];return WS(n),wS(n).get(e)!==t&&(KS(n),n.scope.immer.markChanged(n),n.assigned.set(e,!0),n.copy.set(e,t),n.assigned.set(e,!0)),this},n.delete=function(e){if(!this.has(e))return!1;var t=this[sS];return WS(t),KS(t),t.scope.immer.markChanged(t),t.assigned.set(e,!1),t.copy.delete(e),!0},n.clear=function(){var e=this[sS];return WS(e),KS(e),e.scope.immer.markChanged(e),e.assigned=new Map,e.copy.clear()},n.forEach=function(e,t){var n=this;wS(this[sS]).forEach((function(i,r,o){e.call(t,n.get(r),r,n)}))},n.get=function(e){var t=this[sS];WS(t);var n=wS(t).get(e);if(t.finalized||!dS(n))return n;if(n!==t.base.get(e))return n;var i=t.scope.immer.createProxy(n,t);return KS(t),t.copy.set(e,i),i},n.keys=function(){return wS(this[sS]).keys()},n.values=function(){var e,t=this,n=this.keys();return(e={})[aS]=function(){return t.values()},e.next=function(){var e=n.next();return e.done?e:{done:!1,value:t.get(e.value)}},e},n.entries=function(){var e,t=this,n=this.keys();return(e={})[aS]=function(){return t.entries()},e.next=function(){var e=n.next();if(e.done)return e;var i=t.get(e.value);return{done:!1,value:[e.value,i]}},e},n[aS]=function(){return this.entries()},t}(Map);function KS(e){e.copy||(e.assigned=new Map,e.copy=new Map(e.base))}var XS=function(e){if(!e)throw new Error("Set is not polyfilled");function t(e,t){return this[sS]={type:eS.Set,parent:t,scope:t?t.scope:_S.current,modified:!1,finalized:!1,copy:void 0,base:e,draft:this,drafts:new Map,revoked:!1,isManual:!1},this}cS(t,e);var n=t.prototype;return Object.defineProperty(n,"size",{get:function(){return wS(this[sS]).size},enumerable:!0,configurable:!0}),n.has=function(e){var t=this[sS];return WS(t),t.copy?!!t.copy.has(e)||!(!t.drafts.has(e)||!t.copy.has(t.drafts.get(e))):t.base.has(e)},n.add=function(e){var t=this[sS];return WS(t),t.copy?t.copy.add(e):t.base.has(e)||(QS(t),t.scope.immer.markChanged(t),t.copy.add(e)),this},n.delete=function(e){if(!this.has(e))return!1;var t=this[sS];return WS(t),QS(t),t.scope.immer.markChanged(t),t.copy.delete(e)||!!t.drafts.has(e)&&t.copy.delete(t.drafts.get(e))},n.clear=function(){var e=this[sS];return WS(e),QS(e),e.scope.immer.markChanged(e),e.copy.clear()},n.values=function(){var e=this[sS];return WS(e),QS(e),e.copy.values()},n.entries=function(){var e=this[sS];return WS(e),QS(e),e.copy.entries()},n.keys=function(){return this.values()},n[aS]=function(){return this.values()},n.forEach=function(e,t){for(var n=this.values(),i=n.next();!i.done;)e.call(t,i.value,i.value,this),i=n.next()},t}(Set);function QS(e){e.copy||(e.copy=new Set,e.base.forEach((function(t){if(dS(t)){var n=e.scope.immer.createProxy(t,e);e.drafts.set(t,n),e.copy.add(n)}else e.copy.add(t)})))}function ZS(e,t){return t.forEach((function(t){var n=t.path,i=t.op;n.length||CS();for(var r=e,o=0;o<n.length-1;o++)if(!(r=mS(r,n[o]))||"object"!=typeof r)throw new Error("Cannot apply patch, path doesn't resolve: "+n.join("/"));var s=fS(r),a=JS(t.value),l=n[n.length-1];switch(i){case"replace":switch(s){case Jx.Map:return r.set(l,a);case Jx.Set:throw new Error('Sets cannot have "replace" patches.');default:return r[l]=a}case"add":switch(s){case Jx.Array:return r.splice(l,0,a);case Jx.Map:return r.set(l,a);case Jx.Set:return r.add(a);default:return r[l]=a}case"remove":switch(s){case Jx.Array:return r.splice(l,1);case Jx.Map:return r.delete(l);case Jx.Set:return r.delete(t.value);default:return delete r[l]}default:throw new Error("Unsupported patch operation: "+i)}})),e}function JS(e){if(!e||"object"!=typeof e)return e;if(Array.isArray(e))return e.map(JS);if(vS(e))return new Map(Array.from(e.entries()).map((function(e){return[e[0],JS(e[1])]})));if(bS(e))return new Set(Array.from(e).map(JS));var t=Object.create(Object.getPrototypeOf(e));for(var n in e)t[n]=JS(e[n]);return t}function eC(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var i=Array(e),r=0;for(t=0;t<n;t++)for(var o=arguments[t],s=0,a=o.length;s<a;s++,r++)i[r]=o[s];return i}var tC={useProxies:"undefined"!=typeof Proxy&&void 0!==Proxy.revocable&&"undefined"!=typeof Reflect,autoFreeze:void 0===ut&&"verifyMinified"===function(){}.name,onAssign:null,onDelete:null,onCopy:null},nC=function(){function e(e){var t=this;this.useProxies=!1,this.autoFreeze=!1,pS(tC,(function(n,i){var r,o;t[n]=null!=(o=null===(r=e)||void 0===r?void 0:r[n])?o:i})),this.setUseProxies(this.useProxies),this.produce=this.produce.bind(this),this.produceWithPatches=this.produceWithPatches.bind(this)}return e.prototype.produce=function(e,t,n){var i,r=this;if("function"==typeof e&&"function"!=typeof t){var o=t;t=e;var s=this;return function(e){var n=arguments,i=this;void 0===e&&(e=o);for(var r=[],a=1;a<arguments.length;a++)r[a-1]=n[a];return s.produce(e,(function(e){return t.call.apply(t,eC([i,e],r))}))}}if("function"!=typeof t)throw new Error("The first or second argument to `produce` must be a function");if(void 0!==n&&"function"!=typeof n)throw new Error("The third argument to `produce` must be a function or undefined");if(dS(e)){var a=_S.enter(this),l=this.createProxy(e,void 0),c=!0;try{i=t(l),c=!1}finally{c?a.revoke():a.leave()}return"undefined"!=typeof Promise&&i instanceof Promise?i.then((function(e){return a.usePatches(n),TS(r,e,a)}),(function(e){throw a.revoke(),e})):(a.usePatches(n),TS(this,i,a))}if((i=t(e))!==rS)return void 0===i&&(i=e),OS(this,i,!0),i},e.prototype.produceWithPatches=function(e,t,n){var i,r,o=this;return"function"==typeof e?function(t){for(var n=arguments,i=[],r=1;r<arguments.length;r++)i[r-1]=n[r];return o.produceWithPatches(t,(function(t){return e.apply(void 0,eC([t],i))}))}:(n&&CS(),[this.produce(e,t,(function(e,t){i=e,r=t})),i,r])},e.prototype.createDraft=function(e){if(!dS(e))throw new Error("First argument to `createDraft` must be a plain object, an array, or an immerable object");var t=_S.enter(this),n=this.createProxy(e,void 0);return n[sS].isManual=!0,t.leave(),n},e.prototype.finishDraft=function(e,t){var n=e&&e[sS];if(!n||!n.isManual)throw new Error("First argument to `finishDraft` must be a draft returned by `createDraft`");if(n.finalized)throw new Error("The given draft is already finalized");var i=n.scope;return i.usePatches(t),TS(this,void 0,i)},e.prototype.setAutoFreeze=function(e){this.autoFreeze=e},e.prototype.setUseProxies=function(e){this.useProxies=e},e.prototype.applyPatches=function(e,t){var n;for(n=t.length-1;n>=0;n--){var i=t[n];if(0===i.path.length&&"replace"===i.op){e=i.value;break}}return uS(e)?ZS(e,t):this.produce(e,(function(e){return ZS(e,t.slice(n+1))}))},e.prototype.createProxy=function(e,t){var n=vS(e)?function(e,t){return new YS(e,t)}(e,t):bS(e)?function(e,t){return new XS(e,t)}(e,t):this.useProxies?function(e,t){var n=Array.isArray(e),i={type:n?eS.ProxyArray:eS.ProxyObject,scope:t?t.scope:_S.current,modified:!1,finalized:!1,assigned:{},parent:t,base:e,draft:null,drafts:{},copy:null,revoke:null,isManual:!1},r=i,o=LS;n&&(r=[i],o=NS);var s=Proxy.revocable(r,o),a=s.revoke,l=s.proxy;return i.draft=l,i.revoke=a,l}(e,t):function(e,t){var n=Array.isArray(e),i=zS(e);return pS(i,(function(t){!function(e,t,n){var i=VS[t];i?i.enumerable=n:VS[t]=i={configurable:!0,enumerable:n,get:function(){return function(e,t){WS(e);var n=BS(wS(e),t);return e.finalizing?n:n===BS(e.base,t)&&dS(n)?(jS(e),e.copy[t]=e.scope.immer.createProxy(n,e)):n}(this[sS],t)},set:function(e){!function(e,t,n){if(WS(e),e.assigned[t]=!0,!e.modified){if(yS(n,BS(wS(e),t)))return;US(e),jS(e)}e.copy[t]=n}(this[sS],t,e)}},Object.defineProperty(e,t,i)}(i,t,n||function(e,t){var n=Object.getOwnPropertyDescriptor(e,t);return!(!n||!n.enumerable)}(e,t))})),Object.defineProperty(i,sS,{value:{type:n?eS.ES5Array:eS.ES5Object,scope:t?t.scope:_S.current,modified:!1,finalizing:!1,finalized:!1,assigned:{},parent:t,base:e,draft:i,copy:null,revoked:!1,isManual:!1},enumerable:!1,writable:!0}),i}(e,t);return(t?t.scope:_S.current).drafts.push(n),n},e.prototype.willFinalize=function(e,t,n){this.useProxies||FS(e,t,n)},e.prototype.markChanged=function(e){this.useProxies?DS(e):US(e)},e}(),iC=new nC,rC=iC.produce;let oC,sC,aC;iC.produceWithPatches.bind(iC),iC.setAutoFreeze.bind(iC),iC.setUseProxies.bind(iC),iC.applyPatches.bind(iC),iC.createDraft.bind(iC),iC.finishDraft.bind(iC);var lC=function(e){oC=e.pluginOptions,aC=e.ctx,sC=e.epicMiddleware},cC=function(){return oC},uC=function(){return aC},dC=function(){return sC};const hC=e=>function(t){t=t||(e=>e);let n=EC.isPlatformAddon(e);return uC().player.ui.useSelector((i=>t((t=>n?t.ekoshell[e]:t.ekoshell.addons[e])(i))))},pC=e=>t=>uC().player.reduxStore.dispatch(gC(t,e)),fC=(e,t)=>`EKOSHELL_${t.toUpperCase()}_${e}`,gC=(e,t)=>({...e,addonId:t,addonType:e.type,type:fC(e.type,t)}),mC=new nw,yC=["EkoshellRoot","ClickCatcher","ControlsOverlay","SeekIndication","WaitingIndication","EkoLogo","ProjectMetaData","ShareScreen","VolumeButton","FullscreenButton","SubtitlesButton","SubtitlesContextMenu","ShareButton","UnmuteNotification"];let vC={},bC={},wC={};function kC(e){return vC[e]||bC[e]}function xC(e){let t={player:uC().player,addonId:e,useAddonSelector:hC(e),dispatchAddon:pC(e),getActionTypeName:t=>fC(t,e)};return CC(e)&&(t.pluginOptions=cC()),t}function SC(e,t){let n,i=kC(e),r=kC(t);return n="order"in i&&"order"in r?i.order<r.order?-1:i.order>r.order?1:0:!1 in i&&"order"in r?1:!1 in r&&"order"in i?-1:0,n}const CC=e=>yC.includes(e),_C=(e,t)=>mC.addListener(e,t);_C("addonAdded",(e=>uC().player.reduxStore.dispatch({type:"EKOSHELL_ADDON_ADDED",addonId:e.addonId})));var EC={add:function(e,t){let n=uC().player,i=cC(),r=i&&i.addons;if(r&&!1===r[e.toLowerCase()])return!1;if(e in vC)console.warn(`Ekoshell - insertAddon: an addon with the ${e} already exists. Addon will not be added`);else{let i=CC(e),o=function(e,t,n){let i={...t};if("parentContainer"in i==0&&(i.parentContainer="root"),n){let t=n[e.toLowerCase()];t&&(void 0!==t.order&&(i.order=t.order),void 0!==t.parentContainer&&(i.parentContainer=t.parentContainer))}return i.props="props"in t==0||null===t.props?{}:"function"==typeof t.props?t.props(xC(e)):t.props,t.api&&("function"==typeof t.api?(i.api=t.api(xC(e)),null==i.api&&console.warn(`Ekoshell: Addon "${e}"'s api returned null. Perhaps you forgot to return something from the API generator function?`)):i.api=t.api),i}(e,t,r),s=o.parentContainer;if(i?bC[e]=o:vC[e]=o,i&&o.uiScope?n.ui.add(e,o.component,null,{scope:o.uiScope}):function(e,t){t in wC==0&&(wC[t]=new Set),wC[t].add(e)}(e,s),o.api&&(i?n.ekoshell[e]=o.api:n.ekoshell.addons[e]=o.api),o.init&&"function"==typeof o.init&&o.init(xC(e)),i&&o.epic){let t=dC(),n=o.epic(xC(e));t.run(n)}if(o.events){let e=o.events;Object.keys(e).forEach((t=>{n.tracker&&n.tracker.addEventForwarder(e[t])}))}mC.emit("addonAdded",{addonId:e,addonMetaObject:o,containerId:s})}},get:function(e){return vC[e]},getPlatformAddon:function(e){return bC[e]},getDisplayedAddon:kC,getAll:function(){return vC},getContainerChildren:function(e){let t=Array.from(wC[e]||[]);return t.sort(SC),t},isPlatformAddon:CC,on:_C,off:(e,t)=>mC.removeListener(e,t),updateAddOnLocation:function(e,t){let n=kC(e);if(n.parentContainer)if(n.parentContainer in wC){let t=n.parentContainer,i=wC[t];n.parentContainer=null,i.delete(e),mC.emit("addonRemoved",{addonId:e,addonMetaObject:n,containerId:t})}else console.warn(`Attempting to remove add-on ${e} from parent container ${n.parentContainer} that does not exist.`);t&&(t in wC==0&&(wC[t]=new Set),n.parentContainer=t,wC[t].add(e),mC.emit("addonAdded",{addonId:e,addonMetaObject:n,containerId:t}))}};const TC=rC(((e,t)=>{if(void 0===e)return{addons:{}};if(t.addonId){let n=t.addonId,i=EC.get(n),r=EC.getPlatformAddon(n),o={...t,type:t.addonType};delete o.addonId,delete o.addonType,r&&r.reducer&&(e[n]=r.reducer(e[n],o)),i&&i.reducer&&(e.addons[n]=i.reducer(e.addons[n],o))}}));var PC=function(e,t){return PC=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},PC(e,t)};function IC(e,t){function n(){this.constructor=e}PC(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function AC(e){return"function"==typeof e}var OC=!1,LC={set useDeprecatedSynchronousErrorHandling(e){OC=e},get useDeprecatedSynchronousErrorHandling(){return OC}};function NC(e){setTimeout((function(){throw e}),0)}var RC={closed:!0,next:function(e){},error:function(e){if(LC.useDeprecatedSynchronousErrorHandling)throw e;NC(e)},complete:function(){}},DC=function(){return Array.isArray||function(e){return e&&"number"==typeof e.length}}();function MC(e){return null!==e&&"object"==typeof e}var FC=function(){function e(e){return Error.call(this),this.message=e?e.length+" errors occurred during unsubscription:\n"+e.map((function(e,t){return t+1+") "+e.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=e,this}return e.prototype=Object.create(Error.prototype),e}(),BC=FC,UC=function(){function e(e){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,e&&(this._ctorUnsubscribe=!0,this._unsubscribe=e)}return e.prototype.unsubscribe=function(){var t;if(!this.closed){var n=this,i=n._parentOrParents,r=n._ctorUnsubscribe,o=n._unsubscribe,s=n._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,i instanceof e)i.remove(this);else if(null!==i)for(var a=0;a<i.length;++a)i[a].remove(this);if(AC(o)){r&&(this._unsubscribe=void 0);try{o.call(this)}catch(e){t=e instanceof BC?jC(e.errors):[e]}}if(DC(s)){a=-1;for(var l=s.length;++a<l;){var c=s[a];if(MC(c))try{c.unsubscribe()}catch(e){t=t||[],e instanceof BC?t=t.concat(jC(e.errors)):t.push(e)}}}if(t)throw new BC(t)}},e.prototype.add=function(t){var n=t;if(!t)return e.EMPTY;switch(typeof t){case"function":n=new e(t);case"object":if(n===this||n.closed||"function"!=typeof n.unsubscribe)return n;if(this.closed)return n.unsubscribe(),n;if(!(n instanceof e)){var i=n;(n=new e)._subscriptions=[i]}break;default:throw new Error("unrecognized teardown "+t+" added to Subscription.")}var r=n._parentOrParents;if(null===r)n._parentOrParents=this;else if(r instanceof e){if(r===this)return n;n._parentOrParents=[r,this]}else{if(-1!==r.indexOf(this))return n;r.push(this)}var o=this._subscriptions;return null===o?this._subscriptions=[n]:o.push(n),n},e.prototype.remove=function(e){var t=this._subscriptions;if(t){var n=t.indexOf(e);-1!==n&&t.splice(n,1)}},e.EMPTY=((t=new e).closed=!0,t),e;var t}();function jC(e){return e.reduce((function(e,t){return e.concat(t instanceof BC?t.errors:t)}),[])}var zC=function(){return"function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random()}(),VC=function(e){function t(n,i,r){var o=e.call(this)||this;switch(o.syncErrorValue=null,o.syncErrorThrown=!1,o.syncErrorThrowable=!1,o.isStopped=!1,arguments.length){case 0:o.destination=RC;break;case 1:if(!n){o.destination=RC;break}if("object"==typeof n){n instanceof t?(o.syncErrorThrowable=n.syncErrorThrowable,o.destination=n,n.add(o)):(o.syncErrorThrowable=!0,o.destination=new WC(o,n));break}default:o.syncErrorThrowable=!0,o.destination=new WC(o,n,i,r)}return o}return IC(t,e),t.prototype[zC]=function(){return this},t.create=function(e,n,i){var r=new t(e,n,i);return r.syncErrorThrowable=!1,r},t.prototype.next=function(e){this.isStopped||this._next(e)},t.prototype.error=function(e){this.isStopped||(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this))},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){this.destination.error(e),this.unsubscribe()},t.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},t.prototype._unsubscribeAndRecycle=function(){var e=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=e,this},t}(UC),WC=function(e){function t(t,n,i,r){var o,s=e.call(this)||this;s._parentSubscriber=t;var a=s;return AC(n)?o=n:n&&(o=n.next,i=n.error,r=n.complete,n!==RC&&(AC((a=Object.create(n)).unsubscribe)&&s.add(a.unsubscribe.bind(a)),a.unsubscribe=s.unsubscribe.bind(s))),s._context=a,s._next=o,s._error=i,s._complete=r,s}return IC(t,e),t.prototype.next=function(e){if(!this.isStopped&&this._next){var t=this._parentSubscriber;LC.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?this.__tryOrSetError(t,this._next,e)&&this.unsubscribe():this.__tryOrUnsub(this._next,e)}},t.prototype.error=function(e){if(!this.isStopped){var t=this._parentSubscriber,n=LC.useDeprecatedSynchronousErrorHandling;if(this._error)n&&t.syncErrorThrowable?(this.__tryOrSetError(t,this._error,e),this.unsubscribe()):(this.__tryOrUnsub(this._error,e),this.unsubscribe());else if(t.syncErrorThrowable)n?(t.syncErrorValue=e,t.syncErrorThrown=!0):NC(e),this.unsubscribe();else{if(this.unsubscribe(),n)throw e;NC(e)}}},t.prototype.complete=function(){var e=this;if(!this.isStopped){var t=this._parentSubscriber;if(this._complete){var n=function(){return e._complete.call(e._context)};LC.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?(this.__tryOrSetError(t,n),this.unsubscribe()):(this.__tryOrUnsub(n),this.unsubscribe())}else this.unsubscribe()}},t.prototype.__tryOrUnsub=function(e,t){try{e.call(this._context,t)}catch(e){if(this.unsubscribe(),LC.useDeprecatedSynchronousErrorHandling)throw e;NC(e)}},t.prototype.__tryOrSetError=function(e,t,n){if(!LC.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{t.call(this._context,n)}catch(t){return LC.useDeprecatedSynchronousErrorHandling?(e.syncErrorValue=t,e.syncErrorThrown=!0,!0):(NC(t),!0)}return!1},t.prototype._unsubscribe=function(){var e=this._parentSubscriber;this._context=null,this._parentSubscriber=null,e.unsubscribe()},t}(VC),HC=function(){return"function"==typeof Symbol&&Symbol.observable||"@@observable"}();function $C(e){return e}var GC=function(){function e(e){this._isScalar=!1,e&&(this._subscribe=e)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(e,t,n){var i=this.operator,r=function(e,t,n){if(e){if(e instanceof VC)return e;if(e[zC])return e[zC]()}return e||t||n?new VC(e,t,n):new VC(RC)}(e,t,n);if(r.add(i?i.call(r,this.source):this.source||LC.useDeprecatedSynchronousErrorHandling&&!r.syncErrorThrowable?this._subscribe(r):this._trySubscribe(r)),LC.useDeprecatedSynchronousErrorHandling&&r.syncErrorThrowable&&(r.syncErrorThrowable=!1,r.syncErrorThrown))throw r.syncErrorValue;return r},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){LC.useDeprecatedSynchronousErrorHandling&&(e.syncErrorThrown=!0,e.syncErrorValue=t),function(e){for(;e;){var t=e.destination;if(e.closed||e.isStopped)return!1;e=t&&t instanceof VC?t:null}return!0}(e)?e.error(t):console.warn(t)}},e.prototype.forEach=function(e,t){var n=this;return new(t=qC(t))((function(t,i){var r;r=n.subscribe((function(t){try{e(t)}catch(e){i(e),r&&r.unsubscribe()}}),i,t)}))},e.prototype._subscribe=function(e){var t=this.source;return t&&t.subscribe(e)},e.prototype[HC]=function(){return this},e.prototype.pipe=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return 0===t.length?this:(0===(e=t).length?$C:1===e.length?e[0]:function(t){return e.reduce((function(e,t){return t(e)}),t)})(this)},e.prototype.toPromise=function(e){var t=this;return new(e=qC(e))((function(e,n){var i;t.subscribe((function(e){return i=e}),(function(e){return n(e)}),(function(){return e(i)}))}))},e.create=function(t){return new e(t)},e}();function qC(e){if(e||(e=Promise),!e)throw new Error("no Promise impl found");return e}var YC=function(){function e(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return e.prototype=Object.create(Error.prototype),e}(),KC=function(e){function t(t,n){var i=e.call(this)||this;return i.subject=t,i.subscriber=n,i.closed=!1,i}return IC(t,e),t.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var e=this.subject,t=e.observers;if(this.subject=null,t&&0!==t.length&&!e.isStopped&&!e.closed){var n=t.indexOf(this.subscriber);-1!==n&&t.splice(n,1)}}},t}(UC),XC=function(e){function t(t){var n=e.call(this,t)||this;return n.destination=t,n}return IC(t,e),t}(VC),QC=function(e){function t(){var t=e.call(this)||this;return t.observers=[],t.closed=!1,t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return IC(t,e),t.prototype[zC]=function(){return new XC(this)},t.prototype.lift=function(e){var t=new ZC(this,this);return t.operator=e,t},t.prototype.next=function(e){if(this.closed)throw new YC;if(!this.isStopped)for(var t=this.observers,n=t.length,i=t.slice(),r=0;r<n;r++)i[r].next(e)},t.prototype.error=function(e){if(this.closed)throw new YC;this.hasError=!0,this.thrownError=e,this.isStopped=!0;for(var t=this.observers,n=t.length,i=t.slice(),r=0;r<n;r++)i[r].error(e);this.observers.length=0},t.prototype.complete=function(){if(this.closed)throw new YC;this.isStopped=!0;for(var e=this.observers,t=e.length,n=e.slice(),i=0;i<t;i++)n[i].complete();this.observers.length=0},t.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},t.prototype._trySubscribe=function(t){if(this.closed)throw new YC;return e.prototype._trySubscribe.call(this,t)},t.prototype._subscribe=function(e){if(this.closed)throw new YC;return this.hasError?(e.error(this.thrownError),UC.EMPTY):this.isStopped?(e.complete(),UC.EMPTY):(this.observers.push(e),new KC(this,e))},t.prototype.asObservable=function(){var e=new GC;return e.source=this,e},t.create=function(e,t){return new ZC(e,t)},t}(GC),ZC=function(e){function t(t,n){var i=e.call(this)||this;return i.destination=t,i.source=n,i}return IC(t,e),t.prototype.next=function(e){var t=this.destination;t&&t.next&&t.next(e)},t.prototype.error=function(e){var t=this.destination;t&&t.error&&this.destination.error(e)},t.prototype.complete=function(){var e=this.destination;e&&e.complete&&this.destination.complete()},t.prototype._subscribe=function(e){return this.source?this.source.subscribe(e):UC.EMPTY},t}(QC),JC=function(e){function t(t,n){var i=e.call(this,t,n)||this;return i.scheduler=t,i.work=n,i.pending=!1,i}return IC(t,e),t.prototype.schedule=function(e,t){if(void 0===t&&(t=0),this.closed)return this;this.state=e;var n=this.id,i=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(i,n,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(i,this.id,t),this},t.prototype.requestAsyncId=function(e,t,n){return void 0===n&&(n=0),setInterval(e.flush.bind(e,this),n)},t.prototype.recycleAsyncId=function(e,t,n){if(void 0===n&&(n=0),null!==n&&this.delay===n&&!1===this.pending)return t;clearInterval(t)},t.prototype.execute=function(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},t.prototype._execute=function(e,t){var n=!1,i=void 0;try{this.work(e)}catch(e){n=!0,i=!!e&&e||new Error(e)}if(n)return this.unsubscribe(),i},t.prototype._unsubscribe=function(){var e=this.id,t=this.scheduler,n=t.actions,i=n.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==i&&n.splice(i,1),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null},t}(function(e){function t(t,n){return e.call(this)||this}return IC(t,e),t.prototype.schedule=function(e,t){return this},t}(UC)),e_=function(e){function t(t,n){var i=e.call(this,t,n)||this;return i.scheduler=t,i.work=n,i}return IC(t,e),t.prototype.schedule=function(t,n){return void 0===n&&(n=0),n>0?e.prototype.schedule.call(this,t,n):(this.delay=n,this.state=t,this.scheduler.flush(this),this)},t.prototype.execute=function(t,n){return n>0||this.closed?e.prototype.execute.call(this,t,n):this._execute(t,n)},t.prototype.requestAsyncId=function(t,n,i){return void 0===i&&(i=0),null!==i&&i>0||null===i&&this.delay>0?e.prototype.requestAsyncId.call(this,t,n,i):t.flush(this)},t}(JC),t_=function(){function e(t,n){void 0===n&&(n=e.now),this.SchedulerAction=t,this.now=n}return e.prototype.schedule=function(e,t,n){return void 0===t&&(t=0),new this.SchedulerAction(this,e).schedule(n,t)},e.now=function(){return Date.now()},e}(),n_=function(e){function t(n,i){void 0===i&&(i=t_.now);var r=e.call(this,n,(function(){return t.delegate&&t.delegate!==r?t.delegate.now():i()}))||this;return r.actions=[],r.active=!1,r.scheduled=void 0,r}return IC(t,e),t.prototype.schedule=function(n,i,r){return void 0===i&&(i=0),t.delegate&&t.delegate!==this?t.delegate.schedule(n,i,r):e.prototype.schedule.call(this,n,i,r)},t.prototype.flush=function(e){var t=this.actions;if(this.active)t.push(e);else{var n;this.active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this.active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}},t}(t_),i_=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return IC(t,e),t}(n_))(e_),r_=new GC((function(e){return e.complete()}));function o_(e){return e&&"function"==typeof e.schedule}var s_=function(e){return function(t){for(var n=0,i=e.length;n<i&&!t.closed;n++)t.next(e[n]);t.complete()}};function a_(e,t){return new GC((function(n){var i=new UC,r=0;return i.add(t.schedule((function(){r!==e.length?(n.next(e[r++]),n.closed||i.add(this.schedule())):n.complete()}))),i}))}function l_(e,t){return t?a_(e,t):new GC(s_(e))}function c_(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=e[e.length-1];return o_(n)?(e.pop(),a_(e,n)):l_(e)}var u_=function(){function e(e,t,n){this.kind=e,this.value=t,this.error=n,this.hasValue="N"===e}return e.prototype.observe=function(e){switch(this.kind){case"N":return e.next&&e.next(this.value);case"E":return e.error&&e.error(this.error);case"C":return e.complete&&e.complete()}},e.prototype.do=function(e,t,n){switch(this.kind){case"N":return e&&e(this.value);case"E":return t&&t(this.error);case"C":return n&&n()}},e.prototype.accept=function(e,t,n){return e&&"function"==typeof e.next?this.observe(e):this.do(e,t,n)},e.prototype.toObservable=function(){switch(this.kind){case"N":return c_(this.value);case"E":return function(e,t){return new GC((function(t){return t.error(e)}))}(this.error);case"C":return r_}throw new Error("unexpected notification kind value")},e.createNext=function(t){return void 0!==t?new e("N",t):e.undefinedValueNotification},e.createError=function(t){return new e("E",void 0,t)},e.createComplete=function(){return e.completeNotification},e.completeNotification=new e("C"),e.undefinedValueNotification=new e("N",void 0),e}();function d_(e,t){return void 0===t&&(t=0),function(n){return n.lift(new h_(e,t))}}var h_=function(){function e(e,t){void 0===t&&(t=0),this.scheduler=e,this.delay=t}return e.prototype.call=function(e,t){return t.subscribe(new p_(e,this.scheduler,this.delay))},e}(),p_=function(e){function t(t,n,i){void 0===i&&(i=0);var r=e.call(this,t)||this;return r.scheduler=n,r.delay=i,r}return IC(t,e),t.dispatch=function(e){e.notification.observe(e.destination),this.unsubscribe()},t.prototype.scheduleMessage=function(e){this.destination.add(this.scheduler.schedule(t.dispatch,this.delay,new f_(e,this.destination)))},t.prototype._next=function(e){this.scheduleMessage(u_.createNext(e))},t.prototype._error=function(e){this.scheduleMessage(u_.createError(e)),this.unsubscribe()},t.prototype._complete=function(){this.scheduleMessage(u_.createComplete()),this.unsubscribe()},t}(VC),f_=function(){return function(e,t){this.notification=e,this.destination=t}}(),g_=1,m_=function(){return Promise.resolve()}(),y_={};function v_(e){return e in y_&&(delete y_[e],!0)}var b_=function(e){function t(t,n){var i=e.call(this,t,n)||this;return i.scheduler=t,i.work=n,i}return IC(t,e),t.prototype.requestAsyncId=function(t,n,i){return void 0===i&&(i=0),null!==i&&i>0?e.prototype.requestAsyncId.call(this,t,n,i):(t.actions.push(this),t.scheduled||(t.scheduled=(r=t.flush.bind(t,null),o=g_++,y_[o]=!0,m_.then((function(){return v_(o)&&r()})),o)));var r,o},t.prototype.recycleAsyncId=function(t,n,i){if(void 0===i&&(i=0),null!==i&&i>0||null===i&&this.delay>0)return e.prototype.recycleAsyncId.call(this,t,n,i);0===t.actions.length&&(v_(n),t.scheduled=void 0)},t}(JC),w_=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return IC(t,e),t.prototype.flush=function(e){this.active=!0,this.scheduled=void 0;var t,n=this.actions,i=-1,r=n.length;e=e||n.shift();do{if(t=e.execute(e.state,e.delay))break}while(++i<r&&(e=n.shift()));if(this.active=!1,t){for(;++i<r&&(e=n.shift());)e.unsubscribe();throw t}},t}(n_),k_=new w_(b_),x_=new n_(JC);function S_(){}function C_(e,t){return function(n){if("function"!=typeof e)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return n.lift(new __(e,t))}}var __=function(){function e(e,t){this.project=e,this.thisArg=t}return e.prototype.call=function(e,t){return t.subscribe(new E_(e,this.project,this.thisArg))},e}(),E_=function(e){function t(t,n,i){var r=e.call(this,t)||this;return r.project=n,r.count=0,r.thisArg=i||r,r}return IC(t,e),t.prototype._next=function(e){var t;try{t=this.project.call(this.thisArg,e,this.count++)}catch(e){return void this.destination.error(e)}this.destination.next(t)},t}(VC),T_=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return IC(t,e),t.prototype.notifyNext=function(e,t,n,i,r){this.destination.next(t)},t.prototype.notifyError=function(e,t){this.destination.error(e)},t.prototype.notifyComplete=function(e){this.destination.complete()},t}(VC),P_=function(e){function t(t,n,i){var r=e.call(this)||this;return r.parent=t,r.outerValue=n,r.outerIndex=i,r.index=0,r}return IC(t,e),t.prototype._next=function(e){this.parent.notifyNext(this.outerValue,e,this.outerIndex,this.index++,this)},t.prototype._error=function(e){this.parent.notifyError(e,this),this.unsubscribe()},t.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()},t}(VC);function I_(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}var A_=I_(),O_=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e};function L_(e){return!!e&&"function"!=typeof e.subscribe&&"function"==typeof e.then}var N_=function(e){if(e&&"function"==typeof e[HC])return i=e,function(e){var t=i[HC]();if("function"!=typeof t.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return t.subscribe(e)};if(O_(e))return s_(e);if(L_(e))return n=e,function(e){return n.then((function(t){e.closed||(e.next(t),e.complete())}),(function(t){return e.error(t)})).then(null,NC),e};if(e&&"function"==typeof e[A_])return t=e,function(e){for(var n=t[A_]();;){var i=void 0;try{i=n.next()}catch(t){return e.error(t),e}if(i.done){e.complete();break}if(e.next(i.value),e.closed)break}return"function"==typeof n.return&&e.add((function(){n.return&&n.return()})),e};var t,n,i,r=MC(e)?"an invalid object":"'"+e+"'";throw new TypeError("You provided "+r+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.")};function R_(e,t){return t?function(e,t){if(null!=e){if(function(e){return e&&"function"==typeof e[HC]}(e))return function(e,t){return new GC((function(n){var i=new UC;return i.add(t.schedule((function(){var r=e[HC]();i.add(r.subscribe({next:function(e){i.add(t.schedule((function(){return n.next(e)})))},error:function(e){i.add(t.schedule((function(){return n.error(e)})))},complete:function(){i.add(t.schedule((function(){return n.complete()})))}}))}))),i}))}(e,t);if(L_(e))return function(e,t){return new GC((function(n){var i=new UC;return i.add(t.schedule((function(){return e.then((function(e){i.add(t.schedule((function(){n.next(e),i.add(t.schedule((function(){return n.complete()})))})))}),(function(e){i.add(t.schedule((function(){return n.error(e)})))}))}))),i}))}(e,t);if(O_(e))return a_(e,t);if(function(e){return e&&"function"==typeof e[A_]}(e)||"string"==typeof e)return function(e,t){if(!e)throw new Error("Iterable cannot be null");return new GC((function(n){var i,r=new UC;return r.add((function(){i&&"function"==typeof i.return&&i.return()})),r.add(t.schedule((function(){i=e[A_](),r.add(t.schedule((function(){if(!n.closed){var e,t;try{var r=i.next();e=r.value,t=r.done}catch(e){return void n.error(e)}t?n.complete():(n.next(e),this.schedule())}})))}))),r}))}(e,t)}throw new TypeError((null!==e&&typeof e||e)+" is not observable")}(e,t):e instanceof GC?e:new GC(N_(e))}var D_=function(e){function t(t){var n=e.call(this)||this;return n.parent=t,n}return IC(t,e),t.prototype._next=function(e){this.parent.notifyNext(e)},t.prototype._error=function(e){this.parent.notifyError(e),this.unsubscribe()},t.prototype._complete=function(){this.parent.notifyComplete(),this.unsubscribe()},t}(VC),M_=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return IC(t,e),t.prototype.notifyNext=function(e){this.destination.next(e)},t.prototype.notifyError=function(e){this.destination.error(e)},t.prototype.notifyComplete=function(){this.destination.complete()},t}(VC);function F_(e,t){if(!t.closed)return e instanceof GC?e.subscribe(t):N_(e)(t)}function B_(e,t,n){return void 0===n&&(n=Number.POSITIVE_INFINITY),"function"==typeof t?function(i){return i.pipe(B_((function(n,i){return R_(e(n,i)).pipe(C_((function(e,r){return t(n,e,i,r)})))}),n))}:("number"==typeof t&&(n=t),function(t){return t.lift(new U_(e,n))})}var U_=function(){function e(e,t){void 0===t&&(t=Number.POSITIVE_INFINITY),this.project=e,this.concurrent=t}return e.prototype.call=function(e,t){return t.subscribe(new j_(e,this.project,this.concurrent))},e}(),j_=function(e){function t(t,n,i){void 0===i&&(i=Number.POSITIVE_INFINITY);var r=e.call(this,t)||this;return r.project=n,r.concurrent=i,r.hasCompleted=!1,r.buffer=[],r.active=0,r.index=0,r}return IC(t,e),t.prototype._next=function(e){this.active<this.concurrent?this._tryNext(e):this.buffer.push(e)},t.prototype._tryNext=function(e){var t,n=this.index++;try{t=this.project(e,n)}catch(e){return void this.destination.error(e)}this.active++,this._innerSub(t)},t.prototype._innerSub=function(e){var t=new D_(this),n=this.destination;n.add(t);var i=F_(e,t);i!==t&&n.add(i)},t.prototype._complete=function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()},t.prototype.notifyNext=function(e){this.destination.next(e)},t.prototype.notifyComplete=function(){var e=this.buffer;this.active--,e.length>0?this._next(e.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()},t}(M_);function z_(e){return!DC(e)&&e-parseFloat(e)+1>=0}function V_(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=Number.POSITIVE_INFINITY,i=null,r=e[e.length-1];return o_(r)?(i=e.pop(),e.length>1&&"number"==typeof e[e.length-1]&&(n=e.pop())):"number"==typeof r&&(n=e.pop()),null===i&&1===e.length&&e[0]instanceof GC?e[0]:function(e){return void 0===e&&(e=Number.POSITIVE_INFINITY),B_($C,e)}(n)(l_(e,i))}function W_(e,t){return function(n){return n.lift(new H_(e,t))}}var H_=function(){function e(e,t){this.predicate=e,this.thisArg=t}return e.prototype.call=function(e,t){return t.subscribe(new $_(e,this.predicate,this.thisArg))},e}(),$_=function(e){function t(t,n,i){var r=e.call(this,t)||this;return r.predicate=n,r.thisArg=i,r.count=0,r}return IC(t,e),t.prototype._next=function(e){var t;try{t=this.predicate.call(this.thisArg,e,this.count++)}catch(e){return void this.destination.error(e)}t&&this.destination.next(e)},t}(VC);function G_(e,t,n){void 0===e&&(e=0);var i=-1;return z_(t)?i=Number(t)<1?1:Number(t):o_(t)&&(n=t),o_(n)||(n=x_),new GC((function(t){var r=z_(e)?e:+e-n.now();return n.schedule(q_,r,{index:0,period:i,subscriber:t})}))}function q_(e){var t=e.index,n=e.period,i=e.subscriber;if(i.next(t),!i.closed){if(-1===n)return i.complete();e.index=t+1,this.schedule(e,n)}}function Y_(){return function(e){return e.lift(new K_)}}var K_=function(){function e(){}return e.prototype.call=function(e,t){return t.subscribe(new X_(e))},e}(),X_=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return IC(t,e),t.prototype._next=function(e){},t}(VC);function Q_(e){return function(t){return t.lift(new Z_(e))}}var Z_=function(){function e(e){this.value=e}return e.prototype.call=function(e,t){return t.subscribe(new J_(e,this.value))},e}(),J_=function(e){function t(t,n){var i=e.call(this,t)||this;return i.value=n,i}return IC(t,e),t.prototype._next=function(e){this.destination.next(this.value)},t}(VC),eE=function(){function e(e,t,n){void 0===n&&(n=!1),this.accumulator=e,this.seed=t,this.hasSeed=n}return e.prototype.call=function(e,t){return t.subscribe(new tE(e,this.accumulator,this.seed,this.hasSeed))},e}(),tE=function(e){function t(t,n,i,r){var o=e.call(this,t)||this;return o.accumulator=n,o._seed=i,o.hasSeed=r,o.index=0,o}return IC(t,e),Object.defineProperty(t.prototype,"seed",{get:function(){return this._seed},set:function(e){this.hasSeed=!0,this._seed=e},enumerable:!0,configurable:!0}),t.prototype._next=function(e){if(this.hasSeed)return this._tryNext(e);this.seed=e,this.destination.next(e)},t.prototype._tryNext=function(e){var t,n=this.index++;try{t=this.accumulator(this.seed,e,n)}catch(e){this.destination.error(e)}this.seed=t,this.destination.next(t)},t}(VC),nE=function(e){function t(t,n,i){void 0===n&&(n=0),void 0===i&&(i=k_);var r=e.call(this)||this;return r.source=t,r.delayTime=n,r.scheduler=i,(!z_(n)||n<0)&&(r.delayTime=0),i&&"function"==typeof i.schedule||(r.scheduler=k_),r}return IC(t,e),t.create=function(e,n,i){return void 0===n&&(n=0),void 0===i&&(i=k_),new t(e,n,i)},t.dispatch=function(e){return this.add(e.source.subscribe(e.subscriber))},t.prototype._subscribe=function(e){return this.scheduler.schedule(t.dispatch,this.delayTime,{source:this.source,subscriber:e})},t}(GC),iE=function(){function e(e,t){this.scheduler=e,this.delay=t}return e.prototype.call=function(e,t){return new nE(t,this.delay,this.scheduler).subscribe(e)},e}();function rE(e,t){return function(t){return t.lift(new oE(e))}}var oE=function(){function e(e){this.project=e}return e.prototype.call=function(e,t){return t.subscribe(new sE(e,this.project))},e}(),sE=function(e){function t(t,n){var i=e.call(this,t)||this;return i.project=n,i.index=0,i}return IC(t,e),t.prototype._next=function(e){var t,n=this.index++;try{t=this.project(e,n)}catch(e){return void this.destination.error(e)}this._innerSub(t)},t.prototype._innerSub=function(e){var t=this.innerSubscription;t&&t.unsubscribe();var n=new D_(this),i=this.destination;i.add(n),this.innerSubscription=F_(e,n),this.innerSubscription!==n&&i.add(this.innerSubscription)},t.prototype._complete=function(){var t=this.innerSubscription;t&&!t.closed||e.prototype._complete.call(this),this.unsubscribe()},t.prototype._unsubscribe=function(){this.innerSubscription=void 0},t.prototype.notifyComplete=function(){this.innerSubscription=void 0,this.isStopped&&e.prototype._complete.call(this)},t.prototype.notifyNext=function(e){this.destination.next(e)},t}(M_);function aE(e){return function(t){return t.lift(new lE(e))}}var lE=function(){function e(e){this.notifier=e}return e.prototype.call=function(e,t){var n=new cE(e),i=F_(this.notifier,new D_(n));return i&&!n.seenValue?(n.add(i),t.subscribe(n)):n},e}(),cE=function(e){function t(t){var n=e.call(this,t)||this;return n.seenValue=!1,n}return IC(t,e),t.prototype.notifyNext=function(){this.seenValue=!0,this.complete()},t.prototype.notifyComplete=function(){},t}(M_);function uE(e,t,n){return function(i){return i.lift(new dE(e,t,n))}}var dE=function(){function e(e,t,n){this.nextOrObserver=e,this.error=t,this.complete=n}return e.prototype.call=function(e,t){return t.subscribe(new hE(e,this.nextOrObserver,this.error,this.complete))},e}(),hE=function(e){function t(t,n,i,r){var o=e.call(this,t)||this;return o._tapNext=S_,o._tapError=S_,o._tapComplete=S_,o._tapError=i||S_,o._tapComplete=r||S_,AC(n)?(o._context=o,o._tapNext=n):n&&(o._context=n,o._tapNext=n.next||S_,o._tapError=n.error||S_,o._tapComplete=n.complete||S_),o}return IC(t,e),t.prototype._next=function(e){try{this._tapNext.call(this._context,e)}catch(e){return void this.destination.error(e)}this.destination.next(e)},t.prototype._error=function(e){try{this._tapError.call(this._context,e)}catch(e){return void this.destination.error(e)}this.destination.error(e)},t.prototype._complete=function(){try{this._tapComplete.call(this._context)}catch(e){return void this.destination.error(e)}return this.destination.complete()},t}(VC),pE=function(){function e(e){this.closingSelector=e}return e.prototype.call=function(e,t){return t.subscribe(new fE(e,this.closingSelector))},e}(),fE=function(e){function t(t,n){var i=e.call(this,t)||this;return i.destination=t,i.closingSelector=n,i.openWindow(),i}return IC(t,e),t.prototype.notifyNext=function(e,t,n,i,r){this.openWindow(r)},t.prototype.notifyError=function(e){this._error(e)},t.prototype.notifyComplete=function(e){this.openWindow(e)},t.prototype._next=function(e){this.window.next(e)},t.prototype._error=function(e){this.window.error(e),this.destination.error(e),this.unsubscribeClosingNotification()},t.prototype._complete=function(){this.window.complete(),this.destination.complete(),this.unsubscribeClosingNotification()},t.prototype.unsubscribeClosingNotification=function(){this.closingNotification&&this.closingNotification.unsubscribe()},t.prototype.openWindow=function(e){void 0===e&&(e=null),e&&(this.remove(e),e.unsubscribe());var t=this.window;t&&t.complete();var n,i=this.window=new QC;this.destination.next(i);try{n=(0,this.closingSelector)()}catch(e){return this.destination.error(e),void this.window.error(e)}this.add(this.closingNotification=function(e,t,n,i,r){if(void 0===r&&(r=new P_(e,void 0,void 0)),!r.closed)return t instanceof GC?t.subscribe(r):N_(t)(r)}(this,n))},t}(T_),gE=function(e,t){return e===t||"function"==typeof t&&e===t.toString()},mE=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return e.pipe(W_((function(e){var n=e.type,i=t.length;if(1===i)return gE(n,t[0]);for(var r=0;r<i;r++)if(gE(n,t[r]))return!0;return!1})))}},yE=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),vE=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.source=e,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,GC),yE(t,null,[{key:"of",value:function(){return new this(c_.apply(void 0,arguments))}},{key:"from",value:function(e,t){return new this(R_(e,t))}}]),yE(t,[{key:"lift",value:function(e){var n=new t(this);return n.operator=e,n}},{key:"ofType",value:function(){return mE.apply(void 0,arguments)(this)}}]),t}(),bE=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,(function(e){var t=i.__notifier.subscribe(e);return t&&!t.closed&&e.next(i.value),t})));return i.value=n,i.__notifier=new QC,i.__subscription=e.subscribe((function(e){e!==i.value&&(i.value=e,i.__notifier.next(e))})),i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,GC),t}(),wE=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=function(){for(var e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];return V_.apply(void 0,function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(t.map((function(e){var t=e.apply(void 0,n);if(!t)throw new TypeError('combineEpics: one of the provided Epics "'+(e.name||"<anonymous>")+"\" does not return a stream. Double check you're not missing a return statement!");return t}))))};try{Object.defineProperty(i,"name",{value:"combineEpics("+t.map((function(e){return e.name||"<anonymous>"})).join(", ")+")"})}catch(e){}return i};By(".controlsOverlay {\n  width: 100%;\n  height: 100%;\n  background: rgba(255, 0, 0, 0.5);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  flex-direction: column;\n}\n.controlsOverlay .buttonClicked {\n  padding: 10px;\n  background: green;\n  margin: 10px;\n  color: white;\n}\n.controlsOverlay {\n  pointer-events: all;\n}"),rC(((e,t)=>{if(void 0===e)return{buttonClicked:!1,clicks:0};"CLICK"===t.type&&(e.buttonClicked=!0,e.clicks++)})),function(e){var t=e.createElement("STYLE"),n="addEventListener"in e,i=function(t,i){n?e.addEventListener(t,i):e.attachEvent("on"+t,i)},r=function(e){t.styleSheet?t.styleSheet.cssText=e:t.innerHTML=e};e.getElementsByTagName("HEAD")[0].appendChild(t),i("mousedown",(function(){r(":focus{outline:0}::-moz-focus-inner{border:0;}")})),i("keydown",(function(){r("")}))}(document);const kE=e=>EC.getContainerChildren(e);let xE={};const SE=(e,t)=>`${e}_${t}`,CE=(e,t)=>e?e({pluginOptions:cC(),ctx:uC(),addonId:t}):null;function _E(e){const[t,n]=Pg.useState(kE(e));return Pg.useEffect((()=>{function t(t){t.containerId===e&&(delete xE[SE(t.addonId,t.containerId)],n(kE(e)))}return EC.on("addonAdded",t),EC.on("addonRemoved",t),function(){EC.off("addonAdded",t),EC.off("addonRemoved",t)}}),[]),t.map((t=>((e,t)=>{let n=xE[SE(e,t)];if(n)return n;let i=null,r=EC.getDisplayedAddon(e),o=uC().player,s={...r.props,...CE(r.mapEkoContextToProps,e),addonId:e,parentContainer:t,key:e,useAddonSelector:hC(e),dispatchAddon:pC(e),useContainer:_E,player:o};r.api&&(s.api=r.api);let a=r.component,l=a&&a.prototype&&a.prototype.isReactComponent,c="function"==typeof a,u=Ig.isValidElement(a);if(l||c)if(r.mapStateToProps){let e=o.ui.connect(r.mapStateToProps)(a);i=Ig.createElement(e,s)}else i=Ig.createElement(a,s);else u&&(i=Ig.cloneElement(a,s));return xE[SE(e,t)]=i,i})(t,e)))}let EE={font:{}};By("#EkoshellRoot {\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  top: 0;\n  left: 0;\n  z-index: 100;\n  pointer-events: none;\n  -webkit-transform-style: preserve-3d;\n}");var TE={component:function(e){let t=_E("root"),n=function(){let e={};for(let[t,n]of Object.entries(EE.font))e[`--font-${t}`]=n;return e["--highlight-color"]=EE.highlightColor,e}();return Ig.createElement("div",{id:"EkoshellRoot",style:n},t)},init:({player:e,pluginOptions:t})=>{document.body.addEventListener("keydown",(t=>{" "===t.key&&document.activeElement===document.body&&e.ekoshell.ControlsOverlay.togglePlayPause()})),e.ekoshell.ClickCatcher&&e.ekoshell.ClickCatcher.setClickAction((n=>{t.addons.root&&t.addons.root.tapToPause?e.ekoshell.ControlsOverlay.togglePlayPause():e.ekoshell.ControlsOverlay.toggleShow()}))},uiScope:"platformAbove"};By("#ClickCatcher {\n  width: 100%;\n  height: 100%;\n  z-index: -10;\n  opacity: 0.5;\n  pointer-events: all;\n}");var PE={component:function(e){return React.createElement("div",{id:"ClickCatcher",onClick:()=>function(e){e.player.ekoshell.ClickCatcher.click(e)}(e),style:{display:"block"}})},api:function({}){let e;return{setClickAction:function(t){e=t},getClickAction:function(){return e},click:function(t){e(t)}}},uiScope:"platformBelow"};function IE(){return IE=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},IE.apply(this,arguments)}function AE(e,t){if(null==e)return{};var n,i,r={},o=Object.keys(e);for(i=0;i<o.length;i++)t.indexOf(n=o[i])>=0||(r[n]=e[n]);return r}function OE(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}function LE(e,t){return e.replace(new RegExp("(^|\\s)"+t+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}By('.ekoshell_controlsOverlay {\n  transition: opacity 0.3s;\n}\n.ekoshell_controlsOverlay.ekoshell_controlsOverlay-enter {\n  opacity: 0;\n  pointer-events: none;\n}\n.ekoshell_controlsOverlay.ekoshell_controlsOverlay-enter-done {\n  opacity: 1;\n  pointer-events: all;\n}\n.ekoshell_controlsOverlay.ekoshell_controlsOverlay-active {\n  opacity: 1;\n  pointer-events: all;\n}\n.ekoshell_controlsOverlay.ekoshell_controlsOverlay-exit {\n  opacity: 1;\n  pointer-events: all;\n}\n.ekoshell_controlsOverlay.ekoshell_controlsOverlay-exit-active, .ekoshell_controlsOverlay.ekoshell_controlsOverlay-exit-done {\n  opacity: 0;\n  pointer-events: none;\n}\n.ekoshell_controlsOverlay .prevCheckpoint, .ekoshell_controlsOverlay .nextCheckpoint {\n  width: 28px;\n  height: 28px;\n  position: absolute;\n  bottom: 7px;\n  transform: translateY(-40%) translateX(-50%);\n  background-repeat: no-repeat;\n  background-size: contain;\n  border: 0;\n  background-color: transparent;\n  cursor: pointer;\n  opacity: 0.6;\n  transition: all 0.3s;\n}\n@media (min-width: 40.0625em) and (min-height: 30em) {\n  .ekoshell_controlsOverlay .prevCheckpoint, .ekoshell_controlsOverlay .nextCheckpoint {\n    bottom: 20px;\n  }\n}\n.ekoshell_controlsOverlay .prevCheckpoint:hover, .ekoshell_controlsOverlay .nextCheckpoint:hover {\n  opacity: 1;\n}\n.ekoshell_controlsOverlay .prevCheckpoint {\n  background-image: url("data:image/svg+xml,%3Csvg width%3D%2228%22 height%3D%2228%22 viewBox%3D%220 0 28 28%22 fill%3D%22none%22 xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E    %3Cg clip-path%3D%22url(%23clip0)%22%3E        %3Cpath d%3D%22M24.5018 5.54169L24.5 21.875C24.4999 22.6031 23.6625 23.0126 23.0878 22.5656L14.5833 15.9513V21.875C14.5832 22.6031 13.7458 23.0126 13.1711 22.5656L2.67111 14.3989C2.22069 14.0486 2.22072 13.3678 2.67117 13.0175L13.173 4.85087C13.7477 4.40388 14.5851 4.81355 14.5851 5.54169L14.5833 11.4643L23.0896 4.85087C23.6644 4.40388 24.5018 4.81355 24.5018 5.54169ZM12.8349 7.33062L4.63361 13.7083L12.8335 20.086L12.8349 7.33062ZM22.7516 7.33062L14.5833 13.681V13.7346L22.7502 20.086L22.7516 7.33062Z%22 fill%3D%22white%22%2F%3E    %3C%2Fg%3E    %3Cdefs%3E        %3CclipPath id%3D%22clip0%22%3E            %3Crect width%3D%2228%22 height%3D%2228%22 fill%3D%22white%22%2F%3E        %3C%2FclipPath%3E    %3C%2Fdefs%3E%3C%2Fsvg%3E");\n  left: calc(50% - 20px - 32px);\n}\n.ekoshell_controlsOverlay .nextCheckpoint {\n  background-image: url("data:image/svg+xml,%3Csvg width%3D%2228%22 height%3D%2228%22 viewBox%3D%220 0 28 28%22 fill%3D%22none%22 xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E    %3Cg clip-path%3D%22url(%23clip0)%22%3E        %3Cpath d%3D%22M14.8288 4.85091L25.3288 13.0176C25.7792 13.3679 25.7792 14.0487 25.3288 14.399L14.827 22.5657C14.2522 23.0126 13.4148 22.603 13.4148 21.8748V15.9513L4.91031 22.5657C4.33551 23.0126 3.49817 22.603 3.49817 21.8748L3.49995 5.5415C3.50003 4.81342 4.33743 4.40391 4.91215 4.85091L13.4148 11.4643L13.4166 5.5415C13.4167 4.81342 14.2541 4.40391 14.8288 4.85091ZM15.1664 7.33051L15.165 20.0859L23.3663 13.7082L15.1664 7.33051ZM5.24975 7.33051L5.24836 20.0859L13.4148 13.7346V13.681L5.24975 7.33051Z%22 fill%3D%22white%22%2F%3E    %3C%2Fg%3E    %3Cdefs%3E        %3CclipPath id%3D%22clip0%22%3E            %3Crect width%3D%2228%22 height%3D%2228%22 fill%3D%22white%22%2F%3E        %3C%2FclipPath%3E    %3C%2Fdefs%3E%3C%2Fsvg%3E");\n  left: calc(50% + 20px + 32px);\n}\n@media (min-width: 40.0625em) and (min-height: 30em) {\n  .ekoshell_controlsOverlay .prevCheckpoint {\n    left: calc(50% - 24px - 32px);\n  }\n  .ekoshell_controlsOverlay .nextCheckpoint {\n    background-image: url("data:image/svg+xml,%3Csvg width%3D%2228%22 height%3D%2228%22 viewBox%3D%220 0 28 28%22 fill%3D%22none%22 xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E    %3Cg clip-path%3D%22url(%23clip0)%22%3E        %3Cpath d%3D%22M14.8288 4.85091L25.3288 13.0176C25.7792 13.3679 25.7792 14.0487 25.3288 14.399L14.827 22.5657C14.2522 23.0126 13.4148 22.603 13.4148 21.8748V15.9513L4.91031 22.5657C4.33551 23.0126 3.49817 22.603 3.49817 21.8748L3.49995 5.5415C3.50003 4.81342 4.33743 4.40391 4.91215 4.85091L13.4148 11.4643L13.4166 5.5415C13.4167 4.81342 14.2541 4.40391 14.8288 4.85091ZM15.1664 7.33051L15.165 20.0859L23.3663 13.7082L15.1664 7.33051ZM5.24975 7.33051L5.24836 20.0859L13.4148 13.7346V13.681L5.24975 7.33051Z%22 fill%3D%22white%22%2F%3E    %3C%2Fg%3E    %3Cdefs%3E        %3CclipPath id%3D%22clip0%22%3E            %3Crect width%3D%2228%22 height%3D%2228%22 fill%3D%22white%22%2F%3E        %3C%2FclipPath%3E    %3C%2Fdefs%3E%3C%2Fsvg%3E");\n    left: calc(50% + 24px + 32px);\n  }\n}\n\n.ekoshell_controlsOverlay {\n  width: 100%;\n  height: 94px;\n  background: linear-gradient(180deg, rgba(0, 0, 0, 0) 0%, var(--controlsOverlayGradientColorTop, rgba(0, 0, 0, 0.0001)) 0.01%, var(--controlsOverlayGradientColorBottom, rgba(0, 0, 0, 0.8)) 100%);\n  bottom: 0px;\n  left: 0;\n  position: absolute;\n  transition: all 0.3s;\n  pointer-events: all;\n  z-index: 500;\n}\n.ekoshell_controlsOverlay.visible {\n  opacity: 1;\n  pointer-events: auto;\n}\n.ekoshell_controlsOverlay .playPauseButton {\n  position: absolute;\n  left: 50%;\n  bottom: -8px;\n  width: 40px;\n  height: 40px;\n  transform: translateX(-50%) translateY(-50%);\n  background-size: contain;\n  border: none;\n  background-color: transparent;\n  cursor: pointer;\n  opacity: 0.6;\n  transition: opacity 0.3s;\n}\n@media (min-width: 40.0625em) and (min-height: 30em) {\n  .ekoshell_controlsOverlay .playPauseButton {\n    width: 48px;\n    height: 48px;\n    bottom: -2px;\n  }\n}\n.ekoshell_controlsOverlay .playPauseButton.playing {\n  background-image: url("data:image/svg+xml,%3Csvg width%3D%2240%22 height%3D%2240%22 viewBox%3D%220 0 40 40%22 fill%3D%22none%22 xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E    %3Cpath d%3D%22M39 20C39 30.4934 30.4934 39 20 39C9.50659 39 1 30.4934 1 20C1 9.50659 9.50659 1 20 1C30.4934 1 39 9.50659 39 20Z%22 fill%3D%22black%22 fill-opacity%3D%220.2%22 stroke%3D%22white%22 stroke-width%3D%222%22%2F%3E    %3Cpath d%3D%22M17.5 13.3333C18.1443 13.3333 18.6667 13.8557 18.6667 14.5V25.5C18.6667 26.1443 18.1443 26.6667 17.5 26.6667H15.1667C14.5223 26.6667 14 26.1443 14 25.5V14.5C14 13.8557 14.5223 13.3333 15.1667 13.3333H17.5ZM24.8333 13.3333C25.4777 13.3333 26 13.8557 26 14.5V25.5C26 26.1443 25.4777 26.6667 24.8333 26.6667H22.5C21.8557 26.6667 21.3333 26.1443 21.3333 25.5V14.5C21.3333 13.8557 21.8557 13.3333 22.5 13.3333H24.8333Z%22 fill%3D%22white%22%2F%3E%3C%2Fsvg%3E");\n}\n.ekoshell_controlsOverlay .playPauseButton.paused {\n  background-image: url("data:image/svg+xml,%3Csvg width%3D%2240%22 height%3D%2240%22 viewBox%3D%220 0 40 40%22 fill%3D%22none%22 xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E    %3Cpath d%3D%22M39 20C39 30.4934 30.4934 39 20 39C9.50659 39 1 30.4934 1 20C1 9.50659 9.50659 1 20 1C30.4934 1 39 9.50659 39 20Z%22 fill%3D%22black%22 fill-opacity%3D%220.2%22 stroke%3D%22white%22 stroke-width%3D%222%22%2F%3E    %3Cpath d%3D%22M16.755 12.7062C15.9396 12.2547 14.9127 12.5497 14.4612 13.365C14.3227 13.6152 14.25 13.8965 14.25 14.1825V25.8193C14.25 26.7513 15.0055 27.5068 15.9375 27.5068C16.2236 27.5068 16.5049 27.4341 16.7551 27.2955L27.2613 21.4763C28.0766 21.0247 28.3715 19.9977 27.9199 19.1825C27.7665 18.9055 27.5382 18.6772 27.2612 18.5238L16.755 12.7062Z%22 fill%3D%22white%22%2F%3E%3C%2Fsvg%3E");\n}\n.ekoshell_controlsOverlay .playPauseButton:hover {\n  opacity: 1;\n}\n.ekoshell_controlsOverlay .buttonRow {\n  position: absolute;\n  display: flex;\n  right: 16px;\n  bottom: 19px;\n}\n.ekoshell_controlsOverlay .buttonRow > * {\n  height: 28px;\n  margin-right: 16px;\n}\n.ekoshell_controlsOverlay .buttonRow > *:last-child {\n  margin-right: 0;\n}\n@media (min-width: 40.0625em) and (min-height: 30em) {\n  .ekoshell_controlsOverlay .buttonRow {\n    right: 40px;\n    bottom: 31px;\n  }\n  .ekoshell_controlsOverlay .buttonRow > * {\n    margin-right: 40px;\n  }\n}\n\n.focusablePauseButton {\n  position: absolute;\n  left: 50%;\n  bottom: -8px;\n  width: 40px;\n  height: 40px;\n  transform: translateX(-50%) translateY(-50%);\n  background-size: contain;\n  border: none;\n  background-color: transparent;\n  cursor: pointer;\n  opacity: 0.6;\n  transition: opacity 0.3s;\n  background-image: url("data:image/svg+xml,%3Csvg width%3D%2240%22 height%3D%2240%22 viewBox%3D%220 0 40 40%22 fill%3D%22none%22 xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E    %3Cpath d%3D%22M39 20C39 30.4934 30.4934 39 20 39C9.50659 39 1 30.4934 1 20C1 9.50659 9.50659 1 20 1C30.4934 1 39 9.50659 39 20Z%22 fill%3D%22black%22 fill-opacity%3D%220.2%22 stroke%3D%22white%22 stroke-width%3D%222%22%2F%3E    %3Cpath d%3D%22M17.5 13.3333C18.1443 13.3333 18.6667 13.8557 18.6667 14.5V25.5C18.6667 26.1443 18.1443 26.6667 17.5 26.6667H15.1667C14.5223 26.6667 14 26.1443 14 25.5V14.5C14 13.8557 14.5223 13.3333 15.1667 13.3333H17.5ZM24.8333 13.3333C25.4777 13.3333 26 13.8557 26 14.5V25.5C26 26.1443 25.4777 26.6667 24.8333 26.6667H22.5C21.8557 26.6667 21.3333 26.1443 21.3333 25.5V14.5C21.3333 13.8557 21.8557 13.3333 22.5 13.3333H24.8333Z%22 fill%3D%22white%22%2F%3E%3C%2Fsvg%3E");\n}\n@media (min-width: 40.0625em) and (min-height: 30em) {\n  .focusablePauseButton {\n    width: 48px;\n    height: 48px;\n    bottom: -2px;\n  }\n}\n.focusablePauseButton:hover {\n  opacity: 1;\n}\n.focusablePauseButton:not(:focus) {\n  display: block;\n  position: absolute !important;\n  clip: rect(1px, 1px, 1px, 1px);\n  width: 1px;\n  height: 1px;\n  margin: -1px;\n  border: 0;\n  padding: 0;\n  overflow: hidden;\n}');var NE=Ig.createContext(null),RE="unmounted",DE="exited",ME="entering",FE="entered",BE="exiting",UE=function(e){function t(t,n){var i;i=e.call(this,t,n)||this;var r,o=n&&!n.isMounting?t.enter:t.appear;return i.appearStatus=null,t.in?o?(r=DE,i.appearStatus=ME):r=FE:r=t.unmountOnExit||t.mountOnEnter?RE:DE,i.state={status:r},i.nextCallback=null,i}OE(t,e),t.getDerivedStateFromProps=function(e,t){return e.in&&t.status===RE?{status:DE}:null};var n=t.prototype;return n.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},n.componentDidUpdate=function(e){var t=null;if(e!==this.props){var n=this.state.status;this.props.in?n!==ME&&n!==FE&&(t=ME):n!==ME&&n!==FE||(t=BE)}this.updateStatus(!1,t)},n.componentWillUnmount=function(){this.cancelNextCallback()},n.getTimeouts=function(){var e,t,n,i=this.props.timeout;return e=t=n=i,null!=i&&"number"!=typeof i&&(e=i.exit,t=i.enter,n=void 0!==i.appear?i.appear:t),{exit:e,enter:t,appear:n}},n.updateStatus=function(e,t){void 0===e&&(e=!1),null!==t?(this.cancelNextCallback(),t===ME?this.performEnter(e):this.performExit()):this.props.unmountOnExit&&this.state.status===DE&&this.setState({status:RE})},n.performEnter=function(e){var t=this,n=this.props.enter,i=this.context?this.context.isMounting:e,r=this.props.nodeRef?[i]:[jg.findDOMNode(this),i],o=r[0],s=r[1],a=this.getTimeouts(),l=i?a.appear:a.enter;e||n?(this.props.onEnter(o,s),this.safeSetState({status:ME},(function(){t.props.onEntering(o,s),t.onTransitionEnd(l,(function(){t.safeSetState({status:FE},(function(){t.props.onEntered(o,s)}))}))}))):this.safeSetState({status:FE},(function(){t.props.onEntered(o)}))},n.performExit=function(){var e=this,t=this.props.exit,n=this.getTimeouts(),i=this.props.nodeRef?void 0:jg.findDOMNode(this);t?(this.props.onExit(i),this.safeSetState({status:BE},(function(){e.props.onExiting(i),e.onTransitionEnd(n.exit,(function(){e.safeSetState({status:DE},(function(){e.props.onExited(i)}))}))}))):this.safeSetState({status:DE},(function(){e.props.onExited(i)}))},n.cancelNextCallback=function(){null!==this.nextCallback&&(this.nextCallback.cancel(),this.nextCallback=null)},n.safeSetState=function(e,t){t=this.setNextCallback(t),this.setState(e,t)},n.setNextCallback=function(e){var t=this,n=!0;return this.nextCallback=function(i){n&&(n=!1,t.nextCallback=null,e(i))},this.nextCallback.cancel=function(){n=!1},this.nextCallback},n.onTransitionEnd=function(e,t){this.setNextCallback(t);var n=this.props.nodeRef?this.props.nodeRef.current:jg.findDOMNode(this);if(n&&(null!=e||this.props.addEndListener)){if(this.props.addEndListener){var i=this.props.nodeRef?[this.nextCallback]:[n,this.nextCallback];this.props.addEndListener(i[0],i[1])}null!=e&&setTimeout(this.nextCallback,e)}else setTimeout(this.nextCallback,0)},n.render=function(){var e=this.state.status;if(e===RE)return null;var t=this.props,n=t.children,i=AE(t,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return Ig.createElement(NE.Provider,{value:null},"function"==typeof n?n(e,i):Ig.cloneElement(Ig.Children.only(n),i))},t}(Ig.Component);function jE(){}UE.contextType=NE,UE.propTypes={},UE.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:jE,onEntering:jE,onEntered:jE,onExit:jE,onExiting:jE,onExited:jE},UE.UNMOUNTED=RE,UE.EXITED=DE,UE.ENTERING=ME,UE.ENTERED=FE,UE.EXITING=BE;var zE=function(e,t){return e&&t&&t.split(" ").forEach((function(t){return i=t,void((n=e).classList?n.classList.remove(i):"string"==typeof n.className?n.className=LE(n.className,i):n.setAttribute("class",LE(n.className&&n.className.baseVal||"",i)));var n,i}))},VE=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=e.call.apply(e,[this].concat(i))||this).appliedClasses={appear:{},enter:{},exit:{}},t.onEnter=function(e,n){var i=t.resolveArguments(e,n),r=i[0],o=i[1];t.removeClasses(r,"exit"),t.addClass(r,o?"appear":"enter","base"),t.props.onEnter&&t.props.onEnter(e,n)},t.onEntering=function(e,n){var i=t.resolveArguments(e,n);t.addClass(i[0],i[1]?"appear":"enter","active"),t.props.onEntering&&t.props.onEntering(e,n)},t.onEntered=function(e,n){var i=t.resolveArguments(e,n),r=i[0],o=i[1]?"appear":"enter";t.removeClasses(r,o),t.addClass(r,o,"done"),t.props.onEntered&&t.props.onEntered(e,n)},t.onExit=function(e){var n=t.resolveArguments(e)[0];t.removeClasses(n,"appear"),t.removeClasses(n,"enter"),t.addClass(n,"exit","base"),t.props.onExit&&t.props.onExit(e)},t.onExiting=function(e){var n=t.resolveArguments(e);t.addClass(n[0],"exit","active"),t.props.onExiting&&t.props.onExiting(e)},t.onExited=function(e){var n=t.resolveArguments(e)[0];t.removeClasses(n,"exit"),t.addClass(n,"exit","done"),t.props.onExited&&t.props.onExited(e)},t.resolveArguments=function(e,n){return t.props.nodeRef?[t.props.nodeRef.current,e]:[e,n]},t.getClassNames=function(e){var n=t.props.classNames,i="string"==typeof n,r=i?(i&&n?n+"-":"")+e:n[e];return{baseClassName:r,activeClassName:i?r+"-active":n[e+"Active"],doneClassName:i?r+"-done":n[e+"Done"]}},t}OE(t,e);var n=t.prototype;return n.addClass=function(e,t,n){var i=this.getClassNames(t)[n+"ClassName"],r=this.getClassNames("enter").doneClassName;"appear"===t&&"done"===n&&r&&(i+=" "+r),i&&(this.appliedClasses[t][n]=i,function(e,t){e&&t&&t.split(" ").forEach((function(t){return i=t,void((n=e).classList?n.classList.add(i):function(e,t){return e.classList?!!t&&e.classList.contains(t):-1!==(" "+(e.className.baseVal||e.className)+" ").indexOf(" "+t+" ")}(n,i)||("string"==typeof n.className?n.className=n.className+" "+i:n.setAttribute("class",(n.className&&n.className.baseVal||"")+" "+i)));var n,i}))}(e,i))},n.removeClasses=function(e,t){var n=this.appliedClasses[t],i=n.base,r=n.active,o=n.done;this.appliedClasses[t]={},i&&zE(e,i),r&&zE(e,r),o&&zE(e,o)},n.render=function(){var e=AE(this.props,["classNames"]);return Ig.createElement(UE,IE({},e,{onEnter:this.onEnter,onEntered:this.onEntered,onEntering:this.onEntering,onExit:this.onExit,onExiting:this.onExiting,onExited:this.onExited}))},t}(Ig.Component);function WE(e){let t=Pg.useRef(),n=e.children,i=function(e){let[t,n]=Pg.useState();return Pg.useEffect((()=>{function t(){if(e.current){let t=e.current.getBoundingClientRect();!function(e,t){for(;e.parentNode;){if(e===t)return!0;e=e.parentNode}return!1}(document.elementFromPoint(t.left+t.width/2,t.top+t.height/2),e.current)?n(!0):n(!1)}}let i=document.getElementById("EkoshellRoot");const r=new MutationObserver(t);r.observe(i,{childList:!0,subtree:!0});let o=setTimeout(t,300);return()=>{clearTimeout(o),r.disconnect()}}),[e.current]),t}(t),r=!!i||null;return Ig.cloneElement(n,{ref:e=>{t.current=e,n.ref&&(n.ref.current=e)},"aria-hidden":r,tabIndex:r?-1:null})}function HE(e){let t=Pg.useRef({blurTimeout:null}),[n,i]=Pg.useState();function r(e){i(!0)}function o(n){clearTimeout(t.current.blurTimeout),t.current.blurTimeout=setTimeout((()=>{null!==document.activeElement&&!1!==$E(document.activeElement,e.current)||i(!1)}),100)}return Pg.useEffect((()=>(e.current&&(e.current.addEventListener("focus",r,!0),e.current.addEventListener("blur",o,!0),document.activeElement&&$E(document.activeElement,e.current)&&i(!0)),()=>{e.current&&(e.current.removeEventListener("focus",r),e.current.removeEventListener("blur",o))})),[e.current]),n}function $E(e,t){for(;e.parentNode;){if(e===t)return!0;e=e.parentNode}return!1}VE.defaultProps={classNames:""},VE.propTypes={};var GE="SHOW",qE="SHOW_IF_PAUSED_AFTER_BUFFERING",YE="HIDE",KE="OVERLAY_TIMER_ELAPSE",XE="PREV_CHECKPOINT_CLICK",QE="NEXT_CHECKPOINT_CLICK",ZE="DONE_SEEKING",JE="KEYBOARD_FOCUS_ON_BUTTON",eT={CONTROLS_PAUSE:"ekoshell.button.pause",CONTROLS_PLAY:"ekoshell.button.play",CONTROLS_SKIP_FORWARD:"ekoshell.button.skip.forward",CONTROLS_SKIP_BACKWARDS:"ekoshell.button.skip.backwards",CONTROLS_SHOW:"ekoshell.controls.appear",CONTROLS_HIDE:"ekoshell.controls.disappear"};function tT(e,t){if(t.length>0){let n=t.length-1,i=t.length-2,r=t[n];if(e>r.time+5)return n;if(t[i]&&e>r.time&&e<=r.time+5)return i}return null}function nT(e,t){Pg.useEffect((()=>{let t=document.querySelector(".eko_uiscope.project");return t&&t.addEventListener("click",e),()=>{let t=document.querySelector(".eko_uiscope");t&&t.removeEventListener("click",e)}}),t)}const iT="bottom1",rT=rC(((e,t)=>{if(void 0===e)return{showControlsOverlay:t.type===GE,seekDirection:null};switch(t.type){case GE:case qE:e.showControlsOverlay=!0;break;case YE:case KE:e.showControlsOverlay=!1;break;case QE:e.seekDirection="forwards";break;case XE:e.seekDirection="backwards";break;case ZE:e.seekDirection=null}}));var oT,sT={exports:{}},aT=(oT||(oT=1,function(e){!function(){var t={}.hasOwnProperty;function n(){for(var e=[],i=0;i<arguments.length;i++){var r=arguments[i];if(r){var o=typeof r;if("string"===o||"number"===o)e.push(r);else if(Array.isArray(r)&&r.length){var s=n.apply(null,r);s&&e.push(s)}else if("object"===o)for(var a in r)t.call(r,a)&&r[a]&&e.push(a)}}return e.join(" ")}e.exports?(n.default=n,e.exports=n):window.classNames=n}()}(sT)),sT.exports),lT=r(aT);function cT(){return cT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},cT.apply(this,arguments)}var uT=({styles:e={},...t})=>Ig.createElement("svg",cT({width:"28",height:"28",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t),Ig.createElement("path",{d:"M21.875 4.667a3.792 3.792 0 013.792 3.791v11.089a3.792 3.792 0 01-3.792 3.792H6.125a3.792 3.792 0 01-3.792-3.792V8.458A3.792 3.792 0 015.91 4.673l.215-.006h15.75zm-9.483 5.365C9.582 8.429 6.417 10.33 6.417 14c0 3.667 3.168 5.57 5.974 3.974a.875.875 0 10-.865-1.52c-1.628.925-3.36-.115-3.36-2.454 0-2.34 1.728-3.379 3.359-2.448a.875.875 0 10.867-1.52zm8.75 0c-2.81-1.603-5.975.298-5.975 3.968 0 3.667 3.168 5.57 5.974 3.974a.875.875 0 10-.865-1.52c-1.628.925-3.36-.115-3.36-2.454 0-2.34 1.728-3.379 3.359-2.448a.875.875 0 10.867-1.52z",fill:"#fff"}));function dT(){return dT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},dT.apply(this,arguments)}var hT=({styles:e={},...t})=>Ig.createElement("svg",dT({width:"28",height:"28",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t),Ig.createElement("path",{d:"M21.875 4.667a3.792 3.792 0 013.792 3.791v11.089a3.792 3.792 0 01-3.792 3.792H6.125a3.792 3.792 0 01-3.792-3.792V8.458A3.792 3.792 0 015.91 4.673l.215-.006h15.75zm0 1.75H6.125l-.167.006a2.042 2.042 0 00-1.875 2.035v11.089c0 1.128.914 2.042 2.042 2.042h15.75a2.042 2.042 0 002.042-2.042V8.458a2.042 2.042 0 00-2.042-2.041zM6.417 14c0-3.67 3.165-5.571 5.975-3.968a.875.875 0 01-.867 1.52c-1.63-.93-3.358.107-3.358 2.448 0 2.339 1.731 3.379 3.359 2.453a.875.875 0 11.865 1.521C9.585 19.57 6.417 17.667 6.417 14zm8.75 0c0-3.67 3.165-5.571 5.975-3.968a.875.875 0 01-.867 1.52c-1.63-.93-3.358.107-3.358 2.448 0 2.339 1.731 3.379 3.359 2.453a.875.875 0 11.865 1.521c-2.806 1.596-5.974-.307-5.974-3.974z",fill:"#fff"}));By(".subtitlesButton .ccToggle {\n  padding: 0;\n  margin: 0;\n  background-color: transparent;\n  border: 0;\n  cursor: pointer;\n  cursor: pointer;\n  height: 100%;\n  height: 100%;\n  pointer-events: all;\n}\n.subtitlesButton .ccToggle img {\n  transition: all 0.2s ease-in;\n  opacity: 0.5;\n}\n@media (pointer: fine) {\n  .subtitlesButton .ccToggle:hover img {\n    opacity: 1;\n  }\n}\n\n.iconContainer {\n  width: 100%;\n  height: 100%;\n  cursor: pointer;\n  pointer-events: all;\n  position: relative;\n  display: flex;\n  align-items: center;\n  z-index: 1;\n}");var pT={SUBTITLES_ON:"ekoshell.button.cc.on",SUBTITLES_OFF:"ekoshell.button.cc.off"},fT={component:function(e){let{subtitlesVisible:t}=e;if("subtitles"in e.player==0||0===Object.keys(e.availableLanguages).length)return null;let n=e.player.ui.useSelector((e=>e.ekoshell.SubtitlesContextMenu.languageMenuOpen)),i=lT({subtitlesButton:!0,on:t}),r=uT,o=hT;e.icon&&e.icon.enabled&&e.icon.disabled&&(r=e.icon.enabled,o=e.icon.disabled);let s=t?r:o,a=Object.keys(e.availableLanguages).length;return React.createElement("div",{className:i},React.createElement(WE,null,React.createElement("button",{"aria-expanded":a>1?n:null,"aria-label":"CC",className:"ccToggle","aria-controls":a>1?"expandable":null,"aria-pressed":1===a?t:null,onClick:t=>{e.api.activateSubtitles(),t.stopPropagation()}},React.createElement("img",{alt:"Subtitles/CC button",src:s}))))},parentContainer:"ControlsOverlay_buttonRow",order:10,api:function({player:e}){return{disableSubtitles:function(){e.subtitles.visible&&(e.subtitles.visible=!1),e.trigger(pT.SUBTITLES_OFF)},activateSubtitles:function(t){Object.keys(e.subtitles.availableLanguages).length>1?e.ekoshell.SubtitlesContextMenu.show(t):(e.subtitles.visible=!e.subtitles.visible,e.trigger(e.subtitles.visible?pT.SUBTITLES_ON:pT.SUBTITLES_OFF))}}},mapStateToProps:function(e){return{subtitlesVisible:e.subtitles&&e.subtitles.visible,availableLanguages:e.subtitles&&e.subtitles.availableLanguages}},mapEkoContextToProps:function({ctx:e,pluginOptions:t}){let n=e.utils.getObjectProperty(e.environment,"os.name","").toLowerCase(),i={isiOS:"ios"===n,ismacOS:"mac os"===n};return t.addons.subtitlesbutton&&t.addons.subtitlesbutton.icon&&(i.icon=t.addons.subtitlesbutton.icon),i},events:pT};By('.ekoshellContextMenu {\n  box-sizing: border-box;\n  left: 0;\n  top: 0;\n  position: absolute;\n  z-index: 2000;\n  content: "";\n  background: rgba(19, 21, 26, 0.9);\n  box-shadow: 0 20px 25px rgba(0, 0, 0, 0.1);\n  border-radius: 32px;\n  cursor: pointer;\n  pointer-events: all;\n  padding: 24px 20px;\n  color: white;\n  width: 100%;\n  opacity: 0;\n  transition: all ease-in 0.15s;\n  top: var(--contextMenuTop, 0px);\n}\n@media (min-width: 40.0625em) {\n  .ekoshellContextMenu {\n    left: var(--contextMenuLeft, 0px);\n    width: auto;\n    border-radius: 24px;\n  }\n}\n@media (max-width: 20em) {\n  .ekoshellContextMenu {\n    padding: 18px 10px;\n  }\n}\n.ekoshellContextMenu {\n  transition: opacity 0.3s;\n}\n.ekoshellContextMenu.ekoshellContextMenu-enter {\n  opacity: 0;\n  pointer-events: none;\n}\n.ekoshellContextMenu.ekoshellContextMenu-enter-done {\n  opacity: 1;\n  pointer-events: all;\n}\n.ekoshellContextMenu.ekoshellContextMenu-active {\n  opacity: 1;\n  pointer-events: all;\n}\n.ekoshellContextMenu.ekoshellContextMenu-exit {\n  opacity: 1;\n  pointer-events: all;\n}\n.ekoshellContextMenu.ekoshellContextMenu-exit-active, .ekoshellContextMenu.ekoshellContextMenu-exit-done {\n  opacity: 0;\n  pointer-events: none;\n}');var gT=Pg.forwardRef(((e,t)=>{let n=Pg.useRef(),[i,r]=Pg.useState({}),[o,s]=Pg.useState(),[a,l]=Pg.useState(),c=Pg.useRef(),u=HE(n),d=()=>{let t=document.querySelector(e.anchorQuerySelector),i=e.anchorOffsetX||0,o=e.anchorOffsetY||0,s=e.anchorDirection||"top";if(t&&n.current){let e=document.querySelector("#EkoshellRoot").getBoundingClientRect(),a=e.width,l=n.current.getBoundingClientRect(),c=t.getBoundingClientRect();if("top"===s){let t=c.left-e.left-(l.width-c.width)/2+i;t+l.width+10>a&&(t=a-10-l.width),r({"--contextMenuLeft":t+"px","--contextMenuTop":c.top-l.height+o+"px"})}else if("bottom"===s){let t=c.left-e.left-(l.width-c.width)/2+i;t+l.width+10>a&&(t=a-10-l.width),r({"--contextMenuLeft":t+"px","--contextMenuTop":c.top+c.height+o+"px"})}}};Pg.useEffect((()=>{!1===u&&!a&&e.onHideRequest&&e.onHideRequest()}),[u,a]),nT((()=>{e.visibile&&e.onHideRequest&&e.onHideRequest()}),[e.visibile]),Pg.useEffect((()=>{e.visibile&&d(),h()}),[e.visibile,e.anchorQuerySelector,n.current]),Pg.useEffect((()=>(window.addEventListener("resize",d),()=>window.removeEventListener("resize",d))),[]),Pg.useEffect((()=>(n.current&&window.ResizeObserver&&(c.current=new ResizeObserver(d).observe(n.current)),()=>{c.current&&(c.current.disconnect(),c.current=null)})),[n.current]);let h=()=>{if(e.visibile){let t="autoHideTimeout"in e?e.autoHideTimeout:1e4;if(t){clearTimeout(o);let n=setTimeout((()=>e.onHideRequest&&e.onHideRequest()),t);s(n)}}else clearTimeout(o)};return Pg.useImperativeHandle(t,(()=>({resetAutoHideTimeout:h}))),React.createElement(VE,{in:e.visibile,timeout:150,classNames:"ekoshellContextMenu",unmountOnExit:!0},React.createElement("div",{className:"ekoshellContextMenu",style:i,ref:n,onKeyDown:t=>{"Escape"===t.key&&e.onHideRequest&&e.onHideRequest()},onMouseDown:e=>l(!0),onMouseUp:e=>l(!1)},e.content))}));function mT(e){let t=Pg.useRef();const n=e.items.map(((t,n)=>React.createElement("div",{key:t.id,className:"ekoshellList_itemContainer"},React.createElement("input",{type:"radio",name:"language_select",id:`select_${t.id}`,onChange:e.onChange&&(()=>e.onChange(t.value)),onKeyDown:e.onItemKeyDown,checked:t.checked}),React.createElement("label",{htmlFor:`select_${t.id}`,onClick:e.onItemClick,title:t.label},t.label))));Pg.useEffect((()=>{t.current.querySelector('input[type="radio"]:checked + label').focus()}),[]);let i="ekoshellList";return e.id&&(i+=` ekoshellList_${e.id}`),React.createElement("div",{role:"group",className:i},React.createElement("div",{"aria-hidden":"true",className:"ekoshellList_title"},e.title),React.createElement("div",{className:"ekoshellList_container",ref:t},n))}function yT(e){return{contextmenuVisible:e.ekoshell.SubtitlesContextMenu.languageMenuOpen,subtitlesVisible:e.subtitles&&e.subtitles.visible,availableLanguages:e.subtitles&&e.subtitles.availableLanguages,selectedLanguage:e.subtitles&&e.subtitles.effectiveLanguage}}By(".ekoshellList {\n  display: flex;\n  flex-direction: column;\n  font-family: Montserrat, sans-serif;\n  font-style: normal;\n  font-weight: 400;\n  font-size: 16px;\n  line-height: 20px;\n}\n\n.ekoshellList_container {\n  display: flex;\n  flex-direction: column;\n}\n\n.ekoshellList_itemContainer {\n  position: relative;\n  text-align: left;\n  margin-bottom: 14px;\n}\n.ekoshellList_itemContainer:last-child {\n  margin-bottom: 0px;\n}\n.ekoshellList_itemContainer label {\n  display: block;\n  cursor: pointer;\n  padding: 16px 26px;\n  white-space: nowrap;\n}\n.ekoshellList_itemContainer label:before {\n  display: block;\n  content: attr(title);\n  font-weight: bold;\n  height: 0;\n  overflow: hidden;\n  visibility: hidden;\n}\n@media (min-width: 40.0625em) {\n  .ekoshellList_itemContainer label {\n    padding: 12px 26px;\n  }\n  .ekoshellList_itemContainer label:hover {\n    font-weight: bold;\n  }\n}\n@media (max-width: 20em) {\n  .ekoshellList_itemContainer label {\n    padding: 6px 26px;\n  }\n}\n\ninput[type=radio]:checked + label {\n  font-weight: 700;\n  background: rgba(255, 255, 255, 0.1);\n  border-radius: 32px;\n}\n@media (min-width: 40.0625em) {\n  input[type=radio]:checked + label {\n    border-radius: 24px;\n    font-weight: bold;\n    background: rgba(255, 255, 255, 0.1);\n  }\n}\n\ninput[type=radio] {\n  position: absolute;\n  opacity: 0;\n  pointer-events: none;\n}\ninput[type=radio].focus-visible + label {\n  outline: 1px dotted #212121;\n  outline: 5px auto -webkit-focus-ring-color;\n}\n\n.ekoshellList_title {\n  font-style: normal;\n  font-weight: normal;\n  font-size: 18px;\n  padding: 15px 12px;\n  padding-bottom: 20px;\n  color: rgba(255, 255, 255, 0.5);\n}\n@media (max-width: 20em) {\n  .ekoshellList_title {\n    padding: 10px;\n  }\n}");var vT="SHOW_LANGUAGE_MENU",bT="HIDE_LANGUAGE_MENU",wT="SET_MENU_OPTIONS",kT=rC(((e,t)=>{if(void 0===e)return{languageMenuOpen:!1,menuOptions:{anchorQuerySelector:".ccToggle",anchorOffsetX:0,anchorOffsetY:-8}};t.type===bT?e.languageMenuOpen=!1:t.type===vT?e.languageMenuOpen=!e.languageMenuOpen:t.type===wT&&(e.menuOptions={...e.menuOptions,...t.menuOptions})})),xT={SUBTITLES_MENU_OPEN:"ekoshell.button.cc.menu.open",SUBTITLES_MENU_CLOSE:"ekoshell.button.cc.menu.close",SUBTITLES_SELECTED:"ekoshell.menu.cc.selected"},ST="SHOW_VOLUME_SLIDER",CT="HIDE_VOLUME_SLIDER",_T="ACTIVATE_VOLUME",ET="DEACTIVATE_VOLUME",TT={component:function(e){let t=Pg.useRef(),n=e.useAddonSelector((e=>e.menuOptions));if(!e.availableLanguages)return null;let i=Object.keys(e.availableLanguages).map((t=>({id:t,value:t,label:e.availableLanguages[t].nativeName,checked:e.subtitlesVisible&&t===e.selectedLanguage})));i.push({id:"off",value:"off",label:"Off",checked:!e.subtitlesVisible});const r=e.api.hide;let o=React.createElement(mT,{title:"Subtitles",items:i,onChange:n=>{"off"===n?e.player.ekoshell.SubtitlesButton.disableSubtitles():e.api.selectLanguage(n),t&&t.current.resetAutoHideTimeout()},onItemClick:r,onItemKeyDown:e=>{" "!==e.key&&"Enter"!==e.key||r()}});return React.createElement(gT,{ref:t,visibile:e.contextmenuVisible,anchorQuerySelector:n.anchorQuerySelector,anchorDirection:n.anchorDirection,anchorOffsetX:n.anchorOffsetX,anchorOffsetY:n.anchorOffsetY,content:o,onHideRequest:r})},init:({player:e,addonId:t})=>{e.on("play",e.ekoshell.SubtitlesContextMenu.hide),e.ekoshell.ControlsOverlay.addAutoHideAction(vT,t),e.tracker&&e.tracker.registerContextPacker({match:xT.SUBTITLES_SELECTED,schema:"iglu:com.helloeko/ekoshell_menu_cc_selected/jsonschema/1-0-0",getData:function(e){return{language:e||""}}})},reducer:kT,api:function({player:e,dispatchAddon:t}){return{show:function(n){t({type:wT,menuOptions:n}),t({type:vT}),e.trigger(xT.SUBTITLES_MENU_OPEN)},hide:function(){t({type:bT}),e.trigger(xT.SUBTITLES_MENU_CLOSE)},selectLanguage:function(t){let{selectedLanguage:n,subtitlesVisible:i}=yT(e.reduxStore.getState());n===t&&i||(e.subtitles.language=t,e.subtitles.visible=!0,e.trigger(xT.SUBTITLES_ON)),e.trigger(xT.SUBTITLES_SELECTED,t)}}},epic:function({addonId:e}){return wE((t=>t.pipe(mE(fC(YE,"ControlsOverlay")),Q_(gC({type:bT},e)))),(t=>t.pipe(mE(fC(ST,"VolumeButton")),Q_(gC({type:bT},e)))))},mapStateToProps:yT,events:xT};function PT(){return PT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},PT.apply(this,arguments)}By(".fullscreenButton {\n  padding: 0;\n  margin: 0;\n  background-color: transparent;\n  border: 0;\n  cursor: pointer;\n  cursor: pointer;\n  height: 100%;\n  height: 100%;\n  pointer-events: all;\n}\n.fullscreenButton img {\n  transition: all 0.2s ease-in;\n  opacity: 0.5;\n}\n@media (pointer: fine) {\n  .fullscreenButton:hover img {\n    opacity: 1;\n  }\n}");var IT=({styles:e={},...t})=>Ig.createElement("svg",PT({width:"28",height:"28",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t),Ig.createElement("path",{d:"M21.7 5.07a.875.875 0 011.237 1.237l-3.611 3.61h2.554c.443 0 .809.329.867.756l.008.119a.875.875 0 01-.875.875h-4.667a.875.875 0 01-.875-.875V6.125a.875.875 0 011.75 0v2.554l3.611-3.61zM6.124 11.665a.875.875 0 110-1.75h2.55l-3.607-3.61a.875.875 0 01-.084-1.139l.085-.098a.875.875 0 011.237 0l3.61 3.613V6.124c0-.443.33-.81.757-.867l.118-.008c.484 0 .875.392.875.875v4.667a.875.875 0 01-.875.874H6.125zm4.666 4.674c.484 0 .875.392.875.875v4.667a.875.875 0 11-1.75 0v-2.556l-3.61 3.612a.875.875 0 01-1.14.085l-.097-.085a.875.875 0 010-1.237l3.607-3.61H6.125a.875.875 0 01-.867-.757l-.008-.119c0-.483.392-.875.875-.875h4.666zM22.752 17.21a.875.875 0 00-.875-.874h-4.666a.875.875 0 00-.875.875v4.667c0 .483.391.875.875.875l.118-.008a.875.875 0 00.757-.867V19.32l3.61 3.613a.875.875 0 001.237.001l.085-.098a.875.875 0 00-.084-1.14l-3.608-3.61h2.551a.875.875 0 00.875-.875z",fill:"#fff"}));function AT(){return AT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},AT.apply(this,arguments)}var OT=({styles:e={},...t})=>Ig.createElement("svg",AT({width:"28",height:"28",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t),Ig.createElement("path",{d:"M8.861 17.908a.875.875 0 011.238 1.237l-3.611 3.61h2.554c.443 0 .809.33.867.756l.008.119a.875.875 0 01-.875.875H4.375a.875.875 0 01-.875-.875v-4.667a.875.875 0 111.75 0v2.554l3.611-3.61zm10.103 6.597a.875.875 0 110-1.75h2.55l-3.606-3.61a.875.875 0 01-.085-1.14l.085-.097a.875.875 0 011.238 0l3.61 3.613v-2.558c0-.443.329-.809.756-.867l.119-.008c.483 0 .875.392.875.875v4.667a.875.875 0 01-.875.875h-4.667zM9.042 3.5a.875.875 0 110 1.75H6.49l3.608 3.61c.31.311.339.798.084 1.14l-.084.098a.875.875 0 01-1.238 0L5.25 6.484v2.558c0 .443-.33.809-.756.867l-.119.008a.875.875 0 01-.875-.875V4.375c0-.483.392-.875.875-.875h4.667zm14.589 0c.483 0 .875.392.875.875v4.667a.875.875 0 11-1.75 0V6.486l-3.61 3.612a.875.875 0 01-1.14.085l-.098-.085a.875.875 0 010-1.237l3.608-3.611h-2.552a.875.875 0 01-.867-.756l-.008-.119c0-.483.392-.875.875-.875h4.667z",fill:"#fff"})),LT={FULLSCREENBTN_ENTER:"ekoshell.button.fullscreen.enter",FULLSCREENBTN_EXIT:"ekoshell.button.fullscreen.exit"},NT={component:function(e){let t=OT,n=IT;return e.icon&&e.icon.maximize&&e.icon.minimize&&(t=e.icon.maximize,n=e.icon.minimize),React.createElement(WE,null,React.createElement("button",{onClick:e.api.toggleFullscreen,className:"fullscreenButton","aria-label":"Full screen","aria-pressed":e.isFullscreen},!e.isFullscreen&&React.createElement("img",{src:t,alt:"Maximize screen"}),e.isFullscreen&&React.createElement("img",{src:n,alt:"Minimize"})))},parentContainer:"ControlsOverlay_buttonRow",order:30,api:function({player:e}){return{toggleFullscreen:function(t){e.isFullscreen?(e.exitFullscreen(),e.trigger(LT.FULLSCREENBTN_EXIT)):(e.requestFullscreen(),e.trigger(LT.FULLSCREENBTN_ENTER)),t.stopPropagation()}}},mapStateToProps:function(e){return{isFullscreen:e.player.isFullscreen}},mapEkoContextToProps:function({pluginOptions:e}){let t={};return e.addons.fullscreenbutton&&e.addons.fullscreenbutton.icon&&(t.icon=e.addons.fullscreenbutton.icon),t},events:LT};function RT(){return RT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},RT.apply(this,arguments)}By('.ekoshell_shareButton {\n  padding: 0;\n  margin: 0;\n  background-color: transparent;\n  border: 0;\n  cursor: pointer;\n  display: inline-flex;\n  align-items: center;\n  height: 100%;\n}\n.ekoshell_shareButton svg rect {\n  fill: transparent;\n}\n.ekoshell_shareButton svg {\n  fill: #fff;\n  height: 100%;\n}\n.ekoshell_shareButton .text {\n  color: #fff;\n  font-size: 10px;\n  line-height: 12px;\n  margin: 0 15px 0 3px;\n  font-family: Stolzl-Regular, "Helvetica Neue", Helvetica, Arial, sans-serif;\n}\n@media (min-width: 40.0625em) and (min-height: 30em) {\n  .ekoshell_shareButton .text {\n    font-size: 12px;\n    line-height: 16px;\n  }\n}\n.ekoshell_shareButton img {\n  width: 100%;\n  height: 100%;\n}');var DT=({styles:e={},...t})=>Ig.createElement("svg",RT({width:"28",height:"28",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t),Ig.createElement("path",{d:"M23.047 12.833c.443 0 .809.33.867.757l.008.118v8.168a3.792 3.792 0 01-3.577 3.786l-.215.006H7.297A3.792 3.792 0 013.51 22.09l-.006-.215v-8.168a.875.875 0 011.742-.118l.008.118v8.168c0 1.071.825 1.95 1.874 2.035l.168.007H20.13c1.071 0 1.95-.825 2.035-1.874l.007-.168v-8.168c0-.483.391-.875.875-.875zM7.257 8.42l5.828-5.83a.875.875 0 011.139-.084l.098.084 5.84 5.83a.875.875 0 01-1.14 1.323l-.097-.085L14.58 5.32l.001 13.643c0 .443-.329.81-.756.867l-.119.008a.875.875 0 01-.867-.756l-.008-.119V5.318L8.493 9.656a.875.875 0 01-1.14.085l-.098-.085a.875.875 0 01-.084-1.139l.084-.098 5.83-5.83-5.83 5.83z",fill:"#fff"}));function MT(){return MT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},MT.apply(this,arguments)}var FT=({styles:e={},...t})=>Ig.createElement("svg",MT({width:"27",height:"27",xmlns:"http://www.w3.org/2000/svg"},t),Ig.createElement("path",{d:"M21.84 9.88h-6.89V4.03l3.12 3.12 1.04-1.04L14.3 1.3 9.62 6.11l.91 1.04 3.12-3.12v5.85H6.63c-1.17 0-2.08 1.04-2.08 2.21v11.7c0 1.17.91 2.21 2.08 2.21h15.21c1.17 0 2.21-.91 2.21-2.21v-11.7c0-1.17-.91-2.21-2.21-2.21zm.52 13.91c0 .26-.26.39-.39.39H6.63c-.26 0-.52-.26-.52-.39v-11.7c0-.26.26-.52.52-.52h7.02v6.24h1.3v-6.24h6.89c.26 0 .39.26.39.52v11.7z",fill:"#FFF"})),BT={SHAREBTN_SHARE_CLICK:"ekoshell.button.share"},UT={component:function(e){let{isiOS:t}=e,n=DT;return e.icon&&e.icon.default?n=t&&e.icon.ios?e.icon.ios:e.icon.default:t&&(n=FT),React.createElement(WE,null,React.createElement("button",{onClick:e.api.openShareDialog,className:"ekoshell_shareButton","aria-label":"Share"},React.createElement("img",{src:n})))},parentContainer:"ProjectMetaData_buttonRow",order:10,api:function({player:e}){return{openShareDialog:function(t){e.share.share(),t.stopPropagation(),e.trigger(BT.SHAREBTN_SHARE_CLICK)}}},mapEkoContextToProps:function({ctx:e,pluginOptions:t}){let n=e.utils.getObjectProperty(e.environment,"os.name","").toLowerCase(),i={isiOS:"ios"===n,ismacOS:"mac os"===n};return t.addons.sharebutton&&t.addons.sharebutton.icon&&(i.icon=t.addons.sharebutton.icon),i},events:BT};function jT(){return jT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},jT.apply(this,arguments)}var zT=({styles:e={},...t})=>Ig.createElement("svg",jT({width:"27",height:"27",xmlns:"http://www.w3.org/2000/svg"},t),Ig.createElement("g",{fill:"#fff"},Ig.createElement("path",{d:"M15.5 4.558c0-1.258-1.487-1.926-2.427-1.09l-5.24 4.66a.875.875 0 01-.582.22H2.958a2.625 2.625 0 00-2.625 2.625v5.248a2.625 2.625 0 002.625 2.625h4.293c.214 0 .421.078.582.22l5.24 4.66c.94.836 2.427.169 2.427-1.09V4.558zM8.995 9.435l4.755-4.227v16.779l-4.755-4.228a2.625 2.625 0 00-1.744-.663H2.958a.875.875 0 01-.875-.875v-5.248c0-.483.392-.875.875-.875h4.293c.643 0 1.264-.236 1.744-.663zM20.157 6.48a.875.875 0 011.224.182 11.619 11.619 0 012.286 6.938c0 2.597-.85 4.998-2.286 6.937a.875.875 0 01-1.407-1.041 9.869 9.869 0 001.943-5.896c0-2.21-.722-4.248-1.943-5.896a.875.875 0 01.183-1.224z"}),Ig.createElement("path",{d:"M18 9.364a.875.875 0 011.186.353c.626 1.156.98 2.48.98 3.883a8.134 8.134 0 01-.98 3.883.875.875 0 11-1.539-.833c.49-.907.77-1.944.77-3.05a6.385 6.385 0 00-.77-3.05A.875.875 0 0118 9.364z"})));function VT(){return VT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},VT.apply(this,arguments)}var WT=({styles:e={},...t})=>Ig.createElement("svg",VT({width:"27",height:"27",xmlns:"http://www.w3.org/2000/svg"},t),Ig.createElement("g",{fill:"#fff"},Ig.createElement("path",{d:"M13.073 3.468c.94-.836 2.427-.168 2.427 1.09v18.079c0 1.258-1.487 1.925-2.427 1.09l-5.24-4.66a.875.875 0 00-.582-.221H2.958A2.625 2.625 0 01.333 16.22v-5.248a2.625 2.625 0 012.625-2.625h4.293a.875.875 0 00.582-.22l5.24-4.66zm.677 1.74L8.995 9.435a2.625 2.625 0 01-1.744.663H2.958a.875.875 0 00-.875.875v5.248c0 .483.392.875.875.875h4.293c.643 0 1.264.236 1.744.663l4.755 4.228V5.207zM16.923 10.356a.875.875 0 011.237 0l2.007 2.006 2.006-2.006a.875.875 0 011.237 1.238L21.404 13.6l2.006 2.006a.875.875 0 01-1.237 1.238l-2.006-2.007-2.007 2.007a.875.875 0 01-1.237-1.238l2.006-2.006-2.006-2.006a.875.875 0 010-1.238z"})));By('.volume-container {\n  position: relative;\n  height: 100%;\n  pointer-events: all;\n}\n\n.slider {\n  opacity: 0;\n  bottom: 37px;\n  left: 42%;\n  transform: translateX(-50%);\n  position: absolute;\n  content: "";\n  width: 72px;\n  height: 208px;\n  background: rgba(19, 21, 26, 0.9);\n  box-shadow: 0 20px 25px rgba(0, 0, 0, 0.1);\n  border-radius: 12px;\n  cursor: pointer;\n  pointer-events: none;\n}\n.slider:not(:focus):not(.active) {\n  opacity: 0;\n  position: absolute !important;\n  clip: rect(1px, 1px, 1px, 1px);\n  width: 1px;\n  height: 1px;\n  margin: -1px;\n  border: 0;\n  padding: 0;\n  overflow: hidden;\n}\n.slider.active, .slider:focus {\n  opacity: 1;\n  pointer-events: all;\n}\n.slider:after {\n  content: "";\n  position: absolute;\n  bottom: -100px;\n  left: 0;\n  width: 100%;\n  height: 100px;\n}\n\n.bar, .filledBar {\n  position: absolute;\n  top: 20px;\n  width: 3px;\n  height: 170px;\n  left: calc(50% - 3px);\n  border-radius: 16px;\n}\n\n.bar {\n  background: rgba(255, 255, 255, 0.6);\n  z-index: 1;\n}\n\n.filledBar {\n  content: "";\n  background: var(--highlight-color, #FFF);\n  transform-origin: 50% 100%;\n  z-index: 2;\n}\n\n.handle {\n  position: absolute;\n  top: 20px;\n  left: 50%;\n  width: 24px;\n  height: 24px;\n  background: #fff;\n  border-radius: 20px;\n  z-index: 50;\n  box-shadow: 0 4px 6px 0px rgba(0, 0, 0, 0.1), 0 2px 5px 0px rgba(0, 0, 0, 0.06);\n}\n\n.volumeButton {\n  padding: 0;\n  margin: 0;\n  background-color: transparent;\n  border: 0;\n  cursor: pointer;\n  padding: 0;\n  margin: 0;\n  background-color: transparent;\n  border: 0;\n  cursor: pointer;\n  cursor: pointer;\n  height: 100%;\n  height: 100%;\n  pointer-events: all;\n}\n.volumeButton img {\n  transition: all 0.2s ease-in;\n  opacity: 0.5;\n}\n@media (pointer: fine) {\n  .volumeButton:hover img {\n    opacity: 1;\n  }\n}\n.volumeButton {\n  z-index: 10;\n  position: relative;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n}');var HT=rC(((e,t)=>{if(void 0===e)return{showSlider:!1,isActive:!1};t.type===ST&&(e.showSlider=!0),t.type===CT&&(e.showSlider=!1,e.isActive=!1),t.type===_T&&(e.isActive=!0),t.type===ET&&(e.isActive=!1)})),$T={VOLUME_MUTE:"ekoshell.button.volume.mute",VOLUME_UNMUTE:"ekoshell.button.volume.unmute",VOLUME_OPEN:"ekoshell.menu.volume.open"},GT={component:function(e){if(!e.isDesktop)return null;let[t,n]=Pg.useState(0),[i,r]=Pg.useState(e.player.volume),[o,s]=Pg.useState(),a=e.useAddonSelector((e=>e.showSlider)),l={transform:`translateX(-50%) translateX(-2px) translateY(-50%) translateY(${t}px)`},c={transform:`scaleY(${i})`},u=e.isPlayerMuted,d={display:u?"block":"none"},h={display:u?"none":"block"},p=lT({slider:!0,active:a}),f=zT,g=WT;e.icon&&e.icon.default&&e.icon.muted&&(f=e.icon.default,g=e.icon.muted);const m=Ig.useRef(null),y=Pg.useCallback((e=>{o&&(n(o.height*(1-e)),r(e))}),[o]),v=(t,n)=>{e.api.changeVolume(n)},b=Pg.useCallback((e=>{if(o){let t=1-Math.min(1,Math.max(0,(e.clientY-o.top)/o.height));y(t),v(0,t)}}),[o]);return Pg.useLayoutEffect((()=>{m.current&&s(m.current.getBoundingClientRect())}),[a]),Pg.useLayoutEffect((()=>{y(player.volume)}),[o]),Pg.useEffect((()=>{const t=()=>{e.api.deactivateVolume()};return document.body.addEventListener("mouseup",t),()=>{document.body.removeEventListener("mouseup",t)}}),[]),Ig.createElement("div",{className:"volume-container",onMouseMove:t=>{e.player.reduxStore.getState().ekoshell.VolumeButton.isActive&&b(t)},onMouseLeave:()=>{e.api.hideVolume(),document.activeElement===m.current.parentNode&&document.activeElement.blur()}},Ig.createElement(WE,null,Ig.createElement("button",{"aria-label":u?"Unmute volume":"Mute volume","aria-pressed":u,className:"volumeButton",onMouseEnter:t=>{y(e.player.volume),e.api.showVolume(t)},onClick:t=>{u?(0===player.volume?e.api.changeVolume(.15):e.api.toggleMute(),0===t.pageX&&0===t.pageY&&setTimeout((()=>m.current&&m.current.parentNode.focus()),0),e.api.showVolume(t)):(e.api.toggleMute(),e.api.hideVolume()),t.stopPropagation()},onBlur:()=>{a||e.api.hideVolume()}},Ig.createElement("img",{alt:"Volume on",src:f,className:"hoverPath",style:h}),Ig.createElement("img",{alt:"Volume muted",src:g,className:"hoverPath",style:d}))),Ig.createElement("div",{tabIndex:0,className:p,onMouseDown:t=>{e.api.activateVolume(),b(t)},onClick:e=>{e.preventDefault(),e.stopPropagation()},onKeyDown:e=>{const t=e.keyCode;38===t||40===t?(e.preventDefault(),(e=>{let t=.05;40===e&&(t*=-1);let n=Math.min(1,Math.max(0,i+t));y(n),v(0,n)})(t)):27===t&&document.activeElement&&document.activeElement.blur()},onFocus:e=>{s(m.current.getBoundingClientRect()),console.log(e)},onBlur:()=>{e.api.hideVolume()},role:"slider","aria-label":"Volume slider","aria-valuemax":"100","aria-valuemin":"0","aria-valuenow":Math.ceil(100*i),"aria-valuetext":`${Math.ceil(100*i)} percent`},Ig.createElement("div",{className:"handle",style:l}),Ig.createElement("div",{className:"filledBar",style:c}),Ig.createElement("div",{className:"bar",ref:m})))},parentContainer:"ControlsOverlay_buttonRow",order:20,init:({addonId:e,player:t})=>{t.ekoshell.ControlsOverlay.addAutoHideAction(ST,e)},reducer:HT,api:function({player:e,dispatchAddon:t}){return{changeVolume:function(t){e.volume!==t&&(e.muted=0===t,e.volume=t)},toggleMute:function(){e.muted=!e.muted,t({type:e.muted?CT:ST}),e.trigger(e.muted?$T.VOLUME_MUTE:$T.VOLUME_UNMUTE)},showVolume:function(n){n.stopPropagation(),t({type:ST}),e.trigger($T.VOLUME_OPEN)},hideVolume:function(){t({type:CT})},activateVolume:function(){t({type:_T})},deactivateVolume:function(){t({type:ET})}}},mapStateToProps:function(e){return{isPlayerMuted:e.player.isAudioLocked||e.player.muted}},mapEkoContextToProps:function({ctx:e,pluginOptions:t}){let n={isDesktop:e.environment.isDesktop};return t.addons.volumebutton&&t.addons.volumebutton.icon&&(n.icon=t.addons.volumebutton.icon),n},events:$T},qT={init:({addonId:e,player:t,pluginOptions:n})=>{EC.add("VolumeButton",GT),EC.add("SubtitlesButton",fT),EC.add("SubtitlesContextMenu",TT),EC.add("FullscreenButton",NT),EC.add("ShareButton",UT),t.ekoshell.ControlsOverlay.addAutoHideAction("PLAYER_PAUSE"),t.ekoshell.ControlsOverlay.addAutoHideAction(fC(JE,e)),n.addons.controlsoverlay.showAtStart&&t.ekoshell.ControlsOverlay.show()},component:function(e){let t=e.useContainer("ControlsOverlay_buttonRow"),n=e.isPaused?"paused":"playing",i={...e.backgroundGradientColorTop&&{"--controlsOverlayGradientColorTop":e.backgroundGradientColorTop},...e.backgroundGradientColorBottom&&{"--controlsOverlayGradientColorBottom":e.backgroundGradientColorBottom}},r=e.showControlsOverlay||e.alwaysShow,o=Pg.useRef(),s=Pg.useRef(),a=HE(o);Pg.useEffect((()=>{player.subtitles&&(e.alwaysShow?player.subtitles.position.lockDisplayZone(iT,"ekoshellAlwaysShow"):player.subtitles.position.unlockDisplayZone(iT,"ekoshellAlwaysShow"))}),[e.alwaysShow]),Pg.useEffect((()=>{!0===a&&e.dispatchAddon({type:JE})}),[a]),nT((()=>{r&&e.api.hide()}),[r]);let[l,c]=Pg.useState(!1);return Pg.useEffect((()=>{function e(){c(!0),setTimeout((()=>c(!1)),0)}return s.current&&s.current.addEventListener("blur",e),()=>{s.current&&s.current.removeEventListener("blur",e)}}),[s.current]),Pg.useEffect((()=>{r&&l&&o.current.querySelector(".playPauseButton").focus()}),[r,l]),Ig.createElement(Ig.Fragment,null,!r&&Ig.createElement("button",{className:"focusablePauseButton","aria-label":"Pause",ref:s,onClick:e.api.togglePlayPause,onKeyDown:e=>"Escape"===e.key?e.target.blur():null,onFocus:()=>{player.subtitles&&player.subtitles.position.lockDisplayZone(iT,"ekoshellFocusablePauseButton")},onBlur:()=>{player.subtitles&&player.subtitles.position.unlockDisplayZone(iT,"ekoshellFocusablePauseButton")}}),Ig.createElement(VE,{in:r,classNames:"ekoshell_controlsOverlay",unmountOnExit:!0,timeout:{enter:0,exit:300}},Ig.createElement("div",{className:"ekoshell_controlsOverlay",style:i,onClick:e.api.hide,ref:o},e.showSkipBackward&&e.canJumpToPrevCheckpoint&&Ig.createElement(WE,null,Ig.createElement("button",{className:"prevCheckpoint","aria-label":"Previous checkpoint",onClick:e.api.skipToPrevCheckpoint})),Ig.createElement(WE,null,Ig.createElement("button",{className:`playPauseButton ${n}`,"aria-label":e.isPaused?"Play":"Pause",onClick:function(t){e.api.togglePlayPause(t),0===t.pageX&&0===t.pageY&&setTimeout((()=>{s.current&&s.current.focus()}),0)}})),e.showSkipForward&&e.canJumpToNextCheckpoint&&Ig.createElement(WE,null,Ig.createElement("button",{className:"nextCheckpoint","aria-label":"Next checkpoint",onClick:e.api.skipToNextCheckpoint})),Ig.createElement("div",{className:"buttonRow"},t))))},reducer:rT,api:function({player:e,dispatchAddon:t}){let n=[];function i(){t({type:YE}),e.trigger(eT.CONTROLS_HIDE)}function r(){t({type:GE}),e.trigger(eT.CONTROLS_SHOW)}return{show:r,hide:i,toggleShow:function(){e.reduxStore.getState().ekoshell.ControlsOverlay.showControlsOverlay?i():r()},togglePlayPause:function(n){let i=e.reduxStore.getState().player.isWaiting;e.paused?(!1===i&&t({type:YE}),e.play(),e.trigger(eT.CONTROLS_PLAY)):(e.pause(),t({type:GE}),e.trigger(eT.CONTROLS_PAUSE)),n&&n.stopPropagation()},skipToPrevCheckpoint:function(){if(e.reduxStore.getState().ekoshell.ControlsOverlay.seekDirection)return;let n=tT(e.currentTime,e.checkpoints.checkpoints),i=e.checkpoints.checkpoints[n];i?(e.ekoshell.SeekIndication.show("backward"),t({type:XE,seekDirection:"backward"}),e.once("checkpoints.restored",(()=>t({type:ZE}))),e.checkpoints.restore(i,{forcePause:!1}),e.trigger(eT.CONTROLS_SKIP_BACKWARDS)):console.warn(`EkoShell: tried to jump to checkpoint index ${n} but was null! checkpoints length ${e.checkpoints.checkpoints.length}`)},skipToNextCheckpoint:function(){e.reduxStore.getState().ekoshell.ControlsOverlay.seekDirection||e.checkpoints.upcomingCheckpointsTime.length>0&&(e.ekoshell.SeekIndication.show("forward"),t({type:QE,seekDirection:"forward"}),e.once("seeked",(()=>{e.paused&&e.play(),t({type:ZE})})),e.currentTime=e.checkpoints.upcomingCheckpointsTime[0],e.trigger(eT.CONTROLS_SKIP_FORWARD))},getPrevCheckpointIndex:()=>e.checkpoints?tT(e.currentTime,e.checkpoints.checkpoints):null,addAutoHideAction:function(e,t){if(t){let i=gC({type:e},t);n.push(i.type)}else n.push(e)},getAutoHideActions:function(){return n}}},epic:function({player:e,addonId:t,getActionTypeName:n,pluginOptions:i}){let r=i.addons.controlsoverlay,o=[];return o.push((e=>{return e.pipe(mE("PLAYER_WAITING"),(n=e.ofType("PLAYER_PLAYING"),rE((function(){return n}))),rE((()=>e.ofType("PLAYER_PAUSE").pipe(Q_(gC({type:qE},t)),aE(G_(1e3))))));var n})),!1!==r.autoHide&&o.push((n=>n.pipe(W_((e=>e.type===fC(GE,t))),rE((()=>{let i=e.ekoshell.ControlsOverlay.getAutoHideActions(),r=n.ofType.apply(n,i);return G_(3e3).pipe(Q_(gC({type:KE},t)),aE(r))}))))),null!==r.parentContainer&&(o.push((t=>t.pipe(mE(n(GE)),uE((()=>{e.subtitles&&e.subtitles.position.lockDisplayZone("bottom1","ekoshellControlsOverlay")})),Y_()))),o.push((t=>t.pipe(mE(n(YE),n(KE)),uE((()=>{e.subtitles&&e.subtitles.position.unlockDisplayZone("bottom1","ekoshellControlsOverlay")})),Y_())))),wE.apply(null,o)},mapStateToProps:function(e){let t=e.player.isWaiting,n=!t&&e.checkpoints&&null!==tT(e.player.currentTime,e.checkpoints.checkpoints);return{showControlsOverlay:e.ekoshell.ControlsOverlay.showControlsOverlay||t,isPaused:e.player.isPaused,canJumpToPrevCheckpoint:n,canJumpToNextCheckpoint:!t&&e.checkpoints&&e.checkpoints.upcomingCheckpointsTime.length>0}},mapEkoContextToProps:function({pluginOptions:e,ctx:t}){let n=e.addons.controlsoverlay,i=t.environment.isDesktop?n.checkpointsEnabled:n.checkpointsEnabled&&n.checkpointsEnabledOnMobile,r={showSkipForward:i&&n.skipForward,showSkipBackward:i&&n.skipBackward,isDesktop:t.environment.isDesktop};return n&&(n.backgroundGradientColorTop&&(r.backgroundGradientColorTop=n.backgroundGradientColorTop),n.backgroundGradientColorBottom&&(r.backgroundGradientColorBottom=n.backgroundGradientColorBottom),r.autoHide=!("autoHide"in n)||n.autoHide,r.alwaysShow="alwaysShow"in n&&n.alwaysShow),r},events:eT};function YT(){return YT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},YT.apply(this,arguments)}By('.ekoshell_seekIndicationContainer {\n  position: absolute;\n  width: 104px;\n  height: 104px;\n  left: 50%;\n  top: 50%;\n  pointer-events: none;\n  z-index: 200;\n  transform: translate3d(-50%, -50%, 0);\n  transition: opacity 0.3s;\n}\n.ekoshell_seekIndicationContainer.ekoshell_seekIndicationContainer-enter {\n  opacity: 0;\n  pointer-events: none;\n}\n.ekoshell_seekIndicationContainer.ekoshell_seekIndicationContainer-enter-done {\n  opacity: 1;\n  pointer-events: all;\n}\n.ekoshell_seekIndicationContainer.ekoshell_seekIndicationContainer-active {\n  opacity: 1;\n  pointer-events: all;\n}\n.ekoshell_seekIndicationContainer.ekoshell_seekIndicationContainer-exit {\n  opacity: 1;\n  pointer-events: all;\n}\n.ekoshell_seekIndicationContainer.ekoshell_seekIndicationContainer-exit-active, .ekoshell_seekIndicationContainer.ekoshell_seekIndicationContainer-exit-done {\n  opacity: 0;\n  pointer-events: none;\n}\n@media (min-width: 40.0625em) and (min-height: 30em) {\n  .ekoshell_seekIndicationContainer {\n    width: 148px;\n    height: 148px;\n  }\n}\n.ekoshell_seekIndicationContainer:before {\n  content: "";\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  background: rgba(19, 21, 26, 0.8);\n  border-radius: 170.769px;\n}\n.ekoshell_seekIndicationContainer svg {\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  opacity: 0;\n  transition: opacity 0.3s ease-out;\n}\n.ekoshell_seekIndicationContainer .caption {\n  position: absolute;\n  top: 55px;\n  width: 60px;\n  left: calc(50% - 30px);\n  font-family: Montserrat;\n  font-style: normal;\n  font-weight: 500;\n  font-size: 12px;\n  line-height: 16px;\n  /* or 133% */\n}\n@media (min-width: 40.0625em) and (min-height: 30em) {\n  .ekoshell_seekIndicationContainer .caption {\n    top: 74px;\n    width: 100px;\n    left: calc(50% - 50px);\n    font-weight: 500;\n    font-size: 17.0769px;\n    line-height: 23px;\n  }\n}\n.ekoshell_seekIndicationContainer .caption {\n  display: flex;\n  align-items: center;\n  text-align: center;\n  color: #FFFFFF;\n}\n.ekoshell_seekIndicationContainer .icon {\n  position: absolute;\n  width: 22px;\n  top: 27px;\n  left: calc(50% - 11px);\n}\n@media (min-width: 40.0625em) and (min-height: 30em) {\n  .ekoshell_seekIndicationContainer .icon {\n    width: 32px;\n    top: 35px;\n    left: calc(50% - 14px);\n  }\n}');var KT=({styles:e={},...t})=>Ig.createElement("svg",YT({width:"33",height:"26",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t),Ig.createElement("path",{d:"M32.003 1.378L32 24.712c0 1.04-1.196 1.625-2.017.986l-12.15-9.449v8.463c0 1.04-1.196 1.625-2.017.986l-15-11.666a1.25 1.25 0 010-1.974L15.82.392c.82-.639 2.017-.054 2.017.986l-.002 8.461L29.985.392c.822-.639 2.018-.054 2.018.986z",fill:"#fff"}));function XT(){return XT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},XT.apply(this,arguments)}var QT=({styles:e={},...t})=>Ig.createElement("svg",XT({width:"33",height:"26",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t),Ig.createElement("path",{d:"M17.184.391l15 11.667a1.25 1.25 0 010 1.974L17.182 25.698c-.822.639-2.018.054-2.018-.987V16.25L3.014 25.7c-.82.638-2.016.053-2.016-.988L1 1.378C1 .338 2.197-.247 3.018.391L15.164 9.84l.003-8.461c0-1.04 1.196-1.625 2.017-.987z",fill:"#fff"})),ZT="SHOW",JT="HIDE",eP={component:function(e){let t,n="";return"forward"===e.seekDirection?(n="Next Choice",t=Ig.createElement("img",{src:QT,className:"icon"})):"backward"===e.seekDirection&&(n="Previous Choice",t=Ig.createElement("img",{src:KT,className:"icon"})),Ig.createElement(VE,{in:e.seekDirection,classNames:"ekoshell_seekIndicationContainer",unmountOnExit:!0,timeout:{enter:0,exit:300}},Ig.createElement("div",{className:`ekoshell_seekIndicationContainer ${e.seekDirection?e.seekDirection:""}`},t,Ig.createElement("div",{className:"caption"},n)))},reducer:rC(((e,t)=>{if(void 0===e)return{seekDirection:null};switch(t.type){case ZT:e.seekDirection=t.seekDirection;break;case JT:e.seekDirection=null}})),api:function({dispatchAddon:e}){return{show:function(t){e({type:ZT,seekDirection:t})},hide:function(){e({type:JT})}}},epic:function({addonId:e}){return t=>t.pipe(W_((t=>t.type===fC(ZT,e))),rE((()=>G_(2e3).pipe(Q_(gC({type:JT},e))))))},mapStateToProps:e=>({seekDirection:e.ekoshell.SeekIndication.seekDirection})};let tP,nP;By(".ekoshell_waitingIndication.ekoshell_waitingIndication-enter {\n  opacity: 0;\n  transition: opacity 0.3s 0s;\n}\n\n.ekoshell_waitingIndication.ekoshell_waitingIndication-enter-active {\n  opacity: 1;\n  transition: opacity 0.3s 1s;\n}\n\n.ekoshell_waitingIndication.ekoshell_waitingIndication-exit {\n  opacity: 1;\n  transition: opacity 0.3s;\n}\n\n.ekoshell_waitingIndication {\n  z-index: 500;\n  overflow: hidden;\n  transition: opacity 0.3s;\n  transition: opacity 0.3s;\n}\n.ekoshell_waitingIndication.ekoshell_waitingIndication-enter {\n  opacity: 0;\n  pointer-events: none;\n}\n.ekoshell_waitingIndication.ekoshell_waitingIndication-enter-done {\n  opacity: 1;\n  pointer-events: all;\n}\n.ekoshell_waitingIndication.ekoshell_waitingIndication-active {\n  opacity: 1;\n  pointer-events: all;\n}\n.ekoshell_waitingIndication.ekoshell_waitingIndication-exit {\n  opacity: 1;\n  pointer-events: all;\n}\n.ekoshell_waitingIndication.ekoshell_waitingIndication-exit-active, .ekoshell_waitingIndication.ekoshell_waitingIndication-exit-done {\n  opacity: 0;\n  pointer-events: none;\n}"),By('.eko-loading-animation {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n  pointer-events: none;\n}\n.eko-loading-animation.eko-show-loading-animation .eko-animated-bar {\n  opacity: 0.6;\n}\n.eko-loading-animation.eko-show-loading-animation .eko-animated-bar .eko-animated-bar-inner {\n  animation: eko-loading-bar-inner-animation 2s infinite;\n}\n.eko-loading-animation.eko-show-loading-text .eko-loading-text {\n  opacity: 1;\n}\n.eko-loading-animation .eko-animated-bar {\n  width: 100%;\n  height: 4px;\n  background-color: rgba(232, 232, 232, 0.6980392157);\n  opacity: 0;\n  transition: opacity 0.5s;\n  position: relative;\n}\n.eko-loading-animation .eko-animated-bar .eko-animated-bar-inner {\n  width: 150px;\n  height: 100%;\n  transform: translateX(-150px);\n  background-color: var(--accent-color, #4d484b);\n  display: block;\n  position: absolute;\n}\n.eko-loading-animation .eko-loading-text {\n  position: absolute;\n  top: 10px;\n  left: 50%;\n  transform: translateX(-50%);\n  color: rgb(101, 101, 101);\n  font-size: 12px;\n  font-family: "Bogle-Medium", sans-serif;\n  font-weight: 500;\n  opacity: 0;\n  align-items: center;\n  display: flex;\n  gap: 2px;\n  transition: opacity 0.5s;\n}\n.eko-loading-animation .eko-loading-text-icon {\n  opacity: 60%;\n}\n.eko-loading-animation .eko-loading-text-icon svg {\n  transform: translate(2px, 2px);\n}\n.eko-loading-animation .eko-loading-text-icon path {\n  fill: var(--accent-color, #4d484b);\n}\n.eko-loading-animation.eko-hide-icon .eko-loading-text-icon {\n  display: none;\n}\n\n@keyframes eko-loading-bar-inner-animation {\n  0% {\n    left: -350px;\n  }\n  100% {\n    left: calc(100% + 350px);\n  }\n}\n@media screen and (min-width: 768px) {\n  .eko-loading-animation .eko-animated-bar {\n    height: 6px;\n  }\n  .eko-loading-animation .eko-loading-text {\n    font-size: 16px;\n    top: 12px;\n  }\n  .eko-loading-animation .eko-loading-text-icon {\n    transform: rotate(180deg);\n  }\n}');var iP="SHOW",rP="HIDE",oP={component:function(e){const t="ekoshell_waitingIndication",n={loading:{text:"Buffering video",hideIcon:!1,showAnimationTimer:1500,showTextTimer:7500}};return Ig.createElement(VE,{in:e.active,classNames:t,unmountOnExit:!0,timeout:{enter:0,exit:300},onEntered:()=>function(e,t){var n;const i=(null===(n=window.eko)||void 0===n||null===(n=n.metadata)||void 0===n||null===(n=n.options)||void 0===n?void 0:n.loading)||(null==t?void 0:t.loading),r=(null==i?void 0:i.text)||"Loading video experience",o=(null==i?void 0:i.hideIcon)||!1,s=(null==i?void 0:i.showAnimationTimer)||1500,a=(null==i?void 0:i.showTextTimer)||7500;e.classList.add("eko-loading-animation"),e.querySelector(".eko-loading-text-inner").textContent=r,o&&e.classList.add("eko-hide-icon"),function(e,t){tP=setTimeout((()=>{e.classList.add("eko-show-loading-animation"),e.style.opacity=1}),t)}(e,s),function(e,t){nP=setTimeout((()=>{e.classList.add("eko-show-loading-text")}),t)}(e,a)}(document.querySelector(`.${t}`),n),onExited:()=>(clearTimeout(tP),void clearTimeout(nP))},Ig.createElement("div",{className:t,style:{opacity:0}},Ig.createElement("div",{className:"eko-animated-bar"},Ig.createElement("div",{className:"eko-animated-bar-inner"})),Ig.createElement("div",{className:"eko-loading-text",style:{opacity:0}},Ig.createElement("div",{className:"eko-loading-text-inner"}),Ig.createElement("div",{className:"eko-loading-text-icon"},Ig.createElement("svg",{width:"13",height:"15",viewBox:"0 0 13 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Ig.createElement("path",{d:"M10.4046 1.47286L10.119 2.87937L10.8253 4.12876C10.8607 4.19696 10.8573 4.27949 10.8169 4.33509C10.7766 4.39069 10.6991 4.41936 10.63 4.3975L9.21678 4.12111L7.96739 4.82742C7.89919 4.86282 7.81666 4.85949 7.76106 4.8191C7.70546 4.7787 7.67679 4.70124 7.69866 4.63217L7.97504 3.21893L7.26874 1.96954C7.23333 1.90134 7.24593 1.82554 7.28633 1.76994C7.32672 1.71434 7.39492 1.67894 7.47072 1.69154L8.87722 1.97719L10.1359 1.27762C10.1948 1.23548 10.2773 1.23881 10.3329 1.27921C10.3885 1.3196 10.4172 1.39707 10.4046 1.47286Z"}),Ig.createElement("path",{d:"M4.52419 4.49333L6.47951 6.5921L9.33192 6.8952C9.48396 6.91687 9.6143 7.01818 9.65778 7.14847C9.70126 7.27877 9.65788 7.43805 9.54208 7.52496L7.45055 9.502L7.14745 12.3544C7.12578 12.5064 7.02447 12.6368 6.89418 12.6803C6.76388 12.7237 6.6046 12.6804 6.51769 12.5646L4.54065 10.473L1.68824 10.1699C1.5362 10.1483 1.42758 10.0397 1.3841 9.90942C1.34062 9.77912 1.36228 9.62709 1.47084 9.51846L3.56961 7.56314L3.89443 4.70348C3.89438 4.55869 3.99569 4.42835 4.12598 4.38487C4.25628 4.34139 4.41556 4.38477 4.52419 4.49333Z"}))))))},reducer:rC(((e,t)=>{if(void 0===e)return{active:!1};switch(t.type){case iP:e.active=!0;break;case rP:e.active=!1}})),init:({player:e})=>{e.ekoshell.WaitingIndication.addShowHideActionPair("PLAYER_WAITING",["PLAYER_PLAYING","PLAYER_SEEK_END"])},api:function(){let e={};return{getShowHideActionPairs:function(){return e},addShowHideActionPair:function(t,n,i){let r=i?fC(t,i):t,o=i?fC(n,i):n;e[r]=o}}},epic:function({player:e,addonId:t}){let n=gC({type:iP},t),i=gC({type:rP},t),r=fC(rP,t);function o(){return e.ekoshell.WaitingIndication.getShowHideActionPairs()}return e=>{return e.pipe((t=()=>e.pipe(mE(r)),function(e){return e.lift(new pE(t))}),B_((e=>e.pipe(W_((e=>function(){let e=o();return Object.keys(e).concat(Object.values(e)).flat()}().includes(e.type))),function(e,t){var n=!1;return arguments.length>=2&&(n=!0),function(i){return i.lift(new eE(e,t,n))}}(((e,t)=>{let n=o(),i="startAction"in e;return!i&&t.type in n?(e.startAction=t.type,e.actionable=!0):i&&(t.type===n[e.startAction]||Array.isArray(n[e.startAction])&&n[e.startAction].includes(t.type))?(e.endAction=t.type,e.actionable=!0):e.actionable=!1,e}),{}),W_((e=>e.actionable)),C_((e=>e.endAction?i:e.startAction?n:void 0))))));var t}},mapStateToProps:e=>({active:e.ekoshell.WaitingIndication.active})};By('/* @import must be at top of file, otherwise CSS will not work */\n/*Font Stolzl*/\n@import url(https://fonts.googleapis.com/css?family=Montserrat:300,400,500,700&display=swap);\n@font-face {\n  font-family: "Stolzl-Light";\n  font-display: swap;\n  src: url("https://d1w2zhnqcy4l8f.cloudfront.net/content/helloeko/fonts/Stolzl/30E833_0_0.eot");\n  src: url("https://d1w2zhnqcy4l8f.cloudfront.net/content/helloeko/fonts/Stolzl/30E833_0_0.eot?#iefix") format("embedded-opentype"), url("https://d1w2zhnqcy4l8f.cloudfront.net/content/helloeko/fonts/Stolzl/30E833_0_0.woff2") format("woff2"), url("https://d1w2zhnqcy4l8f.cloudfront.net/content/helloeko/fonts/Stolzl/30E833_0_0.woff") format("woff"), url("https://d1w2zhnqcy4l8f.cloudfront.net/content/helloeko/fonts/Stolzl/30E833_0_0.ttf") format("truetype");\n}\n@font-face {\n  font-family: "Stolzl-Regular";\n  font-display: swap;\n  src: url("https://d1w2zhnqcy4l8f.cloudfront.net/content/helloeko/fonts/Stolzl/30E833_1_0.eot");\n  src: url("https://d1w2zhnqcy4l8f.cloudfront.net/content/helloeko/fonts/Stolzl/30E833_1_0.eot?#iefix") format("embedded-opentype"), url("https://d1w2zhnqcy4l8f.cloudfront.net/content/helloeko/fonts/Stolzl/30E833_1_0.woff2") format("woff2"), url("https://d1w2zhnqcy4l8f.cloudfront.net/content/helloeko/fonts/Stolzl/30E833_1_0.woff") format("woff"), url("https://d1w2zhnqcy4l8f.cloudfront.net/content/helloeko/fonts/Stolzl/30E833_1_0.ttf") format("truetype");\n}\n@font-face {\n  font-family: "Stolzl-Bold";\n  font-display: swap;\n  src: url("https://d1w2zhnqcy4l8f.cloudfront.net/content/helloeko/fonts/Stolzl/30E833_2_0.eot");\n  src: url("https://d1w2zhnqcy4l8f.cloudfront.net/content/helloeko/fonts/Stolzl/30E833_2_0.eot?#iefix") format("embedded-opentype"), url("https://d1w2zhnqcy4l8f.cloudfront.net/content/helloeko/fonts/Stolzl/30E833_2_0.woff2") format("woff2"), url("https://d1w2zhnqcy4l8f.cloudfront.net/content/helloeko/fonts/Stolzl/30E833_2_0.woff") format("woff"), url("https://d1w2zhnqcy4l8f.cloudfront.net/content/helloeko/fonts/Stolzl/30E833_2_0.ttf") format("truetype");\n}\n/*Font Montesrrat*/\n.ekoshell_projectMetaData {\n  width: 100%;\n  height: 100%;\n  background: rgba(0, 0, 0, 0.7);\n  top: 0;\n  left: 0;\n  position: absolute;\n  transition: all 0.3s;\n  pointer-events: all;\n  z-index: 400;\n  transition: opacity 0.3s;\n}\n.ekoshell_projectMetaData.ekoshell_projectMetaData-enter {\n  opacity: 0;\n  pointer-events: none;\n}\n.ekoshell_projectMetaData.ekoshell_projectMetaData-enter-done {\n  opacity: 1;\n  pointer-events: all;\n}\n.ekoshell_projectMetaData.ekoshell_projectMetaData-active {\n  opacity: 1;\n  pointer-events: all;\n}\n.ekoshell_projectMetaData.ekoshell_projectMetaData-exit {\n  opacity: 1;\n  pointer-events: all;\n}\n.ekoshell_projectMetaData.ekoshell_projectMetaData-exit-active, .ekoshell_projectMetaData.ekoshell_projectMetaData-exit-done {\n  opacity: 0;\n  pointer-events: none;\n}\n.ekoshell_projectMetaData.visible {\n  opacity: 1;\n  pointer-events: auto;\n}\n.ekoshell_projectMetaData .projectInfo {\n  position: Absolute;\n  top: 0;\n  left: 0;\n  padding: 20px 0 0 20px;\n  max-width: calc(100% - 100px);\n  user-select: none;\n  display: flex;\n  flex-direction: column;\n  align-items: flex-start;\n}\n@media (min-width: 50.75em) {\n  .ekoshell_projectMetaData .projectInfo {\n    padding-left: 40px;\n  }\n}\n@media (min-width: 64em) {\n  .ekoshell_projectMetaData .projectInfo {\n    padding-left: 20px;\n  }\n}\n@media (min-width: 90.0625em) {\n  .ekoshell_projectMetaData .projectInfo {\n    padding: 40px 0 0 40px;\n  }\n}\n@media (max-width: 26.25em) and (orientation: landscape) {\n  .ekoshell_projectMetaData .projectInfo {\n    padding: 10px 0 0 10px;\n  }\n}\n.ekoshell_projectMetaData .projectInfo .title {\n  padding: 0;\n  margin: 0;\n  background-color: transparent;\n  border: 0;\n  cursor: pointer;\n  padding-bottom: 15px;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  font-family: var(--font-paragraph, Montserrat, sans-serif);\n}\n@media (max-width: 26.25em) and (orientation: landscape) {\n  .ekoshell_projectMetaData .projectInfo .title {\n    padding-bottom: 10px;\n  }\n}\n.ekoshell_projectMetaData .projectInfo .title .alphaText {\n  opacity: 0.75;\n  text-decoration: none;\n}\n@media (max-width: 26.25em) and (orientation: landscape) {\n  .ekoshell_projectMetaData .projectInfo .title .alphaText {\n    text-overflow: ellipsis;\n    overflow: hidden;\n    white-space: nowrap;\n  }\n}\n.ekoshell_projectMetaData .projectInfo .title .alphaText:hover {\n  text-decoration: underline;\n}\n.ekoshell_projectMetaData .projectInfo .subTitle {\n  color: #FFFFFF;\n  font-family: var(--font-title, Stolzl-Bold, "Helvetica Neue", Helvetica, Arial, sans-serif);\n  font-size: 18px;\n  line-height: 24px;\n  padding-bottom: 5px;\n  cursor: default;\n}\n@media (orientation: landscape) {\n  .ekoshell_projectMetaData .projectInfo .subTitle {\n    max-width: 350px;\n  }\n}\n@media (min-width: 64em) {\n  .ekoshell_projectMetaData .projectInfo .subTitle {\n    font-size: 24px;\n    line-height: 30px;\n    max-width: 441px;\n  }\n}\n@media (min-width: 90.0625em) {\n  .ekoshell_projectMetaData .projectInfo .subTitle {\n    font-size: 36px;\n    line-height: 45px;\n    letter-spacing: initial;\n    max-width: 639px;\n  }\n}\n.ekoshell_projectMetaData .projectInfo .alphaText {\n  opacity: 0.4;\n  color: #FFFFFF;\n  font-weight: 500;\n  font-size: 18px;\n  line-height: 22px;\n  white-space: nowrap;\n}\n@media (min-width: 64em) {\n  .ekoshell_projectMetaData .projectInfo .alphaText {\n    font-size: 20px;\n    line-height: 24px;\n    letter-spacing: initial;\n  }\n}\n.ekoshell_projectMetaData .projectInfo .icon {\n  height: 26px;\n  margin-right: 8px;\n  vertical-align: middle;\n}\n.ekoshell_projectMetaData .projectInfo .icon .st0 {\n  opacity: 0.1;\n  fill-rule: evenodd;\n  clip-rule: evenodd;\n  fill: #FFFFFF;\n}\n.ekoshell_projectMetaData .projectInfo .icon .st1 {\n  opacity: 0.75;\n  fill: #FFFFFF;\n}\n.ekoshell_projectMetaData .projectInfo .estTime {\n  padding-bottom: 15px;\n  cursor: default;\n  font-family: var(--font-paragraph, Montserrat, sans-serif);\n  font-weight: 500;\n}\n@media (max-width: 26.25em) and (orientation: landscape) {\n  .ekoshell_projectMetaData .projectInfo .estTime {\n    display: none;\n  }\n}\n.ekoshell_projectMetaData .projectInfo .estTime.alphaText {\n  font-size: 18px;\n  line-height: 22px;\n}\n.ekoshell_projectMetaData .projectInfo .startOver,\n.ekoshell_projectMetaData .projectInfo .credits {\n  padding: 0;\n  margin: 0;\n  background-color: transparent;\n  border: 0;\n  cursor: pointer;\n  font-family: var(--font-paragraph, Montserrat, sans-serif);\n  align-items: start;\n  padding-bottom: 15px;\n  cursor: pointer;\n  font-size: 18px;\n}\n.ekoshell_projectMetaData .projectInfo .startOver:hover span,\n.ekoshell_projectMetaData .projectInfo .credits:hover span {\n  opacity: 1;\n}\n.ekoshell_projectMetaData .projectInfo .credits {\n  padding: 0;\n  margin: 0;\n  background-color: transparent;\n  border: 0;\n  cursor: pointer;\n}\n@media (max-width: 26.25em) and (orientation: landscape) {\n  .ekoshell_projectMetaData .projectInfo .credits {\n    display: none;\n  }\n}\n.ekoshell_projectMetaData .buttonRow {\n  position: absolute;\n  display: flex;\n  top: 20px;\n  right: 23.5px;\n}\n.ekoshell_projectMetaData .buttonRow > * {\n  height: 28px;\n  margin-right: 16px;\n}\n.ekoshell_projectMetaData .buttonRow > *:last-child {\n  margin-right: 0;\n}\n@media (min-width: 40.0625em) and (min-height: 30em) {\n  .ekoshell_projectMetaData .buttonRow {\n    top: 40px;\n    right: 40px;\n  }\n  .ekoshell_projectMetaData .buttonRow > * {\n    right: 40px;\n  }\n}');var sP,aP,lP,cP,uP={PROJECTMETADATA_BACK_CLICKED:"ekoshell.metadata.back",PROJECTMETADATA_REPLAY_CLICKED:"ekoshell.metadata.startover",PROJECTMETADATA_CREDITS_CLICKED:"ekoshell.metadata.credits"},dP={component:function(e){let t=e.player,n=e.isPaused,i=e.useContainer("ProjectMetaData_buttonRow"),r=(o=Math.round((e.watchTime-t.currentTime)/60))>0?o:1;var o;let s=e.watchTime,a=!!(e.showWatchTime&&s&&s>0),l={...e.backgroundColor?{background:e.backgroundColor}:null},c=!1===e.enabled||null,u=c?-1:null;return Ig.createElement(VE,{in:n,classNames:"ekoshell_projectMetaData",unmountOnExit:!0,timeout:{enter:0,exit:300}},Ig.createElement("div",{className:"ekoshell_projectMetaData",onClick:e.api.hide,style:l},Ig.createElement("div",{className:"projectInfo"},e.showBackButton&&e.showTitle&&Ig.createElement(WE,null,Ig.createElement("button",{className:"title",onClick:t=>e.api.onClickBackButton(t,e.showBackButton),"aria-label":"Back to show description","aria-hidden":c,tabIndex:u},Ig.createElement("svg",{className:"icon",viewBox:"0 0 26 26"},Ig.createElement("path",{className:"st0",d:"M13,0L13,0c7.2,0,13,5.8,13,13l0,0c0,7.2-5.8,13-13,13l0,0C5.8,26,0,20.2,0,13l0,0C0,5.8,5.8,0,13,0z"}),Ig.createElement("path",{className:"st1",d:"M7.2,13.5l4.1,4.3c0.5,0.5,1.2-0.3,0.7-0.8L9,13.8c-0.1-0.1-0.1-0.2,0.1-0.2h9.4c0.3,0,0.5-0.2,0.5-0.6c0-0.3-0.2-0.6-0.5-0.6H9c-0.1,0-0.2-0.1-0.1-0.2L12.1,9c0.5-0.5-0.2-1.3-0.7-0.8l-4.1,4.3C6.9,12.8,6.9,13.2,7.2,13.5z"})),Ig.createElement("span",{className:"alphaText"},e.backButtonTitle))),e.showSubtitle&&Ig.createElement("div",{className:"subTitle"},e.projectTitle),a&&Ig.createElement("div",{className:"estTime alphaText"},"About ",r+(r>1?" minutes":" minute")," left to play"),e.showStartOver&&Ig.createElement(WE,null,Ig.createElement("button",{className:"startOver",onClick:e.api.startOver,"aria-label":"Start over","aria-hidden":c,tabIndex:u},Ig.createElement("svg",{className:"icon",viewBox:"0 0 26 26"},Ig.createElement("path",{className:"st0",d:"M13,0L13,0c7.2,0,13,5.8,13,13l0,0c0,7.2-5.8,13-13,13l0,0C5.8,26,0,20.2,0,13l0,0C0,5.8,5.8,0,13,0z"}),Ig.createElement("path",{className:"st1",d:"M13.9,6.5c1.6,0,3.2,0.7,4.3,1.9C19.4,9.6,20,11.3,20,13c0,1.7-0.6,3.4-1.8,4.6c-1.2,1.2-2.7,1.9-4.3,1.9c-1,0-1.9-0.2-2.8-0.7c-0.3-0.2-0.4-0.5-0.3-0.8c0.1-0.3,0.5-0.4,0.8-0.3c0.7,0.4,1.5,0.6,2.3,0.6c1.3,0,2.6-0.6,3.5-1.5c0.9-1,1.5-2.3,1.5-3.7c0-1.4-0.5-2.7-1.5-3.7c-0.9-1-2.2-1.5-3.5-1.5c-1.3,0-2.6,0.6-3.5,1.5c-0.8,0.8-1.3,2-1.4,3.1l0.8-0.8c0.2-0.2,0.6-0.2,0.8,0c0.2,0.2,0.2,0.6,0,0.9l-1.8,1.9c-0.1,0.1-0.3,0.2-0.4,0.2c-0.2,0-0.3-0.1-0.4-0.2l-1.8-1.9c-0.2-0.2-0.2-0.6,0-0.9c0.2-0.2,0.6-0.2,0.8,0l0.7,0.8c0.1-1.5,0.8-2.9,1.8-4C10.7,7.2,12.2,6.5,13.9,6.5z"})),Ig.createElement("span",{className:"alphaText"},"Start over"))),e.showCredits&&Ig.createElement(WE,null,Ig.createElement("button",{className:"credits",onClick:t=>e.api.onClickCredits(t,e.showCredits),"aria-label":"Credits","aria-hidden":c,tabIndex:u},Ig.createElement("svg",{className:"icon",viewBox:"0 0 26 26"},Ig.createElement("path",{className:"st0",d:"M13,0L13,0c7.2,0,13,5.8,13,13l0,0c0,7.2-5.8,13-13,13l0,0C5.8,26,0,20.2,0,13l0,0C0,5.8,5.8,0,13,0z"}),Ig.createElement("path",{className:"st1",d:"M13,20c-3.9,0-7-3.1-7-7s3.1-7,7-7s7,3.1,7,7S16.9,20,13,20z M13,19c3.3,0,6-2.7,6-6s-2.7-6-6-6s-6,2.7-6,6S9.7,19,13,19z M12.4,10.5c0-0.8,1.3-0.8,1.3,0C13.6,11.3,12.4,11.3,12.4,10.5z M13,16.8c-0.4,0-0.6-0.2-0.6-0.4v-3.6c0-0.2,0.3-0.4,0.6-0.4s0.6,0.2,0.6,0.4v3.6C13.6,16.6,13.4,16.8,13,16.8z"})),Ig.createElement("span",{className:"alphaText"},"Credits")))),Ig.createElement("div",{className:"buttonRow"},i)))},api:function({player:e}){return{hide:function(){e.ekoshell.ControlsOverlay.hide(),e.paused&&e.play()},startOver:function(t){t.stopPropagation(),e.control.replay(),e.ekoshell.ControlsOverlay.hide(),e.trigger(uP.PROJECTMETADATA_REPLAY_CLICKED)},onClickBackButton:function(t,n){t.stopPropagation();let i=n.linkout;e.trigger(uP.PROJECTMETADATA_BACK_CLICKED),e.trigger("ekoshell.back",{target:i?"_blank":"_self",url:n.pageUrl})},onClickCredits:function(t,n){t.stopPropagation(),e.urls.open(n,"_blank"),e.trigger(uP.PROJECTMETADATA_CREDITS_CLICKED)}}},mapStateToProps:function(e){return{isPaused:e.player.isPaused}},mapEkoContextToProps:function({pluginOptions:e,ctx:t}){let n=t.environment.isEkoApp,i=e.addons.projectmetadata;return{watchTime:e.projectInfo.watchTimeSeconds,showShareButton:e.addons.sharebutton,showCredits:i.creditsUrl,showWatchTime:void 0===i.watchTime||i.watchTime,showTitle:void 0===i.title||i.title,showSubtitle:void 0===i.subtitle||i.subtitle,showStartOver:void 0===i.startOver||i.startOver,backgroundColor:i.background,projectTitle:e.projectInfo.title,showBackButton:e.addons.backButton||n,backButtonTitle:e.addons.backButton.title,isEkoApp:n}},events:uP};function hP(){if(cP)return lP;cP=1;var e=(aP||(aP=1,sP=function(){var e=document.getSelection();if(!e.rangeCount)return function(){};for(var t=document.activeElement,n=[],i=0;i<e.rangeCount;i++)n.push(e.getRangeAt(i));switch(t.tagName.toUpperCase()){case"INPUT":case"TEXTAREA":t.blur();break;default:t=null}return e.removeAllRanges(),function(){"Caret"===e.type&&e.removeAllRanges(),e.rangeCount||n.forEach((function(t){e.addRange(t)})),t&&t.focus()}}),sP),t={"text/plain":"Text","text/html":"Url",default:"Text"};return lP=function(n,i){var r,o,s,a,l,c,u=!1;i||(i={}),r=i.debug||!1;try{if(s=e(),a=document.createRange(),l=document.getSelection(),(c=document.createElement("span")).textContent=n,c.style.all="unset",c.style.position="fixed",c.style.top=0,c.style.clip="rect(0, 0, 0, 0)",c.style.whiteSpace="pre",c.style.webkitUserSelect="text",c.style.MozUserSelect="text",c.style.msUserSelect="text",c.style.userSelect="text",c.addEventListener("copy",(function(e){e.stopPropagation(),i.format&&(e.preventDefault(),void 0===e.clipboardData?(r&&console.warn("unable to use e.clipboardData"),r&&console.warn("trying IE specific stuff"),window.clipboardData.clearData(),window.clipboardData.setData(t[i.format]||t.default,n)):(e.clipboardData.clearData(),e.clipboardData.setData(i.format,n))),i.onCopy&&(e.preventDefault(),i.onCopy(e.clipboardData))})),document.body.appendChild(c),a.selectNodeContents(c),l.addRange(a),!document.execCommand("copy"))throw new Error("copy command was unsuccessful");u=!0}catch(e){r&&console.error("unable to copy using execCommand: ",e),r&&console.warn("trying IE specific stuff");try{window.clipboardData.setData(i.format||"text",n),i.onCopy&&i.onCopy(window.clipboardData),u=!0}catch(e){r&&console.error("unable to copy using clipboardData: ",e),r&&console.error("falling back to prompt"),o=function(e){var t=(/mac os x/i.test(navigator.userAgent)?"":"Ctrl")+"+C";return e.replace(/#{\s*key\s*}/g,t)}("message"in i?i.message:"Copy to clipboard: #{key}, Enter"),window.prompt(o,n)}}finally{l&&("function"==typeof l.removeRange?l.removeRange(a):l.removeAllRanges()),c&&document.body.removeChild(c),s()}return u},lP}var pP,fP,gP,mP=r(hP()),yP={};var vP=function(){if(gP)return fP;gP=1;var e=function(){if(pP)return yP;pP=1,Object.defineProperty(yP,"__esModule",{value:!0}),yP.CopyToClipboard=void 0;var e=n(Rg),t=n(hP());function n(e){return e&&e.__esModule?e:{default:e}}function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function o(e){return o=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},o(e)}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function a(e,t){return a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},a(e,t)}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var c=function(n){function c(){var n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c);for(var a=arguments.length,u=new Array(a),d=0;d<a;d++)u[d]=arguments[d];return r=function(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?s(e):t}(this,(n=o(c)).call.apply(n,[this].concat(u))),l(s(r),"onClick",(function(n){var i=r.props,o=i.text,s=i.onCopy,a=i.options,l=e.default.Children.only(i.children),c=(0,t.default)(o,a);s&&s(o,c),l&&l.props&&"function"==typeof l.props.onClick&&l.props.onClick(n)})),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(c,n),u=[{key:"render",value:function(){var t=this.props,n=t.children,i=function(e,t){if(null==e)return{};var n,i,r=function(e,t){if(null==e)return{};var n,i,r={},o=Object.keys(e);for(i=0;i<o.length;i++)t.indexOf(n=o[i])>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)t.indexOf(n=o[i])>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}(t,["text","onCopy","options","children"]),o=e.default.Children.only(n);return e.default.cloneElement(o,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(n,!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},i,{onClick:this.onClick}))}}],u&&function(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}(c.prototype,u),c;var u}(e.default.PureComponent);return yP.CopyToClipboard=c,l(c,"defaultProps",{onCopy:void 0,options:void 0}),yP}().CopyToClipboard;return e.CopyToClipboard=e,fP=e}(),bP=r(vP);By(':global(.animate-shareScreen-enter) {\n  opacity: 0;\n  pointer-events: none;\n}\n\n:global(.animate-shareScreen-exit), :global(.animate-shareScreen-enter-active), :global(.animate-shareScreen-enter-done) {\n  opacity: 1;\n  pointer-events: auto;\n}\n\n:global(.animate-shareScreen-exit-active) {\n  opacity: 0;\n  pointer-events: none;\n}\n\n.share-container {\n  width: 100%;\n  height: 100%;\n  background: linear-gradient(175deg, rgb(129, 39, 251) 10%, rgba(69, 28, 195, 0.8) 100%);\n  top: 0;\n  left: 0;\n  position: absolute;\n  z-index: 8000;\n  transition: all 0.2s;\n  -webkit-user-select: none;\n}\n.share-container .closeX {\n  padding: 0;\n  margin: 0;\n  background-color: transparent;\n  border: 0;\n  cursor: pointer;\n  width: 15px;\n  position: Absolute;\n  top: 26px;\n  right: 22px;\n  cursor: pointer;\n}\n@media (min-width: 40.0625em) {\n  .share-container .closeX {\n    top: 20px;\n    right: 20px;\n  }\n}\n.share-container .closeX svg {\n  fill: #fff;\n}\n.share-container .shareWrapper {\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  top: 0;\n  left: 0;\n}\n@media (min-width: 40.0625em) {\n  .share-container .shareWrapper {\n    height: 268px;\n    width: 476px;\n    left: 50%;\n    top: 50%;\n    transform: translate(-50%, -50%);\n    background: rgba(0, 0, 0, 0.63);\n  }\n}\n.share-container .share {\n  position: Absolute;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n}\n.share-container .share {\n  max-width: 390px;\n  width: 80%;\n}\n.share-container .share .linkContainer {\n  position: relative;\n  cursor: pointer;\n}\n.share-container .share .title {\n  color: #FFFFFF;\n  font-family: var(--font-title, Stolzl-Bold, "Helvetica Neue", Helvetica, Arial, sans-serif);\n  font-size: 12px;\n  line-height: 18px;\n  margin-bottom: 15px;\n}\n@media (min-width: 40.0625em) {\n  .share-container .share .title {\n    font-size: 18px;\n  }\n}\n.share-container .share .input {\n  background: transparent;\n  border: 1px solid #46f5c3;\n  width: 100%;\n  padding: 15px;\n  font-size: 15px;\n  line-height: 19px;\n  text-align: center;\n  font-family: var(--font-paragraph, Montserrat, sans-serif);\n  color: #fff;\n  cursor: pointer;\n  display: none;\n  box-sizing: border-box;\n}\n@media (min-width: 29.75em) {\n  .share-container .share .input {\n    display: block;\n  }\n}\n.share-container .share .input:hover {\n  background-color: #46f5c3;\n}\n.share-container .share .input.mobile {\n  display: block;\n}\n@media (min-width: 29.75em) {\n  .share-container .share .input.mobile {\n    display: none;\n  }\n}\n.share-container .share .linkLabel {\n  font-family: var(--font-title, Stolzl-Bold, "Helvetica Neue", Helvetica, Arial, sans-serif);\n  color: #fff;\n  font-size: 12px;\n  display: none;\n  margin-bottom: 15px;\n}\n@media (min-width: 29.75em) {\n  .share-container .share .linkLabel {\n    display: block;\n  }\n}\n.share-container .share .copied {\n  color: #fff;\n  font-family: var(--font-paragraph, Montserrat, sans-serif);\n  font-size: 15px;\n  line-height: 18px;\n  transition: all 0.2s;\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  background: #46f5c3;\n  text-align: center;\n  top: 0;\n  left: 0;\n  pointer-events: none;\n  opacity: 0;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n.share-container .share .copied.visible {\n  opacity: 1;\n  pointer-events: auto;\n}\n.share-container .share .shareButtonsContainer {\n  width: 100%;\n  height: 51px;\n  margin-top: 15px;\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between;\n}\n.share-container .share .shareButtonsContainer .shareButton {\n  padding: 0;\n  margin: 0;\n  background-color: transparent;\n  border: 0;\n  cursor: pointer;\n  width: 48%;\n  height: 100%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  color: white;\n  border: 1px solid;\n  font-size: 15px;\n  font-family: var(--font-paragraph, Montserrat, sans-serif);\n  font-weight: bold;\n  cursor: pointer;\n  box-sizing: border-box;\n}\n.share-container .share .shareButtonsContainer .shareButton.facebook {\n  border-color: #1877F2;\n}\n.share-container .share .shareButtonsContainer .shareButton.facebook:hover {\n  background-color: var(--highlight-color, #1877F2);\n}\n.share-container .share .shareButtonsContainer .shareButton.twitter {\n  border-color: #1DA1F2;\n}\n.share-container .share .shareButtonsContainer .shareButton.twitter:hover {\n  background-color: var(--highlight-color, #1DA1F2);\n}\n.share-container .share .shareButtonsContainer .shareButton img {\n  margin-right: 6px;\n}');var wP={SHARESCREEN_OPEN:"ekoshell.menu.share.open",SHARESCREEN_CLOSE:"ekoshell.menu.share.close",SHARESCREEN_PLATFORM:"ekoshell.menu.share.platform",SHARESCREEN_COPY:"ekoshell.menu.share.copy"};function kP(){return kP=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},kP.apply(this,arguments)}function xP(){return xP=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},xP.apply(this,arguments)}const SP={facebook:({styles:e={},...t})=>Ig.createElement("svg",kP({width:"20",height:"20",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink"},t),Ig.createElement("defs",null,Ig.createElement("path",{id:"a",d:"M.001 0H20V19.88H.001z"})),Ig.createElement("g",{fill:"none",fillRule:"evenodd"},Ig.createElement("g",null,Ig.createElement("mask",{id:"b",fill:"#fff"},Ig.createElement("use",{xlinkHref:"#a"})),Ig.createElement("path",{d:"M20 10c0-5.523-4.477-10-10-10S0 4.477 0 10c0 4.991 3.657 9.128 8.438 9.879V12.89h-2.54V10h2.54V7.797c0-2.506 1.492-3.89 3.777-3.89 1.094 0 2.238.195 2.238.195v2.46h-1.26c-1.243 0-1.63.771-1.63 1.562V10h2.773l-.443 2.89h-2.33v6.989C16.343 19.129 20 14.99 20 10",fill:"#1877F2",mask:"url(#b)"})),Ig.createElement("path",{d:"M13.893 12.89l.443-2.89h-2.774V8.124c0-.79.388-1.562 1.63-1.562h1.261v-2.46s-1.144-.196-2.238-.196c-2.285 0-3.777 1.385-3.777 3.89V10h-2.54v2.89h2.54v6.989a10.075 10.075 0 003.124 0V12.89h2.33",fill:"#FFF"}))),twitter:({styles:e={},...t})=>Ig.createElement("svg",xP({width:"20",height:"20",xmlns:"http://www.w3.org/2000/svg"},t),Ig.createElement("g",{fill:"none",fillRule:"evenodd"},Ig.createElement("circle",{cx:"10",cy:"10",r:"10",fill:"#1DA1F2"}),Ig.createElement("path",{d:"M8.17 15.275c4.435 0 6.86-3.675 6.86-6.86 0-.105 0-.21-.005-.31.47-.34.88-.765 1.205-1.25-.43.19-.895.32-1.385.38.5-.3.88-.77 1.06-1.335-.465.275-.98.475-1.53.585a2.411 2.411 0 00-4.105 2.2 6.84 6.84 0 01-4.97-2.52c-.205.355-.325.77-.325 1.21A2.4 2.4 0 006.05 9.38a2.368 2.368 0 01-1.09-.3v.03c0 1.17.83 2.14 1.935 2.365a2.403 2.403 0 01-1.09.04 2.407 2.407 0 002.25 1.675 4.847 4.847 0 01-3.57.995 6.717 6.717 0 003.685 1.09",fill:"#FFF"})))};var CP="SHOW",_P="HIDE",EP={component:function(e){let t=e.useAddonSelector((e=>e.showOverlay)),n=e.useAddonSelector((e=>e.projectLink));const[i,r]=Ig.useState(!1);let{isTouchEnabled:o,sharePlatforms:s}=e,a=Ig.createElement("svg",{viewBox:"0 0 40 40"},Ig.createElement("polygon",{points:"6.31 40 20 26.31 33.69 40 40 33.69 26.31 20 40 6.31 33.69 0 20 13.69 6.31 0 0 6.31 13.69 20 0 33.69 6.31 40"}));const l=Ig.useRef(null),c=Ig.useRef(null);function u(e){l.current.blur(),c.current.blur(),r(!0),setTimeout((()=>{r(!1),e.api.hide()}),2e3),e.player.trigger(wP.SHARESCREEN_COPY)}function d(e,t){mP(e),u(t)}return Ig.useEffect((()=>{l&&l.current&&l.current.focus(),c&&c.current&&c.current.focus()}),[]),Ig.createElement(VE,{in:t,timeout:300,classNames:"animate-shareScreen",unmountOnExit:!0},Ig.createElement("div",{className:"share-container",onClick:e.api.hide},Ig.createElement("div",{className:"shareWrapper",onClick:e=>e.stopPropagation()},Ig.createElement("button",{className:"closeX",onClick:e.api.hide,"aria-label":"Close"},a),Ig.createElement("div",{className:"share"},Ig.createElement("label",{className:"linkLabel"},o?"Tap":"Click"," to copy this link"),Ig.createElement("div",{className:"linkContainer"},Ig.createElement(bP,{tabIndex:"0",text:n,onCopy:()=>{u(e)}},Ig.createElement("input",{className:"input",readOnly:!0,value:n||"",onKeyDown:t=>13===t.keyCode&&d(n,e),onFocus:e=>e.target.select(),ref:l,role:"button","aria-label":"Copy share link to clipboard"})),Ig.createElement(bP,{tabIndex:"0",text:n,onCopy:()=>{u(e)}},Ig.createElement("input",{className:"input mobile",readOnly:!0,value:"TAP TO COPY LINK",onFocus:e=>e.target.select(),ref:c,role:"button","aria-label":"Copy share link to clipboard",onKeyDown:t=>13===t.keyCode&&d(n,e)})),Ig.createElement("div",{className:i?"copied visible":"copied"},"LINK COPIED!")),s&&Ig.createElement("div",{className:"shareButtonsContainer"},s.map(((t,i)=>Ig.createElement("button",{className:`shareButton ${t.platform}`,onClick:()=>e.api.shareOnPlatform(n,t.url,t.platform),key:i,"aria-label":`Share on ${t.platform}`},Ig.createElement("img",{alt:`Share on ${t.platform}`,width:"20px",height:"20px",src:SP[t.platform]}),"Share"))))))))},reducer:rC(((e,t)=>{if(void 0===e)return{showOverlay:!1,projectLink:""};t.type===CP&&t.data&&t.data.url&&(e.showOverlay=!0,e.projectLink=t.data.url),t.type===_P&&(e.showOverlay=!1)})),init:({player:e})=>{e.on("share.fallback",(t=>{e.ekoshell.ShareScreen.show(t)})),e.tracker&&e.tracker.registerContextPacker({match:wP.SHARESCREEN_PLATFORM,schema:"iglu:com.helloeko/ekoshell_menu_share_platform/jsonschema/1-0-0",getData:function(e){return{platform:e||""}}})},api:function({player:e,dispatchAddon:t}){return{show:function(n){t({type:CP,data:n}),e.trigger(wP.SHARESCREEN_OPEN)},hide:function(){t({type:_P}),e.trigger(wP.SHARESCREEN_CLOSE)},shareOnPlatform:function(t,n,i){window.open(n.replace(/{{URL}}/g,encodeURIComponent(t)),"_blank","location=yes,height=250,width=640,scrollbars=yes,status=yes"),e.trigger(wP.SHARESCREEN_PLATFORM,i)}}},mapEkoContextToProps:function({ctx:e,pluginOptions:t}){return{isTouchEnabled:e.environment.isTouchEnabled,sharePlatforms:t.addons.sharescreen.platforms}},events:wP};By(".ekoshell_logoButton {\n  padding: 0;\n  margin: 0;\n  background-color: transparent;\n  border: 0;\n  cursor: pointer;\n  position: absolute;\n  background-size: contain;\n  background-repeat: no-repeat;\n  background-position: center;\n  width: 28px;\n  height: 19px;\n  opacity: 0.6;\n  left: 16px;\n  bottom: 23px;\n  transition: all 0.15s;\n  pointer-events: none;\n  cursor: default;\n  z-index: 2000;\n  transform: translate3d(0, 0, 0);\n}\n@media (min-width: 40.0625em) and (min-height: 30em) {\n  .ekoshell_logoButton {\n    width: 70px;\n    height: 32px;\n    left: 40px;\n    bottom: 33px;\n  }\n}\n.ekoshell_logoButton.linkable {\n  pointer-events: all;\n  cursor: pointer;\n}\n.ekoshell_logoButton.linkable:hover {\n  opacity: 1;\n}\n.ekoshell_logoButton.opaque {\n  opacity: 1;\n}\n.ekoshell_logoButton svg {\n  pointer-events: none;\n  height: 100%;\n  width: 100%;\n}\n.ekoshell_logoButton svg path {\n  fill: #fff;\n}");var TP={LOGO_CLICK:"ekoshell.button.logo"},PP={component:function(e){if(!e.interactive&&!e.alwaysShow)return null;let t=lT({ekoshell_logoButton:!0,linkable:e.linkable&&e.interactive});return Ig.createElement(WE,null,Ig.createElement("button",{className:t,onClick:e.api.click,"aria-label":"eko",disabled:!1===e.interactive},Ig.createElement("svg",{viewBox:"1.25 2.507 580.5 262.8"},Ig.createElement("path",{d:"M 395.35 76.407 L 327.25 76.407 L 270.75 166.107 L 270.75 2.507 L 212.95 2.507 L 212.95 261.007 L 263.55 261.007 L 300.35 209.507 L 337.15 261.007 L 411.15 261.007 L 334.45 161.707 L 395.35 76.407 Z M 485.05 71.907 C 431.65 71.907 388.35 115.207 388.35 168.607 C 388.35 222.007 431.65 265.307 485.05 265.307 C 538.45 265.307 581.75 222.007 581.75 168.607 C 581.85 115.207 538.55 71.907 485.05 71.907 Z M 485.05 209.707 C 463.65 209.707 446.35 192.507 446.35 168.707 C 446.35 144.907 463.65 127.607 485.05 127.607 C 506.45 127.607 523.75 144.907 523.75 168.707 C 523.75 192.407 506.45 209.707 485.05 209.707 Z M 97.95 71.907 C 44.55 71.907 1.25 115.207 1.25 168.607 C 1.25 222.007 44.55 265.307 97.95 265.307 C 139.35 265.307 174.65 239.307 188.45 202.707 L 129.65 202.707 C 123.55 209.907 115.75 215.007 98.45 215.007 C 80.35 215.007 65.75 205.507 59.15 186.807 L 192.95 186.807 C 194.05 180.907 194.65 174.807 194.65 168.607 C 194.65 115.207 151.35 71.907 97.95 71.907 Z M 59.15 150.407 C 65.35 133.007 80.35 122.607 97.95 122.607 C 115.55 122.607 130.65 133.007 136.75 150.407 L 59.15 150.407 Z"}))))},api:function({player:e,pluginOptions:t}){return{click:function(){let n=t.addons.ekologo.url;n?(e.urls.open(n,t&&t.addons&&t.addons.ekologo.linkout?"_blank":"_self",{role:"helloeko"}),e.trigger(TP.LOGO_CLICK)):e.debug&&console.warn("Ekoshell: LogoButton - Url is missing")}}},mapStateToProps:function(e){return{interactive:e.ekoshell.ControlsOverlay.showControlsOverlay}},mapEkoContextToProps:function({pluginOptions:e}){return{linkable:e.addons.ekologo.url,alwaysShow:void 0===e.addons.ekologo.alwaysShow||e.addons.ekologo.alwaysShow}},events:TP};By(".CustomActionButton {\n  cursor: pointer;\n  height: 100%;\n  background: transparent;\n  padding: 0;\n  margin: 0;\n  border: 0;\n  min-width: 27px;\n}\n.CustomActionButton img {\n  height: 27px;\n}\n.CustomActionButton {\n  pointer-events: all;\n}");var IP={CUSTOMACTIONBTN_CLICK:"ekoshell.button.customactionbutton"};let AP=null;function OP(){AP=!1}var LP,NP,RP,DP,MP={init:({player:e})=>{e.tracker&&e.tracker.registerContextPacker({match:IP.CUSTOMACTIONBTN_CLICK,schema:"iglu:com.helloeko/ekoshell_menu_button_customactionbutton/jsonschema/1-0-0",getData:function(e){return{id:e||""}}})},component:function(e){let t=Pg.useRef();Pg.useEffect((()=>(AP&&AP.parentContainer===e.parentContainer&&AP.order===e.order&&t.current.focus(),()=>{document.activeElement===t.current&&(AP={parentContainer:e.parentContainer,order:e.order,id:e.addonId})})),[]);let n=e.options?e.options.label:void 0;return React.createElement(WE,null,React.createElement("button",{className:"CustomActionButton","data-button-id":e.addonId,onClick:t=>function(e,t){t.player.trigger("ekoshell.buttonClicked",{id:t.addonId}),t.player.trigger(IP.CUSTOMACTIONBTN_CLICK,t.addonId),e.preventDefault(),e.stopPropagation()}(t,e),"aria-label":n||"button",role:"button",ref:t,onBlur:OP},React.createElement("img",{className:"hoverPath",src:e.icon,alt:n||""})))},events:IP};function FP(){return NP?LP:(NP=1,LP={1:{2:{"components.fullscreenButton":"addons.fullscreenbutton","components.fullscreenButton.location":"addons.fullscreenbutton.parentContainer","components.subtitlesButton":"addons.subtitlesbutton","components.subtitlesButton.location":"addons.subtitlesbutton.parentContainer","components.shareButton":"addons.sharebutton","components.shareButton.location":"addons.sharebutton.parentContainer","components.volumeButton":"addons.volumebutton","components.volumeButton.location":"addons.volumebutton.parentContainer","components.customButtons":"addons.custombuttons","components.transport":"addons.controlsoverlay","components.sharePlatforms":"addons.sharescreen.platforms","components.backButton":"addons.backButton","components.backButton.location":"addons.backButton.parentContainer","components.pauseScreen":"addons.projectmetadata","components.pauseScreen.location":"addons.projectmetadata.parentContainer","components.feedback":"addons.feedback","components.feedback.location":"addons.feedback.parentContainer","components.logoButton":"addons.ekologo",projectInfo:"projectInfo",theme:"theme"}}})}var BP=function(){if(DP)return RP;let e,t;DP=1;const n=FP();return RP={ekoshellToLatest:function(i,r){try{let o=i.version||1,s=r||Object.keys(n[o]).slice(-1)[0],a=function(n,i){let r={};return Object.keys(n).forEach((o=>{let s=e(i,o);null!=s&&t(r,n[o],s)})),r}(n[o][s],i);return 1!==s&&a.addons.custombuttons&&a.addons.custombuttons.forEach((e=>{void 0!==e.location&&(e.parentContainer=e.location,"topRight"===e.parentContainer&&(e.parentContainer="ProjectMetaData_buttonRow"),delete e.location),void 0!==e.order&&void 0!==e.icon&&(e.config={order:e.order,icon:e.icon},delete e.order,delete e.icon)})),a}catch(e){throw e.message=`Failed to convert from ekoshell v${r} to ekoshell v${r}. ${e.message}`,e}},initWithPluginCtx:function(n){e=n.getObjectProperty,t=n.setObjectProperty}},RP}(),UP=r(BP);function jP(e,t){"topRight"===t&&(t="ProjectMetaData_buttonRow"),EC.updateAddOnLocation(e,t)}function zP(e,t){let n=t;"topRight"===t&&(n="ProjectMetaData_buttonRow"),"bottomRight"===t&&(n="ControlsOverlay_buttonRow"),uC().player.debug&&console.warn("ekoshell: setButtonLocation is deprecated. Use setParentContainer instead"),jP(e,n)}InterludePlayer&&InterludePlayer.registerPlugin?InterludePlayer.registerPlugin("ekoshell",(function(e,t){e.player.ekoshell={addons:{},addAddon:EC.add,getAddon:EC.get,getAllAddons:EC.getAll,setButtonLocation:zP,setParentContainer:jP};let n=t;UP.initWithPluginCtx(e),e.environment.queryParams.useEkoShell2&&(n=UP.ekoshellToLatest(t));const i=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new(0,i_.constructor)(i_.SchedulerAction),n=new QC,i=void 0,r=function(r){i=r;var o=(new QC).pipe(d_(t)),s=(new QC).pipe(d_(t)),a=new vE(o),l=new bE(s,i.getState()),c=n.pipe(C_((function(t){var n="dependencies"in e?t(a,l,e.dependencies):t(a,l);if(!n)throw new TypeError('Your root Epic "'+(t.name||"<anonymous>")+"\" does not return a stream. Double check you're not missing a return statement!");return n})),B_((function(e){return R_(e).pipe(function(e,t){return void 0===t&&(t=0),function(n){return n.lift(new iE(e,t))}}(t),d_(t))})));return c.subscribe(i.dispatch),function(e){return function(t){var n=e(t);return s.next(i.getState()),o.next(t),n}}};return r.run=function(e){n.next(e)},r}();e.player.addReduxMiddleware(i),lC({ctx:e,pluginOptions:n,epicMiddleware:i}),EC.add("ClickCatcher",PE),EC.add("EkoshellRoot",TE),EC.add("ProjectMetaData",dP),EC.add("EkoLogo",PP),EC.add("ControlsOverlay",qT),EC.add("WaitingIndication",oP),EC.add("SeekIndication",eP),EC.add("ShareScreen",EP),n.addons.custombuttons&&n.addons.custombuttons.forEach((e=>{let t=Object.assign({},MP);t.parentContainer=e.parentContainer,t.order=e.config.order,t.props=e.config,EC.add(e.id,t)})),n.theme&&function(e,t){EE=Object.assign(EE,t),t.font&&t.font.title&&e.ui.loadWebFont({source:"GoogleFonts",name:t.font.title}),t.font&&t.font.paragraph&&e.ui.loadWebFont({source:"GoogleFonts",name:t.font.paragraph})}(e.player,n.theme)}),{autoInit:!1,version:"1.0.0",deps:[{name:"ui"},{name:"storage",optional:"orderonly"},{name:"end",optional:"orderonly"},{name:"overlays",optional:"orderonly"},{name:"ekoplaybutton",optional:"orderonly"},{name:"tracker",optional:"orderonly"}],redux:{reducer:TC}}):console&&console.error&&console.error("Could not register ekoshell plugin");var VP={isRequired:function(e,t,n){var i,r;const o=(null==n?void 0:n.data)||{},s=(null==o||null===(i=o.settings)||void 0===i||null===(i=i.backgroundMusic)||void 0===i||null===(i=i.soundtrack)||void 0===i?void 0:i.length)>0,a=null==o||null===(r=o.logic)||void 0===r?void 0:r.reduce(((e,t)=>[...e,...t.actions]),[]),l=null==a?void 0:a.some((e=>"audio.play"===e.type));return s||l},load:async function(e,t={}){await import("../audio-OojCV8Xl.js").then((function(e){return e.a})),e.initPlugin("audio",t)}},WP={isRequired:async function(e){return!!await e.get("debug")},load:async function(e,t={}){await import("../debug-DE6yNJtN.js").then((function(e){return e.d})),e.initPlugin("debug",{extra:"delivery-app v1.0.379",...t})}},HP={isRequired:async function(e){return!!await e.get("profiler")},load:async function(e,t={}){await import("../profiler-CKSZfKXX.js").then((function(e){return e.p})),e.initPlugin("profiler",t)}};const $P=new Promise((()=>{}));var GP={isRequired:async function(e,t){var n;const i=null===(n=window)||void 0===n||null===(n=n.InterludePlayer)||void 0===n||null===(n=n.environment)||void 0===n?void 0:n.queryParams;if(null!=i&&i.subtitles)return!0;const r=t.repository.get("all"),o=r.filter((e=>null==e?void 0:e.isResolved)),s=r.filter((e=>!(null!=e&&e.isResolved)));return!!(o.length>0&&o.some((e=>{var t;return!(null==e||null===(t=e.data)||void 0===t||!t.subtitles)})))||(a=s.map((async e=>{var t,n;return await(null==e||null===(t=e.segment)||void 0===t?void 0:t.getResolvePromise()),!(null==e||null===(n=e.data)||void 0===n||!n.subtitles)})),Promise.race([Promise.race(a.map((async e=>!!await e||$P))),Promise.all(a).then((e=>e.some(Boolean)))]));var a},load:async function(e,t={}){await import("../subtitles-whXXaUPg.js").then((function(e){return e.s})),e.initPlugin("subtitles",t)}},qP=Object.freeze({__proto__:null,audio:VP,debug:WP,profiler:HP,subtitles:GP});const YP=()=>{},KP=["trace","log","debug","info","warn","error","getLevel","setLevel"],XP=["trace","debug","info","warn","error","silent"],QP={TRACE:"color: white; background-color: magenta;",DEBUG:"color: black; background-color: turquoise;",INFO:"color: white; background-color: green;",WARN:"color: black; background-color: yellow;",ERROR:"color: white; background-color: red;"},ZP="undefined"!=typeof self&&self||"undefined"!=typeof window&&window||void 0!==e&&e;let JP={level:"trace",appName:""},eI=[];const tI="object"==typeof ZP&&ZP.performance&&"function"==typeof ZP.performance.now?ZP.performance.now.bind(ZP.performance):Date.now.bind(Date),nI=e=>e&&"string"==typeof e?e.toLowerCase().trim():"",iI=(()=>{try{const e=new URLSearchParams(document.location.search),t=[].concat(e.getAll("log")).concat(e.getAll("ekolog")).concat(e.getAll("ekologger")).join(",").split(",");if(0===t.length)return{};let n={};return t.forEach((e=>{const[t,i]=e.split(":");n[nI(t)]=nI(i)||"trace"})),n}catch(e){return{}}})(),rI=(e,t="")=>{const n=nI(e),i=T.getLogger(n);if(i.__ekologger)return i.__ekologger;t||iI[n]||iI["*"]||(i.__noExplicitLevel=!0);const r=i.methodFactory;i.methodFactory=(t,n,i)=>{const o=r(t,n,i),s=t.toUpperCase();return(...t)=>{o(`[${((e,t=3)=>(tI()/1e3).toFixed(t))()}] %c[${s}] ${JP.appName?`[${JP.appName}] `:""}[${e}]`,QP[s],...t)}},i.setLevel(t=iI[n]||iI["*"]||t||JP.level,!1);const o=(...e)=>i.log(...e);return KP.forEach((e=>{o[e]=(...t)=>(eI.forEach((n=>{n[e](...t)})),i[e](...t))})),i.__ekologger=o,o};rI.setDefaults=({appName:e="",level:t})=>{e&&"string"==typeof e&&(JP.appName=e),(t=nI(t))&&XP.includes(t)&&(JP.level=t,Object.values(T.getLoggers()).filter((e=>e.__noExplicitLevel)).forEach((e=>e.setLevel(JP.level,!1))))},rI.installDriver=e=>{const t={...KP.reduce(((t,n)=>(t[n]="function"==typeof(null==e?void 0:e[n])?e[n]:YP,t)),{})};eI.push(t)};var oI={};const sI={Square:"square","Rounded Corners":"rounded","Pill Shape":"pill"},aI={Intro:function(e){let t={...e};return t.loop={video:t.video},delete t.video,t},Menu:function(e){let t={...e};return t.options.forEach((e=>{e.name=e.text,delete e.text})),t},MultipleChoice:function(e){let t={...e};return t.introVideo=t.intro,delete t.intro,t.mainVideo=t.video,delete t.video,t.options.forEach((e=>{e.name=e.text,delete e.text,e.video&&(e.loopVideo=e.video,delete e.video)})),t.multipleAnswers=t.multipleChoice,delete t.multipleChoice,t.nextButtonText=t.selectButtonLabel,delete t.selectButtonLabel,t},TwoStepMenu:function(e){let t={...e};return t.introVideo=t.intro,delete t.intro,t.mainVideo=t.video,delete t.video,t.options.forEach((e=>{e.name=e.text,delete e.text,e.video&&(e.loopVideo=e.video,delete e.video)})),t.multipleAnswers=t.multipleChoice,delete t.multipleChoice,t.nextButtonText=t.selectButtonLabel,delete t.selectButtonLabel,t},Sequence:function(e){let t={...e};return t.steps=t.items,delete t.items,t.settings={loop:e.loop,cta:e.cta},delete t.loop,t},Video:function(e){let t={...e};return t.showSkipButton&&(t.skipButton={text:t.skipButtonLabel}),delete t.showSkipButton,delete t.skipButtonLabel,t},Products:function(e){let t={...e};return t.introVideo=t.intro,delete t.intro,t.loopVideo=t.video,delete t.video,t}};function lI(e){let t={};return e.forEach((e=>{t[e.id]={type:e.blockType,name:e.name,config:aI[e.blockType]?aI[e.blockType](e.config):e.config}})),t}var cI,uI={exports:{}},dI=(cI||(cI=1,uI.exports=function(){Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)});var e={},t={"==":function(e,t){return e==t},"===":function(e,t){return e===t},"!=":function(e,t){return e!=t},"!==":function(e,t){return e!==t},">":function(e,t){return e>t},">=":function(e,t){return e>=t},"<":function(e,t,n){return void 0===n?e<t:e<t&&t<n},"<=":function(e,t,n){return void 0===n?e<=t:e<=t&&t<=n},"!!":function(t){return e.truthy(t)},"!":function(t){return!e.truthy(t)},"%":function(e,t){return e%t},log:function(e){return console.log(e),e},in:function(e,t){return!(!t||void 0===t.indexOf)&&-1!==t.indexOf(e)},cat:function(){return Array.prototype.join.call(arguments,"")},substr:function(e,t,n){if(n<0){var i=String(e).substr(t);return i.substr(0,i.length+n)}return String(e).substr(t,n)},"+":function(){return Array.prototype.reduce.call(arguments,(function(e,t){return parseFloat(e,10)+parseFloat(t,10)}),0)},"*":function(){return Array.prototype.reduce.call(arguments,(function(e,t){return parseFloat(e,10)*parseFloat(t,10)}))},"-":function(e,t){return void 0===t?-e:e-t},"/":function(e,t){return e/t},min:function(){return Math.min.apply(this,arguments)},max:function(){return Math.max.apply(this,arguments)},merge:function(){return Array.prototype.reduce.call(arguments,(function(e,t){return e.concat(t)}),[])},var:function(e,t){var n=void 0===t?null:t,i=this;if(void 0===e||""===e||null===e)return i;for(var r=String(e).split("."),o=0;o<r.length;o++){if(null==i)return n;if(void 0===(i=i[r[o]]))return n}return i},missing:function(){for(var t=[],n=Array.isArray(arguments[0])?arguments[0]:arguments,i=0;i<n.length;i++){var r=n[i],o=e.apply({var:r},this);null!==o&&""!==o||t.push(r)}return t},missing_some:function(t,n){var i=e.apply({missing:n},this);return n.length-i.length>=t?[]:i}};return e.is_logic=function(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)&&1===Object.keys(e).length},e.truthy=function(e){return!(Array.isArray(e)&&0===e.length||!e)},e.get_operator=function(e){return Object.keys(e)[0]},e.get_values=function(t){return t[e.get_operator(t)]},e.apply=function(n,i){if(Array.isArray(n))return n.map((function(t){return e.apply(t,i)}));if(!e.is_logic(n))return n;var r,o,s,a,l,c=e.get_operator(n),u=n[c];if(Array.isArray(u)||(u=[u]),"if"===c||"?:"==c){for(r=0;r<u.length-1;r+=2)if(e.truthy(e.apply(u[r],i)))return e.apply(u[r+1],i);return u.length===r+1?e.apply(u[r],i):null}if("and"===c){for(r=0;r<u.length;r+=1)if(o=e.apply(u[r],i),!e.truthy(o))return o;return o}if("or"===c){for(r=0;r<u.length;r+=1)if(o=e.apply(u[r],i),e.truthy(o))return o;return o}if("filter"===c)return a=e.apply(u[0],i),s=u[1],Array.isArray(a)?a.filter((function(t){return e.truthy(e.apply(s,t))})):[];if("map"===c)return a=e.apply(u[0],i),s=u[1],Array.isArray(a)?a.map((function(t){return e.apply(s,t)})):[];if("reduce"===c)return a=e.apply(u[0],i),s=u[1],l=void 0!==u[2]?u[2]:null,Array.isArray(a)?a.reduce((function(t,n){return e.apply(s,{current:n,accumulator:t})}),l):l;if("all"===c){if(a=e.apply(u[0],i),s=u[1],!Array.isArray(a)||!a.length)return!1;for(r=0;r<a.length;r+=1)if(!e.truthy(e.apply(s,a[r])))return!1;return!0}if("none"===c){if(a=e.apply(u[0],i),s=u[1],!Array.isArray(a)||!a.length)return!0;for(r=0;r<a.length;r+=1)if(e.truthy(e.apply(s,a[r])))return!1;return!0}if("some"===c){if(a=e.apply(u[0],i),s=u[1],!Array.isArray(a)||!a.length)return!1;for(r=0;r<a.length;r+=1)if(e.truthy(e.apply(s,a[r])))return!0;return!1}if(u=u.map((function(t){return e.apply(t,i)})),t.hasOwnProperty(c)&&"function"==typeof t[c])return t[c].apply(i,u);if(c.indexOf(".")>0){var d=String(c).split("."),h=t;for(r=0;r<d.length;r++){if(!h.hasOwnProperty(d[r]))throw new Error("Unrecognized operation "+c+" (failed at "+d.slice(0,r+1).join(".")+")");h=h[d[r]]}return h.apply(i,u)}throw new Error("Unrecognized operation "+c)},e.uses_data=function(t){var n=[];if(e.is_logic(t)){var i=e.get_operator(t),r=t[i];Array.isArray(r)||(r=[r]),"var"===i?n.push(r[0]):r.forEach((function(t){n.push.apply(n,e.uses_data(t))}))}return function(e){for(var t=[],n=0,i=e.length;n<i;n++)-1===t.indexOf(e[n])&&t.push(e[n]);return t}(n)},e.add_operation=function(e,n){t[e]=n},e.rm_operation=function(e){delete t[e]},e.rule_like=function(t,n){if(n===t)return!0;if("@"===n)return!0;if("number"===n)return"number"==typeof t;if("string"===n)return"string"==typeof t;if("array"===n)return Array.isArray(t)&&!e.is_logic(t);if(e.is_logic(n)){if(e.is_logic(t)){var i=e.get_operator(n),r=e.get_operator(t);if("@"===i||i===r)return e.rule_like(e.get_values(t,!1),e.get_values(n,!1))}return!1}if(Array.isArray(n)){if(Array.isArray(t)){if(n.length!==t.length)return!1;for(var o=0;o<n.length;o+=1)if(!e.rule_like(t[o],n[o]))return!1;return!0}return!1}return!1},e}()),uI.exports),hI=r(dI);function pI(e,{include:t,exclude:n}={}){const i=e=>{const i=t=>"string"==typeof t?e===t:t.test(e);return t?t.some(i):!n||!n.some(i)};for(const[t,n]of(e=>{const t=new Set;do{for(const n of Reflect.ownKeys(e))t.add([e,n])}while((e=Reflect.getPrototypeOf(e))&&e!==Object.prototype);return t})(e.constructor.prototype)){if("constructor"===n||!i(n))continue;const r=Reflect.getOwnPropertyDescriptor(t,n);r&&"function"==typeof r.value&&(e[n]=e[n].bind(e))}return e}const fI=rI("sauce-vendor"),gI=window.InterludePlayer.environment.queryParams._eko_sauce;let mI;function yI(){if(!gI)return;if(mI)return mI;let e=function(){try{var e;return null!==(e=new URL(gI))&&void 0!==e?e:gI}catch(e){}let t=gI.match(/^((.*)\/)?(.*)$/);return`https://play.eko.com/components/sauces/${t[2]||"main"}/${t[3]}/sauce.min.js`}();mI=import(e).then((e=>e)).catch((t=>{fI.error(`Failed to load sauce from ${e}`,t)}))}let vI={};function bI(e){return vI["string"==typeof e?e:e.id]}var wI={add:function(e,t){vI[e]=t},get:bI,has:function(e){return void 0!==bI(e)},remove:function(e){delete vI["string"==typeof e?e:e.id]}};let kI=!1;var xI,SI,CI=function(){if(SI)return xI;SI=1;var e=function(e){return function(e){return!!e&&"object"==typeof e}(e)&&!function(e){var n=Object.prototype.toString.call(e);return"[object RegExp]"===n||"[object Date]"===n||function(e){return e.$$typeof===t}(e)}(e)},t="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function n(e,t){return!1!==t.clone&&t.isMergeableObject(e)?s(Array.isArray(e)?[]:{},e,t):e}function i(e,t,i){return e.concat(t).map((function(e){return n(e,i)}))}function r(e){return Object.keys(e).concat(function(e){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e).filter((function(t){return Object.propertyIsEnumerable.call(e,t)})):[]}(e))}function o(e,t){try{return t in e}catch(e){return!1}}function s(t,a,l){(l=l||{}).arrayMerge=l.arrayMerge||i,l.isMergeableObject=l.isMergeableObject||e,l.cloneUnlessOtherwiseSpecified=n;var c=Array.isArray(a);return c===Array.isArray(t)?c?l.arrayMerge(t,a,l):function(e,t,i){var a={};return i.isMergeableObject(e)&&r(e).forEach((function(t){a[t]=n(e[t],i)})),r(t).forEach((function(r){(function(e,t){return o(e,t)&&!(Object.hasOwnProperty.call(e,t)&&Object.propertyIsEnumerable.call(e,t))})(e,r)||(a[r]=o(e,r)&&i.isMergeableObject(t[r])?function(e,t){if(!t.customMerge)return s;var n=t.customMerge(e);return"function"==typeof n?n:s}(r,i)(e[r],t[r],i):n(t[r],i))})),a}(t,a,l):n(a,l)}return s.all=function(e,t){if(!Array.isArray(e))throw new Error("first argument should be an array");return e.reduce((function(e,n){return s(e,n,t)}),{})},xI=s}(),_I=r(CI);const EI=rI("instance-data-utils","warn"),TI=rI("instance-data-utils","warn"),PI=rI("instance-data-utils","warn");function II(e){var t;const n="number"==typeof e.volume?e.volume:"number"==typeof(null==e||null===(t=e.addons)||void 0===t||null===(t=t.audio)||void 0===t?void 0:t.volume)?e.addons.audio.volume:null;return"number"!=typeof n?null:n<0||n>100?(PI.warn(`[volume] Invalid volume value, expected number in range [0, 100], instead got: ${n}`),null):{volume:n/100}}function AI(e){return!!(function(e){return!(!e||"assets-delivery-service"!==e.type||!e.assetId||"number"!=typeof e.assetRevision)}(e)||function(e){var t,n;return!!(null!=e&&e.id&&null!=e&&e.version&&null!=e&&null!==(t=e.metadata)&&void 0!==t&&t.type&&(null==e||null===(n=e.representations)||void 0===n?void 0:n.length)>0)}(e)||function(e){var t;return null==e||null===(t=e.startsWith)||void 0===t?void 0:t.call(e,"image:")}(e))}const OI=[function(e){return{source:e}},function(e){var t;const n=null==e||null===(t=e.addons)||void 0===t?void 0:t.coa;return n&&"number"==typeof n.x&&"number"==typeof n.y?n.x<0||n.x>100||n.y<0||n.y>100?(EI.warn(`[coa] Invalid COA value: ${n.x}, ${n.y}`),null):{data:{studio:{coa:[n.x/100*1920,n.y/100*1080,1920,1080]}}}:null},function(e){var t;const n=((null==e||null===(t=e.addons)||void 0===t?void 0:t.subtitles)||[]).reduce(((e,{langCode:t,asset:n})=>t&&n?(e[t]&&TI.warn(`[subtitles] Duplicate subtitle for language: ${t}.\n\tReplacing "${e[t]}" with "${n}".`),e[t]=n,e):e),{});return n&&Object.keys(n).length?{data:{subtitles:n}}:null},II,function(e){var t;return{data:{muteSoundtrack:!(null==e||null===(t=e.addons)||void 0===t||null===(t=t.audio)||void 0===t||!t.muteSoundtrack)}}},function(e){var t;const n=null==e||null===(t=e.addons)||void 0===t?void 0:t.fallbackImage;return n?{data:{fallbackImageUrl:n}}:null}];var LI={transformData:function(e){if(!AI(e))throw new Error(`[video.transformData] requires a valid video component data object, instead got: ${e}`);return _I.all(OI.map((t=>t(e))).filter(Boolean))},isValidVideoData:AI};function NI(e){return!(!e||!e.audio)}const RI=[function(e){return NI(e)?{src:e.audio}:null},II];var DI={transformData:function(e){return NI(e)?_I.all(RI.map((t=>t(e))).filter(Boolean)):null},isValidAudioData:NI};const MI=rI("instance-data-utils","warn");function FI(e,t,n={}){if(!e||"string"!=typeof e)throw new Error(`createNodeConfigObj() requires a valid node id, instead got: ${e}`);if(!LI.isValidVideoData(t))throw MI.error("createNodeConfigObj() requires a valid video component data object, instead got: ",t),new Error("createNodeConfigObj() requires a valid video component data object");const i={id:e,...LI.transformData(t),...n};return MI.info(`[createNodeConfigObj] Created node config obj for "${e}" with data:`,i),i}const BI=({node:e,animationConfig:t,initAnimation:n})=>{const i=Pg.useRef(null);return Pg.useEffect((()=>{t&&i.current&&n(t,i.current)}),[t,e]),Ig.createElement("div",{id:`animationContainer_${e.id}`,ref:i,style:t.style})};function UI(e){if(wI.has(e)){var t;const n=wI.get(e);return null!==(t=n.introNode)&&void 0!==t?t:n.mainNode}return e}let jI=class{constructor(e,t,n,i){var r,o;this.player=e;let s=FI(t,n,...i?[i]:[]);var a;if(this.mainNode=this.player.repository.add(s),null!=n&&n.addons&&null!=n&&null!==(r=n.addons)&&void 0!==r&&r.animation&&this.setAnimationUI(this.mainNode,null==n||null===(a=n.addons)||void 0===a?void 0:a.animation),null!=i&&null!==(o=i.intro)&&void 0!==o&&o.video){var l,c;let n=FI(`${t}_intro`,i.intro.video,i);this.introNode=this.player.repository.add(n),this.introNode.addPrefetch(this.mainNode),function(e,t,n){e.decision.update(t,{children:[n],defaults:[n]})}(e,this.introNode,this.mainNode),null!==(l=i.intro.video)&&void 0!==l&&l.addons&&null!==(c=i.intro.video)&&void 0!==c&&null!==(c=c.addons)&&void 0!==c&&c.animation&&this.setAnimationUI(this.introNode,i.intro.video.addons.animation)}return wI.add(this.mainNode.id,{mainNode:this.mainNode,introNode:this.introNode}),new Proxy(this,{get:function(e,t,n){return t in n?Reflect.get(e,t,n):e.mainNode[t]}})}setAnimationUI(e,t){this.player.ui.addController(`animationController_${e.id}`,"GROUP",{showInNodes:[e.id]}),this.player.ui.add(`animationContainer_${e.id}`,BI,{stateSourceId:`animationController_${e.id}`,enableTransition:!0,node:e,animationConfig:t,initAnimation:this.initAnimation})}async initAnimation(e,t){return async function(e,t,n,i={}){if(!t||"object"!=typeof t)return console.error("Invalid lottie animation data: must be a JSON object"),null;const r={container:e,renderer:"canvas",loop:!1,autoplay:!1,animationData:t},o=await import("../lottie-CZ4n8E2v.js").then((function(e){return e.l})),s=o.loadAnimation({...r,...i});return s.playSegments([n.introSegment.introSegmentStart,n.introSegment.introSegmentEnd],!0),s.addEventListener("complete",(()=>{s.playSegments([n.loopSegment.loopSegmentStart,n.loopSegment.loopSegmentEnd],!0),s.loop=!0})),s}(t,"string"==typeof e.data?await fetch(e.data).then((e=>e.json())):e.data,{introSegment:{introSegmentStart:Number(e.introSegmentStart)||0,introSegmentEnd:Number(e.introSegmentEnd)||0},loopSegment:{loopSegmentStart:Number(e.loopSegmentStart)||0,loopSegmentEnd:Number(e.loopSegmentEnd)||0}})}addPrefetch(...e){return e[0]=UI(e[0]),this.mainNode.addPrefetch(...e)}removePrefetch(...e){return e[0]=UI(e[0]),this.mainNode.removePrefetch(...e)}on(...e){return"nodestart"===e[0]&&this.introNode?this.introNode.on.apply(this.introNode,e):this.mainNode.on.apply(this.mainNode,e)}once(...e){return"nodestart"===e[0]&&this.introNode?this.introNode.once.apply(this.introNode,e):this.mainNode.once.apply(this.mainNode,e)}off(...e){return"nodestart"===e[0]&&this.introNode?this.introNode.off.apply(this.introNode,e):this.mainNode.off.apply(this.mainNode,e)}};const zI=rI("runtime-node");let VI;function WI(e){var t;return null!==(t=e.introNode)&&void 0!==t?t:e.mainNode}var HI={init:function(e){VI?zI.warn("RuntimeNode.init() was already called, ignoring..."):(VI=e,function(e){!function(e){e.origAppend=e.append,e.append=function(...t){if(wI.has(t[0])){var n;let e=wI.get(t[0]);t[0]=null!==(n=e.introNode)&&void 0!==n?n:e.mainNode}return e.origAppend.apply(this,t)}}(e),function(e){e.origSeek=e.seek,e.seek=function(...t){if(wI.has(t[0])){var n;let e=wI.get(t[0]);t[0]=null!==(n=e.introNode)&&void 0!==n?n:e.mainNode}return e.origSeek.apply(this,t)}}(e),kI=!0}(VI))},create:function(e,t,n){if(VI)return new jI(VI,e,t,n);zI.error("RuntimeNode.create() was called before RuntimeNode.init(), ignoring...")},getHeadNode:function(e){return WI(wI.get(e))},getIntroNode:function(e){return wI.get(e).introNode},getMainNode:function(e){return wI.get(e).mainNode},connectNodes:function(e,t,n){const i=wI.get(e),r=t?wI.get(t):null;VI.decision.update(i.mainNode,{children:null==n?void 0:n.map((e=>WI(wI.get(e)))),defaults:r?[WI(r)]:[]})}};const $I=rI("eko-state-manager");let GI;GI=new class{constructor(){if(GI)return GI;$I("[init]"),this.namespaceToStateFnMap={},pI(this)}register(e,t){return"function"==typeof t?(this[e]&&$I.error(`overriding state in ${e}`),((...e)=>{var t;null===(t=window)||void 0===t||null===(t=t.InterludePlayer)||void 0===t||null===(t=t.utils)||void 0===t||t.setObjectProperty(...e)})(this,e,new Proxy({},{get:function(e,n){return t()[n]}})),this.namespaceToStateFnMap[e]=t,!0):($I.error("State must be registered with a function"),!1)}get(e){let t={};return this.namespaceToStateFnMap[e]&&(t=this.namespaceToStateFnMap[e]()),t}getAll(){let e={};for(const[t,n]of Object.entries(this.namespaceToStateFnMap))e[t]=n();return e}};const qI=rI("embed-api-bridge"),YI=window.InterludePlayer.utils,KI=["undefined","number","string","boolean","bigint"];let XI;XI=new class{constructor(){return XI||(qI("[constructor]"),pI(this),this.embedApi=window.eko.embedApi,this.projectHandlers={},this.blockHandlers={},this.moduleHandlers={},this.listenToMessages(),{embedApi:this.embedApi,init:this.init,registerProjectHandler:this.registerProjectHandler,registerBlockHandler:this.registerBlockHandler,registerModuleHandler:this.registerModuleHandler,sendBlockEvent:this.sendBlockEvent})}listenToMessages(){this.listenToPlayerMessages(),this.listenToProjectMessages(),this.listenToBlockMessages(),this.listenToModuleMessages()}listenToPlayerMessages(){this.embedApi.on(this.embedApi.TYPES.PLAYER_INVOKE,(e=>{var t;if(!e)return void qI.warn('Missing "data" in player invoke message');if(!e.action)return void qI.warn('Missing "action" in player invoke message data:',e);if(!YI.hasObjectProperty(this.player,e.action))return void qI.warn("Attempting to call non existent player action:",e.action);let n=e.action,i=null!==(t=e.args)&&void 0!==t?t:[];i=Array.isArray(i)?i:[i];let r=YI.getObjectProperty(this.player,n);if("function"==typeof r)r(...i);else{if(!KI.includes(typeof r))return void qI.warn("Attempting to call non supported player action:",n);YI.setObjectProperty(this.player,n,i[0])}}))}listenToProjectMessages(){this.embedApi.on(this.embedApi.TYPES.PROJECT_INVOKE,(e=>{var t;if(!e)return void qI.warn('Missing "data" in project invoke message');if(!e.action)return void qI.warn('Missing "action" in project invoke message data:',e);let n=e.action,i=null!==(t=e.args)&&void 0!==t?t:{};this.projectHandlers[n]&&this.projectHandlers[n].forEach((e=>{e(i)}))}))}listenToBlockMessages(){this.embedApi.on(this.embedApi.TYPES.BLOCK_INVOKE,(e=>{var t,n,i;if(!e)return void qI.warn('Missing "data" in block invoke message');if(!e.action)return void qI.warn('Missing "action" in block invoke message data:',e);let r=e.action,o=null!==(t=e.args)&&void 0!==t?t:{},s=e.blockId||(null===(n=this.orchestrator.currentBlock)||void 0===n?void 0:n.id);null!==(i=this.blockHandlers[s])&&void 0!==i&&i[r]&&this.blockHandlers[s][r](o)}))}listenToModuleMessages(){this.embedApi.on(this.embedApi.TYPES.MODULE_INVOKE,(e=>{var t,n,i,r,o;if(!e)return void qI.warn('Missing "data" in module invoke message');if(!e.action)return void qI.warn('Missing "action" in module invoke message data:',e);let s=e.action,a=null!==(t=e.args)&&void 0!==t?t:{},l=e.blockId||(null===(n=this.orchestrator.currentBlock)||void 0===n?void 0:n.id),c=e.moduleId||(null===(i=this.orchestrator.currentBlock)||void 0===i||null===(r=i.getCurrentActiveModule)||void 0===r||null===(r=r.call(i))||void 0===r?void 0:r.id);c&&null!==(o=this.moduleHandlers[l])&&void 0!==o&&null!==(o=o[c])&&void 0!==o&&o[s]&&this.moduleHandlers[l][c][s](a)}))}init(e,t){qI("[init]",arguments),this.orchestrator=e,this.player=t}registerProjectHandler(e,t){this.projectHandlers[e]=this.projectHandlers[e]||[],this.projectHandlers[e].push(t)}registerBlockHandler(e,t,n){this.blockHandlers[e]=this.blockHandlers[e]||{},this.blockHandlers[e][t]&&qI.warn(`Overriding existing block handler for block id "${e}" and action name "${t}"`),this.blockHandlers[e][t]=n}registerModuleHandler(e,t,n,i){this.moduleHandlers[e]=this.moduleHandlers[e]||{},this.moduleHandlers[e][t]=this.moduleHandlers[e][t]||{},this.moduleHandlers[e][t][n]&&qI.warn(`Overriding existing module handler for block id "${e}", module id "${t}" and action name "${n}"`),this.moduleHandlers[e][t][n]=i}sendBlockEvent(e,t,n,i={}){this.embedApi.sendMsg(this.embedApi.TYPES.BLOCK_EVENT,{blockId:e,blockType:t,name:n,data:i})}};const QI=rI("eko-actions-manager"),ZI=XI.embedApi;let JI;const eA=(...e)=>{var t;return null===(t=window)||void 0===t||null===(t=t.InterludePlayer)||void 0===t||null===(t=t.utils)||void 0===t?void 0:t.getObjectProperty(...e)};JI=new class{constructor(){if(JI)return JI;QI("[init]"),pI(this),this.listenToMessages()}isValidAction(e){if(!e)return!1;const t=eA(this,e);return t&&"function"==typeof t}listenToMessages(){ZI.on(ZI.TYPES.INVOKE_ACTION,(e=>{const t=e.action;this.isValidAction(t)?eA(this,t)(e.args,e.options):QI.warn("Trying to invoke an invalid action:",t)}))}register(e,t){let n=!1;return"function"!=typeof t?QI.error("action must be of type function"):eA(this,e)?QI.error(`action ${e} is already registered`):(((...e)=>{var t;null===(t=window)||void 0===t||null===(t=t.InterludePlayer)||void 0===t||null===(t=t.utils)||void 0===t||t.setObjectProperty(...e)})(this,e,t),n=!0),n}};const tA=rI("eko-event-emitter"),nA={PROJECT_READY:"projectready",BLOCK_START:"blockstart",BLOCK_DONE:"blockdone",TEST:"testing"};let iA;iA=new class{constructor(){return iA||(tA("[init]"),this.eventEmitter=new Ei,this.events=nA,pI(this),{events:this.events,on:this.on,off:this.off,once:this.once,emit:this.emit})}isValidEvent(e){return!!Object.values(this.events).includes(e)||!!e.startsWith(`${this.events.BLOCK_DONE}:`)||(tA.error(`Unknown event: ${e}`),!1)}on(e,t){return!!this.isValidEvent(e)&&(this.eventEmitter.on(e,t),!0)}off(e,t){return this.eventEmitter.off(e,t),!0}once(e,t){return!!this.isValidEvent(e)&&(this.eventEmitter.once(e,t),!0)}emit(e,...t){return!!this.isValidEvent(e)&&(this.eventEmitter.trigger(e,t),!0)}};const rA=rI("Checkpoints");let oA;oA=new class{constructor(){return oA||(rA("[constructor]"),this.checkpoints=[],this.modules={},pI(this),{register:this.register,save:this.save,restore:this.restore})}register(e,t,n){this.modules[e]={id:e,saveFn:t,restoreFn:n}}save(e){let t={};Object.keys(this.modules).forEach((e=>{let n=this.modules[e].saveFn();n=(e=>{var t;return"object"!=typeof e?e:null===(t=window)||void 0===t||null===(t=t.InterludePlayer)||void 0===t||null===(t=t.utils)||void 0===t?void 0:t.extend(!0,{},e)})(n),t[e]=n})),this.checkpoints.push({id:e,modulesData:t})}restore(e){let t=this.checkpoints.findIndex((t=>t.id===e));if(-1===t)return void rA.warn(`Could not restore checkpoint because could not find checkpoint with id: "${e}"`);let n=this.checkpoints[t];Object.keys(n.modulesData).forEach((e=>{this.modules[e].restoreFn(n.modulesData[e])})),this.checkpoints.splice(t)}};const sA=rI("soundtrack","warn"),aA="soundtrack",lA={fadeDuration:1.5,volume:1,mutedVolume:0};let cA,uA;function dA(e){if(!e)return;const t=cA.audio.get(aA,{format:"sonor"}),n=!(!e.data||!e.data.muteSoundtrack),i=n?uA.mutedVolume:uA.volume;t.volume!==i&&(t.muted||!t.isPlaying?(sA.info(`[onNodeStart] [${e.id}] ${n?"Muting":"Unmuting"} soundtrack (setting volume to ${i})`),t.volume=i):(sA.info(`[onNodeStart] [${e.id}] ${n?"Muting":"Unmuting"} soundtrack (fading to target volume ${i})`),t.fade(i,uA.fadeDuration)))}const hA=rI("SimpleAudioPlayer"),pA="ding",fA={[pA]:{sources:[{url:"https://storage.eko.com/efu/encode_srv/production/v2/1a969730-a46d-11ec-9b77-fd6cf3d0eeb1/encode/packageMedia/audio/0/webm_vorbis/X.vorbisv1.554d61f1e81b579f952d93ec31e0b8b0.Audio_High.webm",type:"audio/webm"},{url:"https://storage.eko.com/efu/encode_srv/production/v2/1a969730-a46d-11ec-9b77-fd6cf3d0eeb1/encode/packageMedia/audio/0/m4av1/X.aacv2.26657d5ff9020d2abefe558796b99584.Audio_High.m4a",type:"audio/mp4"},{url:"https://storage.eko.com/efu/encode_srv/production/v2/1a969730-a46d-11ec-9b77-fd6cf3d0eeb1/encode/packageMedia/audio/0/mp3v1/X.mp3v1.2e0b9ff5c7ee146867e1f49328743b82.Audio_High.mp3",type:"audio/mpeg"}],volume:.2,preload:!0,loop:!1}},gA={DING:pA};function mA(e){const t=document.createElement("audio");t.id=e.id,t.volume=e.volume,t.loop=e.loop,t.preload=e.preload;for(const n of e.sources){const e=document.createElement("source");e.src=n.url,e.type=n.type,t.appendChild(e)}return t}class yA{constructor(e){hA("[constructor]"),this.player=e,this.audioElements={};for(const[e,t]of Object.entries(fA))this.audioElements[e]=mA(t)}shouldUseSimpleAudioPlayer(e){return!this.player.audio&&-1!==Object.values(gA).indexOf(e)}play(e){if(this.player.muted||this.player.isAudioLocked)return void hA.info("[play] Player is muted or audio is locked, not playing");hA("[play]",e);const t=this.audioElements[e];if(!t)throw new Error(`Sound ${e} doesn't exist`);t.currentTime=0,t.play()}}const vA=rI("AudioManager");let bA,wA;function kA(e){var t,n,i;const r=fA[e];if(!r)throw new Error(`Sound ${e} doesn't exist`);return{id:e,src:r.sources.map((e=>e.url)),volume:null!==(t=r.volume)&&void 0!==t?t:1,preload:null===(n=r.preload)||void 0===n||n,loop:null!==(i=r.loop)&&void 0!==i&&i}}bA=new class{constructor(){return bA||(vA("[constructor]"),pI(this),this.registerActions(),{init:this.init,play:this.play,DEFAULT_SOUND_IDS:gA})}registerActions(){JI.register("audio.play",(({id:e})=>{this.play(e)}))}initSoundtrack(){if(this.config.soundtrack){let e=function(e,t){if(!DI.isValidAudioData(t))return MI.info("[createAudioDescObj] No audio data found, returning null."),null;const n={id:e,...DI.transformData(t)};return MI.info(`[createAudioDescObj] Created audio description obj for "${e}" with data:`,n),n}("soundtrack",{audio:this.config.soundtrack.src,volume:this.config.soundtrack.volume});!async function(e,t,n={}){if(cA=e,sA("[init] Initializing soundtrack with args:",cA,t,n),t){if(!cA||"function"!=typeof cA.pluginInited)throw new Error("[soundtrack] [init] Invalid player instance");if(!t.src)throw new Error('[soundtrack] [init] Invalid soundtrack object (must include "src" prop)');t.id&&t.id!==aA&&sA.warn("[init] Soundtrack ID is not the default one. It will be ignored/overwritten."),uA={...lA,volume:"number"==typeof t.volume?t.volume:lA.volume,...n},uA.volume<uA.mutedVolume&&sA.warn("[init] volume is lower than mutedVolume, please check your soundtrack options"),await cA.pluginInited("audio"),cA.audio.add({loop:!0,preload:!0,startOnInteraction:!1,...t,id:aA,volume:uA.volume}),cA.on("nodestart",dA),dA(cA.currentNode)}else sA.info("[init] No soundtrackObj provided, doing nothing")}(this.player,e)}}async addDefaultSounds(){await this.player.pluginInited("audio");for(const e of Object.values(gA))this.player.audio.add(kA(e))}init(e,t){vA("[init]",arguments),this.player=e,this.config=t,this.initSoundtrack(),this.addDefaultSounds(),this.player.audio||(wA=new yA(e))}async play(e){var t;null!==(t=wA)&&void 0!==t&&t.shouldUseSimpleAudioPlayer(e)?wA.play(e):(await this.player.pluginInited("audio"),this.player.audio.play(e))}};var xA=[{event:iA.events.BLOCK_START}];const SA=rI("Tracker"),CA=XI.embedApi,_A={START:"start",CHOICE_BUTTON:"choice button",CHOICE_MULTI_SELECT:"choice multi-select",CHOICE_SLIDER:"choice slider",NEXT_BUTTON:"next button",PREVIOUS_BUTTON:"previous button",SEQUENCE_DOT:"sequence dot",LEARN_MORE:"learn more",BACK:"back",SKIP:"skip",CONTINUE:"continue",START_OVER:"start over",MENU_OPTION:"menu option",MENU_OPTION_UNSELECT:"menu option unselect",HOME:"home button",OPEN_IN_NEW_WINDOW:"open in new window",CTA:"cta",SUBMIT:"submit",CLOSE:"close",PRODUCT_OPTION:"product option",EXIT_BUTTON:"exit button",PAUSE_OVERLAY:"pause overlay",QUESTION_LABEL:"question label",QUESTION:"question",SEARCH_OPENED:"search opened",SEARCH_STARTED:"search started",SEARCH_CLOSED:"search closed",GESTURE:"gesture",GESTURE_NEXT:"gesture next",GESTURE_PREVIOUS:"gesture previous",EXPAND:"expand",COLLAPSE:"collapse",SWIPE_NEXT:"swipe next",SWIPE_PREVIOUS:"swipe previous",SCROLL:"scroll"},EA={NAVIGATION:"navigation",THUMBNAIL:"thumbnail",MODULE:"module"};let TA;TA=new class{constructor(){return TA||(SA("[constructor]"),pI(this),this.elementTypes=_A,this.interactionTypes=EA,this.setupDefaultRuntimeEvents(),{track:this.track,registerContextPacker:this.registerContextPacker,trackInteraction:this.trackInteraction,trackProductLinkOut:this.trackProductLinkOut,trackProductLinkOutCheckout:this.trackProductLinkOutCheckout,trackGenericLinkOut:this.trackGenericLinkOut,elementTypes:this.elementTypes,interactionTypes:this.interactionTypes})}setupDefaultRuntimeEvents(){for(const{event:e,trackAs:t,once:n}of xA)iA[n?"once":"on"](e,(n=>this.track(t||e,n)))}registerContextPacker(e){window.EkoAnalytics.registerContextPacker(e)}trackInteraction({elementid:e,elementtype:t,elementname:n,interactiontype:i}){let r={elementid:e,elementtype:t,elementname:n,interactiontype:i};this.track("implementation.interactions",r),CA.sendMsg(CA.TYPES.INTERACTION,r)}trackProductLinkOut(e){this.track("product.linkout",e)}trackProductLinkOutCheckout({product:e,variant:t}){this.track("product.linkout.checkout",{product:e,variant:t})}trackGenericLinkOut(e){this.track("generic_linkout",e)}track(e,t){window.EkoAnalytics.track(e,t)}};const PA=/.*/;function IA(e){return e.reduce(((e,t)=>(e[t.key]=t.value,e)),{})}var AA=function(e){let t=new RegExp(e+"=([^&]*)"),n=window.location.hash.match(t);return n?decodeURIComponent(n[1]):null};const OA=rI("Variants"),LA=["ProductDemo","FullScreenMultiSequence","GalleryBlock"],NA=window.InterludePlayer.environment.queryParams,RA=NA.editor||NA._eko_platform,DA=NA._eko_varselector;let MA;MA=new class{constructor(){return MA||(OA("[constructor]"),pI(this),this.variants=[],this.currentVariant=null,this.variantsBlocks=[],TA.registerContextPacker((e=this,{schema:"iglu:com.helloeko/variant/jsonschema/1-0-1",match:PA,getData:function({selectedVariant:t}={}){let n=e.getCurrent()||function(){var e;const t=null===(e=window.eko)||void 0===e||null===(e=e.hashParams)||void 0===e?void 0:e.get("variantId");if(t)return{id:t}}();if(!n)return null;let i={id:n.id||""};return n.options&&(i.options=IA(n.options)),t&&(i.selected=IA(t)),i}})),this.registerEmbedApiHandlers(),{init:this.init,getCurrent:this.getCurrent});var e}registerEmbedApiHandlers(){XI.registerProjectHandler("updateVariant",(({id:e})=>{if(!e)return void OA.warn('Missing "id" argument in "updateVariant" handler');let t=this.variants.find((t=>t.id===e));if(!t)return void OA.warn(`Ignoring update variant message since could not find a variant with id "${e}"`);if(this.currentVariant===t)return void OA.info("Ignoring update variant message because it is already set as the current variant");let n=t.options.filter((e=>{var t;return!(null===(t=this.currentVariant.options)||void 0===t?void 0:t.some((t=>t.key===e.key&&t.value===e.value)))}));if(this.currentVariant=t,TA.track("variant.change",{selectedVariant:n}),this.variantsBlocks.length>0){const e=this.variantsBlocks.find((e=>e===this.orchestrator.currentBlock));e?e.variantUpdateHandler(this.currentVariant):this.orchestrator.setNextBlock(this.variantsBlocks[0].id,!0,{seekOptions:{transitionOptions:{forceSeekOnStackedTransitions:!0}}})}}))}isValidVariantsBlock(e){return"function"==typeof e.getVariants&&"function"==typeof e.variantUpdateHandler}getInitialVariant(){let e=this.variants[0],t=AA("variantId")||NA.variantId;if(t){let n=this.variants.find((e=>e.id===t));n?e=n:OA.warn(`Ignoring hash variant id since could not find a variant with id "${t}"`)}return e}shouldShowVariantSelectorUI(){let e=AA("_eko_varselector");return e?"true"===e:"boolean"==typeof DA?DA:RA}init(e,t){this.orchestrator=e;for(const e in t){let n=t[e];LA.includes(n.type)&&this.isValidVariantsBlock(n)&&this.variantsBlocks.push(n)}this.variantsBlocks.length>0&&(this.variants=this.variantsBlocks[0].getVariants(),this.variants.length>0&&(this.currentVariant=this.getInitialVariant(),this.variantsBlocks.forEach((e=>{e.variantReadyHandler&&"function"==typeof e.variantReadyHandler&&e.variantReadyHandler(this.currentVariant)})),this.shouldShowVariantSelectorUI()&&function(e,t,n){const i=document.createElement("div");i.style.position="fixed",i.style.top="15%",i.style.left="5%",i.style.backgroundColor="rgba(100, 100, 100, 0.8)",i.style.zIndex=9999;const r=document.createElement("div");r.textContent=`ID: ${t.id}`,i.appendChild(r);const o=window.matchMedia("(max-width: 768px)");let s=[],a=function(e){let t=e.map((e=>e.options)).flat();t=t.filter((e=>e.key&&e.value));let n={};return t.forEach((e=>{n[e.key]=n[e.key]||[],n[e.key].includes(e.value)||n[e.key].push(e.value)})),n}(e);Object.keys(a).forEach((l=>{const c=document.createElement("label");c.textContent=l+": ";const u=document.createElement("select");function d(){o.matches?(i.style.padding="10px",r.style.fontSize="16px",c.style.fontSize="16px",u.style.fontSize="16px"):(i.style.padding="14px",r.style.fontSize="32px",c.style.fontSize="32px",u.style.fontSize="32px")}u.setAttribute("data-key",l),d(),o.addEventListener("change",d),a[l].forEach((e=>{const n=document.createElement("option");n.value=e,n.textContent=e,n.selected=t.options.find((t=>t.key===l&&t.value===e)),u.appendChild(n)})),u.addEventListener("change",(function(){let t=function(e,t){let n={};return t.forEach((e=>{n[e.getAttribute("data-key")]=e.value})),e.find((e=>Object.keys(n).every((t=>e.options.some((e=>e.key===t&&e.value===n[t])))))).id}(e,s);r.textContent=`ID: ${t}`,window.postMessage({target:"eko.embedapi",type:n.embedApi.TYPES.PROJECT_INVOKE,data:{action:"updateVariant",args:{id:t}}},"*")})),i.appendChild(c),i.appendChild(u),s.push(u),i.appendChild(document.createElement("br"))})),i.childNodes.length>0&&document.body.appendChild(i)}(this.variants,this.currentVariant,XI)))}getCurrent(){return this.currentVariant}};const FA=window.InterludePlayer.environment.queryParams;function BA(){try{return window.self!==window.top}catch(e){return!0}}function UA(){var e,t;return!!FA.forceWalmart||BA()&&(document.referrer.includes("walmart.com")||document.referrer.includes("walmartimages.com")||(null===(e=FA.originalreferrer)||void 0===e?void 0:e.includes("walmart.com"))||(null===(t=FA.originalreferrer)||void 0===t?void 0:t.includes("walmartimages.com")))}var jA={isEmbeddedInIframe:BA,isEmbeddedInWalmart:UA,isEmbeddedInWalmartPDP:function(){return!!FA.forceWalmartPDP||UA()&&FA.publisherID&&/^walmart_\d+$/.test(FA.publisherID)},isEmbeddedInWalmartApp:function(){const e=window.InterludePlayer.environment.ua;return FA.publisherID&&/^walmart_\d+$/.test(FA.publisherID)&&(e.includes("iOS")&&e.includes("WMT1H")||e.includes("Android")&&e.includes("wv"))},isMobile:function(){return!window.InterludePlayer.environment.isDesktop}};const zA=rI("brandingLib"),VA={sams_club:()=>import("../index-BRgPNjn_.js"),walmart:()=>import("../index-B9IQDshv.js"),walmart_alt:()=>import("../index-1LrOZtRu.js"),mockingbird:()=>import("../index-uQfThvqh.js"),mockingbird2:()=>import("../index-hCbYs0Wr.js"),tzumi:()=>import("../index-6_ZXyznz.js"),margaux:()=>import("../index-DBZFVNRg.js"),babybrezza:()=>import("../index-3D4IHHMF.js"),tushy:()=>import("../index-CtZRnjDb.js"),caraway:()=>import("../index-CJiVmQRX.js"),cpap:()=>import("../index-C577ji9i.js"),andie:()=>import("../index-DGD0EZ_o.js"),nzxt:()=>import("../index-C583phTr.js"),cumulus:()=>import("../index-D22PkSrr.js"),members_mark:()=>import("../index-BrcACBna.js"),joie:()=>import("../index-Diu186Vj.js"),impact:()=>import("../index-DOCGq4-j.js"),demo:()=>import("../index-XucI3JrK.js"),oliver_cabell:()=>import("../index-BEQaWBE2.js"),lalo:()=>import("../index-Dv617Y5f.js"),mycubesafe:()=>import("../index-BwzH05ex.js"),hulken:()=>import("../index-zU25eyfc.js"),wayfair:()=>import("../index-DkI8uOf0.js"),vsa:()=>import("../index-BwuW7ucQ.js"),aviron:()=>import("../index-C8lE0FYO.js"),remi:()=>import("../index-Dksd2Q2y.js"),polarmonkeys:()=>import("../index-Cg_O_G8c.js"),jackarcher:()=>import("../index-CpYHuccL.js"),ascend:()=>import("../index-_BLtoata.js"),nordik:()=>import("../index-DpV6VvWt.js"),rorra:()=>import("../index-CorD9wWj.js"),toybox:()=>import("../index-BCyqUGMD.js")};let WA;async function HA(e){return WA||(e&&VA[e]?await VA[e]().then((e=>{WA=e})).catch((t=>{throw zA.error(`Failed loading brand module ${e} with error: ${t}`),t})):zA.warn(`Failed loading brand module with error: brand ${e} does not exist`)),WA}function $A(e){let t=window.InterludePlayer.environment.queryParams;return"brandName"in t?!1===t.brandName?null:t.brandName:UA()?"walmart":e||null}const GA=["customBranding","spaceBranding","instance"],qA=["fontSource","fontUrl","font","transition","primaryColor","secondaryColor","buttonShape","button","reportSwipes","enableGesturesOnMobile","enableEkobranding"],YA=rI("Theme");function KA(e,t){if(!t)return null;let n;return n="Primary"===t?e.primaryColor:"Secondary"===t?e.secondaryColor:t.toLowerCase(),n}const XA={logo:e=>{var t,n;return(null==e||null===(t=e.logo)||void 0===t?void 0:t.visible)&&(null==e||null===(n=e.logo)||void 0===n?void 0:n.asset)},buttonTextColor:"colors.buttons.text",buttonBackgroundColor:"colors.buttons.background",bodyTextColor:"colors.body.text",bodyBackgroundColor:"colors.body.background",fontSource:e=>(null==e?void 0:e.font)&&"url",fontUrl:"font.url",font:"font.name"},QA={logo:(e,t)=>null==t?void 0:t.logo,buttonTextColor:"primaryColor",buttonBackgroundColor:"secondaryColor",bodyTextColor:(e,t)=>KA(e,null==t?void 0:t.textColor),bodyBackgroundColor:(e,t)=>KA(e,null==t?void 0:t.backgroundColor),fontSource:e=>{var t,n;return null!==(t=e.font)&&void 0!==t&&t.name&&null!==(n=e.font)&&void 0!==n&&n.url?"url":"GoogleFonts"},fontUrl:"font.url",font:e=>{var t;return(null===(t=e.font)||void 0===t?void 0:t.name)||e.font}},ZA=e=>(t,n,i)=>"string"==typeof e[t]?((...e)=>{var t;return null===(t=window)||void 0===t||null===(t=t.InterludePlayer)||void 0===t||null===(t=t.utils)||void 0===t?void 0:t.getObjectProperty(...e)})(n,e[t]):"function"==typeof e[t]?e[t](n,i):t in n?n[t]:void 0;let JA;function eO(e){return function e(t){let n={};return new Proxy(t,{get(e,t){return"subscribe"===t?function(e,t){let i;return e?(i=n[e]=n[e]||[],i.push(t)):(i=n[""]=n[""]||[],i.push(t)),()=>{const e=i.indexOf(t);e>-1&&i.splice(e,1)}}:Reflect.get(...arguments)},set:(i,r,o)=>(i[r]="object"==typeof o&&null!==o?e(o):o,function(e,i){let r=n[e],o=n[""];r&&r.forEach((e=>e(i))),o&&o.forEach((e=>e(t)))}(r,o),!0)})}(e||{})}JA=new class{constructor(){return JA||(YA("[constructor]"),pI(this),{init:this.init,get:this.get,blockUIPropsTransformer:this.blockUIPropsTransformer})}getValueUsingOverrides(e,t){let n={customBranding:ZA(XA),spaceBranding:ZA(XA),instance:ZA(QA)};for(let i of GA){let r=this.theme[i];if(r){let o=n[i](e,r,t);if(void 0!==o)return o}}}blockUIPropsTransformer(e,t){let n={};return Object.keys(t.blockConfigMap).forEach((i=>{n[i]=e[t.blockConfigMap[i]]})),t.names.reduce(((e,t)=>(e[t]=this.getValueUsingOverrides(t,n),e)),{})}async init(e,t,n,i){if(t){let r=await HA(t);r?(YA.info(`[init] Initializing brand "${t}"`),r.initHandler&&r.initHandler(n,i,e),r.brandThemeTransformer&&(e.customBranding=r.brandThemeTransformer(structuredClone(e.instance)))):YA.error(`BrandName ${t} does not exist`)}this.theme=e,this.themeProxy=new Proxy(e,{get:(e,t)=>qA.includes(t)?this.getValueUsingOverrides(t):(YA.error(`prop ${t} does not exist in them runtime schema`),null)})}get(){return this.themeProxy}};var tO={VIDEO_SOURCE_PREFIX:"__SRC_VID:",TEXTURE_SOURCE_PREFIX:"__SRC_TEXTURE:",PREVIOUS_OUTPUT_PREFIX:"__PREVIOUS:",SAVED_FRAME_PREFIX:"__SAVED_FRAME:",SYSTEM_NODES:{FILTERS:{RENDER_TO_CANVAS:"__default"},TAGS:{ATOM:"atom",FILTER:"filter",COMPOSITE_FILTER:"composite",TRANSITION_FILTER:"transition"}},MESSAGES:{UPDATE_OPTIONS:"update_options"}};class nO{constructor(e,t){this.canvasSource=e,this.startRendering=t,this.gl=null}init(e,t,n){const i=this.initCanvas(this.canvasSource,e,t);return this.initWebgl(i,n)}initCanvas(){throw new Error("implement on concrete class")}initWebgl(e,t={}){const n=e.getContext("webgl",t);if(!n)throw new Error("Browser doesn't support webgl");return n.enable(n.BLEND),n.disable(n.DEPTH_TEST),n.clearColor(0,0,0,0),n.clear(n.COLOR_BUFFER_BIT),n}isStartRendering(){return this.startRendering}}class iO extends nO{constructor(e){super(e,!0),this.setSrcVidTracksFn=null,this.shouldUpdateTexture=!0,this.onPlayerSeeking=this.onPlayerSeeking.bind(this),this.onPlayerSeeked=this.onPlayerSeeked.bind(this),this.onPlayerNodeStart=this.onPlayerNodeStart.bind(this),this.oncePlayerPlaying=this.oncePlayerPlaying.bind(this);const t=new nw;this.on=t.on.bind(t),this.off=t.off.bind(t),this.once=t.once.bind(t),this.trigger=t.emit.bind(t)}onPlayerSeeking(){this.shouldUpdateTexture=!1}onPlayerSeeked(){this.shouldUpdateTexture=!0}onPlayerNodeStart(){this.shouldUpdateTexture=!0,"function"==typeof this.player.canvas.drawFrame&&this.player.canvas.drawFrame(),this.trigger("forcerender")}oncePlayerPlaying(){this.onPlayerNodeStart()}addPlayerListeners(){this.player&&(this.player.on("seeking",this.onPlayerSeeking),this.player.on("seeked",this.onPlayerSeeked),this.player.on("nodestart",this.onPlayerNodeStart),this.player.once("playing",this.oncePlayerPlaying))}removePlayerListeners(){this.player&&(this.player.off("seeking",this.onPlayerSeeking),this.player.off("seeked",this.onPlayerSeeked),this.player.off("nodestart",this.onPlayerNodeStart),this.player.off("playing",this.oncePlayerPlaying))}initCanvas(e,t,n){return this.player=e,this.setSrcVidTracksFn=t,e.initPlugin("canvas",{contextType:"webgl"}),e.canvas.init({drawFrame:this.canvasDrawFrameFn.bind(this),resize:n,contextType:"webgl",offscreenVideoCanvasEnabled:!1,viewportModeEnabled:!0,fps:0}),e.paused&&0===e.currentTime&&(this.shouldUpdateTexture=!1),this.addPlayerListeners(),e.canvas.canvas}canvasDrawFrameFn(e,t,n){this.setSrcVidTracksFn&&this.shouldUpdateTexture&&e&&t&&n&&(n.videoWidth||n.displayWidth)&&(n.videoHeight||n.displayHeight)&&function(e){return!(e&&"boolean"==typeof e.isDataLoaded)||e&&e.isDataLoaded&&(void 0===e.isFrameTextureReady||e.isFrameTextureReady)}(n)&&this.setSrcVidTracksFn(n)}async recover(){if(this.player&&this.player.paused)return new Promise((e=>{this.player.once("seeked",(()=>{this.shouldUpdateTexture=!0,e()})),this.player.currentTime=this.player.currentTime}))}dispose(){this.player&&(this.player.canvas&&"function"==typeof this.player.canvas.dispose&&this.player.canvas.dispose(),this.removePlayerListeners(),this.player=null)}}class rO extends nO{constructor(e){super(e,!1)}initCanvas(e,t){const n=function(){const e=document.querySelector("video");e&&e.videoHeight&&t(e),requestAnimationFrame(n)};return requestAnimationFrame(n),document.getElementById(e)}}class oO extends nO{constructor(e){super(e,!1)}initCanvas({src:e,dest:t},n,i){const r="string"==typeof t?document.querySelector(t):t,o="undefined"!=typeof HTMLVideoElement&&e instanceof HTMLVideoElement,s=()=>{this.isDisposed||(e&&e.videoHeight&&n(e),requestAnimationFrame(s))};return o?requestAnimationFrame(s):"function"==typeof e?e(n,i):n(e),r}dispose(){this.isDisposed=!0}}function sO(e){return Array.isArray(e)||(e=[e]),e}class aO{constructor(e){this.store=e?{...e.get()}:{}}reset(){this.store={}}get(e){if(!e)return this.store;const t=(e=sO(e)).reduce(((e,t)=>(e.push(this.store[t]),e)),[]);return 1===t.length?t[0]:t}set(e,t){if(e=sO(e),t=sO(t),e.length!==t.length)throw new Error(`cant set values ${t} to keys ${e}, length did not match`);e.forEach(((e,n)=>{this.store[e]=t[n]}))}}class lO{constructor(e,t,n,i){this.gl=i.gl,this.unit=e,this.bindPoint=t,this.height=1080,this.width=1920,this.textureObject=n.object,this.isStatic=!1,n.needRefresh&&this.setParameters()}getUnit(){return this.unit}getObject(){return this.textureObject}bind(){this.gl.bindTexture(this.bindPoint,this.textureObject)}fill(){throw new Error("impl in concrete class")}setParameters(){this.bind(),this.gl.texParameteri(this.bindPoint,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.bindPoint,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.bindPoint,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.bindPoint,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR)}active(){this.gl.activeTexture(this.gl.TEXTURE0+this.getUnit())}beforeUse(){this.active(),this.bind()}dispose(){this.gl.deleteTexture(this.textureObject)}setHeight(e){this.height=e}setWidth(e){this.width=e}getHeight(){if(!this.height)throw new Error(`texture ${this.unit} no height init `);return this.height}getWidth(){if(!this.width)throw new Error(`texture ${this.unit} no width init `);return this.width}}const cO=rI("frame","warn");let uO=!1;if("undefined"!=typeof window&&window.InterludePlayer){let e=window.InterludePlayer.environment,t=e.isAffectedBySafari17SeekBug,n=e.ua.includes("WMT1H")&&e.ua.includes("iOS/17");uO=t||n}class dO extends lO{fill(e){if(uO&&(e.paused||"undefined"!=typeof document&&"hidden"===document.visibilityState))return;if(e.__closed)return;this.bind(),this.width=e.videoWidth||e.displayWidth,this.height=e.videoHeight||e.displayHeight;const t=performance.now();this.gl.texImage2D(this.bindPoint,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,e);const n=(performance.now()-t)/1e3;n>=.1&&cO.warn(`[fill] texImage2D() took ${n.toFixed(3)} seconds to execute.`),"function"==typeof e.close&&(e.close(),e.__closed=!0)}}class hO extends lO{constructor(e,t,n){super(...arguments),n.needRefresh&&(this.fill(null),n.needRefresh=!1)}fill(e){this.bind(),e&&e.tagName&&"IMG"===e.tagName?this.gl.texImage2D(this.bindPoint,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,e):this.gl.texImage2D(this.bindPoint,0,this.gl.RGBA,this.gl.canvas.width,this.gl.canvas.height,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,e)}}class pO{constructor(e){return this.gl=e.gl,this.textureObjectPool=[],this.textureUnitsPool=new Set(Array(20).keys()),{createTexture:this.createTexture.bind(this),releaseTexture:this.releaseTexture.bind(this),refreshTextureObjects:this.refreshTextureObjects.bind(this)}}getTextureObject(){return this.textureObjectPool.pop()||{object:this.gl.createTexture(),needRefresh:!0}}getTextureUnit(){const e=this.textureUnitsPool.values(),t=Math.min.apply(null,[...e]);return this.textureUnitsPool.delete(t),t}createTexture(e){const t=this.gl.TEXTURE_2D;return function(e,t,n,i,r){let o;switch(e){case"frame":o=new dO(t,n,i,r);break;case"pixel":o=new hO(t,n,i,r);break;default:throw new Error(`cant recognize type ${e}`)}return o}(e&&e.type||{},this.getTextureUnit(),t,this.getTextureObject(),{gl:this.gl})}releaseTexture(e){this.textureUnitsPool.has(e.getUnit())||(this.textureObjectPool.push({object:e.getObject(),needRefresh:!1}),this.textureUnitsPool.add(e.getUnit()))}refreshTextureObjects(){this.textureObjectPool.forEach((e=>{e.needRefresh=!0}))}}const fO=tO.VIDEO_SOURCE_PREFIX,gO=tO.TEXTURE_SOURCE_PREFIX,mO=tO.PREVIOUS_OUTPUT_PREFIX,yO=tO.SAVED_FRAME_PREFIX;function vO(e,t,n){e.set(`${fO}${n}`,t)}function bO(e,t,n){e.set(`${mO}${n}`,t)}function wO(e,t,n){e.set(`${yO}${n}`,t)}class kO{constructor(e){return this.gl=e.gl,this.glSource=e.glSource,this.textureManager=e.textureManager,this.capturedFramesManager=e.capturedFramesManager,{setVideoSources:this.setVideoSources.bind(this),setTextureSource:this.setTextureSource.bind(this),getInput:this.getInput.bind(this),getPrevOutput:this.getPrevOutput.bind(this),setOutputs:this.setOutputs.bind(this),disposeTextures:this.disposeTextures.bind(this),disposeAllStore:this.disposeAllStore.bind(this)}}setVideoSources(e){for(const[t,n]of Object.entries(this.capturedFramesManager.getCurrentFrames()))vO(e,n,t),bO(e,n,t);for(const[t,n]of Object.entries(this.capturedFramesManager.getSavedFrames()))wO(e,n,t)}setTextureSource(e,t,n){e.set(`${gO}${n}`,t)}getInput(e,t){return e.get(t)}getPrevOutput(e,t){return t=Number.isInteger(t)?t:0,e.get(`${mO}${t}`)}setOutputs(e,t=[],n=[]){if(Array.isArray(n)||(n=[n]),t.length>n.length)throw new Error(`output ids ${t.length}  is bigger then supplied outputs ${n.length}`);n.forEach(((t,n)=>{bO(e,t,n)})),t.forEach(((t,i)=>{e.set(t,n[i])}))}disposeTextures(e,t){const n=t.getUnit();e.forEach((e=>{const t=e.getUnit();this.capturedFramesManager.isReservedUnit(t)||n===t||this.textureManager.releaseTexture(e)}))}disposeAllStore(e){const t=new Set;Object.values(e.get()).forEach((e=>{const n=e.getUnit();this.capturedFramesManager.isReservedUnit(n)||t.has(n)||e.isStatic||(this.textureManager.releaseTexture(e),t.add(n))}))}}class xO{constructor(e){this.context=e}bind(){throw new Error("impl in concrete")}}let SO=class extends xO{bind(e){return this.context.gl.bindFramebuffer(this.context.gl.FRAMEBUFFER,null),e}},CO=class extends xO{bind(e){Array.isArray(e)||(e=[e]),this.context.gl.bindFramebuffer(this.context.gl.FRAMEBUFFER,this.context.frameBufferObject);const t=this.context.textureManager.createTexture({type:"pixel"});return this.context.gl.framebufferTexture2D(this.context.gl.FRAMEBUFFER,this.context.gl.COLOR_ATTACHMENT0,this.context.gl.TEXTURE_2D,t.textureObject,0),this.context.gl.clear(this.context.gl.COLOR_BUFFER_BIT),e[0]&&(t.setHeight(e[0].getHeight()),t.setWidth(e[0].getWidth())),t}};class _O{constructor(e){this.gl=e.gl,this.textureManager=e.textureManager,this.bufferIndex=0,this.frameBufferObjectsPool=[this.gl.createFramebuffer(),this.gl.createFramebuffer(),this.gl.createFramebuffer()]}getFrameBufferObject(){const e=this.frameBufferObjectsPool[this.bufferIndex];return this.bufferIndex=this.bufferIndex++%this.frameBufferObjectsPool.length,e}create(e){let t;return t=e===tO.SYSTEM_NODES.FILTERS.RENDER_TO_CANVAS?new SO({gl:this.gl}):new CO({gl:this.gl,textureManager:this.textureManager,frameBufferObject:this.getFrameBufferObject()}),t}}function EO(e,t,n){const i=e.createShader(t);if(e.shaderSource(i,n),e.compileShader(i),e.getShaderParameter(i,e.COMPILE_STATUS))return i;const r=e.getShaderInfoLog(i);throw e.deleteShader(i),new Error(r)}var TO=[-1,-1,1,1,-1,1,-1,1,1,1,1,1],PO=[0,1,2,2,1,3],IO=[0,0,1,0,0,1,1,1];const AO=96,OO=[new Float32Array(new ArrayBuffer(AO)),new Float32Array(new ArrayBuffer(AO)),new Float32Array(new ArrayBuffer(AO)),new Float32Array(new ArrayBuffer(AO)),new Float32Array(new ArrayBuffer(AO)),new Float32Array(new ArrayBuffer(AO))],LO=[new Int16Array(6),new Int16Array(6),new Int16Array(6)];class NO{constructor(e,t,n){return this.gl=n.gl,this.program=n.program,this.bindPoint=t,this.location=this.gl.getAttribLocation(this.program,e),this.buffer=this.gl.createBuffer(),this.floatBufferCounter=0,this.unit16BufferCounter=0,{fillBuffer:this.fillBuffer.bind(this),bindBuffer:this.bindBuffer.bind(this),setPointer:this.setPointer.bind(this),dispose:this.dispose.bind(this)}}enable(){this.gl.enableVertexAttribArray(this.location)}bindBuffer(){this.gl.bindBuffer(this.bindPoint,this.buffer)}getBuffer(){let e;switch(this.bindPoint){case this.gl.ARRAY_BUFFER:e=OO[this.floatBufferCounter],this.floatBufferCounter=this.floatBufferCounter++%OO.length;break;case this.gl.ELEMENT_ARRAY_BUFFER:e=LO[this.unit16BufferCounter],this.unit16BufferCounter=this.unit16BufferCounter++%LO.length;break;default:throw new Error("cant get buffer for this bind point: ",this.bindPoint)}return e}fillBuffer(e){this.bindBuffer();const t=this.getBuffer();t.set(e,0),this.gl.bufferData(this.bindPoint,t,this.gl.STATIC_DRAW)}getPointerData(){throw new Error("you should impl this function")}setPointer(){this.bindBuffer(),this.enable();const e=this.getPointerData();this.gl.vertexAttribPointer(this.location,e.size,e.type,e.normalize,e.stride,e.offset)}dispose(){this.gl.deleteBuffer(this.buffer)}}const RO={position_3d:class extends NO{getPointerData(){return{size:3,type:this.gl.FLOAT,normalize:!1,stride:0,offset:0}}},position_indexes:class extends NO{setPointer(){}getPointerData(){}enable(){}},texture_coordinate_2d:class extends NO{getPointerData(){return{size:2,type:this.gl.FLOAT,normalize:!0,stride:0,offset:0}}}};var DO=function(e,t,n){const i=RO[e];if(!i)throw new Error(`${e} is not a attribute name,choose from  list: ${Object.keys(RO)}`);return new i(e,t,n)};class MO{constructor(e,t){this.gl=t.gl,this.program=t.program,this.location=this.gl.getUniformLocation(this.program,e)}compute(){return this}set(){return this}}class FO extends MO{set(e){this.gl.uniform1fv(this.location,e)}}class BO extends MO{set(e){e&&(e.beforeUse(),this.gl.uniform1i(this.location,e.getUnit()))}}const UO="first_texture_dimensions",jO="viewport_dimensions",zO="time",VO={RUNTIME_OPTIONS:"runtimeOptions[0]",STATIC_OPTIONS:"staticOptions[0]",FIRST_TEXTURE:"first_texture",SECOND_TEXTURE:"second_texture",FIRST_MATRIX:"first_mat4"},WO={[VO.FIRST_TEXTURE]:BO,[VO.SECOND_TEXTURE]:BO,[VO.FIRST_MATRIX]:class extends MO{set(e){this.gl.uniformMatrix4fv(this.location,!1,e)}},[VO.STATIC_OPTIONS]:FO,[VO.RUNTIME_OPTIONS]:FO};let HO=100,$O=100;const GO="position_3d",qO="position_indexes",YO="texture_coordinate_2d";class KO{constructor(e,t,n,i){var r;this.type=e,this.gl=i.gl,this.frameBuffer=i.frameBufferFactory.create(e),this.vertexShader=EO(r=this.gl,r.VERTEX_SHADER,t.vertex),this.fragmentShader=function(e,t){return EO(e,e.FRAGMENT_SHADER,t)}(this.gl,t.fragment),this.program=function(e,t,n){const i=e.createProgram();if(e.attachShader(i,t),e.attachShader(i,n),e.linkProgram(i),e.getProgramParameter(i,e.LINK_STATUS))return i;const r=e.getProgramInfoLog(i);throw e.deleteProgram(i),new Error(r)}(this.gl,this.vertexShader,this.fragmentShader);const o={gl:this.gl,program:this.program};this.attributes=function(e,t){const n={};return(e=[{id:GO,bindPoint:t.gl.ARRAY_BUFFER},{id:qO,bindPoint:t.gl.ELEMENT_ARRAY_BUFFER},{id:YO,bindPoint:t.gl.ARRAY_BUFFER}].concat(e=e||[])).forEach((e=>{const i=e.id;n[i]=DO(i,e.bindPoint,t)})),n}(n.attributes,o),this.uniforms=function(e,t){const n={};return(e=e||[]).forEach((e=>{const i=e.id;n[i]=function(e,t){const n=WO[e];if(!n)throw new Error(`${e} is not a attribute name,choose from  list: ${Object.keys(WO)}`);return new n(e,t)}(i,t)})),n}(n.uniforms,o),this.gl.useProgram(this.program),i.__handleAttributesInitedOnce||(this.handleAttributes(),i.__handleAttributesInitedOnce=!0),this.handleStaticUniforms(i.options)}static getFilterType(){throw new Error("impl in concrete class")}static getInputsCount(){throw new Error(`impl in concrete class ${this.getFilterType()}`)}static getInitialOptions(){throw new Error(`impl in concrete class ${this.getFilterType()}`)}static getUniformInfo(e){let t=[{id:VO.RUNTIME_OPTIONS},{id:VO.STATIC_OPTIONS}];return(e.getUniformList||KO.getUniformList)().forEach((e=>{Object.values(VO).includes(e)&&t.push({id:e})})),t}handleRuntimeUniforms(e,t){const{inputTextures:n,viewportDimensions:i}=e;let r=Array.isArray(n)?n:[n],o=[];(this.constructor.getUniformList||KO.getUniformList)().forEach((e=>{switch(e){case VO.FIRST_TEXTURE:this.uniforms[VO.FIRST_TEXTURE].set(r[0]);break;case VO.SECOND_TEXTURE:this.uniforms[VO.SECOND_TEXTURE].set(r[1]);break;case UO:o=[...o,r[0].getWidth(),r[0].getHeight()];break;case jO:o=[...o,i.width,i.height];break;case zO:{const e=function(e,t){let n=(Date.now()-e||0)/(t||1);return n=Number.parseFloat(n).toFixed(7),n=Math.min(1,n),n}(t.startTime,t.duration);o=[...o,e];break}}})),o.length>0&&this.uniforms[VO.RUNTIME_OPTIONS].set(o)}static getUniformList(){return[VO.FIRST_TEXTURE]}getOptionsDisplay(){return[]}handleStaticUniforms(){}handleAttributes(){this.attributes[GO].fillBuffer(TO),this.attributes[GO].setPointer(),this.attributes[qO].fillBuffer(PO),this.attributes[YO].fillBuffer(IO),this.attributes[YO].setPointer()}disposeAttributes(){Object.values(this.attributes).forEach((e=>{e.dispose()}))}render(e,t){const n=this.frameBuffer.bind(e);let i={width:HO,height:$O};return this.gl.useProgram(this.program),this.handleRuntimeUniforms({inputTextures:e,viewportDimensions:i},t),this.draw(),n}draw(){this.gl.drawElements(this.gl.TRIANGLES,6,this.gl.UNSIGNED_SHORT,0)}updateStaticUniforms(e){this.gl.useProgram(this.program),this.handleStaticUniforms(e)}dispose(){this.gl.detachShader(this.program,this.vertexShader),this.gl.deleteShader(this.vertexShader),this.gl.detachShader(this.program,this.fragmentShader),this.gl.deleteShader(this.fragmentShader),this.gl.deleteProgram(this.program)}}class XO extends KO{constructor(e){const t={uniforms:KO.getUniformInfo(XO)};super(XO.getFilterType(),{vertex:"attribute vec3 position_3d;attribute vec2 texture_coordinate_2d;varying vec2 current_texture_coordinate_2d;void main(){float flip_y_position=position_3d.y*(-1.0);vec4 normalize_poistion=vec4(position_3d.x,flip_y_position,position_3d.z,1);gl_Position=normalize_poistion;current_texture_coordinate_2d=texture_coordinate_2d;}",fragment:"precision lowp float;uniform sampler2D first_texture;varying vec2 current_texture_coordinate_2d;void main(){gl_FragColor=texture2D(first_texture,current_texture_coordinate_2d);}"},t,e)}static getFilterType(){return"__default"}static getInputsCount(){return 1}static getInitialOptions(){return{}}}var QO,ZO="undefined"!=typeof Float32Array?Float32Array:Array;function JO(){var e=new ZO(3);return ZO!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function eL(e,t,n){var i=new ZO(3);return i[0]=e,i[1]=t,i[2]=n,i}function tL(){var e=new ZO(4);return ZO!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)}),JO(),function(){var e;e=new ZO(4),ZO!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0)}(),JO(),eL(1,0,0),eL(0,1,0),tL(),tL(),QO=new ZO(9),ZO!=Float32Array&&(QO[1]=0,QO[2]=0,QO[3]=0,QO[5]=0,QO[6]=0,QO[7]=0),QO[0]=1,QO[4]=1,QO[8]=1;class nL extends KO{constructor(e){const t={uniforms:KO.getUniformInfo(nL)};super(nL.getFilterType(),{vertex:"attribute vec3 position_3d;attribute vec2 texture_coordinate_2d;uniform mat4 first_mat4;varying vec2 current_texture_coordinate_2d;void main(){vec4 normalize_poistion=vec4(position_3d.xy,1,1);gl_Position=first_mat4*normalize_poistion;current_texture_coordinate_2d=texture_coordinate_2d;}",fragment:"precision lowp float;uniform sampler2D first_texture;varying vec2 current_texture_coordinate_2d;void main(){gl_FragColor=texture2D(first_texture,current_texture_coordinate_2d);}"},t,e)}static getFilterType(){return"transform"}static getInputsCount(){return 1}static getInitialOptions(){return{translate:{x:0,y:0},scale:{x:1,y:1},rotate:0}}getOptionsDisplay(){return[{properties:["translate","x"],type:"slider",minValue:-2,maxValue:2,step:.001,initialValue:nL.getInitialOptions().translate.x},{properties:["translate","y"],type:"slider",minValue:-2,maxValue:2,step:.001,initialValue:nL.getInitialOptions().translate.y},{properties:["scale","x"],type:"slider",minValue:-10,maxValue:10,step:.001,initialValue:nL.getInitialOptions().scale.x},{properties:["scale","y"],type:"slider",minValue:-10,maxValue:10,step:.001,initialValue:nL.getInitialOptions().scale.y},{properties:["rotate"],type:"slider",minValue:-360,maxValue:360,step:1,initialValue:nL.getInitialOptions().rotate}]}static getUniformList(){return[VO.FIRST_TEXTURE,VO.FIRST_MATRIX]}handleStaticUniforms(e){if(!e||!e.translate||!e.scale)throw new Error(`bad options object for Transform filter, check ${e}`);const t=Number.parseFloat(e.translate.x).toFixed(7),n=-1*Number.parseFloat(e.translate.y).toFixed(7),i=Number.parseFloat(e.scale.x).toFixed(7),r=Number.parseFloat(e.scale.y).toFixed(7),o=e.rotate||0;this.transformMatrix=function(e,t,n,i){var r=t[0],o=t[1],s=t[2],a=t[3],l=r+r,c=o+o,u=s+s,d=r*l,h=r*c,p=r*u,f=o*c,g=o*u,m=s*u,y=a*l,v=a*c,b=a*u,w=i[0],k=i[1],x=i[2];return e[0]=(1-(f+m))*w,e[1]=(h+b)*w,e[2]=(p-v)*w,e[3]=0,e[4]=(h-b)*k,e[5]=(1-(d+m))*k,e[6]=(g+y)*k,e[7]=0,e[8]=(p+v)*x,e[9]=(g-y)*x,e[10]=(1-(d+f))*x,e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e}(function(){var e=new ZO(16);return ZO!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}(),function(e,t,n,i){var r=.5*Math.PI/180;t*=r,n*=r,i*=r;var o=Math.sin(t),s=Math.cos(t),a=Math.sin(n),l=Math.cos(n),c=Math.sin(i),u=Math.cos(i);return e[0]=o*l*u-s*a*c,e[1]=s*a*u+o*l*c,e[2]=s*l*c-o*a*u,e[3]=s*l*u+o*a*c,e}(tL(),0,0,o),eL(t,n,0),eL(i,r,1)),this.uniforms[VO.FIRST_MATRIX].set(this.transformMatrix)}}class iL extends KO{constructor(e){const t={uniforms:KO.getUniformInfo(iL)};super(iL.getFilterType(),{vertex:"attribute vec3 position_3d;attribute vec2 texture_coordinate_2d;uniform float runtimeOptions[2];varying vec2 blur_texture_coordinate_2d[11];void main(){vec2 normalize_poistion=vec2(position_3d.xy);gl_Position=vec4(normalize_poistion,1,1);float texture_width=runtimeOptions[0];float pixel_width=1.0/texture_width;for(int i=-5;i<5;++i){float current_i=float(i);blur_texture_coordinate_2d[i+5]=texture_coordinate_2d+vec2(pixel_width*current_i,0.0);}}",fragment:"precision lowp float;uniform sampler2D first_texture;varying vec2 blur_texture_coordinate_2d[11];void main(){vec4 out_colour=vec4(0.0);out_colour+=texture2D(first_texture,blur_texture_coordinate_2d[0])*0.0093;out_colour+=texture2D(first_texture,blur_texture_coordinate_2d[1])*0.028002;out_colour+=texture2D(first_texture,blur_texture_coordinate_2d[2])*0.065984;out_colour+=texture2D(first_texture,blur_texture_coordinate_2d[3])*0.121703;out_colour+=texture2D(first_texture,blur_texture_coordinate_2d[4])*0.175713;out_colour+=texture2D(first_texture,blur_texture_coordinate_2d[5])*0.198596;out_colour+=texture2D(first_texture,blur_texture_coordinate_2d[6])*0.175713;out_colour+=texture2D(first_texture,blur_texture_coordinate_2d[7])*0.121703;out_colour+=texture2D(first_texture,blur_texture_coordinate_2d[8])*0.065984;out_colour+=texture2D(first_texture,blur_texture_coordinate_2d[9])*0.028002;out_colour+=texture2D(first_texture,blur_texture_coordinate_2d[10])*0.0093;gl_FragColor=out_colour;}"},t,e)}static getFilterType(){return"horizontalBlur"}static getInputsCount(){return 1}static getInitialOptions(){return{}}static getUniformList(){return[VO.FIRST_TEXTURE,UO]}}class rL extends KO{constructor(e){const t={uniforms:KO.getUniformInfo(rL)};super(rL.getFilterType(),{vertex:"attribute vec3 position_3d;attribute vec2 texture_coordinate_2d;uniform float runtimeOptions[2];varying vec2 blur_texture_coordinate_2d[11];void main(){vec2 normalize_poistion=vec2(position_3d.xy);gl_Position=vec4(normalize_poistion,1,1);float texture_width=runtimeOptions[1];float pixel_height=1.0/texture_width;for(int i=-5;i<5;++i){float current_i=float(i);blur_texture_coordinate_2d[i+5]=texture_coordinate_2d+vec2(0.0,pixel_height*current_i);}}",fragment:"precision lowp float;uniform sampler2D first_texture;varying vec2 blur_texture_coordinate_2d[11];void main(){vec4 out_colour=vec4(0.0);out_colour+=texture2D(first_texture,blur_texture_coordinate_2d[0])*0.0093;out_colour+=texture2D(first_texture,blur_texture_coordinate_2d[1])*0.028002;out_colour+=texture2D(first_texture,blur_texture_coordinate_2d[2])*0.065984;out_colour+=texture2D(first_texture,blur_texture_coordinate_2d[3])*0.121703;out_colour+=texture2D(first_texture,blur_texture_coordinate_2d[4])*0.175713;out_colour+=texture2D(first_texture,blur_texture_coordinate_2d[5])*0.198596;out_colour+=texture2D(first_texture,blur_texture_coordinate_2d[6])*0.175713;out_colour+=texture2D(first_texture,blur_texture_coordinate_2d[7])*0.121703;out_colour+=texture2D(first_texture,blur_texture_coordinate_2d[8])*0.065984;out_colour+=texture2D(first_texture,blur_texture_coordinate_2d[9])*0.028002;out_colour+=texture2D(first_texture,blur_texture_coordinate_2d[10])*0.0093;gl_FragColor=out_colour;}"},t,e)}static getFilterType(){return"verticalBlur"}static getInputsCount(){return 1}static getInitialOptions(){return{}}static getUniformList(){return[VO.FIRST_TEXTURE,UO]}}class oL extends KO{constructor(e){const t={uniforms:KO.getUniformInfo(oL)};super(oL.getFilterType(),{vertex:"attribute vec3 position_3d;attribute vec2 texture_coordinate_2d;varying vec2 current_texture_coordinate_2d;varying vec2 current_position_coordinate_2d;void main(){vec4 normalize_poistion=vec4(position_3d.xyz,1);gl_Position=normalize_poistion;current_texture_coordinate_2d=texture_coordinate_2d;current_position_coordinate_2d=normalize_poistion.xy;}",fragment:"precision lowp float;uniform sampler2D first_texture;uniform float staticOptions[3];uniform float runtimeOptions[4];varying vec2 current_texture_coordinate_2d;varying vec2 current_position_coordinate_2d;const float Depth=3.;const float Samples=8.;float OffsetDist=staticOptions[0];vec2 srcDims=vec2(runtimeOptions[0],runtimeOptions[1]);vec2 vpDims=vec2(runtimeOptions[2],runtimeOptions[3]);vec2 iResolution=vpDims;\n#define TAU 6.28318530718\nvec4 RadialBlur(vec2 fragCoord,float radius){if(radius<=0.){return texture2D(first_texture,fragCoord/iResolution.xy);}vec2 offset;float angle=0.;vec4 color=vec4(0.);for(float angle=0.;angle<TAU;angle+=(TAU/Samples)){offset=vec2(cos(angle),sin(angle))*radius;color+=texture2D(first_texture,(fragCoord+offset)/iResolution.xy);}return color/Samples;}vec4 FastBlur(vec2 fragCoord){vec4 color;vec2 offset;float fib=2.;float fibTotal=0.;for(float i=1.;i<=Depth;++i){fib+=i;color+=RadialBlur(fragCoord,i*OffsetDist)/fib;fibTotal+=1./fib;}return color/fibTotal;}void main(){vec2 fragCoords=vec2(current_texture_coordinate_2d)*vpDims;gl_FragColor=FastBlur(fragCoords);}"},t,e)}static getFilterType(){return"fastBlur"}static getInputsCount(){return 1}static getInitialOptions(){return{}}static getUniformList(){return[VO.FIRST_TEXTURE,UO,jO]}handleStaticUniforms(e){var t;const n=(null!==(t=Number.parseFloat(e.offsetDist))&&void 0!==t?t:4).toFixed(3);this.uniforms[VO.STATIC_OPTIONS].set([n])}}class sL extends KO{constructor(e){const t={uniforms:KO.getUniformInfo(sL)};super(sL.getFilterType(),{vertex:"attribute vec3 position_3d;attribute vec2 texture_coordinate_2d;varying vec2 current_texture_coordinate_2d;varying vec2 current_position_coordinate_2d;void main(){vec4 normalize_poistion=vec4(position_3d.xyz,1);gl_Position=normalize_poistion;current_texture_coordinate_2d=texture_coordinate_2d;current_position_coordinate_2d=normalize_poistion.xy;}",fragment:"precision lowp float;uniform sampler2D first_texture;uniform float staticOptions[2];uniform float runtimeOptions[4];varying vec2 current_texture_coordinate_2d;varying vec2 current_position_coordinate_2d;vec2 vpDims=vec2(runtimeOptions[2],runtimeOptions[3]);vec4 dirBlur(){float angle=staticOptions[0];float strength=staticOptions[1];if(strength==0.0){return texture2D(first_texture,current_texture_coordinate_2d);}vec2 uv=current_texture_coordinate_2d;float r=radians(angle);vec2 direction=vec2(sin(r),cos(r));vec2 strengthDirection=strength*direction;vec3 acc=vec3(0);for(float i=-1.0;i<=1.0;i+=(2.0/50.0)){acc+=texture2D(first_texture,uv-vec2(strengthDirection.x*i,strengthDirection.y*i)).rgb*(2.0/50.0)*.5;}return vec4(acc,1.0);}void main(){gl_FragColor=dirBlur();}"},t,e)}static getFilterType(){return"directionalBlur"}static getInputsCount(){return 1}static getInitialOptions(){return{}}static getUniformList(){return[VO.FIRST_TEXTURE,UO,jO]}handleStaticUniforms(e){var t,n;const i=(null!==(t=Number.parseFloat(e.angle))&&void 0!==t?t:90).toFixed(3),r=(null!==(n=Number.parseFloat(e.strength))&&void 0!==n?n:.1).toFixed(3);this.uniforms[VO.STATIC_OPTIONS].set([i,r])}}class aL extends KO{constructor(e){const t={uniforms:KO.getUniformInfo(aL)};super(aL.getFilterType(),{vertex:"attribute vec3 position_3d;attribute vec2 texture_coordinate_2d;varying vec2 current_texture_coordinate_2d;void main(){vec4 normalize_poistion=vec4(position_3d.xyz,1);gl_Position=normalize_poistion;current_texture_coordinate_2d=texture_coordinate_2d;}",fragment:"precision lowp float;uniform sampler2D first_texture;uniform float staticOptions[1];varying vec2 current_texture_coordinate_2d;void main(){vec4 texture=texture2D(first_texture,current_texture_coordinate_2d);float opacity=texture.w-(1.0-staticOptions[0]);gl_FragColor=vec4((texture.xyz),opacity);}"},t,e)}static getFilterType(){return"opacity"}static getInputsCount(){return 1}static getInitialOptions(){return{power:1}}getOptionsDisplay(){return[{properties:["power"],type:"slider",minValue:0,maxValue:1,step:.001}]}handleStaticUniforms(e){const t=Number.parseFloat(e.power).toFixed(7);this.uniforms[VO.STATIC_OPTIONS].set([t])}}class lL extends KO{constructor(e){const t={uniforms:KO.getUniformInfo(lL)};super(lL.getFilterType(),{vertex:"attribute vec3 position_3d;attribute vec2 texture_coordinate_2d;varying vec2 current_texture_coordinate_2d;void main(){vec4 normalize_poistion=vec4(position_3d.xyz,1);gl_Position=normalize_poistion;current_texture_coordinate_2d=texture_coordinate_2d;}",fragment:"precision lowp float;uniform sampler2D first_texture;uniform sampler2D second_texture;varying vec2 current_texture_coordinate_2d;void main(){vec4 fgColor=texture2D(first_texture,current_texture_coordinate_2d);vec4 bgColor=texture2D(second_texture,current_texture_coordinate_2d);gl_FragColor=vec4(mix(bgColor.xyz,fgColor.xyz,fgColor.w),1.0);}"},t,e)}static getFilterType(){return"shapeComposite"}static getInputsCount(){return 2}static getInitialOptions(){return{}}static getUniformList(){return[VO.FIRST_TEXTURE,VO.SECOND_TEXTURE]}}class cL extends KO{constructor(e){const t={uniforms:KO.getUniformInfo(cL)};super(cL.getFilterType(),{vertex:"attribute vec3 position_3d;attribute vec2 texture_coordinate_2d;varying vec2 current_texture_coordinate_2d;void main(){vec4 normalize_poistion=vec4(position_3d.xyz,1);gl_Position=normalize_poistion;current_texture_coordinate_2d=texture_coordinate_2d;}",fragment:"precision lowp float;uniform sampler2D first_texture;uniform sampler2D second_texture;varying vec2 current_texture_coordinate_2d;void main(){vec4 textureColor=texture2D(first_texture,current_texture_coordinate_2d);mediump float blueColor=textureColor.b*63.0;mediump vec2 quad1;quad1.y=floor(floor(blueColor)/8.0);quad1.x=floor(blueColor)-(quad1.y*8.0);mediump vec2 quad2;quad2.y=floor(ceil(blueColor)/8.0);quad2.x=ceil(blueColor)-(quad2.y*8.0);highp vec2 texPos1;texPos1.x=(quad1.x*0.125)+0.5/512.0+((0.125-1.0/512.0)*textureColor.r);texPos1.y=(quad1.y*0.125)+0.5/512.0+((0.125-1.0/512.0)*textureColor.g);highp vec2 texPos2;texPos2.x=(quad2.x*0.125)+0.5/512.0+((0.125-1.0/512.0)*textureColor.r);texPos2.y=(quad2.y*0.125)+0.5/512.0+((0.125-1.0/512.0)*textureColor.g);lowp vec4 newColor1=texture2D(second_texture,texPos1);lowp vec4 newColor2=texture2D(second_texture,texPos2);lowp vec4 color=mix(newColor1,newColor2,fract(blueColor));gl_FragColor=color;}"},t,e)}static getFilterType(){return"lut"}static getInputsCount(){return 2}static getInitialOptions(){return{}}static getUniformList(){return[VO.FIRST_TEXTURE,VO.SECOND_TEXTURE]}getOptionsDisplay(){return[]}handleStaticUniforms(e){const t=Number.parseFloat(e.lutSize).toFixed(1);this.uniforms[VO.STATIC_OPTIONS].set([t])}}var uL="attribute vec3 position_3d;attribute vec2 texture_coordinate_2d;varying vec2 current_texture_coordinate_2d;void main(){vec4 normalize_poistion=vec4(position_3d.xyz,1);gl_Position=normalize_poistion;current_texture_coordinate_2d=texture_coordinate_2d;}",dL="precision lowp float;uniform sampler2D first_texture;varying vec2 current_texture_coordinate_2d;uniform float staticOptions[256];int round(float val){return int(floor(val+0.5));}float getCurveValue(float pixelValue){float v;for(int k=0;k<256;k++){if(k==round(pixelValue*255.0)){v=float(staticOptions[k])/255.0;}}return v;}vec3 masterCurve(vec4 color){float r=getCurveValue(color.r);float g=getCurveValue(color.g);float b=getCurveValue(color.b);return vec3(r,g,b);}void main(){vec4 textureColor=texture2D(first_texture,current_texture_coordinate_2d);vec3 afterMaster=masterCurve(textureColor);vec4 finalColor=vec4(afterMaster,textureColor.a);gl_FragColor=finalColor;}";const{abs:hL,cos:pL,sin:fL,acos:gL,atan2:mL,sqrt:yL,pow:vL}=Math;function bL(e){return e<0?-vL(-e,1/3):vL(e,1/3)}const wL=Math.PI,kL=2*wL,xL=wL/2,SL=Number.MAX_SAFE_INTEGER||9007199254740991,CL=Number.MIN_SAFE_INTEGER||-9007199254740991,_L={x:0,y:0,z:0},EL={Tvalues:[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213],Cvalues:[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872],arcfn:function(e,t){const n=t(e);let i=n.x*n.x+n.y*n.y;return void 0!==n.z&&(i+=n.z*n.z),yL(i)},compute:function(e,t,n){if(0===e)return t[0].t=0,t[0];const i=t.length-1;if(1===e)return t[i].t=1,t[i];const r=1-e;let o=t;if(0===i)return t[0].t=e,t[0];if(1===i){const t={x:r*o[0].x+e*o[1].x,y:r*o[0].y+e*o[1].y,t:e};return n&&(t.z=r*o[0].z+e*o[1].z),t}if(i<4){let t,s,a,l=r*r,c=e*e,u=0;2===i?(o=[o[0],o[1],o[2],_L],t=l,s=r*e*2,a=c):3===i&&(t=l*r,s=l*e*3,a=r*c*3,u=e*c);const d={x:t*o[0].x+s*o[1].x+a*o[2].x+u*o[3].x,y:t*o[0].y+s*o[1].y+a*o[2].y+u*o[3].y,t:e};return n&&(d.z=t*o[0].z+s*o[1].z+a*o[2].z+u*o[3].z),d}const s=JSON.parse(JSON.stringify(t));for(;s.length>1;){for(let t=0;t<s.length-1;t++)s[t]={x:s[t].x+(s[t+1].x-s[t].x)*e,y:s[t].y+(s[t+1].y-s[t].y)*e},void 0!==s[t].z&&(s[t].z=s[t].z+(s[t+1].z-s[t].z)*e);s.splice(s.length-1,1)}return s[0].t=e,s[0]},computeWithRatios:function(e,t,n,i){const r=1-e;let o,s=n[0],a=n[1],l=n[2],c=n[3];return s*=r,a*=e,2===t.length?(o=s+a,{x:(s*t[0].x+a*t[1].x)/o,y:(s*t[0].y+a*t[1].y)/o,z:!!i&&(s*t[0].z+a*t[1].z)/o,t:e}):(s*=r,a*=2*r,l*=e*e,3===t.length?(o=s+a+l,{x:(s*t[0].x+a*t[1].x+l*t[2].x)/o,y:(s*t[0].y+a*t[1].y+l*t[2].y)/o,z:!!i&&(s*t[0].z+a*t[1].z+l*t[2].z)/o,t:e}):(s*=r,a*=1.5*r,l*=3*r,c*=e*e*e,4===t.length?(o=s+a+l+c,{x:(s*t[0].x+a*t[1].x+l*t[2].x+c*t[3].x)/o,y:(s*t[0].y+a*t[1].y+l*t[2].y+c*t[3].y)/o,z:!!i&&(s*t[0].z+a*t[1].z+l*t[2].z+c*t[3].z)/o,t:e}):void 0))},derive:function(e,t){const n=[];for(let i=e,r=i.length,o=r-1;r>1;r--,o--){const e=[];for(let n,r=0;r<o;r++)n={x:o*(i[r+1].x-i[r].x),y:o*(i[r+1].y-i[r].y)},t&&(n.z=o*(i[r+1].z-i[r].z)),e.push(n);n.push(e),i=e}return n},between:function(e,t,n){return t<=e&&e<=n||EL.approximately(e,t)||EL.approximately(e,n)},approximately:function(e,t,n){return hL(e-t)<=(n||1e-6)},length:function(e){const t=EL.Tvalues.length;let n=0;for(let i,r=0;r<t;r++)i=.5*EL.Tvalues[r]+.5,n+=EL.Cvalues[r]*EL.arcfn(i,e);return.5*n},map:function(e,t,n,i,r){return i+(e-t)/(n-t)*(r-i)},lerp:function(e,t,n){const i={x:t.x+e*(n.x-t.x),y:t.y+e*(n.y-t.y)};return void 0!==t.z&&void 0!==n.z&&(i.z=t.z+e*(n.z-t.z)),i},pointToString:function(e){let t=e.x+"/"+e.y;return void 0!==e.z&&(t+="/"+e.z),t},pointsToString:function(e){return"["+e.map(EL.pointToString).join(", ")+"]"},copy:function(e){return JSON.parse(JSON.stringify(e))},angle:function(e,t,n){const i=t.x-e.x,r=t.y-e.y,o=n.x-e.x,s=n.y-e.y;return mL(i*s-r*o,i*o+r*s)},round:function(e,t){const n=""+e,i=n.indexOf(".");return parseFloat(n.substring(0,i+1+t))},dist:function(e,t){const n=e.x-t.x,i=e.y-t.y;return yL(n*n+i*i)},closest:function(e,t){let n,i,r=vL(2,63);return e.forEach((function(e,o){i=EL.dist(t,e),i<r&&(r=i,n=o)})),{mdist:r,mpos:n}},abcratio:function(e,t){if(2!==t&&3!==t)return!1;if(void 0===e)e=.5;else if(0===e||1===e)return e;const n=vL(e,t)+vL(1-e,t);return hL((n-1)/n)},projectionratio:function(e,t){if(2!==t&&3!==t)return!1;if(void 0===e)e=.5;else if(0===e||1===e)return e;const n=vL(1-e,t);return n/(vL(e,t)+n)},lli8:function(e,t,n,i,r,o,s,a){const l=(e-n)*(o-a)-(t-i)*(r-s);return 0!=l&&{x:((e*i-t*n)*(r-s)-(e-n)*(r*a-o*s))/l,y:((e*i-t*n)*(o-a)-(t-i)*(r*a-o*s))/l}},lli4:function(e,t,n,i){return EL.lli8(e.x,e.y,t.x,t.y,n.x,n.y,i.x,i.y)},lli:function(e,t){return EL.lli4(e,e.c,t,t.c)},makeline:function(e,t){return new ML(e.x,e.y,(e.x+t.x)/2,(e.y+t.y)/2,t.x,t.y)},findbbox:function(e){let t=SL,n=SL,i=CL,r=CL;return e.forEach((function(e){const o=e.bbox();t>o.x.min&&(t=o.x.min),n>o.y.min&&(n=o.y.min),i<o.x.max&&(i=o.x.max),r<o.y.max&&(r=o.y.max)})),{x:{min:t,mid:(t+i)/2,max:i,size:i-t},y:{min:n,mid:(n+r)/2,max:r,size:r-n}}},shapeintersections:function(e,t,n,i,r){if(!EL.bboxoverlap(t,i))return[];const o=[],s=[n.startcap,n.forward,n.back,n.endcap];return[e.startcap,e.forward,e.back,e.endcap].forEach((function(t){t.virtual||s.forEach((function(i){if(i.virtual)return;const s=t.intersects(i,r);s.length>0&&(s.c1=t,s.c2=i,s.s1=e,s.s2=n,o.push(s))}))})),o},makeshape:function(e,t,n){const i=e.points.length,r=EL.makeline(t.points[t.points.length-1],e.points[0]),o=EL.makeline(e.points[i-1],t.points[0]),s={startcap:r,forward:e,back:t,endcap:o,bbox:EL.findbbox([r,e,t,o]),intersections:function(e){return EL.shapeintersections(s,s.bbox,e,e.bbox,n)}};return s},getminmax:function(e,t,n){if(!n)return{min:0,max:0};let i,r,o=SL,s=CL;-1===n.indexOf(0)&&(n=[0].concat(n)),-1===n.indexOf(1)&&n.push(1);for(let a=0,l=n.length;a<l;a++)i=n[a],r=e.get(i),r[t]<o&&(o=r[t]),r[t]>s&&(s=r[t]);return{min:o,mid:(o+s)/2,max:s,size:s-o}},align:function(e,t){const n=t.p1.x,i=t.p1.y,r=-mL(t.p2.y-i,t.p2.x-n);return e.map((function(e){return{x:(e.x-n)*pL(r)-(e.y-i)*fL(r),y:(e.x-n)*fL(r)+(e.y-i)*pL(r)}}))},roots:function(e,t){const n=e.length-1,i=EL.align(e,t=t||{p1:{x:0,y:0},p2:{x:1,y:0}}),r=function(e){return 0<=e&&e<=1};if(2===n){const e=i[0].y,t=i[1].y,n=i[2].y,o=e-2*t+n;if(0!==o){const i=-yL(t*t-e*n),s=-e+t;return[-(i+s)/o,-(-i+s)/o].filter(r)}return t!==n&&0===o?[(2*t-n)/(2*t-2*n)].filter(r):[]}const o=i[0].y,s=i[1].y,a=i[2].y;let l=3*s-o-3*a+i[3].y,c=3*o-6*s+3*a,u=-3*o+3*s,d=o;if(EL.approximately(l,0)){if(EL.approximately(c,0))return EL.approximately(u,0)?[]:[-d/u].filter(r);const e=yL(u*u-4*c*d),t=2*c;return[(e-u)/t,(-u-e)/t].filter(r)}c/=l,u/=l,d/=l;const h=(3*u-c*c)/3,p=h/3,f=(2*c*c*c-9*c*u+27*d)/27,g=f/2,m=g*g+p*p*p;let y,v,b,w,k;if(m<0){const e=-h/3,t=yL(e*e*e),n=-f/(2*t),i=gL(n<-1?-1:n>1?1:n),o=2*bL(t);return b=o*pL(i/3)-c/3,w=o*pL((i+kL)/3)-c/3,k=o*pL((i+2*kL)/3)-c/3,[b,w,k].filter(r)}if(0===m)return y=g<0?bL(-g):-bL(g),b=2*y-c/3,w=-y-c/3,[b,w].filter(r);{const e=yL(m);return y=bL(-g+e),v=bL(g+e),[y-v-c/3].filter(r)}},droots:function(e){if(3===e.length){const t=e[0],n=e[1],i=e[2],r=t-2*n+i;if(0!==r){const e=-yL(n*n-t*i),o=-t+n;return[-(e+o)/r,-(-e+o)/r]}return n!==i&&0===r?[(2*n-i)/(2*(n-i))]:[]}if(2===e.length){const t=e[0],n=e[1];return t!==n?[t/(t-n)]:[]}return[]},curvature:function(e,t,n,i,r){let o,s,a,l,c=0,u=0;const d=EL.compute(e,t),h=EL.compute(e,n),p=d.x*d.x+d.y*d.y;if(i?(o=yL(vL(d.y*h.z-h.y*d.z,2)+vL(d.z*h.x-h.z*d.x,2)+vL(d.x*h.y-h.x*d.y,2)),s=vL(p+d.z*d.z,1.5)):(o=d.x*h.y-d.y*h.x,s=vL(p,1.5)),0===o||0===s)return{k:0,r:0};if(c=o/s,u=s/o,!r){const r=EL.curvature(e-.001,t,n,i,!0).k,o=EL.curvature(e+.001,t,n,i,!0).k;l=(o-c+(c-r))/2,a=(hL(o-c)+hL(c-r))/2}return{k:c,r:u,dk:l,adk:a}},inflections:function(e){if(e.length<4)return[];const t=EL.align(e,{p1:e[0],p2:e.slice(-1)[0]}),n=t[2].x*t[1].y,i=t[3].x*t[1].y,r=t[1].x*t[2].y,o=18*(-3*n+2*i+3*r-t[3].x*t[2].y),s=18*(3*n-i-3*r),a=18*(r-n);if(EL.approximately(o,0)){if(!EL.approximately(s,0)){let e=-a/s;if(0<=e&&e<=1)return[e]}return[]}const l=2*o;if(EL.approximately(l,0))return[];const c=s*s-4*o*a;if(c<0)return[];const u=Math.sqrt(c);return[(u-s)/l,-(s+u)/l].filter((function(e){return 0<=e&&e<=1}))},bboxoverlap:function(e,t){const n=["x","y"],i=n.length;for(let r,o,s,a,l=0;l<i;l++)if(r=n[l],o=e[r].mid,s=t[r].mid,a=(e[r].size+t[r].size)/2,hL(o-s)>=a)return!1;return!0},expandbox:function(e,t){t.x.min<e.x.min&&(e.x.min=t.x.min),t.y.min<e.y.min&&(e.y.min=t.y.min),t.z&&t.z.min<e.z.min&&(e.z.min=t.z.min),t.x.max>e.x.max&&(e.x.max=t.x.max),t.y.max>e.y.max&&(e.y.max=t.y.max),t.z&&t.z.max>e.z.max&&(e.z.max=t.z.max),e.x.mid=(e.x.min+e.x.max)/2,e.y.mid=(e.y.min+e.y.max)/2,e.z&&(e.z.mid=(e.z.min+e.z.max)/2),e.x.size=e.x.max-e.x.min,e.y.size=e.y.max-e.y.min,e.z&&(e.z.size=e.z.max-e.z.min)},pairiteration:function(e,t,n){const i=e.bbox(),r=t.bbox(),o=1e5,s=n||.5;if(i.x.size+i.y.size<s&&r.x.size+r.y.size<s)return[(o*(e._t1+e._t2)/2|0)/o+"/"+(o*(t._t1+t._t2)/2|0)/o];let a=e.split(.5),l=t.split(.5),c=[{left:a.left,right:l.left},{left:a.left,right:l.right},{left:a.right,right:l.right},{left:a.right,right:l.left}];c=c.filter((function(e){return EL.bboxoverlap(e.left.bbox(),e.right.bbox())}));let u=[];return 0===c.length||(c.forEach((function(e){u=u.concat(EL.pairiteration(e.left,e.right,s))})),u=u.filter((function(e,t){return u.indexOf(e)===t}))),u},getccenter:function(e,t,n){const i=t.x-e.x,r=t.y-e.y,o=n.x-t.x,s=n.y-t.y,a=i*pL(xL)-r*fL(xL),l=i*fL(xL)+r*pL(xL),c=o*pL(xL)-s*fL(xL),u=o*fL(xL)+s*pL(xL),d=(e.x+t.x)/2,h=(e.y+t.y)/2,p=(t.x+n.x)/2,f=(t.y+n.y)/2,g=EL.lli8(d,h,d+a,h+l,p,f,p+c,f+u),m=EL.dist(g,e);let y,v=mL(e.y-g.y,e.x-g.x),b=mL(t.y-g.y,t.x-g.x),w=mL(n.y-g.y,n.x-g.x);return v<w?((v>b||b>w)&&(v+=kL),v>w&&(y=w,w=v,v=y)):w<b&&b<v?(y=w,w=v,v=y):w+=kL,g.s=v,g.e=w,g.r=m,g},numberSort:function(e,t){return e-t}};class TL{constructor(e){this.curves=[],this._3d=!1,e&&(this.curves=e,this._3d=this.curves[0]._3d)}valueOf(){return this.toString()}toString(){return"["+this.curves.map((function(e){return EL.pointsToString(e.points)})).join(", ")+"]"}addCurve(e){this.curves.push(e),this._3d=this._3d||e._3d}length(){return this.curves.map((function(e){return e.length()})).reduce((function(e,t){return e+t}))}curve(e){return this.curves[e]}bbox(){const e=this.curves;for(var t=e[0].bbox(),n=1;n<e.length;n++)EL.expandbox(t,e[n].bbox());return t}offset(e){const t=[];return this.curves.forEach((function(n){t.push(...n.offset(e))})),new TL(t)}}const{abs:PL,min:IL,max:AL,cos:OL,sin:LL,acos:NL,sqrt:RL}=Math,DL=Math.PI;let ML=class e{constructor(e){let t=e&&e.forEach?e:Array.from(arguments).slice(),n=!1;if("object"==typeof t[0]){n=t.length;const e=[];t.forEach((function(t){["x","y","z"].forEach((function(n){void 0!==t[n]&&e.push(t[n])}))})),t=e}let i=!1;const r=t.length;if(n){if(n>4){if(1!==arguments.length)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");i=!0}}else if(6!==r&&8!==r&&9!==r&&12!==r&&1!==arguments.length)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");const o=this._3d=!i&&(9===r||12===r)||e&&e[0]&&void 0!==e[0].z,s=this.points=[];for(let e=0,n=o?3:2;e<r;e+=n){var a={x:t[e],y:t[e+1]};o&&(a.z=t[e+2]),s.push(a)}const l=this.order=s.length-1,c=this.dims=["x","y"];o&&c.push("z"),this.dimlen=c.length;const u=EL.align(s,{p1:s[0],p2:s[l]}),d=EL.dist(s[0],s[l]);this._linear=u.reduce(((e,t)=>e+PL(t.y)),0)<d/50,this._lut=[],this._t1=0,this._t2=1,this.update()}static quadraticFromPoints(t,n,i,r){if(void 0===r&&(r=.5),0===r)return new e(n,n,i);if(1===r)return new e(t,n,n);const o=e.getABC(2,t,n,i,r);return new e(t,o.A,i)}static cubicFromPoints(t,n,i,r,o){void 0===r&&(r=.5);const s=e.getABC(3,t,n,i,r);void 0===o&&(o=EL.dist(n,s.C));const a=o*(1-r)/r,l=EL.dist(t,i),c=(i.x-t.x)/l,u=(i.y-t.y)/l,d=s.A;return new e(t,{x:t.x+(d.x+(n.x-o*c-d.x)/(1-r)-t.x)/r,y:t.y+(d.y+(n.y-o*u-d.y)/(1-r)-t.y)/r},{x:i.x+(d.x+(n.x+a*c-d.x)/r-i.x)/(1-r),y:i.y+(d.y+(n.y+a*u-d.y)/r-i.y)/(1-r)},i)}static getUtils(){return EL}getUtils(){return e.getUtils()}static get PolyBezier(){return TL}valueOf(){return this.toString()}toString(){return EL.pointsToString(this.points)}toSVG(){if(this._3d)return!1;const e=this.points,t=["M",e[0].x,e[0].y,2===this.order?"Q":"C"];for(let n=1,i=e.length;n<i;n++)t.push(e[n].x),t.push(e[n].y);return t.join(" ")}setRatios(e){if(e.length!==this.points.length)throw new Error("incorrect number of ratio values");this.ratios=e,this._lut=[]}verify(){const e=this.coordDigest();e!==this._print&&(this._print=e,this.update())}coordDigest(){return this.points.map((function(e,t){return""+t+e.x+e.y+(e.z?e.z:0)})).join("")}update(){this._lut=[],this.dpoints=EL.derive(this.points,this._3d),this.computedirection()}computedirection(){const e=this.points,t=EL.angle(e[0],e[this.order],e[1]);this.clockwise=t>0}length(){return EL.length(this.derivative.bind(this))}static getABC(e=2,t,n,i,r=.5){const o=EL.projectionratio(r,e),s=1-o,a={x:o*t.x+s*i.x,y:o*t.y+s*i.y},l=EL.abcratio(r,e);return{A:{x:n.x+(n.x-a.x)/l,y:n.y+(n.y-a.y)/l},B:n,C:a,S:t,E:i}}getABC(t,n){return n=n||this.get(t),e.getABC(this.order,this.points[0],n,this.points[this.order],t)}getLUT(e){if(this.verify(),this._lut.length===(e=e||100)+1)return this._lut;this._lut=[],e++,this._lut=[];for(let t,n,i=0;i<e;i++)n=i/(e-1),t=this.compute(n),t.t=n,this._lut.push(t);return this._lut}on(e,n){n=n||5;const i=this.getLUT(),r=[];for(let t,o=0,s=0;o<i.length;o++)t=i[o],EL.dist(t,e)<n&&(r.push(t),s+=o/i.length);return!!r.length&&(t/=r.length)}project(e){const t=this.getLUT(),n=t.length-1,i=EL.closest(t,e),r=i.mpos,o=(r+1)/n,s=.1/n;let a,l=i.mdist,c=(r-1)/n,u=c;l+=1;for(let t;c<o+s;c+=s)a=this.compute(c),t=EL.dist(e,a),t<l&&(l=t,u=c);return u=u<0?0:u>1?1:u,a=this.compute(u),a.t=u,a.d=l,a}get(e){return this.compute(e)}point(e){return this.points[e]}compute(e){return this.ratios?EL.computeWithRatios(e,this.points,this.ratios,this._3d):EL.compute(e,this.points,this._3d,this.ratios)}raise(){const t=this.points,n=[t[0]],i=t.length;for(let e,r,o=1;o<i;o++)e=t[o],r=t[o-1],n[o]={x:(i-o)/i*e.x+o/i*r.x,y:(i-o)/i*e.y+o/i*r.y};return n[i]=t[i-1],new e(n)}derivative(e){return EL.compute(e,this.dpoints[0],this._3d)}dderivative(e){return EL.compute(e,this.dpoints[1],this._3d)}align(){let t=this.points;return new e(EL.align(t,{p1:t[0],p2:t[t.length-1]}))}curvature(e){return EL.curvature(e,this.dpoints[0],this.dpoints[1],this._3d)}inflections(){return EL.inflections(this.points)}normal(e){return this._3d?this.__normal3(e):this.__normal2(e)}__normal2(e){const t=this.derivative(e),n=RL(t.x*t.x+t.y*t.y);return{t:e,x:-t.y/n,y:t.x/n}}__normal3(e){const t=this.derivative(e),n=this.derivative(e+.01),i=RL(t.x*t.x+t.y*t.y+t.z*t.z),r=RL(n.x*n.x+n.y*n.y+n.z*n.z);t.x/=i,t.y/=i,t.z/=i,n.x/=r,n.y/=r,n.z/=r;const o={x:n.y*t.z-n.z*t.y,y:n.z*t.x-n.x*t.z,z:n.x*t.y-n.y*t.x},s=RL(o.x*o.x+o.y*o.y+o.z*o.z);o.x/=s,o.y/=s,o.z/=s;const a=[o.x*o.x,o.x*o.y-o.z,o.x*o.z+o.y,o.x*o.y+o.z,o.y*o.y,o.y*o.z-o.x,o.x*o.z-o.y,o.y*o.z+o.x,o.z*o.z];return{t:e,x:a[0]*t.x+a[1]*t.y+a[2]*t.z,y:a[3]*t.x+a[4]*t.y+a[5]*t.z,z:a[6]*t.x+a[7]*t.y+a[8]*t.z}}hull(e){let t=this.points,n=[],i=[],r=0;for(i[r++]=t[0],i[r++]=t[1],i[r++]=t[2],3===this.order&&(i[r++]=t[3]);t.length>1;){n=[];for(let o,s=0,a=t.length-1;s<a;s++)o=EL.lerp(e,t[s],t[s+1]),i[r++]=o,n.push(o);t=n}return i}split(t,n){if(0===t&&n)return this.split(n).left;if(1===n)return this.split(t).right;const i=this.hull(t),r={left:new e(2===this.order?[i[0],i[3],i[5]]:[i[0],i[4],i[7],i[9]]),right:new e(2===this.order?[i[5],i[4],i[2]]:[i[9],i[8],i[6],i[3]]),span:i};return r.left._t1=EL.map(0,0,1,this._t1,this._t2),r.left._t2=EL.map(t,0,1,this._t1,this._t2),r.right._t1=EL.map(t,0,1,this._t1,this._t2),r.right._t2=EL.map(1,0,1,this._t1,this._t2),n?(n=EL.map(n,t,1,0,1),r.right.split(n).left):r}extrema(){const e={};let t=[];return this.dims.forEach(function(n){let i=function(e){return e[n]},r=this.dpoints[0].map(i);e[n]=EL.droots(r),3===this.order&&(r=this.dpoints[1].map(i),e[n]=e[n].concat(EL.droots(r))),e[n]=e[n].filter((function(e){return e>=0&&e<=1})),t=t.concat(e[n].sort(EL.numberSort))}.bind(this)),e.values=t.sort(EL.numberSort).filter((function(e,n){return t.indexOf(e)===n})),e}bbox(){const e=this.extrema(),t={};return this.dims.forEach(function(n){t[n]=EL.getminmax(this,n,e[n])}.bind(this)),t}overlaps(e){const t=this.bbox(),n=e.bbox();return EL.bboxoverlap(t,n)}offset(t,n){if(void 0!==n){const e=this.get(t),i=this.normal(t),r={c:e,n:i,x:e.x+i.x*n,y:e.y+i.y*n};return this._3d&&(r.z=e.z+i.z*n),r}if(this._linear){const n=this.normal(0),i=this.points.map((function(e){const i={x:e.x+t*n.x,y:e.y+t*n.y};return e.z&&n.z&&(i.z=e.z+t*n.z),i}));return[new e(i)]}return this.reduce().map((function(e){return e._linear?e.offset(t)[0]:e.scale(t)}))}simple(){if(3===this.order){const e=EL.angle(this.points[0],this.points[3],this.points[1]),t=EL.angle(this.points[0],this.points[3],this.points[2]);if(e>0&&t<0||e<0&&t>0)return!1}const e=this.normal(0),t=this.normal(1);let n=e.x*t.x+e.y*t.y;return this._3d&&(n+=e.z*t.z),PL(NL(n))<DL/3}reduce(){let e,t,n=0,i=0,r=.01,o=[],s=[],a=this.extrema().values;for(-1===a.indexOf(0)&&(a=[0].concat(a)),-1===a.indexOf(1)&&a.push(1),n=a[0],e=1;e<a.length;e++)i=a[e],t=this.split(n,i),t._t1=n,t._t2=i,o.push(t),n=i;return o.forEach((function(e){for(n=0,i=0;i<=1;)for(i=n+r;i<=1.01;i+=r)if(t=e.split(n,i),!t.simple()){if(i-=r,PL(n-i)<r)return[];t=e.split(n,i),t._t1=EL.map(n,0,1,e._t1,e._t2),t._t2=EL.map(i,0,1,e._t1,e._t2),s.push(t),n=i;break}n<1&&(t=e.split(n,1),t._t1=EL.map(n,0,1,e._t1,e._t2),t._t2=e._t2,s.push(t))})),s}translate(t,n,i){i="number"==typeof i?i:n;const r=this.order;let o=this.points.map(((e,t)=>(1-t/r)*n+t/r*i));return new e(this.points.map(((e,n)=>({x:e.x+t.x*o[n],y:e.y+t.y*o[n]}))))}scale(t){const n=this.order;let i=!1;if("function"==typeof t&&(i=t),i&&2===n)return this.raise().scale(i);const r=this.clockwise,o=this.points;if(this._linear)return this.translate(this.normal(0),i?i(0):t,i?i(1):t);const s=i?i(0):t,a=i?i(1):t,l=[this.offset(0,10),this.offset(1,10)],c=[],u=EL.lli4(l[0],l[0].c,l[1],l[1].c);if(!u)throw new Error("cannot scale this curve. Try reducing it first.");return[0,1].forEach((function(e){const t=c[e*n]=EL.copy(o[e*n]);t.x+=(e?a:s)*l[e].n.x,t.y+=(e?a:s)*l[e].n.y})),i?([0,1].forEach((function(e){if(2!==n||!e){var s=o[e+1],a={x:s.x-u.x,y:s.y-u.y},l=i?i((e+1)/n):t;i&&!r&&(l=-l);var d=RL(a.x*a.x+a.y*a.y);a.x/=d,a.y/=d,c[e+1]={x:s.x+l*a.x,y:s.y+l*a.y}}})),new e(c)):([0,1].forEach((e=>{if(2===n&&e)return;const t=c[e*n],i=this.derivative(e);c[e+1]=EL.lli4(t,{x:t.x+i.x,y:t.y+i.y},u,o[e+1])})),new e(c))}outline(t,n,i,r){if(n=void 0===n?t:n,this._linear){const o=this.normal(0),s=this.points[0],a=this.points[this.points.length-1];let l,c,u;void 0===i&&(i=t,r=n),l={x:s.x+o.x*t,y:s.y+o.y*t},u={x:a.x+o.x*i,y:a.y+o.y*i},c={x:(l.x+u.x)/2,y:(l.y+u.y)/2};const d=[l,c,u];l={x:s.x-o.x*n,y:s.y-o.y*n},u={x:a.x-o.x*r,y:a.y-o.y*r},c={x:(l.x+u.x)/2,y:(l.y+u.y)/2};const h=[u,c,l],p=EL.makeline(h[2],d[0]),f=EL.makeline(d[2],h[0]),g=[p,new e(d),f,new e(h)];return new TL(g)}const o=this.reduce(),s=o.length,a=[];let l,c=[],u=0,d=this.length();const h=void 0!==i&&void 0!==r;function p(e,t,n,i,r){return function(o){const s=t-e;return EL.map(o,0,1,e+i/n*s,e+(i+r)/n*s)}}o.forEach((function(e){const o=e.length();h?(a.push(e.scale(p(t,i,d,u,o))),c.push(e.scale(p(-n,-r,d,u,o)))):(a.push(e.scale(t)),c.push(e.scale(-n))),u+=o})),c=c.map((function(e){return l=e.points,e.points=l[3]?[l[3],l[2],l[1],l[0]]:[l[2],l[1],l[0]],e})).reverse();const f=a[s-1].points[a[s-1].points.length-1],g=c[0].points[0],m=EL.makeline(c[s-1].points[c[s-1].points.length-1],a[0].points[0]),y=EL.makeline(f,g),v=[m].concat(a).concat([y]).concat(c);return new TL(v)}outlineshapes(e,t,n){const i=this.outline(e,t=t||e).curves,r=[];for(let e=1,t=i.length;e<t/2;e++){const o=EL.makeshape(i[e],i[t-e],n);o.startcap.virtual=e>1,o.endcap.virtual=e<t/2-1,r.push(o)}return r}intersects(t,n){return t?t.p1&&t.p2?this.lineIntersects(t):(t instanceof e&&(t=t.reduce()),this.curveintersects(this.reduce(),t,n)):this.selfintersects(n)}lineIntersects(e){const t=IL(e.p1.x,e.p2.x),n=IL(e.p1.y,e.p2.y),i=AL(e.p1.x,e.p2.x),r=AL(e.p1.y,e.p2.y);return EL.roots(this.points,e).filter((e=>{var o=this.get(e);return EL.between(o.x,t,i)&&EL.between(o.y,n,r)}))}selfintersects(e){const t=this.reduce(),n=t.length-2,i=[];for(let r,o,s,a=0;a<n;a++)o=t.slice(a,a+1),s=t.slice(a+2),r=this.curveintersects(o,s,e),i.push(...r);return i}curveintersects(e,t,n){const i=[];e.forEach((function(e){t.forEach((function(t){e.overlaps(t)&&i.push({left:e,right:t})}))}));let r=[];return i.forEach((function(e){const t=EL.pairiteration(e.left,e.right,n);t.length>0&&(r=r.concat(t))})),r}arcs(e){return this._iterate(e=e||.5,[])}_error(e,t,n,i){const r=(i-n)/4,o=this.get(n+r),s=this.get(i-r),a=EL.dist(e,t),l=EL.dist(e,o),c=EL.dist(e,s);return PL(l-a)+PL(c-a)}_iterate(e,t){let n,i=0,r=1;do{n=0,r=1;let o,s,a,l,c,u=this.get(i),d=!1,h=!1,p=r,f=1;do{if(h=d,l=a,p=(i+r)/2,o=this.get(p),s=this.get(r),a=EL.getccenter(u,o,s),a.interval={start:i,end:r},d=this._error(a,u,i,r)<=e,c=h&&!d,c||(f=r),d){if(r>=1){if(a.interval.end=f=1,l=a,r>1){let e={x:a.x+a.r*OL(a.e),y:a.y+a.r*LL(a.e)};a.e+=EL.angle({x:a.x,y:a.y},e,this.get(1))}break}r+=(r-i)/2}else r=p}while(!c&&n++<100);if(n>=100)break;l=l||a,t.push(l),i=f}while(r<1);return t}};var FL=function(e,t){let n=1/t;if(0===e.length){let e=[];for(let i=0;i<t;i++)e.push({x:i*n,y:.5});return e}if(1===e.length){let i=e[0].y,r=[{x:0,y:i}];for(let e=0;e<t;e++)r.push({x:e*n+n,y:i});return r}let i=[],r=e[0],o=e[e.length-1],s=new ML({x:o.x-1,y:o.y},{x:o.x-1+(r.x-(o.x-1))/2,y:o.y},{x:r.x-(r.x-(o.x-1))/2,y:r.y},r),a=new ML(o,{x:o.x+(r.x+1-o.x)/2,y:o.y},{x:r.x+1-(r.x+1-o.x)/2,y:r.y},{x:r.x+1,y:r.y});for(let t=0;t<e.length-1;t++){let n=e[t],r=e[t+1],o=new ML(n,{x:n.x+(r.x-n.x)/2,y:n.y},{x:r.x-(r.x-n.x)/2,y:r.y},r);i.push(o)}i.unshift(s),i.push(a);let l=[s.get(s.intersects({p1:{x:0,y:0},p2:{x:0,y:1}})[0])];for(let e=0;e<t;e++){let t,r=e*n+n;i.every((e=>{let n=e.intersects({p1:{x:r,y:0},p2:{x:r,y:1}});return!(n.length>0&&(t=e.get(n[0]),l.push(t),1))}))}return l};class BL{constructor(e,t){this.xs=e,this.ys=t,this.ks=this.getNaturalKs(new Float64Array(this.xs.length))}getNaturalKs(e){const t=this.xs.length-1,n=function(e,t){const n=[];for(let i=0;i<e;i++)n.push(new Float64Array(t));return n}(t+1,t+2);for(let e=1;e<t;e++)n[e][e-1]=1/(this.xs[e]-this.xs[e-1]),n[e][e]=2*(1/(this.xs[e]-this.xs[e-1])+1/(this.xs[e+1]-this.xs[e])),n[e][e+1]=1/(this.xs[e+1]-this.xs[e]),n[e][t+1]=3*((this.ys[e]-this.ys[e-1])/((this.xs[e]-this.xs[e-1])*(this.xs[e]-this.xs[e-1]))+(this.ys[e+1]-this.ys[e])/((this.xs[e+1]-this.xs[e])*(this.xs[e+1]-this.xs[e])));return n[0][0]=2/(this.xs[1]-this.xs[0]),n[0][1]=1/(this.xs[1]-this.xs[0]),n[0][t+1]=3*(this.ys[1]-this.ys[0])/((this.xs[1]-this.xs[0])*(this.xs[1]-this.xs[0])),n[t][t-1]=1/(this.xs[t]-this.xs[t-1]),n[t][t]=2/(this.xs[t]-this.xs[t-1]),n[t][t+1]=3*(this.ys[t]-this.ys[t-1])/((this.xs[t]-this.xs[t-1])*(this.xs[t]-this.xs[t-1])),function(e,t){const n=e.length;let i=0,r=0;for(;i<n&&r<=n;){let t=0,o=-1/0;for(let s=i;s<n;s++){const n=Math.abs(e[s][r]);n>o&&(t=s,o=n)}if(0===e[t][r])r++;else{UL(e,i,t);for(let t=i+1;t<n;t++){const o=e[t][r]/e[i][r];e[t][r]=0;for(let s=r+1;s<=n;s++)e[t][s]-=e[i][s]*o}i++,r++}}for(let i=n-1;i>=0;i--){var o=0;e[i][i]&&(o=e[i][n]/e[i][i]),t[i]=o;for(let t=i-1;t>=0;t--)e[t][n]-=e[t][i]*o,e[t][i]=0}return t}(n,e)}getIndexBefore(e){let t=0,n=this.xs.length,i=0;for(;t<n;)i=Math.floor((t+n)/2),this.xs[i]<e&&i!==t?t=i:n=this.xs[i]>=e&&i!==n?i:t;return t===this.xs.length-1?this.xs.length-1:t+1}at(e){let t=this.getIndexBefore(e);const n=(e-this.xs[t-1])/(this.xs[t]-this.xs[t-1]);return(1-n)*this.ys[t-1]+n*this.ys[t]+n*(1-n)*((this.ks[t-1]*(this.xs[t]-this.xs[t-1])-(this.ys[t]-this.ys[t-1]))*(1-n)+(-this.ks[t]*(this.xs[t]-this.xs[t-1])+(this.ys[t]-this.ys[t-1]))*n)}}function UL(e,t,n){let i=e[t];e[t]=e[n],e[n]=i}function jL(e,t,n){const i=n[0],r=n[n.length-1];if(e<i.x)return i.y;if(e>r.x)return r.y;const o=t.at(e);return Math.max(0,Math.min(o,1))}var zL=function(e,t){if(!Array.isArray(e)||!e.every((e=>"object"==typeof e&&"number"==typeof e.x&&"number"==typeof e.y&&e.x>=0&&e.x<=1&&e.y>=0&&e.y<=1)))throw new Error("[pointsToCurve] Invalid points. Expected array of objects with x and y in [0, 1] range.");if(!("number"==typeof t&&t>=1))throw new Error(`[pointsToCurve] Invalid resolution: ${t}. Expected integer >= 1.`);const n=e.map((e=>e.x)),i=e.map((e=>e.y)),r=new BL(n,i);let o=[];for(let n=0;n<t;n++)o.push(jL(n/(t-1),r,e));return o};function VL(e,t=256,n={}){return"bezier"===n.type?FL(e,t,n):zL(e,t)}const WL=[];for(let e=0;e<256;e++)WL[e]=e;class HL extends KO{constructor(e){const t={vertex:uL,fragment:dL},n={uniforms:KO.getUniformInfo(HL)};super(HL.getFilterType(),t,n,e)}static getFilterType(){return"curves"}static getInputsCount(){return 1}static getInitialOptions(){return{}}getOptionsDisplay(){return[]}handleStaticUniforms(e){let t=[];var n;t=[...e.master||e.points||e.masterPoints?e.master||(n=e.points||e.masterPoints,VL(n,256).map((e=>255*e))):WL],this.uniforms[VO.STATIC_OPTIONS].set(t)}}function $L(e,t,n){if("number"!=typeof e||e<0||e>255)throw new Error(`[levels] Invalid black point: ${e}. Expected integer between 0 and 255`);if("number"!=typeof t||t<0||t>255)throw new Error(`[levels] Invalid white point: ${t}. Expected integer between 0 and 255`);if("number"!=typeof n||n<.01||n>9.99)throw new Error(`[levels] Invalid gamma: ${n}. Expected float between 0.01 and 9.99`);if(e>t)throw new Error(`[levels] Invalid black and white points: ${e}, ${t}. Expected black <= white`);let i=[];for(let r=0;r<256;r++){let o;o=r<=e?0:r>=t?255:255*Math.pow((r-e)/(t-e),1/n),i[r]=o}return i}class GL extends KO{constructor(e){const t={vertex:uL,fragment:dL},n={uniforms:KO.getUniformInfo(GL)};super(GL.getFilterType(),t,n,e)}static getFilterType(){return"levels"}static getInputsCount(){return 1}static getInitialOptions(){return{}}getOptionsDisplay(){return[]}handleStaticUniforms(e){let t=[...$L(e.black,e.white,e.gamma)];this.uniforms[VO.STATIC_OPTIONS].set(t)}}const qL=360,YL=[];for(let e=0;e<qL;e++)YL[e]=e;class KL extends KO{constructor(e){const t={uniforms:KO.getUniformInfo(KL)};super(KL.getFilterType(),{vertex:"attribute vec3 position_3d;attribute vec2 texture_coordinate_2d;varying vec2 current_texture_coordinate_2d;void main(){vec4 normalize_poistion=vec4(position_3d.xyz,1);gl_Position=normalize_poistion;current_texture_coordinate_2d=texture_coordinate_2d;}",fragment:"precision lowp float;uniform sampler2D first_texture;varying vec2 current_texture_coordinate_2d;uniform float staticOptions[360];int round(float val){return int(floor(val+0.5));}float safeMod(float val){return mod(val+1.0,1.0);}float getCurveValue(float pixelValue){float v;for(int k=0;k<360;k++){if(k==round(pixelValue*359.0)){v=float(staticOptions[k])/359.0;}}return v;}const float EPSILON=1e-10;vec3 HUEtoRGB(in float hue){vec3 rgb=abs(hue*6.-vec3(3,2,4))*vec3(1,-1,-1)+vec3(-1,2,2);return clamp(rgb,0.,1.);}vec3 RGBtoHCV(in vec3 rgb){vec4 p=(rgb.g<rgb.b)? vec4(rgb.bg,-1.,2./3.): vec4(rgb.gb,0.,-1./3.);vec4 q=(rgb.r<p.x)? vec4(p.xyw,rgb.r): vec4(rgb.r,p.yzx);float c=q.x-min(q.w,q.y);float h=abs((q.w-q.y)/(6.*c+EPSILON)+q.z);return vec3(h,c,q.x);}vec3 HSVtoRGB(in vec3 hsv){vec3 rgb=HUEtoRGB(hsv.x);return((rgb-1.)*hsv.y+1.)*hsv.z;}vec3 HSLtoRGB(in vec3 hsl){vec3 rgb=HUEtoRGB(hsl.x);float c=(1.-abs(2.*hsl.z-1.))*hsl.y;return(rgb-0.5)*c+hsl.z;}vec3 RGBtoHSV(in vec3 rgb){vec3 hcv=RGBtoHCV(rgb);float s=hcv.y/(hcv.z+EPSILON);return vec3(hcv.x,s,hcv.z);}vec3 RGBtoHSL(in vec3 rgb){vec3 hcv=RGBtoHCV(rgb);float z=hcv.z-hcv.y*0.5;float s=hcv.y/(1.-abs(z*2.-1.)+EPSILON);return vec3(hcv.x,s,z);}void main(){vec4 textureColor=texture2D(first_texture,current_texture_coordinate_2d);vec3 inHSL=RGBtoHSL(textureColor.rgb);float shiftedHue=getCurveValue(mod(inHSL.x+0.5,1.0));vec3 inRGB=HSLtoRGB(vec3(shiftedHue,inHSL.y,inHSL.z));vec4 finalColor=vec4(inRGB,textureColor.a);if(textureColor.r==1.0&&textureColor.g==1.0&&textureColor.b==1.0){finalColor.rgb=vec3(1.0,1.0,1.0);}gl_FragColor=finalColor;}"},t,e)}static getFilterType(){return"hue"}static getInputsCount(){return 1}static getInitialOptions(){return{}}getOptionsDisplay(){return[]}handleStaticUniforms(e){let t=e.points&&VL(e.points,qL,{type:"bezier"}).map((e=>function(e){return((Math.round(e.x*qL)+180)%qL+(1-e.y-.5)*qL+qL)%qL}(e)))||YL;this.uniforms[VO.STATIC_OPTIONS].set(t)}}class XL extends KO{constructor(e){const t={uniforms:KO.getUniformInfo(XL)};super(XL.getFilterType(),{vertex:"attribute vec3 position_3d;attribute vec2 texture_coordinate_2d;varying vec2 current_texture_coordinate_2d;void main(){vec4 normalize_poistion=vec4(position_3d.xyz,1);gl_Position=normalize_poistion;current_texture_coordinate_2d=texture_coordinate_2d;}",fragment:"precision lowp float;uniform sampler2D first_texture;varying vec2 current_texture_coordinate_2d;uniform float staticOptions[2];vec3 rgb2xyz(vec3 c){vec3 tmp=vec3((c.r>.04045)?pow((c.r+.055)/1.055,2.4):c.r/12.92,(c.g>.04045)?pow((c.g+.055)/1.055,2.4):c.g/12.92,(c.b>.04045)?pow((c.b+.055)/1.055,2.4):c.b/12.92);mat3 mat=mat3(.4124,.3576,.1805,.2126,.7152,.0722,.0193,.1192,.9505);return 100.*(tmp*mat);}vec3 xyz2lab(vec3 c){vec3 n=c/vec3(95.047,100.,108.883),v=vec3((n.x>.008856)?pow(n.x,1./3.):(7.787*n.x)+(16./116.),(n.y>.008856)?pow(n.y,1./3.):(7.787*n.y)+(16./116.),(n.z>.008856)?pow(n.z,1./3.):(7.787*n.z)+(16./116.));return vec3((116.*v.y)-16.,500.*(v.x-v.y),200.*(v.y-v.z));}vec3 rgb2lab(vec3 c){vec3 lab=xyz2lab(rgb2xyz(c));return vec3(lab.x/100.,.5+.5*(lab.y/127.),.5+.5*(lab.z/127.));}vec3 lab2xyz(vec3 c){float fy=(c.x+16.)/116.,fx=c.y/500.+fy,fz=fy-c.z/200.;return vec3(95.047*((fx>.206897)?fx*fx*fx:(fx-16./116.)/7.787),100.*((fy>.206897)?fy*fy*fy:(fy-16./116.)/7.787),108.883*((fz>.206897)?fz*fz*fz:(fz-16./116.)/7.787));}vec3 xyz2rgb(vec3 c){mat3 mat=mat3(3.2406,-1.5372,-.4986,-.9689,1.8758,.0415,.0557,-.2040,1.0570);vec3 v=(c/100.0)*mat,r=vec3((v.r>.0031308)?((1.055*pow(v.r,(1./2.4)))-.055):12.92*v.r,(v.g>.0031308)?((1.055*pow(v.g,(1./2.4)))-.055):12.92*v.g,(v.b>.0031308)?((1.055*pow(v.b,(1./2.4)))-.055):12.92*v.b);return r;}vec3 lab2rgb(vec3 c){return xyz2rgb(lab2xyz(vec3(100.*c.x,2.*127.*(c.y-.5),2.*127.*(c.z-.5))));}float handleMix(float x){return pow(x*2.0-1.0,2.0);}void main(){vec3 inColor=texture2D(first_texture,current_texture_coordinate_2d).rgb;vec3 inLab=rgb2lab(inColor);vec3 inRGB;inLab.y-=(-staticOptions[1]+128.0)/255.0-0.5;inLab.z-=(staticOptions[0]+128.0)/255.0-0.5;inRGB=lab2rgb(inLab);vec3 mixed=mix(inRGB,inColor,0.0);gl_FragColor=vec4(mixed,1.0);}"},t,e)}static getFilterType(){return"whiteBalance"}static getInputsCount(){return 1}static getInitialOptions(){return{}}getOptionsDisplay(){return[]}handleStaticUniforms(e){this.uniforms[VO.STATIC_OPTIONS].set([e.temperature?e.temperature:0,e.tint?e.tint:0])}}class QL extends KO{constructor(e){const t={uniforms:KO.getUniformInfo(QL)};super(QL.getFilterType(),{vertex:"attribute vec3 position_3d;attribute vec2 texture_coordinate_2d;varying vec2 current_texture_coordinate_2d;void main(){vec4 normalize_poistion=vec4(position_3d.xyz,1);gl_Position=normalize_poistion;current_texture_coordinate_2d=texture_coordinate_2d;}",fragment:"precision lowp float;uniform sampler2D first_texture;varying vec2 current_texture_coordinate_2d;uniform float staticOptions[4];void main(){float percentAmount=staticOptions[0];float redBalance=staticOptions[1];float greenBalance=staticOptions[2];float blueBalance=staticOptions[3];vec3 color=texture2D(first_texture,current_texture_coordinate_2d).rgb;vec3 coefLuma=vec3(0.212656,0.715158,0.072186);float luma=dot(coefLuma,color);float max_color=max(color.r,max(color.g,color.b));float min_color=min(color.r,min(color.g,color.b));float color_saturation=max_color-min_color;vec3 coeffVibrance=vec3(redBalance,greenBalance,blueBalance)*percentAmount;color.r=mix(luma,color.r,1.0+(coeffVibrance.r*(1.0-(sign(coeffVibrance.r)*color_saturation))));color.g=mix(luma,color.g,1.0+(coeffVibrance.g*(1.0-(sign(coeffVibrance.g)*color_saturation))));color.b=mix(luma,color.b,1.0+(coeffVibrance.b*(1.0-(sign(coeffVibrance.b)*color_saturation))));gl_FragColor=vec4(color,1.0);}"},t,e)}static getFilterType(){return"vibrance"}static getInputsCount(){return 1}static getInitialOptions(){return{}}getOptionsDisplay(){return[]}handleStaticUniforms(e){this.uniforms[VO.STATIC_OPTIONS].set([e.amount?e.amount/100*2:0,null===e.redBalance?1:e.redBalance,null===e.greenBalance?1:e.greenBalance,null===e.blueBalance?1:e.blueBalance])}}class ZL extends KO{constructor(e){const t={uniforms:KO.getUniformInfo(ZL)};super(ZL.getFilterType(),{vertex:"attribute vec3 position_3d;attribute vec2 texture_coordinate_2d;varying vec2 current_texture_coordinate_2d;void main(){vec4 normalize_poistion=vec4(position_3d.xyz,1);gl_Position=normalize_poistion;current_texture_coordinate_2d=texture_coordinate_2d;}",fragment:"precision lowp float;uniform sampler2D first_texture;varying vec2 current_texture_coordinate_2d;uniform float staticOptions[1];/***Adjusts the saturation of a color.**@name czm_saturation*@glslFunction**@param{vec3}rgb The color.*@param{float}adjustment The amount to adjust the saturation of the color.**@returns{float}The color with the saturation adjusted.**@example*vec3 greyScale=czm_saturation(color,0.0);*vec3 doubleSaturation=czm_saturation(color,2.0);*/vec3 czm_saturation(vec3 rgb,float adjustment){const vec3 W=vec3(0.2125,0.7154,0.0721);vec3 intensity=vec3(dot(rgb,W));return mix(intensity,rgb,adjustment);}void main(){float amount=staticOptions[0];vec3 color=texture2D(first_texture,current_texture_coordinate_2d).rgb;gl_FragColor=vec4(czm_saturation(color,amount),1.0);}"},t,e)}static getFilterType(){return"saturation"}static getInputsCount(){return 1}static getInitialOptions(){return{}}getOptionsDisplay(){return[]}handleStaticUniforms(e){this.uniforms[VO.STATIC_OPTIONS].set([null===e.amount?1:e.amount])}}class JL extends KO{constructor(e){const t={uniforms:KO.getUniformInfo(JL)};super(JL.getFilterType(),{vertex:"attribute vec3 position_3d;attribute vec2 texture_coordinate_2d;varying vec2 current_texture_coordinate_2d;varying vec2 current_position_coordinate_2d;void main(){vec4 normalize_poistion=vec4(position_3d.xyz,1);gl_Position=normalize_poistion;current_texture_coordinate_2d=texture_coordinate_2d;current_position_coordinate_2d=normalize_poistion.xy;}",fragment:"precision lowp float;uniform sampler2D first_texture;uniform float staticOptions[12];uniform float runtimeOptions[4];varying vec2 current_texture_coordinate_2d;varying vec2 current_position_coordinate_2d;float roundedBoxSDF(vec2 CenterPosition,vec2 Size,float Radius){return length(max(abs(CenterPosition)-Size+Radius,0.0))-Radius;}void main(){vec2 srcAR=vec2(runtimeOptions[0]/runtimeOptions[1],1.0);if(staticOptions[10]>0.0){srcAR.x=staticOptions[10];}vec2 srcCenter=vec2(staticOptions[0],staticOptions[1]);vec2 srcDims=vec2(staticOptions[2],staticOptions[3]);vec2 srcTL=vec2(srcCenter.x-srcDims[0]/2.0,srcCenter.y-srcDims[1]/2.0);vec2 srcDims_AR=srcDims*srcAR;vec2 srcTL_AR=srcTL*srcAR;vec2 vpDims=vec2(runtimeOptions[2],runtimeOptions[3]);vec2 vpAR=vec2(vpDims[0]/vpDims[1],1.0);vec2 tgtCenter=vec2(staticOptions[4],staticOptions[5]);vec2 tgtDims=vec2(staticOptions[6],staticOptions[7]);vec2 tgtTL=vec2(tgtCenter.x-tgtDims[0]/2.0,tgtCenter.y-tgtDims[1]/2.0);vec2 tgtDims_AR=tgtDims*vpAR;vec2 tgtTL_AR=tgtTL*vpAR;vec2 pos_AR=current_texture_coordinate_2d*vpAR;float ratioW=tgtDims_AR[0]/srcDims_AR[0];float ratioH=tgtDims_AR[1]/srcDims_AR[1];float ratio;float fitType=staticOptions[8];if(fitType==0.0){ratio=ratioW>ratioH ? ratioW : ratioH;vec2 tgtDims_OLD_AR=tgtDims_AR;tgtDims_AR=srcDims_AR*ratio;tgtTL_AR=tgtTL_AR-(tgtDims_AR-tgtDims_OLD_AR)/2.0;}else if(fitType==1.0){ratio=ratioW<ratioH ? ratioW : ratioH;vec2 tgtDims_OLD_AR=tgtDims_AR;tgtDims_AR=srcDims_AR*ratio;tgtTL_AR=tgtTL_AR+(tgtDims_OLD_AR-tgtDims_AR)/2.0;}vec2 final_pos_AR=(pos_AR-tgtTL_AR)/tgtDims_AR*srcDims_AR+srcTL_AR;vec2 pos=final_pos_AR/srcAR;float edgeSoftness=staticOptions[11];float radius=staticOptions[9];float tightDistance=roundedBoxSDF((current_texture_coordinate_2d-tgtCenter),tgtDims_AR/vpAR/2.0,0.0);float distance=roundedBoxSDF((current_texture_coordinate_2d-tgtCenter)*vpDims,(tgtDims*vpDims)/2.0,radius);float smoothedAlpha=1.0-smoothstep(0.0,edgeSoftness*2.0,distance);vec4 textureColor=texture2D(first_texture,pos);vec4 quadColor=vec4(textureColor.xyz,smoothedAlpha);if(tightDistance>0.0&&distance<=0.0){gl_FragColor=vec4(0,0,0,1.0);}else{gl_FragColor=quadColor;}}"},t,e)}static getFilterType(){return"crop"}static getInputsCount(){return 1}static getInitialOptions(){return{source:{center:{x:.5,y:.5},width:1,height:1},target:{center:{x:.5,y:.5},width:1,height:1},fitType:"fill",cornerRadius:10,edgeSoftness:0}}getOptionsDisplay(){return[]}static getUniformList(){return[VO.FIRST_TEXTURE,UO,jO]}handleStaticUniforms(e){let t={...JL.getInitialOptions(),...e};const n=Number.parseFloat(t.source.center.x).toFixed(5),i=Number.parseFloat(t.source.center.y).toFixed(5),r=Number.parseFloat(t.source.width).toFixed(5),o=Number.parseFloat(t.source.height).toFixed(5),s=Number.parseFloat(t.target.center.x).toFixed(5),a=Number.parseFloat(t.target.center.y).toFixed(5),l=Number.parseFloat(t.target.width).toFixed(5),c=Number.parseFloat(t.target.height).toFixed(5),u=Number.parseFloat(t.edgeSoftness).toFixed(5),d=t.source.aspectRatio?Number.parseFloat(t.source.aspectRatio).toFixed(5):0;let h;h="fill"===t.fitType?0:"contain"===t.fitType?1:2;const p=Number.parseFloat(t.cornerRadius).toFixed(5);this.uniforms[VO.STATIC_OPTIONS].set([n,i,r,o,s,a,l,c,h,p,d,u])}}class eN extends KO{constructor(e){const t={uniforms:KO.getUniformInfo(eN)};super(eN.getFilterType(),{vertex:"attribute vec3 position_3d;attribute vec2 texture_coordinate_2d;varying vec2 current_texture_coordinate_2d;varying vec2 current_position_coordinate_2d;void main(){vec4 normalize_poistion=vec4(position_3d.xyz,1);gl_Position=normalize_poistion;current_texture_coordinate_2d=texture_coordinate_2d;current_position_coordinate_2d=normalize_poistion.xy;}",fragment:"precision lowp float;uniform sampler2D first_texture;uniform float staticOptions[4];uniform float runtimeOptions[2];varying vec2 current_texture_coordinate_2d;varying vec2 current_position_coordinate_2d;void main(){vec4 texture=texture2D(first_texture,current_texture_coordinate_2d);vec4 color=vec4(staticOptions[0],staticOptions[1],staticOptions[2],1.0);vec4 blended=mix(texture,color,staticOptions[3]);gl_FragColor=blended;}"},t,e)}static getFilterType(){return"solid"}static getInputsCount(){return 1}static getInitialOptions(){return{color:{r:.33,g:.66,b:.99,a:1}}}getOptionsDisplay(){return[{properties:["color","r"],type:"slider",minValue:0,maxValue:1,step:.001},{properties:["color","g"],type:"slider",minValue:0,maxValue:1,step:.001},{properties:["color","b"],type:"slider",minValue:0,maxValue:1,step:.001}]}handleStaticUniforms(e){var t;const n=Number.parseFloat(e.color.r).toFixed(5),i=Number.parseFloat(e.color.g).toFixed(5),r=Number.parseFloat(e.color.b).toFixed(5),o=(null!==(t=Number.parseFloat(e.color.a))&&void 0!==t?t:1).toFixed(5);this.uniforms[VO.STATIC_OPTIONS].set([n,i,r,o])}}class tN extends KO{constructor(e){const t={uniforms:KO.getUniformInfo(tN)};super(tN.getFilterType(),{vertex:"attribute vec3 position_3d;attribute vec2 texture_coordinate_2d;varying vec2 current_texture_coordinate_2d;varying vec2 current_position_coordinate_2d;void main(){vec4 normalize_poistion=vec4(position_3d.xyz,1);gl_Position=normalize_poistion;current_texture_coordinate_2d=texture_coordinate_2d;current_position_coordinate_2d=normalize_poistion.xy;}",fragment:"precision lowp float;uniform sampler2D first_texture;uniform float runtimeOptions[1];varying vec2 current_texture_coordinate_2d;varying vec2 current_position_coordinate_2d;void main(){vec4 textureColor=texture2D(first_texture,current_texture_coordinate_2d);gl_FragColor=vec4(textureColor.rgb,1.0);}"},t,e)}static getFilterType(){return"solidImage"}static getInputsCount(){return 1}static getInitialOptions(){return{}}getOptionsDisplay(){return[]}}class nN extends KO{constructor(e){const t={uniforms:KO.getUniformInfo(nN)};super(nN.getFilterType(),{vertex:"attribute vec3 position_3d;attribute vec2 texture_coordinate_2d;varying vec2 current_texture_coordinate_2d;void main(){vec4 normalize_position=vec4(position_3d.xyz,1);gl_Position=normalize_position;current_texture_coordinate_2d=texture_coordinate_2d;}",fragment:"precision lowp float;uniform sampler2D first_texture;varying vec2 current_texture_coordinate_2d;vec3 rgb2xyz(vec3 c){vec3 tmp=vec3((c.r>.04045)?pow((c.r+.055)/1.055,2.4):c.r/12.92,(c.g>.04045)?pow((c.g+.055)/1.055,2.4):c.g/12.92,(c.b>.04045)?pow((c.b+.055)/1.055,2.4):c.b/12.92);mat3 mat=mat3(.4124,.3576,.1805,.2126,.7152,.0722,.0193,.1192,.9505);return 100.*(tmp*mat);}vec3 xyz2lab(vec3 c){vec3 n=c/vec3(95.047,100.,108.883),v=vec3((n.x>.008856)?pow(n.x,1./3.):(7.787*n.x)+(16./116.),(n.y>.008856)?pow(n.y,1./3.):(7.787*n.y)+(16./116.),(n.z>.008856)?pow(n.z,1./3.):(7.787*n.z)+(16./116.));return vec3((116.*v.y)-16.,500.*(v.x-v.y),200.*(v.y-v.z));}vec3 rgb2lab(vec3 c){vec3 lab=xyz2lab(rgb2xyz(c));return vec3(lab.x/100.,.5+.5*(lab.y/127.),.5+.5*(lab.z/127.));}void main(){vec3 inColor=texture2D(first_texture,current_texture_coordinate_2d).rgb;vec3 inLab=rgb2lab(inColor);gl_FragColor=vec4(inLab,1.0);}"},t,e)}static getFilterType(){return"lab"}static getInputsCount(){return 1}static getInitialOptions(){return{}}getOptionsDisplay(){return[]}handleStaticUniforms(e){this.uniforms[VO.STATIC_OPTIONS].set([e.temperature?e.temperature:0,e.tint?e.tint:0])}}class iN extends KO{constructor(e){const t={uniforms:KO.getUniformInfo(iN)};super(iN.getFilterType(),{vertex:"attribute vec3 position_3d;attribute vec2 texture_coordinate_2d;varying vec2 current_texture_coordinate_2d;void main(){vec4 normalize_poistion=vec4(position_3d.xyz,1);gl_Position=normalize_poistion;current_texture_coordinate_2d=texture_coordinate_2d;}",fragment:"precision lowp float;uniform sampler2D first_texture;varying vec2 current_texture_coordinate_2d;uniform float staticOptions[1];void main(){float exposureStops=staticOptions[0];vec3 color=texture2D(first_texture,current_texture_coordinate_2d).rgb;float multiplier=pow(2.0,exposureStops);vec3 exposedColor=color*multiplier;gl_FragColor=vec4(exposedColor,1.0);}"},t,e)}static getFilterType(){return"exposure"}static getInputsCount(){return 1}static getInitialOptions(){return{}}getOptionsDisplay(){return[]}handleStaticUniforms(e){this.uniforms[VO.STATIC_OPTIONS].set([null===e.exposure?0:e.exposure])}}var rN,oN,sN,aN,lN,cN,uN,dN;function hN(){if(aN)return sN;aN=1;const e=oN?rN:(oN=1,rN={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}),t={};for(const n of Object.keys(e))t[e[n]]=n;const n={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};sN=n;for(const e of Object.keys(n)){if(!("channels"in n[e]))throw new Error("missing channels property: "+e);if(!("labels"in n[e]))throw new Error("missing channel labels property: "+e);if(n[e].labels.length!==n[e].channels)throw new Error("channel and label counts mismatch: "+e);const{channels:t,labels:i}=n[e];delete n[e].channels,delete n[e].labels,Object.defineProperty(n[e],"channels",{value:t}),Object.defineProperty(n[e],"labels",{value:i})}function i(e,t){return(e[0]-t[0])**2+(e[1]-t[1])**2+(e[2]-t[2])**2}return n.rgb.hsl=function(e){const t=e[0]/255,n=e[1]/255,i=e[2]/255,r=Math.min(t,n,i),o=Math.max(t,n,i),s=o-r;let a,l;o===r?a=0:t===o?a=(n-i)/s:n===o?a=2+(i-t)/s:i===o&&(a=4+(t-n)/s),a=Math.min(60*a,360),a<0&&(a+=360);const c=(r+o)/2;return l=o===r?0:c<=.5?s/(o+r):s/(2-o-r),[a,100*l,100*c]},n.rgb.hsv=function(e){let t,n,i,r,o;const s=e[0]/255,a=e[1]/255,l=e[2]/255,c=Math.max(s,a,l),u=c-Math.min(s,a,l),d=function(e){return(c-e)/6/u+.5};return 0===u?(r=0,o=0):(o=u/c,t=d(s),n=d(a),i=d(l),s===c?r=i-n:a===c?r=1/3+t-i:l===c&&(r=2/3+n-t),r<0?r+=1:r>1&&(r-=1)),[360*r,100*o,100*c]},n.rgb.hwb=function(e){const t=e[0],i=e[1];let r=e[2];const o=n.rgb.hsl(e)[0],s=1/255*Math.min(t,Math.min(i,r));return r=1-1/255*Math.max(t,Math.max(i,r)),[o,100*s,100*r]},n.rgb.cmyk=function(e){const t=e[0]/255,n=e[1]/255,i=e[2]/255,r=Math.min(1-t,1-n,1-i);return[100*((1-t-r)/(1-r)||0),100*((1-n-r)/(1-r)||0),100*((1-i-r)/(1-r)||0),100*r]},n.rgb.keyword=function(n){const r=t[n];if(r)return r;let o,s=1/0;for(const t of Object.keys(e)){const r=i(n,e[t]);r<s&&(s=r,o=t)}return o},n.keyword.rgb=function(t){return e[t]},n.rgb.xyz=function(e){let t=e[0]/255,n=e[1]/255,i=e[2]/255;return t=t>.04045?((t+.055)/1.055)**2.4:t/12.92,n=n>.04045?((n+.055)/1.055)**2.4:n/12.92,i=i>.04045?((i+.055)/1.055)**2.4:i/12.92,[100*(.4124*t+.3576*n+.1805*i),100*(.2126*t+.7152*n+.0722*i),100*(.0193*t+.1192*n+.9505*i)]},n.rgb.lab=function(e){const t=n.rgb.xyz(e);let i=t[0],r=t[1],o=t[2];return i/=95.047,r/=100,o/=108.883,i=i>.008856?i**(1/3):7.787*i+16/116,r=r>.008856?r**(1/3):7.787*r+16/116,o=o>.008856?o**(1/3):7.787*o+16/116,[116*r-16,500*(i-r),200*(r-o)]},n.hsl.rgb=function(e){const t=e[0]/360,n=e[1]/100,i=e[2]/100;let r,o,s;if(0===n)return s=255*i,[s,s,s];r=i<.5?i*(1+n):i+n-i*n;const a=2*i-r,l=[0,0,0];for(let e=0;e<3;e++)o=t+1/3*-(e-1),o<0&&o++,o>1&&o--,s=6*o<1?a+6*(r-a)*o:2*o<1?r:3*o<2?a+(r-a)*(2/3-o)*6:a,l[e]=255*s;return l},n.hsl.hsv=function(e){const t=e[0];let n=e[1]/100,i=e[2]/100,r=n;const o=Math.max(i,.01);return i*=2,n*=i<=1?i:2-i,r*=o<=1?o:2-o,[t,100*(0===i?2*r/(o+r):2*n/(i+n)),(i+n)/2*100]},n.hsv.rgb=function(e){const t=e[0]/60,n=e[1]/100;let i=e[2]/100;const r=Math.floor(t)%6,o=t-Math.floor(t),s=255*i*(1-n),a=255*i*(1-n*o),l=255*i*(1-n*(1-o));switch(i*=255,r){case 0:return[i,l,s];case 1:return[a,i,s];case 2:return[s,i,l];case 3:return[s,a,i];case 4:return[l,s,i];case 5:return[i,s,a]}},n.hsv.hsl=function(e){const t=e[0],n=e[1]/100,i=e[2]/100,r=Math.max(i,.01);let o,s;s=(2-n)*i;const a=(2-n)*r;return o=n*r,o/=a<=1?a:2-a,o=o||0,s/=2,[t,100*o,100*s]},n.hwb.rgb=function(e){const t=e[0]/360;let n=e[1]/100,i=e[2]/100;const r=n+i;let o;r>1&&(n/=r,i/=r);const s=Math.floor(6*t),a=1-i;o=6*t-s,1&s&&(o=1-o);const l=n+o*(a-n);let c,u,d;switch(s){default:case 6:case 0:c=a,u=l,d=n;break;case 1:c=l,u=a,d=n;break;case 2:c=n,u=a,d=l;break;case 3:c=n,u=l,d=a;break;case 4:c=l,u=n,d=a;break;case 5:c=a,u=n,d=l}return[255*c,255*u,255*d]},n.cmyk.rgb=function(e){const t=e[1]/100,n=e[2]/100,i=e[3]/100;return[255*(1-Math.min(1,e[0]/100*(1-i)+i)),255*(1-Math.min(1,t*(1-i)+i)),255*(1-Math.min(1,n*(1-i)+i))]},n.xyz.rgb=function(e){const t=e[0]/100,n=e[1]/100,i=e[2]/100;let r,o,s;return r=3.2406*t+-1.5372*n+-.4986*i,o=-.9689*t+1.8758*n+.0415*i,s=.0557*t+-.204*n+1.057*i,r=r>.0031308?1.055*r**(1/2.4)-.055:12.92*r,o=o>.0031308?1.055*o**(1/2.4)-.055:12.92*o,s=s>.0031308?1.055*s**(1/2.4)-.055:12.92*s,r=Math.min(Math.max(0,r),1),o=Math.min(Math.max(0,o),1),s=Math.min(Math.max(0,s),1),[255*r,255*o,255*s]},n.xyz.lab=function(e){let t=e[0],n=e[1],i=e[2];return t/=95.047,n/=100,i/=108.883,t=t>.008856?t**(1/3):7.787*t+16/116,n=n>.008856?n**(1/3):7.787*n+16/116,i=i>.008856?i**(1/3):7.787*i+16/116,[116*n-16,500*(t-n),200*(n-i)]},n.lab.xyz=function(e){let t,n,i;n=(e[0]+16)/116,t=e[1]/500+n,i=n-e[2]/200;const r=n**3,o=t**3,s=i**3;return n=r>.008856?r:(n-16/116)/7.787,t=o>.008856?o:(t-16/116)/7.787,i=s>.008856?s:(i-16/116)/7.787,t*=95.047,n*=100,i*=108.883,[t,n,i]},n.lab.lch=function(e){const t=e[0],n=e[1],i=e[2];let r;return r=360*Math.atan2(i,n)/2/Math.PI,r<0&&(r+=360),[t,Math.sqrt(n*n+i*i),r]},n.lch.lab=function(e){const t=e[1],n=e[2]/360*2*Math.PI;return[e[0],t*Math.cos(n),t*Math.sin(n)]},n.rgb.ansi16=function(e,t=null){const[i,r,o]=e;let s=null===t?n.rgb.hsv(e)[2]:t;if(s=Math.round(s/50),0===s)return 30;let a=30+(Math.round(o/255)<<2|Math.round(r/255)<<1|Math.round(i/255));return 2===s&&(a+=60),a},n.hsv.ansi16=function(e){return n.rgb.ansi16(n.hsv.rgb(e),e[2])},n.rgb.ansi256=function(e){const t=e[0],n=e[1],i=e[2];return t===n&&n===i?t<8?16:t>248?231:Math.round((t-8)/247*24)+232:16+36*Math.round(t/255*5)+6*Math.round(n/255*5)+Math.round(i/255*5)},n.ansi16.rgb=function(e){let t=e%10;if(0===t||7===t)return e>50&&(t+=3.5),t=t/10.5*255,[t,t,t];const n=.5*(1+~~(e>50));return[(1&t)*n*255,(t>>1&1)*n*255,(t>>2&1)*n*255]},n.ansi256.rgb=function(e){if(e>=232){const t=10*(e-232)+8;return[t,t,t]}let t;return e-=16,[Math.floor(e/36)/5*255,Math.floor((t=e%36)/6)/5*255,t%6/5*255]},n.rgb.hex=function(e){const t=(((255&Math.round(e[0]))<<16)+((255&Math.round(e[1]))<<8)+(255&Math.round(e[2]))).toString(16).toUpperCase();return"000000".substring(t.length)+t},n.hex.rgb=function(e){const t=e.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!t)return[0,0,0];let n=t[0];3===t[0].length&&(n=n.split("").map((e=>e+e)).join(""));const i=parseInt(n,16);return[i>>16&255,i>>8&255,255&i]},n.rgb.hcg=function(e){const t=e[0]/255,n=e[1]/255,i=e[2]/255,r=Math.max(Math.max(t,n),i),o=Math.min(Math.min(t,n),i),s=r-o;let a,l;return a=s<1?o/(1-s):0,l=s<=0?0:r===t?(n-i)/s%6:r===n?2+(i-t)/s:4+(t-n)/s,l/=6,l%=1,[360*l,100*s,100*a]},n.hsl.hcg=function(e){const t=e[1]/100,n=e[2]/100,i=n<.5?2*t*n:2*t*(1-n);let r=0;return i<1&&(r=(n-.5*i)/(1-i)),[e[0],100*i,100*r]},n.hsv.hcg=function(e){const t=e[2]/100,n=e[1]/100*t;let i=0;return n<1&&(i=(t-n)/(1-n)),[e[0],100*n,100*i]},n.hcg.rgb=function(e){const t=e[1]/100,n=e[2]/100;if(0===t)return[255*n,255*n,255*n];const i=[0,0,0],r=e[0]/360%1*6,o=r%1,s=1-o;let a=0;switch(Math.floor(r)){case 0:i[0]=1,i[1]=o,i[2]=0;break;case 1:i[0]=s,i[1]=1,i[2]=0;break;case 2:i[0]=0,i[1]=1,i[2]=o;break;case 3:i[0]=0,i[1]=s,i[2]=1;break;case 4:i[0]=o,i[1]=0,i[2]=1;break;default:i[0]=1,i[1]=0,i[2]=s}return a=(1-t)*n,[255*(t*i[0]+a),255*(t*i[1]+a),255*(t*i[2]+a)]},n.hcg.hsv=function(e){const t=e[1]/100,n=t+e[2]/100*(1-t);let i=0;return n>0&&(i=t/n),[e[0],100*i,100*n]},n.hcg.hsl=function(e){const t=e[1]/100,n=e[2]/100*(1-t)+.5*t;let i=0;return n>0&&n<.5?i=t/(2*n):n>=.5&&n<1&&(i=t/(2*(1-n))),[e[0],100*i,100*n]},n.hcg.hwb=function(e){const t=e[1]/100,n=t+e[2]/100*(1-t);return[e[0],100*(n-t),100*(1-n)]},n.hwb.hcg=function(e){const t=1-e[2]/100,n=t-e[1]/100;let i=0;return n<1&&(i=(t-n)/(1-n)),[e[0],100*n,100*i]},n.apple.rgb=function(e){return[e[0]/65535*255,e[1]/65535*255,e[2]/65535*255]},n.rgb.apple=function(e){return[e[0]/255*65535,e[1]/255*65535,e[2]/255*65535]},n.gray.rgb=function(e){return[e[0]/100*255,e[0]/100*255,e[0]/100*255]},n.gray.hsl=function(e){return[0,0,e[0]]},n.gray.hsv=n.gray.hsl,n.gray.hwb=function(e){return[0,100,e[0]]},n.gray.cmyk=function(e){return[0,0,0,e[0]]},n.gray.lab=function(e){return[e[0],0,0]},n.gray.hex=function(e){const t=255&Math.round(e[0]/100*255),n=((t<<16)+(t<<8)+t).toString(16).toUpperCase();return"000000".substring(n.length)+n},n.rgb.gray=function(e){return[(e[0]+e[1]+e[2])/3/255*100]},sN}function pN(){if(cN)return lN;cN=1;const e=hN();function t(e,t){return function(n){return t(e(n))}}function n(n,i){const r=[i[n].parent,n];let o=e[i[n].parent][n],s=i[n].parent;for(;i[s].parent;)r.unshift(i[s].parent),o=t(e[i[s].parent][s],o),s=i[s].parent;return o.conversion=r,o}return lN=function(t){const i=function(t){const n=function(){const t={},n=Object.keys(e);for(let e=n.length,i=0;i<e;i++)t[n[i]]={distance:-1,parent:null};return t}(),i=[t];for(n[t].distance=0;i.length;){const t=i.pop(),r=Object.keys(e[t]);for(let e=r.length,o=0;o<e;o++){const e=r[o],s=n[e];-1===s.distance&&(s.distance=n[t].distance+1,s.parent=t,i.unshift(e))}}return n}(t),r={},o=Object.keys(i);for(let e=o.length,t=0;t<e;t++){const e=o[t];null!==i[e].parent&&(r[e]=n(e,i))}return r},lN}var fN=function(){if(dN)return uN;dN=1;const e=hN(),t=pN(),n={};return Object.keys(e).forEach((i=>{n[i]={},Object.defineProperty(n[i],"channels",{value:e[i].channels}),Object.defineProperty(n[i],"labels",{value:e[i].labels});const r=t(i);Object.keys(r).forEach((e=>{const t=r[e];n[i][e]=function(e){const t=function(...t){const n=t[0];if(null==n)return n;n.length>1&&(t=n);const i=e(t);if("object"==typeof i)for(let e=i.length,t=0;t<e;t++)i[t]=Math.round(i[t]);return i};return"conversion"in e&&(t.conversion=e.conversion),t}(t),n[i][e].raw=function(e){const t=function(...t){const n=t[0];return null==n?n:(n.length>1&&(t=n),e(t))};return"conversion"in e&&(t.conversion=e.conversion),t}(t)}))})),uN=n}(),gN=r(fN);class mN extends KO{constructor(e){const t={uniforms:KO.getUniformInfo(mN)};super(mN.getFilterType(),{vertex:"attribute vec3 position_3d;attribute vec2 texture_coordinate_2d;varying vec2 current_texture_coordinate_2d;void main(){vec4 normalize_poistion=vec4(position_3d.xyz,1);gl_Position=normalize_poistion;current_texture_coordinate_2d=texture_coordinate_2d;}",fragment:"precision lowp float;uniform sampler2D first_texture;uniform float staticOptions[3];varying vec2 current_texture_coordinate_2d;void main(){vec4 blend=texture2D(first_texture,current_texture_coordinate_2d);vec3 blendRGB=blend.rgb;vec3 baseRGB=vec3(staticOptions[0],staticOptions[1],staticOptions[2]);vec3 limit=step(0.5,blendRGB);vec3 mixedRGB=mix(2.0*baseRGB*blendRGB,1.0-2.0*(1.0-baseRGB)*(1.0-blendRGB),limit);gl_FragColor=vec4((mixedRGB*blend.a)+((1.0-blend.a)*baseRGB),1);}"},t,e)}static getFilterType(){return"hardLight"}static getInputsCount(){return 1}static getInitialOptions(){return{color:"4b0082"}}getOptionsDisplay(){return[{properties:["color"],type:"colorPicker"}]}handleStaticUniforms(e){const t=gN.hex.rgb(e.color).map((e=>e/255));this.uniforms[VO.STATIC_OPTIONS].set([t[0],t[1],t[2]])}}class yN extends KO{constructor(e){const t={uniforms:KO.getUniformInfo(yN)};super(yN.getFilterType(),{vertex:"precision lowp float;attribute vec3 position_3d;attribute vec2 texture_coordinate_2d;uniform float runtimeOptions[1];uniform float staticOptions[6];varying vec2 current_texture_coordinate_2d;varying float exposure_value;float getCurrentBeizerProgress(vec2 p1,vec2 p2,float t){vec2 p0=vec2(0,0);vec2 p3=vec2(1,1);vec2 E=mix(p0,p1,t);vec2 F=mix(p1,p2,t);vec2 G=mix(p2,p3,t);vec2 H=mix(E,F,t);vec2 I=mix(F,G,t);vec2 P=mix(H,I,t);return P.y;}void main(){vec4 normalize_poistion=vec4(position_3d.xyz,1);gl_Position=normalize_poistion;float current_time=runtimeOptions[0];float current_power_progress=getCurrentBeizerProgress(vec2(staticOptions[2],staticOptions[3]),vec2(staticOptions[4],staticOptions[5]),current_time);current_texture_coordinate_2d=texture_coordinate_2d;exposure_value=mix(staticOptions[0],staticOptions[1],current_power_progress);}",fragment:"precision lowp float;uniform sampler2D first_texture;varying vec2 current_texture_coordinate_2d;varying float exposure_value;void main(){vec4 texture=texture2D(first_texture,current_texture_coordinate_2d);gl_FragColor=vec4((texture.xyz)*(1.0+exposure_value),texture.w);}"},t,e)}static getFilterType(){return"exposureTransition"}static getInputsCount(){return 1}static getInitialOptions(){return{properties:{power:{form:0,to:0,ease:[0,0,1,1]}}}}handleStaticUniforms(e){const t=e.properties.power;this.uniforms[VO.STATIC_OPTIONS].set([t.from,t.to,...t.ease])}static getUniformList(){return[VO.FIRST_TEXTURE,zO]}}class vN extends KO{constructor(e){const t={uniforms:KO.getUniformInfo(vN)};super(vN.getFilterType(),{vertex:"precision lowp float;attribute vec3 position_3d;attribute vec2 texture_coordinate_2d;uniform float runtimeOptions[1];uniform float staticOptions[6];varying vec2 current_texture_coordinate_2d;varying float dipToBlack_value;float getCurrentBeizerProgress(vec2 p1,vec2 p2,float t){vec2 p0=vec2(0,0);vec2 p3=vec2(1,1);vec2 E=mix(p0,p1,t);vec2 F=mix(p1,p2,t);vec2 G=mix(p2,p3,t);vec2 H=mix(E,F,t);vec2 I=mix(F,G,t);vec2 P=mix(H,I,t);return P.y;}void main(){vec4 normalize_poistion=vec4(position_3d.xyz,1);gl_Position=normalize_poistion;float current_time=runtimeOptions[0];float current_power_progress=getCurrentBeizerProgress(vec2(staticOptions[2],staticOptions[3]),vec2(staticOptions[4],staticOptions[5]),current_time);current_texture_coordinate_2d=texture_coordinate_2d;dipToBlack_value=mix(staticOptions[0],staticOptions[1],current_power_progress);}",fragment:"precision lowp float;uniform sampler2D first_texture;varying vec2 current_texture_coordinate_2d;varying float dipToBlack_value;void main(){vec4 texture=texture2D(first_texture,current_texture_coordinate_2d);gl_FragColor=vec4(texture.xyz-dipToBlack_value,texture.w);}"},t,e)}static getFilterType(){return"dipToBlackTransition"}static getInputsCount(){return 1}static getInitialOptions(){return{}}handleStaticUniforms(e){const t=e.properties.power;this.uniforms[VO.STATIC_OPTIONS].set([t.from,t.to,...t.ease])}static getUniformList(){return[VO.FIRST_TEXTURE,zO]}}class bN extends KO{constructor(e){const t={uniforms:KO.getUniformInfo(bN)};super(bN.getFilterType(),{vertex:"attribute vec3 position_3d;attribute vec2 texture_coordinate_2d;uniform float runtimeOptions[1];uniform float staticOptions[16];varying vec2 current_texture_coordinate_2d;float getCurrentBeizerProgress(vec2 p1,vec2 p2,float t){vec2 p0=vec2(0,0);vec2 p3=vec2(1,1);vec2 E=mix(p0,p1,t);vec2 F=mix(p1,p2,t);vec2 G=mix(p2,p3,t);vec2 H=mix(E,F,t);vec2 I=mix(F,G,t);vec2 P=mix(H,I,t);return P.y;}void main(){float current_time=runtimeOptions[0];float current_scale_x_progress=getCurrentBeizerProgress(vec2(staticOptions[4],staticOptions[5]),vec2(staticOptions[6],staticOptions[7]),current_time);float currnet_scale_x_value=mix(staticOptions[0],staticOptions[1],current_scale_x_progress);float current_scale_y_progress=getCurrentBeizerProgress(vec2(staticOptions[4],staticOptions[5]),vec2(staticOptions[6],staticOptions[7]),current_time);float currnet_scale_y_value=mix(staticOptions[2],staticOptions[3],current_scale_y_progress);float current_translate_x_progress=getCurrentBeizerProgress(vec2(staticOptions[12],staticOptions[13]),vec2(staticOptions[14],staticOptions[15]),current_time);float currnet_translate_x_value=mix(staticOptions[8],staticOptions[9],current_translate_x_progress);float current_translate_y_progress=getCurrentBeizerProgress(vec2(staticOptions[12],staticOptions[13]),vec2(staticOptions[14],staticOptions[15]),current_time);float currnet_translate_y_value=mix(staticOptions[10],staticOptions[11],current_translate_y_progress);currnet_translate_y_value=currnet_translate_y_value*-1.0;mat4 scaleMatrix;scaleMatrix[0]=vec4(currnet_scale_x_value,0,0,0);scaleMatrix[1]=vec4(0,currnet_scale_y_value,0,0);scaleMatrix[2]=vec4(0,0,1,0);scaleMatrix[3]=vec4(0,0,0,1);mat4 translateMatrix;translateMatrix[0]=vec4(1,0,0,0);translateMatrix[1]=vec4(0,1,0,0);translateMatrix[2]=vec4(0,0,1,0);translateMatrix[3]=vec4(currnet_translate_x_value,currnet_translate_y_value,0,1);vec4 normalize_poistion=vec4(position_3d.xyz,1);gl_Position=translateMatrix*scaleMatrix*normalize_poistion;current_texture_coordinate_2d=texture_coordinate_2d;}",fragment:"precision lowp float;uniform sampler2D first_texture;varying vec2 current_texture_coordinate_2d;void main(){gl_FragColor=texture2D(first_texture,current_texture_coordinate_2d);}"},t,e)}static getFilterType(){return"transformTransition"}static getInputsCount(){return 1}static getInitialOptions(){return{}}handleStaticUniforms(e){const t=e.properties.scale||{},n=e.properties.translate||{};t.ease=t.ease||[0,0,1,1],n.ease=n.ease||[0,0,1,1],this.uniforms[VO.STATIC_OPTIONS].set([t.from&&t.from.x||1,t.to&&t.to.x||1,t.from&&t.from.y||1,t.to&&t.to.y||1,...t.ease,n.from&&n.from.x||0,n.to&&n.to.x||0,n.from&&n.from.y||0,n.to&&n.to.y||0,...n.ease])}static getUniformList(){return[VO.FIRST_TEXTURE,zO]}}class wN extends KO{constructor(e){const t={uniforms:KO.getUniformInfo(wN)};super(wN.getFilterType(),{vertex:"precision lowp float;attribute vec3 position_3d;attribute vec2 texture_coordinate_2d;uniform float staticOptions[8];uniform float runtimeOptions[3];varying vec2 current_texture_coordinate_2d;varying float current_power_value;float getCurrentBeizerProgress(vec2 p1,vec2 p2,float t){vec2 p0=vec2(0,0);vec2 p3=vec2(1,1);vec2 E=mix(p0,p1,t);vec2 F=mix(p1,p2,t);vec2 G=mix(p2,p3,t);vec2 H=mix(E,F,t);vec2 I=mix(F,G,t);vec2 P=mix(H,I,t);return P.y;}void main(){vec4 normalize_poistion=vec4(position_3d.xyz,1);gl_Position=normalize_poistion;float current_time=runtimeOptions[0];float current_power_progress=getCurrentBeizerProgress(vec2(staticOptions[2],staticOptions[3]),vec2(staticOptions[4],staticOptions[5]),current_time);current_texture_coordinate_2d=texture_coordinate_2d;current_power_value=mix(staticOptions[0],staticOptions[1],current_power_progress);}",fragment:"precision lowp float;uniform sampler2D first_texture;uniform float staticOptions[8];uniform float runtimeOptions[3];varying vec2 current_texture_coordinate_2d;varying float current_power_value;const int samples=12;void main(){vec2 pixel=vec2(1.0/runtimeOptions[1],1.0/runtimeOptions[2]);vec2 direction=vec2(staticOptions[6],staticOptions[7]);vec4 color=vec4(0.0);for(int i=1;i<=samples/2;i++){vec2 motion=float(i)*current_power_value/float(samples/2)*direction*pixel;color+=texture2D(first_texture,current_texture_coordinate_2d+motion);color+=texture2D(first_texture,current_texture_coordinate_2d-motion);}color=color/float(samples);gl_FragColor=color;}"},t,e)}static getFilterType(){return"motionBlurTransition"}static getInputsCount(){return 1}static getInitialOptions(){return{}}handleStaticUniforms(e){const t=e.properties.power||{from:0,to:0},n=e.properties.direction||{x:0,y:0};t.ease=t.ease||[0,0,1,1],this.uniforms[VO.STATIC_OPTIONS].set([t.from,t.to,...t.ease,n.x,n.y])}static getUniformList(){return[VO.FIRST_TEXTURE,zO,UO]}}class kN extends KO{constructor(e){const t={uniforms:KO.getUniformInfo(kN)};super(kN.getFilterType(),{vertex:"precision lowp float;attribute vec3 position_3d;attribute vec2 texture_coordinate_2d;uniform float runtimeOptions[1];uniform float staticOptions[9];varying vec2 current_texture_coordinate_2d;varying float current_power_value;float getCurrentBeizerProgress(vec2 p1,vec2 p2,float t){vec2 p0=vec2(0,0);vec2 p3=vec2(1,1);vec2 E=mix(p0,p1,t);vec2 F=mix(p1,p2,t);vec2 G=mix(p2,p3,t);vec2 H=mix(E,F,t);vec2 I=mix(F,G,t);vec2 P=mix(H,I,t);return P.y;}void main(){vec4 normalize_poistion=vec4(position_3d.xyz,1);gl_Position=normalize_poistion;float current_time=runtimeOptions[0];float current_power_progress=getCurrentBeizerProgress(vec2(staticOptions[2],staticOptions[3]),vec2(staticOptions[4],staticOptions[5]),current_time);current_texture_coordinate_2d=texture_coordinate_2d;current_power_value=mix(staticOptions[0],staticOptions[1],current_power_progress);}",fragment:"precision lowp float;uniform sampler2D first_texture;uniform float staticOptions[9];varying vec2 current_texture_coordinate_2d;varying float current_power_value;void main(){vec4 texture=texture2D(first_texture,current_texture_coordinate_2d);vec4 fadeColor=vec4(staticOptions[6],staticOptions[7],staticOptions[8],1.0);gl_FragColor=mix(texture,fadeColor,current_power_value);}"},t,e)}static getFilterType(){return"fadeToColorTransition"}static getInputsCount(){return 1}static getInitialOptions(){return{properties:{power:{form:0,to:0,ease:[0,0,1,1]},color:"#FFFFFF"}}}handleStaticUniforms(e){const t=e.properties.power||{from:0,to:0};t.ease=t.ease||[0,0,1,1];const n=gN.hex.rgb(e.properties.color).map((e=>e/255));this.uniforms[VO.STATIC_OPTIONS].set([t.from,t.to,...t.ease,n[0],n[1],n[2]])}static getUniformList(){return[VO.FIRST_TEXTURE,zO]}}var xN=Object.freeze({__proto__:null,Crop:JL,Curves:HL,Default:XO,DipToBlackTransition:vN,DirectionalBlur:sL,Exposure:iN,ExposureTransition:yN,FadeToColorTransition:kN,FastBlur:oL,HardLight:mN,HorizontalBlur:iL,Hue:KL,Lab:nN,Levels:GL,Lut:cL,MotionBlurTransition:wN,Opacity:aL,Saturation:ZL,ShapeComposite:lL,ShapeCompositeMask:class e extends KO{constructor(t){const n={uniforms:KO.getUniformInfo(e)};super(e.getFilterType(),{vertex:"attribute vec3 position_3d;attribute vec2 texture_coordinate_2d;varying vec2 current_texture_coordinate_2d;varying vec2 current_position_coordinate_2d;void main(){vec4 normalize_poistion=vec4(position_3d.xyz,1);gl_Position=normalize_poistion;current_texture_coordinate_2d=texture_coordinate_2d;current_position_coordinate_2d=normalize_poistion.xy;}",fragment:"precision lowp float;uniform sampler2D first_texture;uniform sampler2D second_texture;uniform float staticOptions[7];uniform float runtimeOptions[2];varying vec2 current_texture_coordinate_2d;varying vec2 current_position_coordinate_2d;float roundedBoxSDF(vec2 point,vec2 center,vec2 area,float radius){return length(max(abs(point-center)-area+radius,0.0))-radius;}float boxSDF(vec2 point,vec2 center,vec2 area){vec2 d=abs(point-center)-area;return length(max(d,vec2(0)));}void main(){float type=staticOptions[0];vec2 aspectRatio=vec2(runtimeOptions[0]/runtimeOptions[1],1.0);vec2 center=vec2(staticOptions[1],staticOptions[2])*aspectRatio;vec2 area=max(vec2(staticOptions[3],staticOptions[4])*aspectRatio,0.0);float radius=staticOptions[5];vec2 SDF_PositionCoordinate2d=vec2(current_position_coordinate_2d.x,current_position_coordinate_2d.y*-1.0)*aspectRatio;vec4 color1=texture2D(first_texture,current_texture_coordinate_2d);vec4 color2=texture2D(second_texture,current_texture_coordinate_2d);float dist;vec4 color;if(type==0.0){dist=boxSDF(SDF_PositionCoordinate2d,center,area);color=(dist>0.0)? color2: color1;}else{dist=roundedBoxSDF(SDF_PositionCoordinate2d,center,area,radius);color=(dist>0.0)? color2: color1;color=mix(color,color2,1.0-smoothstep(0.0,0.0025,abs(dist)));}gl_FragColor=color;}"},n,t)}static getFilterType(){return"shapeCompositeMask"}static getInputsCount(){return 2}static getInitialOptions(){return{type:"box",center:{x:0,y:0},area:{width:0,height:0},radius:.01,edgeSoftness:0}}getOptionsDisplay(){return[{properties:["center","x"],type:"slider",minValue:-1,maxValue:1,step:.001},{properties:["center","y"],type:"slider",minValue:-1,maxValue:1,step:.001},{properties:["area","width"],type:"slider",minValue:-2,maxValue:2,step:.001},{properties:["area","height"],type:"slider",minValue:-2,maxValue:2,step:.001},{properties:["radius"],type:"slider",minValue:-2,maxValue:2,step:.001},{properties:["edgeSoftness"],type:"slider",minValue:-2,maxValue:2,step:.001}]}static getUniformList(){return[VO.FIRST_TEXTURE,UO,VO.SECOND_TEXTURE]}handleStaticUniforms(e){let t;switch(e.type){case"box":t=0;break;case"rounded":t=1;break;default:throw new Error("cant recognize shape composite mask type")}const n=Number.parseFloat(e.center.x).toFixed(7);let i=Number.parseFloat(e.center.y).toFixed(7);i+=0;const r=Number.parseFloat(e.area.width).toFixed(7),o=Number.parseFloat(e.area.height).toFixed(7),s=Number.parseFloat(e.radius).toFixed(7),a=Number.parseFloat(e.edgeSoftness).toFixed(7);this.uniforms[VO.STATIC_OPTIONS].set([t,n,i,r,o,s,a])}},Solid:eN,SolidImage:tN,Transform:nL,TransformTransition:bN,VerticalBlur:rL,Vibrance:QL,WhiteBalance:XL});const SN=Object.values(xN).reduce(((e,t)=>(e[t.getFilterType()]=t,e)),{});class CN{constructor(e){this.context=e}static getFilterClass(e){return SN[e]}getFilterIds(){return Object.keys(this.filterTypeToInstanceMap)}create(e,t){this.context={...this.context,options:t.options};const n=new SN[e](this.context);if(!n)throw new Error(`${e} is not a atom filter, atomFilter list: `,this.getFilterIds());return n}}const _N=tO.PREVIOUS_OUTPUT_PREFIX,EN=Object.values(xN).reduce(((e,t)=>(e[t.getFilterType()]={type:t.getFilterType(),options:t.getInitialOptions(),inputs:[...Array(t.getInputsCount())].map(((e,t)=>`${_N}${t}`)),outputs:[]},e)),{});var TN=function(e,t){return _I(e,t,{arrayMerge:(e,t)=>t})};const PN=tO.MESSAGES.UPDATE_OPTIONS;let IN=class{constructor(e,t){this.eventEmitter=new nw,this.type=e,this.inputs=t.inputs,this.outputs=t.outputs,this.options=t.options}render(){throw new Error("concrete class should implement")}_updateOptions(){throw new Error("concrete class should implement")}updateOptions(e){this._updateOptions(e),this.eventEmitter.emit(PN,this.options)}updateInputs(e){if(e){const t=this.inputs.length===e.length&&this.inputs.every(((t,n)=>t===e[n]));t||(this.inputs=[...e])}}getEventEmitter(){return this.eventEmitter}getType(){return this.type}getInputs(){return this.inputs}getOutputs(){return this.outputs}getOptions(){return this.options}getInfo(){return{inputs:this.inputs,outputs:this.outputs,options:this.options}}getOptionsDisplay(){return this.filter.getOptionsDisplay()}dispose(){throw new Error("concrete class should implement")}};class AN extends IN{constructor(e,t,n){super(...arguments),this.filter=n.filterFactory.create(this.type,{options:this.options})}render(e){const t=e.ioStore,n=e.graphIOManager,i=this.getInputs(),r=this.getOutputs(),o=t.get(i),s=this.filter.render(o,this.options);return n.setOutputs(t,r,s),s}_updateOptions(e){this.options=TN(this.options,e),this.filter.updateStaticUniforms(this.options)}dispose(){this.filter.dispose()}}const ON=tO.MESSAGES.UPDATE_OPTIONS;class LN extends AN{constructor(e,t,n){super(...arguments),this.baseNode=n.baseNode,this.registerListeners()}baseNodeUpdateOptions(e){this.options=TN(this.options,e),this.filter.updateStaticUniforms(this.options)}registerListeners(){this.baseNode.getEventEmitter().on(ON,this.baseNodeUpdateOptions,this)}dispose(){this.filter.dispose(),this.baseNode.getEventEmitter().off(ON,this.baseNodeUpdateOptions,this)}}function NN(e){return null!==e&&"object"==typeof e}function RN(e){if(!NN(e)||Array.isArray(e))return e;const t=Object.keys(e).sort(),n={};return t.forEach((t=>{n[t]=RN(e[t])})),n}function DN(e,t){return e.type===t.type}var MN=function(e,t,n,i){const r=e.graph,o=t.graph;if(!(o&&r&&Array.isArray(o)&&Array.isArray(r)))throw new Error("cant apply new composite options",e);return function(e,t,n,i){const r=[];return e.forEach((e=>{switch(e.type){case"take":r.push(n[e.index]);break;case"update":const o=t[e.newGraphIndex].options,s=n[e.currentGraphIndex];s.updateInputs(t[e.newGraphIndex].inputs),s.updateOptions(o),r.push(s);break;case"create":const a=qN.create(t[e.newGraphIndex],i);r.push(a);break;case"dispose":n[e.currentGraphIndex].dispose();break;default:throw new Error("cant apply action type: ",e.type)}})),r}(function(e,t){const n=[];e.forEach(((e,i)=>{const r=(o=e,t.findIndex((e=>function(e,t){const n=JSON.parse(JSON.stringify(e));return r=JSON.parse(JSON.stringify(t)),NN(i=n)&&NN(r)?JSON.stringify(RN(i))===JSON.stringify(RN(r)):!(!Number.isNaN(i)||!Number.isNaN(r))||i===r;var i,r}(o,e))));var o;if(-1!==r)return void n.push({type:"take",index:r});const s=function(e,t,n){return n&&n[t]&&DN(e,n[t])?t:n.findIndex((t=>DN(e,t)))}(e,i,t);n.push(-1===s?{type:"create",newGraphIndex:i}:{type:"update",currentGraphIndex:s,newGraphIndex:i})}));const i=n.reduce(((e,t)=>("take"===t.type?e.push(t.index):"update"===t.type&&e.push(t.currentGraphIndex),e)),[]),r=t.reduce(((e,t,n)=>(i.includes(n)||e.push(n),e)),[]);return r.forEach((e=>{n.push({type:"dispose",currentGraphIndex:e})})),n}(r,o),r,n,i)};class FN extends IN{constructor(e,t,n){super(...arguments),this.context=n,this.nodes=this.createNodes(this.options)}createNodes(e){if(!e||!e.graph)throw new Error("cant create composite node, please supply info.options.graph");return e.graph.map((e=>qN.create(e,this.context)))}render(e){const t=e.ioStore,n=e.graphIOManager;let i=n.getPrevOutput(t);const r=this.outputs;if(this.nodes.length){const e=new aO(t),r=[];this.nodes.forEach(((t,o)=>{i=t.render({ioStore:e,graphIOManager:n}),o!==this.nodes.length-1&&r.push(i)})),n.disposeTextures(r,i)}return n.setOutputs(t,r,i),i}getOptionsDisplay(){return[]}_updateOptions(e){this.nodes=MN(e,this.options,this.nodes,this.context),this.options=e}dispose(){this.nodes.forEach((e=>{e.dispose()}))}}const BN=tO.MESSAGES.UPDATE_OPTIONS;class UN extends FN{constructor(e,t,n){super(...arguments),this.baseNode=n.baseNode,this.registerListeners()}registerListeners(){this.baseNode.getEventEmitter().on(BN,this.updateOptions,this)}dispose(){this.nodes.forEach((e=>{e.dispose()})),this.baseNode.getEventEmitter().off(BN,this.updateOptions,this)}}const jN=tO.SYSTEM_NODES.TAGS.ATOM,zN=tO.SYSTEM_NODES.TAGS.FILTER,VN=tO.SYSTEM_NODES.TAGS.COMPOSITE_FILTER,WN=tO.SYSTEM_NODES.TAGS.TRANSITION_FILTER,HN=tO.PREVIOUS_OUTPUT_PREFIX,$N=Object.keys(EN);function GN(e,t){return e=TN(EN[e.type],e),new AN(e.type,e,t)}var qN={create:function(e,t){let n;switch(function(e){let t;return t=function(e){return $N.includes(e)}(e)?jN:e===VN?VN:e===WN?WN:zN,t}((e=JSON.parse(JSON.stringify(e))).type)){case jN:n=GN(e,t);break;case zN:n=function(e,t){const n=function(e,t){const n=t.get(e);if(!n)throw new Error(`no base node, cant resolve type: ${e}`);return n}(e.type,t.nodeStore),i=n.getType(),r=n.getInfo();let o;return e=TN(r,e),t={...t,baseNode:n},o=i===VN?new UN(i,e,t):new LN(i,e,t),o}(e,t);break;case VN:n=function(e,t){const n=e.type;return e=TN({inputs:[`${HN}0`]},e),new FN(n,e,t)}(e,t);break;case WN:n=function(e,t){const n=e.options.filter;if(!n)throw new Error(`transition filter should supply base filter ${n}`);return e.type=`${n}Transition`,GN(e,t)}(e,t);break;default:throw new Error("cant create node",e.type)}return n}};const YN=tO.SYSTEM_NODES.FILTERS.RENDER_TO_CANVAS;const KN=tO.CAPTURED_FRAME_PREFIX;class XN{constructor(e){return this.textureManager=e.textureManager,this.currentFrameTextures={0:this.textureManager.createTexture({type:"frame"})},this.saveInNextFrameTextures=[],this.savedFramesTextures={},this.reservedUnits=new Set([this.currentFrameTextures[0].getUnit()]),{capture:this.capture.bind(this),createCaptureId:this.createCaptureId.bind(this),releaseCaptureId:this.releaseCaptureId.bind(this),getCurrentFrames:this.getCurrentFrames.bind(this),getSavedFrames:this.getSavedFrames.bind(this),isReservedUnit:this.isReservedUnit.bind(this)}}updateCurrentFrame(e,t){this.currentFrameTextures[t=t||0].fill(e)}saveFrame(e){0!==this.saveInNextFrameTextures.length&&(this.saveInNextFrameTextures.forEach((t=>{t.fill(e)})),this.saveInNextFrameTextures=[])}capture(e,t){(e.videoHeight>150||e.displayHeight>150)&&(this.updateCurrentFrame(e,t),this.saveFrame(e))}createCaptureId(){const e=this.textureManager.createTexture({type:"frame"});this.saveInNextFrameTextures.push(e);const t=e.getUnit(),n=`${KN}${t}`;return this.savedFramesTextures[n]=e,this.reservedUnits.add(t),n}releaseCaptureId(e){if("string"!=typeof e)throw new Error("capture id should be string");delete this.saveInNextFrameTextures[e];const t=e.split(":")[1];this.reservedUnits.delete(parseInt(t,10))}getCurrentFrames(){return this.currentFrameTextures}getSavedFrames(){return this.savedFramesTextures}isReservedUnit(e){return this.reservedUnits.has(e)}}const QN=rI("ShaderGraphApplication","warn"),ZN=tO.SYSTEM_NODES.FILTERS.RENDER_TO_CANVAS;class JN{constructor(e,t={}){return this.glSource=e,this.config=t,this.doInit(e,t)}doInit(e,t){return this.source=function(e){let t;return t="string"==typeof e?new rO(e):e&&e.src&&e.dest?new oO(e):new iO(e),t}(e),this.render=this.render.bind(this),this.resizeCanvasSize=this.resizeCanvasSize.bind(this),this.setSrcVidTracks=this.setSrcVidTracks.bind(this),this.onWebGLContextLost=this.onWebGLContextLost.bind(this),this.onForceRender=this.onForceRender.bind(this),this.resizeCanvasSize._shouldPreventDefault=!0,this.gl=this.source.init(this.setSrcVidTracks,this.resizeCanvasSize,t.glOptions),this.addCanvasListeners(),this.addSourceListeners(),"undefined"!=typeof window&&(window.ekoShaderGraph=this),this.selectedRenderNode=null,this.textureManager=new pO({gl:this.gl}),this.capturedFramesManager=new XN({textureManager:this.textureManager}),this.graphIOManager=new kO({glSource:e,gl:this.gl,textureManager:this.textureManager,capturedFramesManager:this.capturedFramesManager}),this.frameBufferFactory=new _O({gl:this.gl,textureManager:this.textureManager}),this.filterFactory=new CN({gl:this.gl,frameBufferFactory:this.frameBufferFactory}),this.nodeStore=new aO,this.ioStore=new aO,function(e){const t={[YN]:EN[YN]};for(const[n,i]of Object.entries(t)){const t=qN.create(i,e);e.nodeStore.set(n,t)}}({nodeStore:this.nodeStore,filterFactory:this.filterFactory}),this.addClientNodes(t.nodes),t.userWillCallRender||(this.rafId=requestAnimationFrame(this.render)),this.dirtyCanvasSize=!0,{getNodes:this.getNodes.bind(this),addNodes:this.addClientNodes.bind(this),selectNode:this.selectNode.bind(this),addTexture:this.addTexture.bind(this),releaseTexture:this.releaseTexture.bind(this),captureTexture:this.captureTexture.bind(this),disposeTexture:this.disposeTexture.bind(this),updateOptions:this.updateOptions.bind(this),render:this.render,dispose:this.dispose.bind(this)}}getNodes(){return QN.debug("[getNodes]"),this.nodeStore.get()}addClientNodes(e){QN.debug("[addClientNodes]",e),e&&(this.addClientNodeInvocations=this.addClientNodeInvocations||[],this.addClientNodeInvocations.push(e)),e=e||{};!function(e,t){for(const[n,i]of Object.entries(e)){const e=qN.create(i,t);t.nodeStore.set(n,e)}}(JSON.parse(JSON.stringify(e)),{nodeStore:this.nodeStore,filterFactory:this.filterFactory})}addTexture(e,t,n){QN.debug("[addTexture]",e,t,n);let i=this.textureManager.createTexture({type:t});return i.isStatic=!0,e&&i.fill(e),this.graphIOManager.setTextureSource(this.ioStore,i,n),i}releaseTexture(e){QN.debug("[releaseTexture]",e),this.textureManager.releaseTexture(e)}selectNode(e){if(QN.debug("[selectNode]",e),!this.nodeStore.get(e))throw new Error(`cant find ${e}`);this.selectedRenderNodeId=e}captureTexture(){return QN.debug("[captureTexture]"),this.capturedFramesManager.createCaptureId()}disposeTexture(e){return QN.debug("[disposeTexture]",e),this.capturedFramesManager.releaseCaptureId(e)}setSrcVidTracks(e){this.capturedFramesManager&&this.capturedFramesManager.capture(e)}resizeCanvasSize(e,t,n,i){this.dirtyCanvasSize={width:n,height:i}}render(e={}){const{noRaf:t=!1}=e;if(this.dirtyCanvasSize){let{width:e=this.gl.canvas.width,height:t=this.gl.canvas.height}=this.dirtyCanvasSize;!function(e,t){HO=e,$O=t}(e,t),this.gl.canvas.width=e,this.gl.canvas.height=t,this.textureManager.refreshTextureObjects(),this.gl.viewport(0,0,e,t),this.dirtyCanvasSize=!1}this.graphIOManager.setVideoSources(this.ioStore);let n={ioStore:this.ioStore,graphIOManager:this.graphIOManager};this.selectedRenderNodeId&&this.nodeStore.get(this.selectedRenderNodeId).render(n),this.config.onPreRenderToScreen&&this.config.onPreRenderToScreen(),this.nodeStore.get(ZN).render(n),this.config.onPostRenderToScreen&&this.config.onPostRenderToScreen(),this.graphIOManager.disposeAllStore(this.ioStore),n=null,!t&&!this.config.userWillCallRender&&(this.rafId=requestAnimationFrame(this.render))}updateOptions(e,t){QN.debug("[updateOptions]",e,t),this.nodeStore.get(e).updateOptions(t)}addSourceListeners(){var e;"function"==typeof(null===(e=this.source)||void 0===e?void 0:e.on)&&this.source.on("forcerender",this.onForceRender)}removeSourceListeners(){var e;"function"==typeof(null===(e=this.source)||void 0===e?void 0:e.off)&&this.source.off("forcerender",this.onForceRender)}addCanvasListeners(){var e;null!=this&&null!==(e=this.gl)&&void 0!==e&&e.canvas&&(this.config.noWebGLContextLostRecovery||this.gl.canvas.addEventListener("webglcontextlost",this.onWebGLContextLost))}removeCanvasListeners(){var e;null!=this&&null!==(e=this.gl)&&void 0!==e&&e.canvas&&this.gl.canvas.removeEventListener("webglcontextlost",this.onWebGLContextLost)}getNodesOptions(){const e=this.getNodes();let t={};return Object.keys(e).filter((e=>"__default"!==e)).forEach((n=>{t[n]=e[n].options})),t}getDocumentVisibilityPromise(){return new Promise((e=>{"visible"===document.visibilityState&&e();const t=()=>{"visible"===document.visibilityState&&(document.removeEventListener("visibilitychange",t),e())};document.addEventListener("visibilitychange",t)}))}onForceRender(){QN.info("[onForceRender]"),this.render({noRaf:!0})}async onWebGLContextLost(){const e=this.getNodesOptions(),t=this.addClientNodeInvocations,n=this.selectedRenderNodeId;cancelAnimationFrame(this.rafId);const i=async()=>{try{var r;QN.warn("WebGL context lost - attempting to recover"),await this.getDocumentVisibilityPromise(),this.dispose(!1),this.doInit(this.glSource,this.config),t&&t.length&&t.forEach((e=>{QN.debug("Re-adding client nodes",e),this.addClientNodes(e)})),Object.entries(e).forEach((([e,t])=>{QN.debug("Re-applying node options",e,t),this.updateOptions(e,t)})),this.selectNode(n),"function"==typeof(null===(r=this.source)||void 0===r?void 0:r.recover)&&(QN.debug("Recovering glSource (i.e. seeking/resetting player)"),await this.source.recover(),this.render())}catch(e){QN.error("Failed to recover WebGL context, retrying",e),setTimeout(i,200)}};await i()}dispose(e=!0){if(this.selectedRenderNode=null,this.source&&(this.removeSourceListeners(),"function"==typeof this.source.dispose&&this.source.dispose()),this.gl){this.removeCanvasListeners();const t=this.gl.getParameter(this.gl.MAX_TEXTURE_IMAGE_UNITS);for(let e=0;e<t;++e)this.gl.activeTexture(this.gl.TEXTURE0+e),this.gl.bindTexture(this.gl.TEXTURE_2D,null),this.gl.bindTexture(this.gl.TEXTURE_CUBE_MAP,null);if(this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,null),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),this.gl.bindTexture(this.gl.TEXTURE_2D,null),this.gl.bindRenderbuffer(this.gl.RENDERBUFFER,null),e)try{this.gl.getExtension("WEBGL_lose_context").loseContext()}catch(e){console.error(e)}}this.selectedRenderNodeId=null,delete this.addClientNodeInvocations}}let eR;class tR{constructor(e){if(eR)throw new Error("ShaderGraphManager is a singleton class and can only be instantiated once. Please use ShaderGraphManager.getInstance() instead.");if(!e)throw new Error("ShaderGraphManager requires an instance player to be passed to its constructor.");this.shaderGraphApp=e,this.renderGraphs=[],this.renderGraphName="main",this.addToRepository(this.renderGraphName,{type:"composite",options:{graph:this.renderGraphs}}),this.updateRenderGraph(),this.shaderGraphApp.selectNode(this.renderGraphName)}static getInstance(e){return eR||(eR=new tR(e)),eR}updateRenderGraph(){this.shaderGraphApp.updateOptions(this.renderGraphName,{graph:JSON.parse(JSON.stringify(this.renderGraphs))})}addToRepository(e,t){const n=JSON.parse(JSON.stringify(t));this.shaderGraphApp.addNodes({[e]:n})}addToRenderPipeline(e,t=null){const n=this.renderGraphs.map((e=>e.id));let i;i=0===this.renderGraphs.length?0:null===t?this.renderGraphs.length:t,n.includes(e)||(this.renderGraphs.splice(i,0,{type:e}),this.updateRenderGraph())}addToRenderPipelineAfterGraph(e,t){let n,i=this.renderGraphs.findIndex((e=>e.type===t));-1===i?(n=this.renderGraphs.length,console.error(`VFX: addToRenderPipelineAfterGraph did not find graph with id ${t}`)):n=i+1,this.addToRenderPipeline(e,n)}addTransitionToRenderPipeline(e){let t,n=this.transitionSource;if(!1!==n){if(null===n||"start"===n)t=0;else{if("end"!==n)return void this.addToRenderPipelineAfterGraph(e,n);t=this.renderGraphs.length}this.addToRenderPipeline(e,t)}}removeFromRenderPipeline(e){this.renderGraphs=this.renderGraphs.filter((t=>t.type!==e)),this.updateRenderGraph()}updateOptions(e,t){this.shaderGraphApp.updateOptions(e,t),this.updateRenderGraph()}setTransitionSource(e){this.transitionSource=e}getTransitionSource(){return this.transitionSource}}let nR=0,iR=class{constructor(e,t,n){this.id=`${e}_${++nR}`,this.options=n,this.createShaderGraph=t,tR.getInstance().addToRepository(this.id,{type:"composite",options:{graph:t(this.options)},outputs:[this.id]})}add(e){"string"==typeof e?tR.getInstance().addToRenderPipelineAfterGraph(this.id,e):tR.getInstance().addToRenderPipeline(this.id,e)}remove(){tR.getInstance().removeFromRenderPipeline(this.id)}update(e){this.options=function(e,t){return _I(e,t,{arrayMerge:function(e,t){return t}})}(this.options,e),tR.getInstance().updateOptions(this.id,{graph:this.createShaderGraph(this.options)})}getId(){return this.id}};function rR(e){const t=function(e){return[{type:"transform",inputs:["__PREVIOUS:0"],options:{scale:Ee.get(e,"foreground.scale",{})}},{type:"transform",outputs:["foreground"],options:{translate:Ee.get(e,"foreground.translate",{})}}]}(e),n=function(e){const t=[{type:"transform",inputs:["__SRC_VID:0"],options:{scale:{x:.05,y:.05}}},{type:"verticalBlur"},{type:"horizontalBlur"},{type:"transform",options:{scale:{x:33,y:33}}},{type:"opacity",options:{power:Ee.get(e,"background.video.opacity",{})}}],n=Ee.get(e,"background.video.blendingMode",!1);return n&&t.push({type:n,options:{color:Ee.get(e,"background.baseColor",{})}}),t}(e);return t[t.length-1].outputs=["foreground"],n[n.length-1].outputs=["background"],[...t,...n,{type:"shapeCompositeMask",inputs:["foreground","background"],options:{type:Ee.get(e,"mask.type","box"),center:Ee.get(e,"mask.center",{}),area:Ee.get(e,"mask.area",{}),radius:Ee.get(e,"mask.radius",0),edgeSoftness:Ee.get(e,"mask.edgeSoftness",0)}}]}class oR extends iR{constructor(e){return super("shapeCompositeMask",rR,e),{add:this.add.bind(this),remove:this.remove.bind(this),update:this.update.bind(this)}}}function sR(e){const t=[{type:"solid",inputs:["__SRC_VID:0"],options:{color:function(e){const t=e.match(/^#?([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i);return t?{r:parseInt(t[1],16)/255,g:parseInt(t[2],16)/255,b:parseInt(t[3],16)/255}:{r:0,g:0,b:0}}(e.color||"#ffffff")},outputs:["solid"]}];return e.frames.forEach(((n,i)=>{t.push(...function(e,t,n){let i=t.sourceBR.x-t.sourceTL.x,r=t.sourceBR.y-t.sourceTL.y,o=t.targetBR.x-t.targetTL.x,s=t.targetBR.y-t.targetTL.y;const a=[{type:"crop",inputs:["__SRC_VID:0"],options:{source:{center:{x:t.sourceTL.x+i/2,y:t.sourceTL.y+r/2},width:i,height:r},target:{center:{x:t.targetTL.x+o/2,y:t.targetTL.y+s/2},width:o,height:s},viewport:n,cornerRadius:t.cornerRadius,fitType:t.fitType},outputs:[`frame_${e}_source`]}];let l;return l=0===e?["frame_0_source","solid"]:["__PREVIOUS:0","frame_"+(e-1)],a.push({type:"shapeComposite",inputs:l,outputs:[`frame_${e}`]}),a}(i,n,e.viewport))})),t}class aR extends iR{constructor(e){return super("retarget",sR,e),{getId:this.getId.bind(this),add:this.add.bind(this),remove:this.remove.bind(this),update:this.update.bind(this)}}}function lR(e){var t,n;let i=[];var r;return!1!==(null===(t=e.lut)||void 0===t?void 0:t.enabled)&&i.push({type:"lut",inputs:["__SRC_VID:0","__SRC_TEXTURE:0"],options:{},outputs:["lut"]}),!1!==(null===(n=e.curves)||void 0===n?void 0:n.enabled)&&i.push({type:"curves",inputs:["__PREVIOUS:0"],options:{master:null===(r=e.curves)||void 0===r?void 0:r.masterCurve},outputs:["curves"]}),i}class cR extends iR{constructor(e){return super("colorCorrection",lR,e),{add:this.add.bind(this),remove:this.remove.bind(this),update:this.update.bind(this)}}}class uR extends iR{constructor(e,t){return super(e.name,e.createShaderGraph,t),{getId:this.getId.bind(this),add:this.add.bind(this),remove:this.remove.bind(this),update:this.update.bind(this)}}}var dR=function(e,t){return{type:"transition",inputs:["__PREVIOUS:0"],options:{filter:"exposure",startTime:t,duration:Ee.get(e,"exposure.duration"),properties:{power:{from:Ee.get(e,"exposure.power.from"),to:Ee.get(e,"exposure.power.to"),ease:Ee.get(e,"exposure.ease")}}}}},hR=function(e,t,n){return{type:"transition",inputs:["__PREVIOUS:0"],options:{filter:"fadeToColor",startTime:t,duration:Ee.get(e,"fadeToColor.duration",0),properties:{power:{from:Ee.get(e,"fadeToColor.power.from",0),to:Ee.get(e,"fadeToColor.power.to",0),ease:Ee.get(e,"fadeToColor.ease",[0,0,1,1])},color:Ee.get(e,"fadeToColor.color",n.color)}}}},pR=function(e,t){return{type:"transition",inputs:["__PREVIOUS:0"],options:{filter:"transform",startTime:t,duration:Ee.get(e,"transform.duration",0),properties:{scale:{from:Ee.get(e,"transform.scale.from",{x:1,y:1}),to:Ee.get(e,"transform.scale.to",{x:1,y:1}),ease:Ee.get(e,"transform.ease",[0,0,1,1])},translate:{from:Ee.get(e,"transform.translate.from",{x:0,y:0}),to:Ee.get(e,"transform.translate.to",{x:0,y:0}),ease:Ee.get(e,"transform.ease",[0,0,1,1])}}}}},fR={isDonePlaying:function e(t,n){const i=n[0].options.startTime,r=function(e){return e.reduce(((e,t)=>e<t.options.duration?t.options.duration:e),0)}(n);(Date.now()-i)/r>1?t():requestAnimationFrame(e.bind(null,t,n,i))}};let gR=0;class mR{constructor(e,t,n){this.id=`${e}_${gR}`,gR++,this.stingerAnimation=t.stinger,this.context=n,this.options=t,this.playGraph=this.createGraph(t.filters);const i=function(e){const t=function(e){const t={};return Object.keys(e).forEach((n=>{t[n]=JSON.parse(JSON.stringify(e[n])),Object.values(t[n]).forEach((e=>{!function(e){if("number"==typeof e.from&&"number"==typeof e.to||"object"==typeof e.from&&"object"==typeof e.to){const t=e.from;e.from=e.to,e.to=t}}(e)}))})),t}(e.filters);return _I(t,e.reverseFilters,{arrayMerge:(e,t)=>t})}(t);return this.playReverseGraph=this.createGraph(i),tR.getInstance().addToRepository(this.id,{type:"composite",options:{graph:this.playGraph}}),{play:this.play.bind(this),playBackward:this.playBackward.bind(this),remove:this.remove.bind(this),isStinger:this.isStinger.bind(this),getMaxDuration:this.getMaxDuration.bind(this)}}createGraph(){throw new Error("impl in concrete class")}updateGraphTimes(e,t){return e.forEach((e=>{const n=1e3*this.context.player.currentNodeRemainingTime;e.options.duration=e.options.duration>n?n:e.options.duration,e.options.startTime=t})),e}isStinger(){return!!this.stingerAnimation}getMaxDuration(){let e=Object.values(this.options.filters),t=Object.values(this.options.reverseFilters),n=Math.max(...e.map((e=>e.duration))),i=Math.max(...t.map((e=>e.duration)));return{in:n,out:i}}play(e){e=e||this.playGraph;const t=Date.now(),n=this.updateGraphTimes(e,t);let i;tR.getInstance().updateOptions(this.id,{graph:n}),tR.getInstance().addTransitionToRenderPipeline(this.id);const r=new Promise((e=>{i=e}));return requestAnimationFrame(fR.isDonePlaying.bind(null,i,n)),r}playBackward(){return this.play(this.playReverseGraph)}remove(){tR.getInstance().removeFromRenderPipeline(this.id)}}class yR extends mR{createGraph(e,t){return[pR(e,t),dR(e,t),hR(e,t,{color:"#ffffff"})].filter((t=>!1!==e[t.options.filter]))}}var vR=function(e,t){return{type:"transition",inputs:["__PREVIOUS:0"],options:{filter:"dipToBlack",startTime:t,duration:Ee.get(e,"dipToBlack.duration"),properties:{power:{from:Ee.get(e,"dipToBlack.power.from"),to:Ee.get(e,"dipToBlack.power.to"),ease:Ee.get(e,"dipToBlack.ease")}}}}};class bR extends mR{createGraph(e,t){return[pR(e,t),vR(e,t)]}}let wR;class kR{constructor(e){if(wR)throw new Error("VFX is a singleton class and can only be instantiated once. Please use VFX.getInstance() instead.");if(!e)throw new Error("VFX requires an instance player to be passed to its constructor.");this.player=e,this.shaderGraph=new JN(e),this.shaderGraphManager=tR.getInstance(this.shaderGraph),this.transitionState=eO({})}static getInstance(e){return wR||(wR=new kR(e)),wR}createFilter(e,t){return function(e,t){if("object"==typeof e)return new uR(e,t);if("string"==typeof e)switch(e){case"shapeCompositeMask":return new oR(t);case"retarget":return new aR(t);case"colorCorrection":return new cR(t);default:throw new Error}}(e,t)}createTransition(e,t){return function(e,t,n){switch(e){case"zoomInExposure":return new yR(e,t,n);case"dipToBlack":return new bR(e,t,n);default:throw new Error(`cant find transition type: ${e}`)}}(e,t,{player:this.player})}async seekWithTransition(e,t,n,i){let r="string"==typeof t?t:t.id;if(!e)return void this.player.seek(t,n);if("in"===this.transitionState.direction)return void(null!=i&&i.forceSeekOnStackedTransitions&&this.player.seek(t,n));"out"===this.transitionState.direction&&this.transitionState.currentTransition&&this.transitionState.currentTransition.remove(),this.transitionState.currentTransition=e,this.transitionState.maxDuration=e.getMaxDuration(),this.transitionState.direction="in",this.transitionState.toNode=r;let o=new Promise((e=>{this.player.once("seeking",(()=>{this.player.once(this.player.paused?"seeked":"nodestart",e)}))}));(null==i?void 0:i.onTransitionInStart)&&i.onTransitionInStart(),await e.play(),((null==i?void 0:i.transitionOutPromise)||o).then((()=>{setTimeout((async()=>{(null==i?void 0:i.onTransitionInEnd)&&i.onTransitionInEnd(),e.isStinger()&&(e.remove(),this.transitionState.direction="out",(null==i?void 0:i.onTransitionOutStart)&&i.onTransitionOutStart(),await e.playBackward(),(null==i?void 0:i.onTransitionOutEnd)&&i.onTransitionOutEnd()),this.transitionState.toNode===r&&(e.remove(),this.transitionState.currentTransition=null,this.transitionState.direction=null,this.transitionState.maxDuration=null)}),0)})),this.player.seek(t,n)}setTransitionSource(e){return this.shaderGraphManager.setTransitionSource(e)}getTransitionSource(){return this.shaderGraphManager.getTransitionSource()}}var xR={filters:{fadeToColor:{duration:150,ease:[1,0,1,0],power:{from:0,to:1},color:"#ffffff"},exposure:!1,transform:{duration:150,ease:[0,.5,.5,1],scale:{from:{x:1,y:1},to:{x:1.1,y:1.1}},translate:{from:{x:0,y:0},to:{x:0,y:0}}}},reverseFilters:{fadeToColor:{duration:700,ease:[0,1,0,1]},exposure:!1,transform:{duration:700,ease:[0,1,0,1]}},stinger:!0},SR={filters:{transform:{duration:250,ease:[0,.5,.5,1],scale:{from:{x:1,y:1},to:{x:1.05,y:1.05}},translate:{from:{x:0,y:0},to:{x:0,y:0}}},dipToBlack:{duration:250,ease:[0,.5,.5,1],power:{from:0,to:1}}},reverseFilters:{dipToBlack:{duration:800,ease:[0,1,0,1]}},stinger:!0};const CR=rI("TransitionManager");let _R;class ER{constructor(e,t){CR("[constructor]"),this.player=e,"string"==typeof t?this.globalTransitionName=t:(this.globalTransitionName=t.name,this.globalTransitionConfig=t.config);let n={"Dip to white":["zoomInExposure",xR],"Dip to black":["dipToBlack",SR]};this.transitions={},Object.keys(n).forEach((e=>{setTimeout((()=>{let t=n[e][0],i=window.InterludePlayer.utils.extend(!0,{...n[e][1]},this.globalTransitionConfig&&this.globalTransitionConfig[t]);this.transitions[e]=kR.getInstance(this.player).createTransition(t,i)}),0)})),pI(this)}seekWithTransition(e,t,n){kR.getInstance(this.player).seekWithTransition(t,e,null,n)}static init(e,t){_R||(_R=new ER(e,t))}static getInstance(){return _R}getTransition(e){let t;return t=e?this.transitions[e]:this.transitions[this.globalTransitionName],t}}const TR=rI("player-helper");let PR;class IR{constructor(e,t){if(PR)throw new Error("PlayerHelper is a singleton class and can only be instantiated once. Please use PlayerHelper.getInstance() instead.");if(!e)throw new Error("PlayerHelper requires an instance player to be passed to its constructor.");if(!t)throw new Error('PlayerHelper requires "globalTransitionNameOrConfig" to be passed to its constructor.');this.player=e,this.globalTransitionNameOrConfig=t,ER.init(this.player,this.globalTransitionNameOrConfig),this.transitionManager=ER.getInstance(),pI(this),this.player.on("metamorphosis.needseektoswitch",this.onMetamorphosisNeedSeekToSwitch)}static getInstance(e,t){return PR||(PR=new IR(e,t)),PR}onMetamorphosisNeedSeekToSwitch(){this.seek(this.player.currentNodeId,{transitionOptions:{forceSeekOnStackedTransitions:!0}})}seekWithoutOffset(e,t={}){let n=!1!==t.transition&&(t.transition||this.transitionManager.getTransition());n?this.transitionManager.seekWithTransition(e,n,t.transitionOptions):this.player.seek(e)}seekWithOffset(e,t,n={}){if("string"==typeof e&&(e=this.player.repository.get(e)),t>e.duration)return TR.warn(`Tried to seek to an offset (${t}) bigger than the node's duration (${e.duration}), resolving to offset 0`),this.seekWithoutOffset(e,n);this.player.append(e),this.player.append(e),this.player.currentTime=this.player.duration-2*e.duration+t}seek(e,t={}){this.player.paused&&this.player.once("seeked",this.player.play),t.synchronized?this.seekWithOffset(e,this.player.currentNodeDuration-this.player.currentNodeRemainingTime,t):this.seekWithoutOffset(e,t)}}const AR=rI("Streamerizer");class OR{constructor(e,t,n){return AR("[constructor]"),pI(this),this.player=e,this.config=t,this.blocks=n,this.theme=JA.get(),this.seek=IR.getInstance(this.player,this.theme.transition).seek,this.setupPrefetching(),{setNextBlock:this.setNextBlock}}setupPrefetching(){for(const[e,t]of Object.entries(this.config.blocks)){t.prefetch||AR.warn(`Missing "prefetch" value for block "${e}" configuration. if no prefetch required, set an empty array []`);let n=(t.prefetch||[]).map((t=>{const n=this.blocks[t];return n||AR.warn(`Block "${e}" is trying to prefetch non-existent "${t}" block.`),n})).filter((e=>!!e)).map((e=>e.getHead()));this.blocks[e].getEnds().forEach((e=>{n.forEach((t=>{e.addPrefetch(t)}))}))}}setNextBlock(e,t,n={}){var i;n.onBlockStart=null!==(i=n.onBlockStart)&&void 0!==i?i:()=>{};let r=this.blocks[e],o=r.getHead();o.once("nodestart",(async()=>{await n.onBlockStart(r)})),t?this.seek(o,n.seekOptions):this.player.append(o)}}function LR(e){return function(e,t,n,i,r){return(r-0)/1*2-1}(0,0,0,0,e)}By(".placeholderViewport {\n  pointer-events: none;\n  --padding: 15vw;\n  position: absolute;\n  width: calc(100vw - var(--padding) * 2);\n  height: calc(100vh - var(--padding) * 2);\n  left: calc(var(--padding));\n  top: calc(var(--padding));\n}\n.placeholderViewport.debugMode {\n  background: rgba(251, 255, 0, 0.5);\n  pointer-events: all;\n}\n.placeholderViewport.debugMode.hasCropData {\n  background: rgba(85, 255, 0, 0.5);\n}");const NR=(e,t,n)=>{let i=n.onUpdatedDimensions,r=e.container.querySelector(".interludevideo").children[0].getBoundingClientRect(),o=r.width,s=r.height,a=document.querySelector(".masterContainer").classList.contains("paddedVideo"),l=n.cornerRadius,c=t.width/o,u=t.height/s,d={centerX:LR((t.left+t.width/2-r.left)/r.width),centerY:LR((r.bottom-t.bottom+t.height/2)/r.height),frameWidth:t.width/o,frameHeight:t.height/s,isHorizontal:t.width/o<t.height/s,shrinkFrameScaleFactorX:c,shrinkFrameScaleFactorY:u,isPadded:a,cornerRadius:l},h=function(e,t){let n=[0,1],i=[1,0];for(;;){const t=[n[0]+i[0],n[1]+i[1]];if(e*t[1]>t[0]){if(50<t[1])return i;n=t}else{if(e*t[1]===t[0])return 50>=t[1]?t:n[1]<i[1]?n:i;if(50<t[1])return n;i=t}}}(t.width/t.height);i&&i(d,`${h[0]}:${h[1]}`)};function RR(e){let[t,n]=Pg.useState();const i=Pg.useRef(null),r=Pg.useRef(null),o=()=>{!function(e,t,n){if(!e||!t)return;let i=t.getBoundingClientRect();0!==i.width&&0!==i.height&&e.videoWidth&&NR(e,i,n)}(e.responsiveVideoManager.player,r.current,e)},s=Pg.useCallback((e=>{null===e?(i.current=null,r.current=null):(r.current=e,i.current&&i.current.disconnect(),i.current=new ResizeObserver((t=>{for(let n of t)n.target===e&&o()})),i.current.observe(e),o())}),[]);Pg.useEffect((()=>{const t=e.responsiveVideoManager.player;function n(){setTimeout(o,300)}return window.addEventListener("resize",o),window.addEventListener("orientationchange",n),t&&t.on("saferesize",o),()=>{window.removeEventListener("resize",NR),window.removeEventListener("orientationchange",n),t&&t.off("saferesize",o)}}),[]),Pg.useEffect((()=>{const t=(e,t)=>n(t),i=()=>n(!1);return e.responsiveVideoManager.on("cropDataChange",t),e.responsiveVideoManager.on("aspectRatioChange",i),()=>{e.responsiveVideoManager.off("cropDataChange",t),e.responsiveVideoManager.off("aspectRatioChange",i)}}),[e.responsiveVideoManager]);let a=["placeholderViewport",e.className,...e.debugMode?["debugMode",t&&"hasCropData"]:[]].join(" ");return React.createElement("div",{className:a,ref:s},e.children)}var DR=function(e){if(e.__initedSafeResizeEvent)return;let t=!1;e.on("seeking",(()=>{t=!0})),e.on("nodestart",(()=>{t=!1})),e.on("resize",((...n)=>{const i=()=>{e.trigger("saferesize",...n)};t?e.once("nodestart",i):i()})),e.__initedSafeResizeEvent=!0};let MR,FR;const BR=`https://${window.eko.env}srv.eko.com/responsive-video`,UR=InterludePlayer.environment.queryParams.debugCrop;function jR(...e){UR&&console.log(...e)}function zR(e,t,n){return`${e}_${t}_${n}`}class VR{constructor(e){if(MR)throw new Error("Responsive Video Manager is a singleton class and can only be instantiated once. Please use ResponsiveVideoManager.getInstance() instead.");if(!e)throw new Error("ResponsiveVideoManager requires an instance player to be passed to its constructor.");DR(e),this.player=e,this.eventEmitter=new nw,["emit","on","once","off"].forEach((e=>{this[e]=this.eventEmitter[e].bind(this.eventEmitter)})),this.aspectRatio="16:9",this.currentCropData=null,this.cropCache={},this.cropDataRequests={},this.isDirty=!0}static getInstance(e,t){return MR||(e&&t||console.error("ResponsiveVideoManager - no player/VFX specified"),FR="function"==typeof t.getInstance?t.getInstance(e):t,MR=new VR(e)),MR}init(e){this.shapeCompositeMaskFilter=FR.createFilter("shapeCompositeMask",{...e.shapeCompositeMask}),this.shapeCompositeMaskFilter.add();let t=function(){this.isDirty&&(this.updateCropRender(),this.isDirty=!1),this.onRAF=window.requestAnimationFrame(t)}.bind(this);this.onRAF=window.requestAnimationFrame(t),this.debouncedUpdate=function(e){this.shapeCompositeMaskFilter.update(e)}}destroy(){this.shapeCompositeMaskFilter.remove(),window.cancelAnimationFrame(this.onRAF)}fetchCropDataFromNode(e){let t=e.segment.ivdUrl;this.getCropData(t.assetId,t.assetRevision,this.aspectRatio).then((t=>{player.currentNode===e&&(this.currentCropData=t,this.isDirty=!0,this.emit("cropDataChange",e,!0))}))}getCropData(e,t,n){let i=zR(e,t,n);return new Promise(((r,o)=>{this.cropCache[i]?r(this.cropCache[i]):i in this.cropDataRequests==0?this.cropDataRequests[i]=fetch(`${BR}/crops/${e}/${t}/${n}`).then((e=>e.json())).then((o=>{delete this.cropDataRequests[i],jR("data",e,t,n,o),o.frames_data?(this.cropCache[i]=o,r(o)):jR("No frame data")})).catch((e=>o(e))):jR(`${i} already exists in cropDataRequests`)}))}changeAspectRatio(e){this.currentCropData=null,this.aspectRatio=e,this.emit("aspectRatioChange",e)}updateCropRender(){if(this.currentCropData&&this.frameDimensions){let e=player.currentNodeTime/player.currentNodeDuration,t=Math.floor(e*(this.currentCropData.frames_data.length-1)),n=this.currentCropData.frames_data[t],i=this.currentCropData.frames_data_format.includes("horizontal");this.onCropUpdate(n.center,i)}}getKeyFromNode(e){let t=e.segment.ivdUrl;return zR(t.assetId,t.assetRevision,this.aspectRatio)}onCropUpdate(e,t){let n,i=this.frameDimensions;if(e!=this.previousCropCenter){let r=2*i.shrinkFrameScaleFactor;n=t?{x:i.centerX-(e-.5)*r,y:i.centerY}:{x:i.centerX,y:i.centerY+(e-.5)*r},this.debouncedUpdate({foreground:{translate:n}}),this.previousCropCenter=e}}onUpdatedDimensions(e,t){this.frameDimensions=e,this.aspectRatio=t,this.isDirty=!0;let n={mask:{center:{x:e.centerX,y:e.centerY},area:{width:e.frameWidth,height:e.frameHeight},type:e.cornerRadius>0&&e.isPadded?"rounded":"box",radius:32/window.innerWidth},foreground:{scale:{x:1.01*e.shrinkFrameScaleFactorX,y:1.01*e.shrinkFrameScaleFactorY}}};this.currentCropData||(n.foreground={...n.foreground,translate:{x:e.centerX,y:e.centerY}}),UR&&e&&(e.isHorizontal?n.mask.area.width=2:n.mask.area.height=2),this.debouncedUpdate(n)}getPlaceholderViewport(){let e=this;return function(t){return Ig.createElement(RR,{responsiveVideoManager:e,debugMode:UR,...t,onUpdatedDimensions:(...n)=>{e.onUpdatedDimensions(...n),"function"==typeof t.onUpdatedDimensions&&t.onUpdatedDimensions(...n)}})}}}const WR=function(){if("undefined"==typeof navigator)return!1;try{if(navigator.userAgentData&&"string"==typeof navigator.userAgentData.platform)return/android/i.test(navigator.userAgentData.platform)}catch(e){}const e=navigator.userAgent||"";return/android/i.test(e)}(),HR=(e=250,t)=>{const[n,i]=Pg.useState(!!WR&&t);return Pg.useEffect((()=>{if(WR){const t=()=>{const t=window.screen.height-e>window.visualViewport.height;n!==t&&i(t)};return window.visualViewport.addEventListener("resize",t),()=>{window.visualViewport.removeEventListener("resize",t)}}}),[]),n};function $R(e){let t=e.aspectRatio?"string"==typeof(n=e.aspectRatio)&&n.indexOf(":")>-1?n.split(":")[0]/n.split(":")[1]:"number"==typeof n?n:void 0:null;var n;let i=HR(),r={targetAR:t||16/9};["minUIWidth","minUIHeight","videoPadding","mainAxis"].forEach((t=>{e[t]&&(r[t]=e[t])}));let{setMasterContainerRef:o,dynamicProperties:s,classes:a}=function(e){e={targetAR:16/9,minUIWidth:300,minUIHeight:250,videoPadding:16,...e};let{windowWidth:t,windowHeight:n}=function(){const[e,t]=Pg.useState({windowWidth:window.innerWidth,windowHeight:window.innerHeight});let n=Pg.useCallback(function(e,n){let i,r=!0;return function(...e){i=e,r&&(r=!1,setTimeout((()=>{r=!0,t({windowWidth:window.innerWidth,windowHeight:window.innerHeight}),i=null}),30))}}(),[]);return Pg.useEffect((()=>(window.addEventListener("resize",n),window.addEventListener("orientationchange",n),n(),()=>{window.removeEventListener("resize",n),window.removeEventListener("orientationchange",n)})),[]),e}();const i=Pg.useRef(null);let[r,o]=Pg.useState([]),[s,a]=Pg.useState({});function l(){if(!i.current.node)return;let t=i.current.node,r=[],s={};s["--targetAR"]=e.targetAR,s["--minUIWidth"]=e.minUIWidth+"px",s["--minUIHeight"]=e.minUIHeight+"px",s["--videoPadding"]=e.videoPadding+"px",s["--windowHeight"]=n+"px";let l,c,u=t.getBoundingClientRect(),d=u.width,h=u.height;if(u.width/u.height>1&&"vertical"!==e.mainAxis||"horizontal"===e.mainAxis){r.push("landscape");let t=u.width-u.height*e.targetAR;t<e.minUIWidth?(r.push("paddedVideo"),d=e.minUIWidth):d=t,l=u.width-d-1*e.videoPadding,c=u.height-2*e.videoPadding}else{r.push("portrait");let t=u.height-u.width/e.targetAR;t<e.minUIHeight?(r.push("paddedVideo"),h=e.minUIHeight):h=t,l=u.width-2*e.videoPadding,c=u.height-h-1*e.videoPadding}l/e.targetAR<c/1?(s["--maxVideoWidth"]=l+"px",s["--maxVideoHeight"]=l*(1/e.targetAR)+"px"):(s["--maxVideoWidth"]=c*e.targetAR+"px",s["--maxVideoHeight"]=c+"px"),o(r),a(s)}return Pg.useEffect((()=>{l()}),[t,n,e.targetAR,e.minUIWidth,e.minUIHeight,e.videoPadding,e.mainAxis]),{setMasterContainerRef:Pg.useCallback((e=>{e&&(i.current={},l()),i.current.node=e}),[]),classes:r,dynamicProperties:s}}(r),l=["masterContainer",...a].join(" "),c={...s,...e.style};return React.createElement("div",{className:l,ref:o,style:c},!i&&React.createElement("div",{className:"videoContainer"},e.videoElement),React.createElement("div",{className:"interface"},React.createElement("form",{className:"interfaceContent",onSubmit:e=>e.preventDefault()},e.interfaceElement,e.navigationElement)),e.cardElement)}function GR(){return GR=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},GR.apply(this,arguments)}function qR(){return qR=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},qR.apply(this,arguments)}function YR(){return YR=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},YR.apply(this,arguments)}function KR(){return KR=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},KR.apply(this,arguments)}function XR(){return XR=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},XR.apply(this,arguments)}function QR(){return QR=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},QR.apply(this,arguments)}function ZR(){return ZR=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},ZR.apply(this,arguments)}function JR(){return JR=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},JR.apply(this,arguments)}By('.masterContainer {\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n  display: flex;\n  flex-direction: column;\n  --windowHeight: 100vh;\n  --videoPadding: 30px;\n}\n\n@media (min-width: 90.0625em) {\n  .masterContainer .eko_subtitles_div span {\n    font-size: 24px;\n  }\n}\n.masterContainer.landscape {\n  flex-direction: row;\n}\n.masterContainer.landscape .videoContainer {\n  height: var(--windowHeight);\n  width: calc(var(--windowHeight) * var(--targetAR));\n}\n.masterContainer.landscape .video {\n  width: 100%;\n  height: 100%;\n}\n.masterContainer.landscape.paddedVideo .videoContainer {\n  width: calc(100% - var(--minUIWidth));\n  padding: var(--videoPadding);\n  padding-right: 0;\n  box-sizing: border-box;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n}\n.masterContainer.landscape.paddedVideo .video {\n  box-sizing: border-box;\n  max-width: var(--maxVideoWidth);\n  max-height: var(--maxVideoHeight);\n}\n\n.masterContainer.portrait {\n  flex-direction: column;\n}\n.masterContainer.portrait .videoContainer {\n  width: 100%;\n  height: calc(100vw / var(--targetAR));\n  display: flex;\n}\n.masterContainer.portrait .video {\n  width: 100%;\n  height: 100%;\n  left: 0;\n  top: 0;\n}\n.masterContainer.portrait.paddedVideo .videoContainer {\n  height: calc(100% - var(--minUIHeight));\n  padding: var(--videoPadding);\n  padding-bottom: 0;\n  box-sizing: border-box;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n}\n.masterContainer.portrait.paddedVideo .video {\n  box-sizing: border-box;\n  aspect-ratio: var(--targetAR);\n  max-width: var(--maxVideoWidth);\n  max-height: var(--maxVideoHeight);\n  height: auto;\n}\n\n.videoContainer {\n  position: relative;\n}\n\n.video {\n  width: 100%;\n  height: 100%;\n  left: 0;\n  top: 0;\n  position: relative;\n  pointer-events: all;\n}\n\n.interface {\n  display: flex;\n  position: relative;\n  height: 100%;\n  flex: 1;\n}\n\n.portrait .interface {\n  overflow-y: hidden;\n}\n.portrait .interfaceContent {\n  justify-content: center;\n}\n\n.interfaceContent {\n  width: 100%;\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  flex: 1;\n  font-family: var(--fontName, "Nunito Sans", "Helvetica Neue", Helvetica, Arial, sans-serif);\n}'),$R.propTypes={minUIWidth:Ov.number,minUIHeight:Ov.number,videoPadding:Ov.number};var eD=({styles:e={},...t})=>Ig.createElement("svg",JR({viewBox:"0 0 16 16",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},t),Ig.createElement("path",{d:"M8 14.4A6.4 6.4 0 108 1.6a6.4 6.4 0 000 12.8zm2.966-7.434l-3.2 3.2a.8.8 0 01-1.132 0l-1.6-1.6a.8.8 0 111.132-1.132L7.2 8.47l2.634-2.635a.8.8 0 011.132 1.132z"}));function tD(){return tD=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},tD.apply(this,arguments)}function nD(){return nD=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},nD.apply(this,arguments)}function iD(){return iD=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},iD.apply(this,arguments)}function rD(){return rD=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},rD.apply(this,arguments)}function oD(){return oD=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},oD.apply(this,arguments)}function sD(){return sD=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},sD.apply(this,arguments)}function aD(){return aD=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},aD.apply(this,arguments)}function lD(){return lD=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},lD.apply(this,arguments)}var cD=({styles:e={},...t})=>Ig.createElement("svg",lD({viewBox:"0 0 16 16",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},t),Ig.createElement("path",{d:"M8.234 12.566a.8.8 0 010-1.132L11.67 8 8.234 4.566a.8.8 0 111.132-1.132l4 4a.8.8 0 010 1.132l-4 4a.8.8 0 01-1.132 0z"}),Ig.createElement("path",{d:"M3.434 12.566a.8.8 0 010-1.132L6.87 8 3.434 4.566a.8.8 0 111.132-1.132l4 4a.8.8 0 010 1.132l-4 4a.8.8 0 01-1.132 0z"}));function uD(){return uD=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},uD.apply(this,arguments)}function dD(){return dD=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},dD.apply(this,arguments)}function hD(){return hD=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},hD.apply(this,arguments)}function pD(){return pD=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},pD.apply(this,arguments)}function fD(e){return e?e.split(/\*\*(.*?)\*\*/g).map(((e,t)=>t%2==1?Ig.createElement("em",{key:t},e):e)):e}By(".eko-button {\n  position: relative;\n  font-weight: 700;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  max-height: 2.8em;\n  font-family: var(--fontName);\n  padding: 11px 16px;\n  color: var(--primaryColor);\n  background-color: var(--secondaryColor);\n  border: 2px solid var(--secondaryColor);\n}\n.eko-button .label {\n  overflow: hidden;\n  line-height: 125%;\n  text-overflow: ellipsis;\n  display: -webkit-box;\n  -webkit-line-clamp: 2;\n  -webkit-box-orient: vertical;\n}\n.eko-button .icon {\n  width: 22px;\n  height: 22px;\n}\n.eko-button .checkmark {\n  position: absolute;\n  width: 24px;\n  height: 24px;\n  top: -9px;\n  right: -9px;\n  background-color: var(--secondaryColor);\n  border-radius: 11px;\n  color: var(--primaryColor);\n}\n\n.eko-button--pill {\n  border-radius: 3em;\n}\n\n.eko-button--rounded {\n  border-radius: 8px;\n}\n\n.eko-button--square {\n  border-radius: 0px;\n}\n\n.eko-button--icon .label:empty {\n  display: none;\n}\n\n.eko-button--icon--left .label {\n  margin-left: 4px;\n}\n\n.eko-button--icon--right .label {\n  margin-right: 4px;\n}\n.eko-button--icon--right .icon {\n  order: 10;\n}\n\n.eko-button--icon--only {\n  padding: 8px;\n}\n\n.eko-button--primary {\n  color: var(--secondaryColor);\n  background-color: var(--primaryColor);\n  border: 2px solid var(--secondaryColor);\n}\n\n.eko-button--secondary {\n  color: var(--primaryColor);\n  background-color: transparent;\n  border: 2px solid var(--primaryColor);\n}\n\n.eko-button--helper {\n  background-color: rgba(255, 255, 255, 0.2);\n  color: var(--secondaryColor);\n  border: 2px solid transparent;\n}\n.eko-button--helper.eko-button--selected {\n  border-color: var(--secondaryColor);\n}\n\n.eko-button--disabled {\n  opacity: 0.3;\n  cursor: default;\n}");const gD={arrowLeft:({styles:e={},...t})=>Ig.createElement("svg",GR({viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},t),Ig.createElement("path",{d:"M2.419 11.282a1.34 1.34 0 000 1.947l7.143 6.875a1.47 1.47 0 002.022 0 1.34 1.34 0 000-1.947l-4.71-4.529h13.697c.79 0 1.429-.614 1.429-1.375 0-.76-.638-1.375-1.429-1.375H6.88l4.7-4.529a1.34 1.34 0 000-1.946 1.47 1.47 0 00-2.022 0l-7.143 6.875.005.004z"})),arrowRight:({styles:e={},...t})=>Ig.createElement("svg",qR({viewBox:"0 0 16 16",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},t),Ig.createElement("path",{d:"M8.234 2.634a.8.8 0 011.132 0l4.8 4.8a.8.8 0 010 1.132l-4.8 4.8a.8.8 0 01-1.132-1.132L11.67 8.8H2.4a.8.8 0 110-1.6h9.269L8.234 3.766a.8.8 0 010-1.132z"})),arrowExpandFilled:({styles:e={},...t})=>Ig.createElement("svg",oD({viewBox:"0 0 16 16",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},t),Ig.createElement("path",{d:"M5.112 9.949a.667.667 0 11.943.942L4.277 12.67h1.056c.342 0 .624.258.663.59l.004.077a.667.667 0 01-.667.667H2.667A.667.667 0 012 13.336V10.67a.667.667 0 111.333 0v1.058l1.78-1.778zm5.558 4.054a.667.667 0 010-1.334h1.055l-1.777-1.778a.667.667 0 01-.055-.88l.056-.063c.26-.26.682-.26.943 0l1.778 1.78V10.67c0-.341.257-.623.589-.662l.078-.004c.368 0 .666.298.666.666v2.667a.667.667 0 01-.666.667H10.67zM5.333 2a.667.667 0 010 1.333H4.278l1.777 1.78c.24.24.258.618.055.88l-.055.062a.667.667 0 01-.943 0l-1.779-1.78v1.058a.667.667 0 01-.589.663L2.667 6A.667.667 0 012 5.333V2.667C2 2.298 2.298 2 2.667 2h2.666zm8.004 0c.368 0 .666.298.666.667v2.666a.667.667 0 11-1.333 0V4.275l-1.778 1.78a.667.667 0 01-.88.055l-.063-.055a.667.667 0 010-.943l1.777-1.779H10.67a.667.667 0 01-.662-.589l-.005-.077c0-.369.299-.667.667-.667h2.667z"})),arrowCircleRight:({styles:e={},...t})=>Ig.createElement("svg",nD({viewBox:"0 0 16 16",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},t),Ig.createElement("path",{d:"M8 2.625a5.375 5.375 0 100 10.75 5.375 5.375 0 000-10.75zM1.375 8a6.625 6.625 0 1113.25 0 6.625 6.625 0 01-13.25 0zm6.85-2.442a.625.625 0 01.884 0l2 2a.625.625 0 010 .884l-2 2a.625.625 0 11-.884-.884l.933-.933H5.333a.625.625 0 010-1.25h3.825l-.933-.933a.625.625 0 010-.884z"})),arrowCircleLeft:({styles:e={},...t})=>Ig.createElement("svg",iD({viewBox:"0 0 16 16",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},t),Ig.createElement("path",{d:"M8 2.625a5.375 5.375 0 100 10.75 5.375 5.375 0 000-10.75zM1.375 8a6.625 6.625 0 1113.25 0 6.625 6.625 0 01-13.25 0zm6.4-2.442a.625.625 0 010 .884l-.933.933h3.825a.625.625 0 010 1.25H6.842l.933.933a.625.625 0 11-.884.884l-2-2a.625.625 0 010-.884l2-2a.625.625 0 01.884 0z"})),volumeUp:({styles:e={},...t})=>Ig.createElement("svg",YR({viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},t),Ig.createElement("path",{d:"M13.177 3.29c.465.21.764.67.764 1.18V20a1.296 1.296 0 01-2.155.966L6.33 16.117H3.588A2.59 2.59 0 011 13.53V10.94a2.59 2.59 0 012.588-2.589H6.33l5.456-4.848c.38-.34.926-.421 1.39-.215zm6.956 2.92A7.759 7.759 0 0123 12.234c0 2.43-1.12 4.602-2.867 6.026a.97.97 0 11-1.226-1.509 5.802 5.802 0 002.152-4.517c0-1.824-.837-3.45-2.152-4.522a.974.974 0 01-.141-1.366.974.974 0 011.367-.142v.004zm-2.447 3.012a3.887 3.887 0 010 6.026.97.97 0 11-1.225-1.509c.436-.356.716-.898.716-1.504a1.95 1.95 0 00-.716-1.509.974.974 0 01-.142-1.367.974.974 0 011.367-.141v.004z"})),volumeOff:({styles:e={},...t})=>Ig.createElement("svg",KR({viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},t),Ig.createElement("path",{d:"M17.234 8.6l2.1 2.101 2.102-2.1a.917.917 0 011.295 1.295l-2.101 2.1 2.1 2.101a.916.916 0 01-1.295 1.295l-2.1-2.1-2.101 2.1a.916.916 0 01-1.295-1.295l2.101-2.1-2.1-2.102A.916.916 0 0117.234 8.6zM13.941 4.47a1.296 1.296 0 00-2.155-.966L6.33 8.352H3.588A2.59 2.59 0 001 10.941v2.588a2.59 2.59 0 002.588 2.588H6.33l5.456 4.85A1.296 1.296 0 0013.94 20V4.47z"})),play:({styles:e={},...t})=>Ig.createElement("svg",XR({viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},t),Ig.createElement("path",{d:"M8.232 2.301l12.75 7.857c.62.402 1.018 1.116 1.018 1.83 0 .76-.398 1.473-1.018 1.83l-12.75 7.857c-.664.402-1.505.447-2.17.045C5.399 21.363 5 20.65 5 19.845V4.132c0-.76.398-1.474 1.063-1.83a2.103 2.103 0 012.169 0z"})),pause:({styles:e={},...t})=>Ig.createElement("svg",QR({viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},t),Ig.createElement("path",{d:"M6.25 3h1.5C8.969 3 10 4.031 10 5.25v13.5A2.25 2.25 0 017.75 21h-1.5A2.221 2.221 0 014 18.75V5.25A2.25 2.25 0 016.25 3zm10 0h1.5C18.969 3 20 4.031 20 5.25v13.5A2.25 2.25 0 0117.75 21h-1.5A2.221 2.221 0 0114 18.75V5.25A2.25 2.25 0 0116.25 3z"})),home:({styles:e={},...t})=>Ig.createElement("svg",ZR({viewBox:"0 0 16 16",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},t),Ig.createElement("path",{d:"M7.558 1.558a.625.625 0 01.884 0l6 6a.625.625 0 11-.884.884l-.266-.266v5.157c0 .714-.579 1.292-1.292 1.292H4a1.292 1.292 0 01-1.292-1.292V8.176l-.266.266a.625.625 0 11-.884-.884l6-6zm-3.6 5.368v6.407c0 .023.019.042.042.042h2a.042.042 0 00.042-.042v-2.666c0-.714.578-1.292 1.291-1.292h1.334c.713 0 1.291.578 1.291 1.292v2.666c0 .023.019.042.042.042h2a.042.042 0 00.042-.042V6.926L8 2.884 3.958 6.926zm4.751 6.449V10.667a.042.042 0 00-.042-.042H7.333a.042.042 0 00-.041.042v2.666l-.001.042h1.418z"})),startOver:({styles:e={},...t})=>Ig.createElement("svg",rD({viewBox:"0 0 16 16",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},t),Ig.createElement("path",{d:"M3.399 2.662v2.296c0 .359.29.65.649.65h2.296a.65.65 0 100-1.3H5.81a4.548 4.548 0 015.546 7.118 4.546 4.546 0 01-7.678-4.079.65.65 0 10-1.275-.246 5.845 5.845 0 102.295-3.613v-.826a.65.65 0 10-1.3 0z"})),info:({styles:e={},...t})=>Ig.createElement("svg",tD({viewBox:"0 0 16 16",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},t),Ig.createElement("path",{d:"M8 2.625a5.375 5.375 0 100 10.75 5.375 5.375 0 000-10.75zM1.375 8a6.625 6.625 0 1113.25 0 6.625 6.625 0 01-13.25 0zm6-2.667c0-.345.28-.625.625-.625h.007a.625.625 0 010 1.25H8a.625.625 0 01-.625-.625zM6.708 8c0 .345.28.625.625.625h.042v2.042c0 .345.28.625.625.625h.667a.625.625 0 000-1.25h-.042V8A.625.625 0 008 7.375h-.667A.625.625 0 006.708 8z"})),chevronLeft:({styles:e={},...t})=>Ig.createElement("svg",sD({viewBox:"0 0 16 16",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},t),Ig.createElement("path",{d:"M10.442 2.891a.625.625 0 010 .884L6.217 8l4.225 4.225a.625.625 0 11-.884.884L4.891 8.442a.625.625 0 010-.884l4.667-4.667a.625.625 0 01.884 0z"})),chevronRight:({styles:e={},...t})=>Ig.createElement("svg",aD({viewBox:"0 0 16 16",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},t),Ig.createElement("path",{d:"M5.558 13.109a.625.625 0 010-.884L9.783 8 5.558 3.775a.625.625 0 01.884-.884l4.667 4.667a.625.625 0 010 .884l-4.667 4.667a.625.625 0 01-.884 0z"})),chevronDoubleRight:cD,openFilled:({styles:e={},...t})=>Ig.createElement("svg",uD({viewBox:"0 0 16 16",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},t),Ig.createElement("path",{d:"M8 2.75A.75.75 0 018.75 2h4.5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0V4.56L8.28 8.78a.75.75 0 01-1.06-1.06l4.22-4.22H8.75A.75.75 0 018 2.75z"}),Ig.createElement("path",{d:"M2 6.25A3.25 3.25 0 015.25 3h1a.75.75 0 010 1.5h-1A1.75 1.75 0 003.5 6.25v4.5c0 .966.784 1.75 1.75 1.75h4.5a1.75 1.75 0 001.75-1.75v-1a.75.75 0 011.5 0v1A3.25 3.25 0 019.75 14h-4.5A3.25 3.25 0 012 10.75v-4.5z"})),twReplyFilled:({styles:e={},...t})=>Ig.createElement("svg",dD({viewBox:"0 0 16 16",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},t),Ig.createElement("path",{d:"M6.166 2.634a.8.8 0 010 1.132L4.33 5.6h4.47a5.6 5.6 0 015.6 5.6v1.6a.8.8 0 11-1.6 0v-1.6a4 4 0 00-4-4H4.33l1.835 1.834a.8.8 0 11-1.132 1.132l-3.2-3.2a.8.8 0 010-1.132l3.2-3.2a.8.8 0 011.132 0z"})),ccOff:({styles:e={},...t})=>Ig.createElement("svg",hD({viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},t),Ig.createElement("path",{d:"M20.556 4.929c.336 0 .61.289.61.642V18.43c0 .353-.274.642-.61.642H3.444c-.336 0-.61-.289-.61-.642V5.57c0-.353.274-.642.61-.642h17.112zM3.444 3C2.096 3 1 4.153 1 5.571V18.43C1 19.847 2.096 21 3.444 21h17.112C21.904 21 23 19.847 23 18.429V5.57C23 4.153 21.904 3 20.556 3H3.444zm5.195 7.071c.542 0 1.031.245 1.367.643a.886.886 0 001.295.077 1 1 0 00.073-1.362 3.58 3.58 0 00-2.731-1.286C6.618 8.143 4.976 9.87 4.976 12c0 2.13 1.642 3.857 3.667 3.857a3.58 3.58 0 002.73-1.286 1 1 0 00-.072-1.362.883.883 0 00-1.295.077 1.784 1.784 0 01-1.367.643c-1.012 0-1.833-.864-1.833-1.929s.82-1.929 1.833-1.929zm5.5 1.929c0-1.065.821-1.929 1.833-1.929.543 0 1.031.245 1.368.643a.886.886 0 001.294.077 1 1 0 00.073-1.362 3.58 3.58 0 00-2.731-1.286c-2.024 0-3.667 1.728-3.667 3.857 0 2.13 1.643 3.857 3.667 3.857a3.58 3.58 0 002.73-1.286 1 1 0 00-.072-1.362.883.883 0 00-1.294.077 1.783 1.783 0 01-1.368.643c-1.012 0-1.833-.864-1.833-1.929z"})),ccOn:({styles:e={},...t})=>Ig.createElement("svg",pD({viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},t),Ig.createElement("path",{d:"M1 5.571C1 4.153 2.096 3 3.444 3h17.112C21.904 3 23 4.153 23 5.571V18.43C23 19.847 21.904 21 20.556 21H3.444C2.096 21 1 19.847 1 18.429V5.57zm7.639 4.5c.542 0 1.031.245 1.367.643a.886.886 0 001.295.077 1 1 0 00.073-1.362 3.58 3.58 0 00-2.731-1.286C6.618 8.143 4.976 9.87 4.976 12c0 2.13 1.642 3.857 3.667 3.857a3.58 3.58 0 002.73-1.286 1 1 0 00-.072-1.362.883.883 0 00-1.295.077 1.784 1.784 0 01-1.367.643c-1.012 0-1.833-.864-1.833-1.929s.82-1.929 1.833-1.929zm5.5 1.929c0-1.065.821-1.929 1.833-1.929.543 0 1.031.245 1.368.643a.886.886 0 001.294.077 1 1 0 00.073-1.362 3.58 3.58 0 00-2.731-1.286c-2.024 0-3.667 1.728-3.667 3.857 0 2.13 1.643 3.857 3.667 3.857a3.58 3.58 0 002.73-1.286 1 1 0 00-.072-1.362.883.883 0 00-1.294.077 1.783 1.783 0 01-1.368.643c-1.012 0-1.833-.864-1.833-1.929z"}))},mD={primary:"eko-button--primary",secondary:"eko-button--secondary",helper:"eko-button--helper"},yD=e=>{let t={"--secondaryColor":e.secondaryColor||yD.defaultProps.secondaryColor,"--primaryColor":e.primaryColor||yD.defaultProps.primaryColor,...e.styleOverride},n=e.icon&&"none"!==e.icon,i=e.selected,r="showLabel"in e?e.showLabel:yD.defaultProps.showLabel,o=["eko-button",`eko-button--${e.shape}`,e.icon?"eko-button--icon":"",e.icon?`eko-button--icon--${e.icon&&(e.iconPosition||yD.defaultProps.iconPosition)}`:"",e.icon&&!r?"eko-button--icon--only":"",e.disabled?"eko-button--disabled":"",mD[e.type],e.selected?"eko-button--selected":"",e.className];o=o.filter((e=>!!e));let s=n&&gD[e.icon],a=i?Ig.createElement(eD,{className:"checkmark"}):null,l=e.selected?{"aria-selected":!0}:{};const c=fD(e.label);return Ig.createElement("button",Ja({type:e.type,className:o.join(" "),style:t,onClick:e.onClick,disabled:e.disabled,"aria-label":e.ariaLabel||e.label,"aria-hidden":e.ariaHidden},l),n&&Ig.createElement(s,{className:"icon",key:"button-icon"}),Ig.createElement("span",{className:"label",key:"button-text"},r?c:null),a)};function vD(e){let t;if(e){let n=function(e){let t=1,n=e.tagName;for(;e.previousSibling;)1===(e=e.previousSibling).nodeType&&n.toLowerCase()===e.tagName.toLowerCase()&&t++;return t}(e),i=e.getAttribute("class"),r=[...e.classList].join(".");for(;e.tagName;)t=e.localName+(t?">"+t:""),e=e.parentNode;return i?t=t+"."+r:t+=`:nth-of-type(${n})`,t}throw"not an dom reference"}function bD(e){return function(t){let n=e.ui.useSelector((e=>"subtitles"in e&&Object.keys(e.subtitles.availableLanguages).length>0)),i=e.ui.useSelector((e=>"subtitles"in e&&e.subtitles.visible?"ccOn":"ccOff"));return n&&React.createElement(yD,{className:"subtitles-button",icon:i,onClick:t=>{e.ekoshell.SubtitlesButton.activateSubtitles({anchorQuerySelector:vD(t.currentTarget),anchorDirection:"bottom",anchorOffsetY:8}),t.stopPropagation()},label:"Subtitles",showLabel:!1,shape:t.shape,primaryColor:t.primaryColor||"#000000",secondaryColor:t.secondaryColor||"#FFFFFF"})}}yD.propTypes={primaryColor:Ov.string,secondaryColor:Ov.string,shape:Ov.oneOf(["pill","rounded","square"]),label:Ov.string,icon:Ov.oneOf(["none",...Object.keys(gD)]),iconPosition:Ov.oneOf(["left","right"]),onClick:Ov.func,className:Ov.string,disabled:Ov.bool,selected:Ov.bool,learnProps:Ov.object,type:Ov.string},yD.defaultProps={primaryColor:"#001780",secondaryColor:"#ffffff",shape:"pill",onClick:void 0,iconPosition:"left",disabled:!1,selected:!1,type:"button",showLabel:!0},By(".eko-videoOverlay {\n  position: absolute;\n  height: 100%;\n  width: 100%;\n  transition: background-color 0.11s ease-in;\n}\n.eko-videoOverlay.no-click {\n  pointer-events: none;\n}\n.eko-videoOverlay .buttonContainerTop {\n  position: absolute;\n  top: 10px;\n  right: 9px;\n}\n.eko-videoOverlay .buttonContainerTop .eko-button {\n  pointer-events: auto;\n  max-height: initial;\n  width: 42px;\n  height: 42px;\n}\n.eko-videoOverlay .buttonContainerMiddle {\n  display: none;\n  position: absolute;\n  width: 100%;\n  top: 50%;\n  transform: translateY(-50%);\n  justify-content: center;\n}\n.eko-videoOverlay .buttonContainerMiddle .eko-button {\n  pointer-events: auto;\n  max-height: initial;\n  width: 42px;\n  height: 42px;\n}\n.eko-videoOverlay .buttonContainerMiddle .eko-button .icon {\n  width: 22px;\n  height: 22px;\n}\n.eko-videoOverlay.paused {\n  background: rgba(0, 0, 0, 0.5);\n}\n.eko-videoOverlay.paused .buttonContainerMiddle {\n  display: flex;\n}\n\n.paddedVideo .eko-videoOverlay {\n  border-radius: 8px;\n}");const wD=function(e){let t=e.buttonShape||"rounded",n=void 0===e.showMuteButton||e.showMuteButton?React.createElement(yD,{icon:e.isMuted?"volumeOff":"volumeUp",onClick:e.toggleMute,shape:t,label:"Mute",showLabel:!1,primaryColor:e.primaryColor||"#000000",secondaryColor:e.secondaryColor||"#FFFFFF"}):null,i=e.ConnectedSubtitlesButton&&React.createElement(e.ConnectedSubtitlesButton,{shape:t,label:"Subtitles",showLabel:!1,primaryColor:e.primaryColor||"#000000",secondaryColor:e.secondaryColor||"#FFFFFF"}),r=React.createElement(yD,{icon:"play",shape:t,label:"play",showLabel:!1,primaryColor:e.primaryColor||"#000000",secondaryColor:e.secondaryColor||"#FFFFFF"});return React.createElement("div",{className:["eko-videoOverlay",e.isPaused?"paused":"",e.onClickBackground?"":"no-click"].join(" "),onClick:e.onClickBackground},e.showTopBar&&React.createElement("div",{className:"buttonContainerTop"},i,n),React.createElement("div",{className:"buttonContainerMiddle"},r))};function kD(e){let t=e.player;const n=e.showMuteButton;let i=e.showTopBar,r=JA.get();const o=t.ui.useSelector((e=>e.player.muted||e.player.isAudioLocked)),s=t.ui.useSelector((e=>e.player.isPaused)),a=r.primaryColor||"#501CEB",l=r.secondaryColor||"#FFFFFF";let c=Object.prototype.hasOwnProperty.call(e,"onClickBackground")?e.onClickBackground:t.ekoshell.ControlsOverlay.togglePlayPause;return React.createElement(wD,{toggleMute:e=>{t.ekoshell.VolumeButton.toggleMute(),e.stopPropagation()},isMuted:o,isPaused:s,onClickBackground:c,primaryColor:a,secondaryColor:l,buttonShape:r.buttonShape,showTopBar:i,showMuteButton:n,ConnectedSubtitlesButton:bD(t)})}function xD(e){const t=Pg.useRef(null);e={rules:{},...e};const n=Pg.useCallback((n=>{t.current&&(t.current.resizeObserver.disconnect(),t.current.resizeObserver=null),n&&(t.current={},t.current.resizeObserver=new ResizeObserver((()=>function(e,t){let n=e.getBoundingClientRect();Object.keys(t.rules).forEach((i=>{let r;r=Array.isArray(t.rules[i][0])?t.rules[i]:[t.rules[i]],r.every((e=>function(e,t,n,i){switch(t){case">":return i[e]>n;case">=":return i[e]>=n;case"<":return i[e]<n;case"<=":return i[e]<=n;case"==":return i[e]==n}}(e[0],e[1],e[2],n)))?e.classList.add(i):e.classList.remove(i)}))}(n,e))),t.current.resizeObserver.observe(n)),t.current.node=n}),[]);return n}wD.propTypes={isMuted:Ov.bool,isPaused:Ov.bool,onClickBackground:Ov.func,onClickMuteButton:Ov.func,primaryColor:Ov.string,secondaryColor:Ov.string,buttonShape:Ov.string,showTopBar:Ov.bool,showMuteButton:Ov.bool},wD.defaultProps={showTopBar:!0,showMuteButton:!0},By(".bp-vertical-small {\n  --gizmoPadding: 16px;\n  --navigationHeight: 5.2em;\n  font-size: 12px;\n  line-height: 14px;\n}\n\n.bp-vertical-medium {\n  --gizmoPadding: 24px;\n  --navigationHeight: 5.2em;\n  font-size: 16px;\n  line-height: 17px;\n}\n\n.eko-menu {\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  padding: 0px 3px 1px;\n  padding-bottom: 0;\n  color: white;\n  box-sizing: border-box;\n  text-align: center;\n  justify-content: center;\n  align-items: center;\n  overflow: hidden;\n  --helperWidth: 48px;\n}\n.eko-menu .logo {\n  align-self: center;\n  object-fit: contain;\n  max-height: 88px;\n  width: 100%;\n}\n.eko-menu .eko-menu-title {\n  color: var(--secondaryColor, white);\n  font-size: 24px;\n  font-weight: 700;\n  line-height: 125%;\n  margin: 20px 0 12px 0;\n}\n.eko-menu .eko-text-element {\n  color: var(--secondaryColor, white);\n  font-size: 16px;\n  font-weight: 400;\n  line-height: 150%;\n  margin: 0 0 20px 0;\n}\n.eko-menu ul {\n  list-style-type: none;\n  padding: 0;\n  display: grid;\n  margin: 0;\n  width: 100%;\n}\n.eko-menu ul li > * {\n  width: 100%;\n  height: 100%;\n}\n.eko-menu ul .button-helper-container {\n  display: flex;\n}\n.eko-menu ul .button-helper-container .option-button {\n  width: 100%;\n}\n.eko-menu .eko-menu-scrollbar {\n  --scrollBarHorizontalPadding: 9px;\n}\n.eko-menu.bp-vertical-small .logo {\n  max-width: 50%;\n  margin-bottom: var(--gizmoPadding);\n}\n.eko-menu.bp-vertical-small .eko-menu-title {\n  font-size: 20px;\n  margin-bottom: 8px;\n  margin-top: 8px;\n}\n.eko-menu.bp-vertical-small .eko-text-element {\n  font-size: 14px;\n  margin-bottom: 12px;\n}\n.eko-menu.bp-vertical-small ul {\n  grid-gap: 8px;\n  margin-bottom: 4px;\n}\n.eko-menu.bp-vertical-small li:only-child {\n  grid-column: span 2;\n}\n.eko-menu.bp-vertical-small .eko-button {\n  font-size: 12px;\n  line-height: 14px;\n  padding: 11px;\n}\n.eko-menu.bp-vertical-small .eko-imageButton {\n  font-size: 12px;\n  line-height: 14px;\n}\n.eko-menu.bp-vertical-small.eko-menu-with-helpers ul {\n  grid-template-columns: initial;\n}\n.eko-menu.bp-vertical-medium ul {\n  grid-template-columns: 1fr;\n  grid-gap: 16px;\n}\n.eko-menu.bp-vertical-medium .eko-button {\n  font-size: 16px;\n  line-height: 17px;\n}\n.eko-menu.bp-vertical-medium .eko-imageButton {\n  font-size: 16px;\n  line-height: 20px;\n}\n\n.eko-menu-with-helpers .eko-menu-scrollbar ul .button-helper-container .option-button {\n  width: calc(100% - var(--helperWidth));\n  margin-right: 8px;\n}\n.eko-menu-with-helpers .eko-menu-scrollbar ul .button-helper-container .option-helper {\n  width: var(--helperWidth);\n}\n.eko-menu-with-helpers .eko-menu-scrollbar ul .button-helper-container .option-helper button {\n  width: 100%;\n  height: 100%;\n}\n\n.eko-menu-layout-vertical.bp-vertical-small ul {\n  grid-template-columns: 1fr;\n  grid-gap: 16px;\n}\n\n.eko-menu-layout-horizontal.bp-vertical-medium ul {\n  grid-template-columns: repeat(2, 1fr);\n  grid-gap: 8px;\n}"),By(".eko-imageButton {\n  position: relative;\n  font-weight: 700;\n  border: 2px solid transparent;\n  cursor: pointer;\n  display: flex;\n  flex-grow: 1;\n  align-items: center;\n  align-self: stretch;\n  min-height: 60px;\n  max-height: 2.8em;\n  font-family: var(--fontName);\n  font-size: 16px;\n  line-height: 20px;\n  padding: 11px 8px 11px 6px;\n  text-align: left;\n  color: var(--primaryColor);\n  background-color: var(--backgroundColor);\n  border-radius: 8px;\n}\n.eko-imageButton .label {\n  overflow: hidden;\n  text-overflow: ellipsis;\n  display: -webkit-box;\n  -webkit-line-clamp: 3;\n  -webkit-box-orient: vertical;\n}\n.eko-imageButton img {\n  height: 44px;\n  width: 64px;\n  object-fit: cover;\n  margin-right: 8px;\n  flex-shrink: 0;\n}\n.eko-imageButton .checkmark {\n  position: absolute;\n  width: 22px;\n  height: 22px;\n  top: -9px;\n  right: -9px;\n  background: radial-gradient(circle, rgba(var(--primaryColorRGB), 1) 0%, rgba(var(--primaryColorRGB), 1) 50%, rgba(var(--primaryColorRGB), 0) 50%, rgba(var(--primaryColorRGB), 0) 100%);\n}\n.eko-imageButton .checkmark svg {\n  width: 100%;\n  height: 100%;\n}\n\n.eko-eko-imageButton--pill {\n  border-radius: 3em;\n}\n.eko-eko-imageButton--pill img {\n  border-radius: 3em;\n}\n\n.eko-eko-imageButton--rounded {\n  border-radius: 8px;\n}\n.eko-eko-imageButton--rounded img {\n  border-radius: 4px;\n}\n\n.eko-imageButton--square {\n  border-radius: 0px;\n}\n\n.eko-imageButton-selected {\n  color: var(--backgroundColor);\n  background-color: var(--primaryColor);\n  border-color: var(--backgroundColor);\n}\n\n.eko-imageButton-disabled {\n  opacity: 0.3;\n  cursor: default;\n}");const SD=e=>{let t=e.primaryColor||SD.defaultProps.primaryColor,n={"--backgroundColor":e.secondaryColor||SD.defaultProps.secondaryColor,"--textColor":e.primaryColor||SD.defaultProps.primaryColor};var i;t&&(n["--primaryColor"]=t,n["--primaryColorRGB"]=(i=t,`${parseInt(i.slice(1,3),16)}, ${parseInt(i.slice(3,5),16)}, ${parseInt(i.slice(5,7),16)}`));let r=["eko-imageButton",`eko-imageButton--${e.shape}`,e.label?"":"eko-imageButton--withoutLabel",e.selected&&"eko-imageButton-selected",e.disabled&&"eko-imageButton-disabled",e.className?e.className:""],o=e.src&&Ig.createElement("img",{src:e.src,alt:e.label}),s=e.selected?Ig.createElement("div",{className:"checkmark"},Ig.createElement(eD,null)):null;return Ig.createElement("button",{type:"button",className:r.join(" "),style:n,onClick:e.onClick,disabled:e.disabled},o,e.label&&Ig.createElement("span",{className:"label"},e.label),s)};SD.propTypes={src:Ov.string,primaryColor:Ov.string,secondaryColor:Ov.string,label:Ov.string,onClick:Ov.func,className:Ov.string,disabled:Ov.bool,selected:Ov.bool},SD.defaultProps={src:"",primaryColor:"#001780",secondaryColor:"white",onClick:void 0,disabled:!1,selected:!1},By(".eko-text-element p {\n  margin: 0;\n}\n.eko-text-element p:empty {\n  margin-bottom: 1em;\n}");const CD=e=>{var t;let n=null===(t=e.text)||void 0===t?void 0:t.split("\n").map(((e,t)=>Ig.createElement("p",{key:t},e)));return Ig.createElement("div",{className:`eko-text-element ${e.className?e.className:""}`,style:e.style},n)};CD.propTypes={text:Ov.string};var _D={"bp-vertical-small":["height","<",320],"bp-vertical-medium":["height",">=",320],"bp-horizontal-small":["width","<",372],"bp-horizontal-medium":["width",">=",372]};By(".scroller {\n  display: flex;\n  width: 100%;\n  overflow-y: auto;\n  align-items: start;\n  justify-content: center;\n}\n.scroller .ekoScrollableContainer {\n  --scrollBarHorizontalPadding: 6px;\n  width: 100%;\n  max-width: 320px;\n  position: relative;\n  overflow-y: hidden;\n  overflow-x: hidden;\n  padding: var(--gizmoPadding) 7px var(--gizmoPadding);\n}\n.scroller .ekoScrollableContainer.hasScrollbar {\n  padding-right: var(--scrollBarHorizontalPadding);\n}\n.scroller {\n  /* Let's get this party started */\n}\n.scroller::-webkit-scrollbar {\n  -webkit-appearance: none;\n  position: absolute;\n  width: 3px;\n}\n.scroller {\n  /* Handle */\n}\n.scroller::-webkit-scrollbar-thumb {\n  border: solid 14px transparent;\n  border-radius: 14px;\n  background: var(--thumbColor);\n}\n.scroller::-webkit-scrollbar-thumb:window-inactive {\n  background: rgba(255, 255, 255, 0.6);\n}\n\n.full-screen-layout .ekoScrollableContainer {\n  max-width: 100%;\n  padding: 56px 12px 40px;\n}");const ED=e=>{let{setHasScrollbarRef:t,hasScrollbar:n}=function(){const e=Pg.useRef(null);let[t,n]=Pg.useState(!1);return{setHasScrollbarRef:Pg.useCallback((t=>{e.current&&(e.current.resizeObserver.disconnect(),e.current.resizeObserver=null),t&&(e.current={},e.current.resizeObserver=new ResizeObserver((()=>n(t.scrollHeight>t.clientHeight))),e.current.resizeObserver.observe(t)),e.current.node=t}),[]),hasScrollbar:t}}(),i={"--thumbColor":e.color?`${e.color}e0`:"#ffffff88","--trackColor":e.color?`${e.color}20`:"#ffffff20"},r=["scroller",e.className,n?"hasScrollbar":null].join(" ");return React.createElement("div",{className:r,style:i,ref:t},React.createElement("div",{className:"ekoScrollableContainer"},e.children))},TD=e=>{let t=xD({rules:{..._D,"bp-vertical-small":["height","<",400],"bp-vertical-medium":["height",">=",400]}}),n=e.buttons.reduce(((e,t)=>e||!!t.helper),!1),i=e.buttons.map(((t,n)=>((e,t,n)=>{let{type:i,text:r,onClick:o,disabled:s,selected:a,src:l,primaryColor:c,secondaryColor:u,icon:d,iconPosition:h,helper:p}=t;return Ig.createElement("li",{key:n},Ig.createElement("div",{className:"button-helper-container"},Ig.createElement("image"===i?SD:yD,{label:r,primaryColor:c||e.primaryColor,secondaryColor:u||e.secondaryColor,shape:e.buttonShape,icon:d,iconPosition:h,disabled:s,selected:a,onClick:o,src:l,type:i,className:"option-button"}),Ig.createElement("div",{className:"option-helper"},p&&Ig.createElement(yD,{primaryColor:c||e.primaryColor,secondaryColor:u||e.secondaryColor,shape:e.buttonShape,selected:p.selected,onClick:p.onClick,icon:p.icon,type:"helper",label:"Helper",showLabel:!1}))))})(e,t,n)));return Ig.createElement("div",{className:`eko-menu${n?" eko-menu-with-helpers":""}${e.forceLayout?` eko-menu-layout-${e.forceLayout}`:""}`,ref:t},Ig.createElement(ED,{className:"eko-menu-scrollbar",color:e.secondaryColor},e.logo&&Ig.createElement("img",{className:"logo",src:e.logo,alt:"logo"}),e.title&&Ig.createElement("p",{className:"eko-menu-title"},e.title),e.description&&Ig.createElement(CD,{text:e.description}),Ig.createElement("ul",null,i)))};function PD(e){let t=e.theme;const n="Expand & Play";let i=[{text:n,icon:"arrowExpandFilled",iconPosition:"right",onClick:()=>{TA.trackInteraction({elementid:"expand-and-play",elementtype:TA.elementTypes.OPEN_IN_NEW_WINDOW,elementname:n}),e.player.urls.open(window.location.href)},primaryColor:t.primaryColor,secondaryColor:t.secondaryColor}];return React.createElement($R,{videoElement:React.createElement(e.PlaceholderViewport,{className:"video",cornerRadius:e.cornerRadius},React.createElement(kD,{player:e.player,showTopBar:!1})),aspectRatio:e.ar,interfaceElement:React.createElement(TD,{buttons:i,buttonShape:t.buttonShape,primaryColor:t.backgroundColor,secondaryColor:t.buttonColor}),style:e.style,videoPadding:3,minUIHeight:150,mainAxis:"vertical"})}const ID=300,AD=370,OD=new URLSearchParams(window.location.search).get("overrideAR");function LD(e){var t;let n=e.theme,i=Pg.useRef(),r=e.player,o=function(){const[e,t]=Pg.useState({width:void 0,height:void 0});return Pg.useEffect((()=>{function e(){t({width:window.innerWidth,height:window.innerHeight})}return window.addEventListener("resize",e),e(),()=>window.removeEventListener("resize",e)}),[]),e}();Pg.useEffect((()=>(e.vfx.setTransitionSource("start"),()=>{e.vfx.setTransitionSource(null)})),[]);let[s,a]=Pg.useState(Math.random());if(Pg.useEffect((()=>a(Math.random())),[e.videoDimensions.aspectRatio]),Pg.useEffect((()=>(i.current=VR.getInstance(e.player,e.vfx),i.current.init({shapeCompositeMask:{background:{video:{opacity:.4,blendingMode:"hardLight"},baseColor:n.primaryColor||"#501CEB"}},useAICrop:!1}),()=>{i.current.destroy()})),[]),!i.current)return null;let l=i.current.getPlaceholderViewport(),c={};for(const t in e.gizmos)c[t]=Ig.createElement(e.gizmos[t],{primaryColor:n.primaryColor,secondaryColor:n.secondaryColor});let u,d=Ig.createElement(l,{className:"video",cornerRadius:e.cornerRadius},Ig.createElement(kD,{player:r,showMuteButton:e.showMuteButton}),null==r||null===(t=r.subtitles)||void 0===t?void 0:t.component),h=OD||e.videoDimensions.aspectRatio;var p,f;return u=function(){try{return window.self!==window.top}catch(e){return!0}}()&&(o.width<ID||o.height<AD)?Ig.createElement(PD,{ar:h,PlaceholderViewport:l,style:e.style,cornerRadius:e.cornerRadius,player:r,key:s,theme:n}):Ig.createElement($R,{videoElement:d,aspectRatio:h,interfaceElement:c.main,navigationElement:c.navigation,cardElement:c.card,minUIWidth:null===(p=e.layoutOptions)||void 0===p?void 0:p.minUIWidth,minUIHeight:null===(f=e.layoutOptions)||void 0===f?void 0:f.minUIHeight,style:e.style,key:s}),u}function ND(e){let[t,n]=Pg.useState({}),[i,r]=Pg.useState([]);return Pg.useEffect((()=>{let t=e.transitionState.subscribe("maxDuration",(e=>{n(e?{"--transitionInDuration":`${e.in}ms`,"--transitionOutDuration":`${e.out}ms`}:{})}));return()=>{n({}),t()}}),[]),Pg.useEffect((()=>{let t=e.transitionState.subscribe("direction",(e=>{r("in"===e?["transitionActive","transitionActiveIn"]:"out"===e?["transitionActive","transitionActiveOut"]:[])}));return()=>{r([]),t()}}),[]),[t,i]}let RD;function DD(e){const[t,n]=Pg.useReducer((e=>e+1),0);if(Pg.useEffect((()=>{e.enableGestures&&null!==RD&&import("../use-gesture-react.esm-COVlnafQ.js").then((e=>{RD=e,n()}))}),[]),e.enableGestures&&RD)return Ig.createElement(e.withGestures,Ja({useGestureModule:RD},e.innerProps),e.children);let i=null;var r;return!e.withoutGestures&&e.children?i=e.children:e.withoutGestures&&Ig.isValidElement(e.withoutGestures)?i=e.withoutGestures:e.withoutGestures&&"function"==typeof(r=e.withoutGestures)&&Ig.isValidElement(r())&&(i=Ig.createElement(e.withoutGestures,e.innerProps,e.children)),i}By(".full-screen-layout {\n  width: 100%;\n  height: 100%;\n}\n.full-screen-layout .video-controls-overlay-container {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  pointer-events: none;\n}\n.full-screen-layout .interface {\n  overflow-y: auto;\n  opacity: 1;\n  transition-property: opacity;\n  transition-duration: var(--transitionInDuration, 250ms);\n  transition-timing-function: ease-in;\n  will-change: opacity;\n  overscroll-behavior: none;\n  /* Let's get this party started */\n}\n.full-screen-layout .interface::-webkit-scrollbar {\n  -webkit-appearance: none;\n  position: absolute;\n  width: 3px;\n}\n.full-screen-layout .interface {\n  /* Handle */\n}\n.full-screen-layout .interface::-webkit-scrollbar-thumb {\n  border: solid 14px transparent;\n  border-radius: 14px;\n  background: var(--thumbColor);\n}\n.full-screen-layout .interface::-webkit-scrollbar-thumb:window-inactive {\n  background: rgba(255, 255, 255, 0.6);\n}\n.full-screen-layout .interfaceContent {\n  display: block;\n}\n.full-screen-layout.transitionActiveIn .interface {\n  opacity: 0;\n  transition-duration: var(--transitionInDuration, 150ms);\n  transition-timing-function: ease-out;\n  pointer-events: none;\n}\n.full-screen-layout.transitionActiveOut .interface {\n  transition-duration: var(--transitionOutDuration, 150ms);\n  opacity: 1;\n}"),By(".gestureCatcher {\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  pointer-events: all;\n  touch-action: pan-y;\n}");let MD=window.eko.embedApi;function FD({useGestureModule:e,children:t}){const n=e.useDrag((({swipe:e})=>{(e[0]||e[1])&&MD.sendMsg(MD.TYPES.SWIPE,{swipe:e})}),{threshold:25,filterTaps:!0});return React.createElement("div",Ja({className:"gestureCatcher"},n()),t)}By("a.eko-branding {\n  width: 108px;\n  height: 18px;\n  position: absolute;\n  top: 8px;\n  right: 11px;\n  border: none;\n  background-image: url(https://assets.eko.com/raw/949e5000-271e-11ef-8358-afdbe3c8903c/0);\n  background-position: right;\n  background-repeat: no-repeat;\n  background-color: transparent;\n  opacity: 0.7;\n  z-index: 1;\n  cursor: pointer;\n}\n\n.pause-overlay {\n  width: 100%;\n  position: absolute;\n  top: var(--overlayTop);\n  bottom: calc(100% - var(--overlayBottom));\n  opacity: 0;\n  transition: opacity 0.15s ease-in;\n}\n.pause-overlay.active-pause {\n  background: linear-gradient(0deg, rgba(0, 0, 0, 0) 0%, rgba(0, 0, 0, 0.4) 50%);\n}\n.pause-overlay button.eko-button {\n  opacity: 0;\n  pointer-events: none;\n}\n.pause-overlay button.eko-button svg {\n  fill: #fff;\n  stroke: rgba(0, 0, 0, 0.1019607843);\n  stroke-width: 1px;\n}\n.pause-overlay button.eko-button.play-button svg {\n  width: 33px;\n  height: 38px;\n}\n.pause-overlay button.eko-button.pause-button svg {\n  width: 32px;\n  height: 37px;\n}\n.pause-overlay button.pause-button, .pause-overlay button.play-button {\n  position: absolute;\n  right: 50%;\n  bottom: 50%;\n  transform: translate(50%, 50%);\n  border: none;\n  background-color: transparent;\n  cursor: pointer;\n  z-index: 1;\n}\n\n.full-screen-layout.prepause .pause-overlay, .full-screen-layout.paused .pause-overlay, .full-screen-layout:has(.pause-overlay > .focusable-pause-button:focus) .pause-overlay {\n  opacity: 1;\n}\n.full-screen-layout.prepause .pause-overlay button.eko-button, .full-screen-layout.paused .pause-overlay button.eko-button, .full-screen-layout:has(.pause-overlay > .focusable-pause-button:focus) .pause-overlay button.eko-button {\n  opacity: 1;\n  pointer-events: auto;\n}");const BD=e=>`${(100*e).toFixed(2)}%`,UD="pauseoverlay.",jD=window.eko.embedApi;function zD(e){let t=!e.prePaused&&!e.paused&&!e.player.paused;const[n,i]=Pg.useState(!1);function r(){i(!0)}function o(t){e.player.tracker.track(UD+t)}Pg.useEffect((()=>{e.prePaused?i(!0):e.paused||i(!1)}),[e.prePaused,e.paused]),Pg.useEffect((()=>(e.player.on("ekoshell.button.pause",r),()=>{e.player.off("ekoshell.button.pause",r)})),[e.player]);let s=["pause-overlay",...n?["active-pause"]:[]].join(" ");return React.createElement("div",{className:s,style:(a=e.bounds,{"--overlayTop":BD(a.top),"--overlayBottom":BD(a.bottom)})},e.enableEkobranding&&React.createElement("a",{className:"eko-branding",href:"https://eko.com/?utm_source=player&utm_content=overlaylink",target:"_blank",rel:"external",onClick:function(e){e.stopPropagation(),o("eko-branding")}}),e.paused&&React.createElement(yD,{className:"play-button",icon:"play",onClick:function(t){t.stopPropagation(),o("play"),e.player.play(),jD.sendMsg(jD.TYPES.USER_PLAY)},ariaLabel:"Play"}),(e.prePaused||t)&&React.createElement(yD,{className:"pause-button "+(t?"focusable-pause-button":""),icon:"pause",onClick:function(t){t.stopPropagation(),o("pause"),e.player.pause(),jD.sendMsg(jD.TYPES.USER_PAUSE)},ariaLabel:"Pause",ariaHidden:e.prePaused?"false":"true"}));var a}const VD=3e3;let WD;const HD=window.InterludePlayer.environment.queryParams,$D="boolean"!=typeof HD._eko_enableblockui||HD._eko_enableblockui;function GD(){return{frames:[{sourceTL:{x:0,y:0},sourceBR:{x:1,y:1},targetTL:{x:0,y:0},targetBR:{x:1,y:1},cornerRadius:0,fitType:"fill"}]}}function qD(e){var t;const n=null==e||null===(t=e.frames)||void 0===t?void 0:t[0];var i,r;return n?{top:(null===(i=n.targetTL)||void 0===i?void 0:i.y)||0,bottom:(null===(r=n.targetBR)||void 0===r?void 0:r.y)||1}:{top:0,bottom:1}}function YD(e){var t,n;const i=Pg.useRef(),r=e.theme||{},[o,s]=Pg.useState(qD()),a=e.layoutOptions.getRetargetOptions||GD,l=()=>{const t=a(e.viewportDimensions);i.current.update(t),s(qD(t))};Pg.useEffect((()=>(i.current=i.current||e.vfx.createFilter("retarget",a(e.viewportDimensions)),e.vfx.setTransitionSource(i.current.getId()),i.current.add(),()=>{e.vfx.setTransitionSource(null),i.current.remove(),i.current=null})),[]),Pg.useEffect((()=>{let t;return e.layoutOptions.onLayoutAdded&&(t=e.layoutOptions.onLayoutAdded({player:e.player,vfx:e.vfx,viewportDimensions:e.viewportDimensions,getRetargetOptions:a,updateRetarget:l})),()=>{t&&t()}}),[e.layoutOptions.onLayoutAdded]),Pg.useEffect((()=>{i.current&&l()}),[a]),Pg.useEffect((()=>{i.current&&e.layoutOptions.refreshRetargetOptionsOnVPChange&&l()}),[e.viewportDimensions]);let[c,u]=ND(e.vfx),d=e.player.ui.useSelector((e=>e.player.isPaused)),h=function(e){let[t,n]=Pg.useState(!1);return Pg.useEffect((()=>{const t=()=>{clearTimeout(WD),n(!1)};return e.on("play",t),e.on("playing",t),e.on("pause",t),()=>{e.off("pause",t),e.off("playing",t),e.off("play",t)}}),[]),{onClickBackdrop:function(){e.paused?e.play():e.paused||t?t&&n(!1):(clearTimeout(WD),WD=setTimeout((()=>n(!1)),VD),n(!0),TA.trackInteraction({elementid:"activate_overlay",elementtype:TA.elementTypes.PAUSE_OVERLAY}))},active:t}}(e.player),p={};for(const t in e.gizmos)p[t]=React.createElement(e.gizmos[t],{fullScreenLayoutProps:{prepauseActive:h.active}});let f=["full-screen-layout",...d?["paused"]:[],...h.active?["prepause"]:[],...u].join(" "),g=null!==(t=HD.ekobranding)&&void 0!==t?t:r.enableEkobranding;return React.createElement("div",{className:f,style:c,onClick:h.onClickBackdrop,"aria-live":"polite",tabIndex:"-1"},React.createElement(zD,{bounds:o,paused:d,prePaused:h.active,player:e.player,enableEkobranding:g}),$D&&React.createElement("div",{className:"interface"},React.createElement("form",{className:"interfaceContent",style:e.style,onSubmit:e=>e.preventDefault()},React.createElement(DD,{withGestures:FD,enableGestures:r.reportSwipes},p.main,p.topBar,p.card))),React.createElement("div",{className:"video-controls-overlay-container"},null===(n=e.player)||void 0===n||null===(n=n.subtitles)||void 0===n?void 0:n.component))}const KD={SIDEBAR:"SIDEBAR",FULLSCREEN:"FULLSCREEN"},XD=KD.SIDEBAR;function QD(e){if(e&&"string"!=typeof e)return e;switch(e){case KD.FULLSCREEN:return YD;case KD.SIDEBAR:return LD;default:return QD(XD)}}By("");const ZD={pill:36,rounded:8,square:0};function JD(e){return{width:e.videoWidth,height:e.videoHeight,aspectRatio:e.videoWidth/e.videoHeight}}function eM(e){return{width:e.containerWidth,height:e.containerHeight,aspectRatio:e.containerWidth/e.containerHeight}}function tM(e){var t;let[n,i]=Pg.useState(JD(e.player)),[r,o]=Pg.useState(eM(e.player));Pg.useEffect((()=>{const t=()=>i(JD(e.player)),n=()=>o(eM(e.player));return e.player.on("saferesize",t),e.player.on("containerresize",n),t(),()=>{e.player.off("saferesize",t),e.player.off("containerresize",n)}}),[]);let s=JA.get(),a={...e.style,"--primaryColor":s.primaryColor,"--secondaryColor":s.secondaryColor,"--fontName":s.font,"--viewportWidth":r.width+"px","--viewportHeight":r.height+"px"},l=ZD[s.buttonShape];const c=QD(null===(t=e.layoutOptions)||void 0===t?void 0:t.component);let u={...e.layoutOptions};return delete u.component,Ig.createElement(c,Ja({style:a,theme:s,videoDimensions:n,viewportDimensions:r,layoutOptions:u,cornerRadius:l},e))}const nM=rI("Gizmostrator");class iM{constructor(e,t){nM("[constructor]"),pI(this),DR(e),this.player=e,this.config=t,this.ekoLayoutAdded=!1;let n=JA.get();return this.uiReadyPromise=new Promise((t=>{this.player.pluginInited("ui").then((()=>{let i=n.fontSource;if("GoogleFonts"===i){let t=n.font;t&&e.ui.loadWebFont({source:"GoogleFonts",name:t,weights:[400,500,600,700],display:"swap"})}else if("url"===i){let t=n.fontUrl;t?e.ui.loadWebFont({source:"url",url:t}):nM.warn(`Missing "fontUrl" in theme config, Skipping url font loading for "${n.font}".`)}t()}))})),{setUi:this.setUi}}setUi(e){this.uiReadyPromise.then((()=>{if(!this.ekoLayoutAdded)return this.player.ui.add("ekoLayout",tM,{enableTransition:!1,player:this.player,vfx:kR.getInstance(this.player),...e}),void(this.ekoLayoutAdded=!0);this.player.ui.override("ekoLayout",null,{...e})}))}static getPlayerOptions(){return{scaling:"noop",VideoScaler:{unboxEnabled:!1}}}}const rM=/.*/,oM=/implementation\.interactions.*/;function sM(e,t={}){let n={...e};return n.price={amount:String(e.price||""),currency_code:e.currency},n.compareAtPrice={amount:String(e.compareAtPrice||""),currency_code:e.currency},delete n.currency,delete n._raw,t.removeVariants&&delete n.variants,Object.keys(n).forEach((e=>{null!=n[e]&&""!==n[e]||delete n[e]})),n}let aM=!1;const lM=rI("ExternalTrackers");let cM;cM=new class{constructor(){return cM||(lM("[Constructor]"),pI(this),{init:this.init})}init(e){var t;this.config=e,null!==(t=e.integrations)&&void 0!==t&&t.gtm&&this.registerGTMEvents()}gtmTrackBlockDone(e,t){let n=GI.get(`block::${e}`);window.dataLayer=window.dataLayer||[],window.dataLayer.push({event:"blockdone",blockId:e,blockType:t.type,blockName:t.name,state:n})}registerGTMEvents(){for(let e in this.config.blocks)iA.on(`${iA.events.BLOCK_DONE}:${e}`,(t=>{this.gtmTrackBlockDone(e,this.config.blocks[e])}))}};const uM=XI.embedApi;var dM="forms";const hM=rI("Forms"),pM=[],fM=dM;let gM=new class{constructor(){return hM("[constructor]"),this.formId=null,this.formIntegrationObject=null,this.formInstance=null,pI(this),{init:this.init,getField:this.getField,setField:this.setField,setEmail:this.setEmail,submit:this.submit,getFieldKeys:this.getFieldKeys}}registerActions(){this.Actions.register(`${fM}.setField`,(({key:e,value:t}={})=>{this.setField(e,t)})),this.Actions.register(`${fM}.getField`,(e=>{this.getField(e)}))}async init(e={},{Actions:t}){hM("Initializing forms instance");const{Form:n}=await import("../index-BGiluSaK.js");return this.Actions=t,this.registerActions(),this.provider=pM.filter((t=>e[t]))[0],hM(this.provider),this.provider?(this.formIntegrationObject=e[this.provider],this.formInstance=new n(this.provider,this.formIntegrationObject),!0):(hM.error("No CRM integration object defined"),!1)}submit(e){return this.formInstance.submit(e)}setEmail(e){var t;return null===(t=this.formInstance)||void 0===t?void 0:t.setEmail(e)}setField(e,t){var n;return null===(n=this.formInstance)||void 0===n?void 0:n.setField(e,t)}getField(e){var t;return null===(t=this.formInstance)||void 0===t?void 0:t.getField(e)}getFieldKeys(){var e;return Object.keys(null===(e=this.formInstance)||void 0===e?void 0:e.fields)}};const mM=rI("Forms"),yM=dM;let vM=new class{constructor(){return mM("[constructor]"),this.fields={},pI(this),{init:this.init,getField:this.getField,setField:this.setField,setEmail:this.setEmail,submit:this.submit,getFieldKeys:this.getFieldKeys}}registerActions(){this.Actions.register(`${yM}.setField`,(({key:e,value:t}={})=>{this.setField(e,t)})),this.Actions.register(`${yM}.getField`,(e=>{this.getField(e)}))}init({Actions:e}){mM.warn("Initializing noop forms instance"),this.Actions=e,this.registerActions()}submit(){return!0}setEmail(){return!0}setField(e,t){e&&(this.fields[e]=t)}getField(e){return this.fields[e]}getFieldKeys(){return Object.keys(this.fields)}},bM=gM;async function wM(e,t){bM=gM,await gM.init(e,t)}function kM(e,t){bM=vM,vM.init(t)}var xM=Object.freeze({__proto__:null,get default(){return bM},init:wM,initNoop:kM,integrationFeatures:["leadGeneration"],supportedIntegrations:[]});const SM=/.*/;let CM=!1;function _M(e){let t=e.Tracker;CM||(t.registerContextPacker(function(e){return{schema:"iglu:com.helloeko/ekocommerce/jsonschema/1-0-0",match:SM,getData:function(){return{currentfilters:Object.values(e.currentFilters())}}}}(e)),t.registerContextPacker({schema:"iglu:com.helloeko/products_filter/jsonschema/1-0-0",match:/^products\.filters.*/,getData:({id:e="",filter:t,operator:n})=>{let i={id:e};return t&&(i.filter=t),n&&(i.operator=n),i}}),CM=!0)}const EM=rI("eko-products-manager"),TM={and:"AND",or:"OR"};let PM=new class{constructor(){this.shop=null,this.filters=null,this.recommendations=null,this.ready=!1,this.operators=TM,pI(this)}async init(e,{Tracker:t,Actions:n,Checkpoints:i}){EM("[init]");const{Shop:r,Recommendations:o,Filters:s,Variants:a}=await import("../index-BT7Zdp_a.js");this.Tracker=t,this.Actions=n,this.registerActions(),i.register("products",this.saveFn,this.restoreFn),this.shop=r.create(e),this.filters=s.create(),this.recommendations=o.create(this.shop),this.variants=a.create(this.shop),this.ready=!0,_M(this)}alertIfNotReady(){this.ready||EM.error("ProductsManager must be initiated with init(shop) first")}registerActions(){this.Actions.register("products.addFilter",(({id:e,filter:t})=>{var n;this.alertIfNotReady(),null===(n=this.filters)||void 0===n||n.add(e,t),this.Tracker.track("products.filters.add",{id:e,filter:t})})),this.Actions.register("products.appendFilter",(({id:e,filter:t,operator:n})=>{var i;this.alertIfNotReady();const r=null==this?void 0:this.filters.get(e);null===(i=this.filters)||void 0===i||i.add(e,r?`${r} ${n} ${t}`:t),this.Tracker.track("products.filters.append",{id:e,filter:t,operator:n})})),this.Actions.register("products.removeFilter",(({id:e})=>{var t;this.alertIfNotReady(),null===(t=this.filters)||void 0===t||t.remove(e)})),this.Actions.register("products.resetFilters",(()=>{var e;this.alertIfNotReady(),null===(e=this.filters)||void 0===e||e.removeAll()}))}currentFilters(){var e;return this.alertIfNotReady(),null===(e=this.filters)||void 0===e?void 0:e.getAll()}async getAllProducts(e,t){var n;e=e||this.filters;let i=await(null===(n=this.recommendations)||void 0===n?void 0:n.get(e,t))||[];return i.length||EM.error("No product recommendations found"),i}getAllProductVariants(e){var t;return(null===(t=this.variants)||void 0===t?void 0:t.get(e))||[]}async getProduct(){const e=await this.getAllProducts();return e.length?e[0]:null}async getProductUrl(){let e=await this.getProduct();if(e)return e.url}async getMatchingProducts(e){var t;this.alertIfNotReady();const n=await(null===(t=this.filters)||void 0===t?void 0:t.getAll()),i=e.reduce(((e,t,n)=>0===n?t:e+" OR "+t),"");return n.temp=i,this.getAllProducts(n)}saveFn(){return{currentFilters:this.ready?this.currentFilters():{}}}restoreFn(e){if(this.ready){this.filters.removeAll();for(const[t,n]of Object.entries(e.currentFilters))this.filters.add(t,n)}}};const IM=rI("eko-noop-products-manager");class AM{constructor(){this.filters={}}remove(e){delete this.filters[e]}add(e,t){this.filters[e]&&IM.warn(`Overriding filter id:${e} , previous value:${this.filters[e]} - new value:${t}`),this.filters[e]=t}removeAll(){this.filters={}}get(e){return this.filters[e]}getAll(){return this.filters}}const OM={and:"AND",or:"OR"};let LM=new class{constructor(){this.filters=null,this.ready=!1,pI(this)}init({Tracker:e,Actions:t,Checkpoints:n}){IM.warn("[init] noop products module"),this.Tracker=e,this.Actions=t,this.operators=OM,this.registerActions(),n.register("products",this.saveFn,this.restoreFn),this.filters=new AM,this.ready=!0,_M(this)}alertIfNotReady(){this.ready||IM.error("ProductsManager must be initiated with init(shop) first")}registerActions(){this.Actions.register("products.addFilter",(({id:e,filter:t})=>{var n;this.alertIfNotReady(),null===(n=this.filters)||void 0===n||n.add(e,t),this.Tracker.track("products.filters.add",{id:e,filter:t})})),this.Actions.register("products.appendFilter",(({id:e,filter:t,operator:n})=>{var i;this.alertIfNotReady();const r=null==this?void 0:this.filters.get(e);null===(i=this.filters)||void 0===i||i.add(e,r?`${r} ${n} ${t}`:t),this.Tracker.track("products.filters.append",{id:e,filter:t,operator:n})})),this.Actions.register("products.removeFilter",(({id:e})=>{var t;this.alertIfNotReady(),null===(t=this.filters)||void 0===t||t.remove(e)})),this.Actions.register("products.resetFilters",(()=>{var e;this.alertIfNotReady(),null===(e=this.filters)||void 0===e||e.removeAll()}))}currentFilters(){var e;return this.alertIfNotReady(),null===(e=this.filters)||void 0===e?void 0:e.getAll()}getAllProducts(){return IM("No product recommendations found"),[]}getAllProductVariants(){return[]}getProduct(){return null}getProductUrl(){}getMatchingProducts(){return this.alertIfNotReady(),[]}saveFn(){return{currentFilters:this.ready?this.currentFilters():{}}}restoreFn(e){if(this.ready){this.filters.removeAll();for(const[t,n]of Object.entries(e.currentFilters))this.filters.add(t,n)}}},NM=PM;async function RM(e,t){NM=PM,await PM.init(e,t)}function DM(e,t){NM=LM,LM.init(t)}var MM=Object.freeze({__proto__:null,get default(){return NM},init:RM,initNoop:DM,integrationFeatures:["productInventory"],supportedIntegrations:["shopify","woocomerce","googlesheet","csvurl","sfcc"]});const FM=rI("Urls"),BM=window.InterludePlayer.environment.queryParams,UM={},jM=new URLSearchParams(window.location.search);for(const[e,t]of jM.entries())UM[e]=t;const zM=["id","impl","autoplay","debug","ekologger","headblockid"],VM="urls";let WM=new class{constructor(){return FM("[constructor]"),pI(this),{init:this.init,open:this.open}}registerActions(){this.Actions.register(`${VM}.open`,(({url:e})=>{this.open(e)}))}getExposedState(){return{queryparams:UM}}addEkoAnalyticsParams(e){try{const t={eauid:window.localStorage,easid:window.sessionStorage};Object.keys(t).forEach((n=>{const i=t[n].getItem(n);if(i){const t=e.includes("?")?"&":"?";e=`${e}${t}${n}=${i}`}}))}catch(e){}return e}addForwardedQueryParams(e){let t=e;return Object.keys(BM).forEach((e=>{if(e&&!zM.includes(e)){let n=t.includes("?")?"&":"?";t=`${t}${n}${e}=${BM[e]}`}})),t}init(e,{Actions:t,State:n}){FM("[init]",arguments),this.player=e,this.Actions=t,this.registerActions(),n.register(`module::${VM}`,this.getExposedState)}open(e){let t=this.addForwardedQueryParams(e);t=this.addEkoAnalyticsParams(t),this.player.urls.open(t)}};var HM=[{value:"score",label:"Score",type:"number"}];const $M=rI("Variables"),GM=["",void 0,null];function qM(e){return function(e){return"number"==typeof e||"string"==typeof e&&!!e.trim()&&!isNaN(e)}(e)&&(e=Number(e)),"string"==typeof e&&"true"===e.trim()&&(e=!0),"string"==typeof e&&"false"===e&&(e=!1),e}function YM({key:e,value:t}){return!(!e||GM.includes(t))||($M.warn(`Invalid action passed to variables module: (${e},${t}). Ignoring operation`),!1)}let KM=new class{constructor(){return this.registeredVariables={},pI(this),{init:this.init}}getExposedState(){return this.registeredVariables}registerActions(){this.Actions.register("variables.set",(({key:e,value:t})=>{YM({key:e,value:t})&&($M(`Setting variable ${e} to value ${t}`),t=qM(t),this.set(e,t))})),this.Actions.register("variables.increment",(({key:e,value:t})=>{YM({key:e,value:t})&&($M(`Incrementing variable ${e} by value ${t}`),t=qM(t),this.increment(e,t))})),this.Actions.register("variables.decrement",(({key:e,value:t})=>{YM({key:e,value:t})&&($M(`Decrementing variable ${e} by value ${t}`),t=qM(t),this.decrement(e,t))}))}init({Actions:e,State:t,Checkpoints:n}){$M("[init]",arguments),this.Actions=e,this.registerActions(),t.register("module::variables",this.getExposedState),n.register("variables",this.saveFn,this.restoreFn),this.initDefaultVariables()}initDefaultVariables(){for(let e of HM)"number"===e.type&&this.set(e.value,0)}set(e,t){$M(`variable ${e} is ${t}`),this.registeredVariables[e]=t}increment(e,t){return this.set(e,(this.registeredVariables[e]||0)+t)}decrement(e,t){return this.increment(e,-1*t)}saveFn(){return{registeredVariables:this.registeredVariables}}restoreFn(e){this.registeredVariables={...e.registeredVariables}}};const XM=rI("Environment"),QM=window.InterludePlayer.environment,ZM="desktop"===QM.name,JM="ios"===QM.name,eF="android"===QM.name;let tF=new class{constructor(){return XM("[constructor]"),pI(this),{init:this.init}}getExposedState(){return{isDesktop:ZM,isMobile:JM||eF,isIos:JM,isAndroid:eF,viewPortWidth:window.innerWidth,viewPortHeight:window.innerHeight}}init({State:e}){XM("[init]",arguments),e.register("module::environment",this.getExposedState)}};const nF=rI("modules");function iF(e,t,n){let i=Object.keys(t).some((t=>e.supportedIntegrations.includes(t))),r=n.some((t=>e.integrationFeatures.includes(t)));return i&&r}async function rF(e,t){let n=iF(xM,e,t)?wM:kM;await n(e,{Actions:JI})}async function oF(e,t){let n=iF(MM,e,t)?RM:DM;await n(e,{Actions:JI,Checkpoints:oA,Tracker:TA})}const sF="orchestrator",aF=new class{constructor(){return{createBlocks:this.createBlocks.bind(this)}}createBlocks(e,t,n){const i={};for(const[r,o]of Object.entries(t.blocks))i[r]=this._createBlock(r,o,n,{player:e,settings:t.settings,galleryConfig:t.galleryConfig,registerState:e=>{GI.register(`block::${r}`,e)},done:e=>{TA.track("blockdone");let t=`${iA.events.BLOCK_DONE}:${r}`;const n={...e,state:GI.get(`block::${r}`)};iA.emit(t,n),uM.sendMsg(uM.TYPES.BLOCK_DONE,{...n,blockId:r,blockType:i[r].type})}});return i}_createBlock(e,t,n=[],i){let r=n.find((e=>e.type===t.type));if(r)return new r(e,t.config,i);throw new Error(`Block type "${t.type}" in configuration does not match a supported block class`)}},lF=rI("Orchestrator"),cF=XI.embedApi;class uF{constructor(e,t,n){return lF("[constructor]"),pI(this),this.player=e,this.config=t,this.blockTypes=n,this.currentBlock=null,this.playedBlockList=[],this.isRestoringFromCheckpoint=!1,{init:this.init,currentBlock:this.currentBlock,run:this.run,back:this.back,reset:this.reset,setNextBlock:this.setNextBlock}}async init(){yI(),cM.init(this.config),HI.init(this.player),GI.register(`module::${sF}`,this.getExposedState.bind(this));let e=$A(this.config.brandName);await JA.init(this.config.theme,e,this.player,TA),this.blocks=aF.createBlocks(this.player,this.config,this.blockTypes),MA.init(this,this.blocks),this.streamerizer=new OR(this.player,this.config,this.blocks),this.gizmostrator=new iM(this.player,this.config),XI.init(this,this.player),bA.init(this.player,this.config),await async function(e,t,n){nF("[init]");const i=Object.values(n).map((e=>e.metadata.integrationFeatures)).flat();!function(e){WM.init(e,{Actions:JI,State:GI})}(e),await Promise.all([rF(t.integrations,i),oF(t.integrations,i)]),KM.init({Actions:JI,State:GI,Checkpoints:oA}),tF.init({State:GI})}(this.player,this.config,this.blocks),this.registerActions(),this.registerEmbedApiHandlers(),this.addPlayerEventsListeners(),this.registerBlocksContextPackers()}get currentBlockIndex(){return this.playedBlockList.length-1}getExposedState(){return{blocks:this.blocks,currentBlock:this.currentBlock,currentBlockIndex:this.currentBlockIndex,playedBlockList:this.playedBlockList}}registerActions(){JI.register(`${sF}.setNextBlock`,(({blockId:e},t={})=>{this.setNextBlock(e,t.immediate)})),JI.register(`${sF}.back`,this.back),JI.register(`${sF}.reset`,this.reset),JI.register("focus",(()=>{document.querySelectorAll('button:not([disabled]), input, select, textarea, [tabindex]:not([tabindex="-1"])')[0].focus()}))}registerEmbedApiHandlers(){XI.registerProjectHandler("setNextBlock",(({blockId:e,immediate:t})=>{e?this.setNextBlock(e,t):lF.warn('Missing "blockId" in "setNextBlock" handler')})),XI.registerProjectHandler("queryProjectStarted",(()=>{var e,t;cF.sendMsg(cF.TYPES.PROJECT_STARTED,{started:!!this.currentBlock,blockId:null===(e=this.currentBlock)||void 0===e?void 0:e.id,blockType:null===(t=this.currentBlock)||void 0===t?void 0:t.type})}))}addPlayerEventsListeners(){this.player.on(this.player.events.loadeddata,(()=>{setTimeout((()=>{cF.sendMsg(cF.TYPES.LOAD_START)}),0)})),this.player.on(this.player.events.canplay,(()=>{cF.sendMsg(cF.TYPES.CAN_PLAY)})),this.player.on(this.player.events.playing,(()=>{cF.sendMsg(cF.TYPES.PLAYING)})),this.player.on(this.player.events.pause,(()=>{cF.sendMsg(cF.TYPES.PAUSE)}))}registerBlocksContextPackers(){for(const e of this.blockTypes){let t=e.getContextPackers&&e.getContextPackers()||[];for(const e of t)TA.registerContextPacker(e)}}async getBlockUi(e){var t,n;let i=await e.getUi(),r=await async function(e,t,n){let i=await async function(e,t){var n,i;let r=await yI();return r?null!==(n=r.blocks)&&void 0!==n&&n[e]||null!==(i=r.blocks)&&void 0!==i&&i[t]?r.blocks[e]||r.blocks[t]:(fI.warn(`The loaded sauce doesn't have anything for requested block id/type: "${e}"/"${t}"`),null):null}(e,t);if(!i)return null;if(!n)return fI.warn(`Missing block props hook for block "${e}" - "${t}"`),null;let r=i.main;return function(e){let t={...e,...n()};return React.createElement(r,t)}}(e.id,e.type,null===(t=i.uiPropsHooks)||void 0===t?void 0:t.main);return r&&null!==(n=i.gizmos)&&void 0!==n&&n.main&&(i.gizmos.main=r),i}async onBlockStart(e){if(this.currentBlock===e&&!this.isRestoringFromCheckpoint)return;this.isRestoringFromCheckpoint=!1,this.currentBlock=e,this.playedBlockList.push(e),"function"==typeof e.onStarted&&e.onStarted();let t=await this.getBlockUi(e);this.gizmostrator.setUi(t),oA.save(`blockstarted_index_${this.currentBlockIndex}`),aM||(TA.registerContextPacker(function(e){return{schema:"iglu:com.helloeko/block/jsonschema/1-0-3",match:rM,getData:()=>{var t;let n={},i=e.currentBlock.id;return n.blockid=i,n.blockindex=e.currentBlockIndex+1,n.blocktype=e.config.blocks[i].type,n.blockname=e.config.blocks[i].name,n.blockfamily=null===(t=e.currentBlock.metadata)||void 0===t?void 0:t.blockFamily,n.totalblocks=Object.keys(e.blocks).length,n}}}(this)),TA.registerContextPacker({schema:"iglu:com.helloeko/implementation_interactions/jsonschema/1-0-6",match:oM,getData:function({elementid:e,elementtype:t,elementname:n,interactiontype:i}){let r={elementid:e,elementtype:t};return n&&(r.elementname=n),i&&(r.interactiontype=i),r}}),TA.registerContextPacker({schema:"iglu:com.helloeko/product_linkout/jsonschema/1-0-0",match:"product.linkout",getData:function(e){const t={url:e.url,itemid:e.id,itemname:e.title};return e.price&&(t.price={amount:e.price.toString(),currency_code:e.currency}),t}}),TA.registerContextPacker({schema:"iglu:com.helloeko/product_linkout_checkout/jsonschema/1-0-0",match:"product.linkout.checkout",getData:function({product:e,variant:t}){const n={url:e.url,itemid:e.id,itemname:e.title};return t.price&&(n.price={amount:t.price.toString(),currency_code:e.currency}),t.selectedOptions&&(n.selectedOptions=t.selectedOptions),n}}),TA.registerContextPacker({schema:"iglu:com.helloeko/menu_selection/jsonschema/1-0-0",match:"choiceselect",getData:({selected:e,blockConfig:t})=>(Array.isArray(e)||(e=[e]),{selected:e.map((e=>{let n={index:e};const i=t.options[e];i.image&&(n.image=i.image);let r=i.text||i.name;return r&&(n.name=r),n}))})}),TA.registerContextPacker({schema:"iglu:com.helloeko/product_card_click/jsonschema/1-0-1",match:"product.card.click",getData:e=>({...sM(e)})}),TA.registerContextPacker({schema:"iglu:com.helloeko/products_block/jsonschema/1-0-2",match:"products.display",getData:e=>({products:e.map((e=>sM(e,{removeVariants:!0})))})}),TA.registerContextPacker({schema:"iglu:com.helloeko/generic_linkout/jsonschema/1-0-0",match:"generic_linkout",getData:function({url:e="",label:t}){const n={url:e};return t&&(n.label=t),n}}),TA.registerContextPacker({schema:"iglu:com.helloeko/lead_capture_form/jsonschema/1-0-0",match:"fullscreenleadcapture.submit",getData:({formFields:e})=>({formfields:e})}),aM=!0);let n={blockId:e.id,blockType:e.type};iA.emit(iA.events.BLOCK_START,n),cF.sendMsg(cF.TYPES.BLOCK_START,n)}run(){lF("[run]");const e=this.config.headBlockId;if(e)return lF.warn('Using legacy "headBlockId" property from config to push the head block.'),void this.setNextBlock(e,!1,{onBlockStart:this.onBlockStart});const t=window.InterludePlayer.environment.queryParams.startBlockType;if(t){const e=Object.values(this.blocks).find((e=>e.type===t));if(e)return void this.setNextBlock(e.id,!1,{onBlockStart:this.onBlockStart});lF.info(`Got startBlockType="${t}" but no block was found, ignoring.`)}iA.emit(iA.events.PROJECT_READY)}back(){if(0===this.currentBlockIndex)return void lF.warn('Ignoring "back()" request since there is no previous block.');let e=this.currentBlockIndex-1,t=this.playedBlockList[e];this.playedBlockList.splice(e),oA.restore(`blockstarted_index_${e}`),this.isRestoringFromCheckpoint=!0,this.setNextBlock(t.id,!0,{onBlockStart:this.onBlockStart})}reset(){let e=this.playedBlockList[0];this.playedBlockList=[],oA.restore("blockstarted_index_0"),this.isRestoringFromCheckpoint=!0,this.streamerizer.setNextBlock(e.id,!0,{onBlockStart:this.onBlockStart})}setNextBlock(e,t,n={}){this.streamerizer.setNextBlock(e,t,{onBlockStart:this.onBlockStart,...n})}}function dF(e,t=3){return parseFloat((e/1e3).toFixed(t))}const hF=[{schema:"iglu:com.helloeko/rtperf_resource/jsonschema/1-0-0",match:"rtperf.resource",getData:(e={})=>({url:e.url||"",starttime:dF(e.startTime||0),endtime:dF(e.endTime||0),duration:dF(e.duration||0),transfersize:e.transferSize||0})}];let pF=!1;const fF=rI("RTPerformance"),gF=["onPreInit","onInit","onReady"],mF=[/\/instanceLoader(\.min)?(\.gz)?\.js/,/ekoapi\.eko\.com\/scripts\/bundle/,/\/app(\.min)?(\.gz)?\.js/,/\/EkoAnalyticsPlatform(\.min)?(\.gz)?\.js/],yF=(e,t=3)=>(e/1e3).toFixed(t),vF="object"==typeof window&&window.performance&&"function"==typeof window.performance.now?window.performance.now.bind(window.performance):Date.now.bind(Date);function bF(e){fF.info(`[RESOURCE] ${JSON.stringify(e,null,4)}`),TA.track("rtperf.resource",e)}const wF=rI("logic");function kF(e,t,n){e.forEach((e=>{if("orchestrator.setNextBlock"===e.type){if(n.streamDecided)return void wF.info('Ignoring "setNextBlock" action since next block in the stream was already decided. action data ignored:',e.data);n.streamDecided=!0}let i=((...e)=>{var t;return null===(t=window)||void 0===t||null===(t=t.InterludePlayer)||void 0===t||null===(t=t.utils)||void 0===t?void 0:t.getObjectProperty(...e)})(JI,e.type);i?(wF.debug("Applying action (with options):",e,t),i(e.data,t)):wF.warn(`Tried to invoke unknown/unregistered action type: ${e.type}`)}))}const xF=rI("prefetching"),SF=/^blockdone:(.*)/;const CF={CTA:()=>import("../index-Bf8U-b3T.js"),EmailSignUp:()=>import("../index-6-acxpkL.js"),Intro:()=>import("../index-CkAPMo_u.js"),Menu:()=>import("../index-mGjbMzdE.js"),Products:()=>import("../index-C-oDjCxV.js"),Sequence:()=>import("../index-Cbak0F8Z.js"),TwoStepMenu:()=>import("../index-Ly9rKCiy.js"),MultipleChoice:()=>import("../index-xYzXM2Sq.js"),Video:()=>import("../index-Ck4CgNE2.js"),SplitScreenChoice:()=>import("../index-BjmEE4tZ.js"),FullScreenIntro:()=>Promise.resolve().then((function(){return HU})),FullScreenVideo:()=>import("../index-CCIOi-cS.js"),FullScreenChoice:()=>import("../index-BrJ5OYKl.js"),FullScreenChoiceWithPreview:()=>import("../index-B3wyKsjA.js"),FullScreenSequence:()=>import("../index-C_cUoVLY.js"),FullScreenMultiSequence:()=>import("../index-bBibe6zW.js"),FullScreenProducts:()=>import("../index-DYWIXdLz.js"),FullScreenLeadCapture:()=>import("../index-YJVpMRve.js"),ProductDemo:()=>import("../index-Bgh-VGAL.js"),ProductExplorer:()=>import("../index-DD-jmMRQ.js"),GalleryBlock:()=>Promise.resolve().then((function(){return KV}))};rI.setDefaults({level:"warn",appName:"generic-blocks"});const _F=rI("app");let EF,TF=[],PF=(IF={onPreInit:async function(e,t){var n,i;(function(e,t){var n;_F("config:",e),EF=function(e){var t,n,i,r;return{settings:{showBackButton:!0,showMuteButton:!e.settings.backgroundMusic.hideMuteToggle,audio:{unmuteOnFirstInteraction:e.settings.backgroundMusic.unmuteOnFirstInteraction}},theme:{instance:(r=e.settings.style,{primaryColor:r.primaryColor,secondaryColor:r.secondaryColor,buttonShape:sI[r.buttonShape],font:r.font,textOutline:r.textOutline,transition:r.transition}),spaceBranding:null===(t=window)||void 0===t||null===(t=t.eko)||void 0===t||null===(t=t.params)||void 0===t||null===(t=t.space)||void 0===t?void 0:t.branding,...e.settings.view3dworkaround&&{view3dworkaround:!0}},soundtrack:(i=e.settings.backgroundMusic,{src:i.soundtrack,volume:i.volume}),blocks:lI(e.blocks.blocksArr),logic:e.logic,brandName:null===(n=window)||void 0===n||null===(n=n.eko)||void 0===n||null===(n=n.params)||void 0===n||null===(n=n.space)||void 0===n?void 0:n.brandName}}(e.data),EF.galleryConfig=t,_F("config transformed:",EF),EF.integrations=null===(n=window)||void 0===n||null===(n=n.eko)||void 0===n||null===(n=n.params)||void 0===n||null===(n=n.space)||void 0===n?void 0:n.integrations,"undefined"!=typeof mockProjectData&&(window.InterludePlayer.environment.queryParams.mocklogic?(_F.warn("USING MOCK LOGIC DATA:",mockProjectData.logic),EF.logic=mockProjectData.logic):(_F.warn("USING MOCK DATA:",mockProjectData),EF=mockProjectData))})(e,t.get("galleryConfig")),await async function(){const e={};Object.values(EF.blocks).forEach((t=>{let n=t.type,i=CF[n];i||_F.warn(`Cannot add block type because "${n}" is not a valid block type`),n in e||(e[n]=function(e,t){return new Promise(((t,n)=>{!function i(r){e().then((e=>t(e))).catch((e=>{r<=3?(_F.error(`Failed to fetch module with error: ${e}, attempt:${r}/3`),i(r+1)):n()}))}(1)}))}(i))})),TF=await Promise.all(Object.values(e)).then((e=>e.map((e=>e.default)))).catch((e=>{_F.warn(`Failed to fetch modules with error: ${e}`)}))}(),function(e){wF("[setup]");const t={};e.forEach((e=>{let n=e.trigger;t[n]=t[n]||[],t[n].push(e)}));for(const[e,n]of Object.entries(t))iA.on(e,(t=>{let i=GI.getAll();wF.debug(`State data for "${e}" trigger:`,i);let r={streamDecided:!1};n.forEach((e=>{let n=e.condition;var o,s;(0===(null==(o=n)||null===(s=o.and)||void 0===s?void 0:s.length)||hI.apply(n,i))&&kF(e.actions,t,r)}))}))}(EF.logic),n=EF.blocks,i=EF.logic,xF("[setup]"),i.forEach((e=>{e.actions.forEach((t=>{if("orchestrator.setNextBlock"===t.type){let i=e.trigger.match(SF);if(i&&i[1]){let e=i[1],r=t.data.blockId;n[e].prefetch=n[e].prefetch||[],n[e].prefetch.includes(r)||n[e].prefetch.push(r)}}}))})),Object.values(n).forEach((e=>{e.prefetch=e.prefetch||[]})),await HA($A(EF.brandName)).then((e=>{window.InterludePlayer.utils.extend(!0,oI,(null==e?void 0:e.getPlayerOptions)&&e.getPlayerOptions(),function(e){var t;let n=window.InterludePlayer.utils.extend,i={autoplay:!1!==window.InterludePlayer.environment.queryParams.autoplay};return null!=e&&null!==(t=e.audio)&&void 0!==t&&t.unmuteOnFirstInteraction?(i.forceAudioLocked=!0,i.muted=!1):i.muted=!0,n(!0,{},i,{scaling:"noop",VideoScaler:{unboxEnabled:!1}},{plugins:{ekoshell:{addons:{controlsoverlay:{parentContainer:null,checkpointsEnabled:!1,checkpointsEnabledOnMobile:!1,skipForward:!1,skipBackward:!1},sharebutton:{parentContainer:!1},projectmetadata:!1,ekologo:!1,backButton:!1,feedback:!1},projectInfo:{title:"",watchTimeSeconds:0},projectUrl:"https://eko.com"}}},{plugins:{subtitles:{mode:"proxy"}}})}(EF.settings))}))},onInit:async function(e){let t=new uF(e,EF,TF);await t.init(),t.run()},onReady:function(){}},function(){if(!pF){for(const e of hF)TA.registerContextPacker(e);pF=!0}}(),{...IF,...gF.reduce(((e,t)=>(e[t]=function(e,t){return e=e||function(){},function(e=(()=>{}),t=""){return async function(...n){const i=vF();fF.info(`[${t}] [START]`),TA.track(`rtperf.${t.toLowerCase()}.start`);const r=await e(...n),o=vF()-i;return fF.info(`[${t}] [DONE] Execution duration: ${yF(o)} seconds`),TA.track(`rtperf.${t.toLowerCase()}.end`),r}}(((...n)=>{if("onInit"===t){const e=n[0];e.once("playlistpush",(()=>{fF.info("[PLAYER] [playlistpush] Head node pushed to playlist"),TA.track("rtperf.player.headnodepush")})),e.once("canplay",(()=>{fF.info("[PLAYER] [canplay] Enough media has been loaded to start playback"),TA.track("rtperf.player.canplay")})),e.once("playing",(()=>{fF.info("[PLAYER] [playing] Playback has started"),TA.track("rtperf.player.playing"),function(){if("undefined"==typeof window||!window.performance||"function"!=typeof window.performance.getEntriesByType)return;const e=window.performance.getEntriesByType("resource").map((e=>({url:e.name,startTime:e.startTime,endTime:e.responseEnd,duration:e.duration,transferSize:e.transferSize}))).filter((({url:e})=>mF.some((t=>t.test(e))))).sort(((e,t)=>e.startTime-t.startTime));e.forEach(bF);const t=e[0].startTime,n=Math.max(...e.map((e=>e.endTime)));fF.info(`[logAndTrackResourcesTiming]\n        Total tracked resources:    ${e.length}\n        Start time:                 ${yF(t)} secs\n        End time:                   ${yF(n)} secs\n        Total loading duration:     ${yF(n-t)} secs\n    `),0===fF.getLevel()&&console.table(e.map((e=>({...e,url:e.url.split("/").slice(-1)[0],startTime:parseFloat(yF(e.startTime)),endTime:parseFloat(yF(e.endTime)),duration:parseFloat(yF(e.duration)),transferSize:e.transferSize}))))}()}))}return e(...n)}),t)}(IF[t],t),e)),{})});var IF,AF,OF,LF={onPreInit:PF.onPreInit,onInit:PF.onInit,onReady:PF.onReady,playerOptions:oI},NF=function(){if(OF)return AF;OF=1;const e=["loadstart","canplay","loadeddata"];return AF={listen:function(t){window.newrelic&&e.forEach((e=>{t.once(e,(()=>{window.newrelic.addPageAction(e,function(){try{const e=window.eko&&window.eko.params&&window.eko.params.instance,t=window.eko&&window.eko.params&&window.eko.params.space,n=e?window.eko.params.instance.id:"unknown",i=t?window.eko.params.space.name:"unknown",r=t?window.eko.params.space.spaceId:"unknown";return{instanceId:n,env:window.eko?window.eko.env:"unknown",spaceName:i,spaceId:r}}catch(e){return{error:e.message}}}())}))}))}},AF}(),RF=r(NF),DF={get:async function(e){const t=g("embedParams")||{},n=await m("embedParams")||{};let i=t.csp?function(e,t){return Object.keys(t).forEach((n=>{e[n]="events"===n?`${e[n]},${t[n]}`:t[n]})),e}(t,n):t;return e?i[e]:i}};function MF(e){let t=null;try{t=JSON.parse(JSON.stringify(e))}catch(e){t=null}return t}function FF(e){if(e instanceof Error&&(e=function(e){var t=Object.assign({},e);return t.message=e.message,t.name=e.name,t.stack=e.stack,t}(e)),e&&e.isWarning)return!1;var t=e.errorCode||e.id&&e.id+5e3||1e3,n={};return"string"==typeof e?n={message:e,code:t}:e.message?n={message:e.message,code:t,stack:e.stack}:e.errorMessage&&e.errorCode&&(n={message:e.message,code:t}),n}var BF,UF,jF,zF,VF=-1,WF=function(e){addEventListener("pageshow",(function(t){t.persisted&&(VF=t.timeStamp,e(t))}),!0)},HF=function(){return window.performance&&performance.getEntriesByType&&performance.getEntriesByType("navigation")[0]},$F=function(e,t){var n=HF(),i="navigate";return VF>=0?i="back-forward-cache":n&&(document.prerendering||function(){var e=HF();return e&&e.activationStart||0}()>0?i="prerender":document.wasDiscarded?i="restore":n.type&&(i=n.type.replace(/_/g,"-"))),{name:e,value:-1,rating:"good",delta:0,entries:[],id:"v3-".concat(Date.now(),"-").concat(Math.floor(8999999999999*Math.random())+1e12),navigationType:i}},GF=function(e,t,n,i){var r,o;return function(s){t.value>=0&&(s||i)&&((o=t.value-(r||0))||void 0===r)&&(r=t.value,t.delta=o,t.rating=function(e,t){return e>t[1]?"poor":e>t[0]?"needs-improvement":"good"}(t.value,n),e(t))}},qF=-1,YF=function(){return"hidden"!==document.visibilityState||document.prerendering?1/0:0},KF=function(e){"hidden"===document.visibilityState&&qF>-1&&(qF="visibilitychange"===e.type?e.timeStamp:0,QF())},XF=function(){addEventListener("visibilitychange",KF,!0),addEventListener("prerenderingchange",KF,!0)},QF=function(){removeEventListener("visibilitychange",KF,!0),removeEventListener("prerenderingchange",KF,!0)},ZF=function(){return qF<0&&(qF=YF(),XF(),WF((function(){setTimeout((function(){qF=YF(),XF()}),0)}))),{get firstHiddenTime(){return qF}}},JF={passive:!0,capture:!0},eB=new Date,tB=function(e,t){BF||(BF=t,UF=e,jF=new Date,rB(removeEventListener),nB())},nB=function(){if(UF>=0&&UF<jF-eB){var e={entryType:"first-input",name:BF.type,target:BF.target,cancelable:BF.cancelable,startTime:BF.timeStamp,processingStart:BF.timeStamp+UF};zF.forEach((function(t){t(e)})),zF=[]}},iB=function(e){if(e.cancelable){var t=(e.timeStamp>1e12?new Date:performance.now())-e.timeStamp;"pointerdown"==e.type?function(e,t){var n=function(){tB(e,t),r()},i=function(){r()},r=function(){removeEventListener("pointerup",n,JF),removeEventListener("pointercancel",i,JF)};addEventListener("pointerup",n,JF),addEventListener("pointercancel",i,JF)}(t,e):tB(t,e)}},rB=function(e){["mousedown","keydown","touchstart","pointerdown"].forEach((function(t){return e(t,iB,JF)}))},oB=[100,300];const sB=window.eko.embedApi;let aB=!1;var lB=function(){aB||(aB=!0,function(e,t){t=t||{},function(e){document.prerendering?addEventListener("prerenderingchange",(function(){return e()}),!0):e()}((function(){var n,i=ZF(),r=$F("FID"),o=function(e){e.startTime<i.firstHiddenTime&&(r.value=e.processingStart-e.startTime,r.entries.push(e),n(!0))},s=function(e){e.forEach(o)},a=function(e,t,n){try{if(PerformanceObserver.supportedEntryTypes.includes(e)){var i=new PerformanceObserver((function(e){Promise.resolve().then((function(){t(e.getEntries())}))}));return i.observe(Object.assign({type:e,buffered:!0},{})),i}}catch(e){}}("first-input",s);n=GF(e,r,oB,t.reportAllChanges),a&&function(e){var t=function(t){"pagehide"!==t.type&&"hidden"!==document.visibilityState||e(t)};addEventListener("visibilitychange",t,!0),addEventListener("pagehide",t,!0)}(function(e){var t=!1;return function(e){t||(s(a.takeRecords()),a.disconnect(),t=!0)}}()),a&&WF((function(){r=$F("FID"),n=GF(e,r,oB,t.reportAllChanges),zF=[],UF=-1,BF=null,rB(addEventListener),zF.push(o),nB()}))}))}((e=>{delete e.entries,sB.sendMsg(sB.TYPES.METRICS_FID,e)})))};const cB=()=>{},uB=["trace","log","debug","info","warn","error","getLevel","setLevel"],dB=["trace","debug","info","warn","error","silent"],hB={TRACE:"color: white; background-color: magenta;",DEBUG:"color: black; background-color: turquoise;",INFO:"color: white; background-color: green;",WARN:"color: black; background-color: yellow;",ERROR:"color: white; background-color: red;"},pB="undefined"!=typeof self&&self||"undefined"!=typeof window&&window||void 0!==e&&e;let fB={level:"trace",appName:""},gB=[];const mB="object"==typeof pB&&pB.performance&&"function"==typeof pB.performance.now?pB.performance.now.bind(pB.performance):Date.now.bind(Date),yB=e=>e&&"string"==typeof e?e.toLowerCase().trim():"",vB=(()=>{try{const e=new URLSearchParams(document.location.search),t=[].concat(e.getAll("log")).concat(e.getAll("ekolog")).concat(e.getAll("ekologger")).join(",").split(",");if(0===t.length)return{};let n={};return t.forEach((e=>{const[t,i]=e.split(":");n[yB(t)]=yB(i)||"trace"})),n}catch(e){return{}}})(),bB=(e,t="")=>{const n=yB(e),i=T.getLogger(n);if(i.__ekologger)return i.__ekologger;t||vB[n]||vB["*"]||(i.__noExplicitLevel=!0);const r=i.methodFactory;i.methodFactory=(t,n,i)=>{const o=r(t,n,i),s=t.toUpperCase();return(...t)=>{o(`[${((e,t=3)=>(mB()/1e3).toFixed(t))()}] %c[${s}] ${fB.appName?`[${fB.appName}] `:""}[${e}]`,hB[s],...t)}},i.setLevel(t=vB[n]||vB["*"]||t||fB.level,!1);const o=(...e)=>i.log(...e);return uB.forEach((e=>{o[e]=(...t)=>(gB.forEach((n=>{n[e](...t)})),i[e](...t))})),i.__ekologger=o,o};bB.setDefaults=({appName:e="",level:t})=>{e&&"string"==typeof e&&(fB.appName=e),(t=yB(t))&&dB.includes(t)&&(fB.level=t,Object.values(T.getLoggers()).filter((e=>e.__noExplicitLevel)).forEach((e=>e.setLevel(fB.level,!1))))},bB.installDriver=e=>{const t={...uB.reduce(((t,n)=>(t[n]="function"==typeof(null==e?void 0:e[n])?e[n]:cB,t)),{})};gB.push(t)};const wB=bB("FallbackManager","info"),kB=1;var xB=new WeakMap,SB=new WeakMap,CB=new WeakMap,_B=new WeakMap,EB=new WeakMap,TB=new WeakMap,PB=new WeakMap,IB=new WeakMap,AB=new WeakSet;class OB{constructor(){nl(this,AB),tl(this,xB,null),tl(this,SB,!1),tl(this,CB,!1),tl(this,_B,!1),tl(this,EB,5.5),tl(this,TB,!1),tl(this,PB,null),tl(this,IB,null),Ya(AB,this,LB).call(this)}setPlayer(e){Ka(TB,this)&&!Ka(CB,this)?(Xa(xB,this,e),Ya(AB,this,FB).call(this)):wB.debug("[setPlayer] Skipping setup.")}transformPlayerOptions(e){return{...e,...Ka(CB,this)?Ka(_B,this)?{metamorphosisEnabled:!0}:{EngineTech:{...null==e?void 0:e.EngineTech,forceTech:"fallback"}}:{}}}}function LB(){const e=yg.environment.queryParams,t=e._eko_fallback;Xa(CB,this,"fallback"===v.get("forceTech")||"fallback"===e.forceTech||"always"===t),Xa(TB,this,"enabled"===t||"number"==typeof t),Xa(_B,this,!!e._eko_fallback_metamorphosis),Xa(EB,this,"number"==typeof t?t:5.5);const n=performance.now()/1e3;if(Ka(TB,this)&&n>=Ka(EB,this)&&(wB.info("[#initFallbackLogic] [FALLBACK ENABLED] Timeout expired - forcing fallback experience."),Xa(CB,this,!0)),Ka(CB,this))return wB.info("[#initFallbackLogic] [FALLBACK ENABLED] Currently loading fallback experience."),void Ya(AB,this,BB).call(this);Ka(TB,this)?(Xa(IB,this,setTimeout(Ya(AB,this,NB).bind(this),1e3*(Ka(EB,this)-n))),Xa(PB,this,setInterval(Ya(AB,this,RB).bind(this),100))):wB.debug("[#initFallbackLogic] [FALLBACK DISABLED] Continuing loading.")}function NB(){clearInterval(Ka(PB,this)),Ka(SB,this)?wB.debug("[#onFallbackTimeout] Timeout expired, main experience loaded in time."):(wB.info("[#onFallbackTimeout] Timeout expired and playback did not start in time - loading fallback experience."),Ya(AB,this,DB).call(this))}function RB(){var e;if(Ka(SB,this))return void clearInterval(Ka(PB,this));if(!Ka(xB,this))return;const t=Ka(xB,this).bitrate/1e6,n=(null===(e=Ka(xB,this))||void 0===e||null===(e=e.playlist)||void 0===e||null===(e=e[0])||void 0===e||null===(e=e.segment)||void 0===e||null===(e=e.subsegments)||void 0===e||null===(e=e[0])||void 0===e||null===(e=e.chosenRepresentation)||void 0===e?void 0:e.bandwidth)/1e6||kB,i=8*Ka(xB,this).totalDownloadedBytes/1e6,r=Ka(xB,this).buffered,o=i/n,s=Ka(xB,this).options.minCanplayBuffer,a=s-Math.max(o,r),l=performance.now()/1e3,c=Ka(EB,this)-l,u=a*n,d=u/t,h={measuredBandwidthMbps:t,videoBitrateMbps:n,totalDownloadedMBits:i,playerBufferedSeconds:r,estimatedBufferedSeconds:o,minCanplayBufferSeconds:s,secondsToBuffer:a,secondsElapsedSinceLoad:l,secondsRemainingUntilTimeout:c,estimatedMBitsToDownloadTillCanplay:u,estimatedSecondsTillCanplay:d};return a<=0?(wB.info("[#onFallbackInterval] Buffering is complete, do not load fallback experience.",JSON.stringify(h,null,4)),void clearInterval(Ka(PB,this))):c<d?(wB.info("[#onFallbackInterval] Estimated that it would take too long to start playback, navigating to fallback experience.",JSON.stringify(h,null,4)),void Ya(AB,this,DB).call(this)):void wB.debug("[#onFallbackInterval] Estimated that playback will start in time.",JSON.stringify(h,null,4))}function DB(){var e;wB.info("[#navigateToFallbackExperience] Navigating to fallback experience."),clearTimeout(Ka(IB,this)),clearInterval(Ka(PB,this)),null===(e=Ka(xB,this))||void 0===e||null===(e=e.playlist)||void 0===e||e.reset(),v.set("forceTech","fallback"),v.set("prefallbackloadtime",""+performance.now()/1e3),v.apply(),window.location.reload()}function MB(){wB.debug("[#onPlayerPlaying] Playback started."),Xa(SB,this,!0),clearTimeout(Ka(IB,this)),clearInterval(Ka(PB,this))}function FB(){Ka(xB,this)&&Ka(xB,this).once("playing",Ya(AB,this,MB).bind(this))}function BB(){window.EkoAnalytics("registerContextPacker",{schema:"iglu:com.helloeko/loader_fallback/jsonschema/1-0-0",match:"loader.fallback",getData:({prefallbackloadtime:e=0}={})=>({prefallbackloadtime:e})});const e=parseFloat(v.get("prefallbackloadtime")||0);window.EkoAnalytics("track","loader.fallback",{prefallbackloadtime:e})}const UB=window.eko.embedApi,jB=bB("loader","info");let zB;function VB(e=0){return new Promise((t=>{setTimeout(t,e)}))}function WB(e){let t=eO({data:e||{}});return{set:e=>{t.data={...t.data,...e}},hook:()=>{const[e,n]=Pg.useState(t.data);return Pg.useEffect((()=>{let e=t.subscribe("data",n);return n(t.data),e}),[]),e}}}g("isLandingPage")&&window.self!==window.top&&function(){const e=document.createElement("p"),t=document.createTextNode("A page can't be embedded, please use the embed link for better results");e.appendChild(t);const n=document.querySelector("#player");n.parentElement.appendChild(e),n.parentElement.removeChild(n);const i=document.querySelector("#loadingCover");throw i&&i.parentElement.removeChild(i),new Error("Can't embed a landing page, please use the embed url for better results")}(),async function(){const e=await async function(){return await window.eko.loaderCspPromise}();return async function(e){lB(),window.EkoAnalytics("track","loader.start");const t=new OB;if(g("deferLoading")&&await new Promise((e=>{UB.once(UB.TYPES.LOAD,e)})),!(window&&window.navigator&&window.navigator.userAgent.includes("WMT"))){const e=g("loadingDelay");Number.isNaN(e)||await VB(1e3*e)}if(!await yg.isSupported())throw{name:"unsupported"};e.set("InterludePlayer",yg),await LF.onPreInit(e.get("instance"),e);const n=t.transformPlayerOptions(await async function(){const e=g("playerOptions"),t=LF.playerOptions,n=await DF.get("playerOptions"),i=await m("playerOptions");return yg.utils.extend(!0,{},e||{},t||{},n||{},i||{})}()),{playerOptions:i,dynamicPluginOptions:r}=function(e){const t=Object.keys(qP);let n={},i={...e,plugins:{...e.plugins||{}}};for(const e of t){var r,o;n[e]=(null==i||null===(r=i.plugins)||void 0===r?void 0:r[e])||{},null==i||null===(o=i.plugins)||void 0===o||delete o[e]}return{playerOptions:i,dynamicPluginOptions:n}}(n);window.EkoAnalytics("track","loader.preplayerinit");const o=await yg.create("#player",i);window.EkoAnalytics("track","loader.postplayerinit"),await VB(),e.set("playerOptions",n),window.player=o,e.set("player",o),RF.listen(o),function(e){zB=function(e,t){let n={};return e.forEach((e=>{let i=new Promise((n=>{t.once(e,n)}));n[e]=i})),n}(["canplay","playing","requiresuseraction","checkpoints.restorerequiresuseraction"],e)}(o),t.setPlayer(o),function(e){let t=new Promise((t=>{e.once("playing",(()=>{jB.info("[playing] Playback started."),t()}))}));e.once("canplay",(()=>{let e=new Promise((e=>{setTimeout(e,2e3)}));Promise.any([t,e]).then((()=>{window.dispatchEvent(new Event("eko.removeLoadingCover"))}))}))}(o),await async function(e,t){!function(e,t){t.forEach((t=>{e.on(t,(async function(){let e=Array.prototype.slice.call(arguments);window.eko.postMessage({event:t,args:MF(e),embedid:await DF.get("embedid"),embedapi:await DF.get("embedapi")})}))})),e.on("error",(async e=>{window.eko.postMessage({event:"error",agrs:FF(e),embedid:await DF.get("embedid"),embedapi:await DF.get("embedapi")})}))}(e,function(e){let t=[];return e&&e.split(",").forEach((e=>{-1===t.indexOf(e)&&t.push(e.trim())})),t}(await DF.get("events"))),function(e,t){window.addEventListener("message",(function(n){if(!n||!n.data)return;const{data:i}=n,{target:r,playerProperty:o,args:s}=i,a=Array.isArray(s)?s:[s];if(!r||"embedapi"!==r)return;if(!t.hasObjectProperty(e,o))throw new Error("[EmbedAPI V2].[listenToParent] handler not found: "+o);const l=t.getObjectProperty(e,o),c=typeof l,u=["undefined","number","string","boolean","bigint"];if("function"===c){const n=t.getObjectProperty(e,o.substring(0,o.lastIndexOf(".")));l.apply(n,a)}else{if(!u.includes(c)||!u.includes(typeof a[0]))throw new Error("[EmbedAPI V2].[listenToParent] cannot execute action");t.setObjectProperty(e,o,a[0])}}))}(e,t)}(o,yg.utils),await VB(),await LF.onInit(o,e.get("instance"),e),o.tracker.track("loader.oninit"),await VB(),await async function(e,t,n){for(const[i,{isRequired:r,load:o}]of Object.entries(qP))await r(DF,e,n)&&(jB.debug(`[loadAndInitDynamicPlugins] Loading dynamic plugin: ${i}`),await o(e,t[i]))}(o,r,e.get("instance")),await(zB.default=new Promise((function(e){setTimeout(e,15e3)})),Promise.race(Object.values(zB))),await LF.onReady(o,e.get("instance"),e),o.tracker.track("loader.onready")}(new p({clientSideParams:e,instance:{...g("instance"),...e.instance||{}},space:{...g("space"),...e.space||{}},galleryConfig:[...g("galleryConfig")||[],...e.galleryConfig||[]]}))}().then((async function(){window.eko.postMessage({event:"loader.done",args:[],embedid:await DF.get("embedid"),embedapi:await DF.get("embedapi")})})).catch((async function(e){throw window.eko.postMessage({event:"error",args:{message:e.name},embedid:await DF.get("embedid"),embedapi:await DF.get("embedapi")}),e}));const HB=rI("blocks/utils");function $B(e=(()=>{}),t={},n){t.element&&TA.trackInteraction(t.element),function(e){e.player.paused&&e.player.once("seeking",(()=>{e.player.play()}))}(n),e()}function GB(e){const t=new Image;return t.src=e,window[e]=t,t}var qB={makeNodeLoop:function(e,t){let n=t.player.decision.get(e);if(n&&n.defaults.length>0)return void HB.error("[makeNodeLoop] - Cannot make node loop since decision already has default children",e.id,n.defaults);let i=n?n.children.concat([e]):[e];t.player.decision.update(e,{children:i,defaults:[e]})},connectNodes:function(e,t,n){n.player.decision.update(e,{children:[t],defaults:[t]})},onClickWrapper:$B,preloadImage:GB,preloadImageAndAddParams:function(e,t=66){return GB(`${e}?height=${t}`)},shouldShowBackButton:function(e){return(null==e?void 0:e.showBackButton)&&GI["module::orchestrator"].playedBlockList.length>1},shouldShowStartOverButton:function(e){return null==e?void 0:e.showStartOverButton},shouldShowMuteButton:function(e){return null==e?void 0:e.showMuteButton},onBackClick:function(e,t){$B((()=>{JI.orchestrator.back()}),{element:{elementid:`${e}-back`,elementtype:TA.elementTypes.BACK}},t)},onCTAClick:function(e,t,n){return $B((()=>{let e=null==t?void 0:t.linkoutUrl;e&&(TA.trackGenericLinkOut({url:e,label:null==t?void 0:t.linkoutButtonText}),WM.open(e))}),{element:{elementid:`${e}-cta`,elementtype:TA.elementTypes.CTA,elementname:null==t?void 0:t.linkoutButtonText}},n)},onResetClick:function(e,t){$B((()=>{JI.orchestrator.reset()}),{element:{elementid:`${e}-startOver`,elementtype:TA.elementTypes.START_OVER}},t)},updateNodesDecision:function(e,t,n){HI.connectNodes(e,t,n)},displayResponseVideo:function({responseVideoNode:e,optionConfig:t,block:n,ctx:i,buttonsPosition:r}){var o,s,a;if(!e||!t)return;let l=()=>{i.done({immediate:!1})};t.responseVideo.showSkipButton?n.showSkipButton({label:t.responseVideo.skipButtonLabel||"Skip",onClick:r=>$B((()=>{e.off("nodecritical",l),r.stopPropagation(),i.done({immediate:!0})}),{element:{elementid:`${n.id}-option-${t.name}-response-video-skip`,elementtype:TA.elementTypes.SKIP,elementname:t.name}},i),block:n}):n.menuGizmoProps.set({buttons:[]}),n.menuGizmoProps.set({logo:"",title:(null===(o=t.responseVideo)||void 0===o?void 0:o.title)||"",description:(null===(s=t.responseVideo)||void 0===s?void 0:s.description)||"",buttonsPosition:r,selectButton:!1}),n.seek(e,{synchronized:null===(a=n.blockConfig)||void 0===a||null===(a=a.advanced)||void 0===a?void 0:a.synchronizedSeek}),e.once("nodecritical",l)},showSkipButton:function({block:e,label:t,onClick:n}){e.menuGizmoProps.set({buttons:[{text:t,type:"button",onClick:n,primaryColor:e.theme.primaryColor,secondaryColor:e.theme.secondaryColor,icon:"chevronDoubleRight",iconPosition:"right"}]})},selectGizmoVariant:function(e,t){if(!e.type)throw new Error({message:"Missing block type for block",block:e});let n=window.InterludePlayer.environment.queryParams[`gizmovariant-${e.type}`];return window.eko.isEmbeddedInWalmartPDP&&(n="pdp"),n&&"function"==typeof t[n]?t[n]:[t.default,t[n]]},DEFAULT_BLOCK_REQUIRED_PROPS:{names:["logo","buttonShape","textOutline","buttonTextColor","buttonBackgroundColor","bodyTextColor","bodyBackgroundColor"],blockConfigMap:{logo:"logo",buttonShape:"buttonShape",textColor:"textColor",backgroundColor:"backgroundColor",textOutline:"textOutline"}}};function YB({showBackButton:e,showMuteButton:t=!0,isMuted:n,onClickMute:i,onClickBack:r,ctaButton:o,startOverButton:s,buttonTextColor:a,buttonBackgroundColor:l,buttonShape:c,ConnectedSubtitlesButton:u}){let d={primaryColor:a,secondaryColor:l,shape:c};return Ig.createElement("section",{className:"fullScreenControlContainer","aria-label":"navigation buttons",role:"group"},Ig.createElement("div",{className:"left"},e&&Ig.createElement(yD,Ja({className:"back-button",icon:"arrowLeft",label:"back",showLabel:!1,onClick:r},d)),s&&Ig.createElement(yD,Ja({className:"startover-button",type:s.type,label:s.label,icon:s.icon,iconPosition:s.iconPosition,onClick:s.onClick},d))),Ig.createElement("div",{className:"center"},o&&Ig.createElement(yD,Ja({className:"cta-button",type:o.type,label:o.label,icon:o.icon,iconPosition:o.iconPosition,onClick:o.onClick},d))),Ig.createElement("div",{className:"right"},Ig.createElement(u,d),t&&Ig.createElement(yD,Ja({className:"sound-button",icon:n?"volumeOff":"volumeUp",onClick:i,label:"Sound",showLabel:!1},d))))}function KB(e){let t=JA.blockUIPropsTransformer(e.blockConfig,qB.DEFAULT_BLOCK_REQUIRED_PROPS);return function(n){var i,r,o,s;let a=e.player;const l=qB.shouldShowBackButton(e.blockConfig.navigation),c=!(null===(i=e.blockConfig)||void 0===i||null===(i=i.cta)||void 0===i||!i.linkoutButtonText),u=qB.shouldShowMuteButton(e.ctx.settings),d=qB.shouldShowStartOverButton(e.blockConfig.navigation);let h,p,f=null===(r=e.blockConfig)||void 0===r||null===(r=r.cta)||void 0===r?void 0:r.linkoutButtonText,g=null===(o=e.blockConfig)||void 0===o||null===(o=o.navigation)||void 0===o?void 0:o.startOverButtonLabel;const{secondaryColor:m="black",font:y="sans-serif"}=n.theme||{};c&&(h={label:f,type:"primary",icon:"openFilled",iconPosition:"right",onClick:t=>{var n;t.stopPropagation(),qB.onCTAClick(e.id,null===(n=e.blockConfig)||void 0===n?void 0:n.cta,e.ctx)}}),d&&(p={label:g,icon:"twReplyFilled",iconPosition:"left",onClick:t=>{t.stopPropagation(),qB.onResetClick(e.id,e.ctx)}});let v="fullScreenLayoutProps"in n,b=a.ui.useSelector((e=>e.player.muted||e.player.isAudioLocked)),w=v&&a.ui.useSelector((e=>e.player.isPaused)),k=(null===(s=n.fullScreenLayoutProps)||void 0===s?void 0:s.prepauseActive)&&!w,x=!w&&!k;return React.createElement(YB,Ja({},n,t,{showBackButton:l,showMuteButton:u,onClickBack:t=>{t.stopPropagation(),qB.onBackClick(e.id,e.ctx)},isMuted:b,onClickMute:e=>{a.isAudioLocked||a.ekoshell.VolumeButton.toggleMute(),e.stopPropagation()},ctaButton:h,startOverButton:p,secondaryColor:m,font:y,player:a,ConnectedSubtitlesButton:bD(a),showPlayButton:w,onClickPlay:e=>{e.stopPropagation(),a.play()},showFocusablePauseButton:x,showPauseButton:k,onClickPause:e=>{e.stopPropagation(),a.pause()}}))}}function XB(e){return XB="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},XB(e)}By('.bp-vertical-small {\n  --gizmoPadding: 16px;\n  --navigationHeight: 5.2em;\n  font-size: 12px;\n  line-height: 14px;\n}\n\n.bp-vertical-medium {\n  --gizmoPadding: 24px;\n  --navigationHeight: 5.2em;\n  font-size: 16px;\n  line-height: 17px;\n}\n\n.fullScreenControlContainer {\n  width: 100%;\n  height: 100%;\n  display: flex;\n  flex-direction: row;\n  align-items: flex-start;\n  position: fixed;\n  top: 0;\n  text-align: center;\n  pointer-events: none;\n}\n.fullScreenControlContainer .left, .fullScreenControlContainer .right button.eko-button {\n  width: 52px;\n  height: 52px;\n}\n.fullScreenControlContainer .left {\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  margin: 20px auto 20px 20px;\n}\n.fullScreenControlContainer .right {\n  display: flex;\n  gap: 8px;\n  margin: 20px 20px 20px auto;\n}\n.fullScreenControlContainer .center {\n  white-space: nowrap;\n  margin: 20px;\n  max-width: 460px;\n}\n.fullScreenControlContainer .back-button, .fullScreenControlContainer .sound-button, .fullScreenControlContainer .startover-button, .fullScreenControlContainer .subtitles-button {\n  pointer-events: auto;\n  max-height: initial;\n  width: 100%;\n  height: 100%;\n  font-weight: bold;\n  box-sizing: border-box;\n  display: flex;\n  flex-direction: row;\n  justify-content: center;\n  align-items: center;\n  padding: 16px;\n  gap: 8px;\n  box-shadow: 0 2.90909px 23.2727px rgba(0, 0, 0, 0.08), 0 5.81818px 11.6364px rgba(0, 0, 0, 0.08);\n  flex: none;\n  flex-grow: 0;\n  z-index: 2;\n}\n.fullScreenControlContainer .back-button .icon, .fullScreenControlContainer .sound-button .icon, .fullScreenControlContainer .startover-button .icon, .fullScreenControlContainer .subtitles-button .icon {\n  width: 20px;\n  height: 24px;\n  flex: none;\n  flex-grow: 1;\n}\n.fullScreenControlContainer .back-button .label, .fullScreenControlContainer .sound-button .label, .fullScreenControlContainer .startover-button .label, .fullScreenControlContainer .subtitles-button .label {\n  letter-spacing: -0.01em;\n  font-size: 14px;\n}\n.fullScreenControlContainer .startover-button {\n  margin-left: 8px;\n  width: initial;\n}\n@keyframes cta-appear-anim {\n  0% {\n    opacity: 0;\n    transform: translateY(-1000px);\n  }\n  60% {\n    opacity: 1;\n    transform: translateY(15px);\n  }\n  80% {\n    transform: translateY(-3px);\n  }\n  100% {\n    transform: translateY(0);\n  }\n}\n.fullScreenControlContainer .cta-button {\n  display: flex;\n  width: 100%;\n  box-sizing: border-box;\n  flex-direction: row;\n  justify-content: center;\n  align-items: center;\n  padding: 25px 22px 25px 22px;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAMAAABHPGVmAAAAe1BMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAC9eBywAAAAKXRSTlMxNTlGKEosUk4jQD1DVllfHxtcY2xpZhQYdHB5EAyCfIt/CYaSmwCowgMQkfIAABixSURBVGjeHNRHgis3DABRJAIgCYbOLY2ksec73P+GDsta1ubBna7oVUH9Dw8AMqZGPqw65XWBwQif7+z4SMsdfH1hBqNikGGjFWMawULAS7BB+aEoXKgR2XNbt19CIrAK4D01Zc0LNluSzSJkIWAL8GqZQ1E685T8+dSn5swTvThj+mNb7JlyzwO2h4bokp2wyiUztOwYNL7+ChWeDFHtN9jxZqEKJ1QyvTpRsWR0oUKqX/wZFyvAloJFQzYz9DX8GYg+UzGhfqt4409+pl8EwJ+esaZS24dOBliFtnkANpjBfS95Kxm58XoIeNnSeEc4C7BBkih10R00rXA5qTLB0TKmrRLhsa5c/0wBdEL7YhvcNDjteEIOxWSlpBlJ3zmXDXtsaPJY4PErKwrn4FoZVs8Vx9aNtG5R+6NCwvTNj1LtsVfZpycLhromSSl/GFizb6Uo/LbfJTFz3bIlOVJdogj1VOjPvVjW9rBQ51kxXVI5esaJT+taW2aFx8JCW86aJqbab5YPFAhmhqvStz8TKgN9faUTDgtZCoqKIOekNYvY7068GTlVcEsLTijpgeC4pjXDe7Gcgn+7RpVoXrmn/sUgvoysjux8YYGKmROE2P1b/ZaqOujUhQp3mxwnE3tJ7GxQVJCTQvNz3XBDyLj1jr0aDDRNMY5jUhoAie5a8yFAjpR2ICAJA+RGdSZiIAeblBeMXUd1fkYgxDeVUP9qLcGeMN8pwYdTR6bcFLaiJvaMAb1p4V7wPlyrwnvPWhbVayvbGxYSEAu3zKsWHBrrtrcHq0W2PxKAHLR5OC5OPcP59L+wSVYGqBA1q6XdZ7vgGeUXGLkSqSZmJZ6Y8NYXwHHPCx5YR1nbmgwH0ggy2mer6NbhxiMvuKP3PnFfE17DV83FExP1htHHdwfSSWfBXZX92rHizJq07JZt7OAIiwfDgmgJXtdQJw6s9X65PhbIGaC9oljDcKXHCXC2tIxSCUYQcQsHKR8SMgTJQJnJ6NCR/2K+Sdd6wtX+bvU+mSeCP2o3eNpDCbD4z+M3xYWccgjGsLzita5HuycGQ64omvuaIgVDS2pSeZzHnI2U3xS3g50/PToCMJHPgvByLeuCN+Qp160OLWW6tHvLUB/j81V4TQkFhpebkN+6iTAWPqyiyHazf3vCM3VnGZRy9NG79iNfkBLS1jj6DXWt5iVgD0oVWH/2PLOl9URhHoYCuqCcuy/3lLIsQhOxpFD+3TRj9GDw2Fw52rfHtOI+kRoB3MBjHz8xS9aLX6lwNpyN181rCVAtMzAra5dm+I0uJWZ+x5Py2iw2GJj9rFcOVZAKYu2bF2aOOmsZfMEFcZY6XmVmyGyC9VX5srKBVNau8qbT9IUFpsYPBEKhOnPuZvpoyHIu2LoALMOAMF4npxWbXdDaaMDFTYQAo2jN/FOCck26/1sKJaB2hck50iNEei+YGJMuV2gE5M+X2qb+62/ms5Om2E0yf+XpcaaT21Ra6FCnbFfuIAk5N53TO195UUYvfyb3QEoJM+Pyu6jfRHR2AZ7NJEiEqM1RdOhSoSRvQ3b6Cly4d0uymOcjK8pS8yN3UPC9oNEHluZH3cRWZ9bPg39TPmu3/dpPMNoW0/diFGsZh6fDtXZ/3QDGhr248rlGsyvJ+ii1KDUacw6fdwG4sQ0uSUcnEopMUXXagUdjLO9WrAD0M5zrf2P07H8b9STk0uwP2H3j0g6TC3tVAUkl5Eq7wePMrivd4noBU++tL4w8ni7we+z0DF8Uq2QTFKLQd8h3ZBx76UyegBisdl9SAqiC7Qzd8eQ44ceQ041VF6GnPuioq0HAAxx/73u7NE3EdYe7w3hXKTXeqr9WwXkzNLD6bLYr7ExTosIP/89YGv3IdYSDHr0l1vMF4/WjooEJrlc6St4g/15IdM2FsB4MxIL7Cq6ZVFt9aXIOr7Y+U3WDHZghtxqqN00+qmhahdrSN5MX1HRyjRHeS1Vs6KLTQUCDlsUk0JIg4xcKcfdITFuAGC69RX4lTmNAvBxFwNG4iAHEhSEwK7v04lsNf47SKwGvFfrsWAUxMsI/FI9XkiQ3DERhCRA0RZbrajM7Znel+99QrQ9mRL4AHoKo79be3H0EyFpxS2BWwNxC87qg6K9dXQFJ9DYzvpgLLAv2qK/goj0jAtTckuA6lAlzZrrEg5ITAzIoBvwA98eWDWWRQEjRVySdWxuw6SuvW0jW1RkOxx9iFnpmyOnQkvLLwOkR9PgbVi3NK9HPSwgaQO7AfGJO0IljPmjSxGqIbb3yuRMh1QWrwKEZc5zKT5/cEZZYwbjO1zKw7ON4ZbbouFIEjNEPMUZoJXeMp5DgPSAAzCFcK/5dZTHuzvg3oaivVmSQ3sJMlrUs0rFXI8H3G1p5FMgS4G/PBcUKbv22IqcbROOCNcW065trrmGQzRNuZKnzTmsuTg32QpEuwkDKoNWFmRX8U+nibf3+gBkXrH2OG1l3qXfcUP238LXy9KFL/yjpscWkF2y2dRgikrMo3l/aunpenAD7baMSGAAI7puOo4wMK49s0d/jZliADajWpsGc/jkAsDGz4x7wugAhUpK0ZJcKLErp3iV327Dz8fA14Jq/DggvpV1p0vZNbD1A38Gd1gxacqOyDPR5U4Kak5WedIrVV/5WIaDnR65uKapxhgOz3k5K+PCG+dKxoUJuqF0SDFWzFisni1yP04Gm8rwBU/3/2tK6euoWt0y9yLJutR4PwseSln9uQxlyIgCIfInD6V3uBdJHLVauCplK7FOnPK8jUX535EzX72XXmpue31ShlaWmyKpwY7KaCtvkiRmPBAxHTfdFdrvjjlAL8eBc/Cgy/e4cno5GZZRi60hmVeBMuchbS8f33NN7NKqmAlcrvJA+t8eE6ePcD6LUFoVMH7KCuAdCnICwYwHNsSxTL/7m27KhniT2ZhVTg51EZjjP63kOETY1B4kwSkysLlr/4NvwbnXD9Y45Hs5CDjd6L2O8Oey/9Pc9N3z/jc1uH+9MsI4NTWy/HB+Yn2upoOu+FlzDbhYDdC8juUfXgWWhFwIFb4F+rEsnXSjCtmSUHhm9Ay2tD99nXlKjJerBdSu/KYkl/9pnNdIqdUjH4wT/QGtiBjO+FJKCWz7Pau5qEN0+6ZH2ZWi6o1IR/lGMdho8tjQLrpBTzJW6F9DP/vwDiqTgTlbCkQfuIHKTZtaLcq4jW7Z53Hun2jL4/Zwzzyxai9H5BgyeQ2KRMzE0fg5Ng2kgzbdpBn9WKJP74aNsLjXGVXzPlUsP/wbAkvrE5OkKnVoV1SFKnE2S9DVnU4pOdhBscMiqmwOp7GtfMi2wWzNTAYoCehudn0uk2cxTUcB2Nqfnk/UmDILPdzTN28JrwXoDLF+E22Cc3/UDKDtSsrYdydsEa69XuRonZdqAb/5GOJdy3xBhKwBRHwdh3Ztt7iULDINnUmm7MlHC2/f2Xfkos+fBmyO8CI3qexePpcnv80qQy9ddoOiyPXIqQV0ibvKFQle7KvccZ5rA4K97oepF8diHHhsuLqOy3yfQ3vnf5iTeN/XUR6nW12YAa0ZXDEi6LZKOEBgwyIjhdqVxVPlsijeiSk9wTX7spdlilMlQj8xcU9rjs4iPnEV2Rld8xQbUuYySKuWnLxF/DAj0kyLfH0jon14QCjmctAtl6JXcINKSSJ6d4w4EHSXH3uHqaFIWPHFJrKKLJeNX72u5lw3echwS5xiB4AiQBIvl95WUQcUrvJUbNT37so7Sw3Ja16RR4Xll3JLFBZtkjo+6+bOVJp5RE64bgcFYJkWjxI0+CZks/3QH/iNpAWJGs1ukdnf3/gA1ax5KUtDuC67t5Nx+qMTQ9JG2OD0F9vzYsNJgfP1vBd7in5/08MMG8j1YQ3KewGAbcyg6G0UmdV/32efH1BwsOvd9gS6f6iga0KmtS58pVDu7bPY82pf5sHh6YozWbfdewE2f1PwqkS7oBiHOq4oWsVatdUo0HvTQLhpRRPerYlMOL0//Xu6u7SyMF6hUtLkAWiHRK3IhL4OfLniloyKjI+QFVvMEB1nNBVFmWIhABtKVxtHOSnua2mxrqUoqktb7km60w13qr8Ngjbt/pAJHwWg5lGAVWbPC/MtOCmQl54VrLXD+13B5ZcdxA1EUOafOYQKHpGR7/yv0/dA5VEIDVS9mtq1IFtQcshwPnQrwiCpdBLnTxgey0+kHo9vCIm+lPPM5YFxZ80PtZ0sgjkBoax/qlk5SV7+0Ys+7DSkxCZEewtMLVivpuTqslhKz7qZ9l7yDl7goLTlA7uty32ZgGZGy5ZS89lXelbAQ1q1ZAYReEEC83w1OY929SWL/UKeYENq3VDvBg3wamHAsgi9T453F4KeQyR8QgenyHqnU8pOpwaxvPzjsz7I8rz/kr0VFSTkNqe8Ga6QL32aKZxacZ8iYh1HIX5LyQPr4oeOhaRroc+xq4R4ukhNIZ0UmSpuem+Ceu5d+o6cTaubg/KlxEJ3itKttloEzo9DXcxR6FdXB5wJF8kSlKvdvsFHg7Pko9OmFCay+76887NOxFzKodMe3MgV3N83kPY8aHAYnTwz4iTpHnYlSsn6UChcZ9xD+DeM1lCdrWchkBA3ZfrP1vBp/7L4k8jwbrMuqY4KL3DxFypvTzE6mI0h8Uc01StrhnKeYaQxX2ekHu5udMbUrIzAXkIBwZF24Hyx+KSrKbVdCxgXqlQWCq+raEq3n3Og6YmqBAFL1SO+GtgdGo2+Xt0ygKfn3TWNyeQBiMIVhsw1ZN5qOydhovPiu+XCeEsClaFue97uaIdZZ18v4pyUW8B5abkUnwYtDg8/na1HLPPtqeVer49e+Jh7+VCOFwh6OxdRz4E+nKuMkO+sE+kzSM93eMkC7XWV7unp4wvtTqtliehGkCzlwjFX2Ov5SC6QuST/sLb6f28HCN+OmJiadcxJIgSY4yjVejBjz4i+GwtGTKcpWqqOAvEAUAY4MoBgFbTYkhwFOIVADMeKUtTF7TWiLirjXCzmJAYua4JEWN0klG64h8fakZdbWlynNrsmCUZq05VT0U6YgxH3AWCKTbhd+qQXDVlyRhPHVcWIEte2GJ20t6pXBUU3OHaYJh9sMJ3f/KdOq9g4IBDlVt7SDgtkOEwcwpGz5JB80FyRW6+Y8kFp5KHTbYUxNVRbK5HPewBg+yzbspy4WYEWSoff4QfBo40RJUS0uMjwIhPAfsUIw0iuYjJp26hB6caz11qFvUsxwKi5/Kf1jDA6YPO+QuCmljTmdp7H6KFDXP0x2BOgllRCOqTDuWLnqhJbIEcoq0WfFRG3Ajw/jyn8ZaL5nda4nGxAPLLzC1BFGMHti/SKUv0Ki0f689pdvjOZqJd8PxUB/JUUGeAgtaaWuUcweLbYEQAo7WWaebKiM3SVlGXRdurRLBAkGci5WRo8DaGBh6JWRP1u9CmNIIpRycAurnORBEyD6453uKQ292M1lNMzLkPAkxO8uyKpGzTB0yF/N2OZhJjk5X77dp89djXE/+zJ3kzVuUggJ4JNRyiePg/A+rwVVOGCrW0XgnEMDvH46WlXZiZ+S3gZ9iRVYts4bZgYXiaqdUFq7HJvlSiM/fSElPAi3KeDholjc6pjnkswSkS7W94sU5nmezgn1zMB5ci5amo4ECVEv0nwVUkACaUljpUScvczyTfTB2pZpfwgdsj8Ioh1Z54PySzyfzHW6ZbOAoJlu5hOoXRuKSzV6Z9rHJm2Ece5fLUlywPK8spOCsJ1mUcpkiJ9OTWS+E1WemCWbVX5PVEZEsIcOC1pWlbS2UDYNSYEabD55rYUtHiIegRxGVXzyD7ydNzerZC6lvnJNHwxv1Zl2M0lJQD1qLu7RtTk03hdddasXdgIQQrtOKgXRn65Vd+CFvYlEqdZzmOQX9t+ohy/5qUwvybiuVNExZY+lHyy4h1nOZTE+rmoEutHhy3ws0+Y6r9AsDqmcFU5kP2uVQaFZ/kQVXrCbiH7MJS+X+LMfNfwcvolhwkG8kSj7KoBDZcLk/Z+528ydV3glsGfGWTMYmjUp4kPhL2dvvYsN1SUoE44Uo0/6+AoWu6ZaTehUREdt/ftHRqqOKNolM3bVyqoEq0qpZ0MHU8L1Sz5Ut2i5ex6uZTqVDXFx5sjsQGMBKlOiqCgGGxA00mmdJdAD6dtPOuzxu9+ZAiLBmsJPgZuDEG8tSlL3WwXGHAArQZEHIBPLjxBn+ir6e4KoiDQh4MSQiwZNWs3YWkC3kyfUctktkYWaIKLG9261BC/GpXsV+lN7YsYRSWGFB/FCA8+i0lZuhVUcJed8pQASlN7SwK0FB1V5hMelMv5h73l4bBXaeTLhfSpBaXKnfPfqru6zuIYyG7WgIehGH27Ue1ltVtJNTkib8Rv/oeYopVcstJPwR8GBtqBe7Z9JYsDC0GvTxe2YvvEp2bQ5dvSnR3pCXXTWD3Bp3Pcn6PCYtXNnuHj8A/n8wyzYnxm8BPxOnO6ECOjdc9N6mkIkx8yX9c5ZML//RaNDnHO/dzuDH4m+/oqyqPwy5s28IcObVEkye10Q4XK7bfBQsq4IZ1K1nG34MmYc5EQpfpBZdjWIuQySMuBIjJP0kla2mlyxDm9Leuj6nWaiU7OlnnoVjEhF2N2J9UAyVK+GAV0xlrrkl0aQjWOVP63fg08VJ6mixVB3gvIVz0QKo1mqPv1QzmgGiacZsmsc5rDwBvO5XgLZEU5OAEQR80vHp/H6EdX0NAruVfsQU+X8y7o4AWexcM++EfH0Pol0qtlEz6d0w+NIiiGXE/1+lgYvs/coaprxzaSn+NQZYnfP9U15Mg0a/yLyvWqxXT6/8ZteVVpKJNv/jr+P5ZgcXX9iaasZzsrsgJPbYq3moFzxnq7iZMD0i4QDDQz402zh8F4c8qbDIUGJXcgQ3zhmDC9qSbfR8Z9qFCuGM0yOyahmtROhTZLotY/HEZEIrc0vx8aywViK/c5M82YbkDoTIysiySta9G2LSHUiDREPBo2wURRqaPverZ+F3lDinU4IAm0O6sukmRj/kLaYCAi+KeNL2XSrSe88rFxUifm7SSTjNwDhLKSBOHrOp9ptjo3fjqqnI8vc8NnUsZ5MJlbxaZDjUeb041EDjEL0fvtms1enVmHJGRAgGZpk2KafAqAPAMfiaTrsyNNWaePUY23ZqA145aQbHXgoDRyJeb2KjJwlIZLT4Vu+3H6rnF19HWTc+fuRY/17a+Ts3D4895/TzDp/iZcQn3fmmjlgack6sbbg7EYMSlKUKjB1MtWse3K9BaWbDUSr/XlImFt35V5aP84fL4ds2Hg8tPkTLE0aMstpb1wPBqYQEUM4ZOuKxHOWTAJK6GvQYPir3mFZF5x55b0c1gNM03lfgM8RIS7W4YxLRCGS8IfQXXu6HfarWvVZVyk4nTow4tVSmap5rtacr4Sye5VPKSOzAtYBS4zM1OG+fKLuvuUu6uzo30ZsW4g1V256Cnw6rt7y5y4ttEoUCrsHgvDTnqBVfJszICVdyFYwpvLci/kj6lM2bg+rdOTfZivl3In1ZIuR/rptXq064r5HRMSd2yVea6pjegX7Mwux8aspuRoBdNIQ0HT8FRsZhKgs5WURMip2SDev3dyiQsTGJlmfzrLgMulx3eSkmJx7LKrfkXPsArfLNdUiNpXov4N3ZIlppuiO0nMkYSerAjldb0MsyWVyJtmpA7yjoGZES76X6zPRtq1V4JEq/3IBq2WzBeZz3oj58fRCoK8plYfo6HS5XsWXbh9JqvJFQUaaW/uN+rB4/Cn+mBuXH7e77ktB6uWcf0Sj4UCzL9wTsj/sl7b/euJ2a2enkkaS0aFdLQOLSmhrikQmEIhRTzmS648o8J9fk4oyHHGs8dTeGKBgaP9yUsBTw8De5VSi9l/QesnBJpIkTv2owfzx8Xv2fa2udIGHVP+jh7QXlSrKZKKQsEpZYyFf70Vn8Q5aRS7n54nMzIVUZ+2yZpIZ+VDs+p65rNytgACjBCmoy8V5L6UAXbtYNn3yw+J960Q5NS12j8vXOrllpppOaZt+hseAQmvKK+K/T4u8n+6T4IPh5EsjJb68d7Wyc5V3ooDTm8oqTbstJEjEdA0Jk1anKUVXjEN93YvcZErzeW72F4dSBwKiPD3k4fz1oPOG1+xZh1UK81mdQUDyJ4biNEranEq8MI2WqZ1WUEGtuc0KyYsty7Ksxtm50ym0iWoIp4o0ClK2w6AsrQw8iJzQBWLzVezzH5nfNY+Y1vg13ctSpjneEqN5lurjRoW7KIqOmr3VGRmeujNI+SPIjK9+jGTC2RgekGKWaOEsZl1btyjabvjp5ebPbh0WVo+t1A0VrTJm5wIh2dRUzrpGdspWbJwfbRnolXkVzpWS6tSHdBkq1TOb2ViWP+6b1bZZbW/kNSF71Z0YOPiNqstKZtpr84HylI0nntLzDQImt/8BSf+MfxwRVroAAAAASUVORK5CYII=") var(--primaryColor);\n  background-size: 50px 50px;\n  background-blend-mode: overlay, normal, normal;\n  border: 2px solid rgba(255, 255, 255, 0.3);\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.4);\n  font-style: normal;\n  font-weight: 700;\n  font-size: 20px;\n  line-height: 150%;\n  pointer-events: auto;\n  animation-duration: 0.7s;\n  animation-timing-function: cubic-bezier(0.36, 0, 0, 1);\n  animation-fill-mode: both;\n  animation-name: cta-appear-anim;\n  animation-delay: 250ms;\n}\n.fullScreenControlContainer .cta-button .icon {\n  width: 22px;\n  height: 22px;\n  flex: none;\n  flex-grow: 0;\n}\n.fullScreenControlContainer .cta-button .icon .label {\n  /* Linkout Label */\n  width: 115px;\n  height: 30px;\n  display: flex;\n  align-items: flex-end;\n  text-align: center;\n  letter-spacing: -0.01em;\n  text-shadow: 0px 2px 4px rgba(0, 0, 0, 0.06), 0px 4px 6px rgba(0, 0, 0, 0.1);\n  flex: none;\n  flex-grow: 0;\n}\n.fullScreenControlContainer .cta-button .icon .svg {\n  position: absolute;\n  left: 12.5%;\n  right: 12.5%;\n  top: 12.5%;\n  bottom: 12.5%;\n}\n@media (max-width: 560px) {\n  .fullScreenControlContainer .left {\n    width: 40px;\n    height: 40px;\n    margin: 12px auto 12px 12px;\n  }\n  .fullScreenControlContainer .right {\n    margin: 12px 12px 12px auto;\n  }\n  .fullScreenControlContainer .right button.eko-button {\n    width: 40px;\n    height: 40px;\n  }\n  .fullScreenControlContainer .right button.eko-button .icon {\n    width: 16px;\n    height: 18px;\n  }\n  .fullScreenControlContainer .center {\n    margin: 8px 12px 12px;\n    white-space: normal;\n  }\n}');var QB=/^\s+/,ZB=/\s+$/;function JB(e,t){if(t=t||{},(e=e||"")instanceof JB)return e;if(!(this instanceof JB))return new JB(e,t);var n=function(e){var t={r:0,g:0,b:0},n=1,i=null,r=null,o=null,s=!1,a=!1;return"string"==typeof e&&(e=function(e){e=e.replace(QB,"").replace(ZB,"").toLowerCase();var t,n=!1;if(mU[e])e=mU[e],n=!0;else if("transparent"==e)return{r:0,g:0,b:0,a:0,format:"name"};return(t=IU.rgb.exec(e))?{r:t[1],g:t[2],b:t[3]}:(t=IU.rgba.exec(e))?{r:t[1],g:t[2],b:t[3],a:t[4]}:(t=IU.hsl.exec(e))?{h:t[1],s:t[2],l:t[3]}:(t=IU.hsla.exec(e))?{h:t[1],s:t[2],l:t[3],a:t[4]}:(t=IU.hsv.exec(e))?{h:t[1],s:t[2],v:t[3]}:(t=IU.hsva.exec(e))?{h:t[1],s:t[2],v:t[3],a:t[4]}:(t=IU.hex8.exec(e))?{r:kU(t[1]),g:kU(t[2]),b:kU(t[3]),a:_U(t[4]),format:n?"name":"hex8"}:(t=IU.hex6.exec(e))?{r:kU(t[1]),g:kU(t[2]),b:kU(t[3]),format:n?"name":"hex"}:(t=IU.hex4.exec(e))?{r:kU(t[1]+""+t[1]),g:kU(t[2]+""+t[2]),b:kU(t[3]+""+t[3]),a:_U(t[4]+""+t[4]),format:n?"name":"hex8"}:!!(t=IU.hex3.exec(e))&&{r:kU(t[1]+""+t[1]),g:kU(t[2]+""+t[2]),b:kU(t[3]+""+t[3]),format:n?"name":"hex"}}(e)),"object"==XB(e)&&(AU(e.r)&&AU(e.g)&&AU(e.b)?(t=function(e,t,n){return{r:255*bU(e,255),g:255*bU(t,255),b:255*bU(n,255)}}(e.r,e.g,e.b),s=!0,a="%"===String(e.r).substr(-1)?"prgb":"rgb"):AU(e.h)&&AU(e.s)&&AU(e.v)?(i=SU(e.s),r=SU(e.v),t=function(e,t,n){e=6*bU(e,360),t=bU(t,100),n=bU(n,100);var i=Math.floor(e),r=e-i,o=n*(1-t),s=n*(1-r*t),a=n*(1-(1-r)*t),l=i%6;return{r:255*[n,s,o,o,a,n][l],g:255*[a,n,n,s,o,o][l],b:255*[o,o,a,n,n,s][l]}}(e.h,i,r),s=!0,a="hsv"):AU(e.h)&&AU(e.s)&&AU(e.l)&&(i=SU(e.s),o=SU(e.l),t=function(e,t,n){var i,r,o;function s(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e}if(e=bU(e,360),t=bU(t,100),n=bU(n,100),0===t)i=r=o=n;else{var a=n<.5?n*(1+t):n+t-n*t,l=2*n-a;i=s(l,a,e+1/3),r=s(l,a,e),o=s(l,a,e-1/3)}return{r:255*i,g:255*r,b:255*o}}(e.h,i,o),s=!0,a="hsl"),e.hasOwnProperty("a")&&(n=e.a)),n=vU(n),{ok:s,format:e.format||a,r:Math.min(255,Math.max(t.r,0)),g:Math.min(255,Math.max(t.g,0)),b:Math.min(255,Math.max(t.b,0)),a:n}}(e);this._originalInput=e,this._r=n.r,this._g=n.g,this._b=n.b,this._a=n.a,this._roundA=Math.round(100*this._a)/100,this._format=t.format||n.format,this._gradientType=t.gradientType,this._r<1&&(this._r=Math.round(this._r)),this._g<1&&(this._g=Math.round(this._g)),this._b<1&&(this._b=Math.round(this._b)),this._ok=n.ok}function eU(e,t,n){e=bU(e,255),t=bU(t,255),n=bU(n,255);var i,r,o=Math.max(e,t,n),s=Math.min(e,t,n),a=(o+s)/2;if(o==s)i=r=0;else{var l=o-s;switch(r=a>.5?l/(2-o-s):l/(o+s),o){case e:i=(t-n)/l+(t<n?6:0);break;case t:i=(n-e)/l+2;break;case n:i=(e-t)/l+4}i/=6}return{h:i,s:r,l:a}}function tU(e,t,n){e=bU(e,255),t=bU(t,255),n=bU(n,255);var i,r,o=Math.max(e,t,n),s=Math.min(e,t,n),a=o,l=o-s;if(r=0===o?0:l/o,o==s)i=0;else{switch(o){case e:i=(t-n)/l+(t<n?6:0);break;case t:i=(n-e)/l+2;break;case n:i=(e-t)/l+4}i/=6}return{h:i,s:r,v:a}}function nU(e,t,n,i){var r=[xU(Math.round(e).toString(16)),xU(Math.round(t).toString(16)),xU(Math.round(n).toString(16))];return i&&r[0].charAt(0)==r[0].charAt(1)&&r[1].charAt(0)==r[1].charAt(1)&&r[2].charAt(0)==r[2].charAt(1)?r[0].charAt(0)+r[1].charAt(0)+r[2].charAt(0):r.join("")}function iU(e,t,n,i){return[xU(CU(i)),xU(Math.round(e).toString(16)),xU(Math.round(t).toString(16)),xU(Math.round(n).toString(16))].join("")}function rU(e,t){t=0===t?0:t||10;var n=JB(e).toHsl();return n.s-=t/100,n.s=wU(n.s),JB(n)}function oU(e,t){t=0===t?0:t||10;var n=JB(e).toHsl();return n.s+=t/100,n.s=wU(n.s),JB(n)}function sU(e){return JB(e).desaturate(100)}function aU(e,t){t=0===t?0:t||10;var n=JB(e).toHsl();return n.l+=t/100,n.l=wU(n.l),JB(n)}function lU(e,t){t=0===t?0:t||10;var n=JB(e).toRgb();return n.r=Math.max(0,Math.min(255,n.r-Math.round(-t/100*255))),n.g=Math.max(0,Math.min(255,n.g-Math.round(-t/100*255))),n.b=Math.max(0,Math.min(255,n.b-Math.round(-t/100*255))),JB(n)}function cU(e,t){t=0===t?0:t||10;var n=JB(e).toHsl();return n.l-=t/100,n.l=wU(n.l),JB(n)}function uU(e,t){var n=JB(e).toHsl(),i=(n.h+t)%360;return n.h=i<0?360+i:i,JB(n)}function dU(e){var t=JB(e).toHsl();return t.h=(t.h+180)%360,JB(t)}function hU(e,t){if(isNaN(t)||t<=0)throw new Error("Argument to polyad must be a positive number");for(var n=JB(e).toHsl(),i=[JB(e)],r=360/t,o=1;o<t;o++)i.push(JB({h:(n.h+o*r)%360,s:n.s,l:n.l}));return i}function pU(e){var t=JB(e).toHsl(),n=t.h;return[JB(e),JB({h:(n+72)%360,s:t.s,l:t.l}),JB({h:(n+216)%360,s:t.s,l:t.l})]}function fU(e,t,n){t=t||6,n=n||30;var i=JB(e).toHsl(),r=360/n,o=[JB(e)];for(i.h=(i.h-(r*t>>1)+720)%360;--t;)i.h=(i.h+r)%360,o.push(JB(i));return o}function gU(e,t){t=t||6;for(var n=JB(e).toHsv(),i=n.h,r=n.s,o=n.v,s=[],a=1/t;t--;)s.push(JB({h:i,s:r,v:o})),o=(o+a)%1;return s}JB.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var e=this.toRgb();return(299*e.r+587*e.g+114*e.b)/1e3},getLuminance:function(){var e,t,n,i=this.toRgb();return t=i.g/255,n=i.b/255,.2126*((e=i.r/255)<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4))+.7152*(t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4))+.0722*(n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4))},setAlpha:function(e){return this._a=vU(e),this._roundA=Math.round(100*this._a)/100,this},toHsv:function(){var e=tU(this._r,this._g,this._b);return{h:360*e.h,s:e.s,v:e.v,a:this._a}},toHsvString:function(){var e=tU(this._r,this._g,this._b),t=Math.round(360*e.h),n=Math.round(100*e.s),i=Math.round(100*e.v);return 1==this._a?"hsv("+t+", "+n+"%, "+i+"%)":"hsva("+t+", "+n+"%, "+i+"%, "+this._roundA+")"},toHsl:function(){var e=eU(this._r,this._g,this._b);return{h:360*e.h,s:e.s,l:e.l,a:this._a}},toHslString:function(){var e=eU(this._r,this._g,this._b),t=Math.round(360*e.h),n=Math.round(100*e.s),i=Math.round(100*e.l);return 1==this._a?"hsl("+t+", "+n+"%, "+i+"%)":"hsla("+t+", "+n+"%, "+i+"%, "+this._roundA+")"},toHex:function(e){return nU(this._r,this._g,this._b,e)},toHexString:function(e){return"#"+this.toHex(e)},toHex8:function(e){return function(e,t,n,i,r){var o=[xU(Math.round(e).toString(16)),xU(Math.round(t).toString(16)),xU(Math.round(n).toString(16)),xU(CU(i))];return r&&o[0].charAt(0)==o[0].charAt(1)&&o[1].charAt(0)==o[1].charAt(1)&&o[2].charAt(0)==o[2].charAt(1)&&o[3].charAt(0)==o[3].charAt(1)?o[0].charAt(0)+o[1].charAt(0)+o[2].charAt(0)+o[3].charAt(0):o.join("")}(this._r,this._g,this._b,this._a,e)},toHex8String:function(e){return"#"+this.toHex8(e)},toRgb:function(){return{r:Math.round(this._r),g:Math.round(this._g),b:Math.round(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+")":"rgba("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:Math.round(100*bU(this._r,255))+"%",g:Math.round(100*bU(this._g,255))+"%",b:Math.round(100*bU(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+Math.round(100*bU(this._r,255))+"%, "+Math.round(100*bU(this._g,255))+"%, "+Math.round(100*bU(this._b,255))+"%)":"rgba("+Math.round(100*bU(this._r,255))+"%, "+Math.round(100*bU(this._g,255))+"%, "+Math.round(100*bU(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":!(this._a<1)&&(yU[nU(this._r,this._g,this._b,!0)]||!1)},toFilter:function(e){var t="#"+iU(this._r,this._g,this._b,this._a),n=t,i=this._gradientType?"GradientType = 1, ":"";if(e){var r=JB(e);n="#"+iU(r._r,r._g,r._b,r._a)}return"progid:DXImageTransform.Microsoft.gradient("+i+"startColorstr="+t+",endColorstr="+n+")"},toString:function(e){var t=!!e;e=e||this._format;var n=!1;return t||!(this._a<1&&this._a>=0)||"hex"!==e&&"hex6"!==e&&"hex3"!==e&&"hex4"!==e&&"hex8"!==e&&"name"!==e?("rgb"===e&&(n=this.toRgbString()),"prgb"===e&&(n=this.toPercentageRgbString()),"hex"!==e&&"hex6"!==e||(n=this.toHexString()),"hex3"===e&&(n=this.toHexString(!0)),"hex4"===e&&(n=this.toHex8String(!0)),"hex8"===e&&(n=this.toHex8String()),"name"===e&&(n=this.toName()),"hsl"===e&&(n=this.toHslString()),"hsv"===e&&(n=this.toHsvString()),n||this.toHexString()):"name"===e&&0===this._a?this.toName():this.toRgbString()},clone:function(){return JB(this.toString())},_applyModification:function(e,t){var n=e.apply(null,[this].concat([].slice.call(t)));return this._r=n._r,this._g=n._g,this._b=n._b,this.setAlpha(n._a),this},lighten:function(){return this._applyModification(aU,arguments)},brighten:function(){return this._applyModification(lU,arguments)},darken:function(){return this._applyModification(cU,arguments)},desaturate:function(){return this._applyModification(rU,arguments)},saturate:function(){return this._applyModification(oU,arguments)},greyscale:function(){return this._applyModification(sU,arguments)},spin:function(){return this._applyModification(uU,arguments)},_applyCombination:function(e,t){return e.apply(null,[this].concat([].slice.call(t)))},analogous:function(){return this._applyCombination(fU,arguments)},complement:function(){return this._applyCombination(dU,arguments)},monochromatic:function(){return this._applyCombination(gU,arguments)},splitcomplement:function(){return this._applyCombination(pU,arguments)},triad:function(){return this._applyCombination(hU,[3])},tetrad:function(){return this._applyCombination(hU,[4])}},JB.fromRatio=function(e,t){if("object"==XB(e)){var n={};for(var i in e)e.hasOwnProperty(i)&&(n[i]="a"===i?e[i]:SU(e[i]));e=n}return JB(e,t)},JB.equals=function(e,t){return!(!e||!t)&&JB(e).toRgbString()==JB(t).toRgbString()},JB.random=function(){return JB.fromRatio({r:Math.random(),g:Math.random(),b:Math.random()})},JB.mix=function(e,t,n){n=0===n?0:n||50;var i=JB(e).toRgb(),r=JB(t).toRgb(),o=n/100;return JB({r:(r.r-i.r)*o+i.r,g:(r.g-i.g)*o+i.g,b:(r.b-i.b)*o+i.b,a:(r.a-i.a)*o+i.a})},JB.readability=function(e,t){var n=JB(e),i=JB(t);return(Math.max(n.getLuminance(),i.getLuminance())+.05)/(Math.min(n.getLuminance(),i.getLuminance())+.05)},JB.isReadable=function(e,t,n){var i,r,o,s,a,l=JB.readability(e,t);switch(r=!1,(o=n,"AA"!==(s=((o=o||{level:"AA",size:"small"}).level||"AA").toUpperCase())&&"AAA"!==s&&(s="AA"),"small"!==(a=(o.size||"small").toLowerCase())&&"large"!==a&&(a="small"),i={level:s,size:a}).level+i.size){case"AAsmall":case"AAAlarge":r=l>=4.5;break;case"AAlarge":r=l>=3;break;case"AAAsmall":r=l>=7}return r},JB.mostReadable=function(e,t,n){var i,r,o,s,a=null,l=0;r=(n=n||{}).includeFallbackColors,o=n.level,s=n.size;for(var c=0;c<t.length;c++)(i=JB.readability(e,t[c]))>l&&(l=i,a=JB(t[c]));return JB.isReadable(e,a,{level:o,size:s})||!r?a:(n.includeFallbackColors=!1,JB.mostReadable(e,["#fff","#000"],n))};var mU=JB.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},yU=JB.hexNames=function(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[e[n]]=n);return t}(mU);function vU(e){return e=parseFloat(e),(isNaN(e)||e<0||e>1)&&(e=1),e}function bU(e,t){(function(e){return"string"==typeof e&&-1!=e.indexOf(".")&&1===parseFloat(e)})(e)&&(e="100%");var n=function(e){return"string"==typeof e&&-1!=e.indexOf("%")}(e);return e=Math.min(t,Math.max(0,parseFloat(e))),n&&(e=parseInt(e*t,10)/100),Math.abs(e-t)<1e-6?1:e%t/parseFloat(t)}function wU(e){return Math.min(1,Math.max(0,e))}function kU(e){return parseInt(e,16)}function xU(e){return 1==e.length?"0"+e:""+e}function SU(e){return e<=1&&(e=100*e+"%"),e}function CU(e){return Math.round(255*parseFloat(e)).toString(16)}function _U(e){return kU(e)/255}var EU,TU,PU,IU=(TU="[\\s|\\(]+("+(EU="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)")+")[,|\\s]+("+EU+")[,|\\s]+("+EU+")\\s*\\)?",PU="[\\s|\\(]+("+EU+")[,|\\s]+("+EU+")[,|\\s]+("+EU+")[,|\\s]+("+EU+")\\s*\\)?",{CSS_UNIT:new RegExp(EU),rgb:new RegExp("rgb"+TU),rgba:new RegExp("rgba"+PU),hsl:new RegExp("hsl"+TU),hsla:new RegExp("hsla"+PU),hsv:new RegExp("hsv"+TU),hsva:new RegExp("hsva"+PU),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/});function AU(e){return!!IU.CSS_UNIT.exec(e)}function OU(e,t){const n=JB(e).getBrightness()>125?"black":"white";let i,r={};return r["--textColor"]=e,t?(r["--textColorContrast"]=n,i=["useTextContrast"]):(r["--textColorContrast"]="black"===JB(e).toName()?"#ffffff45":"#00000045",i=["useShadowContrast"]),[r,i]}By(".bp-vertical-small {\n  --gizmoPadding: 16px;\n  --navigationHeight: 5.2em;\n  font-size: 12px;\n  line-height: 14px;\n}\n\n.bp-vertical-medium {\n  --gizmoPadding: 24px;\n  --navigationHeight: 5.2em;\n  font-size: 16px;\n  line-height: 17px;\n}\n\n.fullscreenPage {\n  display: flex;\n  flex-direction: column;\n  padding: 12px;\n  width: 100%;\n  margin: 0;\n  text-align: center;\n  box-sizing: border-box;\n  min-height: calc(var(--viewportHeight, 100vh) - 2px);\n  min-height: 100svh;\n  overflow: hidden;\n  justify-content: space-between;\n}\n@media (max-width: 280px) {\n  .fullscreenPage {\n    padding: 8px;\n  }\n}\n.fullscreenPage .fullscreenPage-content {\n  display: flex;\n  flex-grow: 1;\n  flex-direction: column;\n  justify-content: flex-end;\n  align-items: center;\n  gap: 12px;\n  margin-top: 55px;\n}\n.fullscreenPage .fullscreenPage-content.interfacePosition-Center {\n  justify-content: center;\n  padding: 2px 3px 1px;\n}\n.fullscreenPage .logoContainer {\n  width: fit-content;\n  height: fit-content;\n}\n.fullscreenPage .logoContainer .logo {\n  max-width: 100px;\n  max-height: 100px;\n}\n@media (max-width: 370px) {\n  .fullscreenPage .logoContainer .logo {\n    max-height: 48px;\n    max-width: 96px;\n  }\n}\n.fullscreenPage .title {\n  max-width: 480px;\n  font-family: var(--fontName);\n  font-size: 24px;\n  font-weight: 700;\n  line-height: 125%;\n  margin: 16px 0 8px 0;\n  animation-duration: 0.65s;\n  animation-timing-function: cubic-bezier(0, 0.5, 0, 1);\n  animation-delay: 40ms;\n  animation-fill-mode: both;\n  animation-name: button-text-appear-anim;\n}\n@media (max-width: 370px) {\n  .fullscreenPage .title {\n    font-size: 20px;\n    line-height: 25px;\n    margin-bottom: 8px;\n    margin-top: 8px;\n  }\n}\n@media (max-width: 560px) {\n  .fullscreenPage .title {\n    font-size: 24px;\n    line-height: 30px;\n  }\n}\n@media (min-width: 1440px) {\n  .fullscreenPage .title {\n    font-size: 28px;\n    line-height: 35px;\n  }\n}\n.fullscreenPage .description {\n  font-size: 16px;\n  font-weight: normal;\n  max-width: 480px;\n  font-family: var(--fontName);\n  line-height: 150%;\n  margin: 0;\n  animation-duration: 0.65s;\n  animation-timing-function: cubic-bezier(0, 0.5, 0, 1);\n  animation-delay: 80ms;\n  animation-fill-mode: both;\n  animation-name: button-text-appear-anim;\n}\n@media (max-width: 370px) {\n  .fullscreenPage .description {\n    font-size: 14px;\n    line-height: 21px;\n  }\n}\n@media (max-width: 560px) {\n  .fullscreenPage .description {\n    font-size: 16px;\n    line-height: 24px;\n  }\n}\n@media (min-width: 1440px) {\n  .fullscreenPage .description {\n    font-size: 20px;\n    line-height: 30px;\n  }\n}\n.fullscreenPage .fullscreenPage-bottomNavigation {\n  display: flex;\n  width: 100%;\n  justify-content: end;\n}\n@media (max-width: 560px) {\n  .fullscreenPage .fullscreenPage-bottomNavigation {\n    justify-content: center;\n  }\n}\n.fullscreenPage .fullscreenPage-bottomNavigation .skipButton {\n  box-sizing: border-box;\n  display: flex;\n  flex-direction: row;\n  justify-content: center;\n  align-items: center;\n  gap: 8px;\n  width: fit-content;\n  height: 52px;\n  max-width: 168px;\n  border: 1px solid rgba(0, 0, 0, 0.2);\n  box-shadow: 0 2px 16px rgba(0, 0, 0, 0.08), 0 4px 8px rgba(0, 0, 0, 0.08);\n  margin: 28px 8px 28px 0;\n  padding: 25px 20px 25px 20px;\n}\n@media (max-width: 560px) {\n  .fullscreenPage .fullscreenPage-bottomNavigation .skipButton {\n    margin-right: 0;\n  }\n}\n.fullscreenPage .fullscreenPage-bottomNavigation .skipButton .icon {\n  /* tw-chevron-double-right-filled */\n  width: 16px;\n  height: 16px;\n  /* Inside auto layout */\n  flex: none;\n  order: 1;\n  flex-grow: 0;\n}\n.fullscreenPage .fullscreenPage-bottomNavigation .skipButton .label {\n  width: fit-content;\n  height: 16px;\n  font-style: normal;\n  font-weight: 700;\n  font-size: 16px;\n  line-height: 100%;\n  /* identical to box height, or 16px */\n  display: flex;\n  align-items: center;\n  text-align: center;\n  /* Inside auto layout */\n  flex: none;\n  order: 0;\n  flex-grow: 0;\n  margin-right: 0;\n}\n.fullscreenPage .title, .fullscreenPage .description {\n  color: var(--textColor);\n}\n.useTextContrast .fullscreenPage .title, .useTextContrast .fullscreenPage .description {\n  text-shadow: -2px -2px 2px var(--textColorContrast), -2px -1px 2px var(--textColorContrast), -2px 0px 2px var(--textColorContrast), -2px 1px 2px var(--textColorContrast), -2px 2px 2px var(--textColorContrast), -1px -2px 2px var(--textColorContrast), -1px -1px 2px var(--textColorContrast), -1px 0px 2px var(--textColorContrast), -1px 1px 2px var(--textColorContrast), -1px 2px 2px var(--textColorContrast), 0px -2px 2px var(--textColorContrast), 0px -1px 2px var(--textColorContrast), 0px 0px 2px var(--textColorContrast), 0px 1px 2px var(--textColorContrast), 0px 2px 2px var(--textColorContrast), 1px -2px 2px var(--textColorContrast), 1px -1px 2px var(--textColorContrast), 1px 0px 2px var(--textColorContrast), 1px 1px 2px var(--textColorContrast), 1px 2px 2px var(--textColorContrast), 2px -2px 2px var(--textColorContrast), 2px -1px 2px var(--textColorContrast), 2px 0px 2px var(--textColorContrast), 2px 1px 2px var(--textColorContrast), 2px 2px 2px var(--textColorContrast), 0px 1px 4px rgba(0, 0, 0, 0.6);\n}\n.useShadowContrast .fullscreenPage .title, .useShadowContrast .fullscreenPage .description {\n  text-shadow: 0px 0px 30px var(--textColorContrast);\n}");const LU="Skip";function NU(e){const{buttonTextColor:t,buttonBackgroundColor:n,buttonShape:i,logo:r,title:o,description:s,showSkipButton:a,skipButtonLabel:l=LU,onClickSkip:c,label:u}=e;let d=["fullscreenPage",`buttonShape-${i}`].join(" ");return React.createElement("div",{className:d},React.createElement("section",Ja({},u?{"aria-label":u}:{},{className:`fullscreenPage-content interfacePosition-${e.interfacePosition}`}),r&&React.createElement("div",{className:"logoContainer"},React.createElement("img",{className:"logo",src:r,alt:"logo"})),o&&React.createElement("div",{className:"title"},o),s&&React.createElement(CD,{className:"description",text:s}),e.children),React.createElement("div",{className:"fullscreenPage-bottomNavigation"},a&&React.createElement(yD,{label:l,iconPosition:"right",icon:"chevronDoubleRight",shape:i,primaryColor:t,secondaryColor:n,className:"skipButton",onClick:e=>{e.stopPropagation(),c(e)}})))}function RU(e){const{isMobile:t}=e;return Ig.createElement("div",{className:"button-motivator"},Ig.createElement("p",null,t?"Tap":"Click"," button to interact"))}By(".bp-vertical-small {\n  --gizmoPadding: 16px;\n  --navigationHeight: 5.2em;\n  font-size: 12px;\n  line-height: 14px;\n}\n\n.bp-vertical-medium {\n  --gizmoPadding: 24px;\n  --navigationHeight: 5.2em;\n  font-size: 16px;\n  line-height: 17px;\n}\n\n.fullScreenIntroContainer {\n  width: 100%;\n}\n.fullScreenIntroContainer .buttonContainer {\n  position: relative;\n  width: fit-content;\n  padding-top: 12px;\n  font-size: min(var(--startButtonMaxFontSize, 28pt), 28pt);\n}\n@media (max-width: 560px) {\n  .fullScreenIntroContainer .buttonContainer {\n    font-size: min(var(--startButtonMaxFontSize, 22pt), 22pt);\n    max-width: calc(100% - 32px);\n  }\n}\n@media (max-width: 280px) {\n  .fullScreenIntroContainer .buttonContainer {\n    max-width: calc(100% - 40px);\n  }\n}\n.fullScreenIntroContainer button {\n  width: 100%;\n  height: 100%;\n  cursor: pointer;\n  background-color: transparent;\n  border: 0;\n  font-weight: bold;\n  font-size: inherit;\n}\n.fullScreenIntroContainer .tryIt {\n  position: relative;\n  width: auto;\n  min-width: 200px;\n  letter-spacing: 2px;\n  padding: 20px 40px;\n  box-shadow: 0 0 60px 0 rgba(0, 0, 0, 0.6901960784);\n  font-family: var(--fontName);\n  animation: bump 2s ease-out infinite;\n}\n.fullScreenIntroContainer .tryIt.buttonShape-pill, .fullScreenIntroContainer .tryIt.buttonShape-pill .ripple {\n  border-radius: 3em;\n}\n.fullScreenIntroContainer .tryIt.buttonShape-rounded, .fullScreenIntroContainer .tryIt.buttonShape-rounded .ripple {\n  border-radius: 8px;\n}\n.fullScreenIntroContainer .tryIt.buttonShape-square, .fullScreenIntroContainer .tryIt.buttonShape-square .ripple {\n  border-radius: 0;\n}\n@media (max-width: 280px) {\n  .fullScreenIntroContainer .tryIt {\n    margin: 0 12px 32px;\n  }\n}\n@media (max-width: 560px) {\n  .fullScreenIntroContainer .tryIt {\n    padding: 18px 32px;\n  }\n}\n@keyframes bump {\n  0% {\n    transform: scale(1);\n  }\n  5% {\n    transform: scale(1);\n  }\n  10% {\n    transform: scale(0.8);\n  }\n  20% {\n    transform: scale(1);\n  }\n}\n.fullScreenIntroContainer .handAnim-false .tryIt {\n  animation: none;\n}\n.fullScreenIntroContainer .handAnim-false .handAnim,\n.fullScreenIntroContainer .handAnim-false .ripple {\n  display: none;\n}\n.fullScreenIntroContainer .tryIt .ripple {\n  position: absolute;\n  width: calc(100% - 12px);\n  height: calc(100% - 12px);\n  pointer-events: none;\n  top: 0;\n  left: 0;\n  border: 6px solid;\n  animation: ripple 2s cubic-bezier(0.32, 0.33, 0.08, 1) infinite;\n}\n@keyframes ripple {\n  0% {\n    transform: translateX(0) translateY(0);\n    width: calc(100% - 12px);\n    height: calc(100% - 12px);\n    opacity: 1;\n  }\n  20% {\n    opacity: 1;\n  }\n  60% {\n    transform: translateX(-57px) translateY(-42px);\n    width: calc(100% + 102px);\n    height: calc(100% + 72px);\n    opacity: 0;\n  }\n  100% {\n    opacity: 0;\n  }\n}\n.fullScreenIntroContainer .handContainer {\n  position: absolute;\n  right: -2em;\n  top: 0.9em;\n  width: 2.2em;\n  aspect-ratio: 8/10;\n}\n.fullScreenIntroContainer .handAnim {\n  position: absolute;\n  transform-origin: 70px 100px;\n  animation: handAnim 2s cubic-bezier(0.32, 0.33, 0.08, 1) infinite;\n  pointer-events: none;\n}\n.fullScreenIntroContainer .handAnim svg {\n  width: 64px;\n  height: 80px;\n}\n@media (max-width: 560px) {\n  .fullScreenIntroContainer .handAnim svg {\n    width: 36px;\n    height: 45px;\n  }\n}\n@keyframes handAnim {\n  0% {\n    transform: translateX(0) translateY(0) rotate(0) scale(1);\n  }\n  10% {\n    transform: translateX(-10px) translateY(-20px) rotate(-40deg) scale(0.9);\n  }\n  35% {\n    transform: translateX(0) translateY(0) rotate(15deg) scale(1);\n  }\n  100% {\n    transform: translateX(0) translateY(0) rotate(0) scale(1);\n  }\n}\n@media (max-width: 560px) {\n  .fullScreenIntroContainer .handContainer {\n    right: -1.2em;\n    top: 1.4em;\n    width: 1.5em;\n  }\n  @keyframes handAnim {\n    0% {\n      transform: translateX(0) translateY(0) rotate(0) scale(1);\n    }\n    10% {\n      transform: translateX(-6px) translateY(-15px) rotate(-25deg) scale(0.9);\n    }\n    35% {\n      transform: translateX(0) translateY(0) rotate(7deg) scale(1);\n    }\n    100% {\n      transform: translateX(0) translateY(0) rotate(0) scale(1);\n    }\n  }\n}\n.fullScreenIntroContainer .interfacePosition-Bottom .tryIt {\n  margin-bottom: 32px;\n}\n.fullScreenIntroContainer.paused .handAnim, .fullScreenIntroContainer.paused .tryIt, .fullScreenIntroContainer.paused .tryIt .ripple {\n  animation-play-state: paused;\n}"),By('.bp-vertical-small {\n  --gizmoPadding: 16px;\n  --navigationHeight: 5.2em;\n  font-size: 12px;\n  line-height: 14px;\n}\n\n.bp-vertical-medium {\n  --gizmoPadding: 24px;\n  --navigationHeight: 5.2em;\n  font-size: 16px;\n  line-height: 17px;\n}\n\n.button-motivator {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  gap: 16px;\n  letter-spacing: 1px;\n  white-space: nowrap;\n  position: absolute;\n  top: -12px;\n  left: 50%;\n  padding: 8px 12px;\n  background-color: #FFFFFF;\n  border-radius: 6px;\n  transform: translate(-50%, -20px);\n  box-shadow: 0px 0px 16px -2px rgba(27, 33, 44, 0.1215686275);\n  opacity: 0;\n  z-index: 1;\n  animation: fadeInMoveMotivator 4s 0.1s infinite;\n}\n@media (max-width: 280px) {\n  .button-motivator {\n    display: none;\n  }\n}\n@media (max-height: 330px) {\n  .button-motivator {\n    display: none;\n  }\n}\n.button-motivator p {\n  max-width: 220px;\n  margin: 0;\n  color: #000000;\n  font-size: 12px;\n  line-height: 16px;\n}\n.button-motivator::after {\n  content: "";\n  position: absolute;\n  top: 100%;\n  left: 50%;\n  transform: translateX(-50%);\n  border-width: 6px;\n  border-style: solid;\n  border-color: #FFFFFF transparent transparent transparent;\n}\n\n@keyframes fadeInMoveMotivator {\n  0% {\n    opacity: 0;\n  }\n  20% {\n    opacity: 1;\n  }\n  80% {\n    opacity: 1;\n  }\n  100% {\n    opacity: 0;\n  }\n}');let DU={pdp:"pdp",default:Ig.memo(NU)};var MU={displayName:"Full Screen Intro",blockFamily:"intros",description:"A looping full-screen video that plays until the viewer clicks the button.",previewVideo:"https://res.cloudinary.com/dlkxfitke/video/upload/v1667484140/randy/intro-fullscreen.mp4",helpLink:"https://help.eko.com/what-is-a-full-screen-intro-block",variables:[],integrationFeatures:[]},FU=new WeakMap,BU=new WeakSet;class UU{constructor(e,t,n){return nl(this,BU),tl(this,FU,void 0),this.id=e,this.type=UU.type,this.blockConfig=t,this.ctx=n,this.player=n.player,this.theme=JA.get(),Xa(FU,this,Ya(BU,this,jU).call(this)),Ya(BU,this,zU).call(this),pI(this),Ka(FU,this).loop.on("nodestart",(()=>{this.introUiProps.set(Ya(BU,this,VU).call(this))})),this.registerEmbedApiHandlers(),this.onStarted(),{id:this.id,type:this.type,metadata:MU,getHead:this.getHead,getEnds:this.getEnds,getUi:this.getUi,onStarted:this.onStarted}}registerEmbedApiHandlers(){XI.registerBlockHandler(this.id,"endBlock",(({immediate:e})=>{this.ctx.done({immediate:e})}))}onStarted(){this.introUiProps=WB(Ya(BU,this,VU).call(this))}getHead(){return Ka(FU,this).intro||Ka(FU,this).loop}getEnds(){return[Ka(FU,this).loop]}getUi(){return{layoutOptions:{component:KD.FULLSCREEN},gizmos:{topBar:Ya(BU,this,WU).call(this),main:(e=this,function(t){var n,i;let r={...t,...e.introUiProps.hook()},[o]=qB.selectGizmoVariant(e,DU),[s,a]=OU(r.bodyTextColor,r.textOutline),l=null===(n=r.theme.button)||void 0===n?void 0:n.maxFontSize,c=!1===e.player.reduxStore.getState().environment.isDesktop,u={...s,...l&&{"--startButtonMaxFontSize":`${l}pt`}};const d=e.player.ui.useSelector((e=>e.player.isPaused)),h=d||r.fullScreenLayoutProps.prepauseActive;let p=["fullScreenIntroContainer",...a,...d?["paused"]:[]].join(" "),f={backgroundColor:r.buttonBackgroundColor,color:r.buttonTextColor,...null===(i=r.theme.button)||void 0===i?void 0:i.style};return Ig.createElement("div",{className:p,style:u},Ig.createElement(o,{interfacePosition:r.interfacePosition,logo:r.logo,title:r.title,description:r.description,buttonTextColor:r.buttonTextColor,buttonBackgroundColor:r.buttonBackgroundColor,buttonShape:r.buttonShape},Ig.createElement("div",{className:`buttonContainer handAnim-${r.animatedHand}`},h&&Ig.createElement(RU,{isMobile:c}),Ig.createElement("button",{className:`tryIt buttonShape-${r.buttonShape}`,style:f,onClick:r.onClick},r.label,Ig.createElement("div",{className:"ripple",style:{borderColor:r.buttonBackgroundColor}})),Ig.createElement("div",{className:"handContainer"},Ig.createElement("div",{className:"handAnim"},Ig.createElement("svg",{width:"518",height:"658",viewBox:"0 0 518 658",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Ig.createElement("path",{d:"M139.234 341.909V67.9226C139.234 53.292 145.203 40.0053 154.838 30.3866C175.516 9.69329 209.234 9.70929 229.912 30.3866C239.547 40.0064 245.516 53.288 245.516 67.9226V148.699C254.536 141.662 265.854 137.454 278.13 137.454C292.745 137.454 306.048 143.443 315.666 153.058C325.302 162.693 331.27 175.979 331.27 190.61V194.146C340.291 187.11 351.609 182.901 363.885 182.901C378.499 182.901 391.802 188.891 401.421 198.505C409.785 206.87 415.38 217.984 416.728 230.333C425.785 223.146 437.238 218.844 449.623 218.844C464.254 218.844 477.541 224.833 487.175 234.448C496.795 244.083 502.779 257.369 502.779 272V412.373C502.779 438.608 503.92 455.092 498.212 481.513C493.831 501.664 487.134 519.816 479.54 537.461C462.846 576.289 432.461 604.503 395.878 622.055C367.378 635.732 335.086 642.883 302.638 643.461C270.174 644.039 237.502 638.07 208.258 625.477C169.898 608.972 137.285 581.128 118.425 541.8C105.477 514.816 90.6385 488.097 75.9878 461.753C55.6131 425.06 35.5918 389.018 20.8838 352.665C15.8316 340.165 13.6234 326.692 15.889 314.4C20.6598 288.373 45.5823 272.597 71.217 277.296C83.6806 279.598 95.4463 286.598 103.925 297.301L139.234 341.909Z",fill:"white"}),Ig.createElement("path",{d:"M244.917 166V269M330.917 201V305M419.917 246V326M139.234 341.909V67.9226C139.234 53.292 145.203 40.0053 154.838 30.3866C175.516 9.69329 209.234 9.70929 229.912 30.3866C239.547 40.0064 245.516 53.288 245.516 67.9226V148.699C254.536 141.662 265.854 137.454 278.13 137.454C292.745 137.454 306.048 143.443 315.666 153.058C325.302 162.693 331.27 175.979 331.27 190.61V194.146C340.291 187.11 351.609 182.901 363.885 182.901C378.499 182.901 391.802 188.891 401.421 198.505C409.785 206.87 415.38 217.984 416.728 230.333C425.785 223.146 437.238 218.844 449.623 218.844C464.254 218.844 477.541 224.833 487.175 234.448C496.795 244.083 502.779 257.369 502.779 272V412.373C502.779 438.608 503.92 455.092 498.212 481.513C493.831 501.664 487.134 519.816 479.54 537.461C462.846 576.289 432.461 604.503 395.878 622.055C367.378 635.732 335.086 642.883 302.638 643.461C270.174 644.039 237.502 638.07 208.258 625.477C169.898 608.972 137.285 581.128 118.425 541.8C105.477 514.816 90.6385 488.097 75.9878 461.753C55.6131 425.06 35.5918 389.018 20.8838 352.665C15.8316 340.165 13.6234 326.692 15.889 314.4C20.6598 288.373 45.5823 272.597 71.217 277.296C83.6806 279.598 95.4463 286.598 103.925 297.301L139.234 341.909Z",stroke:"black",strokeWidth:"29",strokeLinecap:"round"})))))))})},uiPropsHooks:{main:this.introUiProps.hook}};var e}}function jU(){let e={};return e.loop=HI.create(`${this.id}_loop`,this.blockConfig.video),e.intro=this.blockConfig.intro&&HI.create(`${this.id}_intro`,this.blockConfig.intro),e}function zU(){Ka(FU,this).intro&&(qB.connectNodes(Ka(FU,this).intro,Ka(FU,this).loop,this.ctx),Ka(FU,this).intro.addPrefetch(Ka(FU,this).loop)),qB.makeNodeLoop(Ka(FU,this).loop,this.ctx)}function VU(){return{title:this.blockConfig.title,description:this.blockConfig.description,label:this.blockConfig.buttonText,animatedHand:this.blockConfig.animatedHand,interfacePosition:this.blockConfig.interfacePosition,...JA.blockUIPropsTransformer(this.blockConfig,qB.DEFAULT_BLOCK_REQUIRED_PROPS),theme:this.theme,onClick:e=>qB.onClickWrapper((()=>{e.stopPropagation(),this.ctx.done({immediate:!0})}),{element:{elementname:this.blockConfig.buttonText,elementtype:TA.elementTypes.START,elementid:`${this.id}-loop-button`}},this.ctx)}}function WU(){return KB(this)}Za(UU,"type","FullScreenIntro");var HU=Object.freeze({__proto__:null,default:UU});function $U(e,t,n,i){return new ML(0,0,e,t,n,i,1,1)}By(".gestureSwitcherContainer {\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  touch-action: pan-y;\n}");let GU=$U(0,.32,.07,1),qU=$U(.65,0,0,1);function YU(e,t,n){return Math.min(n,Math.max(t,e))}function KU(e){const t=e.gestureParameters||{},n=t.swipeVelocityThreshold||.4,i=t.swipeMinDistance||2;return Ig.createElement(DD,{enableGestures:!0,withGestures:function({useGestureModule:t}){var r,o;let[s,a]=Pg.useState({}),l=Pg.useRef({x:0,percent:0,direction:null,totalDistance:0,velocity:0,initialVelocity:null,initialPercent:null,mode:"idle"}),c=Pg.useRef({type:null,velocity:0,velocityCount:1,result:null,direction:null});const u=()=>{let e=c.current;e.velocity=0,e.velocityCount=1,e.type=null,e.result=null,e.direction=null};(t=>{const n=Pg.useRef(),i=Pg.useRef(),r=t=>{void 0!==i.current&&(()=>{let t,n=l.current,i=c.current,r=!1,o=!1;if(n.percent=Math.abs(n.x)/n.totalDistance,"dragging"===n.mode)t=!0;else if("animateSwipe"===n.mode){let e=GU.derivative(n.percent).y/1.5*39+1;n.velocity>0?(n.velocity=e,n.x+=e):(n.velocity=-e,n.x+=-e),n.x=Math.min(n.x,n.totalDistance),n.x=Math.max(n.x,-n.totalDistance),t=!0,n.percent>=1&&(n.velocity=0,n.initialVelocity=null,n.initialPercent=null,n.mode="completed",setTimeout((()=>{n.mode="idle"}),10),"right"===n.direction?(n.x=-n.totalDistance,r=!0):(n.x=n.totalDistance,o=!0))}else if("animateSnapback"===n.mode){var s;const e=1.1;n.initialPercent=null!==(s=n.initialPercent)&&void 0!==s?s:n.percent;let i=YU(1-n.percent/n.initialPercent,0,1),r=YU(qU.derivative(i).y,0,e)/e*29.8+.2;n.velocity=r,n.x+="left"===n.direction?r:-r,("left"===n.direction&&n.x>0||"right"===n.direction&&n.x<0)&&(n.velocity=0,n.initialVelocity=null,n.initialPercent=null,n.direction=null,n.x=0,n.percent=0,n.mode="idle",u()),t=!0}t&&(e.onUpdate&&e.onUpdate(n,i),r&&e.onSwitchedToPrev&&(i.result="completed",e.onSwitchedToPrev(i),u()),o&&e.onSwitchedToNext&&(i.result="completed",e.onSwitchedToNext(i),u()),"function"==typeof e.children&&a({transform:`translateX(${n.x}px)`}))})(),i.current=t,n.current=requestAnimationFrame(r)};Pg.useEffect((()=>(n.current=requestAnimationFrame(r),()=>cancelAnimationFrame(n.current))),[])})();let d=null===(r=e.enableSwitchPrev)||void 0===r||r,h=null===(o=e.enableSwitchNext)||void 0===o||o,p=!1,f=t.useDrag((e=>{let{down:t,movement:r,velocity:o,currentTarget:s,touches:a}=e,u=l.current,f=c.current,g=s.getBoundingClientRect().width,m=Math.abs(o[0])>n&&Math.abs(r[0])>i&&r[0]>0,y=Math.abs(o[0])>n&&Math.abs(r[0])>i&&r[0]<0,v=r[0]/g<-.5,b=r[0]/g>.5;var w;f.velocity-=f.velocity/f.velocityCount,f.velocity+=o[0]/f.velocityCount,f.velocityCount++,f.type=m||y?"swipe":"drag",f.direction=r[0]>0?"right":"left",["animateSwipe","completed"].includes(u.mode)||(a>1?p=!0:t||!p?t&&!p?(u.mode="dragging",u.x=r[0],u.totalDistance=g,null===u.initialVelocity&&Math.abs(o[0])>0&&(u.initialVelocity=Math.abs(o[0])),u.sourceX=null!==(w=u.sourceX)&&void 0!==w?w:0,u.direction=r[0]>0?"right":"left",u.velocity=o[0]):h&&(v||y)&&!p?(u.mode="animateSwipe",u.velocity=-YU(Math.abs(o[0]),1,40),u.x=r[0],u.direction="left"):d&&(b||m)&&!p?(u.mode="animateSwipe",u.velocity=YU(Math.abs(o[0]),1,40),u.x=r[0],u.direction="right"):"dragging"===u.mode&&(u.mode="animateSnapback",u.velocity=30,f.result="snapback"):p=!1)}),{axis:"x",preventScroll:!0});return Ig.createElement("div",Ja({className:"gestureSwitcherContainer"},f()),e.children&&e.children(s))},withoutGestures:e.children})}var XU=Ig.memo(KU);const QU=new Image,ZU=new Blob(['<svg width="1280" height="720" viewBox="0 0 1280 720" fill="none" xmlns="http://www.w3.org/2000/svg">\n    <rect width="1280" height="720" fill="#F5F5F5"/>\n    <path fill-rule="evenodd" clip-rule="evenodd" d="M654.293 344.69H645.344L637.919 356.268V336.111H630.323V368.517H636.973L641.809 361.87L646.645 368.517H656.37L646.29 355.7L654.293 344.69ZM652.679 356.612C652.679 350.017 658.124 344.668 664.84 344.668C671.567 344.668 677.013 350.017 677 356.612C677 363.208 671.555 368.556 664.84 368.556C658.124 368.556 652.679 363.208 652.679 356.612ZM659.973 356.624C659.973 359.564 662.149 361.688 664.84 361.688C667.531 361.688 669.706 359.552 669.706 356.624C669.706 353.685 667.531 351.548 664.84 351.548C662.149 351.548 659.973 353.685 659.973 356.624ZM616.16 344.668C609.445 344.668 604 350.017 604 356.612C604 363.208 609.445 368.556 616.16 368.556C621.367 368.556 625.806 365.344 627.541 360.824H620.147C619.38 361.713 618.399 362.343 616.223 362.343C613.947 362.343 612.111 361.17 611.281 358.86H628.107C628.245 358.131 628.321 357.378 628.321 356.612C628.321 350.017 622.876 344.668 616.16 344.668ZM611.281 354.364C612.061 352.215 613.947 350.931 616.16 350.931C618.374 350.931 620.273 352.215 621.04 354.364H611.281Z" fill="#CBCBCB"/>\n    <path d="M610.157 390.508V380.326H611.39V389.414H616.123V390.508H610.157ZM620.975 390.667C620.286 390.667 619.681 390.503 619.16 390.175C618.643 389.847 618.239 389.388 617.947 388.798C617.659 388.208 617.515 387.518 617.515 386.73C617.515 385.934 617.659 385.24 617.947 384.646C618.239 384.053 618.643 383.592 619.16 383.264C619.681 382.936 620.286 382.772 620.975 382.772C621.664 382.772 622.268 382.936 622.785 383.264C623.305 383.592 623.709 384.053 623.998 384.646C624.289 385.24 624.435 385.934 624.435 386.73C624.435 387.518 624.289 388.208 623.998 388.798C623.709 389.388 623.305 389.847 622.785 390.175C622.268 390.503 621.664 390.667 620.975 390.667ZM620.975 389.613C621.499 389.613 621.93 389.479 622.268 389.21C622.606 388.942 622.856 388.589 623.018 388.151C623.181 387.714 623.262 387.24 623.262 386.73C623.262 386.219 623.181 385.743 623.018 385.303C622.856 384.862 622.606 384.506 622.268 384.234C621.93 383.962 621.499 383.826 620.975 383.826C620.451 383.826 620.02 383.962 619.682 384.234C619.344 384.506 619.094 384.862 618.932 385.303C618.769 385.743 618.688 386.219 618.688 386.73C618.688 387.24 618.769 387.714 618.932 388.151C619.094 388.589 619.344 388.942 619.682 389.21C620.02 389.479 620.451 389.613 620.975 389.613ZM628.473 390.687C627.989 390.687 627.55 390.596 627.156 390.413C626.761 390.228 626.448 389.961 626.216 389.613C625.984 389.262 625.868 388.837 625.868 388.34C625.868 387.903 625.954 387.548 626.127 387.276C626.299 387.001 626.529 386.786 626.818 386.63C627.106 386.474 627.424 386.358 627.772 386.282C628.124 386.203 628.477 386.14 628.831 386.093C629.295 386.034 629.672 385.989 629.96 385.959C630.252 385.926 630.464 385.871 630.596 385.795C630.732 385.719 630.8 385.586 630.8 385.397V385.357C630.8 384.867 630.666 384.486 630.397 384.214C630.132 383.942 629.73 383.806 629.189 383.806C628.629 383.806 628.19 383.929 627.872 384.174C627.554 384.419 627.33 384.681 627.201 384.96L626.087 384.562C626.286 384.098 626.551 383.737 626.882 383.478C627.217 383.216 627.582 383.034 627.976 382.931C628.374 382.825 628.765 382.772 629.15 382.772C629.395 382.772 629.676 382.802 629.995 382.862C630.316 382.918 630.626 383.036 630.924 383.215C631.226 383.394 631.476 383.664 631.675 384.025C631.874 384.386 631.973 384.87 631.973 385.477V390.508H630.8V389.474H630.74C630.661 389.64 630.528 389.817 630.343 390.006C630.157 390.195 629.91 390.355 629.602 390.488C629.294 390.621 628.917 390.687 628.473 390.687ZM628.652 389.633C629.116 389.633 629.507 389.542 629.826 389.359C630.147 389.177 630.389 388.942 630.551 388.654C630.717 388.365 630.8 388.062 630.8 387.744V386.67C630.75 386.73 630.641 386.784 630.472 386.834C630.306 386.88 630.114 386.922 629.895 386.958C629.68 386.991 629.469 387.021 629.264 387.048C629.062 387.071 628.898 387.091 628.772 387.107C628.467 387.147 628.182 387.212 627.917 387.301C627.655 387.387 627.443 387.518 627.28 387.694C627.121 387.866 627.042 388.102 627.042 388.4C627.042 388.808 627.192 389.116 627.494 389.325C627.799 389.53 628.185 389.633 628.652 389.633ZM636.998 390.667C636.362 390.667 635.8 390.506 635.313 390.185C634.826 389.86 634.445 389.403 634.17 388.813C633.894 388.219 633.757 387.518 633.757 386.71C633.757 385.908 633.894 385.212 634.17 384.622C634.445 384.032 634.827 383.576 635.318 383.254C635.809 382.933 636.375 382.772 637.018 382.772C637.515 382.772 637.908 382.855 638.197 383.021C638.488 383.183 638.71 383.369 638.863 383.578C639.019 383.783 639.14 383.952 639.226 384.085H639.325V380.326H640.498V390.508H639.365V389.335H639.226C639.14 389.474 639.017 389.65 638.858 389.862C638.699 390.07 638.472 390.258 638.177 390.423C637.882 390.586 637.489 390.667 636.998 390.667ZM637.157 389.613C637.628 389.613 638.026 389.49 638.351 389.245C638.675 388.997 638.922 388.654 639.091 388.216C639.26 387.775 639.345 387.266 639.345 386.69C639.345 386.12 639.262 385.621 639.096 385.193C638.931 384.762 638.685 384.428 638.361 384.189C638.036 383.947 637.635 383.826 637.157 383.826C636.66 383.826 636.246 383.954 635.915 384.209C635.586 384.461 635.34 384.804 635.174 385.238C635.011 385.669 634.93 386.153 634.93 386.69C634.93 387.233 635.013 387.727 635.179 388.171C635.348 388.612 635.596 388.963 635.925 389.225C636.256 389.484 636.667 389.613 637.157 389.613ZM642.81 390.508V382.872H643.983V390.508H642.81ZM643.407 381.599C643.178 381.599 642.981 381.521 642.815 381.365C642.653 381.209 642.572 381.022 642.572 380.803C642.572 380.585 642.653 380.397 642.815 380.242C642.981 380.086 643.178 380.008 643.407 380.008C643.635 380.008 643.831 380.086 643.993 380.242C644.159 380.397 644.242 380.585 644.242 380.803C644.242 381.022 644.159 381.209 643.993 381.365C643.831 381.521 643.635 381.599 643.407 381.599ZM647.306 385.914V390.508H646.132V382.872H647.266V384.065H647.365C647.544 383.677 647.816 383.365 648.181 383.13C648.545 382.891 649.016 382.772 649.593 382.772C650.11 382.772 650.562 382.878 650.95 383.09C651.338 383.299 651.639 383.617 651.855 384.045C652.07 384.469 652.178 385.006 652.178 385.656V390.508H651.005V385.735C651.005 385.135 650.849 384.668 650.537 384.333C650.226 383.995 649.798 383.826 649.255 383.826C648.88 383.826 648.545 383.907 648.25 384.07C647.959 384.232 647.728 384.469 647.559 384.781C647.39 385.092 647.306 385.47 647.306 385.914ZM657.404 393.531C656.838 393.531 656.35 393.458 655.943 393.312C655.535 393.169 655.195 392.98 654.923 392.745C654.655 392.513 654.441 392.265 654.282 391.999L655.217 391.343C655.323 391.482 655.457 391.641 655.619 391.82C655.782 392.003 656.004 392.16 656.286 392.293C656.571 392.429 656.944 392.497 657.404 392.497C658.021 392.497 658.53 392.347 658.931 392.049C659.332 391.751 659.532 391.284 659.532 390.647V389.096H659.433C659.347 389.235 659.224 389.408 659.065 389.613C658.909 389.815 658.684 389.996 658.389 390.155C658.097 390.311 657.703 390.389 657.205 390.389C656.589 390.389 656.035 390.243 655.545 389.951C655.058 389.659 654.672 389.235 654.387 388.678C654.105 388.122 653.964 387.445 653.964 386.65C653.964 385.868 654.102 385.187 654.377 384.607C654.652 384.023 655.035 383.573 655.525 383.254C656.016 382.933 656.582 382.772 657.225 382.772C657.722 382.772 658.117 382.855 658.409 383.021C658.704 383.183 658.929 383.369 659.085 383.578C659.244 383.783 659.366 383.952 659.453 384.085H659.572V382.872H660.705V390.727C660.705 391.383 660.556 391.917 660.258 392.328C659.963 392.742 659.565 393.045 659.065 393.237C658.568 393.433 658.014 393.531 657.404 393.531ZM657.365 389.335C657.835 389.335 658.233 389.227 658.558 389.011C658.883 388.796 659.129 388.486 659.298 388.082C659.468 387.677 659.552 387.194 659.552 386.63C659.552 386.08 659.469 385.594 659.303 385.173C659.138 384.752 658.892 384.423 658.568 384.184C658.243 383.945 657.842 383.826 657.365 383.826C656.867 383.826 656.453 383.952 656.122 384.204C655.794 384.456 655.547 384.794 655.381 385.218C655.218 385.642 655.137 386.113 655.137 386.63C655.137 387.16 655.22 387.629 655.386 388.037C655.555 388.441 655.803 388.76 656.132 388.992C656.463 389.22 656.874 389.335 657.365 389.335ZM663.708 390.587C663.463 390.587 663.253 390.5 663.077 390.324C662.901 390.148 662.813 389.938 662.813 389.693C662.813 389.447 662.901 389.237 663.077 389.061C663.253 388.886 663.463 388.798 663.708 388.798C663.954 388.798 664.164 388.886 664.34 389.061C664.515 389.237 664.603 389.447 664.603 389.693C664.603 389.855 664.562 390.004 664.479 390.14C664.399 390.276 664.292 390.385 664.156 390.468C664.023 390.548 663.874 390.587 663.708 390.587ZM667.564 390.587C667.318 390.587 667.108 390.5 666.932 390.324C666.757 390.148 666.669 389.938 666.669 389.693C666.669 389.447 666.757 389.237 666.932 389.061C667.108 388.886 667.318 388.798 667.564 388.798C667.809 388.798 668.019 388.886 668.195 389.061C668.371 389.237 668.459 389.447 668.459 389.693C668.459 389.855 668.417 390.004 668.334 390.14C668.255 390.276 668.147 390.385 668.011 390.468C667.879 390.548 667.729 390.587 667.564 390.587ZM671.419 390.587C671.174 390.587 670.963 390.5 670.788 390.324C670.612 390.148 670.524 389.938 670.524 389.693C670.524 389.447 670.612 389.237 670.788 389.061C670.963 388.886 671.174 388.798 671.419 388.798C671.664 388.798 671.875 388.886 672.051 389.061C672.226 389.237 672.314 389.447 672.314 389.693C672.314 389.855 672.273 390.004 672.19 390.14C672.11 390.276 672.003 390.385 671.867 390.468C671.734 390.548 671.585 390.587 671.419 390.587Z" fill="#CBCBCB"/>\n</svg>\n'],{type:"image/svg+xml"}),JU=URL.createObjectURL(ZU);let ej,tj,nj,ij,rj;QU.src=JU;let oj={r:0,g:0,b:0},sj={};function aj(e){var t;return null==e||null===(t=e.getImageUrl)||void 0===t?void 0:t.call(e)}function lj(e){var t;sj[e.id]||(sj[e.id]={promise:(t=aj(e),new Promise(((e,n)=>{fetch(t,{priority:"high"}).then((e=>e.blob())).then((t=>{let n=window.URL.createObjectURL(t),i=new Image;i.onload=()=>{e(i)},i.src=n})).catch((e=>{n(e)}))}))),image:null},sj[e.id].promise.then((t=>{sj[e.id].image=t})))}function cj(e,t,n,i=(e=>e)){return i(e)*(n-t)+t}function uj({progress:e,next:t,darkenEffect:n,retargetOptions:i,textureAspectRatio:r}){let o=rj.containerWidth,s=rj.containerHeight,a=i.frames[0],l=a.targetBR.x-a.targetTL.x,c=a.targetBR.y-a.targetTL.y,u=a.targetTL.x+l/2,d=a.targetTL.y+c/2,h=l<1||c<1,p=n?cj(e,0,.7):0;return[{type:"solid",inputs:["__PREVIOUS:0"],options:{color:{r:oj.r/255,g:oj.g/255,b:oj.b/255,a:p}}},{inputs:["__PREVIOUS:0"],outputs:["fromVideo"],type:"crop",options:{source:{width:1,height:1,center:{x:.5,y:.5},aspectRatio:o/s},target:{width:1,height:1,center:{x:cj(e,.5,t?.25:.75),y:.5}},cornerRadius:0}},{type:"solidImage",inputs:["__SRC_TEXTURE:"+(t?"1":"0")],options:{}},{inputs:["__PREVIOUS:0"],type:"crop",options:{source:{width:1,height:1,center:{x:.5,y:.5},aspectRatio:r},target:{width:l,height:c,center:{x:cj(e,t?1.5:-.5,.5),y:d}},cornerRadius:0,edgeSoftness:0}},{type:"shapeComposite",inputs:["__PREVIOUS:0","fromVideo"],options:{}},...h?[{inputs:["__PREVIOUS:0"],type:"crop",options:{source:{width:l,height:c,center:{x:u,y:d},aspectRatio:o/s},target:{width:l,height:c,center:{x:u,y:d}},cornerRadius:0}}]:[]]}function dj({player:e,vfx:t,viewportDimensions:n,getRetargetOptions:i}){rj=e;let r,o,s=0,a=null,l=null;function c(){o=i(r),ij=t.getTransitionSource(),nj=t.createFilter({name:"transitionFilter",createShaderGraph:uj},{progress:s,retargetOptions:o}),nj.add(ij)}function u(e,t){r||(r={width:e,height:t}),nj||c(),nj.update({retargetOptions:i({width:e,height:t})})}return tj=t.shaderGraph.addTexture(null,"pixel",0),ej=t.shaderGraph.addTexture(null,"pixel",1),rj.containerHeight&&rj.containerWidth&&(r=n,c()),e.on("containerresize",u),{cleanup:()=>{e.off("containerresize",u)},updateProgress:function(e,t,n={}){var i,r,u,d,h,p;nj||c(),n={darkenEffect:!0,...n},s=e;const f=t?null!==(i=null===(r=sj[null===(u=l)||void 0===u?void 0:u.id])||void 0===r?void 0:r.image)&&void 0!==i?i:QU:null!==(d=null===(h=sj[null===(p=a)||void 0===p?void 0:p.id])||void 0===h?void 0:h.image)&&void 0!==d?d:QU;nj.update({progress:s,next:t,darkenEffect:n.darkenEffect,retargetOptions:o,textureAspectRatio:((null==f?void 0:f.width)||16)/((null==f?void 0:f.height)||9)})},setupCurrentNodeImages:function(e,t){lj(e),lj(t),sj[e.id].promise.then((t=>{null!==a&&a!==e||(a=e,tj.fill(t))})),sj[t.id].promise.then((e=>{null!==l&&l!==t||(l=t,ej.fill(e))}))},loadNodeImageToCache:lj,updateImages:function(e,t){let n=t!==l;if(e!==a){var i,r;a=e;let t=null!==(i=null===(r=sj[e.id])||void 0===r?void 0:r.image)&&void 0!==i?i:QU;tj.fill(t)}else if(n){var o,s;l=t;let e=null!==(o=null===(s=sj[t.id])||void 0===s?void 0:s.image)&&void 0!==o?o:QU;ej.fill(e)}}}}function hj(e,t){return Array.isArray(e.variants)?{...e,variants:e.variants.map((e=>{var n,i;return{...e,name:(null===(n=t.variants)||void 0===n||null===(n=n[e.variantId])||void 0===n?void 0:n.name)||t.name||e.name,icon:(null===(i=t.variants)||void 0===i||null===(i=i[e.variantId])||void 0===i?void 0:i.icon)||t.icon||e.icon}}))}:{...e,name:t.name||e.name,icon:t.icon||e.icon}}function pj(e){return e.variants?{itemType:"variantsGalleryItem",variants:Object.entries(e.variants).map((([t,n])=>({variantId:t,name:n.name,icon:n.icon,modules:[{itemType:e.type,...n.config}]})))}:{itemType:"galleryItem",name:e.name,icon:e.icon,modules:[{itemType:e.type,...e.config}]}}function fj(e,...t){function n(e){return"[object Object]"===Object.prototype.toString.call(e)}function i(e,t){if(Array.isArray(t)){Array.isArray(e)||(e=Array.isArray(e)?e.slice():[]);const r=Math.max(e.length,t.length);for(let o=0;o<r;o++){const r=e[o],s=t[o];null!=s&&(e[o]=n(r)&&n(s)?i({...r},s):Array.isArray(r)&&Array.isArray(s)?i(r.slice(),s):n(s)?i({},s):Array.isArray(s)?i([],s):s)}return e}if(n(t)){n(e)||(e={});for(const r of Object.keys(t)){const o=e[r],s=t[r];n(o)&&n(s)?e[r]=i({...o},s):Array.isArray(o)&&Array.isArray(s)?e[r]=i(o.slice(),s):n(s)?e[r]=i({},s):Array.isArray(s)?e[r]=i([],s):void 0!==s&&(e[r]=s)}return e}return t}for(const n of t)null!==n&&i(e,n);return e}function gj(){return gj=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},gj.apply(this,arguments)}By('.bp-vertical-small {\n  --gizmoPadding: 16px;\n  --navigationHeight: 5.2em;\n  font-size: 12px;\n  line-height: 14px;\n}\n\n.bp-vertical-medium {\n  --gizmoPadding: 24px;\n  --navigationHeight: 5.2em;\n  font-size: 16px;\n  line-height: 17px;\n}\n\n.eko-galleryBlockContainer {\n  position: relative;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  box-sizing: border-box;\n  height: 100%;\n  overflow: hidden;\n}\n.eko-galleryBlockContainer.animate {\n  opacity: 0;\n  animation: eko-gallery-ui-initial-anim 0.3s ease-in-out forwards 1s;\n}\n.eko-galleryBlockContainer .gestureCatcher {\n  position: absolute;\n  top: 0;\n  left: 0;\n  height: 100%;\n  width: 100%;\n}\n.eko-galleryBlockContainer .eko-galleryContent {\n  position: relative;\n  width: 100%;\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n}\n.eko-galleryBlockContainer .eko-seqNavigationContainer {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  justify-content: space-between;\n  pointer-events: none;\n  padding: 0 12px;\n  box-sizing: border-box;\n}\n.eko-galleryBlockContainer .eko-seqNavigationContainer .seqNavigation {\n  transition: 0.2s ease-in-out;\n  box-shadow: none;\n}\n.eko-galleryBlockContainer .eko-seqNavigationContainer .seqNavigation svg {\n  fill: rgba(0, 0, 0, 0.6);\n}\n.eko-galleryBlockContainer .seqNavigation {\n  height: 30px;\n  width: 30px;\n  border-radius: 100%;\n  background-color: transparent;\n  padding: 9px;\n  box-sizing: border-box;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  pointer-events: auto;\n  border: 0;\n  opacity: 100%;\n  cursor: pointer;\n  transition-property: background-color, box-shadow, opacity;\n  position: relative;\n}\n.eko-galleryBlockContainer .seqNavigation.prev {\n  transform: rotate(180deg);\n}\n.eko-galleryBlockContainer .seqNavigation.hidden {\n  opacity: 0;\n  pointer-events: none;\n}\n.eko-galleryBlockContainer .seqNavigation::before {\n  content: "";\n  position: absolute;\n  top: -8px;\n  right: -8px;\n  bottom: -8px;\n  left: -8px;\n}\n.eko-galleryBlockContainer .eko-moduleContainer {\n  position: relative;\n  width: 100%;\n  height: 100%;\n  pointer-events: none;\n  opacity: var(--uiOpacity, 1);\n  transform: translate3d(var(--uiXPosition, 0), 0, 0);\n}\n.eko-galleryBlockContainer:hover .eko-seqNavigationContainer .seqNavigation {\n  background-color: #FFFFFF;\n  box-shadow: 0 0 8px 0 rgba(0, 0, 0, 0.12);\n}\n\n@keyframes eko-gallery-ui-initial-anim {\n  0% {\n    opacity: 0;\n  }\n  100% {\n    opacity: 100%;\n  }\n}\n.full-screen-layout.paused .eko-galleryBlockContainer .eko-galleryModuleSteps .eko-stepButton span.currentStep:after {\n  animation-play-state: paused;\n}\n\n#uiRootContainer:has(> .platformAbove > #EkoshellRoot > .ekoshell_waitingIndication) .project .full-screen-layout .eko-galleryBlockContainer .eko-galleryModuleSteps .eko-stepButton span.currentStep:after {\n  animation-play-state: paused;\n}\n\n#uiRootContainer:has(> .project > .full-screen-layout > .interface > .interfaceContent > .eko-galleryBlockContainer) .ekoshell_waitingIndication.ekoshell_waitingIndication-enter-done,\n#uiRootContainer:has(> .project > .full-screen-layout > .interface > .interfaceContent > .gestureCatcher > .eko-galleryBlockContainer) .ekoshell_waitingIndication.ekoshell_waitingIndication-enter-done {\n  pointer-events: none !important;\n}\n\n.full-screen-layout:has(> .interface > .interfaceContent > .eko-galleryBlockContainer).transitionActiveIn .interface,\n.full-screen-layout:has(> .interface > .interfaceContent > .gestureCatcher > .eko-galleryBlockContainer).transitionActiveIn .interface {\n  opacity: 1;\n}\n.full-screen-layout:has(> .interface > .interfaceContent > .eko-galleryBlockContainer) .pause-overlay,\n.full-screen-layout:has(> .interface > .interfaceContent > .gestureCatcher > .eko-galleryBlockContainer) .pause-overlay {\n  display: none;\n}');var mj=({styles:e={},...t})=>Ig.createElement("svg",gj({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 320 512"},t),Ig.createElement("path",{d:"M310.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-192 192c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L242.7 256 73.4 86.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l192 192z"}));function yj(e){return Ig.createElement("button",{className:`seqNavigation ${e.type} ${e.hide?"hidden":""}`,onClick:e.onClick,"aria-label":"next"===e.type?"Next":"Previous"},Ig.createElement(mj,{height:"100%"}))}function vj({currentGalleryItemIndex:e,galleryItems:t,onItemClick:n,showNavigationButtons:i,enableNav:r,labelsOnly:o,onPrevClick:s,onNextClick:a}){const l=Pg.useRef(),[c,u]=Pg.useState(!1),[d,h]=Pg.useState(i),[p,f]=Pg.useState(!0),[g,m]=Pg.useState(!1),y=["eko-galleryBlockItems","navMask",p?"maskStart":"",g?"maskEnd":""].join(" "),v=Pg.useCallback(((e,t)=>{e.stopPropagation(),n(t)}),[n]),b=Pg.useCallback((e=>s(e,"click")),[s]),w=Pg.useCallback((e=>a(e,"click")),[a]),k=t.map(((t,n)=>Ig.createElement("button",{key:n,className:"eko-gallery-nav-button","aria-selected":n===e,onClick:e=>v(e,t),"data-moduletype":t.moduleType,"aria-label":t.name||t.id||`Item Number ${n+1}`},t.icon&&!o&&Ig.createElement("img",{src:t.icon,alt:`Image ${n+1}`}),t.name&&Ig.createElement("span",null,t.name))));function x(e){e&&(f(e.scrollLeft<=0),Math.floor(e.scrollWidth-e.scrollLeft)<=e.clientWidth?m(!0):m(!1))}function S(e,t){return Math.max(-t.scrollLeft,Math.min(t.scrollWidth-t.clientWidth-t.scrollLeft,e))}return Pg.useEffect((()=>{if(l.current){const e=new ResizeObserver((()=>{l.current.clientWidth<l.current.scrollWidth?i&&!d&&h(!0):d&&h(!1),x(l.current)}));return e.observe(l.current),()=>{e.disconnect()}}}),[i,d]),Pg.useEffect((()=>{const t=l.current;t&&!c&&setTimeout((()=>{const n=l.current.childNodes[e].getBoundingClientRect();n.left<84?l.current.scrollBy({left:S(n.left-84,t),behavior:"smooth"}):n.right>l.current.clientWidth-84&&l.current.scrollBy({left:S(n.right-t.clientWidth+84,t),behavior:"smooth"})}),0)}),[e]),Ig.createElement("div",{className:"eko-galleryBlockItemsContainer"},Ig.createElement("div",{className:y,onTouchStart:function(){u(!0)},onTouchEnd:function(){u(!1)},onScroll:function(){x(l.current)},ref:l},k),(d||r)&&Ig.createElement("div",{className:"eko-galleryItemsDesktopNavContainer"},Ig.createElement(yj,Ja({type:"prev"},r?{onClick:b}:{onClick:function(e){e.stopPropagation();const t=l.current;t&&t.scrollBy({left:S(-t.clientWidth,t),behavior:"smooth"})},hide:p})),Ig.createElement(yj,Ja({type:"next"},r?{onClick:w}:{onClick:function(e){e.stopPropagation();const t=l.current;t&&t.scrollBy({left:S(t.clientWidth,t),behavior:"smooth"})},hide:g}))))}function bj(e){const t=Pg.useRef(null);return null===t.current&&(t.current=e()),t.current}function wj(e){let t;return()=>(void 0===t&&(t=e()),t)}yj.propTypes={type:Ov.oneOf(["next","prev"]).isRequired,onClick:Ov.func,hide:Ov.bool},By(".bp-vertical-small {\n  --gizmoPadding: 16px;\n  --navigationHeight: 5.2em;\n  font-size: 12px;\n  line-height: 14px;\n}\n\n.bp-vertical-medium {\n  --gizmoPadding: 24px;\n  --navigationHeight: 5.2em;\n  font-size: 16px;\n  line-height: 17px;\n}\n\n.eko-galleryBlockContainer {\n  --nav_gap: 10px;\n  --nav_padding: 12px 16px;\n  --nav_bgColor: #FFFFFF;\n  --nav_justifyContent: center;\n  --nav_button_width: fit-content;\n  --nav_button_bgColor: #FFFFFF;\n  --nav_button_borderRadius: 100px;\n  --nav_button_paddingTop: 8px;\n  --nav_button_paddingBottom: var(--nav_button_paddingTop);\n  --nav_button_paddingLeft: 12px;\n  --nav_button_paddingRight: var(--nav_button_paddingLeft);\n  --nav_button_boxShadow: 0 0 0 1px #E7E7E7;\n  --nav_button_gap: 2px;\n  --nav_button_selected_boxShadow: 0 0 0 1px #000000;\n  --nav_button_selected_bgColor: var(--nav_button_bgColor);\n  --nav_button_text_color: #000000;\n  --nav_button_text_fontSize: 14px;\n  --nav_button_text_fontWeight: 500;\n  --nav_button_text_fontFamily: var(--fontName);\n  --nav_button_text_lineHeight: 120%;\n  --nav_button_text_letterSpacing: 0px;\n  --nav_button_text_align: center;\n  --nav_button_selected_text_color: var(--nav_button_text_color);\n  --nav_button_selected_text_fontWeight: var(--nav_button_text_fontWeight);\n  --nav_button_image_borderRadius: calc(var(--nav_button_borderRadius) - var(--nav_button_paddingTop));\n  --nav_arrow_color: var(--secondaryColor);\n  --nav_arrow_bgColor: var(--primaryColor);\n  --nav_arrow_padding: 9px;\n  --nav_arrow_size: 28px;\n  --nav_arrow_boxShadow: 0 0 8px 0 rgba(0, 0, 0, 0.3);\n}\n.eko-galleryBlockContainer .eko-galleryBlockItemsContainer {\n  width: 100%;\n  background-color: var(--nav_bgColor);\n  height: var(--buttonsContainerHeight);\n  display: flex;\n  box-sizing: border-box;\n  text-align: center;\n  justify-content: var(--nav_justifyContent);\n  align-items: center;\n  position: relative;\n  flex-shrink: 0;\n}\n.eko-galleryBlockContainer .eko-galleryBlockItems {\n  display: flex;\n  margin: 0;\n  gap: var(--nav_gap);\n  height: 100%;\n  align-items: center;\n  padding: var(--nav_padding);\n  box-sizing: border-box;\n  overflow-x: auto;\n  scrollbar-width: none;\n  max-width: 100%;\n  width: fit-content;\n  overflow-y: hidden;\n  overscroll-behavior-y: none;\n}\n.eko-galleryBlockContainer .eko-galleryBlockItems .eko-gallery-nav-button {\n  display: flex;\n  flex-shrink: 0;\n  height: 100%;\n  width: var(--nav_button_width);\n  border: none;\n  cursor: pointer;\n  align-items: center;\n  gap: var(--nav_button_gap);\n  transition: all 0.2s ease-in-out;\n  background-color: var(--nav_button_bgColor);\n  border-radius: var(--nav_button_borderRadius);\n  padding: var(--nav_button_paddingTop) var(--nav_button_paddingRight) var(--nav_button_paddingBottom) var(--nav_button_paddingLeft);\n  box-shadow: var(--nav_button_boxShadow);\n}\n.eko-galleryBlockContainer .eko-galleryBlockItems .eko-gallery-nav-button span {\n  flex: 1 0 0;\n  transition: color 0.2s ease-in-out;\n  color: var(--nav_button_text_color);\n  font-weight: var(--nav_button_text_fontWeight);\n  font-size: var(--nav_button_text_fontSize);\n  font-family: var(--nav_button_text_fontFamily);\n  line-height: var(--nav_button_text_lineHeight);\n  letter-spacing: var(--nav_button_text_letterSpacing);\n  text-align: var(--nav_button_text_align);\n}\n.eko-galleryBlockContainer .eko-galleryBlockItems .eko-gallery-nav-button img {\n  pointer-events: none;\n  height: 100%;\n  border-radius: var(--nav_button_image_borderRadius);\n}\n.eko-galleryBlockContainer .eko-galleryBlockItems .eko-gallery-nav-button[aria-selected=true] {\n  background-color: var(--nav_button_selected_bgColor);\n  box-shadow: var(--nav_button_selected_boxShadow);\n}\n.eko-galleryBlockContainer .eko-galleryBlockItems .eko-gallery-nav-button[aria-selected=true] span {\n  color: var(--nav_button_selected_text_color);\n  font-weight: var(--nav_button_selected_text_fontWeight);\n}\n.eko-galleryBlockContainer .eko-galleryBlockItems::-webkit-scrollbar {\n  display: none;\n}\n.eko-galleryBlockContainer .eko-galleryBlockItems.navMask {\n  mask: linear-gradient(90deg, rgba(0, 0, 0, 0), #000 58px calc(100% - 58px), rgba(0, 0, 0, 0));\n}\n.eko-galleryBlockContainer .eko-galleryBlockItems.navMask.maskStart {\n  mask: linear-gradient(90deg, #000 0 calc(100% - 58px), rgba(0, 0, 0, 0));\n}\n.eko-galleryBlockContainer .eko-galleryBlockItems.navMask.maskEnd {\n  mask: linear-gradient(90deg, rgba(0, 0, 0, 0), #000 58px 100%);\n}\n.eko-galleryBlockContainer .eko-galleryBlockItems.navMask.maskStart.maskEnd {\n  mask: none;\n}\n.eko-galleryBlockContainer .eko-galleryItemsDesktopNavContainer {\n  position: absolute;\n  height: 100%;\n  width: 100%;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  box-sizing: border-box;\n  padding: 0 8px;\n  pointer-events: none;\n}\n.eko-galleryBlockContainer .eko-galleryItemsDesktopNavContainer .seqNavigation {\n  height: var(--nav_arrow_size);\n  width: var(--nav_arrow_size);\n  background-color: var(--nav_arrow_bgColor);\n  padding: var(--nav_arrow_padding);\n  box-shadow: var(--nav_arrow_boxShadow);\n  transition: 0.15s ease-in-out;\n}\n.eko-galleryBlockContainer .eko-galleryItemsDesktopNavContainer .seqNavigation svg {\n  fill: var(--nav_arrow_color);\n}");const kj=wj((()=>void 0!==window.ScrollTimeline));class xj{constructor(e){this.stop=()=>this.runAll("stop"),this.animations=e.filter(Boolean)}then(e,t){return Promise.all(this.animations).then(e).catch(t)}getAll(e){return this.animations[0][e]}setAll(e,t){for(let n=0;n<this.animations.length;n++)this.animations[n][e]=t}attachTimeline(e,t){const n=this.animations.map((n=>kj()&&n.attachTimeline?n.attachTimeline(e):t(n)));return()=>{n.forEach(((e,t)=>{e&&e(),this.animations[t].stop()}))}}get time(){return this.getAll("time")}set time(e){this.setAll("time",e)}get speed(){return this.getAll("speed")}set speed(e){this.setAll("speed",e)}get startTime(){return this.getAll("startTime")}get duration(){let e=0;for(let t=0;t<this.animations.length;t++)e=Math.max(e,this.animations[t].duration);return e}runAll(e){this.animations.forEach((t=>t[e]()))}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}const Sj=e=>e;let Cj=Sj;const _j=e=>1e3*e,Ej=e=>e/1e3,Tj=e=>Array.isArray(e)&&"number"==typeof e[0],Pj=(e,t,n)=>{const i=t-e;return 0===i?1:(n-e)/i},Ij=(e,t,n=10)=>{let i="";const r=Math.max(Math.round(t/n),2);for(let t=0;t<r;t++)i+=e(Pj(0,r-1,t))+", ";return`linear(${i.substring(0,i.length-2)})`},Aj={linearEasing:void 0};function Oj(e,t){const n=wj(e);return()=>{var e;return null!==(e=Aj[t])&&void 0!==e?e:n()}}const Lj=Oj((()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch(e){return!1}return!0}),"linearEasing"),Nj=([e,t,n,i])=>`cubic-bezier(${e}, ${t}, ${n}, ${i})`,Rj={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Nj([0,.65,.55,1]),circOut:Nj([.55,0,1,.45]),backIn:Nj([.31,.01,.66,-.59]),backOut:Nj([.33,1.53,.69,.99])};function Dj(e,t){return e?"function"==typeof e&&Lj()?Ij(e,t):Tj(e)?Nj(e):Array.isArray(e)?e.map((e=>Dj(e,t)||Rj.easeOut)):Rj[e]:void 0}function Mj(e,t,n,{delay:i=0,duration:r=300,repeat:o=0,repeatType:s="loop",ease:a="easeInOut",times:l}={}){const c={[t]:n};l&&(c.offset=l);const u=Dj(a,r);return Array.isArray(u)&&(c.easing=u),e.animate(c,{delay:i,duration:r,easing:Array.isArray(u)?"linear":u,fill:"both",iterations:o+1,direction:"reverse"===s?"alternate":"normal"})}const Fj=2e4;function Bj(e){let t=0,n=e.next(t);for(;!n.done&&t<Fj;)t+=50,n=e.next(t);return t>=Fj?1/0:t}const Uj=(e=>({test:e=>"string"==typeof e&&e.endsWith("px")&&1===e.split(" ").length,parse:parseFloat,transform:e=>`${e}px`}))(),jj={borderWidth:Uj,borderTopWidth:Uj,borderRightWidth:Uj,borderBottomWidth:Uj,borderLeftWidth:Uj,borderRadius:Uj,radius:Uj,borderTopLeftRadius:Uj,borderTopRightRadius:Uj,borderBottomRightRadius:Uj,borderBottomLeftRadius:Uj,width:Uj,maxWidth:Uj,height:Uj,maxHeight:Uj,top:Uj,right:Uj,bottom:Uj,left:Uj,padding:Uj,paddingTop:Uj,paddingRight:Uj,paddingBottom:Uj,paddingLeft:Uj,margin:Uj,marginTop:Uj,marginRight:Uj,marginBottom:Uj,marginLeft:Uj,backgroundPositionX:Uj,backgroundPositionY:Uj};function zj(e,t){e.timeline=t,e.onfinish=null}const Vj=e=>null!==e;function Wj(e,t,n){e.style.setProperty(`--${t}`,n)}function Hj(e,t,n){e.style[t]=n}const $j=wj((()=>{try{document.createElement("div").animate({opacity:[1]})}catch(e){return!1}return!0})),Gj=wj((()=>Object.hasOwnProperty.call(Element.prototype,"animate"))),qj=new WeakMap,Yj="easeOut";function Kj(e){const t=qj.get(e)||new Map;return qj.set(e,t),qj.get(e)}class Xj{constructor(e,t,n,i){const r=t.startsWith("--");this.setValue=r?Wj:Hj,this.options=i,this.updateFinishedPromise(),Cj("string"!=typeof i.type);const o=Kj(e).get(t);if(o&&o.stop(),Array.isArray(n)||(n=[n]),function(e,t,n){for(let i=0;i<t.length;i++)null===t[i]&&(t[i]=0===i?n():t[i-1]),"number"==typeof t[i]&&jj[e]&&(t[i]=jj[e].transform(t[i]));!$j()&&t.length<2&&t.unshift(n())}(t,n,(()=>t.startsWith("--")?e.style.getPropertyValue(t):window.getComputedStyle(e)[t])),"function"==typeof i.type){const e=function(e,t=100,n){const i=n({...e,keyframes:[0,t]}),r=Math.min(Bj(i),Fj);return{type:"keyframes",ease:e=>i.next(r*e).value/t,duration:Ej(r)}}(i,100,i.type);i.ease=Lj()?e.ease:Yj,i.duration=_j(e.duration),i.type="keyframes"}else i.ease=i.ease||Yj;this.removeAnimation=()=>{var n;return null===(n=qj.get(e))||void 0===n?void 0:n.delete(t)};const s=()=>{this.setValue(e,t,function(e,{repeat:t,repeatType:n="loop"},i){const r=e.filter(Vj),o=t&&"loop"!==n&&t%2==1?0:r.length-1;return o&&void 0!==i?i:r[o]}(n,this.options)),this.cancel(),this.resolveFinishedPromise()};Gj()?(this.animation=Mj(e,t,n,i),!1===i.autoplay&&this.animation.pause(),this.animation.onfinish=s,this.pendingTimeline&&zj(this.animation,this.pendingTimeline),Kj(e).set(t,this)):s()}get duration(){return Ej(this.options.duration||300)}get time(){var e;return this.animation?Ej((null===(e=this.animation)||void 0===e?void 0:e.currentTime)||0):0}set time(e){this.animation&&(this.animation.currentTime=_j(e))}get speed(){return this.animation?this.animation.playbackRate:1}set speed(e){this.animation&&(this.animation.playbackRate=e)}get state(){return this.animation?this.animation.playState:"finished"}get startTime(){return this.animation?this.animation.startTime:null}flatten(){var e;this.animation&&(null===(e=this.animation.effect)||void 0===e||e.updateTiming({easing:"linear"}))}play(){"finished"===this.state&&this.updateFinishedPromise(),this.animation&&this.animation.play()}pause(){this.animation&&this.animation.pause()}stop(){this.animation&&"idle"!==this.state&&"finished"!==this.state&&(this.animation.commitStyles&&this.animation.commitStyles(),this.cancel())}complete(){this.animation&&this.animation.finish()}cancel(){this.removeAnimation();try{this.animation&&this.animation.cancel()}catch(e){}}then(e,t){return this.currentFinishedPromise.then(e,t)}updateFinishedPromise(){this.currentFinishedPromise=new Promise((e=>{this.resolveFinishedPromise=e}))}attachTimeline(e){return this.animation?zj(this.animation,e):this.pendingTimeline=e,Sj}}const Qj=e=>function(t,n,i){return new xj(function(e,t,n,i){const r=function(e,t,n){if(e instanceof Element)return[e];if("string"==typeof e){let n=document;t&&(n=t.current);const i=n.querySelectorAll(e);return i?Array.from(i):[]}return Array.from(e)}(e,i),o=r.length,s=[];for(let e=0;e<o;e++){const i=r[e],c={...n};"function"==typeof c.delay&&(c.delay=c.delay(e,o));for(const e in t){const n=t[e],r={...(a=c,l=e,a?a[l]||a.default||a:void 0)};r.duration=r.duration?_j(r.duration):r.duration,r.delay=_j(r.delay||0),s.push(new Xj(i,e,n,r))}}var a,l;return s}(t,n,i,e))};function Zj(){const e=bj((()=>({current:null,animations:[]}))),t=bj((()=>Qj(e)));var n;return n=()=>{e.animations.forEach((e=>e.stop()))},Pg.useEffect((()=>()=>n()),[]),[e,t]}const Jj=5,ez=(e,t,n)=>n>t?t:n<e?e:n,tz={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},nz=.001,iz=12;function rz(e,t){return e*Math.sqrt(1-t*t)}const oz=["duration","bounce"],sz=["stiffness","damping","mass"];function az(e,t){return t.some((t=>void 0!==e[t]))}function lz(e=tz.visualDuration,t=tz.bounce){const n="object"!=typeof e?{visualDuration:e,keyframes:[0,1],bounce:t}:e;let{restSpeed:i,restDelta:r}=n;const o=n.keyframes[0],s=n.keyframes[n.keyframes.length-1],a={done:!1,value:o},{stiffness:l,damping:c,mass:u,duration:d,velocity:h,isResolvedFromDuration:p}=function(e){let t={velocity:tz.velocity,stiffness:tz.stiffness,damping:tz.damping,mass:tz.mass,isResolvedFromDuration:!1,...e};if(!az(e,sz)&&az(e,oz))if(e.visualDuration){const n=2*Math.PI/(1.2*e.visualDuration),i=n*n,r=2*ez(.05,1,1-e.bounce)*Math.sqrt(i);t={...t,mass:tz.mass,stiffness:i,damping:r}}else{const n=function({duration:e=tz.duration,bounce:t=tz.bounce,velocity:n=tz.velocity,mass:i=tz.mass}){let r,o,s=1-t;s=ez(tz.minDamping,tz.maxDamping,s),e=ez(tz.minDuration,tz.maxDuration,Ej(e)),s<1?(r=t=>{const i=t*s,r=i*e,o=i-n,a=rz(t,s),l=Math.exp(-r);return nz-o/a*l},o=t=>{const i=t*s*e,o=i*n+n,a=Math.pow(s,2)*Math.pow(t,2)*e,l=Math.exp(-i),c=rz(Math.pow(t,2),s);return(-r(t)+nz>0?-1:1)*((o-a)*l)/c}):(r=t=>Math.exp(-t*e)*((t-n)*e+1)-nz,o=t=>Math.exp(-t*e)*(e*e*(n-t)));const a=function(e,t,n){let i=n;for(let n=1;n<iz;n++)i-=e(i)/t(i);return i}(r,o,5/e);if(e=_j(e),isNaN(a))return{stiffness:tz.stiffness,damping:tz.damping,duration:e};{const t=Math.pow(a,2)*i;return{stiffness:t,damping:2*s*Math.sqrt(i*t),duration:e}}}(e);t={...t,...n,mass:tz.mass},t.isResolvedFromDuration=!0}return t}({...n,velocity:-Ej(n.velocity||0)}),f=h||0,g=c/(2*Math.sqrt(l*u)),m=s-o,y=Ej(Math.sqrt(l/u)),v=Math.abs(m)<5;let b;if(i||(i=v?tz.restSpeed.granular:tz.restSpeed.default),r||(r=v?tz.restDelta.granular:tz.restDelta.default),g<1){const e=rz(y,g);b=t=>{const n=Math.exp(-g*y*t);return s-n*((f+g*y*m)/e*Math.sin(e*t)+m*Math.cos(e*t))}}else if(1===g)b=e=>s-Math.exp(-y*e)*(m+(f+y*m)*e);else{const e=y*Math.sqrt(g*g-1);b=t=>{const n=Math.exp(-g*y*t),i=Math.min(e*t,300);return s-n*((f+g*y*m)*Math.sinh(i)+e*m*Math.cosh(i))/e}}const w={calculatedDuration:p&&d||null,next:e=>{const t=b(e);if(p)a.done=e>=d;else{let n=0;g<1&&(n=0===e?_j(f):function(e,t,n){const i=Math.max(t-Jj,0);return r=n-e(i),(o=t-i)?r*(1e3/o):0;var r,o}(b,e,t));const o=Math.abs(n)<=i,l=Math.abs(s-t)<=r;a.done=o&&l}return a.value=a.done?s:t,a},toString:()=>{const e=Math.min(Bj(w),Fj),t=Ij((t=>w.next(e*t).value),e,30);return e+"ms "+t}};return w}function cz(){return cz=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},cz.apply(this,arguments)}var uz=({styles:e={},...t})=>Ig.createElement("svg",cz({viewBox:"0 0 16 17",xmlns:"http://www.w3.org/2000/svg"},t),Ig.createElement("path",{d:"M4.523 2.685a1.5 1.5 0 00-1.5 1.5v9a1.5 1.5 0 001.5 1.5h1a1.5 1.5 0 001.5-1.5v-9a1.5 1.5 0 00-1.5-1.5h-1zm6 0a1.5 1.5 0 00-1.5 1.5v9a1.5 1.5 0 001.5 1.5h1a1.5 1.5 0 001.5-1.5v-9a1.5 1.5 0 00-1.5-1.5h-1z"}));function dz(){return dz=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},dz.apply(this,arguments)}var hz=({styles:e={},...t})=>Ig.createElement("svg",dz({viewBox:"0 0 17 17",xmlns:"http://www.w3.org/2000/svg"},t),Ig.createElement("path",{d:"M6.01 1.904a1.495 1.495 0 00-1.516-.028 1.503 1.503 0 00-.765 1.31v10.998c0 .543.294 1.043.765 1.309a1.503 1.503 0 001.516-.028l8.998-5.5a1.5 1.5 0 000-2.562L6.01 1.905z"}));By('.eko-galleryBlockContainer .eko-galleryBlockPauseButton {\n  position: absolute;\n  bottom: 12px;\n  right: 12px;\n  background: rgba(0, 0, 0, 0.04);\n  border-radius: 100%;\n  border: 0;\n  padding: 0;\n  width: 32px;\n  height: 32px;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  pointer-events: auto;\n  transition: background 0.2s ease-in-out;\n  cursor: pointer;\n}\n.eko-galleryBlockContainer .eko-galleryBlockPauseButton:hover {\n  background: rgba(0, 0, 0, 0.15);\n}\n.eko-galleryBlockContainer .eko-galleryBlockPauseButton svg {\n  width: 16px;\n  height: 16px;\n  fill: black;\n  fill-opacity: 0.6;\n  pointer-events: none;\n}\n.eko-galleryBlockContainer .eko-poweredByContainer {\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  display: flex;\n  justify-content: center;\n  align-items: flex-end;\n  transform: translateY(110%);\n  pointer-events: none;\n}\n.eko-galleryBlockContainer .eko-poweredByContainer .eko-poweredByTag {\n  border: none;\n  z-index: 0;\n  background-color: white;\n  padding: 8px 8px 7px 8px;\n  border-radius: 12px 12px 0 0;\n  box-shadow: 0 1px 4px 0 rgba(0, 0, 0, 0.12);\n  pointer-events: auto;\n  cursor: pointer;\n}\n.eko-galleryBlockContainer .eko-poweredByContainer > svg {\n  z-index: 1;\n}\n.eko-galleryBlockContainer .eko-poweredByContainer:after {\n  content: "";\n  position: absolute;\n  top: 99%;\n  height: 30px;\n  width: 135px;\n  border-radius: 12px 12px 0 0;\n  background-color: white;\n}');const pz=window.eko.embedApi;function fz(e){const{player:t,showPBE:n}=e,[i,r]=Zj(),[o,s]=Pg.useState(-1),a=Pg.useRef(!1),l=t.ui.useSelector((e=>e.player.isPaused)),c=Pg.useCallback((e=>{e.stopPropagation(),e.preventDefault(),l?(t.play(),pz.sendMsg(pz.TYPES.USER_PLAY)):(t.pause(),pz.sendMsg(pz.TYPES.USER_PAUSE),n&&(a.current=!0,i.current&&(i.current.style.display="flex"),r(i.current,{transform:["translateY(110%)","translateY(0)"]},{type:lz,mass:1,stiffness:323,damping:30}).then((()=>{s(0)}))))}),[l,n]),u=Pg.useCallback((e=>{a.current&&(e.stopPropagation(),window.open("https://eko.com/?utm_source=player&utm_content=overlaylink","_blank"))}),[]);return Pg.useEffect((()=>{!l&&n&&a.current&&(a.current=!1,s(-1),r(i.current,{transform:["translateY(0)","translateY(110%)"]},{type:lz,mass:1,stiffness:323,damping:30}).then((()=>{i.current&&(i.current.style.display="none")})))}),[l,n]),Pg.useEffect((()=>{i.current&&(i.current.style.display="none")}),[]),Ig.createElement(Ig.Fragment,null,Ig.createElement("button",{className:"eko-galleryBlockPauseButton",onClick:c,"aria-label":l?"Play":"Pause"},Ig.createElement(l?hz:uz,null)),Ig.createElement("div",{className:"eko-poweredByContainer",ref:i},Ig.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"8",height:"8",viewBox:"0 0 8 8",fill:"none"},Ig.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8 1.17622e-06L8 8L0 8C4.41828 8 8 4.41828 8 1.17622e-06Z",fill:"white"})),Ig.createElement("button",{className:"eko-poweredByTag",onClick:u,tabIndex:o},Ig.createElement("svg",{width:"89",height:"15",viewBox:"0 0 89 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Ig.createElement("path",{d:"M0.799006 11V3.72727H3.39134C3.95715 3.72727 4.4259 3.83026 4.79759 4.03622C5.16927 4.24219 5.44744 4.52391 5.6321 4.88139C5.81676 5.23651 5.90909 5.6366 5.90909 6.08168C5.90909 6.52912 5.81558 6.93158 5.62855 7.28906C5.44389 7.64418 5.16454 7.9259 4.79048 8.13423C4.4188 8.3402 3.95123 8.44318 3.38778 8.44318H1.60511V7.51278H3.28835C3.64583 7.51278 3.93584 7.45123 4.15838 7.32812C4.38092 7.20265 4.54427 7.0322 4.64844 6.81676C4.7526 6.60133 4.80469 6.3563 4.80469 6.08168C4.80469 5.80705 4.7526 5.56321 4.64844 5.35014C4.54427 5.13707 4.37973 4.97017 4.15483 4.84943C3.93229 4.72869 3.63873 4.66832 3.27415 4.66832H1.89631V11H0.799006ZM9.33949 11.1101C8.82813 11.1101 8.38187 10.9929 8.00071 10.7585C7.61955 10.5241 7.32363 10.1963 7.11293 9.77486C6.90223 9.35346 6.79688 8.86103 6.79688 8.29759C6.79688 7.73177 6.90223 7.23698 7.11293 6.81321C7.32363 6.38944 7.61955 6.06037 8.00071 5.82599C8.38187 5.59162 8.82813 5.47443 9.33949 5.47443C9.85085 5.47443 10.2971 5.59162 10.6783 5.82599C11.0594 6.06037 11.3554 6.38944 11.5661 6.81321C11.7768 7.23698 11.8821 7.73177 11.8821 8.29759C11.8821 8.86103 11.7768 9.35346 11.5661 9.77486C11.3554 10.1963 11.0594 10.5241 10.6783 10.7585C10.2971 10.9929 9.85085 11.1101 9.33949 11.1101ZM9.34304 10.2188C9.67448 10.2188 9.9491 10.1312 10.1669 9.95597C10.3847 9.78078 10.5457 9.54759 10.6499 9.25639C10.7564 8.9652 10.8097 8.64441 10.8097 8.29403C10.8097 7.94602 10.7564 7.62642 10.6499 7.33523C10.5457 7.04167 10.3847 6.80611 10.1669 6.62855C9.9491 6.45099 9.67448 6.36222 9.34304 6.36222C9.00923 6.36222 8.73224 6.45099 8.51207 6.62855C8.29427 6.80611 8.1321 7.04167 8.02557 7.33523C7.9214 7.62642 7.86932 7.94602 7.86932 8.29403C7.86932 8.64441 7.9214 8.9652 8.02557 9.25639C8.1321 9.54759 8.29427 9.78078 8.51207 9.95597C8.73224 10.1312 9.00923 10.2188 9.34304 10.2188ZM14.0838 11L12.4787 5.54545H13.576L14.6449 9.55114H14.6982L15.7706 5.54545H16.8679L17.9332 9.53338H17.9865L19.0483 5.54545H20.1456L18.544 11H17.4609L16.353 7.06179H16.2713L15.1634 11H14.0838ZM23.3381 11.1101C22.8007 11.1101 22.3378 10.9953 21.9496 10.7656C21.5637 10.5336 21.2654 10.2081 21.0547 9.78906C20.8464 9.36766 20.7422 8.87405 20.7422 8.30824C20.7422 7.74953 20.8464 7.2571 21.0547 6.83097C21.2654 6.40483 21.5589 6.07221 21.9354 5.8331C22.3142 5.59399 22.7569 5.47443 23.2635 5.47443C23.5713 5.47443 23.8696 5.52533 24.1584 5.62713C24.4472 5.72893 24.7064 5.88873 24.9361 6.10653C25.1657 6.32434 25.3468 6.60724 25.4794 6.95526C25.612 7.3009 25.6783 7.72112 25.6783 8.21591V8.59233H21.3423V7.79688H24.6378C24.6378 7.51752 24.581 7.27012 24.4673 7.05469C24.3537 6.83688 24.1939 6.66525 23.9879 6.53977C23.7843 6.4143 23.5452 6.35156 23.2706 6.35156C22.9723 6.35156 22.7119 6.42495 22.4893 6.57173C22.2692 6.71615 22.0987 6.90554 21.978 7.13991C21.8596 7.37192 21.8004 7.62405 21.8004 7.89631V8.51776C21.8004 8.88234 21.8643 9.19247 21.9922 9.44815C22.1224 9.70384 22.3035 9.89915 22.5355 10.0341C22.7675 10.1667 23.0386 10.233 23.3487 10.233C23.55 10.233 23.7334 10.2045 23.8991 10.1477C24.0649 10.0885 24.2081 10.0009 24.3288 9.88494C24.4496 9.76894 24.5419 9.62571 24.6058 9.45526L25.6108 9.63636C25.5303 9.93229 25.3859 10.1915 25.1776 10.4141C24.9716 10.6342 24.7124 10.8059 24.3999 10.929C24.0897 11.0497 23.7358 11.1101 23.3381 11.1101ZM26.8564 11V5.54545H27.8826V6.41193H27.9395C28.0389 6.11837 28.2141 5.88755 28.465 5.71946C28.7183 5.54901 29.0048 5.46378 29.3244 5.46378C29.3907 5.46378 29.4688 5.46615 29.5588 5.47088C29.6511 5.47562 29.7233 5.48153 29.7754 5.48864V6.50426C29.7328 6.49242 29.657 6.4794 29.5481 6.4652C29.4392 6.44863 29.3303 6.44034 29.2214 6.44034C28.9705 6.44034 28.7467 6.49361 28.5502 6.60014C28.3561 6.70431 28.2022 6.84991 28.0886 7.03693C27.975 7.22159 27.9181 7.43229 27.9181 7.66903V11H26.8564ZM32.8498 11.1101C32.3124 11.1101 31.8496 10.9953 31.4613 10.7656C31.0754 10.5336 30.7771 10.2081 30.5664 9.78906C30.3581 9.36766 30.2539 8.87405 30.2539 8.30824C30.2539 7.74953 30.3581 7.2571 30.5664 6.83097C30.7771 6.40483 31.0707 6.07221 31.4471 5.8331C31.8259 5.59399 32.2686 5.47443 32.7752 5.47443C33.083 5.47443 33.3813 5.52533 33.6701 5.62713C33.9589 5.72893 34.2182 5.88873 34.4478 6.10653C34.6774 6.32434 34.8585 6.60724 34.9911 6.95526C35.1237 7.3009 35.19 7.72112 35.19 8.21591V8.59233H30.854V7.79688H34.1495C34.1495 7.51752 34.0927 7.27012 33.979 7.05469C33.8654 6.83688 33.7056 6.66525 33.4996 6.53977C33.296 6.4143 33.0569 6.35156 32.7823 6.35156C32.484 6.35156 32.2236 6.42495 32.0011 6.57173C31.7809 6.71615 31.6104 6.90554 31.4897 7.13991C31.3713 7.37192 31.3121 7.62405 31.3121 7.89631V8.51776C31.3121 8.88234 31.3761 9.19247 31.5039 9.44815C31.6341 9.70384 31.8152 9.89915 32.0472 10.0341C32.2792 10.1667 32.5503 10.233 32.8604 10.233C33.0617 10.233 33.2451 10.2045 33.4109 10.1477C33.5766 10.0885 33.7198 10.0009 33.8406 9.88494C33.9613 9.76894 34.0536 9.62571 34.1175 9.45526L35.1225 9.63636C35.042 9.93229 34.8976 10.1915 34.6893 10.4141C34.4833 10.6342 34.2241 10.8059 33.9116 10.929C33.6014 11.0497 33.2475 11.1101 32.8498 11.1101ZM38.41 11.1065C37.9696 11.1065 37.5766 10.9941 37.231 10.7692C36.8877 10.5419 36.6178 10.2187 36.4213 9.79972C36.2272 9.37831 36.1301 8.87287 36.1301 8.28338C36.1301 7.69389 36.2284 7.18963 36.4249 6.7706C36.6238 6.35156 36.896 6.03078 37.2417 5.80824C37.5873 5.5857 37.9791 5.47443 38.4171 5.47443C38.7556 5.47443 39.0279 5.53125 39.2338 5.64489C39.4422 5.75616 39.6032 5.88636 39.7168 6.03551C39.8328 6.18466 39.9228 6.31605 39.9867 6.42969H40.0506V3.72727H41.1124V11H40.0755V10.1513H39.9867C39.9228 10.2673 39.8304 10.3999 39.7097 10.549C39.5913 10.6982 39.428 10.8284 39.2196 10.9396C39.0113 11.0509 38.7414 11.1065 38.41 11.1065ZM38.6444 10.201C38.9498 10.201 39.2078 10.1205 39.4185 9.95952C39.6316 9.79616 39.7926 9.57008 39.9015 9.28125C40.0127 8.99242 40.0684 8.65625 40.0684 8.27273C40.0684 7.89394 40.0139 7.5625 39.905 7.27841C39.7961 6.99432 39.6363 6.77296 39.4256 6.61435C39.2149 6.45573 38.9545 6.37642 38.6444 6.37642C38.3248 6.37642 38.0584 6.45928 37.8453 6.625C37.6323 6.79072 37.4713 7.01681 37.3624 7.30327C37.2559 7.58973 37.2026 7.91288 37.2026 8.27273C37.2026 8.63731 37.257 8.9652 37.3659 9.25639C37.4748 9.54759 37.6358 9.77841 37.8489 9.94886C38.0643 10.117 38.3295 10.201 38.6444 10.201ZM45.3596 11V3.72727H46.4213V6.42969H46.4853C46.5468 6.31605 46.6356 6.18466 46.7516 6.03551C46.8676 5.88636 47.0286 5.75616 47.2346 5.64489C47.4405 5.53125 47.7128 5.47443 48.0513 5.47443C48.4917 5.47443 48.8846 5.5857 49.2303 5.80824C49.5759 6.03078 49.847 6.35156 50.0435 6.7706C50.2424 7.18963 50.3418 7.69389 50.3418 8.28338C50.3418 8.87287 50.2435 9.37831 50.0471 9.79972C49.8506 10.2187 49.5807 10.5419 49.2374 10.7692C48.8941 10.9941 48.5023 11.1065 48.062 11.1065C47.7305 11.1065 47.4595 11.0509 47.2488 10.9396C47.0404 10.8284 46.8771 10.6982 46.7587 10.549C46.6403 10.3999 46.5492 10.2673 46.4853 10.1513H46.3965V11H45.3596ZM46.4 8.27273C46.4 8.65625 46.4557 8.99242 46.5669 9.28125C46.6782 9.57008 46.8392 9.79616 47.0499 9.95952C47.2606 10.1205 47.5186 10.201 47.824 10.201C48.1413 10.201 48.4064 10.117 48.6195 9.94886C48.8326 9.77841 48.9935 9.54759 49.1025 9.25639C49.2137 8.9652 49.2694 8.63731 49.2694 8.27273C49.2694 7.91288 49.2149 7.58973 49.106 7.30327C48.9995 7.01681 48.8385 6.79072 48.623 6.625C48.41 6.45928 48.1436 6.37642 47.824 6.37642C47.5163 6.37642 47.2559 6.45573 47.0428 6.61435C46.8321 6.77296 46.6723 6.99432 46.5634 7.27841C46.4545 7.5625 46.4 7.89394 46.4 8.27273ZM52.0197 13.0455C51.8611 13.0455 51.7167 13.0324 51.5865 13.0064C51.4563 12.9827 51.3592 12.9567 51.2953 12.9283L51.551 12.0582C51.7451 12.1103 51.9179 12.1328 52.0694 12.1257C52.2209 12.1186 52.3547 12.0618 52.4707 11.9553C52.5891 11.8487 52.6932 11.6747 52.7832 11.4332L52.9146 11.071L50.9189 5.54545H52.0552L53.4366 9.77841H53.4934L54.8748 5.54545H56.0147L53.7669 11.728C53.6627 12.0121 53.5301 12.2524 53.3691 12.4489C53.2082 12.6477 53.0164 12.7969 52.7939 12.8963C52.5713 12.9957 52.3133 13.0455 52.0197 13.0455Z",fill:"#222222"}),Ig.createElement("path",{d:"M79.688 3.59774H76.286L73.4634 7.96468V0H70.5759V12.5848H73.1037L74.9421 10.0776L76.7805 12.5848H80.4773L76.6456 7.75047L79.688 3.59774Z",fill:"#222222"}),Ig.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M79.3383 8.08639C79.3383 5.48667 81.5015 3.37866 84.1692 3.37866C86.8419 3.37866 89.005 5.48667 89 8.08639C89 10.6861 86.8369 12.7941 84.1692 12.7941C81.5015 12.7941 79.3383 10.6861 79.3383 8.08639ZM82.2358 8.09126C82.2358 9.24993 83.1001 10.0873 84.1692 10.0873C85.2382 10.0873 86.1025 9.24507 86.1025 8.09126C86.1025 6.93258 85.2382 6.09035 84.1692 6.09035C83.1001 6.09035 82.2358 6.93258 82.2358 8.09126Z",fill:"#222222"}),Ig.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M60 8.08639C60 5.48667 62.1631 3.37866 64.8308 3.37866C67.4985 3.37866 69.6617 5.48667 69.6617 8.08639C69.6617 8.38823 69.6317 8.6852 69.5767 8.97243H62.8925C63.2222 9.88282 63.9516 10.3453 64.8558 10.3453C65.7201 10.3453 66.1097 10.097 66.4145 9.74651H69.3519C68.6625 11.5283 66.8991 12.7941 64.8308 12.7941C62.1631 12.7941 60 10.6861 60 8.08639ZM64.8308 5.84692C63.9516 5.84692 63.2022 6.35324 62.8925 7.20034H66.7692C66.4644 6.35324 65.7101 5.84692 64.8308 5.84692Z",fill:"#222222"}))),Ig.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"8",height:"8",viewBox:"0 0 8 8",fill:"none"},Ig.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M5.46164e-05 0.0300705L5.53131e-05 8L8 8C3.59175 8 0.0162617 4.43452 5.46164e-05 0.0300705Z",fill:"white"}))))}By('.eko-galleryModuleSteps {\n  --stepSize: 6px;\n  --stepPadding: 7px;\n  padding: 4px;\n  bottom: 12px;\n  left: 50%;\n  position: absolute;\n  display: flex;\n  align-items: center;\n  animation-duration: 0.75s;\n  animation-timing-function: cubic-bezier(0.36, 0, 0, 1);\n  animation-fill-mode: both;\n  animation-delay: 0.15s;\n  animation-name: gallery-steps-appear-anim;\n}\n@keyframes gallery-steps-appear-anim {\n  from {\n    opacity: 0;\n    transform: translate(-50%, 10px);\n  }\n  to {\n    opacity: 1;\n    transform: translate(-50%, 0);\n  }\n}\n.eko-galleryModuleSteps .eko-stepButton {\n  padding: var(--stepPadding);\n  border: none;\n  background: transparent;\n  cursor: pointer;\n}\n.eko-galleryModuleSteps .eko-stepButton:has(> .tiny) {\n  pointer-events: none;\n  cursor: default;\n}\n.eko-galleryModuleSteps .eko-stepButton span {\n  display: block;\n  width: var(--stepSize);\n  height: var(--stepSize);\n  border-radius: var(--stepSize);\n  background-color: rgba(0, 0, 0, 0.15);\n  box-sizing: border-box;\n  pointer-events: none;\n  transition: all 0.3s ease-in-out;\n}\n.eko-galleryModuleSteps .eko-stepButton span.currentStep {\n  background-color: rgba(0, 0, 0, 0.6);\n}\n.eko-galleryModuleSteps .eko-stepButton span.tiny {\n  width: calc(var(--stepSize) / 2);\n  height: calc(var(--stepSize) / 2);\n}\n.eko-galleryModuleSteps .eko-stepButton span:after {\n  content: "";\n  background-color: rgba(0, 0, 0, 0.6);\n  position: absolute;\n  border-radius: var(--stepSize);\n  width: 0;\n  height: 100%;\n  top: 0;\n  left: -100%;\n  opacity: 0;\n  transform: translateX(0);\n  animation-play-state: paused;\n}\n.eko-galleryModuleSteps.withDuration .eko-stepButton span {\n  position: relative;\n  overflow: hidden;\n}\n.eko-galleryModuleSteps.withDuration .eko-stepButton span:after {\n  transition: 0.3s ease-in-out;\n  transition-property: opacity, width;\n}\n.eko-galleryModuleSteps.withDuration .eko-stepButton span.currentStep {\n  width: 40px;\n  background-color: rgba(0, 0, 0, 0.15);\n}\n.eko-galleryModuleSteps.withDuration .eko-stepButton span.currentStep:after {\n  opacity: 100%;\n  width: 40px;\n  animation: stepDurationAnimation var(--currentDuration) linear forwards;\n  animation-play-state: running;\n}\n@keyframes stepDurationAnimation {\n  0% {\n    transform: translateX(0);\n  }\n  100% {\n    transform: translateX(100%);\n  }\n}');const gz=[[{transform:"translate(calc(-50% + 10px), 0)"},{transform:"translate(-50%, 0)"}],{fill:"forwards",duration:200}],mz=[[{transform:"translate(calc(-50%, -10px), 0)"},{transform:"translate(-50%, 0)"}],{fill:"forwards",duration:200}];function yz(e){const{steps:t,currentStepIndex:n,showDuration:i,onStepClick:r}=e,o=Pg.useRef(null),s=Pg.useRef({lastStepIndex:n,shouldAnimate:!1});return Pg.useEffect((()=>{if(o.current){const{lastStepIndex:e,shouldAnimate:t}=s.current;t&&n>e?o.current.animate(...gz):t&&n<e&&o.current.animate(...mz)}s.current.lastStepIndex=n}),[n]),t.length>1?Ig.createElement("div",{className:"eko-galleryModuleSteps "+(i?"withDuration":""),ref:o,role:"group","aria-roledescription":"Sequence navgation buttons"},function(){let e;if(t.length>5){e=[{index:n,className:"currentStep"}];for(let i=1;e.length<5;i++)n-i>=0&&e.unshift({index:n-i}),n+i<t.length&&e.push({index:n+i});e[0].className||e[1].className||(e[0].className="tiny"),e[4].className||e[3].className||(e[4].className="tiny"),s.current.shouldAnimate="currentStep"===e[2].className}else e=t.map(((e,t)=>({index:t,className:t===n?"currentStep":""})));return e.map((e=>Ig.createElement("button",{key:e.index,className:"eko-stepButton",onClick:t=>function(e,t){e.stopPropagation(),r(t)}(t,e.index)},Ig.createElement("span",{className:e.className,"aria-label":`Go to step ${e.index+1}`}))))}()):null}function vz({stylingVars:e}){return e?Ig.createElement("style",null,`.eko-galleryBlockContainer {${e}}`):null}const bz=Ig.lazy((()=>import("../MoreEkoInformation-BpZUki2R.js"))),wz=({player:e,currentStepIndex:t,currentGalleryItemIndex:n,steps:i=[],bodyTextColor:r,bodyBackgroundColor:o,buttonTextColor:s,buttonBackgroundColor:a,buttonShape:l,onNextClick:c,onPrevClick:u,onStepClick:d,enableSlideTransition:h,galleryItems:p,onItemClick:f,layoutOptions:g,showGalleryItems:m,shouldAnimateEntrance:y,onUpdateGestureSwitcher:v,showPauseButton:b,showPBE:w,currentDuration:k,showDuration:x,ModuleComponent:S,stylingVars:C})=>{var _;const E=Pg.useRef(),T=Pg.useRef(),P=null!==(_=g.navButtonsLocation)&&void 0!==_?_:"video";let I=["eko-galleryBlockContainer",i.length>1?"hasSteps":"",y?"animate":""].join(" "),A={default:"var(--secondaryColor)",black:"black",white:"white",Primary:"var(--primaryColor)",Secondary:"var(--secondaryColor)"},O={default:"var(--primaryColor)",black:"rgba(0,0,0,0.7)",white:"rgba(255, 255, 255, 0.8)",Primary:"var(--primaryColor)",Secondary:"var(--secondaryColor)"},L=(null==r?void 0:r.startsWith("#"))&&r||A[r]||A.default,N=(null==o?void 0:o.startsWith("#"))&&o||O[o]||O.default,R={"--bodyTextColor":L,"--bodyBackgroundColor":N,"--buttonTextColor":s,"--buttonBackgroundColor":a,"--buttonsContainerHeight":`${m?g.buttonsContainerHeight:0}px`,"--uiOpacity":"1","--uiXPosition":"0px","--currentDuration":k+"s"};const D=Pg.useCallback((e=>{E.current.style.setProperty("--uiOpacity","1"),E.current.style.setProperty("--uiXPosition","0px"),u(e,"gesture")}),[u]),M=Pg.useCallback((e=>{E.current.style.setProperty("--uiOpacity","1"),E.current.style.setProperty("--uiXPosition","0px"),c(e,"gesture")}),[c]),F=Pg.useCallback(((e,t)=>{E.current.style.setProperty("--uiOpacity",Math.max(1-3.5*e.percent,0)),E.current.style.setProperty("--uiXPosition",`${e.x}px`),null==v||v(e,t)}),[v]);return Pg.useEffect((()=>{var e;null===(e=T.current)||void 0===e||e.setAttribute("tabIndex",-1)}),[S]),Ig.createElement("section",{className:I,ref:E,style:R},Ig.createElement(vz,{stylingVars:C}),Ig.createElement("div",{className:"eko-galleryContent"},h&&Ig.createElement(XU,{onUpdate:F,onSwitchedToPrev:D,onSwitchedToNext:M}),Ig.createElement("div",{className:"eko-moduleContainer",ref:T},S&&Ig.createElement(S,{buttonShape:l,buttonTextColor:s,buttonBackgroundColor:a})),!h&&"video"===P&&Ig.createElement("div",{className:"eko-seqNavigationContainer"},Ig.createElement(yj,{type:"prev",onClick:e=>u(e,"click")}),Ig.createElement(yj,{type:"next",onClick:e=>c(e,"click")})),Ig.createElement(yz,{key:n,steps:i,currentStepIndex:t,onStepClick:d,showDuration:x}),b&&Ig.createElement(fz,{player:e,showPBE:w}),!h&&w&&Ig.createElement(Pg.Suspense,{fallback:null},Ig.createElement(bz,null))),m&&Ig.createElement(vj,{galleryItems:p,currentGalleryItemIndex:n,selectedBodyTextColor:L,selectedBodyBackgroundColor:N,onItemClick:f,showNavigationButtons:!h,labelsOnly:g.labelsOnly,enableNav:"nav"===P,onPrevClick:u,onNextClick:c}))};wz.propTypes={currentStepIndex:Ov.number.isRequired,currentGalleryItemIndex:Ov.number.isRequired,steps:Ov.array.isRequired,buttonTextColor:Ov.string,buttonBackgroundColor:Ov.string,bodyTextColor:Ov.string,bodyBackgroundColor:Ov.string,buttonShape:Ov.string,onPrevClick:Ov.func.isRequired,onNextClick:Ov.func.isRequired,enableGestures:Ov.bool,galleryItems:Ov.array,onItemClick:Ov.func.isRequired,showSingleStep:Ov.bool,showGalleryItems:Ov.bool,ModuleComponent:Ov.func};var kz={displayName:"Gallery Block",blockFamily:"sequence",description:"A block that works inside a gallery",variables:[],integrationFeatures:[]};function xz({title:e,description:t,textColor:n,bgColor:i}){const[r,o]=Pg.useState(!1),[s,a]=Pg.useState(!1),l=Pg.useRef(null),c=fD(e);Pg.useLayoutEffect((()=>{if(l.current){const e=l.current,t=e.querySelector(".textWrapper"),n=new ResizeObserver((()=>{e.style.setProperty("--descHeight",`${t.clientHeight}px`)}));return n.observe(t),()=>{n.disconnect()}}}),[]),Pg.useLayoutEffect((()=>{if(l.current){const e=l.current;e.style.height="";const t=e.querySelector(".textWrapper");e.style.setProperty("--descHeight",`${t.clientHeight}px`);const n=e.scrollWidth>e.clientWidth;a(n),n||(o(!0),e.style.height="auto")}}),[t]);const u=Pg.useCallback((e=>{e.preventDefault(),e.stopPropagation(),o(!r),TA.trackInteraction({elementid:r?"read_less":"read_more",elementtype:TA.elementTypes[r?"COLLAPSE":"EXPAND"],interactiontype:TA.interactionTypes.MODULE})}),[r]),d=Pg.useCallback((e=>{e.stopPropagation(),o(!0)}),[]),h={"--textBoxColor":n,"--textBoxBg":Pg.useMemo((()=>{if(i){const e=JB(i).toRgb();return`${e.r}, ${e.g}, ${e.b}`}}),[i])};return t?Ig.createElement("div",{className:"eko-textBoxDescriptionBox "+(r?"expanded":""),style:h},e&&Ig.createElement("div",{className:"step-title"},c),Ig.createElement("div",{className:"step-description",ref:l},Ig.createElement("div",{className:"textWrapper"},t,s&&Ig.createElement("a",{href:"#",onClick:u},"Read less")),s&&Ig.createElement("div",{className:"step-description-facade",onClick:d},Ig.createElement("div",null,t),Ig.createElement("a",{href:"#",onClick:u},"Read more")))):e?Ig.createElement("div",{className:"eko-textBoxTitleContainer",style:h},Ig.createElement("div",{className:"step-title"},c)):null}function Sz(e){const{optionsLabel:t,options:n,backgroundColor:i,currentOptionIndex:r}=e,o=n[r];return Ig.createElement("div",{className:"eko-toggleModuleContainer"},Ig.createElement("div",{className:"eko-toggleOptionsContainer",style:{"--toggleBgColor":i}},t&&Ig.createElement("div",{className:"eko-options-label"},t),Ig.createElement("div",{className:`eko-toggleOptions selected-${r}`},n.map((({label:e,note:t,onClick:n},i)=>Ig.createElement("div",{className:"button-helper-container",key:i,style:{"--button-index":i}},Ig.createElement("button",{"aria-selected":r===i,onClick:n,className:"option-button"},e),t&&Ig.createElement("div",{className:"option-note"},t)))))),Ig.createElement(xz,Ja({key:r},o.textBox)))}By('.bp-vertical-small {\n  --gizmoPadding: 16px;\n  --navigationHeight: 5.2em;\n  font-size: 12px;\n  line-height: 14px;\n}\n\n.bp-vertical-medium {\n  --gizmoPadding: 24px;\n  --navigationHeight: 5.2em;\n  font-size: 16px;\n  line-height: 17px;\n}\n\n.eko-galleryBlockContainer {\n  --toggleModule_gap: 8px;\n  --toggleModule_padding: 16px 20px 0px;\n  --toggleModule_options_padding: 2px;\n  --toggleModule_options_height: 44px;\n  --toggleModule_options_width: 355px;\n  --toggleModule_button_backgroundColor: #FFFFFF;\n  --toggleModule_button_padding: 10px 20px;\n  --toggleModule_button_boxShadow: 0px 2px 8px 2px rgba(0, 0, 0, 0.07);\n  --toggleModule_button_text_fontFamily: var(--fontName);\n  --toggleModule_button_text_fontSize: 14px;\n  --toggleModule_button_text_fontWeight: 500;\n  --toggleModule_button_text_fontStyle: normal;\n  --toggleModule_button_text_lineHeight: 120%;\n  --toggleModule_button_text_letterSpacing: -0.2px;\n  --toggleModule_button_text_color: #000;\n  --toggleModule_title_fontFamily: var(--fontName);\n  --toggleModule_title_fontSize: 13px;\n  --toggleModule_title_fontWeight: 400;\n  --toggleModule_title_fontStyle: normal;\n  --toggleModule_title_lineHeight: 120%;\n  --toggleModule_title_letterSpacing: 0;\n  --toggleModule_title_color: #666;\n  --toggleModule_title_textAlignment: center;\n  --toggleModule_note_fontFamily: var(--fontName);\n  --toggleModule_note_fontSize: 12px;\n  --toggleModule_note_fontWeight: 400;\n  --toggleModule_note_fontStyle: normal;\n  --toggleModule_note_lineHeight: 120%;\n  --toggleModule_note_letterSpacing: 0;\n  --toggleModule_note_color: #888;\n  --toggleModule_note_topMargin: 4px;\n}\n.eko-galleryBlockContainer .eko-toggleOptionsContainer {\n  position: absolute;\n  top: 0;\n  padding: var(--toggleModule_padding);\n  width: 100%;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  gap: var(--toggleModule_gap);\n  pointer-events: auto;\n  box-sizing: border-box;\n}\n.eko-galleryBlockContainer .eko-options-label {\n  font-family: var(--toggleModule_title_fontFamily);\n  font-size: var(--toggleModule_title_fontSize);\n  font-weight: var(--toggleModule_title_fontWeight);\n  font-style: var(--toggleModule_title_fontStyle);\n  line-height: var(--toggleModule_title_lineHeight);\n  letter-spacing: var(--toggleModule_title_letterSpacing);\n  color: var(--toggleModule_title_color);\n  text-align: var(--toggleModule_title_textAlignment);\n  width: var(--toggleModule_options_width);\n  max-width: 90%;\n}\n.eko-galleryBlockContainer .eko-toggleOptions {\n  background-color: var(--toggleBgColor, #F2F2F2);\n  width: var(--toggleModule_options_width);\n  height: var(--toggleModule_options_height);\n  padding: var(--toggleModule_options_padding);\n  display: flex;\n  margin: 0;\n  max-width: 90%;\n  border-radius: 100px;\n}\n.eko-galleryBlockContainer .eko-toggleOptions svg {\n  display: none;\n}\n.eko-galleryBlockContainer .eko-toggleOptions .button-helper-container {\n  position: relative;\n  flex: 1;\n  min-width: 0;\n}\n.eko-galleryBlockContainer .eko-toggleOptions .button-helper-container:first-of-type:before {\n  content: "";\n  position: absolute;\n  top: 0;\n  left: 0;\n  bottom: 0;\n  right: 0;\n  border-radius: 100px;\n  background: var(--toggleModule_button_backgroundColor);\n  box-shadow: var(--toggleModule_button_boxShadow);\n  transition: transform 0.3s ease-in-out;\n}\n.eko-galleryBlockContainer .eko-toggleOptions .button-helper-container:has(button[aria-selected=true]) .option-note {\n  animation: optionNoteIn 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards 0.3s;\n}\n.eko-galleryBlockContainer .eko-toggleOptions.selected-0 .button-helper-container:first-of-type:before {\n  transform: translateX(calc(100% * 0));\n}\n.eko-galleryBlockContainer .eko-toggleOptions.selected-1 .button-helper-container:first-of-type:before {\n  transform: translateX(calc(100% * 1));\n}\n.eko-galleryBlockContainer .eko-toggleOptions.selected-2 .button-helper-container:first-of-type:before {\n  transform: translateX(calc(100% * 2));\n}\n.eko-galleryBlockContainer .eko-toggleOptions.selected-3 .button-helper-container:first-of-type:before {\n  transform: translateX(calc(100% * 3));\n}\n.eko-galleryBlockContainer .eko-toggleOptions.selected-4 .button-helper-container:first-of-type:before {\n  transform: translateX(calc(100% * 4));\n}\n.eko-galleryBlockContainer .eko-toggleOptions .option-note {\n  position: absolute;\n  opacity: 0;\n  top: 100%;\n  left: 50%;\n  text-align: center;\n  width: max-content;\n  max-width: 200%;\n  translate: -50% var(--toggleModule_note_topMargin);\n  color: var(--toggleModule_note_color);\n  font-family: var(--toggleModule_note_fontFamily);\n  font-size: var(--toggleModule_note_fontSize);\n  font-weight: var(--toggleModule_note_fontWeight);\n  font-style: var(--toggleModule_note_fontStyle);\n  line-height: var(--toggleModule_note_lineHeight);\n  letter-spacing: var(--toggleModule_note_letterSpacing);\n}\n.eko-galleryBlockContainer .eko-toggleOptions .option-button {\n  border-radius: var(--toggleModule_button_borderRadius);\n  font-family: var(--toggleModule_button_text_fontFamily);\n  font-size: var(--toggleModule_button_text_fontSize);\n  font-weight: var(--toggleModule_button_text_fontWeight);\n  font-style: var(--toggleModule_button_text_fontStyle);\n  line-height: var(--toggleModule_button_text_lineHeight);\n  letter-spacing: var(--toggleModule_button_text_letterSpacing);\n  color: var(--toggleModule_button_text_color);\n  padding: var(--toggleModule_button_padding);\n  background: transparent;\n  width: 100%;\n  height: 100%;\n  text-overflow: ellipsis;\n  overflow: hidden;\n  white-space: nowrap;\n  border-style: none;\n  cursor: pointer;\n  position: relative;\n  animation-duration: 0.5s;\n  animation-timing-function: cubic-bezier(0.36, 0, 0, 1);\n  animation-fill-mode: both;\n  animation-delay: calc(var(--button-index) * 90ms);\n  animation-name: button-back-appear-anim;\n  transform-origin: bottom center;\n}\n@keyframes button-back-appear-anim {\n  from {\n    transform: scale(0);\n  }\n  to {\n    transform: scale(1);\n  }\n}\n@keyframes optionNoteIn {\n  0% {\n    opacity: 0;\n    translate: -50% -5px;\n  }\n  100% {\n    opacity: 1;\n    translate: -50% var(--toggleModule_note_topMargin);\n  }\n}\n@keyframes optionNoteOut {\n  0% {\n    opacity: 1;\n  }\n  100% {\n    opacity: 0;\n  }\n}'),By(".bp-vertical-small {\n  --gizmoPadding: 16px;\n  --navigationHeight: 5.2em;\n  font-size: 12px;\n  line-height: 14px;\n}\n\n.bp-vertical-medium {\n  --gizmoPadding: 24px;\n  --navigationHeight: 5.2em;\n  font-size: 16px;\n  line-height: 17px;\n}\n\n.eko-galleryBlockContainer {\n  --textBox_gap: 8px;\n  --textBox_paddingTop: 88px;\n  --textBox_title_fontFamily: var(--fontName);\n  --textBox_title_fontSize: 20px;\n  --textBox_title_fontStyle: normal;\n  --textBox_title_fontWeight: 600;\n  --textBox_title_lineHeight: 130%;\n  --textBox_title_letterSpacing: -0.2px;\n  --textBox_description_fontFamily: var(--fontName);\n  --textBox_description_fontSize: 13px;\n  --textBox_description_fontStyle: normal;\n  --textBox_description_fontWeight: 400;\n  --textBox_description_lineHeight: 150%;\n  --textBox_description_letterSpacing: 0px;\n}\n.eko-galleryBlockContainer .eko-textBoxTitleContainer {\n  position: absolute;\n  bottom: 0;\n  width: 100%;\n  color: var(--textBoxColor, #000000);\n  box-sizing: border-box;\n  padding: var(--textBox_paddingTop) 64px 24px 64px;\n  pointer-events: none;\n  text-align: center;\n  background: linear-gradient(180deg, rgba(var(--textBoxBg, 246, 246, 246), 0) 35.5%, rgba(var(--textBoxBg, 246, 246, 246), 0.8) 100%), linear-gradient(180deg, rgba(var(--textBoxBg, 246, 246, 246), 0) 0%, rgba(var(--textBoxBg, 246, 246, 246), 0.4) 25.24%, rgba(var(--textBoxBg, 246, 246, 246), 0.7) 49.8%, rgba(var(--textBoxBg, 246, 246, 246), 0.95) 75.46%, rgba(var(--textBoxBg, 246, 246, 246), 1) 100%);\n}\n.eko-galleryBlockContainer .eko-textBoxDescriptionBox {\n  color: var(--textBoxColor, #000000);\n  position: absolute;\n  bottom: 0;\n  display: flex;\n  flex-direction: column;\n  gap: var(--textBox_gap);\n  padding: var(--textBox_paddingTop) 64px 24px 24px;\n  width: 100%;\n  box-sizing: border-box;\n  pointer-events: none;\n  background: linear-gradient(180deg, rgba(var(--textBoxBg, 246, 246, 246), 0) 35.5%, rgba(var(--textBoxBg, 246, 246, 246), 0.8) 100%), linear-gradient(180deg, rgba(var(--textBoxBg, 246, 246, 246), 0) 0%, rgba(var(--textBoxBg, 246, 246, 246), 0.4) 25.24%, rgba(var(--textBoxBg, 246, 246, 246), 0.7) 49.8%, rgba(var(--textBoxBg, 246, 246, 246), 0.95) 75.46%, rgba(var(--textBoxBg, 246, 246, 246), 1) 100%);\n}\n.eko-galleryBlockContainer .eko-textBoxDescriptionBox .step-description {\n  overflow: hidden;\n  position: relative;\n  height: 20px;\n  transition: all 0.4s cubic-bezier(0, 1, 0.25, 1);\n  font-family: var(--textBox_description_fontFamily);\n  font-size: var(--textBox_description_fontSize);\n  font-weight: var(--textBox_description_fontWeight);\n  font-style: var(--textBox_description_fontStyle);\n  line-height: var(--textBox_description_lineHeight);\n  letter-spacing: var(--textBox_description_letterSpacing);\n  white-space: nowrap;\n}\n.eko-galleryBlockContainer .eko-textBoxDescriptionBox .step-description:has(> .step-description-facade) .textWrapper {\n  opacity: 0;\n}\n.eko-galleryBlockContainer .eko-textBoxDescriptionBox .step-description a {\n  display: block;\n  color: var(--textBoxColor, #000000);\n  font-size: 12px;\n  font-weight: 700;\n  line-height: 150%;\n  pointer-events: auto;\n  padding-top: 8px;\n}\n.eko-galleryBlockContainer .eko-textBoxDescriptionBox .step-description .step-description-facade {\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  height: 20px;\n  display: flex;\n  align-items: baseline;\n  color: var(--textBoxColor, #000000);\n  pointer-events: auto;\n}\n.eko-galleryBlockContainer .eko-textBoxDescriptionBox .step-description .step-description-facade div {\n  flex: 1;\n  white-space: nowrap;\n  overflow: hidden;\n  mask: linear-gradient(270deg, rgba(0, 0, 0, 0) 0%, rgba(0, 0, 0, 0.1) 10.3969%, rgb(0, 0, 0) 19.9273%, rgb(0, 0, 0) 100%);\n}\n.eko-galleryBlockContainer .eko-textBoxDescriptionBox .step-description .step-description-facade a {\n  padding-top: 0;\n}\n.eko-galleryBlockContainer .eko-textBoxDescriptionBox.expanded .step-description {\n  height: var(--descHeight, 160px);\n  mask: none;\n  pointer-events: none;\n  cursor: default;\n  color: var(--textBoxColor, #000000);\n  white-space: pre-wrap;\n}\n.eko-galleryBlockContainer .eko-textBoxDescriptionBox.expanded .step-description .textWrapper {\n  opacity: 1;\n}\n.eko-galleryBlockContainer .eko-textBoxDescriptionBox.expanded .step-description .step-description-facade {\n  opacity: 0;\n}\n.eko-galleryBlockContainer .eko-textBoxDescriptionBox.expanded .step-description .step-description-facade a {\n  pointer-events: none;\n}\n.eko-galleryBlockContainer .eko-textBoxDescriptionBox.expanded:has(> .step-description > .step-description-facade) {\n  background: linear-gradient(180deg, rgba(var(--textBoxBg, 246, 246, 246), 0) 34.85%, rgba(var(--textBoxBg, 246, 246, 246), 0.6) 100%), linear-gradient(180deg, rgba(var(--textBoxBg, 246, 246, 246), 0) 0.09%, rgba(var(--textBoxBg, 246, 246, 246), 0.95) 32.13%, rgba(var(--textBoxBg, 246, 246, 246), 1) 99.91%);\n}\n.eko-galleryBlockContainer .step-title {\n  font-family: var(--textBox_title_fontFamily);\n  font-size: var(--textBox_title_fontSize);\n  font-weight: var(--textBox_title_fontWeight);\n  font-style: var(--textBox_title_fontStyle);\n  line-height: var(--textBox_title_lineHeight);\n  letter-spacing: var(--textBox_title_letterSpacing);\n  overflow: visible;\n  white-space: normal;\n}\n.eko-galleryBlockContainer.hasSteps .eko-textBoxDescriptionBox {\n  padding: var(--textBox_paddingTop) 64px 48px 24px;\n}\n.eko-galleryBlockContainer.hasSteps .eko-textBoxDescriptionBox a {\n  bottom: 48px;\n}\n.eko-galleryBlockContainer.hasSteps .eko-textBoxTitleContainer {\n  padding: var(--textBox_paddingTop) 64px 48px 64px;\n}");const Cz=100,_z=10;var Ez=new WeakMap,Tz=new WeakMap;const Pz="module.end";var Iz=new WeakMap,Az=new WeakMap;function Oz(e){const{numOfStories:t,currentStory:n,title:i,storyDuration:r,onNextStory:o,player:s,resetCounter:a}=e;let l=s.ui.useSelector((e=>e.player.isPaused));const c=Pg.useCallback((e=>{const t=e.target;l||!t.classList.contains("gestureSwitcherContainer")&&!t.classList.contains("eko-galleryBlockContainer")||(e.stopPropagation(),o(n))}),[o,n,l]);Pg.useEffect((()=>(window.addEventListener("click",c,{capture:!0}),()=>{window.removeEventListener("click",c,{capture:!0})})),[c]);const u=Array(t).fill(1).map(((e,t)=>{const i=["eko-storyIndicator",t<n?"shown":"",t===n?"current":""].join(" ");return Ig.createElement("div",{className:i,key:t})}));return Ig.createElement("div",{className:"eko-storiesContainer",style:{"--storyDuration":r+"s"}},Ig.createElement("div",{className:"eko-storiesBar",key:a},u),i&&Ig.createElement("div",{className:"eko-storyTitle"},i))}By('.bp-vertical-small {\n  --gizmoPadding: 16px;\n  --navigationHeight: 5.2em;\n  font-size: 12px;\n  line-height: 14px;\n}\n\n.bp-vertical-medium {\n  --gizmoPadding: 24px;\n  --navigationHeight: 5.2em;\n  font-size: 16px;\n  line-height: 17px;\n}\n\n.eko-galleryBlockContainer .eko-storiesContainer {\n  position: relative;\n  width: 100%;\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  padding: 10px;\n  gap: 10px;\n  box-sizing: border-box;\n}\n.eko-galleryBlockContainer .eko-storiesContainer:before {\n  content: "";\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  height: 64px;\n  opacity: 0;\n  transition: opacity 0.2s;\n  background: linear-gradient(180deg, rgba(0, 0, 0, 0.5) 0%, rgba(0, 0, 0, 0.4) 54.19%, rgba(0, 0, 0, 0.1) 83.21%, rgba(0, 0, 0, 0) 100%);\n}\n.eko-galleryBlockContainer .eko-storiesContainer:has(> .eko-storyTitle):before {\n  opacity: 100%;\n}\n.eko-galleryBlockContainer .eko-storiesBar {\n  width: 100%;\n  display: flex;\n  justify-content: center;\n  gap: 10px;\n}\n.eko-galleryBlockContainer .eko-storyIndicator {\n  position: relative;\n  flex: 1;\n  max-width: 77px;\n  height: 5px;\n  background-color: rgba(255, 255, 255, 0.4);\n  border-radius: 2px;\n  box-shadow: 0 0 6px 1px rgba(0, 0, 0, 0.2);\n  overflow: hidden;\n}\n.eko-galleryBlockContainer .eko-storyIndicator.shown {\n  background-color: #ffffff;\n}\n.eko-galleryBlockContainer .eko-storyIndicator.current:after {\n  content: "";\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  top: 0;\n  left: -100%;\n  background-color: #ffffff;\n  box-shadow: 0 0 6px 1px rgba(0, 0, 0, 0.2);\n  border-radius: 2px;\n  animation: storyPlayAnimation linear forwards;\n  animation-duration: var(--storyDuration);\n}\n.eko-galleryBlockContainer .eko-storyTitle {\n  font-size: 13px;\n  font-weight: 500;\n  color: #ffffff;\n  opacity: 0;\n  translate: 0 -15px;\n  animation: storyTitleAppear 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards 0.3s;\n}\n@keyframes storyPlayAnimation {\n  0% {\n    transform: translate3d(0, 0, 0);\n  }\n  100% {\n    transform: translate3d(100%, 0, 0);\n  }\n}\n@keyframes storyTitleAppear {\n  0% {\n    opacity: 0;\n    translate: 0 -15px;\n  }\n  100% {\n    opacity: 1;\n    translate: 0 0;\n  }\n}\n\n.full-screen-layout.paused .eko-galleryBlockContainer .eko-storiesContainer .eko-storyIndicator.current:after {\n  animation-play-state: paused;\n}\n\n#uiRootContainer:has(> .platformAbove > #EkoshellRoot > .ekoshell_waitingIndication) .project .full-screen-layout .eko-galleryBlockContainer .eko-storiesContainer .eko-storyIndicator.current:after {\n  animation-play-state: paused;\n}');var Lz=new WeakMap,Nz=new WeakMap;function Rz(e){const{modes:t,currentModeIndex:n,color:i,selectedColor:r,hasTextBox:o}=e,s=Pg.useMemo((()=>{if(i){const e=JB(i).toRgb();return`${e.r}, ${e.g}, ${e.b}`}}),[i]),a=t[n];return Ig.createElement(Ig.Fragment,null,Ig.createElement("div",{className:"eko-modesModuleContainer "+(o?"top":""),style:{"--unselectedColor":s,"--selectedColor":r}},t.map(((e,t)=>Ig.createElement("button",{className:"eko-modeButton","aria-current":n===t,key:t,onClick:e.onClick},Ig.createElement("img",{src:e.image,alt:`Mode ${t+1}`}),Ig.createElement("div",null,e.title&&Ig.createElement("div",{className:"eko-modeTitle"},e.title),e.description&&Ig.createElement("div",{className:"eko-modeDescription"},e.description)))))),Ig.createElement(xz,Ja({key:n},a.textBox)))}function Dz(e){e&&!e.entity||(e="https://assets.eko.com/image/a8f3d7c0-e882-11ef-86b5-1d04f7d7aec5/0");const t=new URL(e);return t.searchParams.set("width",200),t.searchParams.set("height",200),t.searchParams.set("crop","fill"),qB.preloadImage(t.href),t.href}By(".eko-galleryBlockContainer {\n  --modesModule_gap: 16px;\n  --modesModule_width: 100%;\n  --modesModule_top: unset;\n  --modesModule_left: 0;\n  --modesModule_right: unset;\n  --modesModule_bottom: 0;\n  --modesModule_flexDirection: row;\n  --modesModule_alignItems: flex-start;\n  --modesModule_justifyContent: center;\n  --modesModule_padding: 0 0 32px 0;\n  --modesModule_paddingWithSteps: 0 0 48px 0;\n  --modesModule_paddingWithTextBox: 28px 0 0 0;\n  --modesModule_background: none;\n  --modesModule_border: none;\n  --modesModule_borderRadius: 0;\n  --modesModule_transform: none;\n  --modesModule_mode_width: 64px;\n  --modesModule_mode_titleGap: 6px;\n  --modesModule_mode_title_fontFamily: var(--fontName);\n  --modesModule_mode_title_fontSize: 12px;\n  --modesModule_mode_title_fontWeight: 500;\n  --modesModule_mode_title_lineHeight: 120%;\n  --modesModule_mode_title_letterSpacing: -0.2px;\n  --modesModule_mode_title_textAlign: center;\n  --modesModule_mode_description_fontFamily: var(--fontName);\n  --modesModule_mode_description_fontSize: 11px;\n  --modesModule_mode_description_fontWeight: 400;\n  --modesModule_mode_description_lineHeight: 120%;\n  --modesModule_mode_description_letterSpacing: -0.2px;\n  --modesModule_mode_description_textAlign: center;\n  --modesModule_mode_image_strokeSize: 2px;\n}\n.eko-galleryBlockContainer .eko-modesModuleContainer {\n  position: absolute;\n  top: var(--modesModule_top);\n  left: var(--modesModule_left);\n  right: var(--modesModule_right);\n  bottom: var(--modesModule_bottom);\n  width: var(--modesModule_width);\n  display: flex;\n  flex-direction: var(--modesModule_flexDirection);\n  align-items: var(--modesModule_alignItems);\n  justify-content: var(--modesModule_justifyContent);\n  gap: var(--modesModule_gap);\n  flex-wrap: wrap;\n  padding: var(--modesModule_padding);\n  background: var(--modesModule_background);\n  border: var(--modesModule_border);\n  border-radius: var(--modesModule_borderRadius);\n  transform: var(--modesModule_transform);\n}\n.eko-galleryBlockContainer .eko-modesModuleContainer.top {\n  bottom: unset;\n  top: 0;\n  padding: var(--modesModule_paddingWithTextBox);\n}\n.eko-galleryBlockContainer .eko-modeButton {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  width: var(--modesModule_mode_width);\n  background: none;\n  border: none;\n  padding: 0;\n  pointer-events: auto;\n  cursor: pointer;\n  color: rgba(var(--unselectedColor, 111, 111, 111), 1);\n  gap: var(--modesModule_mode_titleGap);\n  flex-shrink: 0;\n}\n.eko-galleryBlockContainer .eko-modeButton .eko-modeTitle {\n  font-family: var(--modesModule_mode_title_fontFamily);\n  font-size: var(--modesModule_mode_title_fontSize);\n  font-weight: var(--modesModule_mode_title_fontWeight);\n  line-height: var(--modesModule_mode_title_lineHeight);\n  letter-spacing: var(--modesModule_mode_title_letterSpacing);\n  text-align: var(--modesModule_mode_title_textAlign);\n}\n.eko-galleryBlockContainer .eko-modeButton .eko-modeDescription {\n  font-family: var(--modesModule_mode_description_fontFamily);\n  font-size: var(--modesModule_mode_description_fontSize);\n  font-weight: var(--modesModule_mode_description_fontWeight);\n  line-height: var(--modesModule_mode_description_lineHeight);\n  letter-spacing: var(--modesModule_mode_description_letterSpacing);\n  text-align: var(--modesModule_mode_description_textAlign);\n}\n.eko-galleryBlockContainer .eko-modeButton div {\n  width: 100%;\n}\n.eko-galleryBlockContainer .eko-modeButton img {\n  width: 100%;\n  aspect-ratio: 1;\n  object-fit: cover;\n  border-radius: 100%;\n  box-shadow: 0 0 0 var(--modesModule_mode_image_strokeSize) rgba(var(--unselectedColor, 111, 111, 111), 0.15);\n  background-color: rgba(var(--unselectedColor, 111, 111, 111), 0.15);\n  pointer-events: none;\n}\n.eko-galleryBlockContainer .eko-modeButton[aria-current=true] {\n  color: var(--selectedColor, #000000);\n}\n.eko-galleryBlockContainer .eko-modeButton[aria-current=true] img {\n  background-color: var(--selectedColor, #000000);\n  box-shadow: 0 0 0 var(--modesModule_mode_image_strokeSize) var(--selectedColor, #000000);\n}\n.eko-galleryBlockContainer.hasSteps .eko-modesModuleContainer {\n  padding: var(--modesModule_paddingWithSteps);\n}");var Mz=new WeakMap,Fz=new WeakMap;function Bz(e){const{ctaText:t,showCta:n,animationConfig:i,onCtaClick:r}=e,[o,s]=Pg.useState(!1),[a,l]=Pg.useState(!1),[c,u]=Zj();Pg.useEffect((()=>{const{mass:e,stiffness:t,damping:r,delay:o}=i;let a;return n&&(a=setTimeout((async()=>{s(!0),a=null,u(c.current,{transform:["translateY(40px) scale(0, 0.2)","translateY(0) scale(1, 1)"],opacity:1},{type:lz,mass:e,stiffness:t,damping:r}),await u("div",{transform:["translateY(20px) scale(0.8)","translateY(0) scale(1)"],opacity:1},{type:lz,mass:e,stiffness:t,damping:r,delay:.15}),c.current&&l(!0)}),o)),()=>{a&&clearTimeout(a)}}),[n,i]);const d=Pg.useCallback((()=>{u(c.current,{transform:"scale(1.05)"},{type:lz,mass:1.5,stiffness:400,damping:30})}),[]),h=Pg.useCallback((()=>{u(c.current,{transform:"scale(1)"},{type:lz,mass:1.5,stiffness:400,damping:30})}),[]),p=Pg.useCallback((()=>{u(c.current,{transform:"scale(0.95)"},{type:lz,mass:1,stiffness:600,damping:30})}),[]);return Ig.createElement("div",{className:"eko-tryItContainer"},n&&Ig.createElement("button",{ref:c,style:{pointerEvents:o?"auto":"none"},onMouseEnter:a?d:null,onMouseLeave:a?h:null,onMouseDown:a?p:null,onTouchStart:a?p:null,onClick:r},Ig.createElement("div",null,t)))}By(".eko-galleryBlockContainer {\n  --tryItModule_justifyContent: center;\n  --tryItModule_alignItems: flex-end;\n  --tryItModule_padding: 16px 20px 48px 20px;\n  --tryItModule_button_padding: 16px 32px;\n  --tryItModule_button_textAlign: center;\n  --tryItModule_button_borderRadius: 100px;\n  --tryItModule_button_border: 0;\n  --tryItModule_button_boxShadow: 0 4px 24px 2px rgba(0, 0, 0, 0.12);\n  --tryItModule_button_background: #FFFFFF;\n  --tryItModule_button_text_fontFamily: var(--fontName);\n  --tryItModule_button_text_fontSize: 18px;\n  --tryItModule_button_text_color: #222;\n  --tryItModule_button_text_weight: 500;\n  --tryItModule_button_text_lineHeight: 120%;\n  --tryItModule_button_text_letterSpacing: -0.1px;\n}\n.eko-galleryBlockContainer .eko-tryItContainer {\n  position: relative;\n  padding: var(--tryItModule_padding);\n  width: 100%;\n  height: 100%;\n  box-sizing: border-box;\n  display: flex;\n  justify-content: var(--tryItModule_justifyContent);\n  align-items: var(--tryItModule_alignItems);\n}\n.eko-galleryBlockContainer .eko-tryItContainer button {\n  padding: var(--tryItModule_button_padding);\n  text-align: var(--tryItModule_button_textAlign);\n  border-radius: var(--tryItModule_button_borderRadius);\n  border: var(--tryItModule_button_border);\n  background: var(--tryItModule_button_background);\n  box-shadow: var(--tryItModule_button_boxShadow);\n  font-family: var(--tryItModule_button_text_fontFamily);\n  font-size: var(--tryItModule_button_text_fontSize);\n  color: var(--tryItModule_button_text_color);\n  font-weight: var(--tryItModule_button_text_weight);\n  line-height: var(--tryItModule_button_text_lineHeight);\n  letter-spacing: var(--tryItModule_button_text_letterSpacing);\n  cursor: pointer;\n  opacity: 0;\n  overflow: hidden;\n}\n.eko-galleryBlockContainer .eko-tryItContainer button div {\n  opacity: 0;\n}");var Uz,jz,zz,Vz,Wz,Hz,$z,Gz,qz,Yz,Kz,Xz,Qz,Zz,Jz,eV,tV,nV,iV,rV,oV,sV,aV,lV,cV,uV,dV,hV,pV=new WeakMap,fV=new WeakMap;function gV(){return jz?Uz:(jz=1,Uz=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)})}function mV(){if(Hz)return Wz;Hz=1;var e=Vz?zz:(Vz=1,zz="object"==typeof i&&i&&i.Object===Object&&i),t="object"==typeof self&&self&&self.Object===Object&&self,n=e||t||Function("return this")();return Wz=n}function yV(){if(Zz)return Qz;Zz=1;var e=mV();return Qz=e.Symbol}var vV=function(){if(hV)return dV;hV=1;var e=gV(),t=function(){if(Gz)return $z;Gz=1;var e=mV();return $z=function(){return e.Date.now()}}(),n=function(){if(uV)return cV;uV=1;var e=function(){if(Xz)return Kz;Xz=1;var e=function(){if(Yz)return qz;Yz=1;var e=/\s/;return qz=function(t){for(var n=t.length;n--&&e.test(t.charAt(n)););return n},qz}(),t=/^\s+/;return Kz=function(n){return n?n.slice(0,e(n)+1).replace(t,""):n}}(),t=gV(),n=function(){if(lV)return aV;lV=1;var e=function(){if(rV)return iV;rV=1;var e=yV(),t=function(){if(eV)return Jz;eV=1;var e=yV(),t=Object.prototype,n=t.hasOwnProperty,i=t.toString,r=e?e.toStringTag:void 0;return Jz=function(e){var t=n.call(e,r),o=e[r];try{e[r]=void 0;var s=!0}catch(e){}var a=i.call(e);return s&&(t?e[r]=o:delete e[r]),a},Jz}(),n=function(){if(nV)return tV;nV=1;var e=Object.prototype.toString;return tV=function(t){return e.call(t)}}(),i=e?e.toStringTag:void 0;return iV=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":i&&i in Object(e)?t(e):n(e)}}(),t=sV?oV:(sV=1,oV=function(e){return null!=e&&"object"==typeof e});return aV=function(n){return"symbol"==typeof n||t(n)&&"[object Symbol]"==e(n)}}(),i=/^[-+]0x[0-9a-f]+$/i,r=/^0b[01]+$/i,o=/^0o[0-7]+$/i,s=parseInt;return cV=function(a){if("number"==typeof a)return a;if(n(a))return NaN;if(t(a)){var l="function"==typeof a.valueOf?a.valueOf():a;a=t(l)?l+"":l}if("string"!=typeof a)return 0===a?a:+a;a=e(a);var c=r.test(a);return c||o.test(a)?s(a.slice(2),c?2:8):i.test(a)?NaN:+a}}(),i=Math.max,r=Math.min;return dV=function(o,s,a){var l,c,u,d,h,p,f=0,g=!1,m=!1,y=!0;if("function"!=typeof o)throw new TypeError("Expected a function");function v(e){var t=l,n=c;return l=c=void 0,f=e,d=o.apply(n,t)}function b(e){var t=e-p;return void 0===p||t>=s||t<0||m&&e-f>=u}function w(){var e=t();if(b(e))return k(e);h=setTimeout(w,function(e){var t=s-(e-p);return m?r(t,u-(e-f)):t}(e))}function k(e){return h=void 0,y&&l?v(e):(l=c=void 0,d)}function x(){var e=t(),n=b(e);if(l=arguments,c=this,p=e,n){if(void 0===h)return function(e){return f=e,h=setTimeout(w,s),g?v(e):d}(p);if(m)return clearTimeout(h),h=setTimeout(w,s),v(p)}return void 0===h&&(h=setTimeout(w,s)),d}return s=n(s)||0,e(a)&&(g=!!a.leading,u=(m="maxWait"in a)?i(n(a.maxWait)||0,s):u,y="trailing"in a?!!a.trailing:y),x.cancel=function(){void 0!==h&&clearTimeout(h),f=0,l=p=c=h=void 0},x.flush=function(){return void 0===h?d:k(t())},x},dV}(),bV=r(vV);function wV(e,t){var n,i,r;return(null===(n=t.current)||void 0===n?void 0:n.offsetLeft)-((null===(i=e.current)||void 0===i?void 0:i.clientWidth)-(null===(r=t.current)||void 0===r?void 0:r.clientWidth))/2}function kV({callouts:e,timeout:t=5}){const n=Pg.useRef(null),i=Pg.useRef(null),r=Pg.useRef(null),o=Pg.useRef(null),s=Pg.useRef(!1),a=Pg.useRef(null),[l,c]=Pg.useState(0),u={"--calloutsModuleTimeout":`${t}s`},d=Pg.useCallback((t=>{var i;t.stopPropagation(),s.current=!0;const r="BUTTON"===t.target.nodeName?t.target:t.target.parentNode;n.current.scrollTo({left:wV(n,{current:r}),behavior:"smooth"});const o=parseInt(r.dataset.index,10);TA.trackInteraction({elementid:`callout_button_${o+1}`,elementname:(null===(i=e[o])||void 0===i?void 0:i.title)||"",elementtype:TA.elementTypes.CHOICE_BUTTON,interactiontype:TA.interactionTypes.MODULE})}),[]),h=t=>e.map(((e,n)=>Ig.createElement("button",Ja({key:n,className:"eko-callout","data-index":n},t&&0===n?{ref:t}:{},{onClick:d}),Ig.createElement("div",{className:"title"},e.title),Ig.createElement("div",{className:"description"},e.description))));Pg.useLayoutEffect((()=>{var e;s.current=!0,null===(e=n.current)||void 0===e||e.scrollTo({left:wV(n,i),behavior:"instant"});const t=new IntersectionObserver((e=>{e.forEach((e=>{e.isIntersecting&&(c(parseInt(e.target.dataset.index,10)),a.current=e.target)}))}),{root:n.current,rootMargin:"0px",threshold:.95});return n.current.childNodes.forEach((e=>t.observe(e))),()=>{t.disconnect()}}),[]);const p=Pg.useCallback(bV((()=>{var e;s.current=!1,a.current&&(null===(e=n.current)||void 0===e||e.scrollTo({left:wV(n,a),behavior:"smooth"}))}),150),[]),f=Pg.useCallback((()=>{var e;s.current||(s.current=!0,TA.trackInteraction({elementid:"callouts_container",elementtype:TA.elementTypes.SCROLL,interactiontype:TA.interactionTypes.MODULE}));const t=null===(e=n.current)||void 0===e?void 0:e.scrollLeft;var a;(t>=wV(n,o)||t<wV(n,r))&&(null===(a=n.current)||void 0===a||a.scrollTo({left:wV(n,i),behavior:"instant"})),p()}),[]),g=Pg.useCallback(((t,r)=>{if(t.stopPropagation(),n.current){var o;s.current=!0;let t=i.current;for(let e=0;e<r;e++)t=t.nextSibling;n.current.scrollTo({left:wV(n,{current:t}),behavior:"smooth"}),TA.trackInteraction({elementid:`callout_step_${r+1}`,elementname:(null===(o=e[r])||void 0===o?void 0:o.title)||"",elementtype:TA.elementTypes.SEQUENCE_DOT,interactiontype:TA.interactionTypes.MODULE})}}),[]),m=Pg.useCallback((e=>{if("calloutPlayAnimation"===e.animationName&&!s.current){const e=a.current.nextSibling;s.current=!0,n.current.scrollTo({left:wV(n,{current:e}),behavior:"smooth"})}}),[l,e]);return Ig.createElement("div",{className:"eko-calloutsContainer",style:u},Ig.createElement("div",{className:"eko-calloutsSteps",onAnimationEnd:m},e.map(((e,t)=>Ig.createElement("button",{key:t,className:"eko-calloutStep "+(t===l?"current":""),onClick:e=>{g(e,t)}})))),Ig.createElement("div",{className:"eko-calloutsScroll",ref:n,onScroll:f},h(),h(r),h(i),h(o),h()))}By('.bp-vertical-small {\n  --gizmoPadding: 16px;\n  --navigationHeight: 5.2em;\n  font-size: 12px;\n  line-height: 14px;\n}\n\n.bp-vertical-medium {\n  --gizmoPadding: 24px;\n  --navigationHeight: 5.2em;\n  font-size: 16px;\n  line-height: 17px;\n}\n\n.eko-galleryBlockContainer {\n  --calloutsModule_gap: 8px;\n  --calloutsModule_maxWidth: 600px;\n  --calloutsModule_items_gap: 12px;\n  --calloutsModule_item_bgColor: #f6f6f6;\n  --calloutsModule_item_padding: 10px 12px;\n  --calloutsModule_item_borderRadius: 8px;\n  --calloutsModule_item_border: 1px solid rgba(0, 0, 0, 0.08);\n  --calloutsModule_item_gap: 4px;\n  --calloutsModule_item_title_fontFamily: var(--fontName);\n  --calloutsModule_item_title_fontSize: 14px;\n  --calloutsModule_item_title_fontWeight: bold;\n  --calloutsModule_item_title_textColor: #222;\n  --calloutsModule_item_title_lineHeight: 120%;\n  --calloutsModule_item_title_letterSpacing: normal;\n  --calloutsModule_item_description_fontFamily: var(--fontName);\n  --calloutsModule_item_description_fontSize: 13px;\n  --calloutsModule_item_description_fontWeight: 400;\n  --calloutsModule_item_description_textColor: #626262;\n  --calloutsModule_item_description_lineHeight: 130%;\n  --calloutsModule_item_description_letterSpacing: normal;\n  --calloutsModule_item_xs_padding: 8px;\n  --calloutsModule_item_xs_title_fontSize: 13px;\n  --calloutsModule_item_xs_description_fontSize: 12px;\n}\n.eko-galleryBlockContainer .eko-calloutsContainer {\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  right: 56px;\n  display: flex;\n  flex-direction: column;\n  gap: var(--calloutsModule_gap);\n  align-items: center;\n  pointer-events: auto;\n  max-width: var(--calloutsModule_maxWidth);\n  margin: 0 auto;\n}\n.eko-galleryBlockContainer .eko-calloutsScroll {\n  display: flex;\n  width: 100%;\n  gap: var(--calloutsModule_items_gap);\n  padding-bottom: 8px;\n  overflow-y: auto;\n  scrollbar-width: none;\n  mask: linear-gradient(90deg, rgba(0, 0, 0, 0) 0%, #000000 15.24%, #000000 84.99%, rgba(0, 0, 0, 0) 100%);\n}\n.eko-galleryBlockContainer .eko-calloutsScroll::-webkit-scrollbar {\n  display: none;\n}\n.eko-galleryBlockContainer .eko-callout {\n  display: flex;\n  flex-direction: column;\n  gap: var(--calloutsModule_item_gap);\n  flex-shrink: 0;\n  width: 60%;\n  background-color: var(--calloutsModule_item_bgColor);\n  padding: var(--calloutsModule_item_padding);\n  border-radius: var(--calloutsModule_item_borderRadius);\n  border: var(--calloutsModule_item_border);\n  text-align: left;\n  cursor: pointer;\n}\n@media (max-width: 370px) {\n  .eko-galleryBlockContainer .eko-callout {\n    padding: var(--calloutsModule_item_xs_padding);\n  }\n}\n.eko-galleryBlockContainer .eko-callout .title {\n  font-family: var(--calloutsModule_item_title_fontFamily);\n  font-size: var(--calloutsModule_item_title_fontSize);\n  font-weight: var(--calloutsModule_item_title_fontWeight);\n  color: var(--calloutsModule_item_title_textColor);\n  line-height: var(--calloutsModule_item_title_lineHeight);\n  letter-spacing: var(--calloutsModule_item_title_letterSpacing);\n}\n@media (max-width: 370px) {\n  .eko-galleryBlockContainer .eko-callout .title {\n    font-size: var(--calloutsModule_item_xs_title_fontSize);\n  }\n}\n.eko-galleryBlockContainer .eko-callout .description {\n  font-family: var(--calloutsModule_item_description_fontFamily);\n  font-size: var(--calloutsModule_item_description_fontSize);\n  font-weight: var(--calloutsModule_item_description_fontWeight);\n  color: var(--calloutsModule_item_description_textColor);\n  line-height: var(--calloutsModule_item_description_lineHeight);\n  letter-spacing: var(--calloutsModule_item_description_letterSpacing);\n}\n@media (max-width: 370px) {\n  .eko-galleryBlockContainer .eko-callout .description {\n    font-size: var(--calloutsModule_item_xs_description_fontSize);\n  }\n}\n.eko-galleryBlockContainer .eko-calloutsSteps {\n  display: flex;\n  gap: 10px;\n  padding-left: 56px;\n}\n.eko-galleryBlockContainer .eko-calloutStep {\n  position: relative;\n  overflow: hidden;\n  width: 32px;\n  height: 4px;\n  border-radius: 100px;\n  border: none;\n  cursor: pointer;\n  background-color: rgba(0, 0, 0, 0.08);\n  box-shadow: 0 0 0 0.5px rgba(128, 128, 128, 0.25);\n}\n.eko-galleryBlockContainer .eko-calloutStep.current:after {\n  content: "";\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  top: 0;\n  left: 0;\n  opacity: 0;\n  background-color: #ffffff;\n  border-radius: 100px;\n  animation: calloutPlayAnimation linear forwards;\n  animation-duration: var(--calloutsModuleTimeout, 5s);\n}\n@keyframes calloutPlayAnimation {\n  0% {\n    opacity: 0;\n    transform: translate3d(0, 0, 0);\n  }\n  5% {\n    opacity: 1;\n  }\n  100% {\n    opacity: 1;\n    transform: translate3d(100%, 0, 0);\n  }\n}\n.eko-galleryBlockContainer.hasSteps .eko-calloutsContainer {\n  right: 0;\n}\n.eko-galleryBlockContainer.hasSteps .eko-calloutsScroll {\n  padding-bottom: 52px;\n}\n.eko-galleryBlockContainer.hasSteps .eko-calloutsSteps {\n  padding-left: 0;\n}\n\n.full-screen-layout.paused .eko-galleryBlockContainer .eko-calloutsContainer .eko-calloutStep.current:after {\n  animation-play-state: paused;\n}\n\n#uiRootContainer:has(> .platformAbove > #EkoshellRoot > .ekoshell_waitingIndication) .project .full-screen-layout .eko-galleryBlockContainer .eko-calloutsContainer .eko-calloutStep.current:after {\n  animation-play-state: paused;\n}');var xV,SV,CV=new WeakMap,_V={toggleModule:class extends Ei{constructor(e,t,n){var i;return super(),tl(this,Ez,void 0),tl(this,Tz,void 0),this.config=t,this.id=`toggle_${e}`,this.blockId=n.blockId,this.seek=IR.getInstance().seek,this.ctx=n,pI(this),Xa(Ez,this,t.options.map(((e,t)=>{const i=HI.create(`${this.id}_option_${t}`,e.video,{intro:{video:e.intro},...this.config.sync?{partialPrefetchEnabled:!1}:null});return qB.makeNodeLoop(i,n),i}))),t.startOnLoop&&(Xa(Tz,this,HI.create(`${this.id}_entry_node`,t.options[0].video)),qB.makeNodeLoop(Ka(Tz,this),n)),this.toggleComponentProps=WB({options:this.config.options.map(((e,t)=>({label:e.label,note:e.note,textBox:e.textBox,onClick:e=>{null==e||e.stopPropagation(),this.onOptionClick(t)}}))),backgroundColor:this.config.backgroundColor,optionsLabel:this.config.optionsLabel,currentOptionIndex:0}),this.uiComponent=(i=this,function(e){const t=i.toggleComponentProps.hook();return React.createElement(Sz,Ja({},e,t))}),this.registerEmbedApiHandlers(),{id:this.id,on:this.on,once:this.once,off:this.off,type:t.itemType,getEntry:this.getEntry,connectNodes:this.connectNodes,getUi:this.getUi,reset:this.reset}}connectNodes(e,t,n=[]){var i,r;null===(i=Ka(Tz,this))||void 0===i||i.addPrefetch(t,1),null===(r=Ka(Tz,this))||void 0===r||r.addPrefetch(e,_z),Ka(Ez,this).forEach(((i,r)=>{var o;i.addPrefetch(t,1),i.addPrefetch(e,_z),Ka(Ez,this).forEach(((e,t)=>{r!==t&&i.addPrefetch(e,_z)})),n.forEach((e=>{i.addPrefetch(e,Cz)})),null===(o=Ka(Tz,this))||void 0===o||o.addPrefetch(i,_z)}))}getEntry(){return HI.getHeadNode(Ka(Tz,this)||Ka(Ez,this)[0])}getUi(){return this.uiComponent}reset(){this.toggleComponentProps.set({currentOptionIndex:0})}onOptionClick(e){qB.onClickWrapper((()=>{const t=!!this.config.sync;this.seek(Ka(Ez,this)[e].id,{synchronized:t}),this.toggleComponentProps.set({currentOptionIndex:e})}),{element:{elementtype:TA.elementTypes.PRODUCT_OPTION,elementid:`option-${e+1}`,elementname:this.config.options[e].label,interactiontype:TA.interactionTypes.MODULE}},this.ctx)}registerEmbedApiHandlers(){XI.registerModuleHandler(this.blockId,this.id,"selectOption",(({optionIndex:e})=>{const t=parseInt(e,10);!isNaN(t)&&t>=0&&t<this.config.options.length&&this.onOptionClick(t)}))}},videoModule:class extends Ei{constructor(e,t,n){var i;return super(),tl(this,Iz,void 0),this.config=t,this.id=`video_${e}`,pI(this),Xa(Iz,this,HI.create(this.id,t.video,{intro:{video:t.intro}})),t.loop?qB.makeNodeLoop(Ka(Iz,this),n):Ka(Iz,this).on("nodecritical",(()=>{this.emit(Pz)})),this.toggleComponentProps=WB({moduleId:this.id,textBox:t.textBox||{}}),this.uiComponent=(i=this,function(){const{moduleId:e,textBox:t}=i.toggleComponentProps.hook();return React.createElement(xz,Ja({},t,{key:e}))}),{id:this.id,on:this.on,once:this.once,off:this.off,type:t.itemType,getEntry:this.getEntry,connectNodes:this.connectNodes,getUi:this.getUi,hasDuration:this.hasDuration}}connectNodes(e,t,n=[]){Ka(Iz,this).addPrefetch(t,1),Ka(Iz,this).addPrefetch(e,_z),n.forEach((e=>{Ka(Iz,this).addPrefetch(e,Cz)}))}getEntry(){return HI.getHeadNode(Ka(Iz,this))}getUi(){return this.uiComponent}hasDuration(){return!this.config.loop}},imageModule:class extends Ei{constructor(e,t,n){var i;return super(),tl(this,Az,void 0),this.config=t,this.id=`image_${e}`,pI(this),Xa(Az,this,HI.create(this.id,`image:${t.externalImage||t.image||"https://assets.eko.com/image/d45bef20-3561-11f0-8672-575390c2be09/0"}`)),qB.makeNodeLoop(Ka(Az,this),n),this.toggleComponentProps=WB({moduleId:this.id,textBox:t.textBox||{}}),this.uiComponent=(i=this,function(){const{moduleId:e,textBox:t}=i.toggleComponentProps.hook();return React.createElement(xz,Ja({},t,{key:e}))}),{id:this.id,on:this.on,once:this.once,off:this.off,type:t.itemType,getEntry:this.getEntry,connectNodes:this.connectNodes,getUi:this.getUi}}connectNodes(e,t,n=[]){Ka(Az,this).addPrefetch(t,1),Ka(Az,this).addPrefetch(e,_z),n.forEach((e=>{Ka(Az,this).addPrefetch(e,Cz)}))}getEntry(){return HI.getHeadNode(Ka(Az,this))}getUi(){return this.uiComponent}},storiesModule:class extends Ei{constructor(e,t,n){var i;return super(),tl(this,Lz,void 0),tl(this,Nz,void 0),this.config=t,this.id=`stories_${e}`,this.seek=IR.getInstance().seek,this.resetCounter=0,pI(this),Xa(Lz,this,t.stories.map(((e,t)=>HI.create(`${this.id}_story_${t}`,e.video)))),Ka(Lz,this).forEach(((e,i)=>{let r=Ka(Lz,this)[i+1];i===Ka(Lz,this).length-1&&(t.loop?r=Ka(Lz,this)[0]:e.on("nodecritical",(()=>{this.emit(Pz)}))),e.on("nodestart",(e=>{this.storiesComponentProps.set({currentStory:i,title:Ka(Nz,this)[i],storyDuration:e.duration}),r&&n.player.append(r.id)})),r&&e.addPrefetch(r)})),Xa(Nz,this,t.stories.map((e=>e.title))),this.storiesComponentProps=WB({numOfStories:Ka(Lz,this).length,currentStory:0,title:Ka(Nz,this)[0],onNextStory:this.onNextStory,player:n.player,resetCounter:this.resetCounter}),this.uiComponent=(i=this,function(e){const t=i.storiesComponentProps.hook();return React.createElement(Oz,Ja({},e,t))}),{id:this.id,on:this.on,once:this.once,off:this.off,type:t.itemType,getEntry:this.getEntry,connectNodes:this.connectNodes,getUi:this.getUi,reset:this.reset}}onNextStory(e){let t=e+1;t!==Ka(Lz,this).length||(t=0,this.config.loop)?this.seek(Ka(Lz,this)[t].id):this.emit(Pz,{immediate:!0})}connectNodes(e,t){Ka(Lz,this)[Ka(Lz,this).length-1].addPrefetch(t),Ka(Lz,this)[0].addPrefetch(e)}getEntry(){return HI.getHeadNode(Ka(Lz,this)[0])}getUi(){return this.uiComponent}reset(){this.resetCounter++,this.storiesComponentProps.set({currentStory:0,title:Ka(Nz,this)[0],resetCounter:this.resetCounter})}},modesModule:class extends Ei{constructor(e,t,n){var i;return super(),tl(this,Mz,void 0),tl(this,Fz,void 0),this.config=t,this.id=`modes_${e}`,this.seek=IR.getInstance().seek,this.ctx=n,pI(this),Xa(Mz,this,t.modes.map(((e,t)=>{const i=HI.create(`${this.id}_mode_${t}`,e.video,{intro:{video:e.intro},...this.config.sync?{partialPrefetchEnabled:!1}:null});return qB.makeNodeLoop(i,n),i}))),t.startOnLoop&&(Xa(Fz,this,HI.create(`${this.id}_entry_node`,t.modes[0].video)),qB.makeNodeLoop(Ka(Fz,this),n)),this.modesComponentProps=WB({modes:this.config.modes.map(((e,t)=>({title:e.title,description:e.description,image:Dz(e.image),textBox:e.textBox,onClick:e=>{null==e||e.stopPropagation(),this.onModeClick(t)}}))),currentModeIndex:0,color:this.config.color,selectedColor:this.config.selectedColor,hasTextBox:this.config.modes.some((e=>{var t,n;return(null===(t=e.textBox)||void 0===t?void 0:t.title)||(null===(n=e.textBox)||void 0===n?void 0:n.description)}))}),this.uiComponent=(i=this,function(e){const t=i.modesComponentProps.hook();return React.createElement(Rz,Ja({},e,t))}),{id:this.id,on:this.on,once:this.once,off:this.off,type:t.itemType,getEntry:this.getEntry,connectNodes:this.connectNodes,getUi:this.getUi,reset:this.reset}}connectNodes(e,t,n=[]){var i,r;null===(i=Ka(Fz,this))||void 0===i||i.addPrefetch(t,1),null===(r=Ka(Fz,this))||void 0===r||r.addPrefetch(e,_z),Ka(Mz,this).forEach(((i,r)=>{var o;i.addPrefetch(t,1),i.addPrefetch(e,_z),Ka(Mz,this).forEach(((e,t)=>{r!==t&&i.addPrefetch(e,_z)})),n.forEach((e=>{i.addPrefetch(e,Cz)})),null===(o=Ka(Fz,this))||void 0===o||o.addPrefetch(i,_z)}))}getEntry(){return HI.getHeadNode(Ka(Fz,this)||Ka(Mz,this)[0])}getUi(){return this.uiComponent}reset(){this.modesComponentProps.set({currentModeIndex:0})}onModeClick(e){qB.onClickWrapper((()=>{const t=!!this.config.sync;this.seek(Ka(Mz,this)[e].id,{synchronized:t}),this.modesComponentProps.set({currentModeIndex:e})}),{element:{elementtype:TA.elementTypes.PRODUCT_OPTION,elementid:`mode-${e+1}`,elementname:this.config.modes[e].title,interactiontype:TA.interactionTypes.MODULE}},this.ctx)}},tryItModule:class extends Ei{constructor(e,t,n){var i,r;return super(),tl(this,pV,void 0),tl(this,fV,void 0),this.config=t,this.id=`tryIt_${e}`,this.seek=IR.getInstance().seek,this.ctx=n,pI(this),this.tryItComponentProps=WB({moduleId:this.id,ctaText:t.ctaText,animationConfig:t.animationConfig,showCta:!0}),this.uiComponent=(r=this,function(e){const{moduleId:t,...n}=r.tryItComponentProps.hook();return React.createElement(Bz,Ja({key:t,onCtaClick:r.onCtaClick},n,e))}),Xa(pV,this,HI.create(`${this.id}_intro`,t.introVideo.loop,{intro:{video:t.introVideo.intro}})),qB.makeNodeLoop(Ka(pV,this),n),null!==(i=t.mainVideo)&&void 0!==i&&i.loop&&(Xa(fV,this,HI.create(`${this.id}_main`,t.mainVideo.loop,{intro:{video:t.mainVideo.intro}})),qB.makeNodeLoop(Ka(fV,this),n),Ka(fV,this).on("nodestart",(()=>{this.tryItComponentProps.set({showCta:!1})}))),{id:this.id,on:this.on,once:this.once,off:this.off,type:t.itemType,getEntry:this.getEntry,connectNodes:this.connectNodes,getUi:this.getUi,reset:this.reset,hasDuration:this.hasDuration}}connectNodes(e,t,n=[]){Ka(pV,this).addPrefetch(t,1),Ka(pV,this).addPrefetch(e,_z),Ka(fV,this)&&(Ka(pV,this).addPrefetch(Ka(fV,this),1),Ka(fV,this).addPrefetch(t,1),Ka(fV,this).addPrefetch(e,_z)),n.forEach((e=>{var t;Ka(pV,this).addPrefetch(e,Cz),null===(t=Ka(fV,this))||void 0===t||t.addPrefetch(e,Cz)}))}getEntry(){return HI.getHeadNode(Ka(pV,this))}getUi(){return this.uiComponent}reset(){this.tryItComponentProps.set({showCta:!0})}onCtaClick(e){null==e||e.stopPropagation(),qB.onClickWrapper((()=>{Ka(fV,this)?this.seek(HI.getHeadNode(Ka(fV,this)).id):this.emit(Pz,{immediate:!0})}),{element:{elementtype:TA.elementTypes.CHOICE_BUTTON,elementid:"tyrIt-cta",elementname:this.config.ctaText,interactiontype:TA.interactionTypes.MODULE}},this.ctx)}},calloutsModule:class extends Ei{constructor(e,t,n){var i;return super(),tl(this,CV,void 0),this.config=t,this.id=`callouts_${e}`,pI(this),Xa(CV,this,HI.create(this.id,t.video,{intro:{video:t.intro}})),qB.makeNodeLoop(Ka(CV,this),n),this.componentProps=WB({moduleId:this.id,callouts:this.config.callouts,timeout:this.config.timeout}),this.uiComponent=(i=this,function(){const{moduleId:e,...t}=i.componentProps.hook();return React.createElement(kV,Ja({},t,{key:e}))}),{id:this.id,on:this.on,once:this.once,off:this.off,type:t.itemType,getEntry:this.getEntry,connectNodes:this.connectNodes,getUi:this.getUi}}connectNodes(e,t,n=[]){Ka(CV,this).addPrefetch(t,1),Ka(CV,this).addPrefetch(e,_z),n.forEach((e=>{Ka(CV,this).addPrefetch(e,Cz)}))}getEntry(){return HI.getHeadNode(Ka(CV,this))}getUi(){return this.uiComponent}}};const EV="imageModule",TV="implementation.interactions.gesture",PV="ekonovar",IV="ekooverview",AV=rI("GalleryBlock"),OV={names:[...qB.DEFAULT_BLOCK_REQUIRED_PROPS.names,"enableGesturesOnMobile","enableSlideTransition","galleryBlockFullScreen"],blockConfigMap:qB.DEFAULT_BLOCK_REQUIRED_PROPS.blockConfigMap},LV=null!==(xV=null===(SV=window.InterludePlayer)||void 0===SV||null===(SV=SV.environment)||void 0===SV?void 0:SV.queryParams)&&void 0!==xV?xV:{},NV=LV.galleryBlockEditMode,RV=NV||LV.editor;function DV(e){return void 0!==e}function MV(e,t){if(!e)return;const n=new URL(e);return n.searchParams.set("height",t),n.href}function FV(e,t,n){return Math.min(n,Math.max(t,e))}var BV=new WeakMap,UV=new WeakMap,jV=new WeakMap,zV=new WeakSet;class VV{constructor(e,t,n){var i;if(nl(this,zV),tl(this,BV,void 0),tl(this,UV,void 0),tl(this,jV,void 0),AV("[constructor]"),this.id=e,this.type=VV.type,this.blockConfig=t,this.itemsConfig=function(e,t=[]){if(t.length){const n=[];for(let i of t)if(i.id){const t=e.find((e=>e.id===i.id));t&&n.push(hj(t,i))}else i.type&&n.push(pj(i));return n.length?n:(console.warn("Items in gallery config were not found, reverting to all items"),e)}return e}(t.items,n.galleryConfig),this.ctx=n,this.player=n.player,this.zeroUI=null!==(i=LV.galleryBlockZeroUI)&&void 0!==i&&i,this.currentStepIndex=0,this.currentGalleryItemIndex=0,this.currentVariant=PV,this.theme=JA.get(),this.seek=IR.getInstance(this.player,this.theme.transition).seek,pI(this),Ya(zV,this,WV).call(this),Xa(BV,this,Ya(zV,this,HV).call(this)),Ya(zV,this,$V).call(this),Ya(zV,this,GV).call(this),this.imagesCache=new Map,RV){var r;const e=null===(r=localStorage)||void 0===r?void 0:r.getItem(`gallery_${this.id}_data`);if(e){var o;const t=JSON.parse(e);var s;new Date-new Date(t.updated)<36e5&&null!==(o=Ka(UV,this)[t.currentVariant])&&void 0!==o&&null!==(o=o.modules[t.currentGalleryItemIndex])&&void 0!==o&&o[t.currentStepIndex]?(this.currentGalleryItemIndex=t.currentGalleryItemIndex,this.currentStepIndex=t.currentStepIndex,window.location.hash=`#variantId=${t.currentVariant}`):null===(s=localStorage)||void 0===s||s.removeItem(`gallery_${this.id}_data`)}}return this.gestureEventContext={},this.registerEmbedApiHandlers(),this.registerContextPackers(),this.galleryGizmoProps=WB(),this.player.on("nodestart",(e=>{this.galleryGizmoProps.set({currentDuration:e.duration})})),{id:this.id,type:this.type,getHead:this.getHead,getEnds:this.getEnds,getUi:this.getUi,onStarted:this.onStarted,getCurrentActiveModule:this.getCurrentActiveModule,metadata:kz,getVariants:this.getVariants,variantReadyHandler:this.variantReadyHandler,variantUpdateHandler:this.variantUpdateHandler}}onModuleEnd(e){const t=(this.currentStepIndex+1)%this.getCurrentGalleryItem().length,n=Ka(BV,this)[this.currentGalleryItemIndex][t].getEntry();n.once("nodestart",(()=>{this.updateCurrentStateIndex(this.currentGalleryItemIndex,t)})),null!=e&&e.immediate?this.seek(n.id):this.player.append(n.id)}isBlockNode(e){return new RegExp(`_${this.id}_`).test(e.id)}registerContextPackers(){TA.registerContextPacker({schema:"iglu:com.helloeko/gesture/jsonschema/1-0-0",match:TV,getData:e=>{if(!this.isBlockNode(this.player.currentNode))return null;let t={};return e.type&&(t.type=e.type),e.direction&&(t.direction=e.direction),e.result&&(t.result=e.result),t.velocity=e.velocity||0,t}}),TA.registerContextPacker({schema:"iglu:com.helloeko/gallery_block/jsonschema/1-0-1",match:/^(implementation\.interactions.*|galleryblock\.moduleview)$/,getData:()=>{var e;if(!this.isBlockNode(this.player.currentNode))return null;const t=Ka(UV,this)[this.currentVariant],n=t.items[this.currentGalleryItemIndex],i=t.modules[this.currentGalleryItemIndex],r=i[this.currentStepIndex],o=LV.locale||"en";let s,a;if(null!==(e=n.name)&&void 0!==e&&e.startsWith("</>")){const e=function(e,t){const n={};try{var i,r;const o=JSON.parse(e.substring(3));n.thumbnailNameInEnglish=null===(i=o.find((e=>"en"===e.lang)))||void 0===i?void 0:i.text,n.thumbnailNameInCurrentLocale=(null===(r=o.find((e=>e.lang===t)))||void 0===r?void 0:r.text)||n.thumbnailNameInEnglish}catch(e){AV.warn("Failed to parse thumbnail multi-language label.")}return n}(n.name,o);s=e.thumbnailNameInEnglish,a=e.thumbnailNameInCurrentLocale}else s=n.name;return{moduleindex:this.currentStepIndex+1,totalmodules:i.length,moduletype:r.type||"",moduledescription:"",thumbnailindex:this.currentGalleryItemIndex+1,totalthumbnails:t.items.length,thumbnailname:s||"",thumbnailnameincurrentlocale:a||"",currentlocale:o}}})}updateCurrentStateIndex(e,t){var n,i,r;this.currentGalleryItemIndex!==e&&XI.sendBlockEvent(this.id,this.type,"activeItemChanged",{activeItemIndex:e}),this.currentGalleryItemIndex===e&&this.currentStepIndex===t||XI.sendBlockEvent(this.id,this.type,"activeModuleChanged",{activeItemIndex:e,activeModuleIndex:t}),null===(n=Ka(BV,this)[this.currentGalleryItemIndex])||void 0===n||null===(n=n[this.currentStepIndex])||void 0===n||null===(i=n.reset)||void 0===i||i.call(n),this.currentStepIndex=t,this.currentGalleryItemIndex=e;const o=Ka(BV,this)[e][t];var s;this.galleryGizmoProps.set({currentStepIndex:t,currentGalleryItemIndex:e,steps:Ka(BV,this)[e],showPauseButton:o.type!==EV,showDuration:null===(r=o.hasDuration)||void 0===r?void 0:r.call(o),ModuleComponent:o.getUi()}),this.slideTransition&&this.setupCurrentNodeGestureNavigationImages(),RV&&(null===(s=localStorage)||void 0===s||s.setItem(`gallery_${this.id}_data`,JSON.stringify({currentGalleryItemIndex:e,currentStepIndex:t,currentVariant:this.currentVariant,updated:new Date}))),TA.track("galleryblock.moduleview")}seekNode(e,t,n,i){return qB.onClickWrapper((()=>{let n=Ka(BV,this)[e][t].getEntry();(i?this.seek:this.player.seek)(n.id),this.updateCurrentStateIndex(e,t)}),{element:n},this.ctx)}onStepClick(e){if(e!==this.currentStepIndex)return this.seekNode(this.currentGalleryItemIndex,e,{elementtype:TA.elementTypes.SEQUENCE_DOT,elementid:`thumbnail-${this.currentGalleryItemIndex+1}-dot-${e+1}`,interactiontype:TA.interactionTypes.NAVIGATION},!0)}getPrevItem(){let e,t;return this.inFirstStepInGalleryItem()?(e=this.currentGalleryItemIndex-1,e<0&&(e=Ka(BV,this).length-1),t=Ka(BV,this)[e].length-1):(t=this.currentStepIndex-1,e=this.currentGalleryItemIndex),{itemIndex:e,stepIndex:t,node:Ka(BV,this)[e][t].getEntry()}}getNextItem(){let e,t;return this.inLastStepInGalleryItem()?(t=0,e=this.currentGalleryItemIndex+1,e%=Ka(BV,this).length):(t=this.currentStepIndex+1,e=this.currentGalleryItemIndex,t%=Ka(BV,this)[this.currentGalleryItemIndex].length),{itemIndex:e,stepIndex:t,node:Ka(BV,this)[e][t].getEntry()}}onPrevClick(e,t){var n;null==e||null===(n=e.stopPropagation)||void 0===n||n.call(e);const i=this.getPrevItem(),r={click:TA.elementTypes.PREVIOUS_BUTTON,gesture:TA.elementTypes.GESTURE_PREVIOUS};t&&r[t]||AV.warn(`[onPrevClick]: no type or unknown type passed ('${t}'), tracking will not have 'elementtype''`);let o={elementtype:r[t],elementid:this.prevBtnId,interactiontype:TA.interactionTypes.NAVIGATION};const s="gesture"!==t;if("completed"===(null==e?void 0:e.result)){const t={...e,...o};TA.track(TV,t),o=null}return this.seekNode(i.itemIndex,i.stepIndex,o,s)}onNextClick(e,t){var n;null==e||null===(n=e.stopPropagation)||void 0===n||n.call(e);const i=this.getNextItem(),r={click:TA.elementTypes.NEXT_BUTTON,gesture:TA.elementTypes.GESTURE_NEXT,skip:TA.elementTypes.SKIP};t&&r[t]||AV.warn(`[onNextClick]: no type or unknown type passed ('${t}'), tracking will not have 'elementtype''`);let o={elementtype:r[t],elementid:this.nextBtnId,interactiontype:TA.interactionTypes.NAVIGATION};const s="gesture"!==t;if("completed"===(null==e?void 0:e.result)){const t={...e,...o};TA.track(TV,t),o=null}return this.seekNode(i.itemIndex,i.stepIndex,o,s)}onItemClick(e){if(e.index===this.currentGalleryItemIndex)return;let t={elementtype:TA.elementTypes.CHOICE_BUTTON,elementid:`gallery-item-button-${e.index+1}`,elementname:e.name,interactiontype:TA.interactionTypes.THUMBNAIL};this.slideTransition&&this.player.once("nodestart",this.slideTransition.onNodeStart),this.seekNode(e.index,0,t,!0)}registerEmbedApiHandlers(){XI.registerBlockHandler(this.id,"updateActiveItem",(({activeItemIndex:e})=>{const t=parseInt(e,10);if(t!==this.currentGalleryItemIndex){var n;Ka(BV,this)[t][0].getEntry().once("nodestart",(()=>{this.currentGalleryItemIndex===t&&XI.sendBlockEvent(this.id,this.type,"activeItemChangeDone")}));const e={elementtype:TA.elementTypes.CHOICE_BUTTON,elementid:`gallery-3-thumbnail-${t+1}`,elementname:(null===(n=this.getCurrentItems()[t])||void 0===n?void 0:n.name)||"",interactiontype:TA.interactionTypes.THUMBNAIL};this.seekNode(t,0,e,!0)}else XI.sendBlockEvent(this.id,this.type,"activeItemChangeDone")})),XI.registerBlockHandler(this.id,"updateActiveModule",(({activeItemIndex:e,activeModuleIndex:t})=>{const n=parseInt(t,10),i=parseInt(e,10);if(n!==this.currentStepIndex||i!==this.currentGalleryItemIndex){var r;if(!(null===(r=Ka(BV,this)[i])||void 0===r?void 0:r[n]))return void AV.warn(`[updateActiveModule]: module not found for itemIndex: ${i}, stepIndex: ${n}`);this.seekNode(i,n,null,!0)}}))}getCurrentItems(){return Ka(UV,this)[this.currentVariant].items}getStylingVars(){const e={};return function t(n,i=""){for(const[r,o]of Object.entries(n)){const n=i?`${i}_${r}`:`${r}`;"object"==typeof o&&null!==o?t(o,n):e[n]=o}}(this.blockConfig.styling||{}),Object.entries(e).map((([e,t])=>`--${e}: ${t};`)).join("\n")}onStarted(){var e,t,n;this.prevBtnId=`${this.id}-prev`,this.nextBtnId=`${this.id}-next`,this.transformedUIProps=JA.blockUIPropsTransformer(this.blockConfig,OV);let i=!window.InterludePlayer.environment.isDesktop;this.enableSlideTransition=DV(LV.enableSlideTransition)?LV.enableSlideTransition&&i:DV(this.transformedUIProps.enableGesturesOnMobile)?this.transformedUIProps.enableGesturesOnMobile&&i:i,this.showGalleryItems="gallery"!==LV.galleryBlockMode,this.showGalleryItems&&(this.imagesCache=function(e,t){const n=new Map;e.forEach((e=>{e.icon&&n.set(e.icon,MV(e.icon,t)),e.variants&&(Array.isArray(e.variants)?e.variants:Object.values(e.variants)).forEach((e=>{e.icon&&n.set(e.icon,MV(e.icon,t))}))}));for(const e of n.values())qB.preloadImage(e);return n}(this.itemsConfig,2*(this.blockConfig.layout.buttonsContainerHeight-20)));const r=Ka(BV,this)[this.currentGalleryItemIndex][this.currentStepIndex],o=this.getStylingVars();Xa(jV,this,null!==(e=null!==(t=LV.galleryBlockFullScreen)&&void 0!==t?t:this.transformedUIProps.galleryBlockFullScreen)&&void 0!==e&&e),this.galleryGizmoProps.set({player:this.player,stylingVars:o,showPBE:this.blockConfig.showPBE,currentStepIndex:this.currentStepIndex,currentGalleryItemIndex:this.currentGalleryItemIndex,backgroundColor:this.blockConfig.backgroundColor,textColor:this.blockConfig.textColor,galleryItems:Ya(zV,this,qV).call(this,this.getCurrentItems()),steps:Ka(BV,this)[this.currentGalleryItemIndex],onPrevClick:this.onPrevClick,onNextClick:this.onNextClick,onStepClick:this.onStepClick,layoutOptions:this.blockConfig.layout,onItemClick:this.onItemClick,shouldAnimateEntrance:!this.showGalleryItems&&!RV,showGalleryItems:this.showGalleryItems,showPauseButton:r.type!==EV,showDuration:null===(n=r.hasDuration)||void 0===n?void 0:n.call(r),ModuleComponent:r.getUi(),...this.transformedUIProps,enableSlideTransition:this.enableSlideTransition}),TA.track("galleryblock.moduleview")}getHead(){var e;return null!==(e=Ka(BV,this)[this.currentGalleryItemIndex])&&void 0!==e&&e[this.currentStepIndex]?Ka(BV,this)[this.currentGalleryItemIndex][this.currentStepIndex].getEntry():Ka(BV,this)[0][0].getEntry()}getEnds(){return[]}setupCurrentNodeGestureNavigationImages(){let e=this.getPrevItem().node,t=this.getNextItem().node;e&&t?this.slideTransition.setupCurrentNodeImages(e,t):AV.error("[setupCurrentNodeGestureNavigationImages]: could not get prev/next nodes for slide transition images")}onUpdateGestureSwitcher(e,t){if(null===t.type&&"snapback"===this.gestureEventContext.result){const e={...this.gestureEventContext,elementtype:TA.elementTypes.GESTURE,elementid:"this"};TA.track(TV,e)}let n="right"!==e.direction,i="animateSnapback"===e.mode||"dragging"===e.mode||"animateSwipe"===e.mode;if("completed"===e.mode)return this.slideTransition.updateProgress(1,n),void this.player.once("nodestart",this.slideTransition.onNodeStart);let r=0;if("animateSwipe"===e.mode){const t=.2,n=3;let i=1-t;r=FV(Math.abs(e.velocity)/n,0,1);let o=(FV(e.percent,i,1)-i)/t;r*=Math.pow(1-o,3)}else if("animateSnapback"===e.mode){let t=15;r=FV(Math.abs(e.velocity)/t,0,1)}this.slideTransition.updateImages(this.getPrevItem().node,this.getNextItem().node),this.slideTransition.updateProgress(e.percent,n,{darkenEffect:i,blurStrength:r}),this.gestureEventContext={...t}}onLayoutAdded(e){let t=dj(e);return this.slideTransition=t,this.setupCurrentNodeGestureNavigationImages(),Ka(BV,this).flat().forEach((e=>{let t=e.getEntry();t.id!==this.player.currentNodeId&&this.slideTransition.loadNodeImageToCache(t)})),this.slideTransition.onNodeStart=()=>{this.slideTransition.updateProgress(0,null),this.slideTransition.updateImages(this.getPrevItem().node,this.getNextItem().node)},t.cleanup}getUi(){return{showMuteButton:qB.shouldShowMuteButton(this.ctx.settings),layoutOptions:{component:KD.FULLSCREEN,getRetargetOptions:this.getRetargetOptions,refreshRetargetOptionsOnVPChange:!0,...this.enableSlideTransition?{onLayoutAdded:this.onLayoutAdded}:{}},gizmos:{topBar:Ya(zV,this,YV).call(this),main:(e=this,function(t){if(e.zeroUI)return null;let n={...t,...e.galleryGizmoProps.hook(),onUpdateGestureSwitcher:e.onUpdateGestureSwitcher};return React.createElement(wz,n)})},uiPropsHooks:{main:this.galleryGizmoProps.hook}};var e}getCurrentGalleryItem(){return Ka(BV,this)[this.currentGalleryItemIndex]}getCurrentActiveModule(){var e;return null===(e=Ka(BV,this)[this.currentGalleryItemIndex])||void 0===e?void 0:e[this.currentStepIndex]}inLastStepInGalleryItem(){return this.currentStepIndex===this.getCurrentGalleryItem().length-1}inFirstStepInGalleryItem(){return 0===this.currentStepIndex}getRetargetOptions(e){let t=1;if(!Ka(jV,this)){var n;const i=document.querySelector(".eko-galleryBlockItemsContainer");t=1-((null!==(n=null==i?void 0:i.getBoundingClientRect().height)&&void 0!==n?n:0)/e.height||0)}return{frames:[{sourceTL:{x:0,y:0},sourceBR:{x:1,y:1},targetTL:{x:0,y:0},targetBR:{x:1,y:t},cornerRadius:0,fitType:"fill"}]}}getVariants(){return this.variants}variantReadyHandler(e){this.currentVariant=e.id,Xa(BV,this,Ka(UV,this)[e.id].modules)}findItemIndexForNewVariant(e,t){if(e===PV)return 0;const n=t.parent;if(n){let t=Ka(UV,this)[e].items.findIndex((({pseudoVariant:e,parent:t})=>!e&&t===n));if(t>-1)return t}const i=Ka(UV,this)[e].items.findIndex((e=>!e.pseudoVariant&&!!e.parent));return i>-1?i:0}variantUpdateHandler(e){var t,n;null===(t=(n=Ka(BV,this)[this.currentGalleryItemIndex][this.currentStepIndex]).reset)||void 0===t||t.call(n);const i=this.findItemIndexForNewVariant(e.id,this.getCurrentItems()[this.currentGalleryItemIndex]);this.currentVariant=e.id,Xa(BV,this,Ka(UV,this)[e.id].modules),this.seekNode(i,0,null,!0),this.galleryGizmoProps.set({galleryItems:Ya(zV,this,qV).call(this,this.getCurrentItems())})}}function WV(){Xa(UV,this,{});for(let t of this.itemsConfig){let n=[];var e;"variantsGalleryItem"===t.itemType?n=(null===(e=t.variants)||void 0===e||null===(e=e.map((e=>e.variantId)))||void 0===e?void 0:e.filter((e=>!!e)))||[]:"galleryItemV2"===t.itemType&&(n=Object.keys(t.variants||{}));for(let e of n)Ka(UV,this)[e]={items:[],modules:[]}}Ka(UV,this)[PV]={items:[],modules:[]}}function HV(){const e=(e=[],t)=>{const n=[];for(let[i,r]of e.entries()){if(!_V[r.itemType])throw new Error(`Unknown module type ${r.itemType}`);const e=new _V[r.itemType](`${t}_${i}`,r,{...this.ctx,blockId:this.id});e.on(Pz,this.onModuleEnd),n.push(e)}return n};for(let[n,i]of this.itemsConfig.entries())if("variantsGalleryItem"===i.itemType)for(let t of i.variants){const r=Ka(UV,this)[t.variantId];r.items.push({...t,parent:i}),r.modules.push(e(t.modules,`${this.id}_${t.variantId}_${n}`))}else if("galleryItem"===i.itemType)for(let[t,r]of Object.entries(Ka(UV,this)))r.items.push(i),r.modules.push(e(i.modules,`${this.id}_${t}_${n}`));else if("galleryItemV2"===i.itemType)for(let[r,o]of Object.entries(Ka(UV,this))){var t;const o=Ka(UV,this)[r],s=null===(t=i.variants)||void 0===t?void 0:t[r];if(s){const t=fj({},i,s);o.items.push({...t,parent:i}),o.modules.push(e(t.modules,`${this.id}_${r}_${n}`))}else i.variantSpecific||(o.items.push({...i,parent:i,pseudoVariant:!NV}),o.modules.push(e(i.modules,`${this.id}_${r}_${n}`)))}if(NV){Ka(UV,this)[IV]={items:[],modules:[]};const t=Ka(UV,this)[IV];for(let[n,i]of this.itemsConfig.entries())"variantsGalleryItem"===i.itemType&&(i=i.variants[0]),t.items.push({...i,parent:i}),t.modules.push(e(i.modules,`${this.id}_${IV}_${n}`))}return Ka(UV,this)[this.currentVariant].modules}function $V(){for(const[e,t]of Object.entries(Ka(UV,this)))0===t.modules.length&&delete Ka(UV,this)[e];this.variants=Object.keys(Ka(UV,this)).map((e=>({id:e,options:[{key:"ID",value:e}]})))}function GV(){function e(e,t,n){return n<e[t].length-1?e[t][n+1]:t<e.length-1?e[t+1][0]:e[0][0]}function t(e,t,n){return n>0?e[t][n-1]:t>0?e[t-1][e[t-1].length-1]:e[e.length-1][e[e.length-1].length-1]}for(let[n,i]of Object.entries(Ka(UV,this)))i.modules.forEach(((r,o)=>{r.forEach(((r,s)=>{let a=e(i.modules,o,s),l=t(i.modules,o,s),c=[];this.player.options.priorityLoadingEnabled&&Object.keys(Ka(UV,this)).forEach((e=>{if(e!==n){let t=this.findItemIndexForNewVariant(e,i.items[o]),n=Ka(UV,this)[e].modules[t][0];c.push(n.getEntry())}})),a&&l&&r.connectNodes(l.getEntry(),a.getEntry(),c)}))}))}function qV(e){return e.map(((e,t)=>{var n;return{name:e.name,id:e.id,icon:this.imagesCache.get(e.icon),index:t,moduleType:null===(n=e.modules)||void 0===n||null===(n=n[0])||void 0===n?void 0:n.itemType}}))}function YV(){return KB(this)}Za(VV,"type","GalleryBlock");var KV=Object.freeze({__proto__:null,default:VV});export{KB as A,yD as B,Ja as C,SD as D,JB as E,NU as F,DD as G,cD as H,fD as I,XU as J,MA as K,KD as L,TD as M,dj as N,i as O,Ov as P,o as Q,Ig as R,ED as S,CD as T,jA as U,kD as V,Rg as W,r as X,Zj as Y,lz as Z,nl as _,tl as a,Xa as b,Ya as c,_D as d,pI as e,Ka as f,qB as g,HI as h,TA as i,Za as j,Pg as k,HR as l,oA as m,bM as n,XI as o,IR as p,iA as q,WB as r,By as s,JA as t,xD as u,NM as v,WM as w,rI as x,OU as y,ND as z};
//# sourceMappingURL=app.js.map
