"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[59647],{84529:function(e,t,i){i.d(t,{W:function(){return x},w:function(){return k}});var a=i(487954),s=i(155394),n=i(682081),o=i(444002),l=i(620769),r=i.n(l),m=i(194742),u=i(577865),c=i(634582),d=i(451575);const g={DEFAULT:{backgroundColor:"bg-gold",fontColor:"black"},WARNING:{backgroundColor:"bg-red",fontColor:"white"},EXPIRED:{backgroundColor:"bg-near-white",fontColor:"black"},ACTIVE:{backgroundColor:"bg-white",fontColor:"black"}},p={fontSize:".625rem",verticalAlign:"-.01875em",marginTop:"2px",marginRight:"2px"},v=e=>{const{timeUnits:t,showClockIcon:i=!0}=e;return(0,a.jsxs)("div",{className:r()("flex lh-copy f5 br1 justify-center","bg-washed-blue","black"),style:{width:"61px"},"data-testid":"unit-timer",children:[i&&(0,a.jsx)(o.J,{name:"Clock",title:(0,n.m)(u,"timer"),className:"mr1 mt1"}),(0,a.jsx)("span",{"aria-hidden":!0,className:r()("b"),children:0===t.minutes?"".concat(t.minutes+1).concat((0,n.m)(u,"timerTextMinuteSingular")):"".concat(t.minutes+1).concat((0,n.m)(u,"timerTextMinutesPlural"))}),(0,a.jsx)(s.VisuallyHidden,{role:"timer","aria-live":"assertive","aria-atomic":"true","aria-relevant":"all",children:(0,n.m)(u,"waitTime",{minutes:t.minutes+1})})]})},x=e=>{const{timeUnits:t,timerState:i,showClockIcon:l=!0,size:m,ariaLabelAddOnMessage:c}=e,{backgroundColor:d,fontColor:v}=g[i];let x=l?"75px":"52px";"small"===m&&(x=l?"45px":"35px");const k="small"===m;return(0,a.jsxs)("div",{className:r()("flex lh-copy br1 justify-center",d,v,{f5:!k},{f8:k}),style:{width:x},"data-testid":"queue-timer",children:[l&&(0,a.jsx)(o.J,{name:"Clock",title:(0,n.m)(u,"timer"),className:r()({"mr1 mt1":!k}),style:k?p:{}}),(0,a.jsx)("span",{"aria-hidden":!0,className:"b",children:(0,n.m)(u,"countDownTimer",{minutes:String(t.minutes).padStart(2,"0"),seconds:String(t.seconds).padStart(2,"0")})}),(0,a.jsx)(s.VisuallyHidden,{role:"timer","aria-live":"off","aria-atomic":"true","aria-relevant":"all",children:(0,n.m)(u,"minsLeft",{minutes:t.minutes,addonMessage:c})})]})},k=e=>{const{endTime:t,onTimeChange:i,ticketState:s="valid",showClockIcon:n,className:o,size:l="default",ariaLabelAddOnMessage:r}=e,{timeRemainingInSec:u}=(0,c.A)(t.getTime()),g=(0,d.E3)(u),p=0===g.minutes&&0===g.seconds?"EXPIRED":g.minutes<2?"WARNING":"DEFAULT",{0:k,1:h}=(0,m.useState)(p);return(0,m.useEffect)((()=>{i&&i(u),0===g.minutes&&0===g.seconds?h("EXPIRED"):g.minutes>=2?h("DEFAULT"):h("WARNING")}),[g,u,i]),(0,a.jsxs)("div",{className:o,children:[("pending"===s||"paused"===s)&&(0,a.jsx)(v,{timeUnits:g,showClockIcon:n}),"valid"===s&&(0,a.jsx)(x,{timeUnits:g,timerState:k,showClockIcon:n,size:l,ariaLabelAddOnMessage:r})]})}},207925:function(e,t,i){i.r(t),i.d(t,{QueuingLayoutWrapper:function(){return j},default:function(){return a.Z},useQueueSnackbar:function(){return v.gM}});var a=i(922489),s=i(487954),n=i(976481),o=i(293168),l=i(682081),r=i(297693),m=i(362484),u=i(764766),c=i(141819),d=i(451575),g=i(194742),p=i(822722),v=i(933578),x=i(611459),k=i(558403);var h=i(135653),f=i(302303);const T=e=>{let{ticket:t,pageTitle:i,isQueueDialogOpen:n,onOpenLeaveQueueDialog:o}=e;var m,c,d;const{push:g}=(0,u.tv)().router,v=(0,r.wG)(),x=(0,h.Z)(t,{onOpenLeaveQueueDialog:o},i);if(!x.leaveQueueProps||!("customMetadata"in t))return null;const k="pending"===t.state||"paused"===t.state,T="valid"===t.state,j=k&&"guaranteed"===t.customMetadata.admissionLikelihood||T,S=k&&!(x.timerProps&&"guaranteed"===t.customMetadata.admissionLikelihood);return(0,s.jsx)(a.Z.Body,{isQueueDialog:!0,onClick:()=>{var e;return null===(e=x.leaveQueueProps)||void 0===e?void 0:e.onClick(t,n)},text:x.leaveQueueProps.text,queueTicket:t,children:(0,s.jsxs)("div",{className:"flex flex-column",children:[(0,s.jsxs)("div",{className:"flex mb3",children:[j&&(0,s.jsxs)(s.Fragment,{children:[(null===(m=x.timerProps)||void 0===m?void 0:m.endTime)&&(0,s.jsx)(a.Z.Timer,{endTime:x.timerProps.endTime,ticketState:x.timerProps.ticketState,showClockIcon:!1}),(null===(c=x.timerProps)||void 0===c?void 0:c.message)&&(0,s.jsx)(a.Z.TimerMessage,{isQueueDialog:!0,message:x.timerProps.message})]}),S&&(0,s.jsx)("span",{className:"black",children:(0,l.m)(p,"youAreInLine")})]}),(0,s.jsxs)("div",{className:"flex mb2",children:[(0,s.jsx)(a.Z.Image,{isQueueDialog:!0,isQueueFooterOpen:!0,name:t.customMetadata.item.name,src:t.customMetadata.item.imageURL}),(0,s.jsx)("p",{className:"f6 mt0 mr2 w-two-thirds h4",children:(0,s.jsx)(f.W,{lines:3,children:t.customMetadata.item.name})}),(0,s.jsxs)("div",{className:"flex flex-column ml-auto",children:[(0,s.jsx)("p",{className:"f5 b ma0",children:t.customMetadata.item.currentPrice}),t.customMetadata.item.wasPrice&&(0,s.jsx)("p",{className:"f7 ma0 pl2 strike",children:t.customMetadata.item.wasPrice})]})]}),(null===(d=x.ctaProps)||void 0===d?void 0:d.onClick)&&(0,s.jsx)(a.Z.Cta,{queueTicket:t,isQueueDialog:!0,onClick:x.ctaProps.onClick(g,v,n)})]})})},j=()=>{var e;const{pageTitle:t}=(0,g.useContext)(m.z1),{push:i}=(0,u.tv)().router,{footerProps:h,ctaProps:f,leaveQueueProps:j,timerProps:S,isError:C,isLeaveDialogueLoading:b,onDismissError:M,onConfirmLeaveQueue:D,onCloseLeaveQueue:I,onStayInLine:L,onOpenLeaveQueueDialog:N,onCloseQueueDialog:E,displayedQueueTicket:Q,queueTickets:w,queueData:y,isQueueDialogOpen:P,ticketToLeave:U,shouldRenderError:R}=(0,x.i)(),F=null===y||void 0===y?void 0:y.filter((e=>"error"===e.state&&"QUEUE_CLOSED"===e.errorCode)),{QueueSnackbar:O}=(0,v.gM)(w,F,{context:"banner"}),q=(0,r.wG)(),Z=null===(e=(0,o.iC)(c.YL).shared.values)||void 0===e?void 0:e.queueTimeToCompletePurchase,{shouldRenderQueue:A,isBannerPages:B}=(()=>{const{asPath:e}=(0,u.tv)().router,{queueData:t}=(0,k.B)(),i=e.includes("cart"),a=e.includes("bookslot"),s=e.includes("/qp"),n=(0,g.useMemo)((()=>{const n=i||a||s;if(t&&0!==t.length){const i=t.some((t=>t&&"customMetadata"in t&&(t.customMetadata.item.itemURL===e||(null===e||void 0===e?void 0:e.includes(t.customMetadata.item.itemID)))));return n||i}return n}),[e,i,a,s,t]);return{shouldRenderQueue:(0,g.useMemo)((()=>t&&!(0===t.length||i||a||s||t.some((t=>t&&"customMetadata"in t&&(t.customMetadata.item.itemURL===e||(null===e||void 0===e?void 0:e.includes(t.customMetadata.item.itemID))))))),[e,i,a,s,t]),isBannerPages:n}})();if(!B&&R)return(0,s.jsx)(a.Z,{float:!0,children:(0,s.jsx)(a.Z.Error,{})});let V=0;!Q||"pending"!==Q.state&&"paused"!==Q.state?Q&&"valid"===Q.state&&(V=null===Q||void 0===Q?void 0:Q.expires):V=null===Q||void 0===Q?void 0:Q.expectedTurnTimeUnixTimestamp;const z=(0,d.ok)(V),G=[],W=[];return w&&w.length>0&&w.map((e=>("valid"===e.state&&G.push(e),"paused"!==e.state&&"pending"!==e.state||W.push(e),null))),(0,s.jsxs)(s.Fragment,{children:[A&&!P&&O(),A&&Q&&"customMetadata"in Q&&"expires"in Q&&j?(0,s.jsx)(r.tp,{context:t,action:"moduleView",name:"reservationTimer",payload:{nm:{nm:"reservationTimer"},li:{nm:"reservationTimer"},pr:{us:Q.customMetadata.item.itemID,wt:1e3*z},ta:{mo:"reservationTimer"}},children:(0,s.jsxs)(a.Z,{isQueueDialogOpen:P,float:!0,children:[(0,s.jsxs)(a.Z.Body,{onClick:()=>j.onClick(Q,P),text:j.text,queueTicket:Q,children:[(0,s.jsxs)("div",{className:"flex items-center flex-auto justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[Q.customMetadata.item.imageURL&&(0,s.jsx)(a.Z.Image,{name:Q.customMetadata.item.name,isQueueFooterOpen:Boolean(null===h||void 0===h?void 0:h.message),src:Q.customMetadata.item.imageURL,className:"mh2"}),S&&(0,s.jsx)(s.Fragment,{children:"valid"===Q.state||"guaranteed"===Q.customMetadata.admissionLikelihood?(0,s.jsxs)(s.Fragment,{children:[S.endTime&&(0,s.jsx)(a.Z.Timer,{endTime:S.endTime,ticketState:S.ticketState,showClockIcon:!1}),S.message&&(0,s.jsx)(a.Z.TimerMessage,{message:S.message})]}):(0,s.jsx)("p",{className:"black",children:(0,l.m)(p,"youAreInLine")})})]}),(null===f||void 0===f?void 0:f.onClick)&&(0,s.jsx)(a.Z.Cta,{queueTicket:Q,onClick:f.onClick(i,q,P)})]}),(0,s.jsx)("div",{className:"w3 na2",style:{transform:"rotate(90deg)"},children:(0,s.jsx)(n.x,{})})]}),h&&(0,s.jsx)(a.Z.Footer,{onClick:h.onClick,message:h.message}),(0,s.jsxs)(a.Z.Dialog,{title:(0,l.m)(p,"dialogTitle",{queueTickets:w.length}),isOpen:P,onClose:E,queueTickets:w,children:[!!G.length&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("p",{className:"f6 pb3 white mv0",role:"heading","aria-level":3,children:(0,l.m)(p,"timerStartMessage")}),G.map((e=>(0,s.jsx)(T,{ticket:e,onOpenLeaveQueueDialog:N,pageTitle:t,isQueueDialogOpen:P},e.customMetadata.item.itemID)))]}),G.length>0&&W.length>0&&(0,s.jsx)("div",{className:"mb3",children:(0,s.jsx)(n.x,{})}),!!W.length&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("p",{className:"f6 pb3 white mv0",role:"heading","aria-level":3,children:(0,l.m)(p,"queueDialog",{queueTime:Z})}),W.map((e=>(0,s.jsx)(T,{ticket:e,onOpenLeaveQueueDialog:N,pageTitle:t,isQueueDialogOpen:P},e.customMetadata.item.itemID)))]})]}),(0,s.jsx)(a.Z.LeaveQueueDialog,{isOpen:Boolean(U),isError:C,isLeaveDialogueLoading:b,onClose:I,onStayInLine:L,onDismissError:M,onLeaveQueue:()=>U&&D(U)})]})}):null]})}},933578:function(e,t,i){i.d(t,{gM:function(){return x}});var a=i(155394),s=i(682081),n=i(297693),o=i(362484),l=i(786653),r=i(451575),m=i(194742),u=i(822722),c=i(135653);const d="expiry",g="valid",p="pending",v="closed",x=(e,t,i)=>{const{addSnack:s}=(0,a.useSnackbar)(),{getValue:r,setValue:u}=(0,l.Xs)("queueSnackbarHistory"),c=(0,n.wG)(),{pageTitle:d}=(0,m.useContext)(o.z1),g=(e,t)=>"banner"===t?{position:"absolute",bottom:e?"120px":"96px",left:"24px",width:"400px",transform:"none"}:{},p=(e,t,a,n)=>{s({message:e,UNSAFE_style:g(t,null===i||void 0===i?void 0:i.context),onClose:e=>{(null===e||void 0===e?void 0:e.target)&&c({context:d,action:"onClick",name:"queueingSnackBar",payload:{nm:{nm:"dismiss"},ta:{ov:"queueingSnackBar"},co:{ty:n},pr:{us:a}}})}}),c({context:d,action:"overlayView",name:"queueingSnackBar",payload:{nm:{nm:"queueingSnackBar"},co:{ty:n},pr:{us:a}}})};return{QueueSnackbar:()=>{const i=r()||{};if(t&&t.length>0){const e=T(t,i);e&&(p(e.message,!1,e.itemId,e.ticketState),e.storageUpdate&&u(e.storageUpdate))}if(e&&e.length>0){const t=e.length>1,{snackBarDisplayItem:a,storageUpdates:s}=f(e,i);a&&p(a.message,t,a.itemId,a.ticketState),s&&s.forEach((e=>u(e)))}}}},k=["valid","pending","paused"],h=(e,t,i)=>({[e]:{...t[e],[i]:!0}}),f=(e,t)=>{const i=e.map((e=>{const i=(0,c.Z)(e,{onOpenLeaveQueueDialog:()=>null},""),{timerProps:a}=i,{itemID:n}=e.customMetadata.item;let{name:o}=e.customMetadata.item;o=o.length>50?o.slice(0,50).concat("..."):o;const l=t[n]||{};if(a){const e=a.endTime?(0,r.ok)(a.endTime.getTime()):0;if("valid"===(null===a||void 0===a?void 0:a.ticketState)&&e<=120&&!(null===l||void 0===l?void 0:l.expiry)){const i={...t,...h(n,t,d)};return{message:(0,s.m)(u,"snackbarExpiry",{itemName:o}),timeStillRemainingForTickeToExpire:e,ticketState:null===a||void 0===a?void 0:a.ticketState,itemId:n,storageUpdate:i}}if("valid"!==(null===a||void 0===a?void 0:a.ticketState)||l&&(null===l||void 0===l?void 0:l.valid)){if("pending"!==(null===a||void 0===a?void 0:a.ticketState)&&"paused"!==(null===a||void 0===a?void 0:a.ticketState)||l&&(null===l||void 0===l?void 0:l.pending))return{message:"",timeStillRemainingForTickeToExpire:0,ticketState:"",itemId:"",storageUpdate:null};{const i={...t,...h(n,t,p)};return{message:(0,s.m)(u,"snackbarPending",{itemName:o}),timeStillRemainingForTickeToExpire:e,ticketState:null===a||void 0===a?void 0:a.ticketState,itemId:n,storageUpdate:i}}}{const i={...t,...h(n,t,g)};return{message:(0,s.m)(u,"snackbarValid",{itemName:o}),timeStillRemainingForTickeToExpire:e,ticketState:null===a||void 0===a?void 0:a.ticketState,itemId:n,storageUpdate:i}}}return{message:"",timeStillRemainingForTickeToExpire:0,ticketState:"",itemId:"",storageUpdate:null}})),a=i.filter((e=>""!==e.message)),n=i.filter((e=>!!e.storageUpdate));return{snackBarDisplayItem:a.sort(((e,t)=>e.ticketState===t.ticketState?e.timeStillRemainingForTickeToExpire-t.timeStillRemainingForTickeToExpire:k.indexOf(e.ticketState)-k.indexOf(t.ticketState)))[0],storageUpdates:n.map((e=>e.storageUpdate))}},T=(e,t)=>{for(const a of e){var i;if("customMetadata"in a&&(null===(i=a.customMetadata)||void 0===i?void 0:i.item)){const{itemID:e,name:i}=a.customMetadata.item;if(e&&i){const n=t[e];if(!(null===n||void 0===n?void 0:n.closed)){const n=a.customMetadata.body||(0,s.m)(u,"queueClosed",{itemName:i}),o={...t,...h(e,t,v)};return{message:n,timeStillRemainingForTickeToExpire:0,ticketState:a.state,itemId:e,storageUpdate:o}}}}}return null}}}]);