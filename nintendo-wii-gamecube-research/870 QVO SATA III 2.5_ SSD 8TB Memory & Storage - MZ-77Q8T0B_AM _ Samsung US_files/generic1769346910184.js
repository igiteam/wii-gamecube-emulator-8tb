"use strict";(function(){var i={PLACEHOLDERS:{DEFAULT_ANALYTICS_SUBMIT_EVENTS_URL:"https://analytics-fe.digital-cloud-west.medallia.com/api/web/events",USER_AGENT_CLIENT_HINTS_LIST:'["brands", "mobile", "platform", "architecture", "model", "bitness", "platformVersion", "fullVersionList", "wow64", "uaFullVersion"]',DIGITAL_ANALYTICS_STATIC_EVENTS_LIST:"[]",ONSITE_DATA_PATH:"resources.digital-cloud-west.medallia.com/wdcwest/469456/onsite/onsiteData1769346909980.json",SUBMIT_URL_PREFIX:"https://feedback.digital-cloud-west.medallia.com/",JS_SITE_CODE:"resources.digital-cloud-west.medallia.com/wdcwest/469456/onsite/generic1769346910184.js",DEFAULT_MEC_INTEGRATION_ID:"samsunggmc-sea1-medallia-com-samsunggmc",USERSNAP_HOST_PREFIX:"//screencapture.kampyle.com/",COOLADATA_API_HOST:"udc-neb.kampyle.com/",COOLADATA_SRC_PREFIX:"https://resources.digital-cloud-west.medallia.com/",ONSITE_VERSION:"1.69.1",USERSNAP_V4_HOST_PREFIX:"//scp.kampyle.com",URL_PREFIX:"https://resources.digital-cloud-west.medallia.com/",USERSNAP_ONPREM_HOST_PREFIX:"https://md-scp.kampyle.com/"},SRC:{OPEN_SANS:"resources/form/FormBuilder/vendor/fonts-googleapis/css/open-sans-v14.css",OOPS:"resources/onsite/images/oops.svg"},FORM_HEIGHT:"450",FORM_WIDTH:"450",COOKIE_EXPIRATION:365,DELAY_BETWEEN_TABS_TRIGGER_MS:550,DEVICES:{DESKTOP:"desktop",MOBILE:"mobile",TABLET:"tablet"},FEATURE_VERSIONS:{MOBILE_DYNAMIC_SIZING:2},TIME_FORMATS:{SECONDS:"seconds",MINUTES:"minutes",HOURS:"hours",DAYS:"days",WEEKS:"weeks",MONTHS:"months",YEARS:"years"},DISPLAY_TYPES:{LIGHTBOX:"lightbox",ANIMATION:"animation",POPUP:"popup",EMBEDDED:"embedded"},FORM_TYPES:{EMBEDDED:"embedded",INVITATION:"invitation",BUTTON:"button",CODE:"code"},EVENT_DATA:{PAGE_NUMBER:"pageNumber",FEEDBACK_CORRELATION_UUID:"feedbackCorrelationUUID",FEEDBACK_UUID:"feedbackUUID"},EVENT_NAME:{NEB_LOAD_FORM:"neb_loadForm"},FEATURE_FLAGS:{WCAG:"WCAG",EXEMPT_BUTTON_FORMS_FROM_QUARANTINE:"exemptButtonFormsFromQuarantine",EXEMPT_EMBEDDED_FORMS_FROM_QUARANTINE:"exemptEmbeddedFormsFromQuarantine",EXEMPT_CODE_FORMS_FROM_QUARANTINE:"exemptCodeFormsFromQuarantine"},PROVISIONS:{analyticsNewEvents:"cooladataNewEvents",NEW_SCREEN_CAPTURE_CONFIG:"newScreenCaptureConfiguration",ON_PREM_HYBRID:"onPremHybrid",FORM_TEMPLATE_DATA_SEPERATION:"separateFormTemplateFromData",EVENT_INCLUDE_FEEDBACK_CONTENT:"eventIncludeFeedbackContent",CP_EXT_REFACTOR:"cpExtractRefactor",ADOBE_INCLUDE_LINK_TRACK_VARS:"adobeIncludeLinkTrackVars",ADOBE_ANALYTICS_OBJECT_NAME:"adobeAnalyticsObjectName",ADOBE_CONCAT_LINK_TRACK_VARS:"adobeConcatLinkTrackVars",ENABLE_OVERFLOW:"enableOverflow",ENABLE_SPA_OVERFLOW_FIX:"24dcr1_MPC7514_enableSPAOverflowFix",SERVER_BASED_TARGETING:"serverBasedTargeting",ANALYTICS_EVNETS_LIMIT:"cooladataEventsLimit",UBT_EXTRA_EVENTS:"UBTExtraEvents",ALTERNATIVE_UUID:"alternativeUUID",DISABLE_COOKIE_STORAGE:"cookieStorageDisable",SHARE_PROPERTY_DOMAIN:"sharePropertyBetweenSubdomains",SKIP_INVITATION_OPTIMIZATION:"skipInvitationOptimization",DO_NOT_SURVEY_ON_UBT_NETWORK_FAIL:"doNotSurveyOnUBTNetworkFail",DHH:"dynamicHybridHosting",USER_SNAP_V4:"userSnapV4",DYNAMIC_ONSITE_EVENTS:"dynamicOnsiteEvents",CSP_RULES:"CSPRemoveInlineStyling",CREATE_SESSION:"cooladataCreateSessionEvent",FORM_TEMPLATES_WCAG:"formTemplatesWCAG",PREVENT_IFRAME_SCROLLBAR_FLICKERING:"20dcr32_NM11146_PreventIFrameScrollFlickering",BACKEND_GENERATED_UUID:"20dcr4_MPC2802_enable_backendGeneratedUUID",CHTML_LOGS:"chtmlLogs",EXEMPT_FORMS_FROM_QUARANTINE:"20dcr4_MPC2952_enable_exemptFormsFromQuarantine",USER_SNAP_AS_COMPONENT:"20dcr4_MPC2893_enable_ScreenCaptureAsComponent",ADDITIONAL_BUTTON_STYLES:"21dcr1_MPC3199_AdditionalButtonStyles",GREATER_SMALLER_THAN_DECODE:"21dcr1_MPC3370_EnableGreaterSmallerThanSupport",NEW_MODAL_DIALOGS:"21dcr3_MPC3281_enable_newModalDialogs",IS_CHTML_HANDLE_INIT_FOCUS_INDEPENDENTLY:"21dcr3_MPC3281_enable_CHTMLHandleFocusIndependently",WCAG_TRAP_FOCUS_IN_MODAL:"WCAGTrapFocusInModal",WCAG_REVIEW_FIXES:"20dcr4_MPC2905_wcagReviewFixes",PROPERTY_MESSAGES:"propertyMessages",NOT_SCROLL_TO_LAST_POSITION_DISPLAY_TYPE_ANIMATION:"willNotScrollToLastPositionDisplayTypeAnimation",CLEAR_EMBEDDED_ON_UPDATE_PAGE:"21dcr2_MPC3571_enable_ClearEmbeddedFormOnUpdatePageView",ENABLE_EVENTS_FOR_CE_DEBUG:"21DCR2_MPC3662_EnableEventsForCEDebug",EXPOSE_SELECTION_QUESTIONS:"21DCR3_MPC3866_exposeSelectionQuestionsInCustomEvent",EXPOSE_VERBATIM_QUESTIONS:"21DCR3_MPC3866_exposeVerbatimQuestionsInCustomEvent",EXTENSION_ENABLED:"21dcr6_MPC4042_enable_exmdextension",LIVE_FORM_V2:"21dcr2_MPC2743_enable_newLiveForm",ENABLE_FIX_FOR_SPA_TIME_ON_PAGE:"21DCR5_MPC4030_EnableFixForSpaTimeOnPage",ENABLE_UBT_IDENTIFIER_HASH:"21dcr6_MPC4296_enable_UBTIdentifierHash",TARGETING_EVENTS_REPORTING:"targetingEventsReporting",PARALLEL_TAB_SOLUTION:"parallelTabSolution",UNDERSCORE_LOCALIZATION:"underScoreLocalization",ADD_RANDOM_TIME_FOR_SESSION:"addingRandomTimeForTimeInSession",SPA_URL_POLLING:"spaUrlPolling",ENABLE_WCAG_PREPEND_SURVEY:"23dcr1_MPC6711_enableWCAGPrependSurvey",MOBILE_WEB_BANNER_FIX:"23dcr1_mpc6083_enableMobileWebiOSBannerFix",ENABLE_ZOOM_WCAG_REFLOW:"23dcr2_mpc36711_enableFormWCAGReflow",ENABLE_ANALYTICS_SESSION_EVENTS:"23dcr2_MPC6869_enableCXJSessionEvents",DISABLE_ANALYTICS_NEW_PAGE_EVENTS:"23dcr2_MPC6869_disableNewPageEvents",ENABLE_ONSITE_DOMAIN_APPROVAL:"23dcr3_MPC6996_enableOnsiteDomainApproval",ENABLE_INVITATION_SPINNER_FIX:"23dcr4_MPC7186_enableInvitationSpinnerFix",DECIBEL_INSIGHT:"decibelInsight",ENABLE_VIEWPORT_LOGIC_FIX:"24dcr2_MPC7960_enableViewportLogicFix",ENABLE_ONSITE_POST_MESSAGE_VERIFICATION:"24dcr2_MPC7960_enableOnsitePostMessageVerification",ENABLE_DYNAMIC_ANALYTICS_EVENTS:"25dc1_MPC8353_enableDynamicAnalyticsEvents",ENABLE_NEW_FEEDBACK_SUBMIT_EVENTS:"25dcr4_MPC9440_enableNewFeedbackSubmitEvents",ENABLE_DYNAMIC_FEEDBACK_BUTTON_SIZE:"25dcr2_MPC8565_enableDynamicFeedbackButtonSize",DISABLE_USER_PERCENTILE_AT_CREATE_SESSION:"25dcr2_MPC9116_disableUserPercentileAtCreateSession",ENABLE_DIGITAL_ANALYTICS:"24dcr1_MPC_7567_enableDigitalFeedbackAnalytics"},MEDALLIA_DIGITAL_EMBED_FILE:"medallia-digital-embed.js",DEFAULT_ADOBE_SDK_NAME:"s",ANALYTICS_EVENT_FORBIDDEN_PROPERTIES:{sourceWindow:!0,content:!0,feedbackCorrelationUUID:!0},FORM_TRIGGER_TYPES_MAP:{embedded:"Embedded",invitation:"Intercept",button:"AlwaysOn",code:"TriggeredByCode"},EXPOSED_FEEDBACK_KEYS:{FORM_ID_LABEL:"Form_ID",FORM_TYPE_LABEL:"Form_Type",FEEDBACK_UUID_LABEL:"Feedback_UUID",FEEDBACK_CONTENT_LABEL:"Content",FORM_LANGUAGE_LABEL:"Form_Language"},LANG_MEMORY_DATA_KEY_PREFIX:"formLanguage:",FORM_JSON_DATA_KEY_PREFIX:"formJsonData:",INVITE_JSON_DATA_KEY_PREFIX:"inviteJsonData:",FORM_BUTTON:"button",FORM_INVITATION:"invitation",CUSTOM_EVENT_OTHER:"Other",LOCALIZED_FORM_DEFAULT_REPLACE_VALUE:"default",NOT_RECORDING:"NOT_RECORDING",IFRAME_SETTINGS:{EMBEDDED:{IFRAME_ID_PREFIX:"embeddedIframe"},LIGHTBOX:{IFRAME_ID_PREFIX:"kampyleForm",CONTAINER_ID_PREFIX:"kampyleFormModal",WRAPPER_ID:"MDigitalLightboxWrapper"},ANIMATION:{CONTAINER_ID:"KampyleAnimationContainer",IFRAME_ID:"kampyleFormAnimation",WRAPPER_ID:"MDigitalAnimationWrapper"},INVITATION:{IFRAME_ID:"kampyleInvite",CONTAINER_ID:"kampyleInviteModal",IFRAME_TITLE:"Invitation to provide feedback",WRAPPER_ID:"MDigitalInvitationWrapper"},PREVIEW:{IFRAME_ID:"kampyleForm"},OOPS:{CONTAINER_ID_PREFIX:"mdigital-no-json-modal_",CLOSE_BUTTON_ID:"close-no-json-modal"},IFRAME_TITLE:"Feedback Survey",USERSNAP_V4_IFRAME_TITLE:"Screen Capture"},IBM_CPS_TO_SEND:{testData:!0,offeringId:!0,language:!0,trialUser:!0,country:!0,offeringIdShell:!0,testDataShell:!0,trialUserShell:!0,countryShell:!0},PROPERTY_SETTINGS:{MANUALLY_INVITE_TARGETING:"MANUALLY_INVITE_TARGETING",CUSTOM_CSS_UPLOAD:"CUSTOM_CSS_UPLOAD"},EVENTS:{MDIGITAL_MANUALLY_INVITE_TARGETING:"MDigital_manuallyInviteTargeting",MDIGITAL_PAGE_TARGETING_PHASE_ENDED:"MDigital_pageTargetingPhaseEnded",MDIGITAL_BEHAVIORAL_TARGETING_PHASE_ENDED:"MDigital_behavioralTargetingPhaseEnded",MDIGITAL_QUARANTINED_SURVEY_PHASE_ENDED:"MDigital_quarantinedSurveyPhaseEnded",MDIGITAL_TARGETING_RULE_EVALUATED:"MDigital_targetingRuleEvaluated",MDIGITAL_SCREEN_CAPTURE_LOADED:"neb_screenCaptureLoaded",MDIGITAL_SDK_PAGE_VIEW:"neb_sdkPageView",MDIGITAL_WARNING:"MDigital_warning",MDIGITAL_COULD_NOT_FETCH_DATA:"MDigital_couldNotFetchData",MDIGITAL_COULD_NOT_LOAD_FORM_APPLICATION:"MDigital_couldNotLoadFormApplication",NEB_EVENT_DISPATCHER_ERROR:"neb_eventDispatcherError",NEB_LOAD_FORM:"neb_loadForm",NEB_FORM_LOADING_HAS_FAILED:"neb_formLoadingHasFailed",NEB_RESET_FORM_STATE:"neb_resetFormState",MDIGITAL_DYNAMIC_ONSITE_INITIALIZED_SUCCESSFULLY:"MDigital_DynamicOnsiteInitializedSuccessfully",CREATE_SESSION:"createSession",MDIGITAL_NO_JSON_MODAL_SHOWN:"MDigital_noJsonModalShown",MDIGITAL_NO_JSON_MODAL_CLOSED:"MDigital_noJsonModalClosed",MDIGITAL_UPDATE_TARGETING_WITH_DECLINED_DATE_FORM_CLOSED:"MDigital_updateTargetingWithDeclinedDateFormClosed",MDIGITAL_UPDATE_TARGETING_WITH_DECLINED_DATE_INVITE_DECLINED:"MDigital_updateTargetingWithDeclinedDateInviteDeclined",MDIGITAL_CHTML_LOGS:"MDigital_CHTML_Logs",SCREEN_CAPTURE_RETAKE:"MDigital_screenCaptureRetake",SCREEN_CAPTURE_DELETE:"MDigital_screenCaptureDelete",CUSTOM_EVENTS_DEBUG_MESSAGE:"mdigital_customEventsDebugMessage",MDIGITAL_VALIDATE_ORIGIN:"MDigital_validate_origin",DIRECT_GENERIC_INJECTION:"MDigital_directGenericInjection"},LOG_MESSAGES:{TRIGGER_MESSAGE_TEMPLATE:"Event {{EVENT_NAME}} has been {{STATUS}}. \n the data is: {{DATA}}. \n the context is :{{CONTEXT}}. \n the options are : {{OPTIONS}}.\n",ERROR_LOG_TEMPLATE:"Error Message is {{ERROR_MESSAGE}}",ERROR_DYNAMIC_ONSITE_INITIALIZATION:"Failed to fetch onsite data.",ERROR_ONSITE_SDK_CONFIGURATION_MISSING:"Failed to execute KAMPYLE_ONSITE_SDK.{{METHOD}}, due to missing onsite configuration."},LOG_STATUSES:{FAILED:"failed",TRIGGERED:"triggered"},OPERATORS:{REGEX:"regex",EQUALS:"equals",DOES_NOT_EQUAL:"doesnotequal",CONTAINS:"contains",DOES_NOT_CONTAIN:"doesnotcontain",STARTS_WITH:"startswith",ENDS_WITH:"endswith",HAS_VALUE:"hasvalue",LATER_THAN:"laterthan",EARLIER_THAN:"earlierthan",GREATER_THAN:"greaterthan",SMALLER_THAN:"smallerthan"},TARGETING_STATUS:{CANDIDACY:"candidacy",TRIGGERED:"triggered",QUARANTINED:"quarantined"},TARGETING_PHASES:{PAGE_TARGETING:"pageTargeting",BEHAVIORAL_TARGETING:"behavioralTargeting",QUARANTINE_TARGETING:"quarantineTargeting"},TARGETING_RULES:{INVITE_IF_ANY_SURVEY_ALREADY_SUBMITTED_PER_SESSION:"InviteAnySurveyAlreadySubmittedPerSession",INVITE_IF_ANY_INVITE_ALREADY_SHOWN_PER_SESSION:"InvitePerSession"},REGIONS:{DEV:"dev",QA:"qa",COLO_QA:"digital-cloud-qa",COLO_US:"digital-cloud-us"},MEMORY_DATA_FIELDS:{MDIGITAL_ALTERNATIVE_UUID:"mdigital_alternative_uuid",FETCHING_DATA_IN_PROGRESS:"FETCHING_DATA_IN_PROGRESS_",DATA_JSON:"dataJson",HAS_ONSITE_CONFIGURATION:"hasOnsiteConfiguration",SESSION_TAB_PREFIX:"ONSITE_SESSION_TAB_",CURRENT_SESSION_TAB_ID:"CURRENT_SESSION_TAB_ID",TIMEOUT_HANDLERS:"mdTimeoutHandlers",FEEDBACK_CORRELATION_UUID:"feedbackCorrelationUUID",IS_BUTTON_CONTAINER_CREATED:"isButtonContainerCreated",REGION:"region",FEEDBACK_BUTTON_POSITION_STYLE:"buttonPositionStyle",LIVE_FORM_V2_DEBUG_MODE:"md_liveFormV2_isDebugMode",DOM_EVENT_HANDLERS:"domEventHandlers",DECIBEL_DATA:"decibelData",EX_AUTHORIZATION_TOKEN:"md_ex_AuthorizationToken"},SESSION_DATA_FIELDS:{IS_SURVEY_SUBMITTED_IN_SESSION:"md_isSurveySubmittedInSession"},TIMEOUT_HANDLERS:{FORM_APP_STATUS:"formAppStatus",EMBEDDED_STATUS:"embeddedFormStatus"},CSS_FONT_RULE:"CSSFontFaceRule",NETWORK:{RETRY_TIMEOUT:1e3,REQUEST_TIMEOUT:5e3,TIME_FOR_FORM_TO_LOAD_MS:6e4,NUM_OF_RETRIES:3},ERROR_CODE:{SECURITY_ERROR:18},KEY_CODES:{SPACE:32,TAB:9,ENTER:13,ESC:27},BROWSERS:{IE:"IE",CHROME:"Chrome",FIREFOX:"Firefox",SAFARI:"Safari"},MOBILE_SCREEN_WIDTH:480,TEXTS:{DEFAULT_JSON_ERROR_MESSAGES:{title:"Oops...",body:"We can\u2019t collect your feedback at the moment.<br/>Refresh your page and try again",close:"Close this modal"},SCREEN_CAPTURE:{DEFAULT_TITLE:"Screen Capture",DEFAULT_DESCRIPTION:'Click "Capture Image" button or drag the cursor to highlight a specific area'}},FORM_LOADING_FAILURE_CAUSE:{APPLICATION_FAILED:"applicationFailed",JSON_FAILED:"jsonFailed"},PROPERTY_MESSAGES:{NO_JSON_MESSAGE:{TYPE:"noJsonMessage",KEYS:{TITLE:"title",BODY:"body",CLOSE:"close"}}},BROWSER_EVENTS:{FOCUS:"focus",MOUSE_DOWN:"mousedown"},SCREEN_CAPTURE:{DOM_SELECTION:"DOM_SELECTION",DOM_SELECTION_VALUE:"domSelector",AREA_SELECTION_VALUE:"highlight"},ANALYTICS_HTTP_EVENTS_BY_METHOD:{BEFORE:{POST:"neb_beforeHttpPostRequest"},AFTER:{GET:"neb_afterHttpGetRequest",POST:"neb_afterHttpPostRequest"},TIMEOUT:{GET:"neb_afterHttpGetRequestOnTimeout",POST:"neb_afterHttpPostRequestOnTimeout"},ERROR:{GET:"neb_afterHttpGetRequestOnError",POST:"neb_afterHttpPostRequestOnError"},ERROR_STATUS_CODE:{GET:"neb_afterHttpGetRequestOnErrorStatusCode",POST:"neb_afterHttpPostRequestOnErrorStatusCode"}},HTTP_METHODS:{GET:"GET",POST:"POST"},COLORS:{USERSNAP_V4_SELECTION_COLOR:"#fb585b",USERSNAP_ONPREM_SELECTION_COLOR:"#004CCB"},VIEW:{FEEDBACK_BUTTON_ID:"nebula_div_btn",FEEDBACK_BUTTON_CONTAINER_ID:"kampyleButtonContainer"},BUTTON:{MAX_WIDTH:300,MIN_HEIGHT:81},CLOSE_FORM_PARAM_VALUES:{ALL:"all",EMBEDDED:"embedded",MODAL:"modal"},SPINNER_SETTINGS:{ID:"MDigital_spinnerCircle",CONTAINER_ID:"MDigital_spinnerContainer",SIZE:{LARGE:"large",SMALL:"small"}},CSS_SETTINGS:{STYLE_SHEET_ANIMATION_NAME:"MDigital_animationStyle",ANIMATION_RULE_SPIN_NAME:"MDigital_spin"}};function Q(t){"@swc/helpers - typeof";return t&&typeof Symbol!="undefined"&&t.constructor===Symbol?"symbol":typeof t}function j(t,e){return e!=null&&typeof Symbol!="undefined"&&e[Symbol.hasInstance]?!!e[Symbol.hasInstance](t):j(t,e)}function ao(){o.setMemoryData(i.MEMORY_DATA_FIELDS.HAS_ONSITE_CONFIGURATION,!1);var t=Or(),e=t&&t.region||i.REGIONS.DEV;o.setMemoryData(i.MEMORY_DATA_FIELDS.REGION,e)}function oo(){return!o.getMemoryData(i.MEMORY_DATA_FIELDS.HAS_ONSITE_CONFIGURATION)}function Or(){var t=o.getMemoryData(i.MEMORY_DATA_FIELDS.DATA_JSON);return t||{provisions:{"24dcr2_MPC7960_enableOnsitePostMessageVerification":null,"20dcr4_MPC2905_wcagReviewFixes":!0,cpExtractRefactor:null,chtmlLogs:null,"25dcr4_MPC9440_enableNewFeedbackSubmitEvents":null,customEventsBroadcast:!0,googleAnalyticsClientEventsEnabled:null,spaUrlPolling:null,"20dcr4_MPC2802_enable_backendGeneratedUUID":!0,"21dcr2_MPC2743_enable_newLiveForm":!0,willNotScrollToLastPositionDisplayTypeAnimation:null,cooladataNewEvents:null,adobeAnalytics:null,eventIncludeFeedbackContent:null,"24dcr3_MPC7720_enableNewLiveFormCSP":null,customHtmlFormsEnable:!1,propertyMessages:!0,cooladataEventsLimit:null,targetingEventsReporting:null,"23dcr2_MPC6869_disableNewPageEvents":!0,"21DCR3_MPC3866_exposeSelectionQuestionsInCustomEvent":!0,"23dcr1_mpc6083_enableMobileWebiOSBannerFix":null,"21dcr3_MPC3281_enable_CHTMLHandleFocusIndependently":null,serverBasedTargeting:null,CSPRemoveInlineStyling:!0,enableOverflow:null,addingRandomTimeForTimeInSession:null,cookieStorageDisable:null,screenCaptureEnabled:!0,"23dcr5_MPC7566_extractProvisionsToOnsiteData":!0,"21DCR3_MPC3866_exposeVerbatimQuestionsInCustomEvent":null,"22dcr2_MPC4277_useDecibelTriggers":!0,onPremHybrid:null,enableZeroRating:null,"23dcr3_MPC6996_enableOnsiteDomainApproval":null,"21dcr3_MPC3281_enable_newModalDialogs":!0,"23dcr3_MPC4831_enableEncapsulation":!0,UBTExtraEvents:null,decibelInsight:!0,WCAGTrapFocusInModal:!0,dynamicHybridHosting:null,underScoreLocalization:null,"24dcr1_MPC_7567_enableDigitalFeedbackAnalytics":!0,thermoFisherTeaLeafIntegration:null,alternativeUUID:null,separateFormTemplateFromData:!0,dynamicOnsiteEvents:null,"21dcr6_MPC4042_enable_exmdextension":null,"21DCR2_MPC3662_EnableEventsForCEDebug":!1,"23dcr2_MPC6869_enableCXJSessionEvents":null,"25dc1_MPC8353_enableDynamicAnalyticsEvents":null,parallelTabSolution:!0},onsiteDataUrl:null,region:"digital-cloud-west",websiteId:469456,accountId:145270,packageVersion:"#####ON_PREM_PACKAGE_VERSION#####",placeholders:{DEFAULT_ANALYTICS_SUBMIT_EVENTS_URL:"https://analytics-fe.digital-cloud-west.medallia.com/api/web/events",USER_AGENT_CLIENT_HINTS_LIST:'["brands", "mobile", "platform", "architecture", "model", "bitness", "platformVersion", "fullVersionList", "wow64", "uaFullVersion"]',DIGITAL_ANALYTICS_STATIC_EVENTS_LIST:"[]",ONSITE_DATA_PATH:"resources.digital-cloud-west.medallia.com/wdcwest/469456/onsite/onsiteData1769346909980.json",SUBMIT_URL_PREFIX:"https://feedback.digital-cloud-west.medallia.com/",JS_SITE_CODE:"resources.digital-cloud-west.medallia.com/wdcwest/469456/onsite/generic1769346910184.js",DEFAULT_MEC_INTEGRATION_ID:"samsunggmc-sea1-medallia-com-samsunggmc",USERSNAP_HOST_PREFIX:"//screencapture.kampyle.com/",COOLADATA_API_HOST:"udc-neb.kampyle.com/",COOLADATA_SRC_PREFIX:"https://resources.digital-cloud-west.medallia.com/",ONSITE_VERSION:"1.69.1",USERSNAP_V4_HOST_PREFIX:"//scp.kampyle.com",URL_PREFIX:"https://resources.digital-cloud-west.medallia.com/",USERSNAP_ONPREM_HOST_PREFIX:"https://md-scp.kampyle.com/"},isSpa:!1,exemptEmbeddedFormsFromQuarantine:!1,isWCAG:!0,isManuallyInviteTargeting:!1,isGoogleAnalyticsClientGTM:!1,isFormsPreloaded:!0,cookieExpirationTime:null,adobeSdkName:null,sharedSubdomain:null,customCssUpload:!1,exemptButtonFormsFromQuarantine:!1,exemptCodeFormsFromQuarantine:!1,screenCaptureSelectionTool:"AREA_SELECTION"}}function so(t){s.httpRequest(i.HTTP_METHODS.GET,t,null,y.onsiteDataSuccess,y.onsiteDataFailed)}function lo(t){if(!t||t.error)y.onsiteDataFailed(t);else{o.setMemoryData(i.MEMORY_DATA_FIELDS.HAS_ONSITE_CONFIGURATION,!0);var e=y.formatConfiguration(t);e&&(e.provisions=Object.assign({},e.provisions,y.getOnsiteConfiguration().provisions));var r=Object.assign({},y.getOnsiteConfiguration(),e);r.provisions&&r.provisions[i.PROVISIONS.DYNAMIC_ONSITE_EVENTS]&&E.trigger(i.EVENTS.MDIGITAL_DYNAMIC_ONSITE_INITIALIZED_SUCCESSFULLY),Ie.initOnsite(r)}}function uo(t){var e={errorMessage:i.LOG_MESSAGES.ERROR_DYNAMIC_ONSITE_INITIALIZATION,additionalInfo:t};E.triggerError(e),o.setMemoryData(i.MEMORY_DATA_FIELDS.HAS_ONSITE_CONFIGURATION,!1)}function co(t){var e=t,r;if(e.formNodes&&e.formNodes.length)for(var n=0;n<e.formNodes.length;n++)typeof e.formNodes[n].customParams=="string"&&(r=JSON.parse(e.formNodes[n].customParams),e.formNodes[n].customParams=r);return e}var y={init:ao,isOnsiteConfigurationMissing:oo,getOnsiteConfiguration:Or,onsiteDataSuccess:lo,onsiteDataFailed:uo,fetchOnsiteExternalConfiguration:so,formatConfiguration:co};var mo=["formHtmlUrl","buttonData.buttonUrl","formDataUrl","inviteData.inviteUrl","inviteData.inviteDataUrl","versionedResourcesUrl"];function Eo(){return window.KAMPYLE_EMBED.getResourcesPrefix()}function fo(){return s.getNestedPropertyValue(y.getOnsiteConfiguration(),"packageVersion")}function Mr(t){t=t||"";var e;if(t.indexOf(i.PLACEHOLDERS.ONPREM_URL_PREFIX)===-1)return t;var e=t.replace(i.PLACEHOLDERS.ONPREM_URL_PREFIX,window.KAMPYLE_EMBED.getResourcesPrefix());return e}function go(t){return t?(mo.forEach(function(e){var r=s.getNestedPropertyValue(t,e);r&&s.setNestedPropertyValue(t,e,Mr(r))}),t):!1}var Ae={replaceOnPremPrefixes:Mr,getPackageVersion:fo,getPackageRoot:Eo,replaceFormNodeUrls:go};function _o(t){return KAMPYLE_ONSITE_SDK.loadForm(t)}function Io(t,e){return KAMPYLE_ONSITE_SDK.showForm(t,e)}function po(t){return KAMPYLE_ONSITE_SDK.closeForm(t)}function So(t,e){o.isV2Form(e)&&o.getData(i.MEMORY_DATA_FIELDS.LIVE_FORM_V2_DEBUG_MODE)&&(t=t.replace("/index.html","/debug/index.html")),t+="?formId="+e,t+="&type=live",t+="&isMobile="+o.isMobile();var r=window.location.href,n=r.split("?");n&&n.length&&(r=n[0]),t+="&referrer="+encodeURIComponent(r);var a=o.getMemoryData("region");return a&&(t+="&region="+a),o.isFeatureEnabled("WCAG")&&(t+="&isWCAG=true"),c.checkProvision(i.PROVISIONS.CHTML_LOGS)&&o.isCustomHtmlForm(e)&&(t+="&chtmlLogs=true"),t+="&displayType="+o.getDisplayType(o.getFormData(e)),c.checkProvision(i.PROVISIONS.FORM_TEMPLATE_DATA_SEPERATION)&&(t+="&isSeparateFormTemplateFromData=true"),t+="&domainsListRelativePath="+encodeURIComponent(Pr(t)),t}function To(t){for(var e="",r=0;r<t;r++)e+="..|";return e}function Pr(t){var e=Cr().match(/((?:[\/](?!\/))[a-zA-Z0-9_-]+[\/a-zA-Z0-9_-]*)$/),r=e?e[0]+"resources/config":"/resources/config";if(o.getMemoryData("context")==="preview")return r;var n=s.getParsedUrl(KAMPYLE_EMBED.getGenericLocation()),a=s.getParsedUrl(t);if(n.hostname!==a.hostname)return r;var l=n.pathname,d=a.pathname;if(l&&d){var u=l.split("/").slice(1,-1),m=d.split("/").slice(1,-1);return To(m.length)+u.join("/")}return""}function Ao(t){var e=o.getFormState(t),r=null;for(var n in i.FORM_LOADING_FAILURE_CAUSE){var a=i.FORM_LOADING_FAILURE_CAUSE[n];if(e[a]===!0){r=a;break}}return r}function Cr(){var t=c.checkProvision(i.PROVISIONS.ON_PREM_HYBRID);return t?Ae.getPackageRoot()+"/":i.PLACEHOLDERS.URL_PREFIX}function vo(){var t='<div id="'+i.SPINNER_SETTINGS.CONTAINER_ID+'" class="neb-loading-spinner">';return t+='<div id="'+i.SPINNER_SETTINGS.ID+'"> </div>',t+="</div>",t}var Z={loadForm:_o,showForm:Io,closeForm:po,createFormUrl:So,getSpinnerTemplate:vo,getUrlPrefix:Cr,getFormFailureCause:Ao,getDomainsListRelativePath:Pr};function bo(t){if(!c.checkProvision(i.PROVISIONS.CP_EXT_REFACTOR))return c.getSafeCustomParamVal(t);var e=t||{},r=w.extractCPValue(e);return w.castCPValue(r,e.type||"")}function Do(t){var e=w.getFormCustomParams(t)||[];return e.map(w.appendValueToCPObject)}function yo(t){var e=y.getOnsiteConfiguration().customParams||[],r=o.getFormData(t)||{};return Rr(t)?r.customParams.map(function(n){return e.find(function(a){return a.id===n})}):null}function Rr(t){var e=o.getFormData(t);return!!e&&!!e.customParams&&Array.isArray(e.customParams)&&!!e.customParams.length}function ho(){return y.getOnsiteConfiguration().customParams||[]}function No(t){var e=w.getCustomParamByUniqueName(t)||{};return w.getCustomParamValue(e)}function Oo(t){var e=y.getOnsiteConfiguration().customParams||[];return e.find(function(r){return r.unique_name===t})}function Mo(t,e){if(t!==void 0&&e&&e.customParams&&e.customParams.length){var r=y.getOnsiteConfiguration().customParams||[];return r.find(function(n){return Number(n.id)===Number(t)})||null}else return null}function Lr(t){var e=t.value,r=(t.source||"var").toLowerCase(),n=t.name||t.source_name||"";switch(s.safeToLower(r)){case"var":e=s.getNestedPropertyValue(window,n);break;case"url":e=s.getUrlParam(n);break;case"cookie":e=s.getCookie(n);break;default:e=null;break}return e!==""?e:null}function Po(t){var e=t.value;return e===void 0&&(e=Lr(t)),e!==""?e:null}function Co(t,e){if(t===null)return t;switch(e.toLowerCase()){case"datetime":return w.handleDatetimeCasting(t);case"number":return s.getNumericValue(t);case"text":return w.handleTextCasting(t);case"boolean":return w.handleBooleanCasting(t);default:return console.error("Invalid custom parameter type "+e),null}}function Ro(t){return typeof t=="string"?Number(t)||null:!j(t,Date)&&(!(t||{}).getTime||isNaN(t.getTime()))?null:t.getTime()}function Lo(t){return typeof t=="string"?t:null}function Fo(t){return t==="true"?!0:t==="false"?!1:typeof t=="boolean"?t:null}function ko(t){t=t||{};var e=w.getCustomParamValue({name:t.source_name,type:t.type,source:t.source});return Object.assign(t,{value:e})}var w={getCustomParamValue:bo,formatCustomParams:Do,getFormCustomParams:yo,hasCustomParams:Rr,fetchCPValue:Lr,getAllCustomParams:ho,getCustomParamValueByUniqueName:No,getCustomParamByUniqueName:Oo,getCustomParamById:Mo,extractCPValue:Po,castCPValue:Co,handleDatetimeCasting:Ro,handleTextCasting:Lo,handleBooleanCasting:Fo,appendValueToCPObject:ko};var wo="decibel.ks.realtime.behaviours.",Go="decibel.ks.realtime.";function Uo(){E.subscribe("neb_showForm",xo),document.addEventListener("decibel.ks.realtime",Bo)}function xo(t,e){var r=e.formId,n=o.getFormData(r),a=s.getNestedPropertyValue(n,"onSiteData.decibelBehavioural"),l=s.getNestedPropertyValue(n,"onSiteData.decibelScore");(a||l)&&typeof window.decibelInsight=="function"&&window.decibelInsight("sendTrackedEvent","Medallia Digital: Real-time activated survey",r)}function Bo(t){var e=s.getNestedPropertyValue(t,"detail.data");o.setMemoryData(i.MEMORY_DATA_FIELDS.DECIBEL_DATA,e)}function Vo(t,e,r,n){var a=wo+t,l=function(u){document.removeEventListener(a,l),o.deleteMemoryData(i.MEMORY_DATA_FIELDS.DOM_EVENT_HANDLERS+".decibelBehavioural");var m=setTimeout(function(){o.setMemoryData("targetingState.decibelBehavioural",!0),E.trigger(i.EVENTS.MDIGITAL_TARGETING_RULE_EVALUATED,{formId:n,targetingRule:"decibelBehavioural",formTriggerType:o.getFormTriggerType(n),targetingPhase:i.TARGETING_PHASES.BEHAVIORAL_TARGETING,isPassed:!0,expected:"decibelBehavioural rule should have been triggered: "+t,actual:!0}),r()},(e||0)*1e3);o.setTimeoutHandler("decibelBehavioural",m)};document.addEventListener(a,l),o.setDOMEventHandler("decibelBehavioural",a,l)}function Ho(t,e,r,n,a){var l=Go+t,d=function(m){var f=Fr(m.detail,r,e);f&&(o.setMemoryData("targetingState.decibelScore",!0),E.trigger(i.EVENTS.MDIGITAL_TARGETING_RULE_EVALUATED,{formId:a,targetingRule:"decibelScore",formTriggerType:o.getFormTriggerType(a),targetingPhase:i.TARGETING_PHASES.BEHAVIORAL_TARGETING,isPassed:f,expected:"Decibel score should be "+r+" "+e,actual:"Decibel current score: "+m.detail+", Expected score: "+e+", Event name:"+t}),document.removeEventListener(l,d),o.deleteMemoryData(i.MEMORY_DATA_FIELDS.DOM_EVENT_HANDLERS+".decibelBehavioural"),n())};document.addEventListener(l,d),o.setDOMEventHandler("decibelBehavioural",l,d)}function Fr(t,e,r){var n=Number(r);switch(e){case"smallerThan":return t<n;case"equals":return t===n;case"greaterThan":return t>n;default:return!1}}var ve={init:Uo,listenToBehaviouralEvent:Vo,listenToScoreEvent:Ho,isScoreValid:Fr};var Yo={DECLINED_DATE:"The user did not decline",SUBMITTED_DATE:"The user did not submit"};function Wo(){var t={neb_targetingInit:[Zr],MDigital_manuallyInviteTargeting:[Qr],neb_initButton:[wr]};E.subscribeMany(t),o.setMemoryData("targetingState",{})}function ht(t,e){var r=Number(o.getData(e));if(t=Number(t),!r||!t)return!1;var n=1e3*60*60*24;return r+n*t>s.getCurrentTimestamp()}function wr(t,e){e=e||{};var r=o.getFormData(e.formId);if(!r)return!1;var n=o.getMemoryData("kampyleDevice");return(n===i.DEVICES.MOBILE||n===i.DEVICES.TABLET)&&c.isPreloadConfigured()&&E.trigger(i.EVENTS.NEB_LOAD_FORM,{formId:e.formId}),o.setFormState(e.formId,{loaded:null}),o.setMemoryData("buttonFormId",e.formId),E.trigger("neb_showButton",{formId:e.formId}),o.setMemoryData("isButtonShown",!0),!0}function Ko(t){return o.getData(t)?new Date(parseInt(o.getData(t))):Yo[t]}function pe(t){s.sendMessageToIframe("kampyleInvite",{action:i.EVENTS.MDIGITAL_VALIDATE_ORIGIN});var e=o.getMemoryData("currentInviteFormId");if(t=t||o.getFormData(e),!t||o.getMemoryData("isInvitationShouldBeIgnored"))return!1;var r=s.getNestedPropertyValue(t,"inviteData.skipInvitation"),n=o.getMemoryData("targetingState");for(var a in n)if(n[a]!==!0)return!1;var l=L.shouldDisableIntercept(t);if(E.trigger(i.EVENTS.MDIGITAL_BEHAVIORAL_TARGETING_PHASE_ENDED,t),l)return!1;var d=Gr(t);return E.trigger(i.EVENTS.MDIGITAL_QUARANTINED_SURVEY_PHASE_ENDED,t),d?(o.setData("kampyleInvitePresented",!0),s.isTruthy(r)?Xo(t):L.handleNotSkippedInvitaion(t),!0):!1}function Gr(t){var e=jr(t),r=o.getMemoryData("formIsShown")===!0,n=s.isTrue(s.getNestedPropertyValue(t,"onSiteData.kampyleInvitePerSession.inviteOncePerSession")),a=!n&&s.isTrue(o.getData("kampyleInvitePresented"));E.trigger(i.EVENTS.MDIGITAL_TARGETING_RULE_EVALUATED,{formId:t.formId,targetingRule:i.TARGETING_RULES.INVITE_IF_ANY_INVITE_ALREADY_SHOWN_PER_SESSION,formTriggerType:o.getFormTriggerType(t.formId),targetingPhase:i.TARGETING_PHASES.QUARANTINE_TARGETING,isPassed:!a,expected:"Display Invite "+(n?"more than once per session":"once per session"),actual:!a});var l=!1;return c.checkProvision(i.PROVISIONS.EXEMPT_FORMS_FROM_QUARANTINE)&&(l=!n&&s.isTrue(o.getData(i.SESSION_DATA_FIELDS.IS_SURVEY_SUBMITTED_IN_SESSION)),E.trigger(i.EVENTS.MDIGITAL_TARGETING_RULE_EVALUATED,{formId:t.formId,targetingRule:i.TARGETING_RULES.INVITE_IF_ANY_SURVEY_ALREADY_SUBMITTED_PER_SESSION,formTriggerType:o.getFormTriggerType(t.formId),targetingPhase:i.TARGETING_PHASES.QUARANTINE_TARGETING,isPassed:!l,expected:"Display Invite "+(n?"more than once per session":"once per session"),actual:!l})),!e&&!r&&!a&&!l}function Ur(t){var e=c.checkProvision(i.PROVISIONS.SERVER_BASED_TARGETING)&&c.checkProvision(i.PROVISIONS.DO_NOT_SURVEY_ON_UBT_NETWORK_FAIL)&&!o.getMemoryData("isGuest")&&!o.getMemoryData("isSyncedIdentifierData");return e&&E.trigger(i.EVENTS.MDIGITAL_TARGETING_RULE_EVALUATED,{formId:t.formId,targetingRule:"ubtFailed",formTriggerType:o.getFormTriggerType(t.formId),targetingPhase:i.TARGETING_PHASES.PAGE_TARGETING,isPassed:!e,expected:"should ignore quarantine rules evaluation",actual:e}),e}function Xo(t){c.isPreloadConfigured()||E.trigger(i.EVENTS.NEB_LOAD_FORM,{formId:t.formId}),E.trigger("neb_skipInvitation",{formId:t.formId})}function zo(t){var e=ss(t.onSiteData)===!0,r=s.getNestedPropertyValue(t,"onSiteData.submitted.days"),n=L.getTextByQuarentine("SUBMITTED_DATE");return r&&E.trigger(i.EVENTS.MDIGITAL_TARGETING_RULE_EVALUATED,{formId:t.formId,targetingRule:"DontInviteOnSubmitted",formTriggerType:o.getFormTriggerType(t.formId),targetingPhase:i.TARGETING_PHASES.QUARANTINE_TARGETING,isPassed:!e,expected:r+" days",actual:"Current: "+new Date+" Submitted: "+n}),e}function qo(t){var e=os(t.onSiteData)===!0,r=L.getTextByQuarentine("DECLINED_DATE"),n=s.getNestedPropertyValue(t,"onSiteData.declined.days");return n&&E.trigger(i.EVENTS.MDIGITAL_TARGETING_RULE_EVALUATED,{formId:t.formId,targetingRule:"DontInviteOnDeclined",formTriggerType:o.getFormTriggerType(t.formId),targetingPhase:i.TARGETING_PHASES.QUARANTINE_TARGETING,isPassed:!e,expected:n+" days",actual:"Current: "+new Date+" Declined: "+r}),e}function Jo(t){var e=!1,r=s.getNestedPropertyValue(t,"onSiteData.disableInterceptRule");return r&&(typeof r=="string"&&(r=JSON.parse(r)),e=L.evaluateRule(r,t),E.trigger(i.EVENTS.MDIGITAL_TARGETING_RULE_EVALUATED,{formId:t.formId,targetingRule:"disableInterceptRule",formTriggerType:o.getFormTriggerType(t.formId),targetingPhase:i.TARGETING_PHASES.BEHAVIORAL_TARGETING,isPassed:e,expected:"Disable intercept rule should be true",actual:e})),e}function Zo(t){o.getDisplayType(t)===i.DISPLAY_TYPES.POPUP?(o.setFormState(t.formId,{inviteShown:!0}),E.trigger("neb_showInvitation",{formId:t.formId})):c.isFormLoaded(t.formId)?E.trigger("neb_showInvitation",{formId:t.formId}):(o.setMemoryData(L.generateShouldShowInviteParamName(t.formId),!0),E.trigger(i.EVENTS.NEB_LOAD_FORM,{formId:t.formId}))}function Qo(){var t=o.getMemoryData("targetingState");t.kampyleTimeInSession=!1,o.getMemoryData("kampyleDevice")==="desktop"&&(t.abandon=!1),t.kampylePageElementEvent=!1,t.kampyleTimeOnPage=!1,t.decibelBehavioural=!1,t.decibelScore=!1,o.setMemoryData("targetingState",t)}function jo(t){var e=!0,r;if(e===!0&&(r=Hr(t),s.getNestedPropertyValue(t,"urlRules.exclusionUrl.rule")&&E.trigger(i.EVENTS.MDIGITAL_TARGETING_RULE_EVALUATED,{formId:t.formId,targetingRule:"UrlExclude",formTriggerType:o.getFormTriggerType(t.formId),targetingPhase:i.TARGETING_PHASES.PAGE_TARGETING,isPassed:!r,expected:s.getNestedPropertyValue(t,"urlRules.exclusionUrl.rule"),actual:location.href}),r===!0&&(e=!1)),e===!0){var n=Yr(t);s.getNestedPropertyValue(t,"urlRules.inclusionUrl.rule")&&E.trigger(i.EVENTS.MDIGITAL_TARGETING_RULE_EVALUATED,{formId:t.formId,formTriggerType:o.getFormTriggerType(t.formId),targetingRule:"UrlInclude",targetingPhase:i.TARGETING_PHASES.PAGE_TARGETING,isPassed:n,expected:s.getNestedPropertyValue(t,"urlRules.inclusionUrl.rule"),actual:location.href}),n===!1&&(e=!1)}if(e===!0){var a=xr(t);s.getNestedPropertyValue(t,"onSiteData.genericRule")&&E.trigger(i.EVENTS.MDIGITAL_TARGETING_RULE_EVALUATED,{formId:t.formId,targetingRule:"GenericRule",formTriggerType:o.getFormTriggerType(t.formId),targetingPhase:i.TARGETING_PHASES.PAGE_TARGETING,isPassed:a,expected:"Generic rule evaluation result should be true",actual:a}),e=a}return e===!0&&(e=Wr(t),s.getNestedPropertyValue(t,"onSiteData.devicetypes")&&E.trigger(i.EVENTS.MDIGITAL_TARGETING_RULE_EVALUATED,{formId:t.formId,targetingRule:"DeviceTypes",formTriggerType:o.getFormTriggerType(t.formId),targetingPhase:i.TARGETING_PHASES.PAGE_TARGETING,isPassed:e,expected:s.getNestedPropertyValue(t,"onSiteData.devicetypes").toString(),actual:o.getMemoryData("kampyleDevice")})),e}function xr(t){return t&&t.onSiteData&&t.onSiteData.genericRule?(typeof t.onSiteData.genericRule=="string"&&(c.checkProvision(i.PROVISIONS.GREATER_SMALLER_THAN_DECODE)&&(t.onSiteData.genericRule=s.htmlDecode(t.onSiteData.genericRule)),t.onSiteData.genericRule=JSON.parse(t.onSiteData.genericRule)),L.evaluateRule(t.onSiteData.genericRule,t)):!0}function Br(t){if(typeof t!="string"||t==="")return!1;t=t.replace(/%3B/g,";"),t=t.toLowerCase();var e=document.location.href.toLowerCase(),r=e.substring(0,t.length);return r===t?!0:(e=e.replace(/^(?:https?:\/\/)?(?:www\.)?([^\/]+)/i,""),r=e.substring(0,t.length),r===t)}function Vr(t){t=t.split(";");for(var e=t.length,r=0;r<e;r++){var n=Br(t[r]);if(n===!0)return!0}return!1}function Hr(t){if(t.urlRules&&t.urlRules.exclusionUrl&&t.urlRules.exclusionUrl.rule){var e=Vr(t.urlRules.exclusionUrl.rule);return e}return!1}function Yr(t){if(t.urlRules&&t.urlRules.inclusionUrl&&t.urlRules.inclusionUrl.rule){var e=Vr(t.urlRules.inclusionUrl.rule);return e}return!0}function $o(t,e){var r={text:[i.OPERATORS.EQUALS,i.OPERATORS.DOES_NOT_EQUAL,i.OPERATORS.CONTAINS,i.OPERATORS.DOES_NOT_CONTAIN,i.OPERATORS.STARTS_WITH,i.OPERATORS.ENDS_WITH,i.OPERATORS.HAS_VALUE,i.OPERATORS.REGEX],boolean:[i.OPERATORS.EQUALS,i.OPERATORS.HAS_VALUE],datetime:[i.OPERATORS.EQUALS,i.OPERATORS.DOES_NOT_EQUAL,i.OPERATORS.LATER_THAN,i.OPERATORS.EARLIER_THAN,i.OPERATORS.HAS_VALUE],number:[i.OPERATORS.EQUALS,i.OPERATORS.DOES_NOT_EQUAL,i.OPERATORS.GREATER_THAN,i.OPERATORS.SMALLER_THAN,i.OPERATORS.HAS_VALUE]};return t=s.safeToLower(t),e=s.safeToLower(e),!(!t||!e||!r[t]||r[t].indexOf(e)===-1)}function es(t,e){var r=!1,n,a,l;if(!t)return!1;var d=["customParam"],u=s.safeToLower(t.condition);if(!t||t.value===void 0||t.value===null||d.indexOf(t.fieldOrigin)===-1)r=!1;else switch(t.fieldOrigin){case"customParam":var m=w.getCustomParamById(t.fieldId,e);m&&m.source_name&&(n=w.getCustomParamValue({type:m.type,name:m.source_name,source:m.source}),a=w.getCustomParamValue({type:m.type,name:m.source_name,source:m.source,value:t.value}),l=$o(m.type,t.condition)),n!==void 0&&l&&(r=s.kampyleCompareByOperator(n,a,u,m.type));break;default:break}return r}function ts(t,e){var r,n=!1,a=!1;if(t&&t.type==="criteriaGroup"&&t.childrenCriterias&&t.childrenCriterias.length&&t.conjunction)for(var l=0;l<t.childrenCriterias.length&&!a;l++)r=L.evaluateRule(t.childrenCriterias[l],e),r&&t.conjunction==="OR"?(n=!0,a=!0):!r&&t.conjunction==="AND"?(n=!1,a=!0):n=r;else t&&t.type==="criteria"&&(n=es(t,e));return n}function rs(t){var e=o.getData("kampyleUserSessionsCount"),r=!1,n=s.getNestedPropertyValue(t,"onSiteData.numberOfVisits.numberOfRepeats"),a=s.getNestedPropertyValue(t,"onSiteData.numberOfVisits.compareString");return e&&(n===null||a===null?r=!0:r=s.kampyleCompareByOperator(parseInt(e),parseInt(n),a)),n&&E.trigger(i.EVENTS.MDIGITAL_TARGETING_RULE_EVALUATED,{formId:t.formId,targetingRule:"NumberOfVisits",formTriggerType:o.getFormTriggerType(t.formId),targetingPhase:i.TARGETING_PHASES.PAGE_TARGETING,isPassed:r,expected:a+" "+n,actual:e}),r}function Wr(t){if(t&&t.onSiteData&&t.onSiteData.devicetypes){for(var e=t.onSiteData.devicetypes.length,r=0;r<e;r++)if(t.onSiteData.devicetypes[r]===o.getMemoryData("kampyleDevice"))return!0;return!1}return!0}function Kr(t){t=t||{};var e=Number(o.getData("kampyleSessionPageCounter")||0);return s.kampyleCompareByOperator(e,parseInt(t.numberOfRepeats),t.compareString)}function Xr(){var t=o.getStorageDataByPrefix(i.MEMORY_DATA_FIELDS.SESSION_TAB_PREFIX);t.sort(function(r,n){return Number(r)-Number(n)});var e=t.findIndex(function(r){return Number(r)===o.getMemoryData(i.MEMORY_DATA_FIELDS.CURRENT_SESSION_TAB_ID)});return e>=0?(e+1)*i.DELAY_BETWEEN_TABS_TRIGGER_MS:null}function ns(){var t=Xr();typeof t=="number"&&setTimeout(function(){pe()},t)}function is(t,e){Nt(t,e,!0)}function as(){var t=o.getData("kampyleUserSession"),e=parseInt(t),r=s.getTimeDiff(e);return r}function Nt(t,e,r){var n=parseInt(t)*1e3,a=as(),l=o.getMemoryData("targetingState");if(l&&a>=n)l.kampyleTimeInSession=!0,o.setMemoryData("targetingState",l),E.trigger(i.EVENTS.MDIGITAL_TARGETING_RULE_EVALUATED,{formId:e.formId,targetingRule:"TimeInSession",formTriggerType:o.getFormTriggerType(e.formId),targetingPhase:i.TARGETING_PHASES.BEHAVIORAL_TARGETING,isPassed:!0,expected:n,actual:"Over on the expected "+n}),c.checkProvision(i.PROVISIONS.PARALLEL_TAB_SOLUTION)?r?L.isShowInvite():L.onTimeInSessionEnds():L.isShowInvite();else{if(c.checkProvision(i.PROVISIONS.PARALLEL_TAB_SOLUTION)&&r){var d=Math.ceil(Math.random()*999999999999);o.setData(i.MEMORY_DATA_FIELDS.SESSION_TAB_PREFIX+d,d),o.setMemoryData(i.MEMORY_DATA_FIELDS.CURRENT_SESSION_TAB_ID,d)}var u=0;if(c.checkProvision(i.PROVISIONS.ADD_RANDOM_TIME_FOR_SESSION)){var m=500,f=9e3;u=s.getRandomTimeMS(m,f)}var _=n-a,A=this;setTimeout(function(){Nt(t,e,!1)},_+u)}}function os(t){if(t=t||{},t.declined!==null&&t.declined!==void 0){var e=ht(t.declined.days,"DECLINED_DATE");return e}return!1}function ss(t){if(s.getNestedPropertyValue(t,"submitted")){var e=ht(t.submitted.days,"SUBMITTED_DATE");return e}return!1}function ls(t){var e=Yr(t)&&!Hr(t);e&&(o.setMemoryData("targetingState.abandon",!0),pe()===!1&&o.setMemoryData("targetingState.abandon",!1)),E.trigger(i.EVENTS.MDIGITAL_TARGETING_RULE_EVALUATED,{formId:t.formId,targetingRule:"UserAbandonment",formTriggerType:o.getFormTriggerType(t.formId),isPassed:e,targetingPhase:i.TARGETING_PHASES.BEHAVIORAL_TARGETING,expected:"Mouse over user abandonment",actual:"Mouse was over user abandonment"})}function ds(t,e){var r="0",n="5";t||(t={height:n,zIndex:r});var a=t.zIndex?t.zIndex:r,l=t.height&&t.height!=="0"?t.height+"px":n+"px",d=document.getElementById("kampyle_abandon_zone");if(d===null){var d=document.createElement("div");d.id="kampyle_abandon_zone",d.style.width="100%",d.style.height=l,d.style.zIndex=a,d.style.position="fixed",d.style.top="0px",d.onmouseover=function(){ls(e)},document.body.appendChild(d)}else d.style.height=l,d.style.zIndex=a}function zr(t){if(!t||!t.selectorValue||!t.selectorType)return null;var e="{{selector}}{{value}}";switch(t.selectorType){case"className":e=e.replace("{{selector}}",".");break;case"objectId":e=e.replace("{{selector}}","#");break;default:return s.showWarning("Invalid selector type:"+t.selectorType),null}return e=e.replace("{{value}}",t.selectorValue),e}function qr(t,e){var r=zr(t);if(!r)return null;for(var n=Number(t.time)||0,a=document.querySelectorAll(r)||[],l=0;l<a.length;l++){var d=function(){var m=setTimeout(function(){o.setMemoryData("targetingState.kampylePageElementEvent",!0),E.trigger(i.EVENTS.MDIGITAL_TARGETING_RULE_EVALUATED,{formId:e.formId,targetingRule:"PageElement",formTriggerType:o.getFormTriggerType(e.formId),isPassed:!0,targetingPhase:i.TARGETING_PHASES.BEHAVIORAL_TARGETING,expected:t.eventName+" for element with "+t.selectorType+"="+t.selectorValue,actual:!0}),pe()===!1&&o.setMemoryData("targetingState.kampylePageElementEvent",!1),clearTimeout(m)},n*1e3);o.setTimeoutHandler("triggerByEventTimeout_"+l,m)};a[l].addEventListener(t.eventName,d),o.setDOMEventHandler("triggerByEvent_"+l,t.eventName,d,a[l])}}function us(t){var e=s.getNestedPropertyValue(t,"onSiteData.kampyleTimeOnPage.time");e&&E.trigger(i.EVENTS.MDIGITAL_TARGETING_RULE_EVALUATED,{formId:t.formId,targetingRule:"TimeOnPage",formTriggerType:o.getFormTriggerType(t.formId),isPassed:!0,targetingPhase:i.TARGETING_PHASES.BEHAVIORAL_TARGETING,expected:e,actual:"Over on the expecetd "+e})}function cs(t,e){if(t===null){o.setMemoryData("targetingState.kampyleTimeOnPage",!0);return}var r=setTimeout(function(){o.setMemoryData("targetingState.kampyleTimeOnPage",!0),us(e),pe()},t*1e3);if(c.checkProvision(i.PROVISIONS.ENABLE_FIX_FOR_SPA_TIME_ON_PAGE)){var n="timeOnPage_"+e.formId;o.setTimeoutHandler(n,r)}o.setData("kampylePageLoadedTimestamp",s.getCurrentTimestamp())}function ms(){var t=Math.random()*100;return o.setData("kampyleUserPercentile",t),t}function Ot(t){var e=o.getData("kampyleUserPercentile");return!e&&e!=="0"&&(e=L.setUserPercentile()),Number(e)&&Number(e).toFixed?Number(e).toFixed(1):Number(e)}function Jr(t){var e=Ot();if(t&&e){var r=Number(t.prec);if(e>r)return!1}return!0}function Es(t){o.setMemoryData("isInviteActivated",!0);var e=o.getMemoryData("targetingState"),r=t.onSiteData.decibelBehavioural;r?ve.listenToBehaviouralEvent(r.eventName,r.time,pe,t.formId):e.decibelBehavioural=!0;var n=t.onSiteData.decibelScore;n?ve.listenToScoreEvent(n.eventName,n.score,n.compareString,pe,t.formId):e.decibelScore=!0,t.onSiteData.kampyleTimeInSession!==void 0?is(t.onSiteData.kampyleTimeInSession.time,t):e.kampyleTimeInSession=!0,t.onSiteData.abandon?o.getMemoryData("kampyleDevice")==="desktop"&&ds(t.onSiteData.abandon,t):e.abandon=!0;var a=o.getTargetingData(t.formId,"pageEvents");a?qr(a,t):e.kampylePageElementEvent=!0,t.onSiteData.kampyleTimeOnPage!==void 0?cs(t.onSiteData.kampyleTimeOnPage.time,t):e.kampyleTimeOnPage=!0,o.setMemoryData("targetingState",e);for(var l in e)if(e.hasOwnProperty(l)&&!e[l])return!1;pe(t)}function Zr(t,e){fs(),Qo(),Qr(t,e)}function fs(){o.setMemoryData("invitationTimeStamp",null),o.setMemoryData("buttonFormId",null),o.setMemoryData("formIsShown",!1),o.setMemoryData("isButtonShown",!1),o.setMemoryData("isInviteActivated",!1),o.setMemoryData("targetingState",{})}function gs(){var t=o.getAllForms();if(!(!t||!t.length)){for(var e,r=t.length-1;r>=0;r--)if(t[r].formType===i.FORM_TYPES.EMBEDDED&&(e=L.validateCommonTargetingOnForm(t[r]),e)){var n=!L.checkQuarantine(t[r]),a=L.validateCommonSessionTargeting(t[r].formId),l=!Ur(t[r]);l&&n&&a&&E.trigger(i.EVENTS.NEB_LOAD_FORM,{formId:t[r].formId})}}}function _s(){var t=null;if(c.checkProvision(i.PROVISIONS.SERVER_BASED_TARGETING)){t=c.getUserIdentifierVal();var e=t!==null;o.setMemoryData("isGuest",!e),E.trigger("neb_initUserIdentifier",{hasIdentifierValue:e})}return t}function kr(t,e,r){c.shouldSyncIdentifier(t)?(E.trigger("MDigital_settingIdentifierValueOnMemory",{hasIdentifierValue:t!==null}),o.setMemoryData("identifierValue",t),c.syncIdentifierData(encodeURIComponent(t),yt.bind(this,arguments[0],arguments[1]))):(E.trigger("MDigital_shouldNotSyncIdentifier"),yt(e,r))}function Qr(t,e){var r=_s();if(c.checkProvision(i.PROVISIONS.ENABLE_UBT_IDENTIFIER_HASH)){var n=s.sha512(r);n.then(function(a){kr(a,t,e)})}else kr(r,t,e)}function yt(t,e){e=e||{};var r=o.getAllForms();if(!(!r||!r.length)){L.initEmbeddedTargeting();for(var n,a=r.length-1;a>=0&&(r[a].formType===i.FORM_TYPES.BUTTON&&!e.skipButtonTargeting&&o.getMemoryData("isButtonShown")===!1?(n=L.validateCommonTargetingOnForm(r[a]),n===!0&&E.trigger("neb_initButton",{formId:r[a].formId})):L.shouldCheckInvite(r[a],e)&&(n=L.validateCommonTargetingOnForm(r[a])&&L.validateCommonSessionTargeting(r[a].formId),n===!0&&L.initDynamicTargeting(r[a])),!(o.getMemoryData("isInviteActivated")===!0&&o.getMemoryData("isButtonShown")===!0));a--);E.trigger(i.EVENTS.MDIGITAL_PAGE_TARGETING_PHASE_ENDED)}}function Is(t,e){return t.formType===i.FORM_TYPES.INVITATION&&!e.skipInviteTargeting&&o.getMemoryData("isInviteActivated")===!1&&!L.isUbtFailed(t)&&(s.kampyleIsCookieEnabled()||!o.getPropertySharedSubdomain())}function ps(t){t=t||"";var e=o.getFormData(t)||{},r=e.formType===i.FORM_TYPES.INVITATION;if(r&&o.setMemoryData("currentInviteFormId",t),L.isNumSessions(e)===!1)return!1;if(s.getNestedPropertyValue(e,"onSiteData.kampyleInvitePercentageUsers.prec")){var n=Jr(e.onSiteData.kampyleInvitePercentageUsers);if(E.trigger(i.EVENTS.MDIGITAL_TARGETING_RULE_EVALUATED,{formId:e.formId,targetingRule:"UsersPercentage",formTriggerType:o.getFormTriggerType(e.formId),targetingPhase:i.TARGETING_PHASES.PAGE_TARGETING,isPassed:n,expected:s.getNestedPropertyValue(e,"onSiteData.kampyleInvitePercentageUsers.prec"),actual:Ot()}),n===!1)return!1}var a=!!e.onSiteData.numberOfPagesViewed&&Kr(e.onSiteData.numberOfPagesViewed)===!1;return s.getNestedPropertyValue(e,"onSiteData.numberOfPagesViewed.numberOfRepeats")&&E.trigger(i.EVENTS.MDIGITAL_TARGETING_RULE_EVALUATED,{formId:e.formId,targetingRule:"NumberOfPagesViewed",targetingPhase:i.TARGETING_PHASES.PAGE_TARGETING,isPassed:!a,expected:s.getNestedPropertyValue(e,"onSiteData.numberOfPagesViewed.numberOfRepeats"),actual:o.getData("kampyleSessionPageCounter")}),a?!1:(r&&(s.isTrue(e.inviteData.skipInvitation)?c.isPreloadConfigured()&&E.trigger(i.EVENTS.NEB_LOAD_FORM,{formId:t}):E.trigger("neb_loadInvitation",{formId:t})),!0)}function Ss(t,e){o.setMemoryData("targetingState."+t,e)}function Ts(t){return t?"shouldShowInvite_"+t:null}function jr(t){var e=L.isAlreadyDeclined(t),r=L.isAlreadySubmitted(t);return e||r}var L={init:Wo,initTargeting:Zr,initFormsTargeting:yt,validateCommonTargetingOnForm:jo,isShowInvite:pe,handleButton:wr,isDataValid:ht,generateShouldShowInviteParamName:Ts,handleNotSkippedInvitaion:Zo,initDynamicTargeting:Es,validateCommonSessionTargeting:ps,isUbtFailed:Ur,evaluateRule:ts,shouldDisableIntercept:Jo,checkPagesInSession:Kr,isNumSessions:rs,targetingDevice:Wr,setUserPercentile:ms,getUserPercentile:Ot,checkPercentageUsers:Jr,validateGap:Nt,getEventQuery:zr,handleTriggerByEvents:qr,isUrlMatch:Br,onTimeInSessionEnds:ns,getDelayTimeByTabIndex:Xr,setTargetingState:Ss,getTextByQuarentine:Ko,shouldCheckInvite:Is,isQuarantinePhasePassed:Gr,isGenericRuleValid:xr,checkQuarantine:jr,initEmbeddedTargeting:gs,isAlreadyDeclined:qo,isAlreadySubmitted:zo};function As(t){var e=s.getNestedPropertyValue(t,"formId"),r=s.getNestedPropertyValue(t,"formLocalizationSettings.customParam"),n=o.getFormData(e)||{},a=w.getCustomParamById(r,n)||{};return w.fetchCPValue(a)||s.getNestedPropertyValue(t,"formLocalizationSettings.defaultLanguage")}function $r(t){var e=s.isTruthy(s.getNestedPropertyValue(t,"formLocalizationSettings.useCustomParam"));return e?B.getLangCodeFromCP(t):s.getLangCodeFromNavAPI()}function en(t,e){var r=s.getNestedPropertyValue(t,"availableLanguages"),n=t.formLocalizationSettings.defaultLanguage,a=e.split("-")[0].toLowerCase(),l=r.find(function(d){return d.toLowerCase()===a})||r.find(function(d){return d.indexOf(a)===0});return l||n}function vs(t){if(!t.availableLanguages)return null;var e=$r(t)||"";return c.checkProvision(i.PROVISIONS.UNDERSCORE_LOCALIZATION)&&(e=e.replace("_","-")),t.availableLanguages.find(function(r){return r.toLowerCase()===e.toLowerCase()})||en(t,e)}function Mt(t){return B.detectUsableLanguageCode({availableLanguages:t.availableLanguages,formLocalizationSettings:t.formLocalizationSettings,formId:t.formId})}function bs(t){var e=i.LANG_MEMORY_DATA_KEY_PREFIX+t.formId,r=o.getMemoryData(e);r||(r=Mt(t),o.setMemoryData(e,r));var n=s.getNestedPropertyValue(t,"buttonData.textLocalization")||{},a=n[r]||t.buttonData.text;return a&&(typeof a=="undefined"?"undefined":Q(a))==="object"&&(a=a.buttonText),a}function tn(t){if(!t)return null;var e=i.LANG_MEMORY_DATA_KEY_PREFIX+t.formId,r=Mt(t);return o.setMemoryData(e,r),r}function Ds(t){var e=Mt(t),r=s.getNestedPropertyValue(t,"buttonData.textLocalization")||{};return r[e]&&r[e].isRtl==="true"}function ys(t){var e=o.getFormData(t)||{};return e?o.getMemoryData(i.LANG_MEMORY_DATA_KEY_PREFIX+t)||tn(e):null}var B={getLangCodeFromCP:As,getLangCode:$r,getLangaugeFallback:en,detectUsableLanguageCode:vs,detectAndSetFormLanguage:tn,getLocalizedButtonText:bs,getFormLanguage:ys,isFormLanguageRtl:Ds};function hs(){var t=s.getOrCreateWrapperContainer(i.IFRAME_SETTINGS.LIGHTBOX.WRAPPER_ID),e=Object.assign(document.createElement("div"),{id:"kampyleFormContainer"}),r={top:0,left:0,width:"100%",height:"100%",position:"fixed",visibility:"hidden",display:"table",backgroundColor:"rgba(102,102,102,0.4)",zIndex:"99999999",webkitOverflowScrolling:"touch"};s.setElementStyle(e,r,!0);var n=document.createElement("div");n.id="kampyleFormContainer";var a=Pt(),l=document.createElement("div");l.id="kampyleFormModal",s.setElementStyle(l,{zIndex:"99999999",webkitOverflowScrolling:"touch"},!0),n.appendChild(a),n.appendChild(l),e.appendChild(n),t.appendChild(e),s.setSpinnerStyle(a,i.SPINNER_SETTINGS.SIZE.LARGE),c.checkProvision(i.PROVISIONS.ENABLE_WCAG_PREPEND_SURVEY)?document.body.prepend(t):document.body.appendChild(t)}function Ns(t){var e=s.getOrCreateWrapperContainer(i.IFRAME_SETTINGS.INVITATION.WRAPPER_ID),r=o.getMemoryData("kampyleDevice"),n=c.checkProvision(i.PROVISIONS.ENABLE_ZOOM_WCAG_REFLOW)&&r==="desktop",a=Object.assign(document.createElement("div"),{id:"kampyleInviteContainer"});s.setElementStyle(a,{top:"0",left:"0",width:n?"100vw":"100%",height:n?"100vh":"100%",position:"fixed",visibility:"hidden",display:"none",backgroundColor:"rgba(22,22,22,0.5)",zIndex:"99999999",overflow:n?"hidden":"auto"},!0);var l=Pt(),d=document.createElement("div");d.id="kampyleInviteModal",s.setElementStyle(d,{overflow:"hidden",margin:"0 auto",height:t.inviteData.inviteHeight,width:t.inviteData.inviteWidth,position:"relative",zIndex:"99999999",webkitBoxShadow:"0 0 10px rgba(0,0,0,0.4)",mozBoxShadow:"0 0 10px rgba(0,0,0,0.4)",boxShadow:"0 0 10px rgba(0,0,0,0.4)",top:n?"50%":"25%",transform:n?"translateY(-50%)":"none",maxHeight:n?"100vh":"unset",maxWidth:n?"100vw":"unset"}),a.appendChild(d),a.appendChild(l),e.appendChild(a),s.setSpinnerStyle(l,i.SPINNER_SETTINGS.SIZE.LARGE),c.checkProvision(i.PROVISIONS.ENABLE_PREPEND_SURVEY)?document.body.prepend(e):document.body.appendChild(e)}function Os(t,e,r,n,a){var l=document.createElement("div"),d=c.checkProvision(i.PROVISIONS.NEW_MODAL_DIALOGS)?{id:t}:{tabIndex:0,id:t,role:"alertdialog","aria-modal":!0,"aria-labelledby":"title-no-json-modal","aria-describedby":"description-no-json-modal",lang:l};s.addAttributesOnElement(l,d),s.setElementStyle(l,{position:"relative",textAlign:"center",backgroundColor:"rgba(255,255,255, 1)",margin:o.getMemoryData("context")==="preview"?"100px auto 2% auto":"5% auto 2% auto",border:"1px solid #cccccc",boxShadow:"8px 10px 58px 2px rgba(64, 64, 74, 0.56)",color:"#2C3548",fontFamily:"helvetica",height:"500px",width:o.isMobile()?"98%":"450px"});var u=Ls(a,e),m=ks(),f=Fs(r),_=ws(n);return l.appendChild(u),l.appendChild(m),l.appendChild(f),l.appendChild(_),l}function Ms(t){var e=v.getButtonText(t),r="kampyle_"+t.buttonData.position,n=document.createElement("button"),a=c.checkProvision(i.PROVISIONS.ENABLE_ZOOM_WCAG_REFLOW)&&s.getNestedPropertyValue(t,"urlVersion"),l=1;if(a){var d=s.getZoomedIn();o.setMemoryData("kampylePageZoom",d.zoom),l=d.isZoomedIn?nn():1}var u=125,m=35,f=14*l;c.checkProvision(i.PROVISIONS.ENABLE_DYNAMIC_FEEDBACK_BUTTON_SIZE)&&(u=v.getVerticalButtonWidth(e));var _=(-u+m)/2*l;u=u*l,m=m*l;var A=window.innerHeight,N=A*.55-u;s.addAttributesOnElement(n,{id:"nebula_div_btn",alt:e,tabIndex:"0",class:"kampyle_vertical_button "+r+" "+v.getWCAGClass()}),s.setElementStyle(n,{backgroundColor:"transparent",height:"auto",minHeight:m+"px",maxHeight:m+"px",width:u+"px",minWidth:u+"px",maxWidth:u+"px",padding:0},!1),s.setElementStyle(n,{fontFamily:"Open Sans, sans-serif",cursor:"pointer",position:"fixed",bottom:N+"px",border:"none",zIndex:"99999990",height:m+"px","-ms-transform":"rotate(90deg)","-webkit-transform":"rotate(90deg)",transform:"rotate(90deg)"}),o.isFeatureEnabled(i.FEATURE_FLAGS.WCAG)?s.addWcagStyleOnFocus(n):s.setElementStyle(n,{outline:"none"},!1),n.style[t.buttonData.position]=_+"px";var T=document.createElement("div");T.setAttribute("class","kampyle_button");var h=t.buttonData.position==="left"?"3px 3px 0 0":"0 0 3px 3px";s.setElementStyle(T,{width:u+"px",minWidth:u+"px",maxWidth:u+"px",minHeight:m+"px",maxHeight:m+"px","-webkit-border-radius":h,"-moz-border-radius":h,"-ms-border-radius":h,"border-radius":h},!1),s.setElementStyle(T,{height:m+"px",background:t.buttonData.backgroundColor,color:t.buttonData.textColor,position:"absolute",top:0,left:0,zIndex:"-1"});var g=document.createElement("div");if(s.addAttributesOnElement(g,{"data-aut":"feedback",class:"kampyle_button-text"}),s.setElementStyle(g,{fontWeight:"normal"},!1),s.setElementStyle(g,{color:t.buttonData.textColor,fontSize:f+"px",lineHeight:m+"px",textAlign:"center"}),B.isFormLanguageRtl(t)&&s.setElementStyle(g,{transform:"scale(-1)","-ms-transform":"scale(-1)","-webkit-transform":"scale(-1)"}),c.checkProvision(i.PROVISIONS.ADDITIONAL_BUTTON_STYLES)){var R="#FFFFFF",F="#396CEF";rn(n,{bgElementStyle:{backgroundColor:t.buttonData.backgroundColor},textElementStyle:{color:t.buttonData.textColor}},{bgElementStyle:{backgroundColor:t.buttonData.backgroundHoverColor||F},textElementStyle:{color:t.buttonData.textHoverColor||R}})}var X=document.createTextNode(e);return g.appendChild(X),n.appendChild(T),n.appendChild(g),n}function rn(t,e,r){t&&e&&r&&typeof t.addEventListener=="function"&&(t.addEventListener("mouseenter",function(){var n=t.children[0],a=t.children[1];s.setElementStyle(n,r.bgElementStyle),s.setElementStyle(a,r.textElementStyle)}),t.addEventListener("mouseleave",function(){var n=t.children[0],a=t.children[1];s.setElementStyle(n,e.bgElementStyle),s.setElementStyle(a,e.textElementStyle)}))}function Ps(t,e){return{topRight:{btnStyle:{top:0,right:0},div1Style:{top:0,right:0,borderTop:e+" solid "+t.buttonData.backgroundColor,borderLeft:e+" solid transparent"},div2Style:{"-ms-transform":"rotate(45deg)","-webkit-transform":"rotate(45deg)",transform:"rotate(45deg)"}},topLeft:{btnStyle:{top:0,left:0},div1Style:{top:0,left:0,borderTop:e+" solid "+t.buttonData.backgroundColor,borderRight:e+" solid transparent"},div2Style:{"-ms-transform":"rotate(-45deg)","-webkit-transform":"rotate(-45deg)",transform:"rotate(-45deg)"}},bottomRight:{btnStyle:{bottom:0,right:0},div1Style:{bottom:0,right:0,borderBottom:e+" solid "+t.buttonData.backgroundColor,borderLeft:e+" solid transparent"},div2Style:{"-ms-transform":"rotate(-45deg)","-webkit-transform":"rotate(-45deg)",transform:"rotate(-45deg)"}},bottomLeft:{btnStyle:{bottom:0,left:0},div1Style:{bottom:0,left:0,borderBottom:e+" solid "+t.buttonData.backgroundColor,borderRight:e+" solid transparent"},div2Style:{"-ms-transform":"rotate(45deg)","-webkit-transform":"rotate(45deg)",transform:"rotate(45deg)"}}}}function nn(){var t=s.getZoomedIn();return t.constraint/t.zoom}function Cs(t){var e=c.checkProvision(i.PROVISIONS.ENABLE_DYNAMIC_FEEDBACK_BUTTON_SIZE),r=81,n=14,a,l,d,u,m=v.getButtonText(t),f=t.buttonData.position||"topLeft",_=c.checkProvision(i.PROVISIONS.ENABLE_ZOOM_WCAG_REFLOW)&&s.getNestedPropertyValue(t,"urlVersion"),A=_&&s.getZoomedIn().isZoomedIn?nn():1,N={};if(e){var T=v.getTriangleTextSizeCalculation(t);l=T.height*A,u=T.width*A,N=v.getDynamicButtonStyles(f),r=T.height*2,d=T.padding*A,a=1.5}else a=f==="bottomLeft"||f==="bottomRight"?108*A+"px":53*A+"px";var h=r*A+"px",g=Ps(t,h),R=document.createElement("button"),F=v.getClassDirectonByPosition(f),X=g[f].btnStyle,W={textAlign:"center",color:t.buttonData.textColor,fontWeight:"normal",lineHeight:a};e?(W[N.paddingDirection]=d+"px",Object.assign(W,{width:u+"px",height:"auto",margin:"0 auto"})):Object.assign(W,g[f].div2Style,{height:h,width:h,zIndex:"1000"}),s.addAttributesOnElement(R,{id:"nebula_div_btn",alt:m,tabindex:0,class:"kampyle_feedback-button "+F.leftright+" "+v.getWCAGClass()}),s.setElementStyle(R,Object.assign({backgroundColor:"transparent",height:"auto",padding:0,fontFamily:"Open Sans, sans-serif",cursor:"pointer",position:"fixed",border:"none",zIndex:"99999990"},X)),o.isFeatureEnabled(i.FEATURE_FLAGS.WCAG)?(R.addEventListener("focusin",function(Se){s.setElementStyle(R,{outline:"1px dashed #595959",outlineOffset:"2px",transition:"none"},!1)}),R.addEventListener("focusout",function(Se){R.style.outline="none",R.style.outlineOffset=null,R.style.transition=null})):s.setElementStyle(R,{outline:"none"},!1);var M=document.createElement("div");if(s.addAttributesOnElement(M,{"data-aut":"feedback",class:"kampyle_button-text "+F.topbottom}),s.setElementStyle(M,Object.assign({fontSize:n*A+"px"},W)),e){s.setElementStyle(R,{clipPath:N.buttonPath,transform:N.transform,width:h,height:l+"px",backgroundColor:t.buttonData.backgroundColor,color:t.buttonData.textColor},!1);var C=Gs(N);R.appendChild(C.leftShape),R.appendChild(C.rightShape)}var le=document.createTextNode(m);if(M.appendChild(le),!e){var K=g[f].div1Style,de=document.createElement("div");de.setAttribute("class","kampyle_triangle"),s.setElementStyle(de,Object.assign({position:"absolute",width:0,height:0,zIndex:-1},K)),R.appendChild(de)}return R.appendChild(M),R}function Rs(t){var e={bottomLeft:{bottom:0,left:0},bottomRight:{bottom:0,right:0},topLeft:{top:0,left:0},topRight:{top:0,right:0},left:{left:0,top:"50%"},right:{right:0,top:"50%"}},r=document.createElement("button"),n=document.createElement("img"),a=v.getButtonText(t),l=e[t.buttonData.position];return s.addAttributesOnElement(r,{id:"nebula_div_btn",tabindex:0,class:"nebula_image_button "+v.getWCAGClass()}),s.setElementStyle(r,{zIndex:"99999990",position:"fixed",cursor:"pointer",border:"none",lineHeight:"1px",width:"auto",background:"transparent"},!1),s.setElementStyle(r,Object.assign({padding:0},l)),o.isFeatureEnabled(i.FEATURE_FLAGS.WCAG)?(r.addEventListener("focusin",function(d){s.setElementStyle(r,{outline:"1px dashed #595959",outlineOffset:"2px",transition:"none"},!1)}),r.addEventListener("focusout",function(d){r.style.outline="none",r.style.outlineOffset=null,r.style.transition=null})):s.setElementStyle(r,{outline:"none"},!1),s.addAttributesOnElement(n,{alt:a,src:t.buttonData.buttonUrl}),r.appendChild(n),r}function Ls(t,e){var r=document.createElement("i");return s.addAttributesOnElement(r,{"aria-hidden":!c.checkProvision(i.PROVISIONS.NEW_MODAL_DIALOGS),tabIndex:c.checkProvision(i.PROVISIONS.NEW_MODAL_DIALOGS)?0:-1,id:"close-no-json-modal","data-aut":"no-json-modal-close-button",role:"button",lang:e,"aria-label":t}),s.setElementStyle(r,{cursor:"pointer",position:"absolute",top:"3px",right:"12px",fontStyle:"normal",fontSize:"28px",opacity:.7}),o.isFeatureEnabled(i.FEATURE_FLAGS.WCAG)&&s.addWcagStyleOnFocus(r),s.isDesktop()&&s.addHoverEffectOnElement(r,{opacity:.7},{opacity:1}),r.innerHTML="\xD7",r}function Fs(t){var e=document.createElement("h2");return s.addAttributesOnElement(e,{id:"title-no-json-modal"}),s.setElementStyle(e,{fontWeight:"bold",margin:"40px 0 16px",fontSize:"24px"}),e.appendChild(document.createTextNode(t)),e}function ks(){var t=document.createElement("img");return s.addAttributesOnElement(t,{src:Z.getUrlPrefix()+i.SRC.OOPS}),s.setElementStyle(t,{marginLeft:"-1px"}),t}function ws(t){var e=document.createElement("div");s.addAttributesOnElement(e,{id:"description-no-json-modal"}),s.setElementStyle(e,{padding:"0 44px",color:"#2C3548",fontFamily:"helvetica",lineHeight:"23px",fontSize:"16px"});var r=document.createElement("p");return r.innerHTML=t,e.appendChild(r),e}function Pt(){var t=document.createElement("div");t.id=i.SPINNER_SETTINGS.CONTAINER_ID,s.addAttributesOnElement(t,{class:"neb-loading-spinner"});var e=document.createElement("div");return e.id=i.SPINNER_SETTINGS.ID,t.appendChild(e),t}function Gs(t){var e=document.createElement("div");e.className="kampyle_shape_left";var r=document.createElement("div");return r.className="kampyle_shape_right",s.setElementStyle(e,{clipPath:t.textPath.left,shapeOutside:t.textPath.left,height:"100%",width:"50%",float:"left"},!1),s.setElementStyle(r,{clipPath:t.textPath.right,shapeOutside:t.textPath.right,height:"100%",width:"50%",float:"right"},!1),{leftShape:e,rightShape:r}}var $={createFormContainer:hs,createInviteIframeContainer:Ns,getErrorModal:Os,getVerticalButton:Ms,getTriangularButton:Cs,getCustomButton:Rs,addHoverStyleToFeedbackButton:rn,createSpinnerElement:Pt};function Ke(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ue(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{},n=Object.keys(r);typeof Object.getOwnPropertySymbols=="function"&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(a){return Object.getOwnPropertyDescriptor(r,a).enumerable}))),n.forEach(function(a){Ke(t,a,r[a])})}return t}function Us(){var t=ue({neb_formLoadingHasFailed:[Bs],neb_formClosed:[xs]},c.checkProvision(i.PROVISIONS.TARGETING_EVENTS_REPORTING)&&{MDigital_targetingRuleEvaluated:[an]});E.subscribeMany(t)}function xs(t,e){var r=e.formId;r&&o.setFormState(e.formId,{shown:!1})}function Bs(t,e){var r={};r[e.failureCause]=!0,o.setFormState(e.formId,r)}function an(t,e){if(!sn(e))return!1;var r=o.getFormState(e.formId),n=[].concat(r.targeting[e.targetingPhase]||[]);n.push(on(e));var a={};a[e.targetingPhase]=n,o.setFormState(e.formId,{targeting:a})}function Vs(t){var e=o.getFormState(t);return!!e&&!!e.inviteLoaded}function Hs(t){var e=o.getFormState(t);return!!e&&!!e.loaded}function Ys(t){var e=c.checkProvision(i.PROVISIONS.FORM_TEMPLATE_DATA_SEPERATION),r=o.getFormState(t);return e?r.loaded&&c.isJsonDataLoaded(t,!1):r.loaded}function Ws(t){var e=o.getFormState(t);return e&&e.shouldBeShown}function Ks(t){var e=o.getFormState(t);return e&&e.shown}function on(t){var e={targetingRule:"",isPassed:!1,expected:"",actual:""};return Object.keys(e).forEach(function(r){e[r]=t[r]}),e}function sn(t){t=t||{};var e=o.getFormState(t.formId);return!(!e||!e.targeting||!t.targetingPhase)}var z={init:Us,updateTargetingState:an,getRuleData:on,canUpdateState:sn,shouldFormBeShown:Ws,isFormLoaded:Hs,isInviteLoaded:Vs,isFormShown:Ks,isFormFullyLoaded:Ys};var ln={sessionCam:"sessionCamRecorder",quantumMetrics:"QuantumMetricAPI"};function Rt(t){switch(t.source){case"var":return s.getNestedPropertyValue(window,t.param);case"cookie":return s.kampyleGetCookie(t.param);case"function":var e=s.getNestedPropertyValue(window,t.param);if(typeof e=="function")try{var r=t.predefinedArgs;return r?(r=r.split(","),j(r,Array)?e.apply(t.context,r):null):e.apply(t.context)}catch(n){return null}else return null;case"url":return s.getUrlParam(s.getNestedPropertyValue(window,t.param));case"storage":return localStorage.getItem(s.getNestedPropertyValue(window,t.param));default:}}function dn(t){for(var e=!0,r,n,a=t.isEnabled,l=ln[t.integrationName],d=s.getNestedPropertyValue(window,l),u=0;u<a.length;u++){var m=!1,f=a[u].param;n=a[u].paramValue,f||s.showWarning("no current name found"),r=Rt({source:a[u].source,param:f,context:d,predefinedArgs:a[u].predefinedArguments}),n===null?m=r!=null:m=n===r,e=e&&m}return e}function Ct(t){for(var e={},r={},n=t.parameters||[],a=ln[t.integrationName]||null,l=s.getNestedPropertyValue(window,a),d=0;d<n.length;d++){var u=Rt({source:n[d].source,param:n[d].param,context:l,predefinedArgs:n[d].predefinedArguments}),m=t.parameters[d].putIn;s.setNestedPropertyValue(e,m,u)}return r={integrationName:t.integrationName,parameters:e},r}function Xs(t){var e=o.getInegrations()||{},r={},n;for(var a in e)if(e.hasOwnProperty(a)){for(var l=e[a]||[],d=0;d<l.length;d++)if(n=l[d],dn(n))if(t){if(n.integrationName===t)return r[a]=[Ct(n)],r}else r[a]=r[a]||[],r[a].push(Ct(n))}return r}var he={isEnabled:dn,prepareIntegrationData:Ct,getIntegrationData:Xs,getParameterBySource:Rt};var zs=["updateProfileFromExtension","clearProfileFromExtension"];function qs(){s.setEventHandler(window,"message",mn)}function un(t){for(var e=i.IFRAME_SETTINGS,r=[e.EMBEDDED.IFRAME_ID_PREFIX,e.LIGHTBOX.IFRAME_ID_PREFIX,e.INVITATION.IFRAME_ID,e.ANIMATION.IFRAME_ID,e.PREVIEW.IFRAME_ID],n=0;n<r.length;n++)for(var a=document.querySelectorAll('iframe[id^="'+r[n]+'"]'),l=0;l<a.length;l++)if(t===a[l].contentWindow)return!0;var d=o.getMemoryData("popupHandler");return!!(d&&d===t)}function cn(t){if(s.isDebugMode())return!0;var e=c.checkProvision(i.PROVISIONS.ENABLE_ONSITE_POST_MESSAGE_VERIFICATION);if(!t||!t.origin||!t.data||e&&(!t.source||!un(t.source)))return!1;var r=JSON.parse(t.data),n=c.checkProvision(i.PROVISIONS.EXTENSION_ENABLED);if(n&&r&&zs.includes(r.action))return!0;var a=o.getFormData(r.formId);if(a&&a.formHtmlUrl&&s.getParsedUrl(a.formHtmlUrl).origin!==t.origin)return!1;var l=i.PLACEHOLDERS.URL_PREFIX;if(l.indexOf("://")>-1){var d=l.split("/");l=d[0]+"//"+d[2]}else{var u=l.indexOf("/");u>-1&&(l=l.slice(0,u))}return c.checkProvision(i.PROVISIONS.ON_PREM_HYBRID)||t.origin===l}function mn(t){var e;try{e=JSON.parse(t.data)}catch(T){return!1}if(!cn(t))return!1;var r=c.checkProvision(i.PROVISIONS.BACKEND_GENERATED_UUID)?e.feedbackCorrelationUUID:e.uuid;switch(e.action){case"inviteAccepted":E.trigger("neb_inviteAccepted",{formId:e.formId});break;case"inviteDeclined":case"inviteDefered":E.trigger("neb_inviteDeclined",{formId:e.formId});break;case"inviteHeightChanged":E.trigger("neb_inviteHeightChanged",{formId:e.formId,newHeight:e.newHeight});break;case"formLoaded":E.trigger("neb_formLoaded",{formId:e.formId,origin:t.origin,isScreenCaptureEnabled:e.isScreenCaptureEnabled});break;case"formSubmitPending":case"formHide":E.trigger("neb_formHide",{formId:e.formId});break;case"formSubmitted":var n={formId:e.formId,feedbackUUID:c.checkProvision(i.PROVISIONS.BACKEND_GENERATED_UUID)?e.feedbackUUID:e.uuid,feedbackCorrelationUUID:r};e&&e.formLanguage&&(n.formLanguage=e.formLanguage),c.isContentPayloadEnabled()&&e.content&&(n.content=e.content),E.trigger("neb_feedbackSubmitted",n);break;case"formPreSubmitted":var n={formId:e.formId,feedbackCorrelationUUID:r};e&&e.formLanguage&&(n.formLanguage=e.formLanguage),c.isContentPayloadEnabled()&&e.content&&(n.content=e.content),E.trigger("neb_feedbackPreSubmitted",n);break;case"formPostSubmitted":var n={formId:e.formId,feedbackUUID:c.checkProvision(i.PROVISIONS.BACKEND_GENERATED_UUID)?e.feedbackUUID:e.uuid,feedbackCorrelationUUID:r};e&&e.formLanguage&&(n.formLanguage=e.formLanguage),c.isContentPayloadEnabled()&&e.content&&(n.content=e.content),E.trigger("neb_feedbackPostSubmitted",n);break;case"formClose":var n={formId:e.formId,feedbackUUID:c.checkProvision(i.PROVISIONS.BACKEND_GENERATED_UUID)?e.feedbackUUID:e.uuid,sourceWindow:t.source,isFormSubmitted:e.isFormSubmitted,feedbackCorrelationUUID:r};E.trigger("neb_formClosed",n);break;case"formPageShown":var n={formId:e.formId,pageNumber:e.pageNumber,feedbackCorrelationUUID:r};E.trigger("neb_formPageShown",n);break;case"triggerScreenCapture":var n={formId:e.formId,screenCaptureSettings:e.screenCaptureSettings,feedbackCorrelationUUID:r,screenCaptureUuid:c.checkProvision(i.PROVISIONS.USER_SNAP_AS_COMPONENT)?e.screenCaptureUuid:null};E.trigger("neb_captureInit",n);break;case"screenCaptureDelete":E.trigger("screenCaptureDelete",e);break;case"screenCaptureRetake":E.trigger("screenCaptureRetake",e);break;case"scrollToForm":E.trigger("neb_scrollToForm",{formId:e.formId});break;case"iFrameHeightChanged":E.trigger("neb_iFrameHeightChanged",{formId:e.formId,newHeight:e.newHeight});break;case"scrollToTop":E.trigger("neb_scrollToTop",{formId:e.formId});break;case"scrollFromTop":E.trigger("neb_scrollFromTop",{formId:e.formId,numberOfPixels:e.numberOfPixels});break;case"inviteLoaded":E.trigger("neb_inviteLoaded",{formId:e.formId,inviteVersion:e.inviteVersion,inviteContent:e.inviteContent});break;case"loadMultipleForms":E.trigger("neb_loadMultipileForms",{formId:e.formId,formIds:e.formIds});break;case"routeToForm":E.trigger("neb_routeToForm",{formId:e.destinationForm,sourceFormId:e.formId},null,{isStrictMode:!0});break;case"submitFeedbackFailed":E.trigger("neb_submitFeedbackFailed",e);break;case"feedbackUUIDisNull":E.trigger("neb_feedbackUUIDisNull",e);break;case"MDigital_Form_Next_Page":case"MDigital_Form_Back_Page":case"MDigital_ThankYou_Displayed":case"MDigital_ThankYou_Close":case"MDigital_Form_Close_No_Submit":case"MDigital_Form_Close_Submitted":case"MDigital_CHTML_Logs":c.checkProvision(i.PROVISIONS.BACKEND_GENERATED_UUID)||(e.feedbackCorrelationUUID=e.uuid),E.trigger(e.action,e);break;case"MDigital_Invalid_Origin":var a="Message origin domain is not allowed, ",l=o.getFormData(e.formId),d=o.getDisplayType(l)===i.DISPLAY_TYPES.POPUP,u=o.getFormTriggerType(e.formId)===i.FORM_TYPES.INVITATION,m=s.getNestedPropertyValue(o.getFormData(e.formId),"inviteData.skipInvitation");!d&&u&&z.isFormShown(e.formId)&&(KAMPYLE_ONSITE_SDK.closeForm(e.formId),console.warn(a+"form has been closed!")),o.setFormState(e.formId,{shown:!1});var f=(o.getFormState(e.formId)||{}).inviteShown;if(f&&(KAMPYLE_VIEW.hideInvite(),console.warn(a+"invitation has been closed!")),d&&!f){var _=o.getMemoryData("popupHandler");e.sourceWindow=_,KAMPYLE_VIEW.hideForm("MDigital_Invalid_Origin",e),console.warn(a+"popup has been closed!")}o.setMemoryData(KAMPYLE_TARGETING.generateShouldShowInviteParamName(e.formId),!1),m&&o.setMemoryData("isInvitationShouldBeIgnored",!0),E.trigger("MDigital_Invalid_Origin",{formId:e.formId});break;case"updateProfileFromExtension":if(window.md_ex_profile=e&&e.payload?e.payload:null,window.md_ex_profile){var A=c.getCustomParamsMessage(e.formId);if(Lt(A),window.md_ex_profile.authorizationToken){o.setAuthorizationToken(window.md_ex_profile.authorizationToken);var N=KAMPYLE_MESSAGE.getAuthorizationMessage();Lt(N)}}window.md_ex_profile&&Q(window.md_ex_profile)==="object"&&Object.keys(window.md_ex_profile).length&&(o.initOnsiteDefaultState(),c.startCheckingTargeting());break;case"clearProfileFromExtension":window.md_ex_profile=null,o.setAuthorizationToken(null);break;default:return c.checkProvision(i.PROVISIONS.ON_PREM_HYBRID)||s.showWarning("invalid action - "+e.action),!1}}function Js(){var t={action:"setAuthorizationHeader",authorizationToken:o.getAuthorizationToken(),__isDigitalAction:!0};return JSON.stringify(t)}function Lt(t){var e=o.getMemoryData("formsState");for(var r in e)if(e[r]&&e[r].loaded){var n=o.getFormData(r);if(!n||!n.formDisplay||!n.formDisplay.displayType)continue;if(n.formDisplay.displayType==="popup"){var a=o.getMemoryData("popupHandler");a.postMessage(t,"*")}else s.sendMessageToIframe(o.getFormIframeId(r),t)}}var be={init:qs,updateMessageForAllLoadedForms:Lt,getAuthorizationMessage:Js,handleMessage:mn,validateMessageEvent:cn,isAllowedSource:un};function Ne(t){var e={errorMessage:i.LOG_MESSAGES.ERROR_ONSITE_SDK_CONFIGURATION_MISSING.replace("{{METHOD}}",t)};E.triggerError(e),V.warn(e.errorMessage)}function fn(t){if(y.isOnsiteConfigurationMissing())return Ne("loadForm"),!1;var e=o.getFormState(t);return e?(z.isFormFullyLoaded(t)||E.trigger("neb_loadForm",{formId:t}),!0):(s.showWarning("Error fetching data for form id "+t),!1)}function Zs(t,e){if(y.isOnsiteConfigurationMissing())return Ne("showForm"),!1;e=e||{};var r=o.getFormState(t);if(!r)return s.showWarning("Error fetching data for form id "+t),!1;if(o.getMemoryData("inviteLoadedAndShown"))return s.showWarning("There is already an invite displayed"),!1;if(c.isAnyOtherFormAlreadyShown(t,!0))return s.showWarning("There is already a form displayed"),!1;z.isFormFullyLoaded(t)||fn(t),e.triggerType=e.triggerType||"ByCode",o.saveFormExtraData(t,e);var n={formId:t};for(var a in e)e.hasOwnProperty(a)&&(n[a]=e[a]);return E.trigger("neb_sdkShowForm",{formId:t,triggerType:e.triggerType}),!0}function En(t){var e=o.getFormState(t);if(!(e&&e.shown))return!1;var r=e.isCurrentlySubmitted;return E.trigger("neb_formClosed",{formId:t,isFormSubmitted:r}),!0}function Qs(t){switch(t){case i.CLOSE_FORM_PARAM_VALUES.ALL:return function(){return!0};case i.CLOSE_FORM_PARAM_VALUES.EMBEDDED:return function(e){return e&&e.formType===i.CLOSE_FORM_PARAM_VALUES.EMBEDDED};case i.CLOSE_FORM_PARAM_VALUES.MODAL:return function(e){var r=o.getDisplayType(e);return r===i.DISPLAY_TYPES.ANIMATION||r===i.DISPLAY_TYPES.LIGHTBOX};default:return function(){return!1}}}function js(t){if(y.isOnsiteConfigurationMissing())return Ne("closeForm"),!1;if(!isNaN(t))return En(t);for(var e=o.getAllForms(),r=t&&Qs(t.toLowerCase()),n=e.length,a,l=!1,d=0;d<n;d++)a=e[d],r&&r(a)&&(l=En(+a.formId)||l);return l}function $s(){if(y.isOnsiteConfigurationMissing())return Ne("updatePageView"),!1;E.trigger("neb_sdkPageView")}function el(){return y.isOnsiteConfigurationMissing()?(Ne("isSurveyDisplayed"),!1):c.isAnyInviteShown()||c.isAnyOtherFormAlreadyShown()?!0:(E.trigger("neb_sdkSurveyDisplayed"),!1)}function tl(){if(y.isOnsiteConfigurationMissing())return Ne("startInviteTargeting"),!1;if(!o.isFeatureEnabled(i.PROPERTY_SETTINGS.MANUALLY_INVITE_TARGETING))return s.showWarning("Manually invite targeting feature is disabled"),!1;E.trigger(i.EVENTS.MDIGITAL_MANUALLY_INVITE_TARGETING,{skipButtonTargeting:!0,skipInviteTargeting:!1})}function rl(){V.setLoggerStatus(!0)}function nl(){o.deleteData("mdLogger")}function il(){V.printLogs()}function al(t){var e=he.getIntegrationData(t);if(!e){console.log("no integration data!");return}var r={action:"updateIntegrationData",integrations:e,__isDigitalAction:!0};return be.updateMessageForAllLoadedForms(r),e}var Xe={loadForm:fn,showForm:Zs,closeForm:js,updatePageView:$s,isSurveyDisplayed:el,startInviteTargeting:tl,collectIntegrationData:al,startLogger:rl,stopLogger:nl,printMdigitalLogs:il};function ol(){var t={DEBUG:"log",INFO:"info",WARN:"warn",ERROR:"warn"};this._logs=[],this.init=function(){this.getLoggerStatus()||Xe.stopLogger()},this.getLoggerStatus=function(){var e=o.getData("mdLogger");return e==="true"||e===!0},this.setLoggerStatus=function(e){o.setData("mdLogger",e)},this.debug=function(e){this.writeLog("DEBUG",e)},this.warn=function(e){this.writeLog("WARN",e)},this.error=function(e){this.writeLog("ERROR",e)},this.writeLog=function(e,r){var n=t[e]||t.DEBUG;r=this.setTimeAndLevelOnMessage(e,r),this._logs.push({type:n,message:r||""})},this.setTimeAndLevelOnMessage=function(e,r){return new Date+" ["+e+"] "+r},this.printLogs=function(){var e="";return this._logs.forEach(function(r){console[r.type](r.message),e+=" "+r.message}),e}}var V=new ol;function Ce(){var t=y.getOnsiteConfiguration();return t&&t.propertyMessages||{}}function Ft(){var t=Ce();return s.getNestedPropertyValue(t,"localizationSettings.defaultLanguage")}function gn(){var t=Ce(),e=s.getNestedPropertyValue(t,"localizationSettings.customParam");return w.getCustomParamValue({type:e.type,name:e.source_name,source:e.source})||Ft()}function _n(){var t=Ce(),e=s.getNestedPropertyValue(t,"localizationSettings.useCustomParam");return e?gn():s.getLangCodeFromNavAPI()}function sl(t,e){var r=Ce().messagesData||{},n=s.safeToLower(_n()),a=r[t]&&r[t][n];if(a&&a[e]!=null)return a[e];var l=s.safeToLower(Ft()),d=r[t]&&r[t][l];return d&&d[e]!=null?d[e]:i.TEXTS.DEFAULT_JSON_ERROR_MESSAGES[e]}var ce={getPropertyMessageLanguageCode:_n,getPropertyMessageTranslation:Ce,getDefaultLanguageFromPropertyData:Ft,getLanguageCodeByCustomParam:gn,getMessageByTypeAndKey:sl};var ze={CORNER_MARGIN:0,TRIANGULAR_MARGIN:0,VERTICAL_MARGIN:30},In={vertical:"getVerticalButton",triangular:"getTriangularButton",custom:"getCustomButton"};function Sn(t,e){if(e=e||{},!c.hasApplicationLoadingFailed(e.formId,!0)){var r=document.getElementById("kampyleInviteContainer");if(Le()){if(Fe(),r){var n=c.checkProvision(i.PROVISIONS.MOBILE_WEB_BANNER_FIX);s.setElementStyle(r,{top:"",bottom:"",left:"",right:"",background:"none",visibility:n?"hidden":"",display:n?"":"none"},!0)}}else{s.setElementStyle(r,{visibility:"visible"},!0);var a=document.getElementById("kampyleInvite");a&&s.setElementStyle(a,{visibility:"visible"},!0)}}}function Tn(t){s.showInvite(),s.removeEventHandler(t.srcElement,"blur",Tn)}function An(t){s.hideInvite(),s.setEventHandler(t.srcElement,"blur",Tn)}function vn(){var t=document.querySelectorAll("input"),e=document.querySelectorAll("textarea"),r=[],n;for(n=0;n<t.length;n++)r.push(t[n]);for(n=0;n<e.length;n++)r.push(e[n]);return r}function ll(t,e){e=e||{},e.formId=e.formId||o.getMemoryData("currentFormId");var r=v.getInvitePosition(e.formId);if(Le()&&r==="bottom")for(var n=vn(),a=0;a<n.length;a++)s.setEventHandler(n[a],"focus",An)}function kt(t,e){e=e||{},e.formId=e.formId||o.getMemoryData("currentFormId");var r=v.getInvitePosition(e.formId);if(Le()&&r==="bottom")for(var n=vn(),a=0;a<n.length;a++)s.removeEventHandler(n[a],"focus",An)}function dl(t,e){var r=L.generateShouldShowInviteParamName(e.formId),n=o.getMemoryData(r);n&&(E.trigger("neb_invitation_loaded",{formId:e.formId}),E.trigger("neb_showInvitation",{formId:e.formId}),o.deleteMemoryData(r))}function bn(t){document.getElementById(i.IFRAME_SETTINGS.EMBEDDED.IFRAME_ID_PREFIX+t).scrollIntoView()}function Dn(t){window.scrollTo(0,t)}function ul(t,e){e=e||{},o.isEmbeddedDisplayType(e.formId)||Dn(0)}function yn(t,e){var r=(e||{}).numberOfPixels||0;if(o.isEmbeddedDisplayType(e.formId)){bn(e.formId);var n=(s.getScrollPosition()||{}).y||0;v.doScrollY(r+n)}else v.doScrollY(r)}function hn(t,e){if(!c.checkProvision(i.PROVISIONS.NEW_MODAL_DIALOGS)){var r=s.getNestedPropertyValue(s.getBrowser(),"name");if(r===i.BROWSERS.SAFARI){var n;if(c.checkProvision(i.PROVISIONS.FORM_TEMPLATE_DATA_SEPERATION)){var a=o.getMemoryJsonKey(e.formId,!0),l=o.getMemoryData(a);n=l.desktopDesign.invitationContentText}else n=e.inviteContent;var d=s.htmlDecode(n)||"";d=d.replace(/<[^>]+>/g,"").trim();var u=document.getElementById("kampyleInvite");u.title=d}}}function cl(t,e){o.isPopupDisplayType(e.formId)&&xt()}function Nn(t,e){o.getData("isSkipInvitationOptimized")==="true"&&(s.setElementStyle(document.getElementById("kampyleFormContainer"),{visibility:"visible"},!0),v.prepareHostingDOM(),o.setData("isSkipInvitationOptimized",!1))}function ml(){var t={neb_targetingInit:[Zn],neb_loadInvitation:[jl],neb_loadForm:[zn,gl,ql],neb_formReady:[Oe],neb_formLoaded:[Yn,xt,dl],neb_formShown:[Nn],neb_inviteHeightChanged:[Kn],neb_iFrameHeightChanged:[Jl],neb_scrollToTop:[ul],neb_scrollFromTop:[yn],neb_inviteReady:[Sn,ll],neb_scrollToForm:[_l],neb_showButton:[Vt,Il,Rn,Mn],neb_buttonClicked:[yl],neb_sdkShowForm:[Oe],neb_captureInit:[Gt,Oe],neb_inviteAccepted:[qe,Oe,kt],neb_showForm:[Wn],neb_sdkPageView:[qe,kt],neb_inviteDeclined:[qe,kt],neb_formClosed:[Je],neb_popupBlocked:[Je],neb_formHide:[Gt],neb_captureImageClicked:[wt],MDigital_Capture_Cancelled:[wt],neb_formLoadingHasFailed:[Ut],neb_inviteLoaded:[hn,cl],MDigital_Invalid_Origin:[Ut]};c.checkProvision(i.PROVISIONS.ADDITIONAL_BUTTON_STYLES)&&t.neb_showButton.push(Ln),E.subscribeMany(t),c.checkProvision(i.PROVISIONS.CSP_RULES)||(s.addStyle(".noOutline{outline: none !important;}"),s.addStyle(".wcagOutline:focus{outline: 1px dashed #595959 !important;outline-offset: 2px !important;transition: none !important;}")),s.setEventHandler(window,"resize",function(e){Ht()}),o.setMemoryData("isOriginalHostingDom",!0)}function On(t){var e=t?"block":"none",r=document.getElementsByClassName("neb-loading-spinner");if(r&&r.length)for(var n=r.length-1;n>=0;n--)s.setElementStyle(r[n],{display:e})}function Mn(t,e){var r=o.getFormData(e.formId),n=c.checkProvision(i.PROVISIONS.ENABLE_ZOOM_WCAG_REFLOW)&&s.getNestedPropertyValue(r,"urlVersion");n&&s.setEventHandler(window,"resize",Pn(r))}function Pn(t){var e=!o.isMobile(),r=v.onResizeButton.bind(null,t),n=s.debounce(r,100,e);return v.debouncedOnResize=n,n}function El(t){var e=s.getZoomedIn(),r=e.zoom,n=r&&r===o.getMemoryData("kampylePageZoom");if(!n){o.setMemoryData("kampylePageZoom",r);var a={buttonVerticalOffset:s.getNestedPropertyValue(t,"buttonData.verticalOffset")||0,buttonType:s.getNestedPropertyValue(t,"buttonData.type")||"",buttonPosition:Ze(t)};if(a.buttonType==="custom"){var l=document.querySelector("#nebula_div_btn > img"),d=!0;Vn(l,a,d)}else xl(a,t),Rn("windowResize",a)}}function fl(){s.removeEventHandler(window,"resize",v.debouncedOnResize)}function xt(t,e){On(!1)}function gl(t,e){On(!0)}function _l(t,e){document.getElementById("kampyleFormContainer").scrollIntoView()}function Cn(t){t=t||{};var e=s.getNestedPropertyValue(t,"formType")==="invitation",r;if(e)r=ze.CORNER_MARGIN;else{var n=s.getNestedPropertyValue(t,"buttonData.type");switch(n){case"vertical":case"triangular":r=ze.TRIANGULAR_MARGIN;break;case"custom":r=s.getNestedPropertyValue(t,"buttonData.cornerMargin")||ze.CORNER_MARGIN;break;default:r=ze.CORNER_MARGIN;break}}return parseInt(r,10)}function Ze(t){return t=t||{},s.getNestedPropertyValue(t,"buttonData.position")||"right"}function Il(t,e){e=e||{};var r=o.getFormData(e.formId),n=document.getElementById("nebula_div_btn");if(!n||!r)return!1;var a=Cn(r)+"px";switch(Ze(r)){case"bottomRight":n.style.right=a;break;case"bottomLeft":n.style.left=a;break;default:break}}function Rn(t,e){var r=0,n=35,a="",l="",d=e&&e.formId&&o.getFormData(e.formId)||{};if(t==="windowResize")r=e.buttonVerticalOffset,a=e.buttonPosition,l=e.buttonType;else{var u=s.getNestedPropertyValue(d,"buttonData");r=s.getNestedPropertyValue(u,"verticalOffset")||0,a=u.position,l=s.getNestedPropertyValue(u,"type")}if(l!=="custom"){var m=t==="windowResize"||c.checkProvision(i.PROVISIONS.ENABLE_ZOOM_WCAG_REFLOW)&&s.getNestedPropertyValue(d,"urlVersion");if(!isNaN(r)){var f=document.getElementById("nebula_div_btn");if(f&&f.style){if(m){var _=s.getZoomedIn();r=Number(r)/_.zoom,_.isZoomedIn&&(n=n*(_.constraint/_.zoom))}a.indexOf("bottom")>-1?f.style.marginBottom=r+"px":a.indexOf("top")>-1?(r=Number(r)*-1,f.style.marginTop=r+"px"):(r=Number(r),f.style.bottom=window.innerHeight*.55-n+r+"px")}}}}function Ln(t,e){var r=o.getFormData(e.formId),n=s.getNestedPropertyValue(r,"buttonData.zIndex");if(s.isValueNumericAndDefined(n)){var a=document.getElementById("nebula_div_btn");a.style.zIndex=n}}function wt(t,e){var r=o.getMemoryData("currentFormId"),n=o.getFormData(r);if(o.getDisplayType(n)==="animation")return!1;var a=document.getElementById("kampyleFormContainer"),l=document.getElementById(i.IFRAME_SETTINGS.LIGHTBOX.IFRAME_ID_PREFIX+r);a&&l&&s.setElementStyle(a,{display:"block",visibility:"visible"},!0)}function Qe(){return o.isFeatureEnabled(i.FEATURE_FLAGS.WCAG)?" wcagOutline ":" noOutline "}function Gt(){var t=o.getMemoryData("currentFormId");if(t){var e=document.getElementById("kampyleFormContainer"),r=document.getElementById(i.IFRAME_SETTINGS.LIGHTBOX.IFRAME_ID_PREFIX+t),n=document.getElementById("mdigital-no-json-modal_"+t);e&&(r||n)&&s.setElementStyle(e,{display:"none",visibility:"hidden"},!0)}}function Je(t,e){e=e||{};var r=o.getMemoryData("currentFormId");Me("remove");var n=document.getElementById("kampyleFormContainer");if(n!==null){var a=document.getElementById(i.IFRAME_SETTINGS.LIGHTBOX.IFRAME_ID_PREFIX+r);a&&(o.initOnsiteDefaultState(r),a&&a.remove&&a.remove(),s.setElementStyle(n,{display:"none",visibility:"hidden"},!0)),Gt(),Fe()}o.isPopupDisplayType(r)&&e.sourceWindow&&e.sourceWindow.close&&e.sourceWindow.close()}function Fn(t){var e=t.buttonData||{},r=c.checkProvision(i.PROVISIONS.ENABLE_DYNAMIC_FEEDBACK_BUTTON_SIZE),n=81,a=14,l=53,d=108,u={},m,f,_,A=c.checkProvision(i.PROVISIONS.ENABLE_ZOOM_WCAG_REFLOW)&&s.getNestedPropertyValue(t,"urlVersion");if(r){var N=v.getTriangleTextSizeCalculation(t);m=N.height,_=N.width,u=Re(e.position),n=m*2,l=d="1.5",f=N.padding}if(A){var T=s.getZoomedIn();T.isZoomedIn&&(n=String(n*(T.constraint/T.zoom)),a=String(a*(T.constraint/T.zoom)),r?(m=String(m*(T.constraint/T.zoom)),f=String(f*(T.constraint/T.zoom)),_=String(_*(T.constraint/T.zoom))):(l=String(l*(T.constraint/T.zoom)),d=String(d*(T.constraint/T.zoom))))}n=n+"px",a=a+"px",r||(l=l+"px",d=d+"px");var h=[r?"":"button#nebula_div_btn { height: auto }",".kampyle_feedback-button{",r?"width:"+n+";height:"+m+"px;background-color:"+e.backgroundColor+";color:"+e.textColor+";transform:"+u.transform+";clip-path:"+u.buttonPath+";":"background-color:transparent;",'font-family:"Open Sans",sans-serif;cursor:pointer;position:fixed;z-index:99999990',"}",".kampyle_feedback-button .kampyle_triangle{position:absolute;width:0;height:0;z-index:-1}",".kampyle_feedback-button .kampyle_button-text{",r?"height: auto;width:"+_+"px;margin: 0 auto;"+u.paddingDirection+":"+f+"px;":"height:"+n+";width:"+n+";","text-align:center;z-index:1000;color:"+e.textColor+";font-size:"+a+";font-weight:normal;","}",".kampyle_feedback-button .kampyle_button-text.kampyle_bottom{","line-height:"+d+";","}",".kampyle_feedback-button .kampyle_button-text.kampyle_top {","line-height:"+l+";","}",".kampyle_feedback-button.kampyle_top-right{","top:0;right:0;","}",".kampyle_feedback-button.kampyle_top-left .kampyle_triangle, .kampyle_feedback-button.kampyle_top-right .kampyle_triangle {","top:0;border-top:"+n+" solid;","}",".kampyle_feedback-button.kampyle_bottom-left .kampyle_triangle, .kampyle_feedback-button.kampyle_bottom-right .kampyle_triangle {","border-bottom:"+n+" solid;","}",".kampyle_feedback-button.kampyle_bottom-right .kampyle_triangle, .kampyle_feedback-button.kampyle_top-right .kampyle_triangle {","right:0;border-left:"+n+" solid transparent;","}",".kampyle_feedback-button.kampyle_bottom-left .kampyle_triangle, .kampyle_feedback-button.kampyle_top-left .kampyle_triangle {","left:0;border-right:"+n+" solid transparent;","}","#nebula_div_btn .kampyle_triangle {","border-bottom-color: "+e.backgroundColor+";","border-top-color: "+e.backgroundColor+";","}",".kampyle_feedback-button.kampyle_top-right .kampyle_button-text, .kampyle_feedback-button.kampyle_bottom-left .kampyle_button-text {",r?"":"-ms-transform:rotate(45deg);-webkit-transform:rotate(45deg);transform:rotate(45deg);","}",".kampyle_feedback-button.kampyle_top-left .kampyle_button-text, .kampyle_feedback-button.kampyle_bottom-right .kampyle_button-text {",r?"":"-ms-transform:rotate(-45deg);-webkit-transform:rotate(-45deg);transform:rotate(-45deg);","}",".kampyle_feedback-button.kampyle_top-left {","top:0;left:0;","}",".kampyle_feedback-button.kampyle_bottom-right {","bottom:0;right:0;","}",".kampyle_feedback-button.kampyle_bottom-left {","bottom:0;left:0;","}",".kampyle_feedback-button.kampyle_bottom-left, .kampyle_feedback-button.kampyle_bottom-right, .kampyle_feedback-button.kampyle_top-left, .kampyle_feedback-button.kampyle_top-right {","padding: 0;","}",r?".kampyle_shape_left { height:100%;width:50%;clip-path:"+u.textPath.left+";float:left;shape-outside:"+u.textPath.left+"; }":"",r?".kampyle_shape_right { height:100%;width:50%;clip-path:"+u.textPath.right+";float:right;shape-outside:"+u.textPath.right+"; }":""].join(" ");return h}function Bt(t){var e=v.getVerticalButtonTextWidth(t),r=40;return e+r}function kn(t){var e=t.buttonData||{},r="";B.isFormLanguageRtl(t)&&(r="transform: scale(-1);-ms-transform: scale(-1);-webkit-transform: scale(-1)");var n=125,a=35,l=14;if(c.checkProvision(i.PROVISIONS.ENABLE_DYNAMIC_FEEDBACK_BUTTON_SIZE)){var d=v.getButtonText(t);n=Bt(d)}var u=(-n+a)/2;if(c.checkProvision(i.PROVISIONS.ENABLE_ZOOM_WCAG_REFLOW)&&s.getNestedPropertyValue(t,"urlVersion")){var m=s.getZoomedIn();m.isZoomedIn&&(n=n*(m.constraint/m.zoom),a=a*(m.constraint/m.zoom),l=l*(m.constraint/m.zoom),u=u*(m.constraint/m.zoom))}var f=window.innerHeight,_=f*.55-n,A=["button#nebula_div_btn { height: auto }",".kampyle_vertical_button {",'background-color:transparent;font-family:"Open Sans",sans-serif;cursor:pointer;position:fixed;bottom:'+_+"px;z-index:99999990;height:"+a+"px;min-height:"+a+"px;max-height:"+a+"px;width:"+n+"px;max-width:"+n+"px;min-width:"+n+"px;-ms-transform:rotate(90deg);-webkit-transform:rotate(90deg);transform:rotate(90deg)","}",".kampyle_vertical_button .kampyle_button {","height:"+a+"px;min-height:"+a+"px;;max-height:"+a+"px;width:"+n+"px;min-width:"+n+"px;max-width:"+n+"px; background:"+e.backgroundColor+";color:"+e.textColor+";position:absolute;top:0;left:0;z-index:-1;","}",".kampyle_vertical_button .kampyle_button-text {","color:"+e.textColor+";font-size:"+l+"px;line-height:"+a+"px;text-align:center;font-weight:normal;"+r,"}",".kampyle_vertical_button.kampyle_left .kampyle_button {","-webkit-border-radius:3px 3px 0 0;-moz-border-radius:3px 3px 0 0;-ms-border-radius:3px 3px 0 0;border-radius:3px 3px 0 0;","}",".kampyle_vertical_button.kampyle_right {","right:"+u+"px;","}",".kampyle_vertical_button.kampyle_left {","left:"+u+"px;","}",".kampyle_vertical_button.kampyle_right .kampyle_button {","-webkit-border-radius:0 0 3px 3px;-moz-border-radius:0 0 3px 3px;-ms-border-radius:0 0 3px 3px;border-radius:0 0 3px 3px","}",".kampyle_vertical_button.kampyle_right, .kampyle_vertical_button.kampyle_left  {","padding: 0;","}"].join(" ");return c.checkProvision(i.PROVISIONS.ADDITIONAL_BUTTON_STYLES)&&(A+=[".kampyle_vertical_button:hover .kampyle_button-text {","color:"+e.textHoverColor+";","}",".kampyle_vertical_button:hover .kampyle_button {","background-color:"+e.backgroundHoverColor+";","}"].join(" ")),A}function pl(t){var e=v.getButtonText(t),r=t.buttonData.position.includes("bottom");r&&(e=e.split("").reverse().join(""));var n=Re("topRight"),a=document.createElement("div");s.addAttributesOnElement(a,{id:"nebula_div_btn",class:"kampyle_feedback-button"}),s.setElementStyle(a,{visibility:"hidden",position:"fixed",border:"none",width:i.BUTTON.MAX_WIDTH+"px",height:i.BUTTON.MAX_WIDTH/2+"px"});var l=document.createElement("div");s.addAttributesOnElement(l,{class:"kampyle_button-text"}),s.setElementStyle(l,{fontFamily:'"Open Sans",sans-serif',width:"100%",textAlign:"center",fontSize:"14px",lineHeight:"1.5"});var d=document.createElement("span");d.textContent=e,l.appendChild(d);var u=document.createElement("div");s.setElementStyle(u,{height:"100%",width:"50%",float:"left",clipPath:n.textPath.left,shapeOutside:n.textPath.left});var m=document.createElement("div");s.setElementStyle(m,{height:"100%",width:"50%",float:"right",clipPath:n.textPath.right,shapeOutside:n.textPath.right}),a.appendChild(u),a.appendChild(m),a.appendChild(l),document.body.appendChild(a);var f={width:d.offsetWidth+1,height:l.offsetHeight+1};a.removeChild(u),a.removeChild(m),l.style.width=f.width+"px";var _=l.offsetHeight;return f.height=Math.max(f.height,i.BUTTON.MIN_HEIGHT),f.padding=f.height-_,document.body.removeChild(a),f}function Sl(t){var e=v.getButtonText(t),r=Gn(t.buttonData.position),n='<div class="kampyle_triangle"></div>',a="",l="background: none;";return c.checkProvision(i.PROVISIONS.ENABLE_DYNAMIC_FEEDBACK_BUTTON_SIZE)&&(a='<div class="kampyle_shape_left"></div><div class="kampyle_shape_right"></div>',l="",n=""),'<button id="nebula_div_btn" style="border: none; '+l+'" alt="'+e+'" tabindex="0" class="kampyle_feedback-button '+r.leftright+" "+Qe()+'">'+n+a+'<div data-aut="feedback" class="kampyle_button-text '+r.topbottom+'">'+e+"</div></button>"}function Tl(t){var e="kampyle_left",r=v.getButtonText(t);switch(t.buttonData.position){case"left":e="kampyle_left";break;case"right":e="kampyle_right";break}return'<button id="nebula_div_btn" style="position: fixed !important; border: none" alt="'+r+'" tabindex="0" class="kampyle_vertical_button '+e+" "+Qe()+'"><div class="kampyle_button"></div><div data-aut="feedback" class="kampyle_button-text">'+r+"</div></button>"}function Al(t){var e={vertical:{html:Tl,style:kn},triangular:{html:Sl,style:Fn}}[t.buttonData.type];return e?(s.addStyle(e.style(t)),e.html(t)):(s.showWarning("Invalid button type "+t.buttonData.type),"")}function vl(t){var e="z-index: 99999990;position: fixed;cursor: pointer;line-height:1px; padding:0;",r=v.getButtonText(t),n=[".nebula_image_button {","width: auto;","background: transparent;","}"].join(" ");switch(s.addStyle(n),t.buttonData.position){case"bottomLeft":e+="bottom:0;left:0;";break;case"bottomRight":e+="bottom:0;right:0;";break;case"topLeft":e+="top:0;left:0;";break;case"topRight":e+="top:0;right:0;";break;case"left":e+="left:0;top:50%;";break;case"right":e+="right:0;top:50%;";break;default:break}return'<button id="nebula_div_btn" class="nebula_image_button '+Qe()+'" style="'+e+';border: none" tabindex="0"><img alt="'+r+'" src="'+t.buttonData.buttonUrl+'" /></button>'}function pn(t){Me("add");var e=document.getElementById("kampyleFormContainer");if(e){var r=document.getElementById(i.IFRAME_SETTINGS.LIGHTBOX.IFRAME_ID_PREFIX+t);r&&s.setElementStyle(r,{display:"block"},!0),s.setElementStyle(e,{display:"block",visibility:"visible"},!0)}}function wn(t){var e="mdigital-no-json-modal_"+t;Je({formId:t});var r=document.getElementById(e);r&&(r.style.display="none"),o.setFormState(t,{shown:!1}),v.resetFormState(t),Vt("",{formId:o.getMemoryData("buttonFormId")}),s.triggerCustomEvent(i.EVENTS.MDIGITAL_NO_JSON_MODAL_CLOSED,{formId:t}),E.trigger(i.EVENTS.MDIGITAL_NO_JSON_MODAL_CLOSED,{formId:t})}function bl(t){var e=o.getFormTriggerType(t)===i.FORM_TYPES.INVITATION,r=o.getMemoryJsonKey(t,e),n=o.getMemoryJsonKey(t,e,i.MEMORY_DATA_FIELDS.FETCHING_DATA_IN_PROGRESS);o.setMemoryData(r,null),o.setMemoryData(n,null),o.setFormState(t,{loaded:null,loading:null}),o.setMemoryData(i.MEMORY_DATA_FIELDS.IS_BUTTON_CONTAINER_CREATED,!1),E.trigger(i.EVENTS.NEB_RESET_FORM_STATE,{formId:t})}function Dl(t){var e="en",r=i.TEXTS.DEFAULT_JSON_ERROR_MESSAGES.title,n=i.TEXTS.DEFAULT_JSON_ERROR_MESSAGES.body,a=i.TEXTS.DEFAULT_JSON_ERROR_MESSAGES.close;r=ce.getMessageByTypeAndKey(i.PROPERTY_MESSAGES.NO_JSON_MESSAGE.TYPE,i.PROPERTY_MESSAGES.NO_JSON_MESSAGE.KEYS.TITLE),n=ce.getMessageByTypeAndKey(i.PROPERTY_MESSAGES.NO_JSON_MESSAGE.TYPE,i.PROPERTY_MESSAGES.NO_JSON_MESSAGE.KEYS.BODY),a=ce.getMessageByTypeAndKey(i.PROPERTY_MESSAGES.NO_JSON_MESSAGE.TYPE,i.PROPERTY_MESSAGES.NO_JSON_MESSAGE.KEYS.CLOSE),e=ce.getPropertyMessageLanguageCode();var l="mdigital-no-json-modal_"+t;return $.getErrorModal(l,e,r,n,a)}function yl(t,e){var r=o.getFormData(e.formId),n=o.getDisplayType(r);if(n=n.toLowerCase(),n==="lightbox"){var a=document.getElementById("kampyleFormContainer");if(!a||c.hasApplicationLoadingFailed(e.formId,!1)||c.isAnyOtherFormAlreadyShown(e.formId,!0))return!1;s.setElementStyle(a,{display:"block",visibility:"visible"},!0)}}function Gn(t){var e={topbottom:"kampyle_bottom",leftright:"kampyle_bottom-left"};switch(t){case"bottomLeft":e.leftright="kampyle_bottom-left",e.topbottom="kampyle_bottom";break;case"bottomRight":e.leftright="kampyle_bottom-right",e.topbottom="kampyle_bottom";break;case"topLeft":e.leftright="kampyle_top-left",e.topbottom="kampyle_top";break;case"topRight":e.leftright="kampyle_top-right",e.topbottom="kampyle_top";break;default:break}return e}function hl(t,e){var r={};switch(t){case"bottomLeft":r={"border-bottom-width":e,"border-right-width":e};break;case"bottomRight":r={"border-bottom-width":e,"border-left-width":e};break;case"topLeft":r={"border-top-width":e,"border-right-width":e};break;case"topRight":r={"border-top-width":e,"border-left-width":e};break;default:break}return r}function Nl(t){var e=o.getFormTriggerType(t);return z.shouldFormBeShown(t)&&(e===i.FORM_TYPES.BUTTON||e===i.FORM_TYPES.CODE)}function Un(t,e){t.keyCode===i.KEY_CODES.SPACE||t.keyCode===i.KEY_CODES.ENTER?v.onErrModalClose(e):t.keyCode===i.KEY_CODES.TAB&&(t.preventDefault(),t.stopPropagation())}function xn(t,e){if(t.preventDefault(),t.keyCode===i.KEY_CODES.ESC){v.onErrModalClose(e);return}var r=document.querySelector("#mdigital-no-json-modal_"+e+" #close-no-json-modal");r&&t.keyCode===i.KEY_CODES.TAB&&!t.shiftKey&&(r.setAttribute("aria-hidden",!1),r.focus())}function Ut(t,e){if(!(c.isAnyOtherFormAlreadyShown(e.formId)||!v.shouldShowErrMsgOnForm(e.formId))){var r="mdigital-no-json-modal_"+e.formId,n=document.getElementById("kampyleFormModal");if(xt(),pn(e.formId),document.getElementById(r))document.getElementById(r).style.display="block";else{n||(Yt(),n=document.getElementById("kampyleFormModal"),pn(e.formId));var a=Dl(e.formId);n.innerHTML="",n&&n.appendChild&&n.appendChild(a);var l=document.querySelector("#"+r+" #close-no-json-modal");l.onclick=wn.bind(null,e.formId),(o.isFeatureEnabled(i.FEATURE_FLAGS.WCAG)||c.checkProvision(i.PROVISIONS.NEW_MODAL_DIALOGS))&&(a.addEventListener("keydown",function(m){xn(m,e.formId)}),l.addEventListener("keydown",function(m){Un(m,e.formId)}))}o.setFormState(e.formId,{loaded:null,shown:!0,shouldBeShown:!1}),Oe("",{formId:o.getMemoryData("buttonFormId")}),s.triggerCustomEvent(i.EVENTS.MDIGITAL_NO_JSON_MODAL_SHOWN,{formId:e.formId});var d=Z.getFormFailureCause(e.formId),u={failureCause:d};d===i.FORM_LOADING_FAILURE_CAUSE.JSON_FAILED&&(u.jsonPath=o.getDataJsonUrl(e.formId,!1)),E.trigger(i.EVENTS.MDIGITAL_NO_JSON_MODAL_SHOWN,{additionalInfo:u,formId:e.formId})}}function Ol(r,e){var r=r.toLowerCase();return typeof $[In[r]]=="function"?$[In[r]](e):(V.error("Invalid button type - "+r),null)}function Ml(){var t=document.getElementById(i.VIEW.FEEDBACK_BUTTON_ID);t!=null&&(s.setElementStyle(t,Bn(!1),!1),s.removeAttribute(t,"tabindex"),s.removeAttribute(t,"aria-hidden"))}function Pl(){var t=document.getElementById(i.VIEW.FEEDBACK_BUTTON_ID);t!=null&&(s.setElementStyle(t,Bn(!0),!1),s.addAttributesOnElement(t,{tabindex:-1,"aria-hidden":!0}))}function Vt(t,e){c.checkProvision(i.PROVISIONS.NEW_MODAL_DIALOGS)&&document.getElementById(i.VIEW.FEEDBACK_BUTTON_CONTAINER_ID)!=null&&document.getElementById(i.VIEW.FEEDBACK_BUTTON_ID)!=null?(v.showFeedbackButtonVisually(),Cl(t,e)):v.createButton(t,e)}function Cl(t,e){e=e||{};var r=o.getFormData(e.formId)||{};E.trigger("neb_button_displayed",{formId:e.formId,position:s.getNestedPropertyValue(r,"buttonData.position")||"",formClosed:s.getNestedPropertyValue(e,"formClosed")||!1})}function Bn(t){var e=o.getMemoryData(i.MEMORY_DATA_FIELDS.FEEDBACK_BUTTON_POSITION_STYLE)||{},r="",n=t?"9999px":0;switch(e){case"left":r="rotate(90deg) translateY("+n+")";break;case"right":r="rotate(90deg) translateY(-"+n+")";break;case"bottomRight":case"topRight":if(c.checkProvision(i.PROVISIONS.ENABLE_DYNAMIC_FEEDBACK_BUTTON_SIZE)){r=n?"translateX("+n+")":Re(e).transform;break}r="translateX("+n+")";break;case"customRight":r="translateX("+n+")";break;case"bottomLeft":case"topLeft":if(c.checkProvision(i.PROVISIONS.ENABLE_DYNAMIC_FEEDBACK_BUTTON_SIZE)){r=n?"translateX(-"+n+")":Re(e).transform;break}r="translateX(-"+n+")";break;case"customLeft":r="translateX(-"+n+")";break}return{transform:r}}function Rl(t,e){var r=t&&t.style;return r!=null&&e!=null&&e.length?e.reduce(function(n,a){var l=r[a];return l!=null&&(n[a]=l),n},{}):{}}function Vn(t,e,r){if(Number(t.naturalWidth)>0&&Number(t.naturalHeight)>0){var n=document.getElementById("nebula_div_btn"),a={el:t,width:t.naturalWidth,height:t.naturalHeight};Ul(n,a,e,r),s.removeEventHandler(t,"load",this.boundHandleLoadCustomBtnEvent)}}function Ll(t,e){var r="";e=e||{};var n=o.getFormData(e.formId)||{},a=s.getNestedPropertyValue(n,"buttonData.type")||"",l={buttonVerticalOffset:s.getNestedPropertyValue(n,"buttonData.verticalOffset")||"",buttonType:a,buttonPosition:Ze(n)};if(c.checkProvision(i.PROVISIONS.CSP_RULES)){var d=Ol(a,n);if(d){var u=document.getElementById("kampyleButtonContainer");u===null?(u=document.createElement("span"),u.id="kampyleButtonContainer",u.appendChild(d),document.body.appendChild(u)):(u.innerHTML="",u.appendChild(d))}}else{switch(a.toLowerCase()){case"vertical":case"triangular":r=Al(n);break;case"custom":r=vl(n);break;default:return s.showWarning("Invalid button type - "+a),!1}var u=document.getElementById("kampyleButtonContainer");u===null?(u=document.createElement("span"),u.innerHTML=r,u.id="kampyleButtonContainer",document.body.appendChild(u)):u.innerHTML=r}if(a.toLowerCase()==="custom"){var m=c.checkProvision(i.PROVISIONS.ENABLE_ZOOM_WCAG_REFLOW)&&s.getNestedPropertyValue(n,"urlVersion"),f=document.querySelector("#nebula_div_btn > img");this.boundHandleLoadCustomBtnEvent=Vn.bind(this,f,l,m),s.setEventHandler(f,"load",this.boundHandleLoadCustomBtnEvent)}if(c.checkProvision(i.PROVISIONS.NEW_MODAL_DIALOGS)){var _=l.buttonPosition;a.toLowerCase()==="custom"&&(_=l.buttonPosition.toLowerCase().indexOf("right")>-1?"customRight":"customLeft"),o.setMemoryData(i.MEMORY_DATA_FIELDS.FEEDBACK_BUTTON_POSITION_STYLE,_)}E.trigger("neb_button_displayed",{formId:e.formId,position:s.getNestedPropertyValue(n,"buttonData.position")||"",formClosed:s.getNestedPropertyValue(e,"formClosed")||!1}),u.onclick=function(T){c.isAnyOtherFormAlreadyShown(e.formId,!0)||(E.trigger("neb_buttonClicked",{formId:e.formId}),T.preventDefault(),T.stopPropagation())};var A=o.getMemoryData("kampyleDevice")===i.DEVICES.DESKTOP;if(A){this.boundHandleLoadFormEvent=Hn.bind(this,e,u),s.setEventHandler(u,"mouseover",this.boundHandleLoadFormEvent);var N=function(h){var g=o.getFormState(e.formId),R=c.checkProvision(i.PROVISIONS.ENABLE_INVITATION_SPINNER_FIX)&&o.getMemoryData("inviteLoadedAndShown");if(!g||g.loading||g.loaded||R||o.getMemoryData(i.MEMORY_DATA_FIELDS.IS_BUTTON_CONTAINER_CREATED))return!1;var F=s.isNear("nebula_div_btn",100,h);F&&(E.trigger("neb_load_form_preload_proximity",{formId:e.formId}),E.trigger("neb_loadForm",{formId:e.formId}),o.setMemoryData(i.MEMORY_DATA_FIELDS.IS_BUTTON_CONTAINER_CREATED,!0))};s.setEventHandler(window,"mousemove",N)}u.onkeyup=function(T){switch(T.keyCode){case i.KEY_CODES.TAB:z.isFormLoaded(e.formId)||E.trigger("neb_loadForm",{formId:e.formId});break;default:break}},u.onkeypress=function(T){switch(T.keyCode){case i.KEY_CODES.ENTER:c.isAnyOtherFormAlreadyShown(e.formId,!0)||E.trigger("neb_buttonClicked",{formId:e.formId});break;default:break}}}function Hn(t,e){var r=o.getFormState(t.formId);r.loaded||o.getMemoryData(i.MEMORY_DATA_FIELDS.IS_BUTTON_CONTAINER_CREATED)||(E.trigger("neb_loadForm",{formId:t.formId}),o.setMemoryData(i.MEMORY_DATA_FIELDS.IS_BUTTON_CONTAINER_CREATED,!0)),s.removeEventHandler(e,"mouseover",this.boundHandleLoadFormEvent)}function Yn(t,e){if(e.origin!=null){var r=document.getElementById(i.IFRAME_SETTINGS.LIGHTBOX.IFRAME_ID_PREFIX+e.formId);r&&r.setAttribute&&r.setAttribute("origin",e.origin)}}function Fl(t,e,r){var n=document.querySelector(".kampyle_vertical_button.kampyle_right"),a=document.querySelector(".kampyle_vertical_button.kampyle_left"),l=document.querySelector(".kampyle_button"),d=t.constraint,u=35,m=125,f=14;c.checkProvision(i.PROVISIONS.ENABLE_DYNAMIC_FEEDBACK_BUTTON_SIZE)&&(m=Bt(r.textContent));var _=(-m+u)/2;m=t.isZoomedIn?String(m*(d/t.zoom))+"px":m+"px",u=t.isZoomedIn?String(u*(d/t.zoom))+"px":u+"px",_=t.isZoomedIn?String(_*(d/t.zoom))+"px":_+"px",f=t.isZoomedIn?String(f*(d/t.zoom))+"px":f+"px",s.setElementStyle(e,{width:m,minWidth:m,maxWidth:m,height:u,minHeight:u,maxHeight:u},!1),s.setElementStyle(n,{right:_},!1),s.setElementStyle(a,{left:_},!1),s.setElementStyle(l,{width:m,minWidth:m,maxWidth:m,height:u,minHeight:u,maxHeight:u},!1),s.setElementStyle(r,{lineHeight:u,fontSize:f},!1)}function kl(t,e,r,n){var a=c.checkProvision(i.PROVISIONS.ENABLE_DYNAMIC_FEEDBACK_BUTTON_SIZE),l=81,d,u,m=14,f=t.constraint,_={},A={},N,T,h=Ze(n);if(a){var g=v.getTriangleTextSizeCalculation(n);if(_=v.getDynamicButtonStyles(h),u=g.height,l=g.height*2,T=g.padding,d=g.width,N=1.5,t.isZoomedIn){var R=f/t.zoom;d=d*R,u=u*R,T=T*R}}else{var F=53,X=108;N=h.indexOf("top")===0?F:X,N=t.isZoomedIn?String(N*(f/t.zoom))+"px":N+"px"}var W=t.isZoomedIn?String(l*(f/t.zoom))+"px":l+"px";if(m=t.isZoomedIn?String(m*(f/t.zoom))+"px":m+"px",a)s.setElementStyle(e,{height:u+"px",width:W,fontSize:m,lineHeight:N},!1),A={height:"auto",margin:"0 auto",width:d+"px",fontSize:m,lineHeight:N},A[_.paddingDirection]=T+"px",s.setElementStyle(r,A,!1);else{s.setElementStyle(e,{lineHeight:N},!1),s.setElementStyle(r,{height:W,width:W,fontSize:m,lineHeight:N},!1);var M=document.querySelector(".kampyle_triangle"),C=hl(h,W);s.setElementStyle(M,C,!0)}}function wl(t){var e=document.createElement("div");e.style.position="absolute",e.style.visibility="hidden",e.style.width="auto",e.style.font='14px "Open Sans", sans-serif',e.style.lineHeight="1.5",e.innerText=t,document.body.appendChild(e);var r=e.offsetWidth;return document.body.removeChild(e),r}function Re(t){var e,r,n,a,l;switch(t){case"topLeft":l="polygon(0 100%, 50% 0%, 100% 100%)",e="polygon(0% 0%, 100% 100%, 100% 0%)",r="polygon(0% 100%, 0% 0%, 100% 0%)",n="rotate(-45deg) translate(-18%, -58%)",a="padding-top";break;case"topRight":l="polygon(0 100%, 50% 0%, 100% 100%)",e="polygon(0% 0%, 100% 100%, 100% 0%)",r="polygon(0% 100%, 0% 0%, 100% 0%)",n="rotate(45deg) translate(18%, -58%)",a="padding-top";break;case"bottomLeft":l="polygon(0 0%, 50% 100%, 100% 0%)",e="polygon(0% 100%, 100% 0%, 100% 100%)",r="polygon(0% 100%, 0% 0%, 100% 100%)",n="rotate(45deg) translate(-18%, 58%)",a="padding-bottom";break;case"bottomRight":l="polygon(0 0%, 50% 100%, 100% 0%)",e="polygon(0% 100%, 100% 0%, 100% 100%)",r="polygon(0% 100%, 0% 0%, 100% 100%)",n="rotate(-45deg) translate(18%, 58%)",a="padding-bottom";break;default:l="unset",e="unset",r="unset",n="unset",a="padding-bottom";break}return{textPath:{right:e,left:r},buttonPath:l,transform:n,paddingDirection:a}}function Gl(t,e,r){var n={};return t.indexOf("bottom")>-1?n={bottom:0,marginBottom:r+"px",top:"unset"}:t.indexOf("top")>-1?n={top:0,marginTop:r*-1+"px",bottom:"unset"}:n={bottom:window.innerHeight*.5-e+"px",marginBottom:r+"px",top:"unset"},n}function Ul(t,e,r,n){var a=n?1/s.getZoomedIn().zoom:1,l=e?e.el:document.querySelector("#nebula_div_btn>img"),d=e?e.width:l.naturalWidth,u=e?e.height:l.naturalHeight,m=String(d*a),f=String(u*a),_=r.buttonVerticalOffset;_=isNaN(_)?0:Number(_)*a;var A=Gl(r.buttonPosition,f,_);s.setElementStyle(t,{width:m+"px",height:f+"px"},!1),s.setElementStyle(t,A,!0),s.setElementStyle(l,{width:"inherit",height:"inherit"},!1)}function xl(t,e){var r=document.getElementById("nebula_div_btn");if(r!==null){var n=document.querySelector(".kampyle_button-text"),a=s.getZoomedIn();t.buttonType==="vertical"?Fl(a,r,n,t.buttonPosition):t.buttonType==="triangular"&&kl(a,r,n,e)}}function Ht(t){var e=o.getMemoryData("currentFormId")||o.getShownFormId();if(!(document.getElementById("kampyleFormContainer")===null||!e)){if(t=t||o.getFormData(e)||{},o.isMobileDynamicSizing(t.formId))return Vl(t);Bl(t)}}function Bl(t){var e=(t||{}).formId||o.getMemoryData("currentFormId")||o.getShownFormId(),r,n;t&&(r=parseInt(t.formWidth,10)||450,n=parseInt(t.formHeight,10)||450);var a=document.documentElement.clientHeight,l={overflowY:"auto",height:"100%"};s.setElementStyle(document.getElementById("innerContainer"),l);var d={border:0,position:"relative",margin:"50px auto 50px",height:n+"px",width:r+"px"},u=o.getMemoryData("kampyleDevice");u===i.DEVICES.MOBILE||u===i.DEVICES.TABLET?(n="100%",r="100%",d={position:"relative",margin:"0",height:n,width:r}):o.isCustomHtmlAndFixedSizeForm(e)?(d={position:"absolute",top:"50%","margin-top":-n/2+"px",left:"50%","margin-left":-r/2+"px",height:n+"px",width:r+"px"},a<n&&(d.position="relative",d.top="0",d["margin-top"]="50px",d["margin-bottom"]="50px")):d={position:"fixed",height:"100%",width:"100%"};var m=document.getElementById("kampyleFormModal");m&&m.style&&m.removeAttribute&&(m.removeAttribute("style"),s.setElementStyle(m,d,!0))}function Vl(t){var e=document.getElementById(i.IFRAME_SETTINGS.LIGHTBOX.WRAPPER_ID);e&&e.setAttribute("aria-hidden",!1);var r=document.getElementById("kampyleFormModal");r&&s.setElementStyle(r,{top:0,margin:0,width:"100%"},!0)}function Hl(t,e,r,n,a){t=Z.createFormUrl(t,e);var l="NebulaCX"+e,d="width="+r+", height="+n+",scrollbars=yes",u=window.open(t,l,d),m=!u||u.closed||typeof u.closed=="undefined";o.setMemoryData("popupHandler",u),setTimeout(function(){m&&(a!=="neb_skipInvitation"&&alert("The survey was blocked, please disable popup blocker and refresh the page."),E.trigger("neb_popupBlocked",{formId:e}))},25)}function Yl(t,e,r,n,a){c.shouldRenderForm({formId:e})&&Hl(t,e,r,n,a)}function Wn(t,e){var r=t==="neb_skipInvitation";e=e||{};var n=o.getFormData(e.formId);if(v.ignoreShowForm(n)||c.hasApplicationLoadingFailed(e.formId,!1)||c.isAnyOtherFormAlreadyShown(e.formId,!0))return!1;var a=n.formHtmlUrl,l=n.formWidth,d=n.formHeight,u=o.getDisplayType(n);u=u.toLowerCase(),Me("add"),o.setMemoryData("currentFormId",e.formId),o.isEmbeddedDisplayType(e.formId)||(o.setMemoryData("formIsShown",!0),o.setMemoryData("isInvitationShouldBeIgnored",!0));var m=o.getMemoryData("kampyleDevice"),f=r&&c.checkProvision(i.PROVISIONS.SKIP_INVITATION_OPTIMIZATION);if(u==="lightbox"){f?o.setData("isSkipInvitationOptimized",!0):v.prepareHostingDOM();var _=document.getElementById("kampyleFormContainer");if(_){Ht(n);var A=document.getElementById(i.IFRAME_SETTINGS.LIGHTBOX.IFRAME_ID_PREFIX+e.formId);A&&s.setElementStyle(A,{display:"block"},!0),s.setElementStyle(_,{display:"block",visibility:f?"hidden":"visible"},!0)}else s.showWarning("formContainer wasn't loaded properly")}else u==="popup"&&Yl(a,e.formId,l,d,t);return!0}function Wl(t){return!t||o.getDisplayType(t)==="animation"}function qe(){o.setMemoryData("inviteLoadedAndShown",!1),Me("remove");var t=document.getElementById("kampyleInviteContainer"),e=document.getElementById("kampyleInvite");t&&e&&(s.setElementStyle(t,{display:"none"},!0),Fe())}function Kn(t,e){e=e||{};var r=["top","bottom"],n=(o.getFormState(e.formId)||{}).inviteShown;if(!Le()||!n)return!1;var a=v.getInvitePosition(e.formId),l=document.getElementById("kampyleInviteContainer"),d=document.getElementById("kampyleInvite");document.activeElement.tagName==="INPUT"||document.activeElement.tagName==="TEXTAREA"?(s.hideInvite(),s.setEventHandler(document.activeElement,"blur",function(m){return function f(){s.removeEventHandler(m,"blur",f),s.showInvite()}}(document.activeElement))):s.showInvite();var u={display:"block",height:e.newHeight+"px",left:"0",right:"0"};u[a]=0,u[r[(r.indexOf(a)+1)%2]]="",s.setElementStyle(l,u,!0)}function Me(t){if(t=t||"",o.getMemoryData("kampyleDevice")!=="desktop"){var e=c.checkProvision(i.PROVISIONS.FORM_TEMPLATES_WCAG)?"width=device-width, initial-scale=1.0":"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no",r=document.getElementById("kampyleMetaViewport"),n=c.checkProvision(i.PROVISIONS.ENABLE_VIEWPORT_LOGIC_FIX),a=o.getMemoryData("hostedViewportContent")||[];if(!a.length){var l=document.getElementsByName("viewport"),d=l&&l.length>0;if(d)for(var u=l.length-1;u>=0;u--){var m=l[u].getAttribute("content");m&&(n?a.push({el:l[u],content:m}):a.push(l[u]))}}var f=n&&!!a.length&&!r;switch(t.toLowerCase()){case"add":if(a&&a.length){for(var u=a.length-1;u>=0;u--)if(f)a[u].el&&a[u].el.setAttribute("content",e);else if(!a[u].el){if(a[u].hasAttribute("id")&&a[u].id==="kampyleMetaViewport")continue;a[u].remove&&a[u].remove()}}if(!f)if(r)r.content=e,r.name="viewport";else{var _=document.createElement("meta");_.content=e,_.name="viewport",_.id="kampyleMetaViewport",document.getElementsByTagName("head")[0].appendChild(_)}break;case"remove":if(r&&(r.content="",r.name="",r.remove&&r.remove()),a&&a.length){for(var u=a.length-1;u>=0;u--)if(f)a[u].el&&a[u].el.setAttribute("content",a[u].content);else if(!a[u].el){if(a[u].hasAttribute("id")&&a[u].id==="kampyleMetaViewport")continue;document.getElementsByTagName("head")[0].appendChild(a[u])}}break}o.setMemoryData("hostedViewportContent",a)}}function Le(){return Number(o.getMemoryData("inviteVersion"))>0&&o.isNewMobileInvitation()}function Kl(t){var e=o.getFormData(t)||{};return(e.inviteData||{}).invitationPosition||"top"}function Xl(t,e){Me("add");var r=o.getInviteData(e.formId),n="25%",a="none";if(!r||!z.isInviteLoaded(e.formId)||!c.isJsonDataLoaded(e.formId,!0))return!1;var l=c.checkProvision(i.PROVISIONS.ENABLE_ZOOM_WCAG_REFLOW),d=o.getMemoryData("kampyleDevice"),u="unset",m="unset";d===i.DEVICES.MOBILE||d===i.DEVICES.TABLET?(r.inviteHeight="100%",r.inviteWidth="100%",u="100vw",m="100vh",n=0):l&&(u="100vw",m="100vh",n="50%",a="translateY(-50%)");var f=s.getCurrentTimestamp();o.setMemoryData("invitationTimeStamp",f),o.setData("LAST_INVITATION_VIEW",f);var _=document.getElementById("kampyleInviteContainer");if(_&&o.getMemoryData("formIsShown")===!1){s.setElementStyle(_,{display:"block",visibility:o.isNewMobileInvitation()?"hidden":"visible"},!0),Xn(),E.trigger("neb_invitation_ready",{formId:e.formId});var A=document.getElementById("kampyleInviteModal");A&&s.setElementStyle(A,{top:n,width:r.inviteWidth+"px","max-width":u,height:r.inviteHeight+"px","max-height":m,display:"block",transform:a},!0);var N=document.getElementById("kampyleInvite");N&&s.setElementStyle(N,{width:r.inviteWidth+"px","max-width":u,height:r.inviteHeight+"px","max-height":m,display:"block",visibility:o.isNewMobileInvitation()?"hidden":"visible"},!0)}return!0}function Xn(){if(!(c.checkProvision(i.PROVISIONS.ENABLE_SPA_OVERFLOW_FIX)&&!o.getMemoryData("isOriginalHostingDom")))if(o.setMemoryData("isOriginalHostingDom",!1),o.isMobileDynamicSizing())v.manipulateAriaHiddens(),o.setMemoryData("hostedBodyOverflowXAttr",document.body.style.overflowX),document.body.style.overflowX="hidden";else{if(o.setMemoryData("hostedBodyPositionAttr",document.body.style.position),c.checkProvision(i.PROVISIONS.ENABLE_OVERFLOW))return!1;o.setMemoryData("hostedBodyOverflowAttr",document.body.style.overflow),document.body.style.overflow="hidden"}}function Fe(){if(!(c.checkProvision(i.PROVISIONS.ENABLE_SPA_OVERFLOW_FIX)&&o.getMemoryData("isOriginalHostingDom")))if(o.setMemoryData("isOriginalHostingDom",!0),o.isMobileDynamicSizing()){var t=document.getElementById("kampyleFormModal");s.setElementStyle(t,{height:"100%"},!0),v.restoreAriaHidden(),document.body.style.overflowX=o.getMemoryData("hostedBodyOverflowXAttr")||""}else c.checkProvision(i.PROVISIONS.ENABLE_OVERFLOW)||(document.body.style.overflow=o.getMemoryData("hostedBodyOverflowAttr")||""),document.body.style.position=o.getMemoryData("hostedBodyPositionAttr")||""}function Yt(){if(c.checkProvision(i.PROVISIONS.CSP_RULES))$.createFormContainer();else{var t=s.getOrCreateWrapperContainer(i.IFRAME_SETTINGS.LIGHTBOX.WRAPPER_ID),e="";e+='<div id="kampyleFormContainer" style="top:0 !important;left:0 !important;width: 100% !important;height: 100% !important;position: fixed !important;visibility:hidden !important;display:table !important;background-color: rgba(102,102,102,0.4) !important;z-index:99999999 !important;-webkit-overflow-scrolling: touch !important; ">',e+=' <div id="innerContainer">',e+='   <div id="kampyleFormModal" style="z-index:99999999 !important; -webkit-overflow-scrolling: touch !important;"></div>',e+=" </div>",e+="</div>",t.innerHTML=e;var r=$.createSpinnerElement();t.querySelector("#innerContainer").appendChild(r),s.setSpinnerStyle(r,i.SPINNER_SETTINGS.SIZE.LARGE),c.checkProvision(i.PROVISIONS.ENABLE_WCAG_PREPEND_SURVEY)?document.body.prepend(t):document.body.appendChild(t)}}function zn(t,e){e=e||{};var r=o.getFormState(e.formId);if(!(r&&r.loaded||c.hasApplicationLoadingFailed(e.formId,!1))){var n=o.getFormData(e.formId),a=o.getDisplayType(n);if(!(!n||!e.formId||a!=="lightbox")){var l=i.TIMEOUT_HANDLERS.FORM_APP_STATUS+"_"+e.formId,d=!!o.getTimeoutHandler(l);if(!d){var u=window.setTimeout(function(){c.isFormLoaded(e.formId)||E.trigger(i.EVENTS.NEB_FORM_LOADING_HAS_FAILED,{formId:e.formId,failureCause:i.FORM_LOADING_FAILURE_CAUSE.APPLICATION_FAILED,formState:o.getFormState(e.formId)})},i.NETWORK.TIME_FOR_FORM_TO_LOAD_MS);o.setTimeoutHandler(l,u)}document.getElementById("kampyleFormContainer")||Yt();var m=document.getElementById(i.IFRAME_SETTINGS.LIGHTBOX.IFRAME_ID_PREFIX+e.formId);if(!m){var f={border:0,height:"100%","max-height":"100%","min-height":"100%",width:"100%","max-width":"100%","min-width":"100%",display:"none"};!o.isCustomHtmlForm(e.formId)&&!o.isMobileDynamicSizing(n.formId)&&(f.position="fixed");var _=!0,A=document.getElementById(i.IFRAME_SETTINGS.LIGHTBOX.CONTAINER_ID_PREFIX);v.createFormIframe(e.formId,i.IFRAME_SETTINGS.LIGHTBOX.IFRAME_ID_PREFIX,A,f,_)}}}}function zl(t,e,r,n,a){var l=o.getFormData(t),d=document.createElement("iframe");s.setElementStyle(d,n,a),d.id=e+t;var u=l.formHtmlUrl;return u=Z.createFormUrl(u,t),d.src=u,d.tabIndex=-1,d.setAttribute("title",i.IFRAME_SETTINGS.IFRAME_TITLE),r.appendChild(d),d}function ql(t,e){var r=e.formId,n=document.getElementById("kampyleFormContainer");if(!(r&&n&&o.isMobileDynamicSizing(r)))return!1;s.setElementStyle(n,{height:s.getDocumentSize().height+"px",position:"absolute"},!0)}function qn(){return s.isIos()?"30px":"100%"}function Jn(t){if(o.isLightBoxDisplayType(t.formId)){var e=document.getElementById("kampyleFormModal"),r=Number((t||{}).newHeight);r=isNaN(r)?qn():r+"px",s.setElementStyle(e,{height:r},!0)}}function Jl(t,e){if(o.isMobileDynamicSizing((e||{}).formId)){Jn(e);var r=s.getNestedPropertyValue(e,"newHeight");if(v.shouldAddScroll(r)){var n=document.getElementById("kampyleFormContainer");s.setElementStyle(n,{overflowY:"auto"},!0)}}}function Zl(){for(var t=document.body.children,e=[],r=0;r<t.length;r++)e.push({element:t[r],prevAriaHiddenValue:t[r].getAttribute("aria-hidden")}),t[r].setAttribute("aria-hidden",!0);o.setMemoryData("initialAriaHiddenValues",e)}function Ql(){for(var t=o.getMemoryData("initialAriaHiddenValues")||[],e=0;e<t.length;e++)t[e].element&&j(t[e].element,Element)&&(t[e].prevAriaHiddenValue===null?t[e].element.removeAttribute("aria-hidden"):t[e].element.setAttribute("aria-hidden",t[e].prevAriaHiddenValue));o.deleteMemoryData("initialAriaHiddenValues")}function jl(t,e){var r=o.getFormData(e.formId),n=s.getOrCreateWrapperContainer(i.IFRAME_SETTINGS.INVITATION.WRAPPER_ID);if(c.checkProvision(i.PROVISIONS.CSP_RULES))$.createInviteIframeContainer(r);else{var a="top:0 !important;left:0 !important;width: 100% !important;";a+="height: 100% !important;position: fixed !important;visibility:hidden !important;",a+="display:none !important;background-color: rgba(22,22,22,0.5) !important;",a+="z-index:99999999 !important;overflow:auto !important",n.innerHTML='<div id="kampyleInviteContainer" style="'+a+'"><div id="kampyleInviteModal" style="overflow: hidden;margin: 0 auto;height:'+r.inviteData.inviteHeight+";width:"+r.inviteData.inviteWidth+';position:relative;z-index:99999999;top: 25%;-webkit-box-shadow:0 0 10px rgba(0,0,0,0.4);-moz-box-shadow:0 0 10px rgba(0,0,0,0.4); box-shadow:0 0 10px rgba(0,0,0,0.4);"></div></div>';var l=$.createSpinnerElement();n.querySelector("#kampyleInviteContainer").appendChild(l),s.setSpinnerStyle(l,i.SPINNER_SETTINGS.SIZE.LARGE),c.checkProvision(i.PROVISIONS.ENABLE_WCAG_PREPEND_SURVEY)?document.body.prepend(n):document.body.appendChild(n)}var d=document.createElement("iframe");d.id=i.IFRAME_SETTINGS.INVITATION.IFRAME_ID,d.title=i.IFRAME_SETTINGS.INVITATION.IFRAME_TITLE,d.tabIndex=-1;var u=r.inviteData.inviteHeight,m=r.inviteData.inviteWidth,f=o.getMemoryData("kampyleDevice"),_=c.checkProvision(i.PROVISIONS.ENABLE_ZOOM_WCAG_REFLOW),A=f===i.DEVICES.MOBILE||f===i.DEVICES.TABLET,N=_||A?"100vw":"unset",T=_||A?"100vh":"unset",h=document.getElementById("kampyleInviteModal");A&&(u="100%",m="100%",h&&s.setElementStyle(h,{height:"100%",width:"100%"},!0)),h&&s.setElementStyle(h,{maxWidth:N,maxHeight:T},!0),s.setElementStyle(d,{height:u,width:m,maxWidth:N,maxHeight:T,display:"none",border:"0"},!0);var g=r.inviteData.inviteUrl+"?formId="+e.formId;if(o.isFeatureEnabled(i.FEATURE_FLAGS.WCAG)&&(g+="&isWCAG=true"),g+="&domainsListRelativePath="+Z.getDomainsListRelativePath(g),d.src=g,document.getElementById("kampyleInviteModal").appendChild(d),o.isNewMobileInvitation()){var R=document.getElementsByClassName("neb-loading-spinner")[0];s.setElementStyle(R,{display:"none"},!0),s.setElementStyle(n,{"z-index":99999998},!0);var F=document.getElementById("kampyleInviteContainer");F&&s.setElementStyle(F,{"z-index":99999998},!0)}setTimeout(function(){o.getFormState(r.formId).inviteLoaded!==!0&&o.setFormState(r.formId,{inviteLoaded:!1,inviteShown:!1})},i.NETWORK.TIME_FOR_FORM_TO_LOAD_MS)}function Oe(t,e){!e||o.isEmbeddedDisplayType(e.formId)||(c.checkProvision(i.PROVISIONS.NEW_MODAL_DIALOGS)?v.hideFeedbackButtonVisually():(v.removeButton(t,e),v.unlistenToResize()))}function $l(t,e){var r=document.getElementById("kampyleButtonContainer");r&&(r.innerHTML="",c.checkProvision(i.PROVISIONS.NEW_MODAL_DIALOGS)&&o.setMemoryData(i.MEMORY_DATA_FIELDS.FEEDBACK_BUTTON_POSITION_STYLE,{}))}function Zn(t,e){c.checkProvision(i.PROVISIONS.ENABLE_SPA_OVERFLOW_FIX)&&Fe();var r=document.getElementById(i.IFRAME_SETTINGS.LIGHTBOX.WRAPPER_ID),n=document.getElementById(i.IFRAME_SETTINGS.INVITATION.WRAPPER_ID),a=document.getElementById(i.IFRAME_SETTINGS.ANIMATION.WRAPPER_ID),l=document.getElementById("kampyle_abandon_zone");v.removeButton(t,e),v.unlistenToResize(),r&&s.removeAllContent(r),n&&s.removeAllContent(n),a&&s.removeAllContent(a),l&&s.removeAllContent(l)}function ed(t){return typeof B!="undefined"&&B.getLocalizedButtonText?B.getLocalizedButtonText(t):t.buttonData.text}function td(t){var e=s.getElementStyle(document.body,"position");return(e==="fixed"||e==="absolute")&&s.getDocumentSize().height<=t}var v={setIframeOrigin:Yn,ignoreShowForm:Wl,scrollToEmbeddedForm:bn,scrollFromTop:yn,doScrollY:Dn,removeAllShownElements:Zn,handleLightBoxIframe:zn,createFormIframe:zl,createFormContainer:Yt,showForm:Wn,hideForm:Je,showButton:Vt,createButton:Ll,listenToResize:Mn,unlistenToResize:fl,onResizeButton:El,debouncedOnResize:Pn,hideInvite:qe,hideButton:Oe,hideFeedbackButtonVisually:Pl,showFeedbackButtonVisually:Ml,removeButton:$l,handleInvitationSkippedForms:Nn,updateIframeStyle:Ht,formatTriangularStyle:Fn,formatVerticalStyle:kn,prepareHostingDOM:Xn,restoreHostingDOM:Fe,getInvitePosition:Kl,newMobileInvite:Le,changeInviteHeight:Kn,iFrameHeightChangedHandler:Jn,manipulateAriaHiddens:Zl,restoreAriaHidden:Ql,getDefaultIframeHeight:qn,shouldAddScroll:td,shouldShowErrMsgOnForm:Nl,onErrModalClose:wn,handleLoadFormEvent:Hn,handleCloseButtonInErroModalKeydown:Un,onErrorModalKeyPressed:xn,pickElementStyleProperties:Rl,resetFormState:bl,getVerticalButtonTextWidth:wl,init:ml,setMetaViewport:Me,setZIndex:Ln,showVisibility:wt,getCornerMargin:Cn,showFormCouldNotFechtedErrorMsg:Ut,handleInviteReady:Sn,getButtonText:ed,showInvite:Xl,getWCAGClass:Qe,getClassDirectonByPosition:Gn,updateInviteIframeTitle:hn,getDynamicButtonStyles:Re,getVerticalButtonWidth:Bt,getTriangleTextSizeCalculation:pl};var rd={ANIMATION_DIRECTION:"centerRight"};function nd(){var t={neb_buttonClicked:[je],neb_sdkShowForm:[je],neb_loadForm:[Jt,Zt,Qn],neb_inviteAccepted:[je],neb_skipInvitation:[je],neb_formClosed:[$e,Wt],neb_popupBlocked:[$e,Wt],neb_captureInit:[$e],neb_captureImageClicked:[Kt],MDigital_Capture_Cancelled:[Kt],neb_formHide:[$e],neb_formLoadingHasFailed:[zt],neb_skipShowingForm:[ei],neb_resetFormState:[Wt]};E.subscribeMany(t)}function Qn(t,e){var r=o.getFormData(e.formId),n=o.isMobile(),a=s.getNestedPropertyValue(r,"formDisplay.displayDirection"),l=s.getNestedPropertyValue(r,"formDisplay.displayType"),d=c.checkProvision(i.PROVISIONS.ENABLE_ZOOM_WCAG_REFLOW)&&s.getNestedPropertyValue(r,"urlVersion");d&&!n&&a&&l==="animation"&&a.indexOf("center")>-1&&s.setEventHandler(window,"resize",jn(r))}function jn(t){var e=ae.resizeAnimationContainer.bind(null,t),r=s.debounce(e,100,!0);return ae.debouncedOnResize=r,r}function id(t){var e=document.getElementById("KampyleAnimationContainer");s.setElementStyle(e,{top:Xt(t.formHeight)})}function je(t,e){Zt(t,e),setTimeout(function(){Kt(t,e),ad(e.formId)},10)}function ad(t){if(s.isSafari()){var e=o.getFormIframeId(t),r=document.getElementById(e);s.focusElement(r)}}function od(t,e,r){return!t||!e||!ke(t)||c.hasApplicationLoadingFailed(r,!1)}function Kt(t,e){e=e||{};var r=o.getFormData(e.formId),n=document.getElementById(i.IFRAME_SETTINGS.ANIMATION.CONTAINER_ID);if(od(r,n,e.formId))return!1;o.setMemoryData("isInvitationShouldBeIgnored",!0);var a=document.getElementById(i.IFRAME_SETTINGS.ANIMATION.IFRAME_ID+e.formId),l={display:"block",backgroundColor:r.designSettings.formBackgroundColor||"white"},d={display:"block",boxShadow:"-4px 0px 18px -1px rgba(0,0,0,0.37)",backgroundColor:r.designSettings.formBackgroundColor||"white"};c.checkProvision(i.PROVISIONS.ENABLE_ZOOM_WCAG_REFLOW)&&(d.maxWidth="100vw",d.maxHeight="100vh");var u=qt(r);switch(u){case"centerRight":s.setElementStyle(n,{right:0}),d.borderRadius="8px 0px 0px 8px";break;case"centerLeft":s.setElementStyle(n,{left:0}),d.borderRadius="0px 8px 8px 0px";break;case"bottomRight":s.setElementStyle(n,{bottom:0}),d.borderRadius="8px 0px 0px 0px";break;case"bottomLeft":s.setElementStyle(n,{bottom:0}),d.borderRadius="0px 8px 0px 0px";break;case"topRight":s.setElementStyle(n,{top:0}),d.borderRadius="0px 0px 0px 8px";break;case"topLeft":s.setElementStyle(n,{top:0}),d.borderRadius="0px 0px 8px 0px";break;default:return s.showWarning("Invalid animation type - "+u),!1}a&&(o.isV2Form(e.formId)?s.setElementStyle(a,d):s.setElementStyle(a,l))}function zt(){var t=document.getElementById(i.IFRAME_SETTINGS.ANIMATION.CONTAINER_ID);t&&s.setElementStyle(t,{width:0,height:0})}function Wt(t,e){setTimeout(function(){var r=o.getFormData(e.formId),n=document.getElementById(i.IFRAME_SETTINGS.ANIMATION.IFRAME_ID+e.formId);n&&(n.remove(),s.removeEventHandler(window,"resize",ae.debouncedOnResize),o.initOnsiteDefaultState(e.formId)),zt()},1e3)}function $e(t,e){var r=o.getFormData(e.formId);if(o.getDisplayType(r)!=="animation")return!1;e=e||{};var n=document.getElementById(i.IFRAME_SETTINGS.ANIMATION.CONTAINER_ID);if(!r||!n||!ke(r))return!1;$n(r,n)}function Xt(t){return String(Math.max(0,(window.innerHeight-parseInt(t,10))/2))+"px"}function qt(t){return t=t||{},s.getNestedPropertyValue(t,"formDisplay.displayDirection")||rd.ANIMATION_DIRECTION}function $n(t,e){var r;switch(qt(t)){case"centerRight":s.setElementStyle(e,{top:Xt(e.style.height),right:"-"+t.formWidth+"px",bottom:null,left:null,transition:"right 1s ease-in-out"});break;case"centerLeft":s.setElementStyle(e,{top:Xt(e.style.height),right:null,bottom:null,left:"-"+t.formWidth+"px",transition:"left 1s ease-in-out"});break;case"bottomRight":r=v.getCornerMargin(t)+"px",s.setElementStyle(e,{top:null,right:r,bottom:"-"+t.formHeight+"px",left:null,transition:"bottom 1s ease-in-out"});break;case"bottomLeft":r=v.getCornerMargin(t)+"px",s.setElementStyle(e,{top:null,right:null,bottom:"-"+t.formHeight+"px",left:r,transition:"bottom 1s ease-in-out"});break;case"topLeft":r=v.getCornerMargin(t)+"px",s.setElementStyle(e,{top:"-"+t.formHeight+"px",right:null,bottom:null,left:r,transition:"top 1s ease-in-out"});break;case"topRight":r=v.getCornerMargin(t)+"px",s.setElementStyle(e,{top:"-"+t.formHeight+"px",right:r,bottom:null,left:null,transition:"top 1s ease-in-out"});break;default:return s.showWarning("Invalid animation type - "+t.formDisplayDirection),!1}}function ke(t){return o.getDisplayType(t)==="animation"}function ei(t,e){var r=o.getFormData(e.formId);if(ke(r)){var n=document.getElementById(i.IFRAME_SETTINGS.ANIMATION.IFRAME_ID+e.formId);n&&s.setElementStyle(n,{display:"none"})}}function sd(t){var e=document.getElementById(i.IFRAME_SETTINGS.ANIMATION.CONTAINER_ID);if(!e){var r=s.getOrCreateWrapperContainer(i.IFRAME_SETTINGS.ANIMATION.WRAPPER_ID);e=document.createElement("div"),s.addAttributesOnElement(e,{id:i.IFRAME_SETTINGS.ANIMATION.CONTAINER_ID}),e.style.zIndex="2147483000",r.appendChild(e),document.body.appendChild(r);var n={border:0,position:"fixed",display:"block",zIndex:"2147483000"};t&&(n.maxWidth="100vw",n.maxHeight="100vh"),s.setElementStyle(e,n)}return e}function Jt(t,e){e=e||{};var r=o.getFormData(e.formId);if(!r||!ae.isAnimationForm(r))return!1;var n=c.checkProvision(i.PROVISIONS.ENABLE_ZOOM_WCAG_REFLOW)&&s.getNestedPropertyValue(r,"urlVersion"),a=ae.getOrCreateAnimationContainer(n),l=document.getElementById(i.IFRAME_SETTINGS.ANIMATION.IFRAME_ID+e.formId);if(!l){var d={border:0,height:r.formHeight+"px",width:r.formWidth+"px",display:"none"};n&&(d.maxWidth="100vw",d.maxHeight="100vh");var u=!1;v.createFormIframe(e.formId,i.IFRAME_SETTINGS.ANIMATION.IFRAME_ID,a,d,u)}var m=a.querySelector("#"+i.SPINNER_SETTINGS.CONTAINER_ID);m||(m=$.createSpinnerElement(),a.appendChild(m),s.setSpinnerStyle(m,i.SPINNER_SETTINGS.SIZE.LARGE))}function Zt(t,e){e=e||{};var r=o.getFormData(e.formId),n=o.isSkipInvitation(e.formId),a=document.getElementById(i.IFRAME_SETTINGS.ANIMATION.CONTAINER_ID);if(!a||!r||!ke(r)||n&&c.isAnyOtherFormAlreadyShown(e.formId))return!1;document.getElementById(i.IFRAME_SETTINGS.ANIMATION.IFRAME_ID+e.formId)||Jt(t,e),s.setElementStyle(a,{height:r.formHeight+"px",width:r.formWidth+"px"}),$n(r,a)}var ae={initAnimationPosition:Zt,getDisplayDirection:qt,getOrCreateAnimationContainer:sd,init:nd,hideAnimationContainer:zt,hideFormAnimationContainer:ei,handleAnimationIframe:Jt,isAnimationForm:ke,listenToResizeAnimation:Qn,resizeAnimationContainer:id,debouncedOnResize:jn};function ld(){var t={neb_loadForm:[ri],neb_formLoaded:[ni],neb_iFrameHeightChanged:[si],neb_formClosed:[gd],MDigital_ThankYou_Displayed:[ui],neb_targetingInit:[ti]};E.subscribeMany(t)}function ti(){if(c.checkProvision(i.PROVISIONS.CLEAR_EMBEDDED_ON_UPDATE_PAGE))for(var t=o.getAllForms(),e=0;e<t.length;e++){var r=t[e];o.isEmbeddedDisplayType(r.formId)&&De.deleteEmbeddedIframe(r.formId)}}function dd(t){var e=o.getFormData(t);return s.getNestedPropertyValue(e,"isFullWidthEmbedded")}function ri(t,e){if(e=e||{},!o.isEmbeddedDisplayType(e.formId))return!1;var r=ii(e.formId);if(!ud(r))return!1;if(r){var n=parseInt(getComputedStyle(r).height),a=parseInt(getComputedStyle(r).paddingTop)+parseInt(getComputedStyle(r).paddingBottom);a===n&&(n=0),li(r.id,n)}var l=setTimeout(function(){c.isFormLoaded(e.formId)||E.trigger(i.EVENTS.NEB_FORM_LOADING_HAS_FAILED,{formId:e.formId,failureCause:i.FORM_LOADING_FAILURE_CAUSE.APPLICATION_FAILED,formState:o.getFormState(e.formId)})},i.NETWORK.TIME_FOR_FORM_TO_LOAD_MS);o.setTimeoutHandler(i.TIMEOUT_HANDLERS.EMBEDDED_STATUS+"_"+e.formId,l);var d=cd(e.formId),u=o.getFormData(e.formId);return d.src=Z.createFormUrl(u.formHtmlUrl,e.formId),r.appendChild(d),o.setFormState(e.formId,{shouldBeShown:!0}),!0}function ni(t,e){if(!o.isEmbeddedDisplayType(e.formId)||c.hasApplicationLoadingFailed(e.formId))return!1;var r=document.getElementById(i.IFRAME_SETTINGS.EMBEDDED.IFRAME_ID_PREFIX+e.formId);return r&&Qt(r,{display:"block"}),!0}function ud(t){return t!==null&&(!t.innerHTML||typeof t.innerHTML=="string"&&t.innerHTML.trim()==="")}function ii(t){var e=o.getFormData(t);return document.getElementById(s.getNestedPropertyValue(e,"embeddedData.pageElementId"))}function ai(t){var e=c.checkProvision(i.PROVISIONS.PREVENT_IFRAME_SCROLLBAR_FLICKERING),r=o.isV2Form(t),n=o.isCustomHtmlForm(t);return e&&!r&&!n}function cd(t){var e=i.IFRAME_SETTINGS.EMBEDDED.IFRAME_ID_PREFIX+t,r=document.getElementById(e);return r||(r=document.createElement("iframe"),r.id=e,r.setAttribute("title",i.IFRAME_SETTINGS.IFRAME_TITLE),ai(t)&&r.setAttribute("scrolling","no"),Qt(r,{display:"none"})),r}function Qt(t,e){var r={border:0,width:"100%",height:"100%"},n=Object.assign({},r,e);s.setElementStyle(t,n,!1)}function oi(t,e){e?s.removeAttribute(t,"scrolling"):s.addAttributesOnElement(t,{scrolling:"no"})}function si(t,e){e=e||{};var r=o.getFormData(e.formId)||{},n=ii(e.formId),a=document.getElementById(i.IFRAME_SETTINGS.EMBEDDED.IFRAME_ID_PREFIX+e.formId);if(!o.isEmbeddedDisplayType(e.formId)||n===null||a===null)return!1;var l=md(n,r,e),d=fd(n,r),u={height:l.iframeHeight+"px",width:dd(e.formId)?"100%":d+"px"};Qt(a,u),ai(e.formId)&&oi(a,l.shouldBeStatic);var m={height:l.formHeight,width:d,shouldBeStatic:l.shouldBeStatic};return s.sendMessageToIframe(i.IFRAME_SETTINGS.EMBEDDED.IFRAME_ID_PREFIX+e.formId,{action:"setFormStyle",data:m}),m}function md(t,e,r){var n=e.isFixedSize==="true"||e.isFixedSize===!0,a=n,l=n?parseInt(e.formHeight):r.newHeight,d=getComputedStyle(t),u=di(t.id);u=isNaN(u)?parseInt(t.style.height||0):u;var m=isNaN(parseInt(d.maxHeight))?u||0:parseInt(d.maxHeight),f=isNaN(parseInt(d.minHeight))?0:parseInt(d.minHeight),_=m===0&&f===0;return m!==0&&f>m&&(m=f),Ed(l,a,_,m,f,u)}function Ed(t,e,r,n,a,l){var d,u=t;return r?(u=t,d=u):(n!==0&&t>=n&&(u=n,e=!0),d=u,(t<a||t<l)&&(d=a!==0?a:l)),{formHeight:u,iframeHeight:d,shouldBeStatic:e}}function fd(t,e){var r=parseInt(e.formWidth);return Math.min(r,s.getElementSize(t).width)}function gd(t,e){De.deleteEmbeddedIframe(e.formId)}function _d(t){if(!o.isEmbeddedDisplayType(t))return!1;var e=document.getElementById(i.IFRAME_SETTINGS.EMBEDDED.IFRAME_ID_PREFIX+t);return e===null?!1:(s.removeAllContent(e),!0)}function li(t,e){var r=o.getMemoryData("hostingElementsHeights");r[t]=e,o.setMemoryData("hostingElementsHeights",r)}function di(t){return o.getMemoryData("hostingElementsHeights")[t]||0}function ui(t,e){e=e||{},o.isEmbeddedDisplayType(e.formId)&&o.isMobile()&&v.scrollToEmbeddedForm(e.formId)}var De={removeEmbeddedIFrames:ti,init:ld,createEmbeddedIframe:ri,showForm:ni,calculateFormSize:si,deleteEmbeddedIframe:_d,addHostingElementHeight:li,getHostingElementHeight:di,handleThankyouPage:ui,setIframeScrolling:oi};var G=[],Id=function(){if(!G.__SV){window.MDIGITAL.md_tracker=G;var e,r;G._i=[],G.init=function(n,a){function l(u,m){var f=m.split(".");f.length===2&&(u=u[f[0]],m=f[1]),u[m]=function(){u.push([m].concat(Array.prototype.slice.call(arguments,0)))}}var d=G;for(typeof a!="undefined"?d=G[a]=[]:a="md_tracker",e=["trackEvent","trackEventLater","flush","set_config"],r=0;r<e.length;r++)l(d,e[r]);n&&G._i.push([n,a])},G.__SV=1.2}},pd=function(){var e=Array.prototype,r=Object.prototype,n=e.slice,a=r.toString,l=r.hasOwnProperty,d=window.console,u=window.navigator,m=window.document,f=u.userAgent,_;u.userAgentData&&u.userAgentData.platform&&(_=u.userAgentData.getHighEntropyValues(["architecture","bitness","model","platformVersion","uaFullVersion","fullVersionList","wow64"]).then(JSON.stringify));var A="md_tracker",N=G&&G.__SV||0,T=window.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest,h=!T&&f.indexOf("MSIE")==-1&&f.indexOf("Mozilla")==-1,g={},R={api_host:"",loaded:function(){},http_post:!0},F=!1;(function(){var I=e.forEach,p=Array.isArray,D={},b=g.each=function(O,P,J){if(O!=null){if(I&&O.forEach===I)O.forEach(P,J);else if(O.length===+O.length){for(var x=0,ee=O.length;x<ee;x++)if(x in O&&P.call(J,O[x],x,O)===D)return}else for(var re in O)if(l.call(O,re)&&P.call(J,O[re],re,O)===D)return}};g.extend=function(S){return b(n.call(arguments,1),function(O){for(var P in O)O[P]!==void 0&&(S[P]=O[P])}),S},g.isArray=p||function(S){return a.call(S)==="[object Array]"},g.isFunction=function(S){try{return/^\s*\bfunction\b/.test(S)}catch(O){return!1}},g.isArguments=function(S){return!!(S&&l.call(S,"callee"))},g.toArray=function(S){return S?S.toArray?S.toArray():g.isArray(S)||g.isArguments(S)?n.call(S):g.values(S):[]},g.values=function(S){var O=[];return S==null||b(S,function(P){O[O.length]=P}),O}})(),g.isObject=function(I){return I===Object(I)&&!g.isArray(I)},g.isUndefined=function(I){return I===void 0},g.isString=function(I){return a.call(I)=="[object String]"},g.strip_empty_properties=function(I){var p={};return g.each(I,function(D,b){g.isString(D)&&D.length>0&&(p[b]=D)}),p},g.utf8Encode=function(I){I=I.replace(/\r\n/g,"\n");for(var p="",D=0;D<I.length;D++){var b=I.charCodeAt(D);b<128?p+=String.fromCharCode(b):b>127&&b<2048?(p+=String.fromCharCode(b>>6|192),p+=String.fromCharCode(b&63|128)):(p+=String.fromCharCode(b>>12|224),p+=String.fromCharCode(b>>6&63|128),p+=String.fromCharCode(b&63|128))}return p},g.base64Encode=function(I){var p={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(b){var S="",O,P,J,x,ee,re,Te,We=0;for(b=g.utf8Encode(b);We<b.length;)O=b.charCodeAt(We++),P=b.charCodeAt(We++),J=b.charCodeAt(We++),x=O>>2,ee=(O&3)<<4|P>>4,re=(P&15)<<2|J>>6,Te=J&63,isNaN(P)?re=Te=64:isNaN(J)&&(Te=64),S=S+this._keyStr.charAt(x)+this._keyStr.charAt(ee)+this._keyStr.charAt(re)+this._keyStr.charAt(Te);return S}};return p.encode(I)},g.HTTPBuildQuery=function(I,p){var D,b,S,O=[];return typeof p=="undefined"&&(p="&"),g.each(I,function(P,J){b=encodeURIComponent(P.toString()),S=encodeURIComponent(J),O[O.length]=S+"="+b}),O.join(p)},g.getQueryParam=function(I,p){p=p.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var D="[\\?&]"+p+"=([^&#]*)",b=new RegExp(D),S=b.exec(I);return S===null||S&&typeof S[1]!="string"&&S[1].length?"":decodeURIComponent(S[1]).replace(/\+/g," ")},g.register_event=function(){var I=function(S,O,P,J){if(!S){d.log("No valid element provided to register_event");return}if(S.addEventListener&&!J)S.addEventListener(O,P,!1);else{var x="on"+O,ee=S[x];S[x]=p(S,P,ee)}};function p(b,S,O){var P=function(x){if(x=x||D(window.event),!!x){var ee=!0,re,Te;return g.isFunction(O)&&(re=O(x)),Te=S.call(b,x),(re===!1||Te===!1)&&(ee=!1),ee}};return P}function D(b){return b&&(b.preventDefault=D.preventDefault,b.stopPropagation=D.stopPropagation),b}return D.preventDefault=function(){this.returnValue=!1},D.stopPropagation=function(){this.cancelBubble=!0},I}(),g.info={properties:function(){return g.extend(g.strip_empty_properties({sessionScreenSize:window.screen.width+"x"+window.screen.height,sessionDua:u.userAgent,sessionPlatform:u.platform,referringUrl:m.referrer,pageTitle:m.title,pageUrl:m.location.href}),{type:"website"})}};var X={critical:function(){if(!g.isUndefined(d)&&d){var p=["md_tracker error:"].concat(g.toArray(arguments));try{d.error.apply(d,p)}catch(D){g.each(p,function(b){d.error(b)})}}}},W=function(p,D){var b,S=D===A?G:G[D];if(S&&!g.isArray(S)){d.log("You have already initialized "+D);return}return b=new M,b._init(p,D),g.isUndefined(S)||b._execute_array(S),b},M=function(){};if(M.prototype.init=function(I,p){if(typeof p=="undefined"){d.log("You must name your new library: init(config, name)");return}if(p===A){d.log("You must initialize the main md_tracker object right after you include the md_tracker js snippet");return}var D=W(I,p);return G[p]=D,D._loaded(),D},M.prototype._init=function(I,p){this.__loaded=!0,this.__SV=!0,this.config={},this.eventsArray=[],I=I||{},this.set_config(g.extend({},R,{session_id:I.session_id,http_post:I.http_post,topic:I.topic,name:p,api_host:I.api_host})),this.__dom_loaded_queue=[],this.__request_queue=[],I.custom_event_handler&&(this.__customEventHandler=I.custom_event_handler)},M.prototype._loaded=function(){this.get_config("loaded")(this)},M.prototype._dom_loaded=function(){g.each(this.__dom_loaded_queue,function(I){this._track_dom.apply(this,I)},this),g.each(this.__request_queue,function(I){this._send_request.apply(this,I)},this),delete this.__dom_loaded_queue,delete this.__request_queue},M.prototype._track_dom=function(I,p){if(!F)return this.__dom_loaded_queue.push([I,p]),!1;var D=new I().init(this);return D.track.apply(D,p)},M.prototype.trackEventLater=function(I,p){if(typeof I=="undefined"){d.log("No event name provided to md_tracker.trackEventLater");return}p=p||{};var D=new Date,b=g.extend({},g.info.properties(),{eventName:I,timestamp:D.toISOString(),eventTimezoneOffset:-1*(D.getTimezoneOffset()/60)});if(b=g.extend(b,p),_){var S=this;_.then(function(O){b=g.extend(b,{clientHints:O})}).catch(function(){}).then(function(){S.eventsArray.push(b)})}else this.eventsArray.push(b)},M.prototype.flush=function(){var I=this.eventsArray;this._send_request(I),this.eventsArray=[]},M.prototype._onError=function(I,p){},M.prototype._send_request=function(I,p){if(h){this.__request_queue.push(arguments);return}if(this.__customEventHandler&&this.__customEventHandler.handleRequest){var D=null;T&&(D="post"),this.__customEventHandler.handleRequest(this,I,D);return}var b=this.get_config("api_host"),S=this.get_config("topic"),O=JSON.stringify(I);if(T){var P=new XMLHttpRequest;P.open("POST",b,!0),P.setRequestHeader("Content-type","application/json"),P.setRequestHeader("charset","UTF-8"),S&&P.setRequestHeader("Mec-Integration-Id",S),P.onreadystatechange=function(ee){if(P.readyState===4)if(P.status===200)p&&p();else{var re="Bad HTTP status: "+P.status+" "+P.statusText;d.log(re)}},P.send(O)}else{var J=this;I={data:g.base64Encode(O)},S&&(I.mecIntegrationId=g.base64Encode(S)),b+="/da.gif?"+g.HTTPBuildQuery(I);var x=m.createElement("img");x.onerror=function(){J._onError(I,p)},x.width=1,x.height=1,x.src=b}},M.prototype._execute_array=function(I){var p,D=[],b=[],S=[];g.each(I,function(P){P&&(p=P[0],typeof P=="function"?P.call(this):g.isArray(P)&&p==="alias"?D.push(P):g.isArray(P)&&(p.indexOf("track")!=-1||p.indexOf("flush")!=-1)&&typeof this[p]=="function"?S.push(P):b.push(P))},this);var O=function(J,x){g.each(J,function(ee){this[ee[0]].apply(this,ee.slice(1))},x)};O(D,this),O(b,this),O(S,this)},M.prototype.push=function(I){this._execute_array([I])},M.prototype.trackEvent=function(I,p,D){if(typeof I=="undefined"){d.log("No event name provided to md_tracker.trackEvent");return}p=p||{};var b=new Date,S=g.extend({},g.info.properties(),{eventName:I,timestamp:b.toISOString(),eventTimezoneOffset:-1*(b.getTimezoneOffset()/60)});S=g.extend(S,p),_?_.then(function(O){S=g.extend(S,{clientHints:O})}).catch(function(){}).then(this._send_events.bind(this,S,D)):this._send_events(S,D)},M.prototype._send_events=function(I,p){this._send_request([I],p)},M.prototype.set_config=function(I){g.isObject(I)&&g.extend(this.config,I)},M.prototype.get_config=function(I){return this.config[I]},M.prototype.toString=function(){var I=this.get_config("name");return I!==A&&(I=A+"."+I),I},g.toArray=g.toArray,g.isObject=g.isObject,g.info=g.info,M.prototype.init=M.prototype.init,M.prototype.track_event=M.prototype.trackEvent,M.prototype.track_event_later=M.prototype.trackEventLater,M.prototype.flush=M.prototype.flush,M.prototype.set_config=M.prototype.set_config,M.prototype.get_config=M.prototype.get_config,M.prototype.toString=M.prototype.toString,g.isUndefined(G)){X.critical("'md_tracker' object not initialized. Ensure you are using the latest version of the md_tracker JS Library along with the snippet we provide.");return}if(G.__loaded||G.config){d.log("md_tracker library has already been downloaded at least once.");return}if(N<1.1){d.critical("Version mismatch; please ensure you're using the latest version of the md_tracker code snippet.");return}var C={};g.each(G._i,function(I){var p,D;I&&g.isArray(I)&&(p=I[I.length-1],D=W.apply(this,I),C[p]=D)});var le=function(){g.each(C,function(p,D){D!==A&&(G[D]=p)}),G._=g};G.init=function(I,p){if(p)G[p]||(G[p]=C[p]=W(I,p),G[p]._loaded());else{var D=G;C[A]?D=C[A]:(D=W(I,A),D&&D._loaded()),window.MDIGITAL[A]=G=D,le()}},G.init(),g.each(C,function(I){I._loaded()});function K(){K.done||(K.done=!0,F=!0,h=!1,g.each(C,function(I){I._dom_loaded()}))}if(m.addEventListener)m.readyState=="complete"?K():m.addEventListener("DOMContentLoaded",K,!1);else if(m.attachEvent){m.attachEvent("onreadystatechange",K);var de=!1;try{de=window.frameElement==null}catch(I){}m.documentElement.doScroll&&de&&Se()}function Se(){try{m.documentElement.doScroll("left")}catch(I){setTimeout(Se,1);return}K()}g.register_event(window,"load",K,!0)},jt={loadBaseTracker:Id,loadFullTracker:pd,md_tracker:G};var nt={},Sd={additional_data:"additionalData",additionalInfo:function(e){return typeof e=="string"?e:"additionalData"},error_logs:"errorLogs",source_function:"sourceFunction",formId:"destinationForm"},Td={errorMessage:"message",uuid:"feedbackUuid"},$t,oe={},we={neb_eventDispatcherError:{eventId:"nebula_eventDispatcherError",eventDataKeys:["errorMessage","errorStack"],eventMdDataKeys:["additionalInfo"]},MDigital_warning:{eventId:"MDigital_warning",eventDataKeys:["message"]},MDigital_couldNotFetchData:{eventId:"MDigital_couldNotFetchData",eventMdDataKeys:["errorData"]},MDigital_noJsonModalShown:{eventId:"mdigital_noDataMessageDisplayed",eventMdDataKeys:["additionalInfo"]},neb_afterHttpGetRequestOnError:{eventId:"nebula_after_http_get_request_on_error",eventMdDataKeys:["httpRequestData"]},neb_afterHttpGetRequestOnErrorStatusCode:{eventId:"nebula_after_http_get_request_on_error_status_code",eventMdDataKeys:["httpRequestData"]},neb_afterHttpGetRequestOnTimeout:{eventId:"nebula_after_http_get_request_on_timeout",eventMdDataKeys:["httpRequestData"]},neb_afterHttpGetRequest:{eventId:"nebula_after_http_get_request",eventMdDataKeys:["httpRequestData"]},MDigital_directGenericInjection:{eventId:"mdigital_directGenericInjection"}},tt={neb_pageView:{eventId:"nebula_page_view",disableProvision:i.PROVISIONS.DISABLE_ANALYTICS_NEW_PAGE_EVENTS},neb_inviteAccepted:{eventId:"nebula_invite_accepted"},neb_inviteDeclined:{eventId:"nebula_invite_declined"},neb_showInvitation:ue({eventId:"nebula_invitation_show",memoryDataKey:"invitationTriggeringData"},{formatDataFunc:et}),neb_feedbackSubmitted:ue({eventId:"nebula_form_submitted"},{formatDataFunc:et}),neb_feedbackPreSubmitted:{eventId:"nebula_form_preSubmitted"},neb_feedbackPostSubmitted:ue({eventId:"nebula_form_postSubmitted"},{formatDataFunc:et}),neb_formShown:ue({eventId:"nebula_form_show"},{formatDataFunc:et}),neb_buttonClicked:{eventId:"nebula_button_clicked"},neb_sdkShowForm:{eventId:"nebula_code_trigger_form"},neb_routeToForm:{eventId:"nebula_route_to_form",eventMdDataKeys:["formId"]},neb_formClosed:{eventId:"nebula_form_closed"},neb_popupBlocked:{eventId:"nebula_popup_blocked"},neb_skipInvitation:{eventId:"nebula_invitation_skipped"},neb_formPageShown:{eventId:"nebula_form_page_displayed"},neb_captureInit:{eventId:"nebula_capture_init"},neb_captureImageClicked:{eventId:"nebula_capture_image_clicked"},MDigital_Capture_Cancelled:{eventId:"nebula_cancel_capture_clicked"},neb_cancel_capture_clicked:{eventId:"nebula_cancel_capture_clicked"},neb_sdkSurveyDisplayed:{eventId:"nebula_code_survey_displayed"},neb_feedbackUUIDisNull:{eventId:"nebula_feedbackUuidIsNull"},neb_submitFeedbackFailed:{eventId:"nebula_submitFeedbackFailed",eventDataKeys:["uuid","errorMessage","errorStack"]},MDigital_couldNotLoadFormApplication:{eventId:"MDigital_couldNotLoadFormApplication",eventMdDataKeys:["errorData"]},MDigital_Invalid_Origin:{eventId:"MDigital_Invalid_Origin"},screenCaptureRetake:{eventId:i.EVENTS.SCREEN_CAPTURE_RETAKE},screenCaptureDelete:{eventId:i.EVENTS.SCREEN_CAPTURE_DELETE}},ci={neb_sessionStart:{eventId:"session_start",provision:i.PROVISIONS.ENABLE_ANALYTICS_SESSION_EVENTS},neb_load_form_preload_proximity:{eventId:"nebula_load_form_preload_proximity",provision:i.PROVISIONS.analyticsNewEvents},neb_button_displayed:{eventId:"nebula_button_displayed",provision:i.PROVISIONS.analyticsNewEvents,eventMdDataKeys:["position"]},neb_invitation_loaded:{eventId:"nebula_invitation_loaded",provision:i.PROVISIONS.analyticsNewEvents},neb_invitation_ready:{eventId:"nebula_invitation_ready",provision:i.PROVISIONS.analyticsNewEvents},neb_form_loaded:{eventId:"nebula_form_loaded",provision:i.PROVISIONS.analyticsNewEvents},neb_formReady:{eventId:"nebula_form_ready",provision:i.PROVISIONS.analyticsNewEvents},MDigital_updatingSbtServer:{eventId:"MDigital_updating_sbt_server",eventMdDataKeys:["dataObjForSbt"],provision:i.PROVISIONS.UBT_EXTRA_EVENTS},MDigital_settingIdentifierValueOnMemory:{eventId:"MDigital_setting_identifier_value_on_memory",provision:i.PROVISIONS.UBT_EXTRA_EVENTS},MDigital_shouldNotSyncIdentifier:{eventId:"MDigital_should_not_sync_identifier",provision:i.PROVISIONS.UBT_EXTRA_EVENTS},neb_beforeHttpPostRequest:{eventId:"nebula_before_http_post_request",eventMdDataKeys:["httpRequestData"],provision:i.PROVISIONS.UBT_EXTRA_EVENTS},neb_afterHttpPostRequestOnError:{eventId:"nebula_after_http_post_request_on_error",eventMdDataKeys:["httpRequestData"],provision:i.PROVISIONS.UBT_EXTRA_EVENTS},neb_afterHttpPostRequest:{eventId:"nebula_after_http_post_request",eventMdDataKeys:["httpRequestData"],provision:i.PROVISIONS.UBT_EXTRA_EVENTS},neb_afterHttpPostRequestOnErrorStatusCode:{eventId:"nebula_after_http_post_request_on_error_status_code",eventMdDataKeys:["httpRequestData"],provision:i.PROVISIONS.UBT_EXTRA_EVENTS},neb_afterHttpPostRequestOnTimeout:{eventId:"nebula_after_http_post_request_on_timeout",eventMdDataKeys:["httpRequestData"],provision:i.PROVISIONS.UBT_EXTRA_EVENTS},MDigital_updateTargetingWithDeclinedDateInviteDeclined:{eventId:"MDigital_update_targeting_with_declined_date_invite_declined",provision:i.PROVISIONS.UBT_EXTRA_EVENTS},MDigital_updateTargetingWithSubmittedDate:{eventId:"MDigital_update_targeting_with_submitted_date",provision:i.PROVISIONS.UBT_EXTRA_EVENTS},MDigital_updateTargetingWithDeclinedDateFormClosed:{eventId:"MDigital_update_targeting_with_declined_date_form_closed",provision:i.PROVISIONS.UBT_EXTRA_EVENTS},neb_initUserIdentifier:{eventId:"nebula_init_user_identifier",provision:i.PROVISIONS.UBT_EXTRA_EVENTS},neb_initUserIdentifierOnExtraData:{eventId:"nebula_init_user_identifier_on_extra_data",provision:i.PROVISIONS.UBT_EXTRA_EVENTS},MDigital_Form_Next_Page:{eventId:"MDigital_Form_Next_Page",provision:i.PROVISIONS.analyticsNewEvents},MDigital_Form_Back_Page:{eventId:"MDigital_Form_Back_Page",provision:i.PROVISIONS.analyticsNewEvents},MDigital_Form_Close_No_Submit:{eventId:"MDigital_Form_Close_No_Submit",provision:i.PROVISIONS.analyticsNewEvents},MDigital_ThankYou_Displayed:{eventId:"MDigital_ThankYou_Displayed",provision:i.PROVISIONS.analyticsNewEvents},MDigital_ThankYou_Close:{eventId:"MDigital_ThankYou_Close",provision:i.PROVISIONS.analyticsNewEvents},MDigital_pageTargetingPhaseEnded:{eventId:i.EVENTS.MDIGITAL_PAGE_TARGETING_PHASE_ENDED,provision:i.PROVISIONS.TARGETING_EVENTS_REPORTING,formatDataFunc:Ti,eventMdDataKeys:["additionalData"],rateLimit:1},MDigital_behavioralTargetingPhaseEnded:{eventId:i.EVENTS.MDIGITAL_BEHAVIORAL_TARGETING_PHASE_ENDED,provision:i.PROVISIONS.TARGETING_EVENTS_REPORTING,formatDataFunc:Ai,eventMdDataKeys:["additionalData"],rateLimit:1},MDigital_quarantinedSurveyPhaseEnded:{eventId:i.EVENTS.MDIGITAL_QUARANTINED_SURVEY_PHASE_ENDED,provision:i.PROVISIONS.TARGETING_EVENTS_REPORTING,formatDataFunc:vi,eventMdDataKeys:["additionalData"],rateLimit:1},MDigital_DynamicOnsiteInitializedSuccessfully:{eventId:i.EVENTS.MDIGITAL_DYNAMIC_ONSITE_INITIALIZED_SUCCESSFULLY,provision:i.PROVISIONS.DYNAMIC_ONSITE_EVENTS},MDigital_createSession:{eventId:i.EVENTS.CREATE_SESSION,provision:i.PROVISIONS.CREATE_SESSION,eventMdDataKeys:["additionalData"]},mdigital_customEventsDebugMessage:{eventId:i.EVENTS.CUSTOM_EVENTS_DEBUG_MESSAGE,eventDataKeys:["customEventId","customEventData"],provision:i.PROVISIONS.ENABLE_EVENTS_FOR_CE_DEBUG},MDigital_CHTML_Logs:{eventId:i.EVENTS.MDIGITAL_CHTML_LOGS,provision:i.PROVISIONS.CHTML_LOGS,eventMdDataKeys:["source_function","additional_data","error_logs"]}};function et(t){var e=o.getFormData(t.formId),r=s.getNestedPropertyValue(e,"onSiteData.decibelBehavioural"),n=s.getNestedPropertyValue(e,"onSiteData.decibelScore");if(r&&s.setNestedPropertyValue(t,"decibelBehavioural",r.eventName),n){var a=o.getMemoryData(i.MEMORY_DATA_FIELDS.DECIBEL_DATA);s.setNestedPropertyValue(t,"decibelScore",{eventName:n.eventName,score:a[n.eventName]})}return t}function Ge(t){var e=t||oe;Object.keys(e).forEach(function(r){var n=e[r];fi(n)&&(nt[n.eventId]=0)})}function er(t){var e=c.checkProvision(i.PROVISIONS.BACKEND_GENERATED_UUID)?t.feedbackUUID:t.feedbackCorrelationUUID;t.accountId||E.appendDefaultEventParams(t);var r=c.checkProvision(i.PROVISIONS.TARGETING_EVENTS_REPORTING),n={accountId:t.accountId,propertyId:t.websiteId,feedbackUuid:e,formId:t.formId||null,formTriggerType:o.getFormTriggerType(t.formId),mdData:t.mdData||{},userId:t.userId||null,sessionId:t.sessionId||null,cookieSize:t.cookieSize||null,sdkVersion:window.MDIGITAL.version||"0.0.0.0",historyLength:window.history.length,isUserIdentified:!!o.getMemoryData("identifierValue"),feedbackCorrelationUuid:c.checkProvision(i.PROVISIONS.BACKEND_GENERATED_UUID)?t.feedbackCorrelationUUID:null,clientEventUuid:s.kampyleCreateUUID(),deviceType:c.checkDevice()};return t.decibelBehavioural&&Object.assign(n.mdData,{decibelBehavioural:t.decibelBehavioural}),t.decibelScore&&Object.assign(n.mdData,{decibelScore:t.decibelScore}),t.formId&&(n.webFormLang=B.getFormLanguage(t.formId)||null),mi(t,n),r&&t.mdTargetingData&&(n.mdData.mdTargetingData=t.mdTargetingData),n}function mi(t,e){var r=oe[t.eventName],n=r?r.eventDataKeys:null;if(n)for(var a=0;a<n.length;a++){var l=Td[n[a]]||n[a];e[l]=t[n[a]]||null}}function Ad(t){if(!t||!window.MDIGITAL.md_tracker)return!1;var e=er(t);return k.makeAnalyticsCalls(t.eventId,e),!0}function tr(t,e){if(!t||!e)return null;var r=Object.assign({},e);for(var n in $t)r[n]=$t[n];for(var a in oe[t])r[a]=oe[t][a];var l=s.getAllKampyleData();return r.mdData={submittedDate:l.SUBMITTED_DATE,declinedDate:l.DECLINED_DATE,lastInvitationView:l.LAST_INVITATION_VIEW,mdUserPercentile:l.kampyleUserPercentile,mdInvitePresented:l.kampyleInvitePresented},pi(t,r),Si(t,r.mdData,r),r.sessionId=l.kampyleUserSession,r.cookieSize=s.getByteSize(document.cookie),r.pageURL=location.href,r.eventName=t,r}var rt=function(e,r){var n=oe[e];if(!(n&&Ei(n))||gi(n))return!1;var a=n.formatDataFunc&&typeof n.formatDataFunc=="function";a&&(r=n.formatDataFunc.call(this,r));var l=tr(e,r);k.sendDigitalAnalytics(l)};function Ei(t){var e=t.disableProvision&&c.checkProvision(t.disableProvision);return!e&&(!t.provision||!!c.checkProvision(t.provision))}function fi(t){return typeof t.rateLimit=="number"&&t.rateLimit>0}function it(t){var e=nt[t];return typeof e=="number"?e:null}function gi(t){var e=it(t.eventId);return c.checkProvision(i.PROVISIONS.ANALYTICS_EVNETS_LIMIT)&&typeof e=="number"&&e>=t.rateLimit}function _i(t){return it(t)===null?null:++nt[t]}function vd(t){if(!t||!window.MDIGITAL.md_tracker)return!1;var e=tr("neb_eventDispatcherError",t),r=er(e);return k.makeAnalyticsCalls(e.eventId,r),r}function bd(t,e){try{window.MDIGITAL.md_tracker.trackEvent(t,e),it(t)!==null&&_i(t)}catch(r){console.warn(r)}}function Dd(){try{$t={userId:s.kampyleGetUserId()};try{jt.loadBaseTracker();var t={api_host:i.PLACEHOLDERS.DEFAULT_ANALYTICS_SUBMIT_EVENTS_URL,topic:i.PLACEHOLDERS.DEFAULT_MEC_INTEGRATION_ID};window.MDIGITAL.md_tracker.init(t),jt.loadFullTracker(),c.checkProvision(i.PROVISIONS.ANALYTICS_EVNETS_LIMIT)&&(Ge(we),Ge(tt),E.subscribeOnce(i.EVENTS.MDIGITAL_SDK_PAGE_VIEW,Ge))}catch(r){console.warn(r)}if(c.checkProvision(i.PROVISIONS.ENABLE_DYNAMIC_ANALYTICS_EVENTS)){var e=JSON.parse(i.PLACEHOLDERS.DIGITAL_ANALYTICS_STATIC_EVENTS_LIST||"[]");we=Ii(we,e)}else Object.assign(oe,tt),s.initEventSubscriptions(tt,rt);return Object.assign(oe,we),s.initEventSubscriptions(we,rt),!0}catch(r){console.warn(r)}}function Ii(t,e){var r={};for(var n in t)e&&e.includes(t[n].eventId)&&(r[n]=t[n]);return r}function yd(){var t=y.getOnsiteConfiguration();if(t&&t.analyticsSubmitEventsUrl){var e={api_host:t.analyticsSubmitEventsUrl,topic:t.mecIntegrationId};window.MDIGITAL.md_tracker.set_config(e)}else console.error(new Error("No Digital analytics url was found!"))}function hd(){var t={};if(c.checkProvision(i.PROVISIONS.ENABLE_DYNAMIC_ANALYTICS_EVENTS)){var e=y.getOnsiteConfiguration(),r=e.digitalAnalyticsDynamicEventsList;Object.assign(t,ci,tt),t=Ii(t,r)}else Object.assign(t,ci);Object.assign(oe,t),Ge(t),s.initEventSubscriptions(t,rt)}function pi(t,e){e=e||{};var r=oe[t].memoryDataKey,n=o.getMemoryData(r);return n&&(e.mdData=e.mdData||{},e.mdData[r]=n),e}function Si(t,e,r){r=r||{};var n=oe[t].eventMdDataKeys;if(n)for(var a=0;a<n.length;a++){var l=n[a],d=r[l],u=Sd[l]||l;typeof u=="function"&&(u=u(d)),e[u]=d}return e}function Nd(t,e){return t&&e.isPassed}function at(t,e){t=t||{};var r=o.getFormState(t.formId);if(!r||!r.targeting)return V.error("Digital Analytics - getFormTargetingData: failed to build "+e+" phase data for form id: "+t.id),!1;var n=r.targeting[e],a={formId:t.formId,formType:t.formType,evaluationResult:n===null?!1:(n||[]).reduce(Nd,!0),conditions:n};return a}function Ti(){var t=[],e=o.getAllForms()||[];return e.forEach(function(r){t.push(at(r,i.TARGETING_PHASES.PAGE_TARGETING))}),{mdTargetingData:t}}function Ai(t){return{mdTargetingData:at(t,i.TARGETING_PHASES.BEHAVIORAL_TARGETING)}}function vi(t){var e=at(t,i.TARGETING_PHASES.QUARANTINE_TARGETING)||{};return e.userIdentifierValue=o.getMemoryData("identifierValue"),{mdTargetingData:e}}var k={getDataToSend:er,sendDigitalAnalytics:Ad,formatData:tr,appendDataByEventName:Si,appendMemoryDataByEventName:pi,addEventDataKeys:mi,makeAnalyticsCalls:bd,rateLimitCounterMap:nt,isEventProvisioned:Ei,isEventDefinedAsRateLimited:fi,getEventCallsCounter:it,isRateLimitExceeded:gi,increaseEventCallsCounter:_i,initRateLimiting:Ge,initTracker:Dd,updateTrackerAnalyticsUrl:yd,registerConfigurationDependentEvents:hd,triggerDigitalEvent:rt,triggerDigitalAnalyticsEventDispatcherError:vd,formatPageTargetingData:Ti,formatBehavioralTargetingData:Ai,formatQuarantineTargetingData:vi,getFormTargetingData:at};var H="formId",q="formTriggerType",ot="feedbackUUID",me="feedbackCorrelationUUID",rr="content",Od="isPassed",Md="targetingRule",Pd="expected",Cd="actual",nr="formLanguage",bi=function(){var e={MDigital_Form_Close_Submitted:{customEventId:"MDigital_Form_Close_Submitted",payload:[H,q]},neb_formReady:{customEventId:"MDigital_Form_Displayed",payload:[H,q]},neb_pageView:{customEventId:"MDigital_Page_View",payload:[]},MDigital_Form_Next_Page:{customEventId:"MDigital_Form_Next_Page",payload:[H,q]},MDigital_Form_Back_Page:{customEventId:"MDigital_Form_Back_Page",payload:[H,q]},MDigital_Form_Close_No_Submit:{customEventId:"MDigital_Form_Close_No_Submit",payload:[H,q]},MDigital_ThankYou_Displayed:{customEventId:"MDigital_ThankYou_Displayed",payload:[H,q]},MDigital_ThankYou_Close:{customEventId:"MDigital_ThankYou_Close",payload:[H,q].concat(c.checkProvision(i.PROVISIONS.BACKEND_GENERATED_UUID)?ot:me)},neb_feedbackSubmitted:{customEventId:"MDigital_Submit_Feedback",payload:[H,q].concat(c.checkProvision(i.PROVISIONS.BACKEND_GENERATED_UUID)?ot:me).concat(st()?nr:[]).concat(c.isContentPayloadEnabled()?rr:[])},neb_feedbackPostSubmitted:{customEventId:"MDigital_Submit_Feedback",payload:[H,q].concat(c.checkProvision(i.PROVISIONS.BACKEND_GENERATED_UUID)?ot:me).concat(st()?nr:[]).concat(c.isContentPayloadEnabled()?rr:[])},neb_inviteAccepted:{customEventId:"MDigital_Invite_Accepted",payload:[H]},neb_showInvitation:{customEventId:"MDigital_Invite_Displayed",payload:[H]},neb_inviteDeclined:{customEventId:"MDigital_Invite_Declined",payload:[H]},neb_skipInvitation:{customEventId:"MDigital_invite_Skipped",payload:[H]},neb_buttonClicked:{customEventId:"MDigital_Feedback_Button_Clicked",payload:[H,q]},neb_captureInit:{customEventId:"MDigital_CaptureButton_Clicked",payload:[H,q].concat(c.checkProvision(i.PROVISIONS.BACKEND_GENERATED_UUID)?[]:me)},neb_captureImageClicked:{customEventId:"MDigital_CaptureButton_Taken",payload:[H,q].concat(c.checkProvision(i.PROVISIONS.BACKEND_GENERATED_UUID)?[]:me)},neb_initButton:{customEventId:"MDigital_Button_Displayed",payload:[H]},MDigital_Capture_Cancelled:{customEventId:"MDigital_CaptureButton_Cancel",payload:[H,q].concat(c.checkProvision(i.PROVISIONS.BACKEND_GENERATED_UUID)?[]:me)},screenCaptureDelete:{customEventId:"MDigital_ScreenCapture_Delete",payload:[H,q].concat(c.checkProvision(i.PROVISIONS.BACKEND_GENERATED_UUID)?[]:me)},screenCaptureRetake:{customEventId:"MDigital_ScreenCapture_Retake",payload:[H,q].concat(c.checkProvision(i.PROVISIONS.BACKEND_GENERATED_UUID)?[]:me)},neb_sdkShowForm:{customEventId:"MDigital_ShowForm_Called",payload:[H,q]},MDigital_targetingRuleEvaluated:{customEventId:"MDigital_targetingRuleEvaluated",payload:[H,Od,Md,Pd,Cd,q]}},r=c.checkProvision(i.PROVISIONS.DISABLE_EXTRA_FEEDBACK_SUBMIT_EVENT)?"neb_feedbackSubmitted":"neb_submitFeedbackSuccess";return e[r]={customEventId:"MDigital_Submit_Feedback",payload:[H,q].concat(c.checkProvision(i.PROVISIONS.BACKEND_GENERATED_UUID)?ot:me).concat(st()?nr:[]).concat(c.isContentPayloadEnabled()?rr:[])},e},Rd={formId:{exposedProperty:i.EXPOSED_FEEDBACK_KEYS.FORM_ID_LABEL,manipulateValueMethod:null},formTriggerType:{exposedProperty:i.EXPOSED_FEEDBACK_KEYS.FORM_TYPE_LABEL,manipulateValueMethod:kd},feedbackCorrelationUUID:{exposedProperty:i.EXPOSED_FEEDBACK_KEYS.FEEDBACK_UUID_LABEL},feedbackUUID:{exposedProperty:i.EXPOSED_FEEDBACK_KEYS.FEEDBACK_UUID_LABEL,manipulateValueMethod:null},content:{exposedProperty:i.EXPOSED_FEEDBACK_KEYS.FEEDBACK_CONTENT_LABEL,manipulateValueMethod:null},formLanguage:{exposedProperty:i.EXPOSED_FEEDBACK_KEYS.FORM_LANGUAGE_LABEL,manipulateValueMethod:null}};function Ld(){c.checkProvision(i.PROVISIONS.DECIBEL_INSIGHT)&&(window.dxa_digital_listener_disabled=!0);var t=bi();try{return s.initEventSubscriptions(t,Di),!0}catch(e){console.warn(e)}}function Fd(t,e){var r=bi();if(!t||!e)return null;for(var n in r[t])r[t].hasOwnProperty(n)&&(e[n]=r[t][n]);return e.eventName=t,e.formTriggerType=o.getFormTriggerType(e.formId),e}function Di(t,e){var r=Fd(t,e),n=yi(r);if(n){var a=r.customEventId;s.triggerCustomEvent(a,n),c.checkProvision(i.PROVISIONS.DECIBEL_INSIGHT)&&wd(a,n),c.checkProvision(i.PROVISIONS.ENABLE_EVENTS_FOR_CE_DEBUG)&&k.triggerDigitalEvent(i.EVENTS.CUSTOM_EVENTS_DEBUG_MESSAGE,{customEventId:a,customEventData:n})}}function yi(t){var e={};if(!t||!t.payload)return null;for(var r=0;r<t.payload.length;r++){var n=t.payload[r],a=s.getNestedPropertyValue(t,n),l;a!=null&&(l=Rd[n],l&&l.exposedProperty?e[l.exposedProperty]=l.manipulateValueMethod?l.manipulateValueMethod.apply(this,[a]):a:e[n]=a)}return e}function kd(t){return i.FORM_TRIGGER_TYPES_MAP[t]||i.CUSTOM_EVENT_OTHER}function st(){return c.checkProvision(i.PROVISIONS.EXPOSE_SELECTION_QUESTIONS)||c.checkProvision(i.PROVISIONS.EXPOSE_VERBATIM_QUESTIONS)}function wd(t,e){function r(){window.dxa_digital_integration&&dxa_digital_integration(t,e)}typeof window.decibelInsight=="function"?window.decibelInsight("ready",r):(window._da_readyArray=window._da_readyArray||[],window._da_readyArray.push(r))}var lt={init:Ld,triggerCustomEvent:Di,getCustomEventDataToSend:yi,isExposeFormLanguageAllowed:st};var hi="onUsersnapLoad",Gd="scroll",Y,Ee=!1,Ud='[data-tips]{position:relative;text-decoration:none}[data-tips]:after,[data-tips]:before{position:absolute;z-index:100;opacity:0}[data-tips]:after{content:attr(data-tips);line-height:20px;padding:0 10px;font-size:12px;text-align:center;color:#fff;background:#222;border-radius:5px;text-shadow:0 0 5px #000;-moz-box-shadow:0 0 5px rgba(0, 0, 0, .3);-webkit-box-shadow:0 0 5px rgba(0, 0, 0, .3);box-shadow:0 0 5px rgba(0, 0, 0, .3);white-space:normal;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;width:135px;word-wrap:break-word}[data-tips]:before{content:"";width:0;height:0;border-width:6px;border-style:solid}[data-tips]:hover:after,[data-tips]:hover:before{opacity:1}[data-tips].top-tip:after,[data-tips].top-tip:before{-webkit-transition:bottom .25s ease-in-out, opacity .25s ease-in-out;-moz-transition:bottom .25s ease-in-out, opacity .25s ease-in-out;transition:bottom .25s ease-in-out, opacity .25s ease-in-out;bottom:90%;left:-9999px;margin-bottom:12px}[data-tips].top-tip:before{border-color:#222 transparent transparent;margin-bottom:0}[data-tips].top-tip:hover:after,[data-tips].top-tip:hover:before{bottom:100%;left:0}[data-tips].top-tip:hover:before{left:15px}[data-tips].bottom-tip:after,[data-tips].bottom-tip:before{-webkit-transition:top .25s ease-in-out, opacity .25s ease-in-out;-moz-transition:top .25s ease-in-out, opacity .25s ease-in-out;transition:top .25s ease-in-out, opacity .25s ease-in-out;top:90%;left:-9999px;margin-top:12px}[data-tips].bottom-tip:before{border-color:transparent transparent #222;margin-top:0}[data-tips].bottom-tip:hover:after,[data-tips].bottom-tip:hover:before{top:100%;left:0}[data-tips].bottom-tip:hover:before{left:15px}[data-tips].left-tip:after,[data-tips].left-tip:before{-webkit-transition:left .25s ease-in-out, opacity .25s ease-in-out;-moz-transition:left .25s ease-in-out, opacity .25s ease-in-out;transition:left .25s ease-in-out, opacity .25s ease-in-out;top:-9999px;left:96%;margin-left:12px}[data-tips].left-tip:before{border-color:transparent #222 transparent transparent;margin-left:0}[data-tips].left-tip:hover:after,[data-tips].left-tip:hover:before{left:100%;top:0}[data-tips].left-tip:hover:before{top:7px}[data-tips].right-tip:after,[data-tips].right-tip:before{-webkit-transition:right .25s ease-in-out, opacity .25s ease-in-out;-moz-transition:right .25s ease-in-out, opacity .25s ease-in-out;transition:right .25s ease-in-out, opacity .25s ease-in-out;top:-9999px;right:96%;margin-right:12px}[data-tips].right-tip:before{border-color:transparent transparent transparent #222;margin-right:0}[data-tips].right-tip:hover:after,[data-tips].right-tip:hover:before{right:100%;top:0}[data-tips].right-tip:hover:before{top:7px}',xd=".scTitle:focus, .scParagraph:focus, .sc-widget-footer-cancel:focus, .sc-widget-footer-capture:focus, p:focus { border: 2px solid #8e8e93 !important; box-shadow: 0 0 7px #8e8e93 !important;}",ir={submitScreenCaptureLabel:"Capture Image",cancelScreenCaptureLabel:"Cancel",instructionsScreenCapture:'<h2 class="scTitle" style="font-size: 1.5em;">Screen Capture</h2><p class="scParagraph" style="font-size: 1em; margin-top: 10px;">Drag the cursor around the area you want to highlight.<br>Press Capture Image to take the snapshot and return to your feedback</p>',submitScreenCaptureTooltip:"Take snapshot",cancelScreenCaptureTooltip:"Back to Feedback"},Bd=function(){var e=Z.getSpinnerTemplate();return["<html>","<head>",'<link rel="stylesheet" type="text/css" href="'+i.PLACEHOLDERS.URL_PREFIX+i.SRC.OPEN_SANS+'" />','<script type="text/javascript">',"function resizeIframe() {",'parent.document.getElementById("nebScIframe").height = document.getElementById("sc-widget").scrollHeight + 15;','var SCWidget = parent.document.getElementById("nebScIframe");',"if (SCWidget) {","SCWidget.focus();","}","}","<\/script>","<style>{tooltipStyles} {buttonsOutlineStyle}</style>","</head>",'<body onload="resizeIframe();" style="margin:0px;overflow:hidden;">','<div id="sc-widget" class="sc-widget" style="{widget}">','<div class="sc-widget-content" style="{widgetContent}">',"{{instructionsScreenCapture}}","</div>",'<div class="sc-widget-footer" style="{widgetFooter}">','<button onclick="parent.KAMPYLE_SCREEN_CAPTURE.onCancelScreenCaptureClick();" class="sc-widget-footer-cancel top-tip" data-tips="{{cancelScreenCaptureTooltip}}" style="{widgetFooterBtn} {widgetFooterCancel}">',"{{cancelScreenCaptureLabel}}","</button>",'<button onclick="parent.KAMPYLE_SCREEN_CAPTURE.onSubmitScreenCaptureClick();" class="sc-widget-footer-capture top-tip" data-tips="{{submitScreenCaptureTooltip}}" style="{widgetFooterBtn} {widgetFooterCapture}">',e,'<span id="widgetFooterCaptureText">{{submitScreenCaptureLabel}}</span>',"</button>","</div>","</div>","</body></html>"].join(" ")},Ni={overlay:{position:"fixed",top:"0",left:"0","z-index":"2147483646 !important",right:"0",bottom:"0",display:"block","pointer-events":"none"},widget:{"font-family":"'Open Sans'",border:"1px solid #999",width:"285px","border-radius":"5px",position:"absolute","z-index":"2147483647 !important","pointer-events":"auto",background:"#FFFFFF","text-align":"center","line-height":"20px"},widgetContent:{padding:"10px 14px",outline:"none"},widgetFooter:{"font-family":"'Open Sans' !important",padding:"10px","font-size":"14px","padding-top":"0","font-stretch":"normal","font-style":"normal","font-variant":"normal","font-weight":"normal","letter-spacing":"normal","line-height":"20px"},widgetFooterBtn:{height:"34px",margin:"0 0 2px 5px","min-width":"100px",padding:"6px 12px",display:"inline-block","border-radius":"4px",cursor:"pointer","transition-delay":"0s","transition-duration":"0.3s","transition-property":"all","transition-timing-function":"ease","vertical-align":"middle","white-space":"nowrap","word-spacing":"0px",border:"none",color:"#FFF"},widgetFooterCancel:{background:"#A2A2A2",color:"#FFF"},widgetFooterCapture:{"margin-left":"5px",background:"#020202",color:"#FFF"}},Oi=function(){this.init=function(){this.determineWidgetVersion()},this.determineWidgetVersion=function(){this._usersnapOnpremWidgetLoaderPath=s.getNestedPropertyValue(y.getOnsiteConfiguration(),"usersnapOnpremWidgetLoaderPath")},this.close=function(){window.UserSnap.api.close()},this.getUrl=function(){return i.PLACEHOLDERS.USERSNAP_ONPREM_HOST_PREFIX+this._usersnapOnpremWidgetLoaderPath},this.initConfiguration=function(){window.usersnapConfig={cdnUrl:i.PLACEHOLDERS.USERSNAP_ONPREM_HOST_PREFIX+this._usersnapOnpremWidgetLoaderPath.slice(0,this._usersnapOnpremWidgetLoaderPath.lastIndexOf("/")),onLoadCallbackName:hi},window[hi]=Hd()},this.getContainer=function(){return document.getElementsByName("us-entrypoint-widgetApp")[0]},this.initWidget=function(){window.UserSnap.api.open()}},Vd=function(){var e=document.getElementById("nebScIframe");if(e&&e.contentDocument){var r=e.contentDocument.getElementById(i.SPINNER_SETTINGS.CONTAINER_ID);if(r){r.style.display="none";var n=e.contentDocument.getElementById("widgetFooterCaptureText");n&&(n.style.display="inline")}}},ar=function(){Y.canceledClicked=!0,Ee.close()};function Mi(){var t=document.getElementById("us_sandbox");t&&(t.style.display="none");var e=document.getElementById("nebScIframe");e&&e.parentNode.removeChild(e)}function Pi(){if(Y&&!Y.canceledClicked){Vd(),Mi();var t={formId:Y.formId,feedbackCorrelationUUID:Y.feedbackCorrelationUUID};E.trigger("neb_captureImageClicked",t),s.sendMessageToIframe(o.getFormIframeId(Y.formId),{action:"takenScreenCapture",data:t})}Ee.close()}function Hd(){return function(t){t.on("open",function(r){var n={uuid:Y.feedbackCorrelationUUID,websiteId:Y.websiteId};sr(Y)&&(n.screenCaptureUuid=Y.screenCaptureUuid),Object.assign(n,{screenWidth:window.innerWidth,screenHeight:window.innerHeight}),r.api.setValue("custom",n)}),t.on("opened",function(){Ci()}),t.on("submit",function(){Pi()}),t.on("close",function(){var r=o.getMemoryData("overFlowType");or(Y,r),Y.canceledClicked&&Li()}),t.on("domSelector:selected",function(){lr(),t.submit()});var e={serviceUrl:i.PLACEHOLDERS.USERSNAP_ONPREM_HOST_PREFIX,mode:"headless",button:null,tools:{keys:["highlight"],colors:[i.COLORS.USERSNAP_V4_SELECTION_COLOR]},thankYou:{isHidden:!0},iframeTitle:i.IFRAME_SETTINGS.USERSNAP_V4_IFRAME_TITLE};e.tools.keys[0]=Fi(),e.tools.colors[0]=i.COLORS.USERSNAP_ONPREM_SELECTION_COLOR,e.apiKey=s.getNestedPropertyValue(y.getOnsiteConfiguration(),"usersnapEnvId"),t.init(e),window.UserSnap={api:t}}}function Yd(t){Y={},Ee=new Oi,Ee.init(),Ee.initConfiguration(),Kd(),s.objectPropertyObserver(window,"UserSnap",t),E.subscribeMany({neb_captureInit:[Ri],neb_cancelCaptureClicked:[ar]})}function dt(t){t&&t.contentDocument&&t.contentDocument.body.addEventListener("keydown",function(e){e.key==="Escape"&&ar()})}function Ci(){var t=Ee.getContainer();s.setElementStyle(t,{display:"block",zIndex:"2147483646"},!0);var e=t&&t.getElementsByTagName&&t.getElementsByTagName("iframe"),r=e&&e[0];r?(s.setElementStyle(r,{display:"block"},!0),dt(r)):dt(t);var n=s.getNestedPropertyValue(document,"body.style.overflow");o.setMemoryData("overFlowType",n),or(Y,Gd),Ui(Y,t)}function Wd(t){var e=document.body;e&&s.setElementStyle(e,{overflow:t})}function or(t,e){var r=o.getFormData(t.formId),n=o.getDisplayType(r),a=ne.getSelectedTool();n===i.DISPLAY_TYPES.LIGHTBOX&&a===i.SCREEN_CAPTURE.DOM_SELECTION_VALUE&&ne.setBodyOverflowType(e)}function Ri(t,e){e=e||{},Y.feedbackCorrelationUUID=e.feedbackCorrelationUUID,sr(e)&&(Y.screenCaptureUuid=e.screenCaptureUuid),o.setMemoryData(i.MEMORY_DATA_FIELDS.FEEDBACK_CORRELATION_UUID,Y.feedbackCorrelationUUID),Y.websiteId=e.websiteId,Y.accountId=e.accountId,Y.formId=e.formId,Y.screenCaptureSettings=e.screenCaptureSettings,Y.canceledClicked=!1,Ee.initWidget()}function Li(){ne.closeScreenCaptureWidget();var t=o.getMemoryData("currentFormId");E.trigger("MDigital_Capture_Cancelled",{formId:t,feedbackCorrelationUUID:o.getMemoryData(i.MEMORY_DATA_FIELDS.FEEDBACK_CORRELATION_UUID)});var e=o.getFormData(t);s.sendMessageToIframe(o.getFormIframeId(t),{action:"cancelScreenCapture",data:e})}function Kd(){var t="kampyleSceenCaptureScript";if(document.getElementById(t))return!1;var e=document.createElement("script");Object.assign(e,{id:t,type:"text/javascript",src:Ee.getUrl()}),document.body.appendChild(e)}function sr(t){var e=s.getNestedPropertyValue(t,"screenCaptureSettings.screenCaptureAsComponentEnabled");return c.checkProvision(i.PROVISIONS.USER_SNAP_AS_COMPONENT)&&e}function Fi(){var t=y.getOnsiteConfiguration();return t.screenCaptureSelectionTool===i.SCREEN_CAPTURE.DOM_SELECTION?i.SCREEN_CAPTURE.DOM_SELECTION_VALUE:i.SCREEN_CAPTURE.AREA_SELECTION_VALUE}function Xd(){return Ee}function ki(t){var e=Ni;return t&&(e.widget.background=t.backgroundColor?t.backgroundColor:e.widget.background,e.widgetFooterCapture.background=t.submitButtoncolor?t.submitButtoncolor:e.widgetFooterCapture.background,e.widgetFooterCancel.background=t.closeButtoncolor?t.closeButtoncolor:e.widgetFooterCancel.background,e.widgetFooterCancel.color=t.closeButtonTextColor?t.closeButtonTextColor:e.widgetFooterBtn.color,e.widgetFooterCapture.color=t.submitButtonTextColor?t.submitButtonTextColor:e.widgetFooterBtn.color),e}function wi(t){var e=ir;if(t){for(var r in e)t.hasOwnProperty(r)&&e.hasOwnProperty(r)&&(e[r]=t[r]);return e}}function lr(){var t=document.getElementById("nebScIframe").contentDocument,e=t.getElementById(i.SPINNER_SETTINGS.CONTAINER_ID);if(e){s.setSpinnerStyle(e,i.SPINNER_SETTINGS.SIZE.SMALL,t);var r=t.getElementById("widgetFooterCaptureText");r&&(r.style.display="none")}}function zd(t){var e=o.getFormData(t);if(!e)return!1;var r=o.getDisplayType(e);return!!r&&r!=="popup"}function Gi(t){t=t||{};var e=Bd(),r=wi(t.screenCaptureSettings);(!r||!r.submitScreenCaptureTooltip)&&(e=e.replace('data-tips="{{submitScreenCaptureTooltip}}"',"")),(!r||!r.cancelScreenCaptureTooltip)&&(e=e.replace('data-tips="{{cancelScreenCaptureTooltip}}"',""));for(var n in r)ir.hasOwnProperty(n)&&(e=e.replace("{{"+n+"}}",ir[n]));var a=ki(t.screenCaptureSettings);for(var l in a)e=s.replaceAll(e,"{"+l+"}",s.styleObjToInline(Ni[l]));return e=e.replace("{tooltipStyles}",Ud).replace("{buttonsOutlineStyle}",xd),s.htmlDecode(e)}function Ui(t,e){if(c.checkProvision(i.PROVISIONS.CSP_RULES))ne.createScreenCaptureInstructionWidget(t,e);else{var r=Gi(t),n=document.createElement("iframe");return n.addEventListener("load",function(){dt(n)}),n.id="nebScIframe",s.setElementStyle(n,{width:"310px",bottom:"20px",left:"20px",zIndex:2147483647,position:"fixed"}),s.setElementStyle(n,{display:"block"},!0),n.frameBorder="0",n.sandbox="allow-top-navigation allow-same-origin allow-scripts",e?e.parentNode.insertBefore(n,e):document.body.appendChild(n),n.contentWindow&&(n.contentWindow.contents=r),n.src='javascript:window["contents"]',setTimeout(function(){document.activeElement.blur()},100),!0}}function xi(){E.trigger("neb_cancelCaptureClicked",{formId:o.getMemoryData("currentFormId"),feedbackCorrelationUUID:o.getMemoryData(i.MEMORY_DATA_FIELDS.FEEDBACK_CORRELATION_UUID)})}function Bi(){lr(),window.UserSnap.api.submit()}function qd(){var t=document.createElement("head"),e=document.createElement("link");return e.rel="stylesheet",e.type="text/css",e.href=i.PLACEHOLDERS.URL_PREFIX+i.SRC.OPEN_SANS,t.appendChild(e),t}function Jd(t){return t.screenCaptureSettings?t.screenCaptureSettings.bodyInstructionsScreenCapture||t.screenCaptureSettings.instructionsScreenCapture||i.TEXTS.SCREEN_CAPTURE.DEFAULT_DESCRIPTION:i.TEXTS.SCREEN_CAPTURE.DEFAULT_DESCRIPTION}function Zd(t,e){var r=document.createElement("div");r.className="sc-widget-footer",s.setElementStyle(r,{"font-family":"'Open Sans'",padding:"10px","font-size":"14px","padding-top":"0","font-stretch":"normal","font-style":"normal","font-variant":"normal","font-weight":"normal","letter-spacing":"normal","line-height":"20px"});var n=document.createElement("button");n.className="sc-widget-footer-cancel top-tip",s.addAttributesOnElement(n,{class:"sc-widget-footer-cancel top-tip",title:t.cancelScreenCaptureTooltip}),n.addEventListener("click",function(){xi()}),s.setElementStyle(n,Object.assign({outline:"none"},e.widgetFooterCancel,e.widgetFooterBtn));var a=document.createTextNode(t.cancelScreenCaptureLabel);n.appendChild(a);var l=document.createElement("button");s.addAttributesOnElement(l,{class:"sc-widget-footer-capture top-tip",title:t.submitScreenCaptureTooltip}),l.addEventListener("click",Bi),s.setElementStyle(l,Object.assign({outline:"none"},e.widgetFooterCapture,e.widgetFooterBtn));var d=$.createSpinnerElement(),u=document.createElement("span");return u.id="widgetFooterCaptureText",u.appendChild(document.createTextNode(t.submitScreenCaptureLabel)),l.appendChild(d),l.appendChild(u),r.appendChild(n),r.appendChild(l),r}function Qd(t,e){var r=document.createElement("iframe");r.id="nebScIframe",s.setElementStyle(r,{width:"310px",bottom:"20px",left:"20px",zIndex:2147483647,position:"fixed"}),s.setElementStyle(r,{display:"block"},!0),r.frameBorder="0",r.sandbox="allow-top-navigation allow-same-origin allow-scripts",e?e.parentNode.insertBefore(r,e):document.body.appendChild(r);var n=r.contentDocument||r.contentWindow.document;return n.open(),n.write("<html><head></head><body></body></html>"),n.close(),n.replaceChild(t,n.getElementsByTagName("html")[0]),r.height=n.getElementById("sc-widget")&&n.getElementById("sc-widget").scrollHeight+20,setTimeout(function(){document.activeElement.blur()},100),!0}function Vi(t,e,r){var n=document.createElement("body");s.setElementStyle(n,{margin:"0px",overflow:"hidden"});var a=document.createElement("div");a.id="sc-widget",a.className="sc-widget",s.setElementStyle(a,r.widget),s.setElementStyle(a,{zIndex:"2147483646"});var l=document.createElement("div");l.className="sc-widget-content",s.setElementStyle(l,r.widgetContent),s.setElementStyle(l,{fontFamily:"Open Sans"},!0);var d=document.createElement("h2");d.className="scTitle",d.style.fontSize="16px";var u=t.screenCaptureSettings&&t.screenCaptureSettings.titleInstructionsScreenCapture?t.screenCaptureSettings.titleInstructionsScreenCapture:i.TEXTS.SCREEN_CAPTURE.DEFAULT_TITLE,m=document.createTextNode(u);d.appendChild(m);var f=document.createElement("p");f.className="scParagraph",s.setElementStyle(f,{fontSize:"12px",marginTop:"10px"});var _=Jd(t),A=document.createTextNode(_);return f.appendChild(A),l.appendChild(d),l.appendChild(f),a.appendChild(l),a.appendChild(e),n.appendChild(a),n}function jd(t,e){var r=document.createElement("html");return r.appendChild(t),r.appendChild(e),r}function $d(t,e){var r=ne.overrideDefaultScreenCaptureTexts(t.screenCaptureSettings)||{},n=ne.overrideDefaultScreenCaptureStyles(t.screenCaptureSettings)||{},a=qd(),l=Zd(r,n),d=Vi(t,l,n),u=jd(a,d);Qd(u,e)}var ne={initScreenCaptureWidget:Ri,handleCaptureCancellation:Li,closeScreenCaptureWidget:Mi,beforeOpen:Ci,UserSnapModel:Oi,shouldProcessScreenCaptureAsComponent:sr,overrideDefaultScreenCaptureTexts:wi,overrideDefaultScreenCaptureStyles:ki,formatScreenCaptureWidget:Gi,getSelectedTool:Fi,handleScrollIfNeeded:or,setBodyOverflowType:Wd,cancelCaptureClicked:ar,afterSend:Pi,getUserSnapInstance:Xd,init:Yd,addEscKeyDownListenerToIframe:dt,createScreenCaptureWidget:Ui,isScreenCaptureEnabled:zd,onCancelScreenCaptureClick:xi,onSubmitScreenCaptureClick:Bi,showScreenCaptureSpinner:lr,createScreenCaptureInstructionWidget:$d,createScreenCaptureBody:Vi};function eu(){z.init(),tu(),v.init(),De.init(),c.checkProvision(i.PROVISIONS.NEW_MODAL_DIALOGS)?window.MDIGITAL.MODAL_DIALOGS&&window.MDIGITAL.MODAL_DIALOGS.init():c.checkProvision(i.PROVISIONS.WCAG_TRAP_FOCUS_IN_MODAL)&&window.MDIGITAL.WCAG&&window.MDIGITAL.WCAG.init(),L.init(),be.init(),ae.init();var t=y.getOnsiteConfiguration()||{};t=Xi(t),c.checkProvision(i.PROVISIONS.ON_PREM_HYBRID)&&(t.formNodes.forEach(Ae.replaceFormNodeUrls),t.globalResourcesUrl=Ae.replaceOnPremPrefixes(t.globalResourcesUrl)),o.setMemoryData(i.MEMORY_DATA_FIELDS.DATA_JSON,t);var e=s.getUrlParam("nebContext")||window.MDIGITAL.nebContext||"live";if(o.setMemoryData("context",e),o.setMemoryData("kampyleDevice",gr()),o.setMemoryData("hostedViewportContent",[]),o.setMemoryData("isGuest",!0),o.getMemoryData("context"),ve.init(),lt.init(),ea(),ji(),Ji(),s.setEventHandler(window,"hashchange",hu),c.checkProvision(i.PROVISIONS.SPA_URL_POLLING)){o.setMemoryData("currentUrl",window.location.href);var r=setInterval(function(){window.location.href!==o.getMemoryData("currentUrl")&&(o.setMemoryData("currentUrl",window.location.href),KAMPYLE_ONSITE_SDK.updatePageView())},500)}}function Xi(t){t.formNodes=t.formNodes||[];for(var e,r=t.formNodes.length-1;r>=0;r--)e=t.formNodes[r],(!e.formHeight||e.formHeight==="null")&&(e.formHeight=i.FORM_HEIGHT),(!e.formWidth||e.formWidth==="null")&&(e.formWidth=i.FORM_WIDTH);return t}function tu(){var t={neb_inviteReady:[ra],neb_buttonClicked:[Hi],neb_inviteAccepted:[Hi],neb_showInvitation:[Ia],neb_sdkPageView:[Ue,o.initOnsiteDefaultState,o.resetAllFormsLanguagesCode]};E.subscribeMany(t)}function Hi(t,e){var r=o.getFormState(e.formId);!r.loaded&&!r.loading&&E.trigger("neb_loadForm",{formId:e.formId})}function zi(t,e){var r=(e||{}).formIds||[];r.forEach(function(n){Z.loadForm(n)})}function qi(t,e){if(e=e||{},Z.closeForm(e.sourceFormId),!Z.showForm(e.formId))throw new Error("Form cannot be loaded")}function ru(){if(!c.checkProvision(i.PROVISIONS.NEW_MODAL_DIALOGS)){var t=document.querySelector("#kampyleInvite");t&&typeof t.focus=="function"&&t.focus()}}function Et(t,e){e=e||{};var r=(o.getFormState(e.formId)||{}).inviteShown;r&&z.isInviteLoaded(e.formId)&&gt(e.formId,!0)&&!xe()?(v.showInvite("",{formId:e.formId}),E.trigger("neb_inviteReady",e),o.setMemoryData("inviteLoadedAndShown",!0)):(ft(e.formId,!0)||xe())&&o.setFormState(e.formId,{inviteShown:!1})}function Ji(){var t={neb_inviteDeclined:["neb_displayClosed"],neb_formClosed:["neb_displayClosed"]};E.subscribeMany(t)}function nu(t){var e=o.isSkipInvitation(t)&&xe(t),r=z.isFormShown(t);return e&&(E.trigger("neb_formReady",{formId:t}),o.setFormState(t,{shouldBeShown:!1}),E.trigger("neb_skipShowingForm",{formId:t})),e||r}function ft(t,e){var r=o.getMemoryJsonKey(t,e),n=o.getMemoryData(r),a=o.getFormState(t);return n===!1||!e&&a&&a.loaded===!1||e&&a&&a.inviteLoaded===!1}function gt(t,e){var r=o.getMemoryJsonKey(t,e);return!c.checkProvision(i.PROVISIONS.FORM_TEMPLATE_DATA_SEPERATION)||o.getMemoryData(r)}function iu(t,e,r){var n=i.MEMORY_DATA_FIELDS.FETCHING_DATA_IN_PROGRESS+t+"_"+r,a=o.getMemoryData(n),l=c.checkProvision(i.PROVISIONS.FORM_TEMPLATE_DATA_SEPERATION);return!l||gt(t,!1)||ft(t,e)||a}function au(t,e){if(e.failureCause===i.FORM_LOADING_FAILURE_CAUSE.APPLICATION_FAILED){var r=o.getFormData(e.formId),n=o.getDisplayType(r),a=o.getFormState(e.formId),l={errorData:{formId:e.formId,displayType:n,formState:a}};E.trigger(i.EVENTS.MDIGITAL_COULD_NOT_LOAD_FORM_APPLICATION,l)}setTimeout(function(){o.setFormState(e.formId,{shouldBeShown:!1,loaded:!1})},0)}function Zi(t){var e=o.getFormData(t),r=o.getDisplayType(e);return z.isFormLoaded(t)}function ou(t){var e=o.getMemoryJsonKey(t,!0),r=o.getMemoryData(e);o.setMemoryData("inviteVersion",r&&r.mobileDesign?1:-1)}function dr(t,e){var r=t==="neb_loadInvitation",n=o.getMemoryData(i.LANG_MEMORY_DATA_KEY_PREFIX+e.formId),a=i.MEMORY_DATA_FIELDS.FETCHING_DATA_IN_PROGRESS+e.formId;a=a+"_"+n,r&&(a=a+"_invite"),!c.shouldSkipFetchingFormData(e.formId,r,n)&&(o.setMemoryData(a,!0),o.fetchFormJsonData({formId:e.formId,isInvite:r,fetchingDataInProgressKey:a,callback:function(){r?(v.updateInviteIframeTitle("",e),ou(e.formId),Et("",e)):_t(e)},onError:su.bind(null,e,r)}))}function Qi(t){var e=o.isPopupDisplayType(t.formId),r=Zi(t.formId)&&gt(t.formId,!1),n=z.shouldFormBeShown(t.formId)&&!nu(t.formId);return(r||e)&&n}function su(t,e,r){var n=o.getMemoryJsonKey(t.formId,e);o.setMemoryData(n,!1),e||E.trigger(i.EVENTS.NEB_FORM_LOADING_HAS_FAILED,{formId:t.formId,failureCause:i.FORM_LOADING_FAILURE_CAUSE.JSON_FAILED});var a={errorData:{formId:t.formId,isInvite:e,errorDetails:r}};E.trigger(i.EVENTS.MDIGITAL_COULD_NOT_FETCH_DATA,a)}function _t(t){var e=o.isPopupDisplayType(t.formId),r=z.isFormShown(t.formId),n=Qi(t),a=e&&r||!e&&n;n?(E.trigger("neb_showForm",{formId:t.formId}),o.setFormState(t.formId,{shown:!0,isCurrentlySubmitted:!1})):ft(t.formId,!1)&&E.trigger(i.EVENTS.NEB_FORM_LOADING_HAS_FAILED,{formId:t.formId}),a&&E.trigger("neb_formReady",{formId:t.formId})}function ji(){var t={neb_pageView:[sa],neb_showInvitation:[Ue,s.setCurrentScrollPosition,ct,ru,Et],neb_buttonClicked:[s.setCurrentScrollPosition,ct,ut],neb_sdkShowForm:[s.setCurrentScrollPosition,ct,ut],neb_skipInvitation:[s.setCurrentScrollPosition,ct,ut],neb_inviteLoaded:[Ue,ta],neb_inviteAccepted:[Ue,s.setCurrentScrollPosition,ut],neb_inviteDeclined:[Ue,la,s.handleAfterFormPosition],neb_formClosed:[cr,s.handleAfterFormPosition],neb_popupBlocked:[cr,s.handleAfterFormPosition],neb_loadForm:[dr,du],neb_loadInvitation:[dr],neb_formLoaded:[Su],neb_loadMultipileForms:[zi],neb_routeToForm:[qi],neb_formReady:[ma,fa,da],neb_feedbackSubmitted:[mt],neb_feedbackPostSubmitted:[mt],neb_submitFeedbackFailed:[mt],neb_sdkPageView:[oa],neb_screenCaptureLoaded:[Au],neb_formLoadingHasFailed:[au]};E.subscribeMany(t)}function $i(t){var e={neb_buttonClicked:"Button",neb_sdkShowForm:"ByCode",neb_routeToForm:"ByCode",neb_skipInvitation:"Invitation",neb_inviteAccepted:"Invitation"};return e[t]||null}function ut(t,e){e=e||{},e.triggerType=e.triggerType||$i(t),o.saveFormExtraData(e.formId,{triggerType:e.triggerType}),o.setMemoryData("currentFormId",e.formId),o.setMemoryData("formIsShown",!0),o.setFormState(e.formId,{shouldBeShown:!0,triggerType:e.triggerType}),_t(e)}function ea(){var t=c.isReferrerDifferentThanHost(),e=o.getData("kampyleUserSession"),r=!1;try{r=document.referrer===""||window.parent.document.referrer===""}catch(l){var n={errorMessage:l.message,errorStack:l.stack,additionalInfo:"createSession- failed to access document.referrer, probably CORS problem when the customer's iframe is hosted in a website with different domain."};t=!1,k.triggerDigitalEvent(i.MDIGITAL_WARNING,n)}finally{if(!e||r||t){var a={user_session:e,direct_navigation:r,different_referrer:t};c.checkProvision(i.PROVISIONS.CREATE_SESSION)&&k.triggerDigitalEvent("MDigital_createSession",{additionalData:a}),o.setMemoryData("isSyncedIdentifierData",!1),o.setData("kampyleUserSession",s.getCurrentTimestamp()),o.setData("kampyleSessionPageCounter",0),yu(),o.deleteData("kampyleUserPercentile"),o.deleteData("kampyleInvitePresented"),o.deleteData(i.SESSION_DATA_FIELDS.IS_SURVEY_SUBMITTED_IN_SESSION),ua(i.PROVISIONS.DISABLE_USER_PERCENTILE_AT_CREATE_SESSION)||L.setUserPercentile(),c.checkProvision(i.PROVISIONS.ENABLE_ANALYTICS_SESSION_EVENTS)&&k.triggerDigitalEvent("neb_sessionStart",{additionalData:a}),c.checkProvision(i.PROVISIONS.PARALLEL_TAB_SOLUTION)&&o.clearSessionTabs()}}}function lu(){var t=document.referrer.match(/:\/\/(.[^/]+)/);if(!t)return!0;if(t=t[1],t===window.location.host)return!1;var e=o.getPropertySharedSubdomain();return e?!s.isHostMatchesSubdomain(t,e)||!s.isHostMatchesSubdomain(window.location.host,e):!0}function ta(t,e){if(e=e||{},!o.getMemoryData("inviteVersion")){var r=s.getNestedPropertyValue(e,"inviteVersion");o.setMemoryData("inviteVersion",r)}var n=o.getFormState(e.formId)||{};n.inviteShown&&Et("",e)}function du(t,e){e=e||{},o.setFormState(e.formId,{loading:!0}),E.trigger("neb_form_loaded",{formId:e.formId})}function ra(t,e){if(e=e||{},!o.getFormState(e.formId).inviteLoaded)return!1;s.sendMessageToIframe("kampyleInvite",{action:"inviteShown"});var r={accountId:e.accountId,websiteId:e.websiteId,environment:e.enviroment,url:document.location.href,kampyle_version:window.MDIGITAL.version||"0.0.0.0",formId:e.formId,cookie_size:s.getByteSize(document.cookie),isWCAG:o.isFeatureEnabled("WCAG"),deviceType:gr(),provisions:fr(),position:v.getInvitePosition(e.formId),customCssUpload:o.isFeatureEnabled(i.PROPERTY_SETTINGS.CUSTOM_CSS_UPLOAD)};if(c.checkProvision(i.PROVISIONS.FORM_TEMPLATE_DATA_SEPERATION)){var n=function(d){var u=o.getFormData(e.formId),m=y.getOnsiteConfiguration(),f={submitUrlPrefix:m.submitUrlPrefix,submitUrlSuffix:m.submitUrlSuffix,globalResourcesUrl:m.globalResourcesUrl,versionedResourcesUrl:u.versionedResourcesUrl};r=Object.assign({},r,{inviteData:d},f),r.formLanguage=B.getFormLanguage(e.formId)||null,s.sendMessageToIframe("kampyleInvite",{action:"setExtraData",data:r})},a=function(d){console.error(d)};o.fetchFormJsonData({formId:e.formId,callback:n,onError:a,isInvite:!0},!0)}else s.sendMessageToIframe("kampyleInvite",{action:"setExtraData",data:r})}function Ue(t,e){switch(s.sendMessageToIframe("kampyleInvite",{action:i.EVENTS.MDIGITAL_VALIDATE_ORIGIN}),e=e||{},e.formId=e.formId||o.getMemoryData("currentFormId"),t){case"neb_showInvitation":o.setFormState(e.formId,{inviteShown:!0});break;case"neb_inviteDeclined":case"neb_inviteAccepted":o.setFormState(e.formId,{inviteShown:!1});break;case"neb_inviteLoaded":o.setFormState(e.formId,{inviteLoaded:!0});break;case"neb_sdkPageView":o.setFormState(e.formId,{inviteLoaded:null,inviteShown:!1});break;default:s.showWarning("Unhandled event name "+t)}}function na(t){var e=t.formId,r,n;t&&(r=parseInt(t.formWidth,10),n=parseInt(t.formHeight,10));var a=document.documentElement.clientWidth,l=document.documentElement.clientHeight,d={overflowY:"auto",height:"100%"};s.setElementStyle(document.getElementById("innerContainer"),d);var u={border:0,position:"relative",margin:"50px auto 50px",height:n+"px",width:r+"px"};a>r&&l>n&&(o.isCustomHtmlAndFixedSizeForm(e)?u={position:"absolute",top:"50%","margin-top":-n/2+"px",left:"50%","margin-left":-r/2+"px",height:n+"px",width:r+"px"}:u={position:"fixed",height:"100%",width:"100%"});var m=document.getElementById("kampyleFormModal");m&&m.style&&m.removeAttribute&&(m.removeAttribute("style"),s.setElementStyle(m,u))}function uu(){var t=450,e=450,r=s.getUrlParam("url"),n;if(o.getMemoryData("kampyleDevice")===i.DEVICES.MOBILE)e="100%",t="100%";else{var a=s.getUrlParam("height"),l=s.getUrlParam("width");a&&!isNaN(a)&&(t=a),l&&!isNaN(l)&&(e=l)}if(r&&s.validateKampyleDomain(decodeURIComponent(r))){r=decodeURIComponent(r),r+="?region="+o.getMemoryData("region");var d=s.getUrlParam("formId");d?(r+="&formId="+d,o.setMemoryData("currentFormId",d)):(n=location.protocol+"//"+location.host,window.location=n+"/#/error/404");var u=decodeURIComponent(window.getUrlParam("provisions"));u&&(r+="&provisions="+encodeURIComponent(u));var m=decodeURIComponent(window.getUrlParam("websiteId"));m&&(r+="&websiteId="+encodeURIComponent(m));var f=s.getUrlParam("type")||"direct",_=["live","direct","preview"];_.indexOf(f.toLowerCase())===-1&&(f="direct"),r+="&type="+f;var A="100%",N="100%";o.isCustomHtmlAndFixedSizeForm(d)&&(A=t,N=e);var T=s.createIframe(r,N,A,i.IFRAME_SETTINGS.PREVIEW.IFRAME_ID+d);o.isCustomHtmlForm(d)&&na({formId:d,formHeight:t,formWidth:e});var h=document.getElementById("kampyleFormModal");h&&(h.appendChild(T),T.offsetTop<30&&!o.getMemoryData("kampyleDevice")===i.DEVICES.MOBILE&&(h.style.paddingTop=30-T.offsetTop+"px"))}else n=location.protocol+"//"+location.host,window.location=n+"/#/error/404"}function ia(){var t=o.getUserIdentifier();if(!t)return null;var e=w.getCustomParamValue({name:t.source_name,type:t.type,source:t.source});return e||null}function cu(t){o.setMemoryData("isSyncedIdentifierData",!0),mu(t.data)}function mu(t){ur(t.DECLINED_DATE,"DECLINED_DATE"),ur(t.SUBMITTED_DATE,"SUBMITTED_DATE")}function ur(t,e){var r=parseInt(o.getData(e));r=r||null;var n={identifierDataState:e,identifierValOnLocalStorage:r},a={identifierDataState:e,identifierValOnSbt:t,identifierValOnLocalStorage:r};if(t=t||null,t===r)return null;t!==null&&r===null||t>r?o.setData(e,t):r!==null&&t===null||t<r?c.updateTargeting(e,r):s.showWarning("special case")}function Eu(t,e){var r=y.getOnsiteConfiguration().websiteId||null,n=o.getServerBasedTargetingPrefix(),a=o.getServerBasedTargetingEnv(),l=n+"/api/targeting/property/"+a+r+"/identity/"+t,d=aa.bind(null,e),u=fu.bind(null,e);s.httpRequest(i.HTTP_METHODS.GET,l,null,d,u)}function aa(t,e){!e||e.error?k.triggerDigitalAnalyticsEventDispatcherError({errorMessage:"Invalid identifier data. Data: "+JSON.stringify(e)}):cu(e),typeof t=="function"&&t()}function fu(t,e){k.triggerDigitalAnalyticsEventDispatcherError({errorMessage:"Failed to fetch identifier data. Error: "+JSON.stringify(e)}),typeof t=="function"&&t()}function gu(t){var e=o.getMemoryData("identifierValue"),r=o.getMemoryData("isSyncedIdentifierData")===!0,n=!!c.checkProvision(i.PROVISIONS.SERVER_BASED_TARGETING),a=!!t;return a&&n&&(!r||e!==t)}function oa(){if(xe())return!1;if(o.setMemoryData("isInvitationShouldBeIgnored",!1),E.trigger("neb_pageView"),window.KAMPYLE_ONSITE_STATE!=="manual"){var t=o.isFeatureEnabled(i.PROPERTY_SETTINGS.MANUALLY_INVITE_TARGETING);E.trigger("neb_targetingInit",{skipInviteTargeting:t})}}function sa(){var t=o.getData("kampyleSessionPageCounter")||0;t=parseInt(t),o.setData("kampyleSessionPageCounter",++t)}function _u(t){var e="DECLINED_DATE",r=s.getCurrentTimestamp();o.setData(e,r),c.checkProvision(i.PROVISIONS.SERVER_BASED_TARGETING)&&E.trigger(t,{declinedDate:r}),Er(e,r)}function cr(t,e){e=e||{},!e.isFormSubmitted&&(!c.checkProvision(i.PROVISIONS.EXEMPT_FORMS_FROM_QUARANTINE)||o.isFormOfType(e.formId,i.FORM_TYPES.INVITATION))&&c.setQuarantineDeclinedDate(i.EVENTS.MDIGITAL_UPDATE_TARGETING_WITH_DECLINED_DATE_FORM_CLOSED),o.setMemoryData("formIsShown",!1),o.setFormState(e.formId,{shouldBeShown:!1,shown:!1,loaded:null}),c.checkProvision(i.PROVISIONS.NEW_MODAL_DIALOGS)||(s.triggerCustomEvent("neb_formClosed",{formId:e.formId}),o.getMemoryData("context")==="preview"&&window.close()),Yi(e.formId)}function Yi(t){var e=o.getMemoryData("buttonFormId"),r=o.getFormData(e),n=o.getDisplayType(r)==="animation"?1e3:0;e?setTimeout(function(){E.trigger("neb_showButton",{formId:e,formClosed:!0}),Wi(t),mr()},n):(Wi(t),mr())}function Wi(t){E.trigger("neb_afterFormClosed",{formId:t}),c.checkProvision(i.PROVISIONS.NEW_MODAL_DIALOGS)&&s.triggerCustomEvent("neb_formClosed",{formId:t})}function Er(t,e){if(c.checkProvision(i.PROVISIONS.SERVER_BASED_TARGETING)&&o.getMemoryData("identifierValue")){var r={};r[t]=e;var n=o.getServerBasedTargetingPrefix(),a=o.getServerBasedTargetingEnv(),l=n+"/api/targeting/property/"+a+y.getOnsiteConfiguration().websiteId+"/identity/"+encodeURIComponent(o.getMemoryData("identifierValue")),d=r[t],u={dataState:d,dataValue:e};E.trigger("MDigital_updatingSbtServer",u),s.httpRequest(i.HTTP_METHODS.POST,l,r)}}function Iu(){var t="SUBMITTED_DATE",e=s.getCurrentTimestamp();o.setData(t,e),c.checkProvision(i.PROVISIONS.SERVER_BASED_TARGETING)&&E.trigger("MDigital_updateTargetingWithSubmittedDate",{submittedDate:e}),Er(t,e)}function pu(t){switch(o.getFormTriggerType(t)){case i.FORM_TYPES.BUTTON:return o.isFeatureEnabled(i.FEATURE_FLAGS.EXEMPT_BUTTON_FORMS_FROM_QUARANTINE);case i.FORM_TYPES.CODE:return o.isFeatureEnabled(i.FEATURE_FLAGS.EXEMPT_CODE_FORMS_FROM_QUARANTINE);case i.FORM_TYPES.EMBEDDED:return o.isFeatureEnabled(i.FEATURE_FLAGS.EXEMPT_EMBEDDED_FORMS_FROM_QUARANTINE);default:return!1}}function mt(t,e){(!c.checkProvision(i.PROVISIONS.EXEMPT_FORMS_FROM_QUARANTINE)||!pu(e.formId))&&c.setQuarantineSubmittedDate(),o.setData(i.SESSION_DATA_FIELDS.IS_SURVEY_SUBMITTED_IN_SESSION,!0),o.setFormState(e.formId,{isCurrentlySubmitted:!0})}function la(t,e){c.setQuarantineDeclinedDate(i.EVENTS.MDIGITAL_UPDATE_TARGETING_WITH_DECLINED_DATE_INVITE_DECLINED),mr()}function Su(t,e){o.setFormState(e.formId,{loading:!1,loaded:!0}),_t(e)}function da(t,e){e=e||{};var r=c.checkProvision(i.PROVISIONS.USER_SNAP_AS_COMPONENT),n=r&&!Tu(e.formId);n||e.isScreenCaptureEnabled!==!1&&ne.init(function(){E.trigger("neb_screenCaptureLoaded",{formId:e.formId})})}function Tu(t){var e=s.getNestedPropertyValue(o.getFormData(t),"formDisplay.displayType"),r=e!=="embedded"&&!o.isMobile();if(!r)return!1;var n=o.getMemoryJsonNestedPropertyValue(t,"pages",!1),a=o.isV2Form(t),l=a?"components":"dynamicData",d=a?"type":"component";return n.some(function(u){return u[l].some(function(m){return m[d]==="screenCaptureComponent"})})}function Au(t,e){e=e||{};var r=o.getFormData(e.formId),n;switch(o.getDisplayType(r)){case i.DISPLAY_TYPES.LIGHTBOX:n=i.IFRAME_SETTINGS.LIGHTBOX.IFRAME_ID_PREFIX;break;case i.DISPLAY_TYPES.ANIMATION:n=i.IFRAME_SETTINGS.ANIMATION.IFRAME_ID;break;default:n=i.IFRAME_SETTINGS.PREVIEW.IFRAME_ID}var a=n+e.formId;s.sendMessageToIframe(a,{action:"screenCaptureLoaded"})}function ct(){o.setMemoryData("kampyleFocusedElement",document.activeElement)}function mr(){var t=o.getMemoryData("kampyleFocusedElement");t&&t.focus&&t.focus()}function ua(t){var e=y.getOnsiteConfiguration();return!!t&&!!e&&!!e.provisions&&(!!e.provisions[t]||e.provisions[t]==="true")}function fr(){var t=y.getOnsiteConfiguration().provisions,e={};for(var r in t)t.hasOwnProperty(r)&&(e[r]=c.checkProvision(r));return e}function gr(){return o.getMemoryData("kampyleDevice")||o.setMemoryData("kampyleDevice",s.getDeviceTypeByUserAgent(navigator.userAgent,navigator.userAgentData)),o.getMemoryData("kampyleDevice")||"desktop"}function ca(t){var e=o.getMemoryData("version");return e===1?t.screenCapture={isTaken:!1}:t.integrations.screenCapture={isTaken:!1},t}function ma(t,e){e=e||{};var r=o.getFormData(e.formId);if(!r||!e.formId)return!1;var n,a,l=o.getDisplayType(r);switch(l){case"animation":a=document.getElementById(i.IFRAME_SETTINGS.ANIMATION.IFRAME_ID+e.formId);break;case"lightbox":a=document.getElementById(i.IFRAME_SETTINGS.LIGHTBOX.IFRAME_ID_PREFIX+e.formId);break;case"popup":n=o.getMemoryData("popupHandler");break;case i.DISPLAY_TYPES.EMBEDDED:a=document.getElementById(i.IFRAME_SETTINGS.EMBEDDED.IFRAME_ID_PREFIX+e.formId);break;default:return s.showWarning("Invalid display type - "+l),!1}var d="*";if(a&&a.getAttribute&&(d=a.getAttribute("origin")||"*",n=a.contentWindow),n&&n.postMessage){var u=Ea(e.formId);n.postMessage(u,d);var m=c.checkProvision(i.PROVISIONS.EXTENSION_ENABLED);if(m){var f=be.getAuthorizationMessage();n.postMessage(f,d)}u='{"action": "setFormId","formId" : '+e.formId+', "__isDigitalAction": true}',n.postMessage(u,d),u={action:"setExtraData",__isDigitalAction:!0},u.clientHints=s.safeJsonParse(i.PLACEHOLDERS.USER_AGENT_CLIENT_HINTS_LIST)||[],u.provisions=fr(),u.integrations=he.getIntegrationData();var _=o.getMemoryData(i.MEMORY_DATA_FIELDS.DECIBEL_DATA);Object.assign(u.integrations,{decibel:_}),u.websiteId=y.getOnsiteConfiguration().websiteId||null,u.device=o.getMemoryData("kampyleDevice"),u.context=o.getMemoryData("context"),u.url=encodeURIComponent(document.location.href),u.customCssUpload=o.isFeatureEnabled(i.PROPERTY_SETTINGS.CUSTOM_CSS_UPLOAD),u=ca(u),u.isScreenCaptureEnabled=ne.isScreenCaptureEnabled(e.formId),u.provisions.screenCapture=c.checkProvision("screenCapture")||c.checkProvision("screenCaptureEnabled"),u.displayType=o.getDisplayType(r);var A=y.getOnsiteConfiguration();Object.assign(u,{submitUrlPrefix:A.submitUrlPrefix,submitUrlSuffix:A.submitUrlSuffix,submitUrlWithBackendUUID:A.submitUrlWithBackendUUID,globalResourcesUrl:A.globalResourcesUrl,versionedResourcesUrl:r.versionedResourcesUrl,textAreaLimit:A.textAreaLimit}),c.checkProvision(i.PROVISIONS.SERVER_BASED_TARGETING)&&(u.endUserIdentifier=ia(),E.trigger("neb_initUserIdentifierOnExtraData",{hasIdentifierValue:u.endUserIdentifier!==null}));var N=o.flushFormExtraData(e.formId);if(N)for(var T in N)N.hasOwnProperty(T)&&(u[T]=N[T]);if(c.checkProvision(i.PROVISIONS.FORM_TEMPLATE_DATA_SEPERATION)){var h=function(F){u=Object.assign({},u,{formData:F}),u.formLanguage=B.getFormLanguage(e.formId)||null,n.postMessage(JSON.stringify(u),d)},g=function(F){console.error(F)};o.fetchFormJsonData({formId:r.formId,callback:h,onError:g},!0)}else n.postMessage(JSON.stringify(u),d)}E.trigger("neb_formShown",{formId:e.formId,feedbackCorrelationUUID:e.feedbackCorrelationUUID})}function Ea(t){if(w.hasCustomParams(t)){var e=w.formatCustomParams(t);return'{"action": "customParamsLoaded","customParams" : '+JSON.stringify(e)+', "__isDigitalAction": true}'}}function fa(t,e){e=e||{},o.setMemoryData("NEB_FORM_VERSION",e.formVersion||0)}function vu(){var t=o.getMemoryData("formsState")||{};for(var e in t)if(t.hasOwnProperty(e)&&t[e].inviteShown)return!0;return!1}function xe(t,e){var r=o.getMemoryData("formsState")||{};for(var n in r)if(r.hasOwnProperty(n)){var a=!z.isFormShown(n)&&(t&&t==n||e&&o.isSkipInvitation(n));if((r[n].shown||r[n].shouldBeShown)&&!o.isEmbeddedDisplayType(n)&&!a)return!0}return!1}function bu(t){t=t||{};var e=t.value,r=t.type||"";if(e===void 0&&(e=w.fetchCPValue(t)),e!==null)switch(r.toLowerCase()){case"datetime":typeof e=="string"?e=parseInt(e)||null:!j(e,Date)&&(!e.getTime||isNaN(e.getTime()))?e=null:e=e.getTime();break;case"number":e=s.getNumericValue(e);break;case"text":typeof e!="string"&&(e=null);break;case"boolean":e==="true"?e=!0:e==="false"&&(e=!1),typeof e!="boolean"&&(e=null);break;default:e=null,console.error("Invalid custom parameter type "+r);break}return e}function Du(){var t=y.getOnsiteConfiguration();return!!t&&t.isFormsPreloaded!=="false"&&t.isFormsPreloaded!==!1}function yu(){var t=o.getData("kampyleUserSessionsCount");t=Number(t)||0,o.setData("kampyleUserSessionsCount",++t)}function hu(){o.isFeatureEnabled("SPA")&&KAMPYLE_ONSITE_SDK.updatePageView()}function Nu(t){t=t||{},E.trigger("neb_buttonClicked",{formId:t.formId})}function ga(){var t=Number(o.getData("kampyleUserSession"));return t?Math.floor(s.getTimeDiff(t,i.TIME_FORMATS.SECONDS)):0}function _a(){var t=Number(o.getData("kampylePageLoadedTimestamp"));return t?Math.floor(s.getTimeDiff(t,i.TIME_FORMATS.SECONDS)):0}function Ki(t){var e=Number(o.getData(t));return e?s.getTimeDiff(e,i.TIME_FORMATS.DAYS):null}function Ia(t,e){var r=(o.getMemoryData("kampyleDevice")||i.DEVICES.DESKTOP).toLowerCase(),n=o.getFormData(e.formId),a={desktop:r===i.DEVICES.DESKTOP,mobile:r===i.DEVICES.MOBILE,tablet:r===i.DEVICES.TABLET,abandon:!!o.getMemoryData("targetingState.abandon"),time_in_session:ga(),time_on_page:_a(),excluded_urls:s.getNestedPropertyValue(n,"urlRules.exclusionUrl.rule"),included_urls:s.getNestedPropertyValue(n,"urlRules.inclusionUrl.rule"),number_of_visits:Number(o.getData("kampyleUserSessionsCount"))||1,last_declined:Ki("DECLINED_DATE"),last_feedback:Ki("SUBMITTED_DATE"),percentage:L.getUserPercentile(e.formId)};o.setMemoryData("invitationTriggeringData",a)}function Ou(){return c.checkProvision(i.PROVISIONS.EVENT_INCLUDE_FEEDBACK_CONTENT)||c.checkProvision(i.PROVISIONS.EXPOSE_SELECTION_QUESTIONS)||c.checkProvision(i.PROVISIONS.EXPOSE_VERBATIM_QUESTIONS)}var c={increasePageViewCounter:sa,subscribeToCustomEvents:Ji,subscribeToPageEvents:ji,createSession:ea,updateTargeting:Er,checkProvision:ua,getAllProvisions:fr,onSyncIdentifierDataSuccess:aa,shouldRenderForm:Qi,addScreenCaptureData:ca,sendFormExtraData:ma,handleVersion:fa,showPreviewForm:uu,updatePreviewIframeStyle:na,validateFormContract:Xi,getTriggerTypeByEvent:$i,prepareInviteTriggeringData:Ia,loadScreenCaptureApi:da,handleInviteLoaded:ta,sendInviteInitialData:ra,checkDevice:gr,shouldSyncIdentifier:gu,prepareJsonData:dr,shouldSkipFetchingFormData:iu,getTimeInSession:ga,getTimeOnPage:_a,isReferrerDifferentThanHost:lu,setQuarantineDeclinedDate:_u,setQuarantineSubmittedDate:Iu,handleFormClosed:cr,handleFeedbackSubmitted:mt,handleInviteDeclined:la,init:eu,startCheckingTargeting:oa,isAnyOtherFormAlreadyShown:xe,isAnyInviteShown:vu,getSafeCustomParamVal:bu,isPreloadConfigured:Du,kampyleButtonClicked:Nu,loadMultipileForms:zi,routeToForm:qi,updateIdentifierDataIntegerIfNecessary:ur,syncIdentifierData:Eu,getUserIdentifierVal:ia,handleFormStateUpdated:_t,hasApplicationLoadingFailed:ft,isJsonDataLoaded:gt,handleInviteApplicationUpdated:Et,isFormLoaded:Zi,isContentPayloadEnabled:Ou,getCustomParamsMessage:Ea};var s={TOP_LEVEL_DOMAIN_COOKIE_PREFIX:"Tld-",startsWith:function(e,r,n){return e.substr(n||0,r.length)===r},isIos:function(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream},isSafari:function(){return navigator.userAgent.indexOf("Safari")>-1&&navigator.userAgent.indexOf("Chrome")<0},isiPhone:function(){return/iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream},isiPadOS13:function(){return s.isSafari()&&!s.isiPhone()&&(navigator.platform==="MacIntel"||navigator.platform==="Mac-Intel")&&navigator.maxTouchPoints>1},isDesktop:function(){return o.getMemoryData("kampyleDevice")===i.DEVICES.DESKTOP},triggerCustomEvent:function(e,r){var n;r=r?{detail:r}:{},n=new CustomEvent(e,r);try{window.dispatchEvent(n)}catch(a){s.showWarning("Could not trigger custom event "+e)}},isDebugMode:function(){var e=o.getMemoryData("region");return e===i.REGIONS.DEV||e===i.REGIONS.QA},showErrorStack:function(e){s.isDebugMode()&&console.warn(e.stack)},showWarning:function(e){s.isDebugMode()&&console.warn(e)},addStyle:function(e,r){if(c.checkProvision(i.PROVISIONS.CSP_RULES))console.error("Should not use this method if the provision csp rules is on");else{r=r||window.document;var n=r.getElementById("kampyleStyle");if(n===null){n=r.createElement("style"),n.type="text/css",n.id="kampyleStyle";var a=r.head||r.getElementsByTagName("head")[0];a.appendChild(n)}n.styleSheet?n.styleSheet.cssText+=e:(n.appendChild(document.createTextNode(e)),s.setAnimationRule(i.CSS_SETTINGS.ANIMATION_RULE_SPIN_NAME,"{0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); }}"))}},addAttributesOnElement:function(e,r){if(e&&r)for(var n in r)r.hasOwnProperty(n)&&e.setAttribute&&e.setAttribute(n,r[n])},removeAttribute:function(e,r){e&&e.hasAttribute(r)&&e.removeAttribute(r)},getViewportSize:function(){return{width:Math.max(document.documentElement.clientWidth,window.innerWidth||0),height:Math.max(document.documentElement.clientHeight,window.innerHeight||0)}},getDocumentSize:function(){var e=document.body,r=document.documentElement,n=Math.max(e.scrollHeight||0,e.offsetHeight||0,r.clientHeight||0,r.scrollHeight||0,r.offsetHeight||0),a=Math.max(e.scrollWidth||0,r.scrollWidth||0,e.offsetWidth||0,r.offsetWidth||0,r.clientWidth||0);return{width:a+(e.getBoundingClientRect&&e.getBoundingClientRect().left||0),height:n+(e.getBoundingClientRect&&e.getBoundingClientRect().top||0)}},getElementSize:function(e){var r=Math.max(e.scrollHeight||0,e.offsetHeight||0,e.clientHeight||0),n=Math.max(e.scrollWidth||0,e.offsetWidth||0,e.clientWidth||0);return{width:n,height:r}},getCurrentTimestamp:function(){return new Date().getTime()},getTimeDiff:function(e,r){var n=typeof e!="undefined"?e:"2014-01-01 01:02:03.123456";n=new Date(n).getTime();var a=s.getCurrentTimestamp();if(isNaN(n))return"";var l=0;switch(n<a?l=a-n:l=n-a,r){case i.TIME_FORMATS.SECONDS:return l.toFixed(1)/1e3;case i.TIME_FORMATS.DAYS:return Math.floor(l/1e3/60/60/24);default:return l}},setEventHandler:function(e,r,n){e.addEventListener?e.addEventListener(r,n,!1):e.attachEvent&&e.attachEvent("on"+r,n)},subscribeToCustomEvent:function(e,r){window&&window.addEventListener&&typeof r=="function"&&window.addEventListener(e,function(n){var a=n&&n.detail;r.apply(null,[e,a])},!1)},removeEventHandler:function(e,r,n){e.removeEventListener?e.removeEventListener(r,n):e.detachEvent&&e.detachEvent("on"+r,n)},setElementStyle:function(e,r,n){var a,l;if(n=n?"important":"",e){for(a in r)if(r.hasOwnProperty(a))if(n&&e&&e.style.setProperty){l=s.camelToDash(a);try{e.style.setProperty(l,""+r[a],n)}catch(d){e.style.setProperty(l,""+r[a],"!"+n)}}else e.style[a]=r[a]}},setAnimationRule:function(e,r,n){for(var a=n&&n.styleSheets&&n.styleSheets||!n&&window.document.styleSheets,l=null,d=0;d<a.length;d++)a[d].title==i.CSS_SETTINGS.STYLE_SHEET_ANIMATION_NAME&&(l=a[d]);if(l){for(var d=0;d<l.cssRules.length;d++)if(l.cssRules[d].name==e)return}if(!l){var u=document.createElement("style");u.title=i.CSS_SETTINGS.STYLE_SHEET_ANIMATION_NAME,n?(n.body.appendChild(u),l=n.styleSheets[n.styleSheets.length-1]):(document.body.appendChild(u),l=window.document.styleSheets[window.document.styleSheets.length-1])}var m="@keyframes "+e+" "+r,f=l.cssRules.length;l.insertRule(m,f)},isNear:function(e,r,n){var a=document.getElementById(e);if(!a)return!1;var l=s.offset(a).left-r,d=s.offset(a).top-r,u=l+a.clientWidth+2*r,m=d+a.clientHeight+2*r,f=n.pageX,_=n.pageY;return f>l&&f<u&&_>d&&_<m},offset:function(e){if(!e)return!1;var r=e.getBoundingClientRect(),n=document.body;return{top:+r.top+n.scrollTop,left:r.left+n.scrollLeft}},createIframe:function(e,r,n,a){var l=document.createElement("iframe");return l.width=r,l.height=n,l.src=e,l.id=a,l.style.border=0,l.frameBorder=0,l.style.display="inline-block",l},getUrlParam:function(e){var r=location.search.substr(location.search.indexOf("?")+1);r===""&&(r=location.hash.substr(location.hash.indexOf("?")+1));var n=null;r=r.split("&");for(var a=r.length,l=0;l<a;l++){var d=r[l].split("=");d&&[d[0]]==e&&(n=decodeURIComponent(d[1]))}return n},htmlDecode:function(e){e=e||"";var r;return r=new RegExp("&lt","g"),e=e.replace(r,"<"),r=new RegExp("&gt","g"),e=e.replace(r,">"),e},escapeRegExp:function(e){return e.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")},replaceAll:function(e,r,n){return e.replace(new RegExp(s.escapeRegExp(r),"g"),n)},sendMessageToIframe:function(e,r){var a,l,n;if(e&&(n=document.getElementById(e),!(!n||!n.getAttribute))){var a=n.getAttribute("origin")||"*",l=n.contentWindow;l&&l.postMessage&&(r&&(r.__isDigitalAction=!0),l.postMessage(JSON.stringify(r),a))}},getZoomedIn:function(){var e={zoom:1,constraint:1,isZoomedIn:!1},r="",n=1,a=!1;try{o.isMobile()?e.zoom=window.visualViewport.scale:(r=s.getBrowser(),n=window.devicePixelRatio,r.name===i.BROWSERS.SAFARI?(a=n===2,e.zoom=window.outerWidth/window.innerWidth):r.name===i.BROWSERS.FIREFOX?(n>5?a=!0:a=window.matchMedia("only screen and (-webkit-min-device-pixel-ratio: 1.5), screen and (min-resolution: 1.5dppx), screen and (min-resolution: 144dpi)").matches,e.zoom=a?n*.5:n):(window.screen&&window.screen.pixelDepth?a=window.screen.pixelDepth>24:a=window.outerWidth-window.innerWidth*(n/2)<=60,e.zoom=a?n*.5:n),e.constraint=2)}catch(l){return e}return e.isZoomedIn=e.zoom>=2.4,e},getBrowser:function(){var e=navigator.userAgent,r,n=e.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];if(n[1]==="Chrome"&&(r=e.match(/\b(OPR|Edge)\/(\d+)/),r!=null)){var a=r.slice(1);return{name:a[0].replace("OPR","Opera"),version:a[1]||""}}return n=n[2]?[n[1],n[2]]:[navigator.appName,navigator.appVersion,"-?"],(r=e.match(/version\/(\d+)/i))!=null&&n.splice(1,1,r[1]),{name:n[0],version:n[1]}},initEventSubscriptions:function(e,r){for(var n in e)e.hasOwnProperty(n)&&E.subscribe(n,r)},getRandomTimeMS:function(e,r){return e+Math.round(Math.random()*(r-e))},kampyleGetUserId:function(){var e=o.getData("kampyle_userid");return e||(e=s.kampyleCreateUUID(),o.setData("kampyle_userid",e),c.checkProvision(i.PROVISIONS.ALTERNATIVE_UUID)&&o.setData(i.MEMORY_DATA_FIELDS.MDIGITAL_ALTERNATIVE_UUID,s.generateUUID())),e},kampyleCreateUUID:function(){for(var e=8,r=function(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)},n=r(),a=0;a<e-1;a++)n+="-"+r();return n},removeAllContent:function(e){if(e){for(;e.firstChild;)e.removeChild(e.firstChild);e.parentNode.removeChild(e)}},safeToLower:function(e){return typeof e!="string"?e:e.toLowerCase()},getCookieFlagByProtocol:function(){var e=s.isSecureProtocol(),r=e?"None":"Lax",n=e?"Secure; ":"";return"SameSite="+r+"; "+n},buildQueryParams:function(e){return Object.keys(e||{}).map(function(r,n){return(n===0?"?":"")+r+"="+e[r]}).join("&")||""},kampyleSetCookie:function(e,r,n,a){var l=new Date;l.setTime(l.getTime()+n*24*60*60*1e3);var d="expires="+l.toUTCString(),u=a?";domain="+a+";":"",m=s.getCookieFlagByProtocol();e=a?s.TOP_LEVEL_DOMAIN_COOKIE_PREFIX+e:e,document.cookie=e+"="+r+"; "+m+d+";path=/"+u},isSecureProtocol:function(){return location.protocol==="https:"},getCookie:function(e){this.name=e+"=",this.ca=document.cookie.split(";");for(var r=0;r<this.ca.length;r++){for(this.c=this.ca[r];this.c.charAt(0)===" ";)this.c=this.c.substring(1);if(this.c.indexOf(this.name)===0){var n=this.c.substring(this.name.length,this.c.length);return n}}return null},getDomainFromHost:function(e){if(e===null)return null;var r=e.indexOf(":"),n=r===-1?e.length:r;return e.substring(0,n)},isHostMatchesSubdomain:function(e,r){var n=s.getDomainFromHost(e);return n===r||n.endsWith("."+r)},kampyleGetCookie:function(e){this.name=e+"=",this.ca=document.cookie.split(";");for(var r=0;r<this.ca.length;r++){for(this.c=this.ca[r];this.c.charAt(0)===" ";)this.c=this.c.substring(1);if(this.c.indexOf(this.name)===0)return this.c.substring(this.name.length,this.c.length)}return""},getByteSize:function(e){return encodeURIComponent("<q></q>"+e).length},getAllKampyleData:function(){var e=["SUBMITTED_DATE","kampyleUserPercentile","kampyleUserSession","kampyle_userid","kampyleInvitePresented","DECLINED_DATE","LAST_INVITATION_VIEW"];c.checkProvision(i.PROVISIONS.ALTERNATIVE_UUID)&&e.push(i.MEMORY_DATA_FIELDS.MDIGITAL_ALTERNATIVE_UUID),c.checkProvision(i.PROVISIONS.EXEMPT_FORMS_FROM_QUARANTINE)&&e.push(i.SESSION_DATA_FIELDS.IS_SURVEY_SUBMITTED_IN_SESSION);for(var r={},n=e.length-1;n>=0;n--)r[e[n]]=o.getData(e[n]);return r},kampyleDeleteCookie:function(e,r){var n="";r&&(n=";domain="+r+";");var a=s.getCookieFlagByProtocol(),l="expires=Thu, 01 Jan 1970 00:00:00 UTC";document.cookie=e+"= ; "+a+l+";path=/"+n},kampyleIsCookieEnabled:function(){return navigator.cookieEnabled},kampyleCompareTimestamps:function(e,r,n){if(typeof e!="number"||typeof r!="number")return!1;switch(e=new Date(e),r=new Date(r),e.setHours(0,0,0,0),n){case"equals":return r.setHours(0,0,0,0),e.getTime()===r.getTime();case"laterthan":return r.setHours(23,59,59,999),e>r;case"earlierthan":return r.setHours(0,0,0,0),e<r;case"doesnotequal":return r.setHours(0,0,0,0),e.getTime()!==r.getTime();default:return!1}},kampyleCompareByOperator:function(e,r,n,a){a=s.safeToLower(a);var l=!1;if(e===void 0)return l;switch(n=s.safeToLower(n),n){case i.OPERATORS.EQUALS:a==="datetime"?l=s.kampyleCompareTimestamps(e,r,n):l=e===r;break;case i.OPERATORS.DOES_NOT_EQUAL:a==="datetime"?l=s.kampyleCompareTimestamps(e,r,n):l=e!==r;break;case i.OPERATORS.GREATER_THAN:l=e>r;break;case i.OPERATORS.LATER_THAN:a==="datetime"?l=s.kampyleCompareTimestamps(e,r,n):l=e>r;break;case i.OPERATORS.SMALLER_THAN:l=e<r;break;case i.OPERATORS.EARLIER_THAN:a==="datetime"?l=s.kampyleCompareTimestamps(e,r,n):l=e>r;break;case i.OPERATORS.CONTAINS:l=!!e&&e.indexOf&&e.indexOf(r)!==-1;break;case i.OPERATORS.DOES_NOT_CONTAIN:l=!!e&&e.indexOf&&e.indexOf(r)===-1;break;case i.OPERATORS.STARTS_WITH:l=!!e&&e.indexOf&&e.indexOf(r)===0;break;case i.OPERATORS.ENDS_WITH:l=!!e&&e.indexOf&&e.length&&e.indexOf(r,e.length-e.length)!==-1;break;case i.OPERATORS.HAS_VALUE:l=!!e||e===""||e===!1||e===0;break;case i.OPERATORS.REGEX:try{var d=new RegExp(r);l=!!e&&d.exec(e)!==null}catch(u){l=!1}break;default:break}return l},setNestedPropertyValue:function(e,r,n){for(var a=e,l=r.split("."),d=l.length,u=0;u<d-1;u++){var m=l[u];a[m]||(a[m]={}),a=a[m]}a[l[d-1]]=n},getNestedPropertyValue:function(e,r,n){if(!e||!r||typeof r!="string")return null;for(var a="#DOT#",l=r.split("."),d=e,u=l.length,m=0;m<u;m++){var f=l[m].split(a).join("."),_=d!==null&&(typeof d=="undefined"?"undefined":Q(d))==="object"&&f in d;if(d&&(Object.prototype.hasOwnProperty.call(d,f)||_||d[f]))d=d[f];else return typeof n=="undefined"?null:n}return d},validateKampyleDomain:function(e){var r=/(^https?:\/\/[A-Za-z0-9\-]+\.kampyle\.com(\/[A-Za-z0-9\-\._~:\/\?#\[\]@!$&'\(\)\*\+,;\=]*)?)/,n=r.test(e);return n||console.warn("Invalid url in validateKampyleDomain: "+e),n},camelToDash:function(e){return typeof e!="string"?e:e.replace(/\W+/g,"-").replace(/([a-z\d])([A-Z])/g,"$1-$2").toLowerCase()},objectPropertyObserver:function(e,r,n){var a=100,l=100,d=0;function u(){var m=s.getNestedPropertyValue(e,r);if(m&&j(n,Function))return n(m);d++<a&&window.setTimeout(u,l)}window.setTimeout(u,l)},showInvite:function(){var e=document.getElementById("kampyleInvite");s.setElementStyle(e,{visibility:"visible"},!0)},hideInvite:function(){var e=document.getElementById("kampyleInvite");s.setElementStyle(e,{visibility:"hidden"},!0)},getNumericValue:function(e){return e===""||e===null||typeof e!="number"&&isNaN(Number(e))?null:Number(e)},extractAllObjectNonFunctionsProperties:function(e){var r={};for(var n in e)typeof e[n]!="function"&&(r[n]=e[n]);return Object.keys(r).length>0?r:null},httpRequest:function(e,r,n,a,l,d){var u=0,m=(d||{}).numOfTimes||i.NETWORK.NUM_OF_RETRIES,f=(d||{}).timeout||i.NETWORK.REQUEST_TIMEOUT;function _(N,T,h){if(u<m){u++;var g=s.getRetryTimeout();setTimeout(A,g)}else E.trigger(T,h),typeof l=="function"&&l(N)}function A(){var N=s.getCurrentTimestamp(),T={attemptNumber:u,url:r};if(n){var h=Object.assign({},n);T=Object.assign({},T,{postData:h})}e==="POST"&&E.trigger(i.ANALYTICS_HTTP_EVENTS_BY_METHOD.BEFORE.POST,{httpRequestData:T});var g=new XMLHttpRequest;g.open(e,r,!0),n&&g.setRequestHeader("Content-Type","application/json"),g.timeout=f||0,g.onerror=function(R){var F=s.getTimeDiff(N,i.TIME_FORMATS.SECONDS),X={requestUrl:r,responseStatus:g.status,error:R,requestTotalTimeInSeconds:F};_(X,i.ANALYTICS_HTTP_EVENTS_BY_METHOD.ERROR[e],{httpRequestData:X})},g.ontimeout=function(R){var F=s.getTimeDiff(N,i.TIME_FORMATS.SECONDS),X={requestUrl:r,responseStatus:g.status,error:R,attemptNumber:u,networkConnectionDetails:s.extractAllObjectNonFunctionsProperties(window.navigator.connection),requestTotalTimeInSeconds:F};_(X,i.ANALYTICS_HTTP_EVENTS_BY_METHOD.TIMEOUT[e],{httpRequestData:X})},g.onload=function(){var R=s.getTimeDiff(N,i.TIME_FORMATS.SECONDS),F=s.safeJsonParse(g.responseText);if(g.status===200){var X={requestUrl:r,attemptNumber:u,requestTotalTimeInSeconds:R};E.trigger(i.ANALYTICS_HTTP_EVENTS_BY_METHOD.AFTER[e],{httpRequestData:X}),typeof a=="function"&&a(F)}else{var W={requestUrl:r,responseStatus:g.status,responseText:F,attemptNumber:u,requestTotalTimeInSeconds:R};_(W,i.ANALYTICS_HTTP_EVENTS_BY_METHOD.ERROR_STATUS_CODE[e],{httpRequestData:W})}},n?g.send(JSON.stringify(T.postData)):g.send()}A()},lowerize:function(e){return e.toLowerCase()},trim:function(e){return e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")},getDeviceTypeByUserAgent:function(e,r){var n="function",a="model",l="object",d="type",u="vendor",m="console",f="mobile",_="tablet",A="smarttv",N="wearable",T="desktop";if(r&&r.platform)return r.mobile?f:r.platform.toLowerCase()==="android"?_:T;if(s.isiPadOS13())return _;for(var h={},g=[[/\((ipad|playbook);[\w\s\);-]+(rim|apple)/i],[a,u,[d,_]],[/applecoremedia\/[\w\.]+ \((ipad)/],[a,[u,"Apple"],[d,_]],[/(archos)\s(gamepad2?)/i,/(hp).+(touchpad)/i,/(hp).+(tablet)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i,/SHIELD Tablet/,/A500/,/LG-V410\/V41020c/,/Puffin/,/^(?!.*Mobile).*Android.*$/],[u,a,[d,_]],[/(kf[A-z]+)\sbuild\/[\w\.]+.*silk\//i],[a,[u,"Amazon"],[d,_]],[/\((ip[honed|\s\w*]+);.+(apple)/i],[a,u,[d,f]],[/\((ip[honed|\s\w*]+);/i],[a,[u,"Apple"],[d,f]],[/(blackberry)[\s-]?(\w+)/i,/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|huawei|meizu|motorola|polytron)[\s_-]?([\w-]+)*/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i],[u,a,[d,f]],[/\(bb10;\s(\w+)/i],[a,[u,"BlackBerry"],[d,f]],[/android.+(transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus 7|padfone)/i],[a,[u,"Asus"],[d,_]],[/(sony)\s(tablet\s[ps])\sbuild\//i,/(sony)?(?:sgp.+)\sbuild\//i],[[u,"Sony"],[a,"Xperia Tablet"],[d,_]],[/(?:sony)?(?:(?:(?:c|d)\d{4})|(?:so[-l].+))\sbuild\//i],[[u,"Sony"],[a,"Xperia Phone"],[d,f]],[/(lenovo)\s?(S(?:5000|6000)+(?:[-][\w+]))/i],[u,a,[d,_]],[/(htc)[;_\s-]+([\w\s]+(?=\))|\w+)*/i,/(zte)-(\w+)*/i,/(alcatel|geeksphone|huawei|lenovo|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]+)*/i],[u,[a,/_/g," "],[d,f]],[/(nexus\s9)/i],[a,[u,"HTC"],[d,_]],[/(nexus\s6p)/i],[a,[u,"Huawei"],[d,f]],[/(microsoft);\s(lumia[\s\w]+)/i],[u,a,[d,f]],[/(kin\.[onetw]{3})/i],[[a,/\./g," "],[u,"Microsoft"],[d,f]],[/\s(milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?(:?\s4g)?)[\w\s]+build\//i,/mot[\s-]?(\w+)*/i,/(XT\d{3,4}) build\//i,/(nexus\s6)/i],[a,[u,"Motorola"],[d,f]],[/android.+\s(mz60\d|xoom[\s2]{0,2})\sbuild\//i],[a,[u,"Motorola"],[d,_]],[/android.+((sch-i[89]0\d|shw-m380s|gt-p\d{4}|gt-n\d+|sgh-t8[56]9|nexus 10))/i,/((SM-T\w+))/i],[[u,"Samsung"],a,[d,_]],[/smart-tv.+(samsung)/i],[u,[d,A],a],[/((s[cgp]h-\w+|gt-\w+|galaxy\snexus|sm-\w[\w\d]+))/i,/(sam[sung]*)[\s-]*(\w+-?[\w-]*)*/i,/sec-((sgh\w+))/i],[[u,"Samsung"],a,[d,f]],[/sie-(\w+)*/i],[a,[u,"Siemens"],[d,f]],[/(maemo|nokia).*(n900|lumia\s\d+)/i,/(nokia)[\s_-]?([\w-]+)*/i],[[u,"Nokia"],a,[d,f]],[/android\s3\.[\s\w;-]{10}(a\d{3})/i],[a,[u,"Acer"],[d,_]],[/android\s3\.[\s\w;-]{10}(lg?)-([06cv9]{3,4})/i],[[u,"LG"],a,[d,_]],[/(nexus\s[45])/i,/lg[e;\s\/-]+(\w+)*/i],[a,[u,"LG"],[d,f]],[/android.+(ideatab[a-z0-9\-\s]+)/i],[a,[u,"Lenovo"],[d,_]],[/linux;.+((jolla));/i],[u,a,[d,f]],[/android.+;\s(oppo)\s?([\w\s]+)\sbuild/i],[u,a,[d,f]],[/android.+;\s(pixel c)\s/i],[a,[u,"Google"],[d,_]],[/android.+;\s(pixel xl|pixel)\s/i],[a,[u,"Google"],[d,f]],[/android.+(\w+)\s+build\/hm\1/i,/android.+(hm[\s\-_]*note?[\s_]*(?:\d\w)?)\s+build/i,/android.+(mi[\s\-_]*(?:one|one[\s_]plus|note lte)?[\s_]*(?:\d\w)?)\s+build/i],[[a,/_/g," "],[u,"Xiaomi"],[d,f]],[/android.+a000(1)\s+build/i],[a,[u,"OnePlus"],[d,f]],[/\s(tablet)[;\/]/i,/\s(mobile)(?:[;\/]|\ssafari)/i],[[d,s.lowerize],u,a],[/Mobile|iP(hone|od|ad)|(Android).*(Mobile|sdk)|BlackBerry|portalmmm|BOLT|Vodafone|WindowsCE|IEMobile|Kindle|NetFront|Silk-Accelerated|(hpw|web)OS|Fennec|Minimo|Opera M(obi|ini)|Blazer|Dolfin|Dolphin|Skyfire|Zune/],[u,a,[d,f]]],R=e||navigator.userAgent,F=0,X,W,M,C,le,K;F<g.length&&!le;){var de=g[F],Se=g[F+1];for(X=W=0;X<de.length&&!le;)if(le=de[X++].exec(R),le)for(M=0;M<Se.length;M++)K=le[++W],C=Se[M],(typeof C=="undefined"?"undefined":Q(C))===l&&C.length>0?C.length==2?Q(C[1])==n?h[C[0]]=C[1].call(h,K):h[C[0]]=C[1]:C.length==3?Q(C[1])===n&&!(C[1].exec&&C[1].test)?h[C[0]]=K?C[1].call(h,K,C[2]):void 0:h[C[0]]=K?K.replace(C[1],C[2]):void 0:C.length==4&&(h[C[0]]=K?C[3].call(h,K.replace(C[1],C[2])):void 0):h[C]=K||void 0;F+=2}return!h[d]||h[d]!==f&&h[d]!==_?T:h[d]},getElementStyle:function(e,r){if(j(e,HTMLElement))try{return window.getComputedStyle(e).getPropertyValue(r)}catch(n){}return null},isTruthy:function(e){if(typeof e!="string")return e;try{e=JSON.parse(e)}catch(r){}return e},safeJsonParse:function(e,r){try{return JSON.parse(e)}catch(n){return s.showWarning(r||"Failed to parse JSON, error message: "+(n||{}).message),s.showErrorStack(n||{}),null}},addWcagStyleOnFocus:function(e){o.isFeatureEnabled(i.FEATURE_FLAGS.WCAG)&&(e.addEventListener("focusin",function(){s.setElementStyle(e,{outline:"1px dashed #595959",outlineOffset:"2px",transition:"none"},!0)}),e.addEventListener("focusout",function(){e.style.outline="none",e.style.outlineOffset=null,e.style.transition=null}))},addHoverEffectOnElement:function(e,r,n){e&&typeof e.addEventListener=="function"&&(e.addEventListener("mouseenter",function(){s.setElementStyle(e,n)}),e.addEventListener("mouseleave",function(){s.setElementStyle(e,r)}))},handleAfterFormPosition:function(e,r){var n=!0;if(c.checkProvision(i.PROVISIONS.NOT_SCROLL_TO_LAST_POSITION_DISPLAY_TYPE_ANIMATION))var a=o.getFormData(r.formId),n=o.getDisplayType(a)!=="animation";n&&s.scrollToLastPosition()},scrollToLastPosition:function(){var e=o.getMemoryData("scrollPosition");e&&(window.scroll(e.x,e.y),o.deleteMemoryData("scrollPosition"))},setCurrentScrollPosition:function(){if(!c.checkProvision(i.PROVISIONS.NOT_SCROLL_TO_LAST_POSITION_DISPLAY_TYPE_ANIMATION)&&document.body!==document.activeElement)return!1;var e=s.getScrollPosition()||{};o.setMemoryData("scrollPosition",{x:e.x,y:e.y})},getScrollPosition:function(){var e=window.pageXOffset!==void 0,r=(document.compatMode||"")==="CSS1Compat",n=e?window.pageXOffset:r?document.documentElement.scrollLeft:document.body.scrollLeft,a=e?window.pageYOffset:r?document.documentElement.scrollTop:document.body.scrollTop;return{x:n,y:a}},getLangCodeFromNavAPI:function(){return window.navigator.language||window.navigator.userLanguage||null},getStrigifiedData:function(e){var r;if((typeof e=="undefined"?"undefined":Q(e))==="object"&&e!==null)try{r=JSON.stringify(e)}catch(n){r=e}else r=e;return r},appendScript:function(e){var r=document.createElement("script");r.src=e,document.body.appendChild(r)},toBase64:function(e){return e=e||"",btoa(unescape(encodeURIComponent(e)))},styleObjToInline:function(e){var r="";for(var n in e)r+=n+":"+e[n]+";";return r},getBaseUrl:function(){return location.origin+location.pathname},generateUUID:function(){var e=s.getCurrentTimestamp();window.performance&&typeof window.performance.now=="function"&&(e+=performance.now());var r="xxxx-xxxx-xxxx-xxxx-xxxx-xxxx-xxxx-xxxx".replace(/[x]/g,function(){var n=(e+Math.random()*16)%16|0;return e=Math.floor(e/16),n.toString(16)});return r},getRetryTimeout:function(){var e=o.getMemoryData(i.MEMORY_DATA_FIELDS.DATA_JSON);return s.getNestedPropertyValue(e,"retryTimout")||i.NETWORK.RETRY_TIMEOUT},isTrue:function(e){return e===!0||e==="true"},isValueNumericAndDefined:function(e){var r=!!e,n=!isNaN(e);return r&&n},focusElement:function(e){e&&typeof e.focus=="function"&&e.focus()},fakePromise:function(e){return{then:function(n){n(e)}}},textEncode:function(e){if(window.TextEncoder)return new TextEncoder("utf-8").encode(e);for(var r=unescape(encodeURIComponent(e)),n=new window.Uint8Array(r.length),a=0;a<r.length;a++)n[a]=r.charCodeAt(a);return n},toHex:function(e){for(var r=new window.Uint8Array(e),n=[],a=0;a<r.length;a++){var l=r[a].toString(16),d=("00"+l).slice(-2);n.push(d)}return n.join("")},sha512:function(e){var r=window.crypto;if(!(r&&r.subtle)||!e||!window.Uint8Array)return s.fakePromise(null);var n=s.textEncode(e),a=r.subtle.digest("SHA-256",n);return typeof a.then=="function"&&typeof a.catch=="function"?a.then(function(l){return s.toHex(l)}).catch(function(){return null}):s.fakePromise(null)},isModalFormType:function(e){var r=o.getFormData(e),n=o.getDisplayType(r),a=!!r&&!!n&&r.formType!==i.FORM_TYPES.EMBEDDED&&n!==i.DISPLAY_TYPES.POPUP;return c.checkProvision(i.PROVISIONS.NEW_MODAL_DIALOGS)?a&&n!==i.DISPLAY_TYPES.ANIMATION:a},isFormInPreviewContext:function(e){var r=o.getFormState(e);return r!=null&&(r.triggerType=="Preview"||r.triggerType=="DraftPreview")},setSpinnerStyle:function(e,r,n){if(e||r){var a={small:{widthHeight:15,border:3},large:{widthHeight:40,border:4}},l=a[r].widthHeight/2+a[r].border,d=e.querySelector("#"+i.SPINNER_SETTINGS.ID),u={display:"block",height:"100%","z-index":"2147483647"};r===i.SPINNER_SETTINGS.SIZE.LARGE&&(u.position="absolute",u.width="100%",u.top=0),s.setElementStyle(d,{border:a[r].border+"px solid #f3f3f3","border-radius":"50%",width:a[r].widthHeight+"px",height:a[r].widthHeight+"px","border-top":a[r].border+"px solid #4050C6","margin-top":"5px","margin-right":"5px",top:"calc(50% - "+l+"px)",left:"calc(50% - "+l+"px)",position:"relative"},!0),s.setElementStyle(e,u,!0),c.checkProvision(i.PROVISIONS.CSP_RULES)?d.animate([{transform:"rotate(0deg)"},{transform:"rotate(360deg)"}],{duration:1e3,iterations:1/0}):(s.setElementStyle(d,{animation:i.CSS_SETTINGS.ANIMATION_RULE_SPIN_NAME+" 1s linear infinite"},!0),s.setAnimationRule(i.CSS_SETTINGS.ANIMATION_RULE_SPIN_NAME,"{0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); }}",n))}},getParsedUrl:function(e){try{var r=document.createElement("a");return r.href=e,{protocol:r.protocol,host:r.host,hostname:r.hostname,port:r.port,pathname:r.pathname,hash:r.hash,search:r.search,origin:r.origin}}catch(n){return console.error("Not valid URL"+e),null}},debounce:function(e,r,n){var a;return function(){var l=this,d=arguments,u=function(){a=null,n||e.apply(l,d)},m=n&&!a;clearTimeout(a),a=setTimeout(u,r),m&&e.apply(l,d)}},getOrCreateWrapperContainer:function(e){return document.getElementById(e)||Object.assign(document.createElement("span"),{id:e})}};var fe;function Mu(){fe={}}function pa(t){var e=i.LOG_MESSAGES.TRIGGER_MESSAGE_TEMPLATE;return e=e.replace("{{EVENT_NAME}}",t.eventName).replace("{{DATA}}",s.getStrigifiedData(t.data)).replace("{{CONTEXT}}",s.getStrigifiedData(t.context)).replace("{{OPTIONS}}",s.getStrigifiedData(t.options)),t.errorMessage?(e=e.replace("{{STATUS}}",i.LOG_STATUSES.FAILED),e+=i.LOG_MESSAGES.ERROR_LOG_TEMPLATE.replace("{{ERROR_MESSAGE}}",t.errorMessage)):e=e.replace("{{STATUS}}",i.LOG_STATUSES.TRIGGERED),e}function Sa(t){return t&&fe&&fe[t]?fe[t]:fe}var Pu=function(e,r){if(!e||typeof e!="string"||!r||typeof r!="function")return!1;var n=fe[e];if(typeof n!="undefined"){var a=n.indexOf(r);a!==-1&&n.splice(a,1)}return!0},_r=function(e,r){if(!e||typeof e!="string"||!r||typeof r!="function"&&typeof r!="string")return!1;var n=fe[e];typeof n=="undefined"&&(n=fe[e]=[]);var a=n.indexOf(r);return a===-1&&n.push(r),!0};function Ta(t){t=t||{};var e=y.getOnsiteConfiguration(),r={};return e&&(r={accountId:e.accountId,websiteId:e.websiteId,enviroment:e.region}),Object.assign(t,r)}var Cu=function(e,r,n,a){var l=s.getNestedPropertyValue(fe,e),d,u;if(typeof l=="undefined"||l===null)return!1;r=Ta(r);var m=j(r,Array)?r:[r];for(n=n||null,u=l.length,d=0;d<u;d+=1)if(typeof l[d]=="string")s.triggerCustomEvent(l[d]);else try{l[d].apply(n,[e].concat(m)),V.getLoggerStatus()&&V.debug(pa({eventName:e,data:r,context:n,options:a,errorMessage:null}))}catch(f){if(V.getLoggerStatus()&&V.error(pa({eventName:e,data:r,context:n,options:a,errorMessage:f.message})),s.showErrorStack(f),r&&(r.errorMessage=f.message,r.errorStack=f.stack,k.triggerDigitalAnalyticsEventDispatcherError(r)),a&&a.isStrictMode)break;continue}return!0},Ru=function(e){E.trigger(i.EVENTS.NEB_EVENT_DISPATCHER_ERROR,e)},Lu=function(e){for(var r in e)if(e.hasOwnProperty(r))for(var n=0;n<e[r].length;n++)_r(r,e[r][n])};function Fu(t,e){var r=Sa(t);(!r[t]||r.indexOf(e)===-1)&&_r(t,e)}var E={subscribe:_r,subscribeOnce:Fu,subscribeMany:Lu,trigger:Cu,triggerError:Ru,unsubscribe:Pu,init:Mu,getEventSubscriptions:Sa,appendDefaultEventParams:Ta};var Ir,Be,Aa={abandon:"abandon",percentage:"kampyleInvitePercentageUsers",timeInSession:"kampyleTimeInSession",timeOnPage:"kampyleTimeOnPage",deviceTypes:"devicetypes",pageEvents:"pageElementEvent"},ku={GTM:"isGoogleAnalyticsClientGTM",WCAG:"isWCAG",SPA:"isSpa",MANUALLY_INVITE_TARGETING:"isManuallyInviteTargeting",CUSTOM_CSS_UPLOAD:"customCssUpload"},wu=[i.FEATURE_FLAGS.EXEMPT_BUTTON_FORMS_FROM_QUARANTINE,i.FEATURE_FLAGS.EXEMPT_EMBEDDED_FORMS_FROM_QUARANTINE,i.FEATURE_FLAGS.EXEMPT_CODE_FORMS_FROM_QUARANTINE],Gu=function(){Ir=y.getOnsiteConfiguration()||{},Be={}};function pt(t){var e=o.getMemoryData(i.MEMORY_DATA_FIELDS.DATA_JSON);return s.getNestedPropertyValue(e,t)}function Uu(){var t=se("formsState")||{};for(var e in t)if(t.hasOwnProperty(e)&&t[e].shouldBeShown)return e;return!1}function va(){return{loading:!1,loaded:null,shouldBeShown:!1,shown:!1,inviteLoaded:null,inviteShown:!1,jsonFailed:!1,applicationFailed:!1,isCurrentlySubmitted:!1,targeting:{pageTargeting:null,behavioralTargeting:[],quarantineTargeting:[]}}}function xu(t){var e=isNaN(t)||!t,r;if(e){r={};for(var n=y.getOnsiteConfiguration()||{},a=n.formNodes||[],l=a.length,d,u=0;u<l;u++)d=a[u],d&&(r[d.formId]=va());ge("formsState",r)}else r=o.getMemoryData("formsState"),r[t]=va(),ge("formsState",r);ge("hostingElementsHeights",{}),o.setMemoryData(i.MEMORY_DATA_FIELDS.IS_BUTTON_CONTAINER_CREATED,!1),o.clearAllTimeoutHandlers(),o.clearAllDOMEventsHandlers()}function Bu(){var t=se(i.MEMORY_DATA_FIELDS.TIMEOUT_HANDLERS);for(var e in t)window.clearTimeout(t[e]);ge(i.MEMORY_DATA_FIELDS.TIMEOUT_HANDLERS,{})}function Vu(t,e){ge(i.MEMORY_DATA_FIELDS.TIMEOUT_HANDLERS+"."+t,e)}function Hu(t){return se(i.MEMORY_DATA_FIELDS.TIMEOUT_HANDLERS+"."+t)}function Yu(t,e,r,n){var a={eventName:e,eventHandler:r,targetElement:n};ge(i.MEMORY_DATA_FIELDS.DOM_EVENT_HANDLERS+"."+t,a)}function Wu(t){return se(i.MEMORY_DATA_FIELDS.DOM_EVENT_HANDLERS+"."+t)}function Ku(){var t=se(i.MEMORY_DATA_FIELDS.DOM_EVENT_HANDLERS)||{};for(var e in t){var r=t[e].eventName,n=t[e].eventHandler,a=t[e].targetElement||document;a.removeEventListener(r,n)}ba(i.MEMORY_DATA_FIELDS.DOM_EVENT_HANDLERS)}function Xu(t){ge(i.MEMORY_DATA_FIELDS.EX_AUTHORIZATION_TOKEN,t)}function zu(){return se(i.MEMORY_DATA_FIELDS.EX_AUTHORIZATION_TOKEN)}function qu(t){var e=ku[t];return e==null&&wu.indexOf(t)!==-1&&(e=t),!!e&&!!s.getNestedPropertyValue(Ir,e)}function Ju(t){try{return Sr()?s.kampyleGetCookie(s.TOP_LEVEL_DOMAIN_COOKIE_PREFIX+t):localStorage[t]||s.kampyleGetCookie(t)}catch(e){return s.kampyleGetCookie(t)}}function se(t){return t=t||"",s.getNestedPropertyValue(Be,t)}function ge(t,e){s.setNestedPropertyValue(Be,t,e)}function ba(t){delete(Be||{})[t]}function Zu(t,e,r){var n=c.checkProvision(i.PROVISIONS.DISABLE_COOKIE_STORAGE);if(n)if(o.getPropertySharedSubdomain())s.kampyleSetCookie(t,e,r||It(),o.getPropertySharedSubdomain());else try{localStorage[t]=e}catch(a){s.kampyleSetCookie(t,e,r||It(),o.getPropertySharedSubdomain())}else{if(!o.getPropertySharedSubdomain())try{localStorage[t]=e}catch(a){}s.kampyleSetCookie(t,e,r||It(),o.getPropertySharedSubdomain())}return!0}var Qu=function(e){var r=Sr();if(r){s.kampyleDeleteCookie(s.TOP_LEVEL_DOMAIN_COOKIE_PREFIX+e,r);return}try{localStorage[e]!==void 0&&delete localStorage[e]}catch(n){}c.checkProvision(i.PROVISIONS.DISABLE_COOKIE_STORAGE)||s.kampyleDeleteCookie(e)};function _e(t){for(var e=ya(),r=e.length,n,a=0;a<r;a++)if(n=e[a],parseInt(t)===parseInt(n.formId))return n;return null}function ju(){return Be}function pr(t){return t=t||"",se("formsState."+t)||null}function Da(t,e){e=e||{};var r=se("formsState")||{};r[t]=r[t]||{};for(var n in e)Q(r[t][n])==="object"&&r[t][n]!==null?Object.assign(r[t][n],e[n]):r[t][n]=e[n];ge("formsState",r)}function ya(){var t=y.getOnsiteConfiguration()||{},e=t.formNodes||[];return e}function $u(){var t=y.getOnsiteConfiguration()||{};return t.integrations||{}}function ec(t){var e=_e(t);return e?e.inviteData:null}function tc(){var t=c.checkProvision("mobileInvitationLayout"),e=se("kampyleDevice");return!!t&&e!=="desktop"}function rc(t){var e=_e(t)||{},r=s.getNestedPropertyValue(e,"inviteData.skipInvitation");return r&&r!=="false"}function nc(t){var e=_e(t)||{};return e.isFixedSize===!0||e.isFixedSize==="true"}function ic(t){var e=ha(t),r=c.checkProvision("dynamicModalSizeInCustomHtml");return e&&(!r||r&&nc(t))}function St(t){var e=o.getMemoryData("kampyleDevice"),r=s.getNestedPropertyValue(t,"formDisplay.displayType");return e!==i.DEVICES.DESKTOP?r===i.DISPLAY_TYPES.EMBEDDED?i.DISPLAY_TYPES.EMBEDDED:i.DISPLAY_TYPES.LIGHTBOX:r||i.DISPLAY_TYPES.LIGHTBOX}function ac(t,e){e=e||{};var r=(pr(t)||{}).pendingExtraData||{};e=Object.assign(r,e),Da(t,{pendingExtraData:e})}function oc(t){var e=pr(t)||{},r={};return e&&e.pendingExtraData&&(r=e.pendingExtraData,delete e.pendingExtraData),r}function ha(t){var e=_e(t)||{},r=s.getUrlParam("isCustomHtml");return e.isCustomHtmlEnabled===!0||e.isCustomHtmlEnabled==="true"||r===!0||r==="true"}function It(){return s.getNestedPropertyValue(Ir,"cookieExpirationTime")||i.COOKIE_EXPIRATION}function sc(t,e){if(!t||!e||!Aa[e])return null;var r=_e(t)||{},n=Aa[e];return s.getNestedPropertyValue(r,"onSiteData."+n)}function lc(t){var e=o.getFormData(t);return Number((e||{}).formVersion)||0}function dc(){return y.getOnsiteConfiguration().websiteId||null}function uc(t){var e=o.getMemoryData("kampyleDevice"),r=i.FEATURE_VERSIONS.MOBILE_DYNAMIC_SIZING;t=t||o.getMemoryData("currentFormId");var n=o.isCustomHtmlForm(t),a=n&&c.checkProvision("mobileWebDynamicFormSize")||!n&&c.checkProvision("mobileWebDynamicFormSizeInFormBuilder");return a&&e&&e!=="desktop"&&!o.isV2Form(t)&&o.getFormVersion(t)>=r}function cc(){var t=o.getMemoryData("kampyleDevice");return t&&t!=="desktop"}function mc(){return pt("sbtServerDomain")}function Ec(){return pt("sbtEnvPrefix")}function Sr(){var t=pt("sharedSubdomain");return t&&s.isHostMatchesSubdomain(window.location.host,t)?t:null}function fc(){for(var t=y.getOnsiteConfiguration().customParams||[],e=o.getNestedConfigurationProperty("formNodes")||[],r=0;r<e.length;r++){var n=(e[r].customParams||[]).map(function(l){return t.find(function(d){return d.id===l})}),a=(n||[]).find(function(l){return(typeof l=="undefined"?"undefined":Q(l))==="object"&&l.is_identifier===!0})||null;if(a!==null)return a}return null}function gc(t){var e=_e(t);return St(e)===i.DISPLAY_TYPES.POPUP}function _c(t){var e=_e(t);return St(e)===i.DISPLAY_TYPES.EMBEDDED}function Ic(t){var e=_e(t);return St(e)===i.DISPLAY_TYPES.LIGHTBOX}function pc(t,e,r){var n;return r?n=e?r+t+"_invite":r+t:n=(e?i.INVITE_JSON_DATA_KEY_PREFIX:i.FORM_JSON_DATA_KEY_PREFIX)+t,n+"_"+B.getFormLanguage(t)}function Sc(t,e,r){var n=o.getMemoryJsonKey(t,r),a=o.getMemoryData(n);return a!=null?s.getNestedPropertyValue(a,e):null}function Tc(t,e){var r=B.getFormLanguage(t)||i.LOCALIZED_FORM_DEFAULT_REPLACE_VALUE;return e.replace("###LANGUAGE_CODE###",r)}function Ac(){for(var t=o.getAllForms(),e=0;e<t.length;e++){var r=t[e];B.detectAndSetFormLanguage(r)}}function vc(){for(var t in localStorage)t.indexOf(i.MEMORY_DATA_FIELDS.SESSION_TAB_PREFIX)>-1&&o.deleteData(t)}function bc(t){var e=[];for(var r in localStorage)r.indexOf(t)>-1&&e.push(localStorage[r]);return e}function Dc(t,e){var r=o.getFormData(t),n=s.getNestedPropertyValue(r,e?"inviteData.inviteDataUrl":"formDataUrl");return n?o.localizeUrl(t,n):null}function yc(t,e){var r=o.getMemoryJsonKey(t.formId,t.isInvite),n=o.getMemoryData(r),a=o.getDataJsonUrl(t.formId,t.isInvite);if(n)return t.fetchingDataInProgressKey&&o.setMemoryData(t.fetchingDataInProgressKey,!1),typeof t.callback=="function"&&t.callback(n);if(!a){var l=new Error("Failed to get JSON, jsonDataUrl is missing.");return typeof t.onError=="function"&&t.onError(l)}s.httpRequest(i.HTTP_METHODS.GET,a,null,function(d){if(e){var u="second http request have been made to the url: "+a;E.trigger("MDigital_warning",{message:u})}if(d)o.setMemoryData(r,d),t.fetchingDataInProgressKey&&o.setMemoryData(t.fetchingDataInProgressKey,!1),typeof t.callback=="function"&&t.callback(d);else{var m="Invalid form json data. Data: "+JSON.stringify(d);k.triggerDigitalAnalyticsEventDispatcherError({errorMessage:m}),typeof t.onError=="function"&&t.onError({message:m})}},function(d){k.triggerDigitalAnalyticsEventDispatcherError({errorMessage:"Failed to fetch JSON data. Error: "+JSON.stringify(d)}),typeof t.onError=="function"&&t.onError(d)})}function Na(t){var e=s.getNestedPropertyValue(o.getFormData(t),"formType");return i.FORM_TRIGGER_TYPES_MAP[e]?e:null}function hc(t,e){var r=Na(t);return!!r&&r===e}function Nc(t){var e=o.getFormData(t);if(e==null)return null;if(e.formType===i.FORM_TYPES.EMBEDDED)return i.IFRAME_SETTINGS.EMBEDDED.IFRAME_ID_PREFIX+t;var r=o.getDisplayType(e);return r===i.DISPLAY_TYPES.LIGHTBOX?i.IFRAME_SETTINGS.LIGHTBOX.IFRAME_ID_PREFIX+t:r===i.DISPLAY_TYPES.ANIMATION?i.IFRAME_SETTINGS.ANIMATION.IFRAME_ID+t:null}function Oc(t){var e=o.getFormData(t);if(!(!t||!e||!e.formDataUrl))return e.formDataUrl.indexOf("formDataV2")>-1}var o={init:Gu,isFeatureEnabled:qu,getData:Ju,setData:Zu,deleteData:Qu,getAllForms:ya,getInegrations:$u,getFormData:_e,getMemoryData:se,getTargetingData:sc,setMemoryData:ge,getShownFormId:Uu,getFormState:pr,setFormState:Da,getInviteData:ec,getDisplayType:St,saveFormExtraData:ac,flushFormExtraData:oc,isCustomHtmlForm:ha,getCookieExpiration:It,isNewMobileInvitation:tc,isCustomHtmlAndFixedSizeForm:ic,deleteMemoryData:ba,getFormVersion:lc,isMobileDynamicSizing:uc,getPropertySharedSubdomain:Sr,getUserIdentifier:fc,getServerBasedTargetingPrefix:mc,getServerBasedTargetingEnv:Ec,isPopupDisplayType:gc,isEmbeddedDisplayType:_c,isLightBoxDisplayType:Ic,fetchFormJsonData:yc,getFormTriggerType:Na,getPropertyId:dc,isMobile:cc,isSkipInvitation:rc,getFormIframeId:Nc,isFormOfType:hc,getMemoryJsonNestedPropertyValue:Sc,resetAllFormsLanguagesCode:Ac,getMemoryJsonKey:pc,clearSessionTabs:vc,getStorageDataByPrefix:bc,setTimeoutHandler:Vu,getTimeoutHandler:Hu,isV2Form:Oc,setDOMEventHandler:Yu,getDOMEventHandler:Wu,clearAllDOMEventsHandlers:Ku,setAuthorizationToken:Xu,getAuthorizationToken:zu,localizeUrl:Tc,getMemory:ju,initOnsiteDefaultState:xu,getDataJsonUrl:Dc,clearAllTimeoutHandlers:Bu,getNestedConfigurationProperty:pt};var Oa;function Ma(t){var e=window.location.hostname,r=t.filter?t.filter(function(n){if(n[0]==="*"){var a=new RegExp("^.*"+n.slice(1)+"$");return a.test(e)}return n===e}):[];return!!r.length}function Mc(){window.MDIGITAL=window.MDIGITAL||{};var t=!!window.MDIGITAL.version;if(t){var e=k||window.MDIGITAL.ANALYTICS;throw e&&window.MDIGITAL.md_tracker&&e.sendDigitalAnalytics({eventId:"MDigital_multipleGenericInjections",mdData:{additionalInfo:"version ".concat(i.PLACEHOLDERS.ONSITE_VERSION," was loaded after ").concat(window.MDIGITAL.version)}}),new Error("MDIGITAL already loaded")}window.MDIGITAL.version=i.PLACEHOLDERS.ONSITE_VERSION,Oa=y.getOnsiteConfiguration(),Pc(),o.setMemoryData(i.MEMORY_DATA_FIELDS.DATA_JSON,Oa);var r=c.checkProvision(i.PROVISIONS.DHH),n=window.KAMPYLE_EMBED.getOnsiteDataLocation();n?y.fetchOnsiteExternalConfiguration(window.KAMPYLE_EMBED.getOnsiteDataLocation(r)):y.onsiteDataFailed("onsiteDataLocation is ".concat(n))}function Pc(){V.init(),E.init(),o.init(),y.init(),k.initTracker(),window.KAMPYLE_EMBED||E.trigger(i.EVENTS.DIRECT_GENERIC_INJECTION)}function Cc(t){if(c.checkProvision(i.PROVISIONS.ENABLE_ONSITE_DOMAIN_APPROVAL)){var e=t.domainsConfiguration;if(e&&!e.allDomainsAllowed&&e.domainsNames&&!Ma(e.domainsNames)){console.error("onsite origin domain is not allowed"),E.triggerError({errorMessage:window.location.hostname+" domain was blocked! domainsConfiguration: "+JSON.stringify(e)});return}}o.setMemoryData(i.MEMORY_DATA_FIELDS.DATA_JSON,t),k.registerConfigurationDependentEvents(),k.updateTrackerAnalyticsUrl(),o.initOnsiteDefaultState(),Lc(),c.init(),c.startCheckingTargeting(),Ie.reportInitComplete()}function Rc(){s.triggerCustomEvent("neb_OnsiteLoaded")}function Lc(){c.checkProvision(i.PROVISIONS.EXTENSION_ENABLED)&&window.postMessage({action:"sendMdExtensionData",propertyId:o.getPropertyId(),__isDigitalAction:!0},document.location.origin)}var Ie={init:Mc,initOnsite:Cc,reportInitComplete:Rc,isAllowedDomain:Ma};function Pa(t){if(Array.isArray(t))return t}function Ca(t,e){var r=t==null?null:typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n=[],a=!0,l=!1,d,u;try{for(r=r.call(t);!(a=(d=r.next()).done)&&(n.push(d.value),!(e&&n.length===e));a=!0);}catch(m){l=!0,u=m}finally{try{!a&&r.return!=null&&r.return()}finally{if(l)throw u}}return n}}function Ra(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Tr(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function La(t,e){if(t){if(typeof t=="string")return Tr(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(r);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Tr(t,e)}}function Tt(t,e){return Pa(t)||Ca(t,e)||La(t,e)||Ra()}function Fc(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;window[e]={};var n=function(){return console.warn("".concat(e," will be deprecated! Please, use in future KAMPYLE_ONSITE_SDK instead!"))};(typeof t=="undefined"?"undefined":Q(t))==="object"&&(r&&(window.MDIGITAL[e]={}),Object.entries(t).map(function(a){var l=Tt(a,2),d=l[0],u=l[1];if(typeof u=="function"){var m=u;r?window.MDIGITAL[e][d]=function(){return n(),m.apply(window,arguments)}:window[e][d]=function(){return n(),m.apply(window,arguments)}}else Object.defineProperty(window[e],d,{get:function(){return n(),u}})}))}var U=Fc;var Fa={formId:null,targetModalId:""},ka=window.top,te={};function kc(){At(),E.subscribeMany({neb_formShown:[wa],neb_inviteReady:[Ga],MDigital_noJsonModalShown:[Ua],neb_afterFormClosed:[Gc],neb_inviteAccepted:[Uc],neb_inviteDeclined:[xc],MDigital_noJsonModalClosed:[Bc],neb_captureImageClicked:[Ar],MDigital_Capture_Cancelled:[Ar]})}function At(){Object.assign(te,Fa)}function Ve(t){Object.assign(te,t)}function wc(){return te}function wa(t,e){var r=e.formId;Qa(r),s.isModalFormType(r)&&(Ve({formId:r,focusedElement:vt(r)?te.focusedElement:document.activeElement,targetModalId:o.getFormIframeId(r),isNoJsonModal:!1,isPreview:r!=null&&s.isFormInPreviewContext(r)}),Yc(r),s.isSafari()||o.isCustomHtmlForm(r)&&!c.checkProvision(i.PROVISIONS.IS_CHTML_HANDLE_INIT_FOCUS_INDEPENDENTLY)?Ya():ie.trapFocus())}function Ga(t,e){var r=e.formId;ja(r),!o.isNewMobileInvitation()&&(Ve({formId:r,focusedElement:document.activeElement,targetModalId:i.IFRAME_SETTINGS.INVITATION.IFRAME_ID,isNoJsonModal:!1,isPreview:!1}),Wc(r),s.isSafari()?Ya():ie.trapFocus())}function Ua(t,e){Ve({formId:e.formId,focusedElement:document.activeElement,targetModalId:i.IFRAME_SETTINGS.OOPS.CONTAINER_ID_PREFIX+e.formId,isNoJsonModal:!0,isPreview:!1}),Kc(),ie.focusOnOopsCloseButton(),ie.trapFocus()}function vt(t){return t!=null&&t==te.formId}function Gc(t,e){vt(e.formId)&&xa()}function Uc(t,e){vt(e.formId)&&(br(),yr(),Ve({targetModalId:null}))}function xc(t,e){vt(e.formId)&&Vc()}function Bc(t,e){xa()}function Vc(){br(),yr(),Xa(),At()}function xa(){br(),Dr(),Xa(),At()}function Ba(){Ha()}function Hc(){if(!te.isPreview)try{ka.addEventListener(i.BROWSER_EVENTS.FOCUS,Ba,!0)}catch(t){Va(t)}}function br(){if(!te.isPreview)try{ka.removeEventListener(i.BROWSER_EVENTS.FOCUS,Ba,!0)}catch(t){Va(t)}}function Va(t){k.triggerDigitalAnalyticsEventDispatcherError({errorMessage:t.message,errorStack:t.stack}),V.getLoggerStatus()&&V.error(t)}function Ar(){var t=document.getElementById(te.targetModalId);t&&t.contentWindow&&t.contentWindow.focus()}function Ha(){te.isNoJsonModal?Ka():Wa()}function Ya(){ie.focusOnModal(),ie.trapFocus()}function Wa(){var t=document.getElementById(te.targetModalId);s.focusElement(t)}function Ka(){var t=document.querySelector("#"+te.targetModalId+" #"+i.IFRAME_SETTINGS.OOPS.CLOSE_BUTTON_ID);s.focusElement(t)}function Xa(){var t=te.focusedElement;if(t!=null&&t!==document.body)s.focusElement(t);else if(document.activeElement!==document.body&&s.isSafari()){var e=document.getElementById(te.targetModalId);e!=null&&document.activeElement===e&&(window.focus(),zc())}}function Yc(t){var e={role:"dialog","aria-modal":!0,"aria-label":Ja(t)},r=qa(t);Dr(),za(Object.assign(e,{lang:r}))}function Wc(t){var e={role:"dialog","aria-modal":!0,"aria-label":Za(t)},r=qa(t);yr(),Xc(r!=null?Object.assign(e,{lang:r}):e)}function Kc(){var t={role:"alertdialog","aria-modal":!0,"aria-labelledby":"title-no-json-modal","aria-describedby":"description-no-json-modal"},e=qc();Dr(),za(e!=null?Object.assign(t,{lang:e}):t)}function za(t){ie.setDialogAriaAttributes(i.IFRAME_SETTINGS.LIGHTBOX.CONTAINER_ID_PREFIX,t)}function Xc(t){ie.setDialogAriaAttributes(i.IFRAME_SETTINGS.INVITATION.WRAPPER_ID,{"aria-live":"polite"}),ie.setDialogAriaAttributes(i.IFRAME_SETTINGS.INVITATION.CONTAINER_ID,t)}function zc(){var t=document.createElement("div");s.addAttributesOnElement(t,{tabindex:"-1","aria-hidden":!0}),document.body.appendChild(t),t.focus(),t.remove()}function qc(){return c.checkProvision(i.PROVISIONS.PROPERTY_MESSAGES)?ce.getPropertyMessageLanguageCode():null}function qa(t){return B.getFormLanguage(t)}function Jc(t,e){var r=document.getElementById(t);r!=null&&s.addAttributesOnElement(r,e)}function Dr(){vr(i.IFRAME_SETTINGS.LIGHTBOX.CONTAINER_ID_PREFIX)}function yr(){vr(i.IFRAME_SETTINGS.INVITATION.WRAPPER_ID),vr(i.IFRAME_SETTINGS.INVITATION.CONTAINER_ID)}function vr(t){var e=document.getElementById(t);if(e!=null){var r=["role","aria-modal","aria-label","aria-labelledby","aria-describedby","lang","aria-live"];for(var n in r)s.removeAttribute(e,r[n])}}function Ja(t){var e;return c.checkProvision(i.PROVISIONS.FORM_TEMPLATE_DATA_SEPERATION)&&(e=o.getMemoryJsonNestedPropertyValue(t,"settings.formBasicSettings.formAnnouncement",!1)),e||i.IFRAME_SETTINGS.IFRAME_TITLE}function Za(t){var e;return c.checkProvision(i.PROVISIONS.FORM_TEMPLATE_DATA_SEPERATION)&&(e=o.getMemoryJsonNestedPropertyValue(t,"invitationAnnouncement",!0)),e||i.IFRAME_SETTINGS.INVITATION.IFRAME_TITLE}function Qa(t){var e=o.getFormIframeId(t);if(e!=null){var r=document.getElementById(e);r!=null&&(r.title=Ja(t))}}function ja(t){var e=document.getElementById(i.IFRAME_SETTINGS.INVITATION.IFRAME_ID);e!=null&&(e.title=Za(t))}var ie={init:kc,initModalState:At,onFormShown:wa,onInviteReady:Ga,onNoJsonModalShown:Ua,getModalState:wc,setModalState:Ve,setFocus:Ha,focusOnModal:Wa,focusOnOopsCloseButton:Ka,trapFocus:Hc,refocusForm:Ar,setDialogAriaAttributes:Jc,setLocalizedAnnouncementOnForm:Qa,setLocalizedAnnouncementOnInvite:ja,CURRENT_SHOWN_MODAL_INITIAL_STATE:Fa};var $a={formId:null,targetModalId:""},eo=window.top,ye={};function Zc(){Pe(),E.subscribeMany(ue({neb_formShown:[to],neb_captureImageClicked:[hr],MDigital_Capture_Cancelled:[hr],neb_inviteReady:[Qc,He,ro,Nr],MDigital_noJsonModalShown:[jc,He,Nr],neb_formClosed:[$c],neb_inviteAccepted:[bt,Pe],neb_inviteDeclined:[bt,Pe],MDigital_noJsonModalClosed:[bt,Pe]},c.checkProvision(i.PROVISIONS.WCAG_REVIEW_FIXES)&&{neb_button_displayed:[tm]}))}function Pe(){Object.assign(ye,$a)}function to(t,e){s.isModalFormType(e.formId)&&(Dt({formId:e.formId,targetModalId:o.getFormIframeId(e.formId)}),Ye.focusOnModal(),Ye.trapFocus())}function hr(){var t=document.getElementById(ye.targetModalId);t&&t.contentWindow&&t.contentWindow.focus()}function Dt(t){Object.assign(ye,t)}function He(){var t=document.getElementById(ye.targetModalId);t&&typeof t.focus=="function"&&t.focus()}function ro(){var t=document.getElementById(ye.targetModalId),e=s.getNestedPropertyValue(s.getBrowser(),"name");t&&e===i.BROWSERS.FIREFOX&&(t.setAttribute("aria-hidden","true"),setTimeout(function(){t.setAttribute("role","alert"),t.setAttribute("aria-hidden","false")},250))}function Nr(){try{eo.addEventListener(i.BROWSER_EVENTS.FOCUS,He)}catch(t){no(t)}}function Qc(t,e){Dt({targetModalId:i.IFRAME_SETTINGS.INVITATION.IFRAME_ID})}function jc(t,e){Dt({targetModalId:i.IFRAME_SETTINGS.OOPS.CONTAINER_ID_PREFIX+e.formId})}function $c(t,e){var r=e.formId;r===ye.formId&&(bt(),Pe())}function bt(){try{eo.removeEventListener(i.BROWSER_EVENTS.FOCUS,He)}catch(t){no(t)}}function no(t){k.triggerDigitalAnalyticsEventDispatcherError({errorMessage:t.message,errorStack:t.stack}),V.getLoggerStatus()&&V.error(t)}function em(){return ye}function tm(t,e){if(e.formClosed){var r=document.getElementById("nebula_div_btn");r&&typeof r.focus=="function"&&r.focus()}}var Ye={init:Zc,initModalState:Pe,onFormShown:to,getModalState:em,setModalState:Dt,focusOnModal:He,trapFocus:Nr,refocusForm:hr,announceInvitation:ro,CURRENT_SHOWN_MODAL_INITIAL_STATE:$a};function rm(){window.KAMPYLE_ONSITE_SDK=Xe;var t=location.search.slice(1).split("&").reduce(function(e,r){var n=Tt(r.split("="),2),a=n[0],l=n[1];return Object.assign(e,Ke({},a,l))},{});(localStorage.isDebugMode==="true"||t.isDebugMode&&s.isFormInPreviewContext(t.isDebugMode))&&(window.KAMPYLE_DATA=o),window.KAMPYLE_DATA=o,U(i,"KAMPYLE_CONSTANT"),U(s,"KAMPYLE_UTILS"),U(E,"KAMPYLE_EVENT_DISPATCHER"),U(c,"KAMPYLE_FUNC"),U(ae,"KAMPYLE_ANIMATION"),U(Z,"KAMPYLE_COMMON"),U(k,"MDIGITAL_ANALYTICS"),U(he,"KAMPYLE_INTEGRATION"),U(be,"KAMPYLE_MESSAGE"),U(ne,"KAMPYLE_SCREEN_CAPTURE"),U(L,"KAMPYLE_TARGETING"),U(v,"KAMPYLE_VIEW"),U($,"MDIGITAL_ELEMENT_BUILDER"),U(z,"FORM_STATE",!0),U(y,"CONFIGURATION",!0),U(lt,"CUSTOM_EVENTS",!0),U(w,"CUSTOM_PARAMETERS"),U(De,"EMBEDDED",!0),U(Ie,"INIT",!0),c.checkProvision(i.PROVISIONS.LOCALIZED_FORMS)&&U(B,"LOCALIZATION",!0),U(V,"LOGGER",!0),c.checkProvision(i.PROVISIONS.NEW_MODAL_DIALOGS)&&U(ie,"MODAL_DIALOGS",!0),c.checkProvision(i.PROVISIONS.ON_PREM_HYBRID)&&U(Ae,"ON_PREM",!0),U(ce,"PROPERTY_MESSAGES",!0),U(Ye,"WCAG",!0),U(ve,"DECIBEL",!0)}var io={init:rm};Ie.init();io.init();})();
//# sourceMappingURL=generic.js.map
